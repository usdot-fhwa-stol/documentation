<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Carma-platform: basic_autonomy::waypoint_generation Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Carma-platform<span id="projectnumber">&#160;v4.2.0</span>
   </div>
   <div id="projectbrief">CARMA Platform is built on robot operating system (ROS) and utilizes open source software (OSS) that enables Cooperative Driving Automation (CDA) features to allow Automated Driving Systems to interact and cooperate with infrastructure and other vehicles through communication.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('namespacebasic__autonomy_1_1waypoint__generation.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">basic_autonomy::waypoint_generation Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html">DetailedTrajConfig</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1GeneralTrajConfig.html">GeneralTrajConfig</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1PointSpeedPair.html">PointSpeedPair</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab4974a3dfe697ccc0dd1344a8e11c5e1"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasic__autonomy_1_1waypoint__generation.html#ab4974a3dfe697ccc0dd1344a8e11c5e1">apply_speed_limits</a> (const std::vector&lt; double &gt; speeds, const std::vector&lt; double &gt; speed_limits)</td></tr>
<tr class="memdesc:ab4974a3dfe697ccc0dd1344a8e11c5e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies the provided speed limits to the provided speeds such that each element is capped at its corresponding speed limit if needed.  <a href="namespacebasic__autonomy_1_1waypoint__generation.html#ab4974a3dfe697ccc0dd1344a8e11c5e1">More...</a><br /></td></tr>
<tr class="separator:ab4974a3dfe697ccc0dd1344a8e11c5e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada2ee63b890bfa23d67a17cf61dd0129"><td class="memItemLeft" align="right" valign="top">Eigen::Isometry2d&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasic__autonomy_1_1waypoint__generation.html#ada2ee63b890bfa23d67a17cf61dd0129">compute_heading_frame</a> (const lanelet::BasicPoint2d &amp;p1, const lanelet::BasicPoint2d &amp;p2)</td></tr>
<tr class="memdesc:ada2ee63b890bfa23d67a17cf61dd0129"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a 2D coordinate frame which is located at p1 and oriented so p2 lies on the +X axis.  <a href="namespacebasic__autonomy_1_1waypoint__generation.html#ada2ee63b890bfa23d67a17cf61dd0129">More...</a><br /></td></tr>
<tr class="separator:ada2ee63b890bfa23d67a17cf61dd0129"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af509efce135492493e13c9bb86329dcd"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1PointSpeedPair.html">PointSpeedPair</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasic__autonomy_1_1waypoint__generation.html#af509efce135492493e13c9bb86329dcd">constrain_to_time_boundary</a> (const std::vector&lt; <a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1PointSpeedPair.html">PointSpeedPair</a> &gt; &amp;points, double time_span)</td></tr>
<tr class="memdesc:af509efce135492493e13c9bb86329dcd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reduces the input points to only those points that fit within the provided time boundary.  <a href="namespacebasic__autonomy_1_1waypoint__generation.html#af509efce135492493e13c9bb86329dcd">More...</a><br /></td></tr>
<tr class="separator:af509efce135492493e13c9bb86329dcd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9dd6a1f0fa9c6f6590b83a7cc2e0d118"><td class="memItemLeft" align="right" valign="top">std::pair&lt; double, size_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasic__autonomy_1_1waypoint__generation.html#a9dd6a1f0fa9c6f6590b83a7cc2e0d118">min_with_exclusions</a> (const std::vector&lt; double &gt; &amp;values, const std::unordered_set&lt; size_t &gt; &amp;excluded)</td></tr>
<tr class="memdesc:a9dd6a1f0fa9c6f6590b83a7cc2e0d118"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the min, and its idx, from the vector of values, excluding given set of values.  <a href="namespacebasic__autonomy_1_1waypoint__generation.html#a9dd6a1f0fa9c6f6590b83a7cc2e0d118">More...</a><br /></td></tr>
<tr class="separator:a9dd6a1f0fa9c6f6590b83a7cc2e0d118"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84a6c11da2d9736a8f277b6afd124100"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasic__autonomy_1_1waypoint__generation.html#a84a6c11da2d9736a8f277b6afd124100">optimize_speed</a> (const std::vector&lt; double &gt; &amp;downtracks, const std::vector&lt; double &gt; &amp;curv_speeds, double accel_limit)</td></tr>
<tr class="memdesc:a84a6c11da2d9736a8f277b6afd124100"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies the longitudinal acceleration limit to each point's speed.  <a href="namespacebasic__autonomy_1_1waypoint__generation.html#a84a6c11da2d9736a8f277b6afd124100">More...</a><br /></td></tr>
<tr class="separator:a84a6c11da2d9736a8f277b6afd124100"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba6a29cdaf0c4af10647b59bf6df4e01"><td class="memItemLeft" align="right" valign="top">std::vector&lt; carma_planning_msgs::msg::TrajectoryPlanPoint &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasic__autonomy_1_1waypoint__generation.html#aba6a29cdaf0c4af10647b59bf6df4e01">trajectory_from_points_times_orientations</a> (const std::vector&lt; lanelet::BasicPoint2d &gt; &amp;points, const std::vector&lt; double &gt; &amp;times, const std::vector&lt; double &gt; &amp;yaws, rclcpp::Time startTime, const std::string &amp;desired_controller_plugin)</td></tr>
<tr class="memdesc:aba6a29cdaf0c4af10647b59bf6df4e01"><td class="mdescLeft">&#160;</td><td class="mdescRight">Method combines input points, times, orientations, and an absolute start time to form a valid carma platform trajectory.  <a href="namespacebasic__autonomy_1_1waypoint__generation.html#aba6a29cdaf0c4af10647b59bf6df4e01">More...</a><br /></td></tr>
<tr class="separator:aba6a29cdaf0c4af10647b59bf6df4e01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9a705cca66d75f0d2d8ce9e6ea2ee41"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1PointSpeedPair.html">PointSpeedPair</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasic__autonomy_1_1waypoint__generation.html#af9a705cca66d75f0d2d8ce9e6ea2ee41">attach_past_points</a> (const std::vector&lt; <a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1PointSpeedPair.html">PointSpeedPair</a> &gt; &amp;points_set, std::vector&lt; <a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1PointSpeedPair.html">PointSpeedPair</a> &gt; future_points, const <a class="el" href="classint.html">int</a> nearest_pt_index, double back_distance)</td></tr>
<tr class="memdesc:af9a705cca66d75f0d2d8ce9e6ea2ee41"><td class="mdescLeft">&#160;</td><td class="mdescRight">Attaches back_distance length of points behind the future points.  <a href="namespacebasic__autonomy_1_1waypoint__generation.html#af9a705cca66d75f0d2d8ce9e6ea2ee41">More...</a><br /></td></tr>
<tr class="separator:af9a705cca66d75f0d2d8ce9e6ea2ee41"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e0eab343d21d18c665083839d706f04"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classbasic__autonomy_1_1smoothing_1_1SplineI.html">basic_autonomy::smoothing::SplineI</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasic__autonomy_1_1waypoint__generation.html#a9e0eab343d21d18c665083839d706f04">compute_fit</a> (const std::vector&lt; lanelet::BasicPoint2d &gt; &amp;basic_points)</td></tr>
<tr class="memdesc:a9e0eab343d21d18c665083839d706f04"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes a spline based on the provided points.  <a href="namespacebasic__autonomy_1_1waypoint__generation.html#a9e0eab343d21d18c665083839d706f04">More...</a><br /></td></tr>
<tr class="separator:a9e0eab343d21d18c665083839d706f04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4ca284ba04f4f76fb88bf8d20731835"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasic__autonomy_1_1waypoint__generation.html#ae4ca284ba04f4f76fb88bf8d20731835">compute_curvature_at</a> (const <a class="el" href="classbasic__autonomy_1_1smoothing_1_1SplineI.html">basic_autonomy::smoothing::SplineI</a> &amp;fit_curve, double step_along_the_curve)</td></tr>
<tr class="memdesc:ae4ca284ba04f4f76fb88bf8d20731835"><td class="mdescLeft">&#160;</td><td class="mdescRight">Given the curvature fit, computes the curvature at the given step along the curve.  <a href="namespacebasic__autonomy_1_1waypoint__generation.html#ae4ca284ba04f4f76fb88bf8d20731835">More...</a><br /></td></tr>
<tr class="separator:ae4ca284ba04f4f76fb88bf8d20731835"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acdcd3bb44d31aa6405b30f151ea35ae4"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1PointSpeedPair.html">PointSpeedPair</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasic__autonomy_1_1waypoint__generation.html#acdcd3bb44d31aa6405b30f151ea35ae4">create_geometry_profile</a> (const std::vector&lt; carma_planning_msgs::msg::Maneuver &gt; &amp;maneuvers, double max_starting_downtrack, const <a class="el" href="namespacecarma__wm.html#a3ac653959e0b6198cae274d68b343228">carma_wm::WorldModelConstPtr</a> &amp;wm, carma_planning_msgs::msg::VehicleState &amp;ending_state_before_buffer, const carma_planning_msgs::msg::VehicleState &amp;state, const <a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1GeneralTrajConfig.html">GeneralTrajConfig</a> &amp;general_config, const <a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html">DetailedTrajConfig</a> &amp;detailed_config)</td></tr>
<tr class="memdesc:acdcd3bb44d31aa6405b30f151ea35ae4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates geometry profile to return a point speed pair struct for LANE FOLLOW and LANE CHANGE maneuver types.  <a href="namespacebasic__autonomy_1_1waypoint__generation.html#acdcd3bb44d31aa6405b30f151ea35ae4">More...</a><br /></td></tr>
<tr class="separator:acdcd3bb44d31aa6405b30f151ea35ae4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3500af9146c0d9c80cb1b4101be01e5"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1PointSpeedPair.html">PointSpeedPair</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasic__autonomy_1_1waypoint__generation.html#aa3500af9146c0d9c80cb1b4101be01e5">create_lanefollow_geometry</a> (const carma_planning_msgs::msg::Maneuver &amp;maneuver, double max_starting_downtrack, const <a class="el" href="namespacecarma__wm.html#a3ac653959e0b6198cae274d68b343228">carma_wm::WorldModelConstPtr</a> &amp;wm, const <a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1GeneralTrajConfig.html">GeneralTrajConfig</a> &amp;general_config, const <a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html">DetailedTrajConfig</a> &amp;detailed_config, std::unordered_set&lt; lanelet::Id &gt; &amp;visited_lanelets)</td></tr>
<tr class="memdesc:aa3500af9146c0d9c80cb1b4101be01e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts a set of requested LANE_FOLLOWING maneuvers to point speed limit pairs.  <a href="namespacebasic__autonomy_1_1waypoint__generation.html#aa3500af9146c0d9c80cb1b4101be01e5">More...</a><br /></td></tr>
<tr class="separator:aa3500af9146c0d9c80cb1b4101be01e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad56958ee3bb11064df00a37cbf948b8d"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1PointSpeedPair.html">PointSpeedPair</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasic__autonomy_1_1waypoint__generation.html#ad56958ee3bb11064df00a37cbf948b8d">add_lanefollow_buffer</a> (const <a class="el" href="namespacecarma__wm.html#a3ac653959e0b6198cae274d68b343228">carma_wm::WorldModelConstPtr</a> &amp;wm, std::vector&lt; <a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1PointSpeedPair.html">PointSpeedPair</a> &gt; &amp;points_and_target_speeds, const std::vector&lt; carma_planning_msgs::msg::Maneuver &gt; &amp;maneuvers, carma_planning_msgs::msg::VehicleState &amp;ending_state_before_buffer, const <a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html">DetailedTrajConfig</a> &amp;detailed_config)</td></tr>
<tr class="memdesc:ad56958ee3bb11064df00a37cbf948b8d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds extra centerline points beyond required message length to lane follow maneuver points so that there's always enough points to calculate trajectory (BUFFER POINTS SHOULD BE REMOVED BEFORE RETURNING FINAL TRAJECTORY)  <a href="namespacebasic__autonomy_1_1waypoint__generation.html#ad56958ee3bb11064df00a37cbf948b8d">More...</a><br /></td></tr>
<tr class="separator:ad56958ee3bb11064df00a37cbf948b8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad633c0c515eae2b1752ad96031e01ef8"><td class="memItemLeft" align="right" valign="top">std::vector&lt; carma_planning_msgs::msg::TrajectoryPlanPoint &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasic__autonomy_1_1waypoint__generation.html#ad633c0c515eae2b1752ad96031e01ef8">compose_lanefollow_trajectory_from_path</a> (const std::vector&lt; <a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1PointSpeedPair.html">PointSpeedPair</a> &gt; &amp;points, const carma_planning_msgs::msg::VehicleState &amp;state, const rclcpp::Time &amp;state_time, const <a class="el" href="namespacecarma__wm.html#a3ac653959e0b6198cae274d68b343228">carma_wm::WorldModelConstPtr</a> &amp;wm, const carma_planning_msgs::msg::VehicleState &amp;ending_state_before_buffer, carma_debug_ros2_msgs::msg::TrajectoryCurvatureSpeeds &amp;debug_msg, const <a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html">DetailedTrajConfig</a> &amp;detailed_config)</td></tr>
<tr class="memdesc:ad633c0c515eae2b1752ad96031e01ef8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Method converts a list of lanelet centerline points and current vehicle state into a usable list of trajectory points for trajectory planning for a Lane following maneuver.  <a href="namespacebasic__autonomy_1_1waypoint__generation.html#ad633c0c515eae2b1752ad96031e01ef8">More...</a><br /></td></tr>
<tr class="separator:ad633c0c515eae2b1752ad96031e01ef8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af992a6cbbdafd6e86d73976a65164e94"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1PointSpeedPair.html">PointSpeedPair</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasic__autonomy_1_1waypoint__generation.html#af992a6cbbdafd6e86d73976a65164e94">get_lanechange_points_from_maneuver</a> (const carma_planning_msgs::msg::Maneuver &amp;maneuver, double max_starting_downtrack, const <a class="el" href="namespacecarma__wm.html#a3ac653959e0b6198cae274d68b343228">carma_wm::WorldModelConstPtr</a> &amp;wm, carma_planning_msgs::msg::VehicleState &amp;ending_state_before_buffer, const carma_planning_msgs::msg::VehicleState &amp;state, const <a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1GeneralTrajConfig.html">GeneralTrajConfig</a> &amp;general_config, const <a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html">DetailedTrajConfig</a> &amp;detailed_config)</td></tr>
<tr class="memdesc:af992a6cbbdafd6e86d73976a65164e94"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts a set of requested LANE_CHANGE maneuvers to point speed limit pairs.  <a href="namespacebasic__autonomy_1_1waypoint__generation.html#af992a6cbbdafd6e86d73976a65164e94">More...</a><br /></td></tr>
<tr class="separator:af992a6cbbdafd6e86d73976a65164e94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2219ab96db87781023137bdb45af1ea2"><td class="memItemLeft" align="right" valign="top">std::vector&lt; lanelet::BasicPoint2d &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasic__autonomy_1_1waypoint__generation.html#a2219ab96db87781023137bdb45af1ea2">create_lanechange_geometry</a> (lanelet::Id starting_lane_id, lanelet::Id ending_lane_id, double starting_downtrack, double ending_downtrack, const <a class="el" href="namespacecarma__wm.html#a3ac653959e0b6198cae274d68b343228">carma_wm::WorldModelConstPtr</a> &amp;wm, <a class="el" href="classint.html">int</a> downsample_ratio, double buffer_ending_downtrack)</td></tr>
<tr class="memdesc:a2219ab96db87781023137bdb45af1ea2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a vector of lane change points using parameters defined.  <a href="namespacebasic__autonomy_1_1waypoint__generation.html#a2219ab96db87781023137bdb45af1ea2">More...</a><br /></td></tr>
<tr class="separator:a2219ab96db87781023137bdb45af1ea2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19cf5cf882789e1e9ed3e92d0105a8de"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; lanelet::BasicPoint2d &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasic__autonomy_1_1waypoint__generation.html#a19cf5cf882789e1e9ed3e92d0105a8de">resample_linestring_pair_to_same_size</a> (std::vector&lt; lanelet::BasicPoint2d &gt; &amp;line_1, std::vector&lt; lanelet::BasicPoint2d &gt; &amp;line_2)</td></tr>
<tr class="memdesc:a19cf5cf882789e1e9ed3e92d0105a8de"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resamples a pair of basicpoint2d lines to get lines of same number of points.  <a href="namespacebasic__autonomy_1_1waypoint__generation.html#a19cf5cf882789e1e9ed3e92d0105a8de">More...</a><br /></td></tr>
<tr class="separator:a19cf5cf882789e1e9ed3e92d0105a8de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a741942c16ca54212b9adf3ddc2eea66d"><td class="memItemLeft" align="right" valign="top">std::vector&lt; carma_planning_msgs::msg::TrajectoryPlanPoint &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasic__autonomy_1_1waypoint__generation.html#a741942c16ca54212b9adf3ddc2eea66d">compose_lanechange_trajectory_from_path</a> (const std::vector&lt; <a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1PointSpeedPair.html">PointSpeedPair</a> &gt; &amp;points, const carma_planning_msgs::msg::VehicleState &amp;state, const rclcpp::Time &amp;state_time, const <a class="el" href="namespacecarma__wm.html#a3ac653959e0b6198cae274d68b343228">carma_wm::WorldModelConstPtr</a> &amp;wm, const carma_planning_msgs::msg::VehicleState &amp;ending_state_before_buffer, const <a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html">DetailedTrajConfig</a> &amp;detailed_config)</td></tr>
<tr class="memdesc:a741942c16ca54212b9adf3ddc2eea66d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Method converts a list of lanelet centerline points and current vehicle state into a usable list of trajectory points for trajectory planning for a Lane following maneuver.  <a href="namespacebasic__autonomy_1_1waypoint__generation.html#a741942c16ca54212b9adf3ddc2eea66d">More...</a><br /></td></tr>
<tr class="separator:a741942c16ca54212b9adf3ddc2eea66d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9876518513a13a569a63f225013b686f"><td class="memItemLeft" align="right" valign="top">std::vector&lt; lanelet::BasicPoint2d &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasic__autonomy_1_1waypoint__generation.html#a9876518513a13a569a63f225013b686f">create_route_geom</a> (double starting_downtrack, <a class="el" href="classint.html">int</a> starting_lane_id, double ending_downtrack, const <a class="el" href="namespacecarma__wm.html#a3ac653959e0b6198cae274d68b343228">carma_wm::WorldModelConstPtr</a> &amp;wm)</td></tr>
<tr class="memdesc:a9876518513a13a569a63f225013b686f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a Lanelet2 Linestring from a vector or points along the geometry.  <a href="namespacebasic__autonomy_1_1waypoint__generation.html#a9876518513a13a569a63f225013b686f">More...</a><br /></td></tr>
<tr class="separator:a9876518513a13a569a63f225013b686f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1466a3966dee2e7bfb71ac6f7e62e5b"><td class="memItemLeft" align="right" valign="top">lanelet::BasicLineString2d&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasic__autonomy_1_1waypoint__generation.html#aa1466a3966dee2e7bfb71ac6f7e62e5b">create_lanechange_path</a> (const lanelet::ConstLanelet &amp;start_lanelet, const lanelet::ConstLanelet &amp;end_lanelet)</td></tr>
<tr class="memdesc:aa1466a3966dee2e7bfb71ac6f7e62e5b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Given a start and end point, create a vector of points fit through a spline between the points (using a Spline library)  <a href="namespacebasic__autonomy_1_1waypoint__generation.html#aa1466a3966dee2e7bfb71ac6f7e62e5b">More...</a><br /></td></tr>
<tr class="separator:aa1466a3966dee2e7bfb71ac6f7e62e5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8be61ccb69db73e2e70d5e59f88ce446"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html">DetailedTrajConfig</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasic__autonomy_1_1waypoint__generation.html#a8be61ccb69db73e2e70d5e59f88ce446">compose_detailed_trajectory_config</a> (double trajectory_time_length, double curve_resample_step_size, double minimum_speed, double max_accel, double lateral_accel_limit, <a class="el" href="classint.html">int</a> speed_moving_average_window_size, <a class="el" href="classint.html">int</a> curvature_moving_average_window_size, double back_distance, double buffer_ending_downtrack, std::string desired_controller_plugin=&quot;default&quot;)</td></tr>
<tr class="separator:a8be61ccb69db73e2e70d5e59f88ce446"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11b8eae5903a23ecab69c2f814c1bcf8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1GeneralTrajConfig.html">GeneralTrajConfig</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasic__autonomy_1_1waypoint__generation.html#a11b8eae5903a23ecab69c2f814c1bcf8">compose_general_trajectory_config</a> (const std::string &amp;trajectory_type, <a class="el" href="classint.html">int</a> default_downsample_ratio, <a class="el" href="classint.html">int</a> turn_downsample_ratio)</td></tr>
<tr class="separator:a11b8eae5903a23ecab69c2f814c1bcf8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef0a6b216ad0be7289773e54843f747b"><td class="memItemLeft" align="right" valign="top">autoware_auto_msgs::msg::Trajectory&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasic__autonomy_1_1waypoint__generation.html#aef0a6b216ad0be7289773e54843f747b">process_trajectory_plan</a> (const carma_planning_msgs::msg::TrajectoryPlan &amp;tp, double vehicle_response_lag)</td></tr>
<tr class="memdesc:aef0a6b216ad0be7289773e54843f747b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Given a carma type of trajectory_plan, generate autoware type of trajectory accounting for speed_lag and stopping case Generated trajectory is meant to be used in autoware.auto's pure_pursuit library using set_trajectory() function.  <a href="namespacebasic__autonomy_1_1waypoint__generation.html#aef0a6b216ad0be7289773e54843f747b">More...</a><br /></td></tr>
<tr class="separator:aef0a6b216ad0be7289773e54843f747b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c66a834de5e4a066c8c9011e25f8e71"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasic__autonomy_1_1waypoint__generation.html#a3c66a834de5e4a066c8c9011e25f8e71">apply_response_lag</a> (const std::vector&lt; double &gt; &amp;speeds, const std::vector&lt; double &gt; downtracks, double response_lag)</td></tr>
<tr class="memdesc:a3c66a834de5e4a066c8c9011e25f8e71"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies a specified response lag in seconds to the trajectory shifting the whole thing by the specified lag time.  <a href="namespacebasic__autonomy_1_1waypoint__generation.html#a3c66a834de5e4a066c8c9011e25f8e71">More...</a><br /></td></tr>
<tr class="separator:a3c66a834de5e4a066c8c9011e25f8e71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a924ac023f1b51e791ca1b61b9194f44a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classint.html">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasic__autonomy_1_1waypoint__generation.html#a924ac023f1b51e791ca1b61b9194f44a">get_nearest_point_index</a> (const std::vector&lt; lanelet::BasicPoint2d &gt; &amp;points, const carma_planning_msgs::msg::VehicleState &amp;state)</td></tr>
<tr class="memdesc:a924ac023f1b51e791ca1b61b9194f44a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the nearest point (in terms of cartesian 2d distance) to the provided vehicle pose in the provided l.  <a href="namespacebasic__autonomy_1_1waypoint__generation.html#a924ac023f1b51e791ca1b61b9194f44a">More...</a><br /></td></tr>
<tr class="separator:a924ac023f1b51e791ca1b61b9194f44a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ef24fc9ed2fb1aeccb039313bdf858c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classint.html">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasic__autonomy_1_1waypoint__generation.html#a9ef24fc9ed2fb1aeccb039313bdf858c">get_nearest_point_index</a> (const std::vector&lt; <a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1PointSpeedPair.html">PointSpeedPair</a> &gt; &amp;points, const carma_planning_msgs::msg::VehicleState &amp;state)</td></tr>
<tr class="memdesc:a9ef24fc9ed2fb1aeccb039313bdf858c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the nearest point (in terms of cartesian 2d distance) to the provided vehicle pose in the provided list.  <a href="namespacebasic__autonomy_1_1waypoint__generation.html#a9ef24fc9ed2fb1aeccb039313bdf858c">More...</a><br /></td></tr>
<tr class="separator:a9ef24fc9ed2fb1aeccb039313bdf858c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa399a236f88f7b1c5557327fbb2ba71a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classint.html">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasic__autonomy_1_1waypoint__generation.html#aa399a236f88f7b1c5557327fbb2ba71a">get_nearest_index_by_downtrack</a> (const std::vector&lt; lanelet::BasicPoint2d &gt; &amp;points, const <a class="el" href="namespacecarma__wm.html#a3ac653959e0b6198cae274d68b343228">carma_wm::WorldModelConstPtr</a> &amp;wm, double target_downtrack)</td></tr>
<tr class="memdesc:aa399a236f88f7b1c5557327fbb2ba71a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the nearest "less than" point to the provided vehicle pose in the provided list by utilizing the downtrack measured along the route NOTE: This function compares the downtrack, provided by routeTrackPos, of each points in the list to get the closest one to the given point's downtrack. Therefore, it is rather costlier method than comparing cartesian distance between the points and getting the closest. This way, however, the function correctly returns the end point's index if the given state, despite being valid, is farther than the given points and can technically be near any of them.  <a href="namespacebasic__autonomy_1_1waypoint__generation.html#aa399a236f88f7b1c5557327fbb2ba71a">More...</a><br /></td></tr>
<tr class="separator:aa399a236f88f7b1c5557327fbb2ba71a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f07faaac8c54cc485f2bb217097326e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasic__autonomy_1_1waypoint__generation.html#a0f07faaac8c54cc485f2bb217097326e">split_point_speed_pairs</a> (const std::vector&lt; <a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1PointSpeedPair.html">PointSpeedPair</a> &gt; &amp;points, std::vector&lt; lanelet::BasicPoint2d &gt; *basic_points, std::vector&lt; double &gt; *speeds)</td></tr>
<tr class="memdesc:a0f07faaac8c54cc485f2bb217097326e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper method to split a list of <a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1PointSpeedPair.html">PointSpeedPair</a> into separate point and speed lists.  <a href="namespacebasic__autonomy_1_1waypoint__generation.html#a0f07faaac8c54cc485f2bb217097326e">More...</a><br /></td></tr>
<tr class="separator:a0f07faaac8c54cc485f2bb217097326e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51d5d768864d9632b6c59acddbb804a6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classint.html">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasic__autonomy_1_1waypoint__generation.html#a51d5d768864d9632b6c59acddbb804a6">get_nearest_index_by_downtrack</a> (const std::vector&lt; <a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1PointSpeedPair.html">PointSpeedPair</a> &gt; &amp;points, const <a class="el" href="namespacecarma__wm.html#a3ac653959e0b6198cae274d68b343228">carma_wm::WorldModelConstPtr</a> &amp;wm, const carma_planning_msgs::msg::VehicleState &amp;state)</td></tr>
<tr class="memdesc:a51d5d768864d9632b6c59acddbb804a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Overload: Returns the nearest point to the provided vehicle pose in the provided list by utilizing the downtrack measured along the route NOTE: This function compares the downtrack, provided by routeTrackPos, of each points in the list to get the closest one to the given point's downtrack. Therefore, it is rather costlier method than comparing cartesian distance between the points and getting the closest. This way, however, the function correctly returns the end point's index if the given state, despite being valid, is farther than the given points and can technically be near any of them.  <a href="namespacebasic__autonomy_1_1waypoint__generation.html#a51d5d768864d9632b6c59acddbb804a6">More...</a><br /></td></tr>
<tr class="separator:a51d5d768864d9632b6c59acddbb804a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a663da94d69d090be22675c21ec95fc6d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classint.html">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasic__autonomy_1_1waypoint__generation.html#a663da94d69d090be22675c21ec95fc6d">get_nearest_index_by_downtrack</a> (const std::vector&lt; lanelet::BasicPoint2d &gt; &amp;points, const <a class="el" href="namespacecarma__wm.html#a3ac653959e0b6198cae274d68b343228">carma_wm::WorldModelConstPtr</a> &amp;wm, const carma_planning_msgs::msg::VehicleState &amp;state)</td></tr>
<tr class="memdesc:a663da94d69d090be22675c21ec95fc6d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Overload: Returns the nearest point to the provided vehicle pose in the provided list by utilizing the downtrack measured along the route NOTE: This function compares the downtrack, provided by routeTrackPos, of each points in the list to get the closest one to the given point's downtrack. Therefore, it is rather costlier method than comparing cartesian distance between the points and getting the closest. This way, however, the function correctly returns the end point if the given state, despite being valid, is farther than the given points and can technically be near any of them.  <a href="namespacebasic__autonomy_1_1waypoint__generation.html#a663da94d69d090be22675c21ec95fc6d">More...</a><br /></td></tr>
<tr class="separator:a663da94d69d090be22675c21ec95fc6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a40f0df33d30f775890f99bef7a685e33"><td class="memItemLeft" align="right" valign="top">static const std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a> = &quot;basic_autonomy&quot;</td></tr>
<tr class="separator:a40f0df33d30f775890f99bef7a685e33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05408c147e288f4120ad1a8c90dd3241"><td class="memItemLeft" align="right" valign="top">const double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasic__autonomy_1_1waypoint__generation.html#a05408c147e288f4120ad1a8c90dd3241">epsilon_</a> = 0.0000001</td></tr>
<tr class="separator:a05408c147e288f4120ad1a8c90dd3241"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="ad56958ee3bb11064df00a37cbf948b8d" name="ad56958ee3bb11064df00a37cbf948b8d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad56958ee3bb11064df00a37cbf948b8d">&#9670;&nbsp;</a></span>add_lanefollow_buffer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1PointSpeedPair.html">PointSpeedPair</a> &gt; basic_autonomy::waypoint_generation::add_lanefollow_buffer </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacecarma__wm.html#a3ac653959e0b6198cae274d68b343228">carma_wm::WorldModelConstPtr</a> &amp;&#160;</td>
          <td class="paramname"><em>wm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1PointSpeedPair.html">PointSpeedPair</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>points_and_target_speeds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; carma_planning_msgs::msg::Maneuver &gt; &amp;&#160;</td>
          <td class="paramname"><em>maneuvers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">carma_planning_msgs::msg::VehicleState &amp;&#160;</td>
          <td class="paramname"><em>ending_state_before_buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html">DetailedTrajConfig</a> &amp;&#160;</td>
          <td class="paramname"><em>detailed_config</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds extra centerline points beyond required message length to lane follow maneuver points so that there's always enough points to calculate trajectory (BUFFER POINTS SHOULD BE REMOVED BEFORE RETURNING FINAL TRAJECTORY) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">wm</td><td>Pointer to intialized world model for semantic map access </td></tr>
    <tr><td class="paramname">points_and_target_speeds</td><td>set of lane follow maneuver points to which buffer is added </td></tr>
    <tr><td class="paramname">maneuvers</td><td>The list of lane follow maneuvers which were converted to geometry points and associated speed </td></tr>
    <tr><td class="paramname">ending_state_before_buffer</td><td>reference to Vehicle state, which is state before applying extra points for curvature calculation that are removed later </td></tr>
    <tr><td class="paramname">detailed_config</td><td>Basic autonomy struct defined to load detailed config parameters from tactical plugins</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>List of centerline points paired with speed limits returned with added buffer </dd></dl>

<p class="definition">Definition at line <a class="el" href="basic__autonomy_8cpp_source.html#l00225">225</a> of file <a class="el" href="basic__autonomy_8cpp_source.html">basic_autonomy.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  226</span>                                                                                                                       {</div>
<div class="line"><span class="lineno">  227</span>            </div>
<div class="line"><span class="lineno">  228</span> </div>
<div class="line"><span class="lineno">  229</span>            <span class="keywordtype">double</span> starting_route_downtrack = wm-&gt;routeTrackPos(points_and_target_speeds.front().point).downtrack;</div>
<div class="line"><span class="lineno">  230</span> </div>
<div class="line"><span class="lineno">  231</span>            <span class="comment">// Always try to add the maximum buffer. Even if the route ends it may still be possible to add buffered points.</span></div>
<div class="line"><span class="lineno">  232</span>            <span class="comment">// This does mean that downstream components might not be able to assume the buffer points are on the route </span></div>
<div class="line"><span class="lineno">  233</span>            <span class="comment">// though this is not likely to be an issue as they are buffer only</span></div>
<div class="line"><span class="lineno">  234</span>            <span class="keywordtype">double</span> ending_downtrack = maneuvers.back().lane_following_maneuver.end_dist + detailed_config.<a class="code hl_variable" href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html#ae2456fd9c7e752615b59ec444c8c28ee">buffer_ending_downtrack</a>;</div>
<div class="line"><span class="lineno">  235</span> </div>
<div class="line"><span class="lineno">  236</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;Add lanefollow buffer: ending_downtrack: &quot;</span> &lt;&lt; ending_downtrack &lt;&lt; <span class="stringliteral">&quot;, maneuvers.back().lane_following_maneuver.end_dist: &quot;</span> &lt;&lt; maneuvers.back().lane_following_maneuver.end_dist &lt;&lt;</div>
<div class="line"><span class="lineno">  237</span>                            <span class="stringliteral">&quot;, detailed_config.buffer_ending_downtrack: &quot;</span> &lt;&lt; detailed_config.<a class="code hl_variable" href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html#ae2456fd9c7e752615b59ec444c8c28ee">buffer_ending_downtrack</a>);</div>
<div class="line"><span class="lineno">  238</span> </div>
<div class="line"><span class="lineno">  239</span>            <span class="keywordtype">size_t</span> max_i = points_and_target_speeds.size() - 1;</div>
<div class="line"><span class="lineno">  240</span>            <span class="keywordtype">size_t</span> unbuffered_idx = points_and_target_speeds.size() - 1;</div>
<div class="line"><span class="lineno">  241</span>            <span class="keywordtype">bool</span> found_unbuffered_idx = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  242</span>            <span class="keywordtype">double</span> dist_accumulator = starting_route_downtrack;</div>
<div class="line"><span class="lineno">  243</span>            lanelet::BasicPoint2d prev_point;</div>
<div class="line"><span class="lineno">  244</span> </div>
<div class="line"><span class="lineno">  245</span>            boost::optional&lt;lanelet::BasicPoint2d&gt; delta_point;</div>
<div class="line"><span class="lineno">  246</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> = 0; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> &lt; points_and_target_speeds.size(); ++<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>) {</div>
<div class="line"><span class="lineno">  247</span>                <span class="keyword">auto</span> current_point = points_and_target_speeds[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>].point;</div>
<div class="line"><span class="lineno">  248</span>                </div>
<div class="line"><span class="lineno">  249</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> == 0) {</div>
<div class="line"><span class="lineno">  250</span>                    prev_point = current_point;</div>
<div class="line"><span class="lineno">  251</span>                    <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  252</span>                }</div>
<div class="line"><span class="lineno">  253</span> </div>
<div class="line"><span class="lineno">  254</span>                <span class="keywordtype">double</span> delta_d = lanelet::geometry::distance2d(prev_point, current_point);</div>
<div class="line"><span class="lineno">  255</span> </div>
<div class="line"><span class="lineno">  256</span>                dist_accumulator += delta_d;</div>
<div class="line"><span class="lineno">  257</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;Index i: &quot;</span> &lt;&lt; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> &lt;&lt; <span class="stringliteral">&quot;, delta_d: &quot;</span> &lt;&lt; delta_d &lt;&lt; <span class="stringliteral">&quot;, dist_accumulator:&quot;</span> &lt;&lt; dist_accumulator &lt;&lt;<span class="stringliteral">&quot;, current_point.x():&quot;</span> &lt;&lt; current_point.x() &lt;&lt; </div>
<div class="line"><span class="lineno">  258</span>                <span class="stringliteral">&quot;current_point.y():&quot;</span> &lt;&lt; current_point.y());</div>
<div class="line"><span class="lineno">  259</span>                <span class="keywordflow">if</span> (dist_accumulator &gt; maneuvers.back().lane_following_maneuver.end_dist &amp;&amp; !found_unbuffered_idx)</div>
<div class="line"><span class="lineno">  260</span>                {</div>
<div class="line"><span class="lineno">  261</span>                    unbuffered_idx = <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> - 1;</div>
<div class="line"><span class="lineno">  262</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;Found index unbuffered_idx at: &quot;</span> &lt;&lt; unbuffered_idx);</div>
<div class="line"><span class="lineno">  263</span>                    found_unbuffered_idx = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  264</span>                }</div>
<div class="line"><span class="lineno">  265</span>                </div>
<div class="line"><span class="lineno">  266</span>                <span class="keywordflow">if</span> (dist_accumulator &gt; ending_downtrack) {</div>
<div class="line"><span class="lineno">  267</span>                    max_i = <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>;</div>
<div class="line"><span class="lineno">  268</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;Max_i breaking at: i: &quot;</span> &lt;&lt; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> &lt;&lt; <span class="stringliteral">&quot;, max_i: &quot;</span> &lt;&lt; max_i);</div>
<div class="line"><span class="lineno">  269</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  270</span>                }</div>
<div class="line"><span class="lineno">  271</span> </div>
<div class="line"><span class="lineno">  272</span>                <span class="comment">// If there are no more points to add but we haven&#39;t reached the ending downtrack then</span></div>
<div class="line"><span class="lineno">  273</span>                <span class="comment">// construct an extrapolated straight line from the final point and keep adding to this line until the downtrack is met</span></div>
<div class="line"><span class="lineno">  274</span>                <span class="comment">// Since this is purely needed to allow for a spline fit edge case, it should have minimal impact on the actual steering behavior of the vehicle</span></div>
<div class="line"><span class="lineno">  275</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> == points_and_target_speeds.size() - 1) <span class="comment">// dist_accumulator &lt; ending_downtrack is guaranteed by earlier conditional</span></div>
<div class="line"><span class="lineno">  276</span>                {</div>
<div class="line"><span class="lineno">  277</span> </div>
<div class="line"><span class="lineno">  278</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;Extending trajectory using buffer beyond end of target lanelet&quot;</span>);</div>
<div class="line"><span class="lineno">  279</span> </div>
<div class="line"><span class="lineno">  280</span>                    <span class="keywordflow">if</span> (!delta_point) { <span class="comment">// Set the step size based on last two points</span></div>
<div class="line"><span class="lineno">  281</span>                        delta_point = (current_point - prev_point) * 0.25; <span class="comment">// Use a smaller step size then default to help ensure enough points are generated;</span></div>
<div class="line"><span class="lineno">  282</span>                    }</div>
<div class="line"><span class="lineno">  283</span> </div>
<div class="line"><span class="lineno">  284</span>                    <span class="comment">// Create an extrapolated new point </span></div>
<div class="line"><span class="lineno">  285</span>                    <span class="keyword">auto</span> new_point = current_point + delta_point.get();</div>
<div class="line"><span class="lineno">  286</span> </div>
<div class="line"><span class="lineno">  287</span>                    <a class="code hl_typedef" href="namespacecooperative__lanechange.html#af2521f0bb23baab64641072110316a67">PointSpeedPair</a> new_pair;</div>
<div class="line"><span class="lineno">  288</span>                    new_pair.<a class="code hl_variable" href="structbasic__autonomy_1_1waypoint__generation_1_1PointSpeedPair.html#a628d9d3853745335b42ad940136d88ac">point</a> = new_point;</div>
<div class="line"><span class="lineno">  289</span>                    new_pair.speed = points_and_target_speeds.back().speed;</div>
<div class="line"><span class="lineno">  290</span> </div>
<div class="line"><span class="lineno">  291</span>                    points_and_target_speeds.push_back(new_pair);</div>
<div class="line"><span class="lineno">  292</span>                }</div>
<div class="line"><span class="lineno">  293</span> </div>
<div class="line"><span class="lineno">  294</span>                prev_point = current_point;</div>
<div class="line"><span class="lineno">  295</span>            }</div>
<div class="line"><span class="lineno">  296</span> </div>
<div class="line"><span class="lineno">  297</span>            ending_state_before_buffer.x_pos_global = points_and_target_speeds[unbuffered_idx].point.x();</div>
<div class="line"><span class="lineno">  298</span>            ending_state_before_buffer.y_pos_global = points_and_target_speeds[unbuffered_idx].point.y();</div>
<div class="line"><span class="lineno">  299</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;Here ending_state_before_buffer.x_pos_global: &quot;</span> &lt;&lt; ending_state_before_buffer.x_pos_global &lt;&lt; </div>
<div class="line"><span class="lineno">  300</span>            <span class="stringliteral">&quot;, and y_pos_global&quot;</span> &lt;&lt; ending_state_before_buffer.y_pos_global);</div>
<div class="line"><span class="lineno">  301</span> </div>
<div class="line"><span class="lineno">  302</span>            std::vector&lt;PointSpeedPair&gt; constrained_points(points_and_target_speeds.begin(), points_and_target_speeds.begin() + max_i);</div>
<div class="line"><span class="lineno">  303</span> </div>
<div class="line"><span class="lineno">  304</span>            <span class="keywordflow">return</span> constrained_points;</div>
<div class="line"><span class="lineno">  305</span>        }</div>
<div class="ttc" id="anamespacebasic__autonomy_1_1waypoint__generation_html_a40f0df33d30f775890f99bef7a685e33"><div class="ttname"><a href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">basic_autonomy::waypoint_generation::BASIC_AUTONOMY_LOGGER</a></div><div class="ttdeci">static const std::string BASIC_AUTONOMY_LOGGER</div><div class="ttdef"><b>Definition:</b> <a href="basic__autonomy_8hpp_source.html#l00062">basic_autonomy.hpp:62</a></div></div>
<div class="ttc" id="anamespacecooperative__lanechange_html_af2521f0bb23baab64641072110316a67"><div class="ttname"><a href="namespacecooperative__lanechange.html#af2521f0bb23baab64641072110316a67">cooperative_lanechange::PointSpeedPair</a></div><div class="ttdeci">basic_autonomy::waypoint_generation::PointSpeedPair PointSpeedPair</div><div class="ttdef"><b>Definition:</b> <a href="cooperative__lanechange__node_8hpp_source.html#l00048">cooperative_lanechange_node.hpp:48</a></div></div>
<div class="ttc" id="anamespaceprocess__bag_html_af102a02c97622dd30b0dbf7bafb0d199"><div class="ttname"><a href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">process_bag.i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="process__bag_8py_source.html#l00059">process_bag.py:59</a></div></div>
<div class="ttc" id="astructbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig_html_ae2456fd9c7e752615b59ec444c8c28ee"><div class="ttname"><a href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html#ae2456fd9c7e752615b59ec444c8c28ee">basic_autonomy::waypoint_generation::DetailedTrajConfig::buffer_ending_downtrack</a></div><div class="ttdeci">double buffer_ending_downtrack</div><div class="ttdef"><b>Definition:</b> <a href="basic__autonomy_8hpp_source.html#l00089">basic_autonomy.hpp:89</a></div></div>
<div class="ttc" id="astructbasic__autonomy_1_1waypoint__generation_1_1PointSpeedPair_html_a628d9d3853745335b42ad940136d88ac"><div class="ttname"><a href="structbasic__autonomy_1_1waypoint__generation_1_1PointSpeedPair.html#a628d9d3853745335b42ad940136d88ac">basic_autonomy::waypoint_generation::PointSpeedPair::point</a></div><div class="ttdeci">lanelet::BasicPoint2d point</div><div class="ttdef"><b>Definition:</b> <a href="basic__autonomy_8hpp_source.html#l00066">basic_autonomy.hpp:66</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="basic__autonomy_8hpp_source.html#l00062">BASIC_AUTONOMY_LOGGER</a>, <a class="el" href="basic__autonomy_8hpp_source.html#l00089">basic_autonomy::waypoint_generation::DetailedTrajConfig::buffer_ending_downtrack</a>, <a class="el" href="process__bag_8py_source.html#l00059">process_bag::i</a>, <a class="el" href="basic__autonomy_8hpp_source.html#l00066">basic_autonomy::waypoint_generation::PointSpeedPair::point</a>, and <a class="el" href="basic__autonomy_8hpp_source.html#l00067">basic_autonomy::waypoint_generation::PointSpeedPair::speed</a>.</p>

<p class="reference">Referenced by <a class="el" href="basic__autonomy_8cpp_source.html#l00024">create_geometry_profile()</a>, and <a class="el" href="light__controlled__intersection__tactical__plugin_8cpp_source.html#l00386">light_controlled_intersection_tactical_plugin::LightControlledIntersectionTacticalPlugin::createGeometryProfile()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebasic__autonomy_1_1waypoint__generation_ad56958ee3bb11064df00a37cbf948b8d_icgraph.png" border="0" usemap="#anamespacebasic__autonomy_1_1waypoint__generation_ad56958ee3bb11064df00a37cbf948b8d_icgraph" alt=""/></div>
<map name="anamespacebasic__autonomy_1_1waypoint__generation_ad56958ee3bb11064df00a37cbf948b8d_icgraph" id="anamespacebasic__autonomy_1_1waypoint__generation_ad56958ee3bb11064df00a37cbf948b8d_icgraph">
<area shape="rect" title="Adds extra centerline points beyond required message length to lane follow maneuver points so that th..." alt="" coords="940,173,1160,214"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#acdcd3bb44d31aa6405b30f151ea35ae4" title="Creates geometry profile to return a point speed pair struct for LANE FOLLOW and LANE CHANGE maneuver..." alt="" coords="643,125,834,181"/>
<area shape="rect" href="classlight__controlled__intersection__tactical__plugin_1_1LightControlledIntersectionTacticalPlugin.html#afee417a4310729540055e6c6f35eeccf" title="Creates geometry profile to return a point speed pair struct for INTERSECTION_TRANSIT maneuver types ..." alt="" coords="585,205,892,261"/>
<area shape="rect" href="classcooperative__lanechange_1_1CooperativeLaneChangePlugin.html#a5f0c14a409d58d6b1750c38c6bf1b34a" title="Creates a vector of Trajectory Points from maneuver information in trajectory request." alt="" coords="295,5,502,61"/>
<area shape="rect" href="classinlanecruising__plugin_1_1InLaneCruisingPlugin.html#a60f695c3ed54c99c6a2dcfaf77ae55e2" title="Service callback for trajectory planning." alt="" coords="315,85,482,141"/>
<area shape="rect" href="classplatooning__tactical__plugin_1_1PlatooningTacticalPlugin.html#aee3afe082ccd5ab937dbb1c49f9e21ff" title="Service callback for trajectory planning." alt="" coords="311,165,487,221"/>
<area shape="rect" href="classcooperative__lanechange_1_1CooperativeLaneChangePlugin.html#a8913539d8614e509910af225e18bc809" title="Extending class provided callback which should return a planned trajectory based on the provided traj..." alt="" coords="5,5,212,61"/>
<area shape="rect" href="classlight__controlled__intersection__tactical__plugin_1_1LightControlledIntersectionTacticalPlugin.html#a124f95825dfb2728fefa245e6a0e1db7" title="Function to process the light controlled intersection tactical plugin service call for trajectory pla..." alt="" coords="260,245,537,301"/>
</map>
</div>

</div>
</div>
<a id="a3c66a834de5e4a066c8c9011e25f8e71" name="a3c66a834de5e4a066c8c9011e25f8e71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c66a834de5e4a066c8c9011e25f8e71">&#9670;&nbsp;</a></span>apply_response_lag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; double &gt; basic_autonomy::waypoint_generation::apply_response_lag </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>speeds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt;&#160;</td>
          <td class="paramname"><em>downtracks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>response_lag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Applies a specified response lag in seconds to the trajectory shifting the whole thing by the specified lag time. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">speeds</td><td>Velocity profile to shift. The first point should be the current vehicle speed </td></tr>
    <tr><td class="paramname">downtrack</td><td>Distance points for each velocity point. Should have the same size as speeds and start from 0 </td></tr>
    <tr><td class="paramname">response_lag</td><td>The lag in seconds before which the vehicle will not meaningfully accelerate</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A Shifted trajectory </dd></dl>

<p class="definition">Definition at line <a class="el" href="basic__autonomy_8cpp_source.html#l01260">1260</a> of file <a class="el" href="basic__autonomy_8cpp_source.html">basic_autonomy.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1261</span>        { <span class="comment">// Note first speed is assumed to be vehicle speed</span></div>
<div class="line"><span class="lineno"> 1262</span>            <span class="keywordflow">if</span> (speeds.size() != downtracks.size()) {</div>
<div class="line"><span class="lineno"> 1263</span>                <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;Speed list and downtrack list are not the same size.&quot;</span>);</div>
<div class="line"><span class="lineno"> 1264</span>            }</div>
<div class="line"><span class="lineno"> 1265</span> </div>
<div class="line"><span class="lineno"> 1266</span>            std::vector&lt;double&gt; output;</div>
<div class="line"><span class="lineno"> 1267</span>            <span class="keywordflow">if</span> (speeds.empty()) {</div>
<div class="line"><span class="lineno"> 1268</span>                <span class="keywordflow">return</span> output;</div>
<div class="line"><span class="lineno"> 1269</span>            }</div>
<div class="line"><span class="lineno"> 1270</span> </div>
<div class="line"><span class="lineno"> 1271</span>            <span class="keywordtype">double</span> lookahead_distance = speeds[0] * response_lag;</div>
<div class="line"><span class="lineno"> 1272</span> </div>
<div class="line"><span class="lineno"> 1273</span>            <span class="keywordtype">double</span> downtrack_cutoff = downtracks[0] + lookahead_distance;</div>
<div class="line"><span class="lineno"> 1274</span>            <span class="keywordtype">size_t</span> lookahead_count = std::lower_bound(downtracks.begin(),downtracks.end(), downtrack_cutoff) - downtracks.begin(); <span class="comment">// Use binary search to find lower bound cutoff point</span></div>
<div class="line"><span class="lineno"> 1275</span>            output = trajectory_utils::shift_by_lookahead(speeds, (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>) lookahead_count);</div>
<div class="line"><span class="lineno"> 1276</span>            <span class="keywordflow">return</span> output;</div>
<div class="line"><span class="lineno"> 1277</span>        }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="basic__autonomy_8cpp_source.html#l01184">process_trajectory_plan()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebasic__autonomy_1_1waypoint__generation_a3c66a834de5e4a066c8c9011e25f8e71_icgraph.png" border="0" usemap="#anamespacebasic__autonomy_1_1waypoint__generation_a3c66a834de5e4a066c8c9011e25f8e71_icgraph" alt=""/></div>
<map name="anamespacebasic__autonomy_1_1waypoint__generation_a3c66a834de5e4a066c8c9011e25f8e71_icgraph" id="anamespacebasic__autonomy_1_1waypoint__generation_a3c66a834de5e4a066c8c9011e25f8e71_icgraph">
<area shape="rect" title="Applies a specified response lag in seconds to the trajectory shifting the whole thing by the specifi..." alt="" coords="508,13,717,54"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#aef0a6b216ad0be7289773e54843f747b" title="Given a carma type of trajectory_plan, generate autoware type of trajectory accounting for speed_lag ..." alt="" coords="228,13,460,54"/>
<area shape="rect" href="classpure__pursuit__wrapper_1_1PurePursuitWrapperNode.html#a2f08ea5b6b48dd727292e1da2e28712b" title="Extending class provided method which should generate a command message which will be published to th..." alt="" coords="5,5,180,61"/>
</map>
</div>

</div>
</div>
<a id="ab4974a3dfe697ccc0dd1344a8e11c5e1" name="ab4974a3dfe697ccc0dd1344a8e11c5e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4974a3dfe697ccc0dd1344a8e11c5e1">&#9670;&nbsp;</a></span>apply_speed_limits()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; double &gt; basic_autonomy::waypoint_generation::apply_speed_limits </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt;&#160;</td>
          <td class="paramname"><em>speeds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt;&#160;</td>
          <td class="paramname"><em>speed_limits</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Applies the provided speed limits to the provided speeds such that each element is capped at its corresponding speed limit if needed. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">speeds</td><td>The speeds to limit </td></tr>
    <tr><td class="paramname">speed_limits</td><td>The speed limits to apply. Must have the same size as speeds</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The capped speed limits. Has the same size as speeds </dd></dl>

<p class="definition">Definition at line <a class="el" href="basic__autonomy_8cpp_source.html#l00604">604</a> of file <a class="el" href="basic__autonomy_8cpp_source.html">basic_autonomy.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  606</span>        {</div>
<div class="line"><span class="lineno">  607</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;Speeds list size: &quot;</span> &lt;&lt; speeds.size());</div>
<div class="line"><span class="lineno">  608</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;SpeedLimits list size: &quot;</span> &lt;&lt; speed_limits.size());</div>
<div class="line"><span class="lineno">  609</span> </div>
<div class="line"><span class="lineno">  610</span>            <span class="keywordflow">if</span> (speeds.size() != speed_limits.size())</div>
<div class="line"><span class="lineno">  611</span>            {</div>
<div class="line"><span class="lineno">  612</span>                <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;Speeds and speed limit lists not same size&quot;</span>);</div>
<div class="line"><span class="lineno">  613</span>            }</div>
<div class="line"><span class="lineno">  614</span>            std::vector&lt;double&gt; out;</div>
<div class="line"><span class="lineno">  615</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> = 0; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> &lt; speeds.size(); <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>++)</div>
<div class="line"><span class="lineno">  616</span>            {</div>
<div class="line"><span class="lineno">  617</span>                out.push_back(std::min(speeds[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>], speed_limits[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>]));</div>
<div class="line"><span class="lineno">  618</span>            }</div>
<div class="line"><span class="lineno">  619</span> </div>
<div class="line"><span class="lineno">  620</span>            <span class="keywordflow">return</span> out;</div>
<div class="line"><span class="lineno">  621</span>        }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="basic__autonomy_8hpp_source.html#l00062">BASIC_AUTONOMY_LOGGER</a>, and <a class="el" href="process__bag_8py_source.html#l00059">process_bag::i</a>.</p>

<p class="reference">Referenced by <a class="el" href="basic__autonomy_8cpp_source.html#l00853">compose_lanefollow_trajectory_from_path()</a>, and <a class="el" href="stop__controlled__intersection__tactical__plugin_8cpp_source.html#l00477">stop_controlled_intersection_tactical_plugin::StopControlledIntersectionTacticalPlugin::compose_trajectory_from_centerline()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebasic__autonomy_1_1waypoint__generation_ab4974a3dfe697ccc0dd1344a8e11c5e1_icgraph.png" border="0" usemap="#anamespacebasic__autonomy_1_1waypoint__generation_ab4974a3dfe697ccc0dd1344a8e11c5e1_icgraph" alt=""/></div>
<map name="anamespacebasic__autonomy_1_1waypoint__generation_ab4974a3dfe697ccc0dd1344a8e11c5e1_icgraph" id="anamespacebasic__autonomy_1_1waypoint__generation_ab4974a3dfe697ccc0dd1344a8e11c5e1_icgraph">
<area shape="rect" title="Applies the provided speed limits to the provided speeds such that each element is capped at its corr..." alt="" coords="609,177,815,218"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#ad633c0c515eae2b1752ad96031e01ef8" title="Method converts a list of lanelet centerline points and current vehicle state into a usable list of t..." alt="" coords="339,105,553,161"/>
<area shape="rect" href="classstop__controlled__intersection__tactical__plugin_1_1StopControlledIntersectionTacticalPlugin.html#ae4ee772170429ec26c32ceec68f3c22f" title="Method converts a list of lanelet centerline points and current vehicle state into a usable list of t..." alt="" coords="331,206,561,277"/>
<area shape="rect" href="classinlanecruising__plugin_1_1InLaneCruisingPlugin.html#a60f695c3ed54c99c6a2dcfaf77ae55e2" title="Service callback for trajectory planning." alt="" coords="61,5,227,61"/>
<area shape="rect" href="classplatooning__tactical__plugin_1_1PlatooningTacticalPlugin.html#aee3afe082ccd5ab937dbb1c49f9e21ff" title="Service callback for trajectory planning." alt="" coords="56,85,232,141"/>
<area shape="rect" href="classlight__controlled__intersection__tactical__plugin_1_1LightControlledIntersectionTacticalPlugin.html#a124f95825dfb2728fefa245e6a0e1db7" title="Function to process the light controlled intersection tactical plugin service call for trajectory pla..." alt="" coords="5,165,283,221"/>
<area shape="rect" href="classstop__controlled__intersection__tactical__plugin_1_1StopControlledIntersectionTacticalPlugin.html#ab0bf4a699bff521ffe56736d78880926" title="Extending class provided callback which should return a planned trajectory based on the provided traj..." alt="" coords="43,246,245,317"/>
</map>
</div>

</div>
</div>
<a id="af9a705cca66d75f0d2d8ce9e6ea2ee41" name="af9a705cca66d75f0d2d8ce9e6ea2ee41"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9a705cca66d75f0d2d8ce9e6ea2ee41">&#9670;&nbsp;</a></span>attach_past_points()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1PointSpeedPair.html">PointSpeedPair</a> &gt; basic_autonomy::waypoint_generation::attach_past_points </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1PointSpeedPair.html">PointSpeedPair</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>points_set</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1PointSpeedPair.html">PointSpeedPair</a> &gt;&#160;</td>
          <td class="paramname"><em>future_points</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classint.html">int</a>&#160;</td>
          <td class="paramname"><em>nearest_pt_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>back_distance</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Attaches back_distance length of points behind the future points. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">points_set</td><td>all point speed pairs </td></tr>
    <tr><td class="paramname">future_points</td><td>future points before which to attach the points </td></tr>
    <tr><td class="paramname">nearest_pt_index</td><td>idx of the first future_point in points_set </td></tr>
    <tr><td class="paramname">back_distance</td><td>the back distance to be added, in meters</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>point speed pairs with back distance length of points in front of future points NOTE- used to add past points to future trajectory for smooth spline calculation </dd></dl>

<p class="definition">Definition at line <a class="el" href="basic__autonomy_8cpp_source.html#l00781">781</a> of file <a class="el" href="basic__autonomy_8cpp_source.html">basic_autonomy.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  783</span>        {</div>
<div class="line"><span class="lineno">  784</span>            std::vector&lt;PointSpeedPair&gt; back_and_future;</div>
<div class="line"><span class="lineno">  785</span>            back_and_future.reserve(points_set.size());</div>
<div class="line"><span class="lineno">  786</span>            <span class="keywordtype">double</span> total_dist = 0;</div>
<div class="line"><span class="lineno">  787</span>            <span class="keywordtype">int</span> min_i = 0;</div>
<div class="line"><span class="lineno">  788</span> </div>
<div class="line"><span class="lineno">  789</span>            <span class="comment">// int must be used here to avoid overflow when i = 0</span></div>
<div class="line"><span class="lineno">  790</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> = nearest_pt_index; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> &gt;= 0; --<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>)</div>
<div class="line"><span class="lineno">  791</span>            {</div>
<div class="line"><span class="lineno">  792</span>                min_i = <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>;</div>
<div class="line"><span class="lineno">  793</span>                total_dist += lanelet::geometry::distance2d(points_set[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>].<a class="code hl_variable" href="namespaceprocess__traj__logs.html#ab81a05c3d1d100117b6781d7dedf8a29">point</a>, points_set[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> - 1].<a class="code hl_variable" href="namespaceprocess__traj__logs.html#ab81a05c3d1d100117b6781d7dedf8a29">point</a>);</div>
<div class="line"><span class="lineno">  794</span> </div>
<div class="line"><span class="lineno">  795</span>                <span class="keywordflow">if</span> (total_dist &gt; back_distance)</div>
<div class="line"><span class="lineno">  796</span>                {</div>
<div class="line"><span class="lineno">  797</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  798</span>                }</div>
<div class="line"><span class="lineno">  799</span>            }</div>
<div class="line"><span class="lineno">  800</span> </div>
<div class="line"><span class="lineno">  801</span>            back_and_future.insert(back_and_future.end(), points_set.begin() + min_i, points_set.begin() + nearest_pt_index + 1);</div>
<div class="line"><span class="lineno">  802</span>            back_and_future.insert(back_and_future.end(), future_points.begin(), future_points.end());</div>
<div class="line"><span class="lineno">  803</span>            <span class="keywordflow">return</span> back_and_future;</div>
<div class="line"><span class="lineno">  804</span>        }</div>
<div class="ttc" id="anamespaceprocess__traj__logs_html_ab81a05c3d1d100117b6781d7dedf8a29"><div class="ttname"><a href="namespaceprocess__traj__logs.html#ab81a05c3d1d100117b6781d7dedf8a29">process_traj_logs.point</a></div><div class="ttdeci">point</div><div class="ttdef"><b>Definition:</b> <a href="process__traj__logs_8py_source.html#l00126">process_traj_logs.py:126</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="process__bag_8py_source.html#l00059">process_bag::i</a>, and <a class="el" href="process__traj__logs_8py_source.html#l00126">process_traj_logs::point</a>.</p>

<p class="reference">Referenced by <a class="el" href="basic__autonomy_8cpp_source.html#l00853">compose_lanefollow_trajectory_from_path()</a>, and <a class="el" href="stop__controlled__intersection__tactical__plugin_8cpp_source.html#l00477">stop_controlled_intersection_tactical_plugin::StopControlledIntersectionTacticalPlugin::compose_trajectory_from_centerline()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebasic__autonomy_1_1waypoint__generation_af9a705cca66d75f0d2d8ce9e6ea2ee41_icgraph.png" border="0" usemap="#anamespacebasic__autonomy_1_1waypoint__generation_af9a705cca66d75f0d2d8ce9e6ea2ee41_icgraph" alt=""/></div>
<map name="anamespacebasic__autonomy_1_1waypoint__generation_af9a705cca66d75f0d2d8ce9e6ea2ee41_icgraph" id="anamespacebasic__autonomy_1_1waypoint__generation_af9a705cca66d75f0d2d8ce9e6ea2ee41_icgraph">
<area shape="rect" title="Attaches back_distance length of points behind the future points." alt="" coords="609,177,815,218"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#ad633c0c515eae2b1752ad96031e01ef8" title="Method converts a list of lanelet centerline points and current vehicle state into a usable list of t..." alt="" coords="339,105,553,161"/>
<area shape="rect" href="classstop__controlled__intersection__tactical__plugin_1_1StopControlledIntersectionTacticalPlugin.html#ae4ee772170429ec26c32ceec68f3c22f" title="Method converts a list of lanelet centerline points and current vehicle state into a usable list of t..." alt="" coords="331,206,561,277"/>
<area shape="rect" href="classinlanecruising__plugin_1_1InLaneCruisingPlugin.html#a60f695c3ed54c99c6a2dcfaf77ae55e2" title="Service callback for trajectory planning." alt="" coords="61,5,227,61"/>
<area shape="rect" href="classplatooning__tactical__plugin_1_1PlatooningTacticalPlugin.html#aee3afe082ccd5ab937dbb1c49f9e21ff" title="Service callback for trajectory planning." alt="" coords="56,85,232,141"/>
<area shape="rect" href="classlight__controlled__intersection__tactical__plugin_1_1LightControlledIntersectionTacticalPlugin.html#a124f95825dfb2728fefa245e6a0e1db7" title="Function to process the light controlled intersection tactical plugin service call for trajectory pla..." alt="" coords="5,165,283,221"/>
<area shape="rect" href="classstop__controlled__intersection__tactical__plugin_1_1StopControlledIntersectionTacticalPlugin.html#ab0bf4a699bff521ffe56736d78880926" title="Extending class provided callback which should return a planned trajectory based on the provided traj..." alt="" coords="43,246,245,317"/>
</map>
</div>

</div>
</div>
<a id="a8be61ccb69db73e2e70d5e59f88ce446" name="a8be61ccb69db73e2e70d5e59f88ce446"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8be61ccb69db73e2e70d5e59f88ce446">&#9670;&nbsp;</a></span>compose_detailed_trajectory_config()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html">DetailedTrajConfig</a> basic_autonomy::waypoint_generation::compose_detailed_trajectory_config </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>trajectory_time_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>curve_resample_step_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>minimum_speed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_accel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lateral_accel_limit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classint.html">int</a>&#160;</td>
          <td class="paramname"><em>speed_moving_average_window_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classint.html">int</a>&#160;</td>
          <td class="paramname"><em>curvature_moving_average_window_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>back_distance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>buffer_ending_downtrack</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>desired_controller_plugin</em> = <code>&quot;default&quot;</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="basic__autonomy_8cpp_source.html#l01070">1070</a> of file <a class="el" href="basic__autonomy_8cpp_source.html">basic_autonomy.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1080</span>        {</div>
<div class="line"><span class="lineno"> 1081</span>            <a class="code hl_struct" href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html">DetailedTrajConfig</a> detailed_config;</div>
<div class="line"><span class="lineno"> 1082</span> </div>
<div class="line"><span class="lineno"> 1083</span>            detailed_config.<a class="code hl_variable" href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html#aeb772409ce5df1b078295282a353349f">trajectory_time_length</a> = trajectory_time_length;</div>
<div class="line"><span class="lineno"> 1084</span>            detailed_config.<a class="code hl_variable" href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html#aed01f5b534f9dc52cc74022c71e2fa3c">curve_resample_step_size</a> = curve_resample_step_size;</div>
<div class="line"><span class="lineno"> 1085</span>            detailed_config.<a class="code hl_variable" href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html#a4bf547260f4eb35b2df2a8ddb5b216c8">minimum_speed</a> = minimum_speed;</div>
<div class="line"><span class="lineno"> 1086</span>            detailed_config.<a class="code hl_variable" href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html#ac27f6c12b09f9cc22e608ec1be16477c">max_accel</a> = max_accel;</div>
<div class="line"><span class="lineno"> 1087</span>            detailed_config.<a class="code hl_variable" href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html#a75872d4c289f3eda6a9a6cfca337534b">lateral_accel_limit</a> = lateral_accel_limit;</div>
<div class="line"><span class="lineno"> 1088</span>            detailed_config.<a class="code hl_variable" href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html#a4a883bd5094bdc768c05d0c3a751f219">speed_moving_average_window_size</a> = speed_moving_average_window_size;</div>
<div class="line"><span class="lineno"> 1089</span>            detailed_config.<a class="code hl_variable" href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html#a60a7d101e04a9a2bf755b8c5a9741354">curvature_moving_average_window_size</a> = curvature_moving_average_window_size;</div>
<div class="line"><span class="lineno"> 1090</span>            detailed_config.<a class="code hl_variable" href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html#a4c8a65b9797246e176f6245025e21b95">back_distance</a> = back_distance;</div>
<div class="line"><span class="lineno"> 1091</span>            detailed_config.<a class="code hl_variable" href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html#ae2456fd9c7e752615b59ec444c8c28ee">buffer_ending_downtrack</a> = buffer_ending_downtrack;</div>
<div class="line"><span class="lineno"> 1092</span>            detailed_config.<a class="code hl_variable" href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html#a89ca36377e20e514abc609c5bd65a941">desired_controller_plugin</a> = desired_controller_plugin;</div>
<div class="line"><span class="lineno"> 1093</span> </div>
<div class="line"><span class="lineno"> 1094</span>            <span class="keywordflow">return</span> detailed_config;</div>
<div class="line"><span class="lineno"> 1095</span>        }</div>
<div class="ttc" id="astructbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig_html"><div class="ttname"><a href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html">basic_autonomy::waypoint_generation::DetailedTrajConfig</a></div><div class="ttdef"><b>Definition:</b> <a href="basic__autonomy_8hpp_source.html#l00078">basic_autonomy.hpp:79</a></div></div>
<div class="ttc" id="astructbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig_html_a4a883bd5094bdc768c05d0c3a751f219"><div class="ttname"><a href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html#a4a883bd5094bdc768c05d0c3a751f219">basic_autonomy::waypoint_generation::DetailedTrajConfig::speed_moving_average_window_size</a></div><div class="ttdeci">int speed_moving_average_window_size</div><div class="ttdef"><b>Definition:</b> <a href="basic__autonomy_8hpp_source.html#l00085">basic_autonomy.hpp:85</a></div></div>
<div class="ttc" id="astructbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig_html_a4bf547260f4eb35b2df2a8ddb5b216c8"><div class="ttname"><a href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html#a4bf547260f4eb35b2df2a8ddb5b216c8">basic_autonomy::waypoint_generation::DetailedTrajConfig::minimum_speed</a></div><div class="ttdeci">double minimum_speed</div><div class="ttdef"><b>Definition:</b> <a href="basic__autonomy_8hpp_source.html#l00082">basic_autonomy.hpp:82</a></div></div>
<div class="ttc" id="astructbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig_html_a4c8a65b9797246e176f6245025e21b95"><div class="ttname"><a href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html#a4c8a65b9797246e176f6245025e21b95">basic_autonomy::waypoint_generation::DetailedTrajConfig::back_distance</a></div><div class="ttdeci">double back_distance</div><div class="ttdef"><b>Definition:</b> <a href="basic__autonomy_8hpp_source.html#l00088">basic_autonomy.hpp:88</a></div></div>
<div class="ttc" id="astructbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig_html_a60a7d101e04a9a2bf755b8c5a9741354"><div class="ttname"><a href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html#a60a7d101e04a9a2bf755b8c5a9741354">basic_autonomy::waypoint_generation::DetailedTrajConfig::curvature_moving_average_window_size</a></div><div class="ttdeci">int curvature_moving_average_window_size</div><div class="ttdef"><b>Definition:</b> <a href="basic__autonomy_8hpp_source.html#l00086">basic_autonomy.hpp:86</a></div></div>
<div class="ttc" id="astructbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig_html_a75872d4c289f3eda6a9a6cfca337534b"><div class="ttname"><a href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html#a75872d4c289f3eda6a9a6cfca337534b">basic_autonomy::waypoint_generation::DetailedTrajConfig::lateral_accel_limit</a></div><div class="ttdeci">double lateral_accel_limit</div><div class="ttdef"><b>Definition:</b> <a href="basic__autonomy_8hpp_source.html#l00084">basic_autonomy.hpp:84</a></div></div>
<div class="ttc" id="astructbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig_html_a89ca36377e20e514abc609c5bd65a941"><div class="ttname"><a href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html#a89ca36377e20e514abc609c5bd65a941">basic_autonomy::waypoint_generation::DetailedTrajConfig::desired_controller_plugin</a></div><div class="ttdeci">std::string desired_controller_plugin</div><div class="ttdef"><b>Definition:</b> <a href="basic__autonomy_8hpp_source.html#l00090">basic_autonomy.hpp:90</a></div></div>
<div class="ttc" id="astructbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig_html_ac27f6c12b09f9cc22e608ec1be16477c"><div class="ttname"><a href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html#ac27f6c12b09f9cc22e608ec1be16477c">basic_autonomy::waypoint_generation::DetailedTrajConfig::max_accel</a></div><div class="ttdeci">double max_accel</div><div class="ttdef"><b>Definition:</b> <a href="basic__autonomy_8hpp_source.html#l00083">basic_autonomy.hpp:83</a></div></div>
<div class="ttc" id="astructbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig_html_aeb772409ce5df1b078295282a353349f"><div class="ttname"><a href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html#aeb772409ce5df1b078295282a353349f">basic_autonomy::waypoint_generation::DetailedTrajConfig::trajectory_time_length</a></div><div class="ttdeci">double trajectory_time_length</div><div class="ttdef"><b>Definition:</b> <a href="basic__autonomy_8hpp_source.html#l00080">basic_autonomy.hpp:80</a></div></div>
<div class="ttc" id="astructbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig_html_aed01f5b534f9dc52cc74022c71e2fa3c"><div class="ttname"><a href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html#aed01f5b534f9dc52cc74022c71e2fa3c">basic_autonomy::waypoint_generation::DetailedTrajConfig::curve_resample_step_size</a></div><div class="ttdeci">double curve_resample_step_size</div><div class="ttdef"><b>Definition:</b> <a href="basic__autonomy_8hpp_source.html#l00081">basic_autonomy.hpp:81</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="basic__autonomy_8hpp_source.html#l00088">basic_autonomy::waypoint_generation::DetailedTrajConfig::back_distance</a>, <a class="el" href="basic__autonomy_8hpp_source.html#l00089">basic_autonomy::waypoint_generation::DetailedTrajConfig::buffer_ending_downtrack</a>, <a class="el" href="basic__autonomy_8hpp_source.html#l00086">basic_autonomy::waypoint_generation::DetailedTrajConfig::curvature_moving_average_window_size</a>, <a class="el" href="basic__autonomy_8hpp_source.html#l00081">basic_autonomy::waypoint_generation::DetailedTrajConfig::curve_resample_step_size</a>, <a class="el" href="basic__autonomy_8hpp_source.html#l00090">basic_autonomy::waypoint_generation::DetailedTrajConfig::desired_controller_plugin</a>, <a class="el" href="basic__autonomy_8hpp_source.html#l00084">basic_autonomy::waypoint_generation::DetailedTrajConfig::lateral_accel_limit</a>, <a class="el" href="basic__autonomy_8hpp_source.html#l00083">basic_autonomy::waypoint_generation::DetailedTrajConfig::max_accel</a>, <a class="el" href="basic__autonomy_8hpp_source.html#l00082">basic_autonomy::waypoint_generation::DetailedTrajConfig::minimum_speed</a>, <a class="el" href="basic__autonomy_8hpp_source.html#l00085">basic_autonomy::waypoint_generation::DetailedTrajConfig::speed_moving_average_window_size</a>, and <a class="el" href="basic__autonomy_8hpp_source.html#l00080">basic_autonomy::waypoint_generation::DetailedTrajConfig::trajectory_time_length</a>.</p>

<p class="reference">Referenced by <a class="el" href="cooperative__lanechange__node_8cpp_source.html#l00564">cooperative_lanechange::CooperativeLaneChangePlugin::plan_lanechange()</a>, <a class="el" href="inlanecruising__plugin_8cpp_source.html#l00049">inlanecruising_plugin::InLaneCruisingPlugin::plan_trajectory_callback()</a>, <a class="el" href="platooning__tactical__plugin_8cpp_source.html#l00044">platooning_tactical_plugin::PlatooningTacticalPlugin::plan_trajectory_cb()</a>, and <a class="el" href="light__controlled__intersection__tactical__plugin_8cpp_source.html#l00028">light_controlled_intersection_tactical_plugin::LightControlledIntersectionTacticalPlugin::planTrajectoryCB()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebasic__autonomy_1_1waypoint__generation_a8be61ccb69db73e2e70d5e59f88ce446_icgraph.png" border="0" usemap="#anamespacebasic__autonomy_1_1waypoint__generation_a8be61ccb69db73e2e70d5e59f88ce446_icgraph" alt=""/></div>
<map name="anamespacebasic__autonomy_1_1waypoint__generation_a8be61ccb69db73e2e70d5e59f88ce446_icgraph" id="anamespacebasic__autonomy_1_1waypoint__generation_a8be61ccb69db73e2e70d5e59f88ce446_icgraph">
<area shape="rect" title=" " alt="" coords="585,125,785,181"/>
<area shape="rect" href="classcooperative__lanechange_1_1CooperativeLaneChangePlugin.html#a5f0c14a409d58d6b1750c38c6bf1b34a" title="Creates a vector of Trajectory Points from maneuver information in trajectory request." alt="" coords="295,5,502,61"/>
<area shape="rect" href="classinlanecruising__plugin_1_1InLaneCruisingPlugin.html#a60f695c3ed54c99c6a2dcfaf77ae55e2" title="Service callback for trajectory planning." alt="" coords="315,85,482,141"/>
<area shape="rect" href="classplatooning__tactical__plugin_1_1PlatooningTacticalPlugin.html#aee3afe082ccd5ab937dbb1c49f9e21ff" title="Service callback for trajectory planning." alt="" coords="311,165,487,221"/>
<area shape="rect" href="classlight__controlled__intersection__tactical__plugin_1_1LightControlledIntersectionTacticalPlugin.html#a124f95825dfb2728fefa245e6a0e1db7" title="Function to process the light controlled intersection tactical plugin service call for trajectory pla..." alt="" coords="260,245,537,301"/>
<area shape="rect" href="classcooperative__lanechange_1_1CooperativeLaneChangePlugin.html#a8913539d8614e509910af225e18bc809" title="Extending class provided callback which should return a planned trajectory based on the provided traj..." alt="" coords="5,5,212,61"/>
</map>
</div>

</div>
</div>
<a id="a11b8eae5903a23ecab69c2f814c1bcf8" name="a11b8eae5903a23ecab69c2f814c1bcf8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11b8eae5903a23ecab69c2f814c1bcf8">&#9670;&nbsp;</a></span>compose_general_trajectory_config()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1GeneralTrajConfig.html">GeneralTrajConfig</a> basic_autonomy::waypoint_generation::compose_general_trajectory_config </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>trajectory_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classint.html">int</a>&#160;</td>
          <td class="paramname"><em>default_downsample_ratio</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classint.html">int</a>&#160;</td>
          <td class="paramname"><em>turn_downsample_ratio</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="basic__autonomy_8cpp_source.html#l01097">1097</a> of file <a class="el" href="basic__autonomy_8cpp_source.html">basic_autonomy.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1100</span>        {</div>
<div class="line"><span class="lineno"> 1101</span>            <a class="code hl_struct" href="structbasic__autonomy_1_1waypoint__generation_1_1GeneralTrajConfig.html">GeneralTrajConfig</a> general_config;</div>
<div class="line"><span class="lineno"> 1102</span> </div>
<div class="line"><span class="lineno"> 1103</span>            general_config.<a class="code hl_variable" href="structbasic__autonomy_1_1waypoint__generation_1_1GeneralTrajConfig.html#a3cea08651e7da10dc7b7510dc82b192d">trajectory_type</a> = trajectory_type;</div>
<div class="line"><span class="lineno"> 1104</span>            general_config.<a class="code hl_variable" href="structbasic__autonomy_1_1waypoint__generation_1_1GeneralTrajConfig.html#a0ad2d91d1f739942213d5bfe7f0e861f">default_downsample_ratio</a> = default_downsample_ratio;</div>
<div class="line"><span class="lineno"> 1105</span>            general_config.<a class="code hl_variable" href="structbasic__autonomy_1_1waypoint__generation_1_1GeneralTrajConfig.html#a57b1703c6bbc6043c489280ca1c34041">turn_downsample_ratio</a> = turn_downsample_ratio;</div>
<div class="line"><span class="lineno"> 1106</span> </div>
<div class="line"><span class="lineno"> 1107</span> </div>
<div class="line"><span class="lineno"> 1108</span>            <span class="keywordflow">return</span> general_config;</div>
<div class="line"><span class="lineno"> 1109</span>        }</div>
<div class="ttc" id="astructbasic__autonomy_1_1waypoint__generation_1_1GeneralTrajConfig_html"><div class="ttname"><a href="structbasic__autonomy_1_1waypoint__generation_1_1GeneralTrajConfig.html">basic_autonomy::waypoint_generation::GeneralTrajConfig</a></div><div class="ttdef"><b>Definition:</b> <a href="basic__autonomy_8hpp_source.html#l00070">basic_autonomy.hpp:71</a></div></div>
<div class="ttc" id="astructbasic__autonomy_1_1waypoint__generation_1_1GeneralTrajConfig_html_a0ad2d91d1f739942213d5bfe7f0e861f"><div class="ttname"><a href="structbasic__autonomy_1_1waypoint__generation_1_1GeneralTrajConfig.html#a0ad2d91d1f739942213d5bfe7f0e861f">basic_autonomy::waypoint_generation::GeneralTrajConfig::default_downsample_ratio</a></div><div class="ttdeci">int default_downsample_ratio</div><div class="ttdef"><b>Definition:</b> <a href="basic__autonomy_8hpp_source.html#l00073">basic_autonomy.hpp:73</a></div></div>
<div class="ttc" id="astructbasic__autonomy_1_1waypoint__generation_1_1GeneralTrajConfig_html_a3cea08651e7da10dc7b7510dc82b192d"><div class="ttname"><a href="structbasic__autonomy_1_1waypoint__generation_1_1GeneralTrajConfig.html#a3cea08651e7da10dc7b7510dc82b192d">basic_autonomy::waypoint_generation::GeneralTrajConfig::trajectory_type</a></div><div class="ttdeci">std::string trajectory_type</div><div class="ttdef"><b>Definition:</b> <a href="basic__autonomy_8hpp_source.html#l00072">basic_autonomy.hpp:72</a></div></div>
<div class="ttc" id="astructbasic__autonomy_1_1waypoint__generation_1_1GeneralTrajConfig_html_a57b1703c6bbc6043c489280ca1c34041"><div class="ttname"><a href="structbasic__autonomy_1_1waypoint__generation_1_1GeneralTrajConfig.html#a57b1703c6bbc6043c489280ca1c34041">basic_autonomy::waypoint_generation::GeneralTrajConfig::turn_downsample_ratio</a></div><div class="ttdeci">int turn_downsample_ratio</div><div class="ttdef"><b>Definition:</b> <a href="basic__autonomy_8hpp_source.html#l00074">basic_autonomy.hpp:74</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="basic__autonomy_8hpp_source.html#l00073">basic_autonomy::waypoint_generation::GeneralTrajConfig::default_downsample_ratio</a>, <a class="el" href="basic__autonomy_8hpp_source.html#l00072">basic_autonomy::waypoint_generation::GeneralTrajConfig::trajectory_type</a>, and <a class="el" href="basic__autonomy_8hpp_source.html#l00074">basic_autonomy::waypoint_generation::GeneralTrajConfig::turn_downsample_ratio</a>.</p>

<p class="reference">Referenced by <a class="el" href="cooperative__lanechange__node_8cpp_source.html#l00564">cooperative_lanechange::CooperativeLaneChangePlugin::plan_lanechange()</a>, <a class="el" href="inlanecruising__plugin_8cpp_source.html#l00049">inlanecruising_plugin::InLaneCruisingPlugin::plan_trajectory_callback()</a>, <a class="el" href="platooning__tactical__plugin_8cpp_source.html#l00044">platooning_tactical_plugin::PlatooningTacticalPlugin::plan_trajectory_cb()</a>, and <a class="el" href="light__controlled__intersection__tactical__plugin_8cpp_source.html#l00028">light_controlled_intersection_tactical_plugin::LightControlledIntersectionTacticalPlugin::planTrajectoryCB()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebasic__autonomy_1_1waypoint__generation_a11b8eae5903a23ecab69c2f814c1bcf8_icgraph.png" border="0" usemap="#anamespacebasic__autonomy_1_1waypoint__generation_a11b8eae5903a23ecab69c2f814c1bcf8_icgraph" alt=""/></div>
<map name="anamespacebasic__autonomy_1_1waypoint__generation_a11b8eae5903a23ecab69c2f814c1bcf8_icgraph" id="anamespacebasic__autonomy_1_1waypoint__generation_a11b8eae5903a23ecab69c2f814c1bcf8_icgraph">
<area shape="rect" title=" " alt="" coords="585,125,783,181"/>
<area shape="rect" href="classcooperative__lanechange_1_1CooperativeLaneChangePlugin.html#a5f0c14a409d58d6b1750c38c6bf1b34a" title="Creates a vector of Trajectory Points from maneuver information in trajectory request." alt="" coords="295,5,502,61"/>
<area shape="rect" href="classinlanecruising__plugin_1_1InLaneCruisingPlugin.html#a60f695c3ed54c99c6a2dcfaf77ae55e2" title="Service callback for trajectory planning." alt="" coords="315,85,482,141"/>
<area shape="rect" href="classplatooning__tactical__plugin_1_1PlatooningTacticalPlugin.html#aee3afe082ccd5ab937dbb1c49f9e21ff" title="Service callback for trajectory planning." alt="" coords="311,165,487,221"/>
<area shape="rect" href="classlight__controlled__intersection__tactical__plugin_1_1LightControlledIntersectionTacticalPlugin.html#a124f95825dfb2728fefa245e6a0e1db7" title="Function to process the light controlled intersection tactical plugin service call for trajectory pla..." alt="" coords="260,245,537,301"/>
<area shape="rect" href="classcooperative__lanechange_1_1CooperativeLaneChangePlugin.html#a8913539d8614e509910af225e18bc809" title="Extending class provided callback which should return a planned trajectory based on the provided traj..." alt="" coords="5,5,212,61"/>
</map>
</div>

</div>
</div>
<a id="a741942c16ca54212b9adf3ddc2eea66d" name="a741942c16ca54212b9adf3ddc2eea66d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a741942c16ca54212b9adf3ddc2eea66d">&#9670;&nbsp;</a></span>compose_lanechange_trajectory_from_path()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; carma_planning_msgs::msg::TrajectoryPlanPoint &gt; basic_autonomy::waypoint_generation::compose_lanechange_trajectory_from_path </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1PointSpeedPair.html">PointSpeedPair</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>points</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const carma_planning_msgs::msg::VehicleState &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const rclcpp::Time &amp;&#160;</td>
          <td class="paramname"><em>state_time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacecarma__wm.html#a3ac653959e0b6198cae274d68b343228">carma_wm::WorldModelConstPtr</a> &amp;&#160;</td>
          <td class="paramname"><em>wm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const carma_planning_msgs::msg::VehicleState &amp;&#160;</td>
          <td class="paramname"><em>ending_state_before_buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html">DetailedTrajConfig</a> &amp;&#160;</td>
          <td class="paramname"><em>detailed_config</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Method converts a list of lanelet centerline points and current vehicle state into a usable list of trajectory points for trajectory planning for a Lane following maneuver. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">points</td><td>The set of points that define the current lane the vehicle is in and are defined based on the request planning maneuvers. These points must be in the same lane as the vehicle and must extend in front of it though it is fine if they also extend behind it. </td></tr>
    <tr><td class="paramname">state</td><td>The current state of the vehicle </td></tr>
    <tr><td class="paramname">state_time</td><td>The abosolute time which the provided vehicle state corresponds to </td></tr>
    <tr><td class="paramname">wm</td><td>The carma world model object which the vehicle is operating in. </td></tr>
    <tr><td class="paramname">ending_state_before_buffer</td><td>The vehicle state before a buffer was added to the points. Used to revert the trajectory to required distance before returning.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A list of trajectory points to send to the carma planning stack </dd></dl>

<p class="definition">Definition at line <a class="el" href="basic__autonomy_8cpp_source.html#l01112">1112</a> of file <a class="el" href="basic__autonomy_8cpp_source.html">basic_autonomy.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1115</span>        {</div>
<div class="line"><span class="lineno"> 1116</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;Input points size in compose traj from centerline: &quot;</span>&lt;&lt; points.size());</div>
<div class="line"><span class="lineno"> 1117</span>            <span class="keywordtype">int</span> nearest_pt_index = <a class="code hl_function" href="namespacebasic__autonomy_1_1waypoint__generation.html#aa399a236f88f7b1c5557327fbb2ba71a">get_nearest_index_by_downtrack</a>(points, wm, state);</div>
<div class="line"><span class="lineno"> 1118</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;nearest_pt_index: &quot;</span>&lt;&lt; nearest_pt_index);</div>
<div class="line"><span class="lineno"> 1119</span> </div>
<div class="line"><span class="lineno"> 1120</span>            std::vector&lt;PointSpeedPair&gt; future_points(points.begin() + nearest_pt_index + 1, points.end());</div>
<div class="line"><span class="lineno"> 1121</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;future_points size: &quot;</span>&lt;&lt; future_points.size());</div>
<div class="line"><span class="lineno"> 1122</span> </div>
<div class="line"><span class="lineno"> 1123</span>            <span class="comment">//Compute yaw values from original trajectory.</span></div>
<div class="line"><span class="lineno"> 1124</span>            std::vector&lt;lanelet::BasicPoint2d&gt; future_geom_points;</div>
<div class="line"><span class="lineno"> 1125</span>            std::vector&lt;double&gt; final_actual_speeds;</div>
<div class="line"><span class="lineno"> 1126</span>            <a class="code hl_function" href="namespacebasic__autonomy_1_1waypoint__generation.html#a0f07faaac8c54cc485f2bb217097326e">split_point_speed_pairs</a>(future_points, &amp;future_geom_points, &amp;final_actual_speeds);</div>
<div class="line"><span class="lineno"> 1127</span> </div>
<div class="line"><span class="lineno"> 1128</span>            std::unique_ptr&lt;smoothing::SplineI&gt; fit_curve = <a class="code hl_function" href="namespacebasic__autonomy_1_1waypoint__generation.html#a9e0eab343d21d18c665083839d706f04">compute_fit</a>(future_geom_points);</div>
<div class="line"><span class="lineno"> 1129</span>            <span class="keywordflow">if</span>(!fit_curve){</div>
<div class="line"><span class="lineno"> 1130</span>                <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;Could not fit a spline curve along the given trajectory!&quot;</span>);</div>
<div class="line"><span class="lineno"> 1131</span>            }</div>
<div class="line"><span class="lineno"> 1132</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;Got fit&quot;</span>);</div>
<div class="line"><span class="lineno"> 1133</span>            std::vector&lt;lanelet::BasicPoint2d&gt; all_sampling_points;</div>
<div class="line"><span class="lineno"> 1134</span>            all_sampling_points.reserve(1 + future_geom_points.size() * 2);</div>
<div class="line"><span class="lineno"> 1135</span> </div>
<div class="line"><span class="lineno"> 1136</span>            lanelet::BasicPoint2d current_vehicle_point(state.x_pos_global, state.y_pos_global);</div>
<div class="line"><span class="lineno"> 1137</span> </div>
<div class="line"><span class="lineno"> 1138</span>            future_geom_points.insert(future_geom_points.begin(),</div>
<div class="line"><span class="lineno"> 1139</span>                                       current_vehicle_point); <span class="comment">// Add current vehicle position to front of future geometry points</span></div>
<div class="line"><span class="lineno"> 1140</span> </div>
<div class="line"><span class="lineno"> 1141</span>            final_actual_speeds.insert(final_actual_speeds.begin(), state.longitudinal_vel);</div>
<div class="line"><span class="lineno"> 1142</span>        </div>
<div class="line"><span class="lineno"> 1143</span>            <span class="comment">//Compute points to local downtracks</span></div>
<div class="line"><span class="lineno"> 1144</span>            std::vector&lt;double&gt; downtracks = <a class="code hl_function" href="namespacecarma__wm_1_1geometry.html#adf1c6b7f1e33569b45074e4e5bbeff1d">carma_wm::geometry::compute_arc_lengths</a>(future_geom_points);</div>
<div class="line"><span class="lineno"> 1145</span> </div>
<div class="line"><span class="lineno"> 1146</span>            <span class="keyword">auto</span> total_step_along_curve = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(downtracks.back() /detailed_config.<a class="code hl_variable" href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html#aed01f5b534f9dc52cc74022c71e2fa3c">curve_resample_step_size</a>);</div>
<div class="line"><span class="lineno"> 1147</span> </div>
<div class="line"><span class="lineno"> 1148</span>            <span class="keywordtype">double</span> scaled_steps_along_curve = 0.0; <span class="comment">//from 0 (start) to 1 (end) for the whole trajectory</span></div>
<div class="line"><span class="lineno"> 1149</span> </div>
<div class="line"><span class="lineno"> 1150</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> steps_along_curve = 0; steps_along_curve &lt; total_step_along_curve; steps_along_curve++){</div>
<div class="line"><span class="lineno"> 1151</span>                lanelet::BasicPoint2d p = (*fit_curve)(scaled_steps_along_curve);</div>
<div class="line"><span class="lineno"> 1152</span> </div>
<div class="line"><span class="lineno"> 1153</span>                all_sampling_points.push_back(p);</div>
<div class="line"><span class="lineno"> 1154</span> </div>
<div class="line"><span class="lineno"> 1155</span>                scaled_steps_along_curve += 1.0 / total_step_along_curve; </div>
<div class="line"><span class="lineno"> 1156</span>            }</div>
<div class="line"><span class="lineno"> 1157</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;Got sampled points with size:&quot;</span> &lt;&lt; all_sampling_points.size());</div>
<div class="line"><span class="lineno"> 1158</span> </div>
<div class="line"><span class="lineno"> 1159</span>            std::vector&lt;double&gt; final_yaw_values = <a class="code hl_function" href="namespacecarma__wm_1_1geometry.html#ad8a3ee0bf06f85a6e7a8b5097251da2b">carma_wm::geometry::compute_tangent_orientations</a>(future_geom_points);</div>
<div class="line"><span class="lineno"> 1160</span>            <span class="keywordflow">if</span>(final_yaw_values.size() &gt; 0) {</div>
<div class="line"><span class="lineno"> 1161</span>                final_yaw_values[0] = state.orientation; <span class="comment">// Set the initial yaw value based on the initial state</span></div>
<div class="line"><span class="lineno"> 1162</span>            }</div>
<div class="line"><span class="lineno"> 1163</span> </div>
<div class="line"><span class="lineno"> 1164</span>            final_actual_speeds = <a class="code hl_function" href="namespacebasic__autonomy_1_1smoothing.html#afb726e75a21ada8efa3ca5561ffc9984">smoothing::moving_average_filter</a>(final_actual_speeds, detailed_config.<a class="code hl_variable" href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html#a4a883bd5094bdc768c05d0c3a751f219">speed_moving_average_window_size</a>);</div>
<div class="line"><span class="lineno"> 1165</span> </div>
<div class="line"><span class="lineno"> 1166</span>            <span class="comment">//Convert speeds to time</span></div>
<div class="line"><span class="lineno"> 1167</span>            std::vector&lt;double&gt; times;</div>
<div class="line"><span class="lineno"> 1168</span>            trajectory_utils::conversions::speed_to_time(downtracks, final_actual_speeds, &amp;times);</div>
<div class="line"><span class="lineno"> 1169</span> </div>
<div class="line"><span class="lineno"> 1170</span>            <span class="comment">//Remove extra points</span></div>
<div class="line"><span class="lineno"> 1171</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;Before removing extra buffer points, future_geom_points.size()&quot;</span>&lt;&lt; future_geom_points.size());</div>
<div class="line"><span class="lineno"> 1172</span>            <span class="keywordtype">int</span> end_dist_pt_index = <a class="code hl_function" href="namespacebasic__autonomy_1_1waypoint__generation.html#aa399a236f88f7b1c5557327fbb2ba71a">get_nearest_index_by_downtrack</a>(future_geom_points, wm, ending_state_before_buffer);</div>
<div class="line"><span class="lineno"> 1173</span>            future_geom_points.resize(end_dist_pt_index + 1);</div>
<div class="line"><span class="lineno"> 1174</span>            times.resize(end_dist_pt_index + 1);</div>
<div class="line"><span class="lineno"> 1175</span>            final_yaw_values.resize(end_dist_pt_index + 1);</div>
<div class="line"><span class="lineno"> 1176</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;After removing extra buffer points, future_geom_points.size():&quot;</span>&lt;&lt; future_geom_points.size());</div>
<div class="line"><span class="lineno"> 1177</span> </div>
<div class="line"><span class="lineno"> 1178</span>            std::vector&lt;carma_planning_msgs::msg::TrajectoryPlanPoint&gt; traj_points =</div>
<div class="line"><span class="lineno"> 1179</span>                <a class="code hl_function" href="namespacebasic__autonomy_1_1waypoint__generation.html#aba6a29cdaf0c4af10647b59bf6df4e01">trajectory_from_points_times_orientations</a>(future_geom_points, times, final_yaw_values, state_time, detailed_config.<a class="code hl_variable" href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html#a89ca36377e20e514abc609c5bd65a941">desired_controller_plugin</a>);</div>
<div class="line"><span class="lineno"> 1180</span> </div>
<div class="line"><span class="lineno"> 1181</span>            <span class="keywordflow">return</span> traj_points;</div>
<div class="line"><span class="lineno"> 1182</span>        }</div>
<div class="ttc" id="anamespacebasic__autonomy_1_1smoothing_html_afb726e75a21ada8efa3ca5561ffc9984"><div class="ttname"><a href="namespacebasic__autonomy_1_1smoothing.html#afb726e75a21ada8efa3ca5561ffc9984">basic_autonomy::smoothing::moving_average_filter</a></div><div class="ttdeci">std::vector&lt; double &gt; moving_average_filter(const std::vector&lt; double &gt; input, int window_size, bool ignore_first_point=true)</div><div class="ttdoc">Extremely simplie moving average filter.</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l00024">filters.cpp:24</a></div></div>
<div class="ttc" id="anamespacebasic__autonomy_1_1waypoint__generation_html_a0f07faaac8c54cc485f2bb217097326e"><div class="ttname"><a href="namespacebasic__autonomy_1_1waypoint__generation.html#a0f07faaac8c54cc485f2bb217097326e">basic_autonomy::waypoint_generation::split_point_speed_pairs</a></div><div class="ttdeci">void split_point_speed_pairs(const std::vector&lt; PointSpeedPair &gt; &amp;points, std::vector&lt; lanelet::BasicPoint2d &gt; *basic_points, std::vector&lt; double &gt; *speeds)</div><div class="ttdoc">Helper method to split a list of PointSpeedPair into separate point and speed lists.</div><div class="ttdef"><b>Definition:</b> <a href="helper__functions_8cpp_source.html#l00083">helper_functions.cpp:83</a></div></div>
<div class="ttc" id="anamespacebasic__autonomy_1_1waypoint__generation_html_a9e0eab343d21d18c665083839d706f04"><div class="ttname"><a href="namespacebasic__autonomy_1_1waypoint__generation.html#a9e0eab343d21d18c665083839d706f04">basic_autonomy::waypoint_generation::compute_fit</a></div><div class="ttdeci">std::unique_ptr&lt; basic_autonomy::smoothing::SplineI &gt; compute_fit(const std::vector&lt; lanelet::BasicPoint2d &gt; &amp;basic_points)</div><div class="ttdoc">Computes a spline based on the provided points.</div><div class="ttdef"><b>Definition:</b> <a href="basic__autonomy_8cpp_source.html#l00806">basic_autonomy.cpp:806</a></div></div>
<div class="ttc" id="anamespacebasic__autonomy_1_1waypoint__generation_html_aa399a236f88f7b1c5557327fbb2ba71a"><div class="ttname"><a href="namespacebasic__autonomy_1_1waypoint__generation.html#aa399a236f88f7b1c5557327fbb2ba71a">basic_autonomy::waypoint_generation::get_nearest_index_by_downtrack</a></div><div class="ttdeci">int get_nearest_index_by_downtrack(const std::vector&lt; lanelet::BasicPoint2d &gt; &amp;points, const carma_wm::WorldModelConstPtr &amp;wm, double target_downtrack)</div><div class="ttdoc">Returns the nearest &quot;less than&quot; point to the provided vehicle pose in the provided list by utilizing ...</div><div class="ttdef"><b>Definition:</b> <a href="helper__functions_8cpp_source.html#l00065">helper_functions.cpp:65</a></div></div>
<div class="ttc" id="anamespacebasic__autonomy_1_1waypoint__generation_html_aba6a29cdaf0c4af10647b59bf6df4e01"><div class="ttname"><a href="namespacebasic__autonomy_1_1waypoint__generation.html#aba6a29cdaf0c4af10647b59bf6df4e01">basic_autonomy::waypoint_generation::trajectory_from_points_times_orientations</a></div><div class="ttdeci">std::vector&lt; carma_planning_msgs::msg::TrajectoryPlanPoint &gt; trajectory_from_points_times_orientations(const std::vector&lt; lanelet::BasicPoint2d &gt; &amp;points, const std::vector&lt; double &gt; &amp;times, const std::vector&lt; double &gt; &amp;yaws, rclcpp::Time startTime, const std::string &amp;desired_controller_plugin)</div><div class="ttdoc">Method combines input points, times, orientations, and an absolute start time to form a valid carma p...</div><div class="ttdef"><b>Definition:</b> <a href="basic__autonomy_8cpp_source.html#l00750">basic_autonomy.cpp:750</a></div></div>
<div class="ttc" id="anamespacecarma__wm_1_1geometry_html_ad8a3ee0bf06f85a6e7a8b5097251da2b"><div class="ttname"><a href="namespacecarma__wm_1_1geometry.html#ad8a3ee0bf06f85a6e7a8b5097251da2b">carma_wm::geometry::compute_tangent_orientations</a></div><div class="ttdeci">std::vector&lt; double &gt; compute_tangent_orientations(const lanelet::BasicLineString2d &amp;centerline)</div><div class="ttdoc">Compute an approximate orientation for the vehicle at each point along the provided centerline.</div><div class="ttdef"><b>Definition:</b> <a href="Geometry_8cpp_source.html#l00559">Geometry.cpp:559</a></div></div>
<div class="ttc" id="anamespacecarma__wm_1_1geometry_html_adf1c6b7f1e33569b45074e4e5bbeff1d"><div class="ttname"><a href="namespacecarma__wm_1_1geometry.html#adf1c6b7f1e33569b45074e4e5bbeff1d">carma_wm::geometry::compute_arc_lengths</a></div><div class="ttdeci">std::vector&lt; double &gt; compute_arc_lengths(const std::vector&lt; lanelet::BasicPoint2d &gt; &amp;data)</div><div class="ttdoc">Compute the arc length at each point around the curve.</div><div class="ttdef"><b>Definition:</b> <a href="Geometry_8cpp_source.html#l00498">Geometry.cpp:498</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="basic__autonomy_8hpp_source.html#l00062">BASIC_AUTONOMY_LOGGER</a>, <a class="el" href="Geometry_8cpp_source.html#l00498">carma_wm::geometry::compute_arc_lengths()</a>, <a class="el" href="basic__autonomy_8cpp_source.html#l00806">compute_fit()</a>, <a class="el" href="Geometry_8cpp_source.html#l00559">carma_wm::geometry::compute_tangent_orientations()</a>, <a class="el" href="basic__autonomy_8hpp_source.html#l00081">basic_autonomy::waypoint_generation::DetailedTrajConfig::curve_resample_step_size</a>, <a class="el" href="basic__autonomy_8hpp_source.html#l00090">basic_autonomy::waypoint_generation::DetailedTrajConfig::desired_controller_plugin</a>, <a class="el" href="helper__functions_8cpp_source.html#l00065">get_nearest_index_by_downtrack()</a>, <a class="el" href="filters_8cpp_source.html#l00024">basic_autonomy::smoothing::moving_average_filter()</a>, <a class="el" href="basic__autonomy_8hpp_source.html#l00085">basic_autonomy::waypoint_generation::DetailedTrajConfig::speed_moving_average_window_size</a>, <a class="el" href="helper__functions_8cpp_source.html#l00083">split_point_speed_pairs()</a>, and <a class="el" href="basic__autonomy_8cpp_source.html#l00750">trajectory_from_points_times_orientations()</a>.</p>

<p class="reference">Referenced by <a class="el" href="cooperative__lanechange__node_8cpp_source.html#l00564">cooperative_lanechange::CooperativeLaneChangePlugin::plan_lanechange()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebasic__autonomy_1_1waypoint__generation_a741942c16ca54212b9adf3ddc2eea66d_cgraph.png" border="0" usemap="#anamespacebasic__autonomy_1_1waypoint__generation_a741942c16ca54212b9adf3ddc2eea66d_cgraph" alt=""/></div>
<map name="anamespacebasic__autonomy_1_1waypoint__generation_a741942c16ca54212b9adf3ddc2eea66d_cgraph" id="anamespacebasic__autonomy_1_1waypoint__generation_a741942c16ca54212b9adf3ddc2eea66d_cgraph">
<area shape="rect" title="Method converts a list of lanelet centerline points and current vehicle state into a usable list of t..." alt="" coords="5,208,227,264"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#adf1c6b7f1e33569b45074e4e5bbeff1d" title="Compute the arc length at each point around the curve." alt="" coords="304,13,456,54"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#a9e0eab343d21d18c665083839d706f04" title="Computes a spline based on the provided points." alt="" coords="293,78,467,119"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#ad8a3ee0bf06f85a6e7a8b5097251da2b" title="Compute an approximate orientation for the vehicle at each point along the provided centerline." alt="" coords="279,143,481,185"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#aa399a236f88f7b1c5557327fbb2ba71a" title="Returns the nearest &quot;less than&quot; point to the provided vehicle pose in the provided list by utilizing ..." alt="" coords="293,208,467,264"/>
<area shape="rect" href="namespacebasic__autonomy_1_1smoothing.html#afb726e75a21ada8efa3ca5561ffc9984" title="Extremely simplie moving average filter." alt="" coords="289,287,471,329"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#a0f07faaac8c54cc485f2bb217097326e" title="Helper method to split a list of PointSpeedPair into separate point and speed lists." alt="" coords="293,352,467,408"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#aba6a29cdaf0c4af10647b59bf6df4e01" title="Method combines input points, times, orientations, and an absolute start time to form a valid carma p..." alt="" coords="275,432,485,488"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#a4e12c2971926486d1447e44e978f8d4d" title=" " alt="" coords="534,5,679,61"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#a9bc48b810ba18270fcc21674b55922f0" title="Compute the Euclidean distance between the two points." alt="" coords="728,5,873,61"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#a126f739493756f0eb84183ea22912b93" title=" " alt="" coords="533,136,680,192"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#ae8af6cd9c27d35849c12959ab9f1b9c3" title=" " alt="" coords="728,136,873,192"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebasic__autonomy_1_1waypoint__generation_a741942c16ca54212b9adf3ddc2eea66d_icgraph.png" border="0" usemap="#anamespacebasic__autonomy_1_1waypoint__generation_a741942c16ca54212b9adf3ddc2eea66d_icgraph" alt=""/></div>
<map name="anamespacebasic__autonomy_1_1waypoint__generation_a741942c16ca54212b9adf3ddc2eea66d_icgraph" id="anamespacebasic__autonomy_1_1waypoint__generation_a741942c16ca54212b9adf3ddc2eea66d_icgraph">
<area shape="rect" title="Method converts a list of lanelet centerline points and current vehicle state into a usable list of t..." alt="" coords="515,5,736,61"/>
<area shape="rect" href="classcooperative__lanechange_1_1CooperativeLaneChangePlugin.html#a5f0c14a409d58d6b1750c38c6bf1b34a" title="Creates a vector of Trajectory Points from maneuver information in trajectory request." alt="" coords="260,5,467,61"/>
<area shape="rect" href="classcooperative__lanechange_1_1CooperativeLaneChangePlugin.html#a8913539d8614e509910af225e18bc809" title="Extending class provided callback which should return a planned trajectory based on the provided traj..." alt="" coords="5,5,212,61"/>
</map>
</div>

</div>
</div>
<a id="ad633c0c515eae2b1752ad96031e01ef8" name="ad633c0c515eae2b1752ad96031e01ef8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad633c0c515eae2b1752ad96031e01ef8">&#9670;&nbsp;</a></span>compose_lanefollow_trajectory_from_path()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; carma_planning_msgs::msg::TrajectoryPlanPoint &gt; basic_autonomy::waypoint_generation::compose_lanefollow_trajectory_from_path </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1PointSpeedPair.html">PointSpeedPair</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>points</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const carma_planning_msgs::msg::VehicleState &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const rclcpp::Time &amp;&#160;</td>
          <td class="paramname"><em>state_time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacecarma__wm.html#a3ac653959e0b6198cae274d68b343228">carma_wm::WorldModelConstPtr</a> &amp;&#160;</td>
          <td class="paramname"><em>wm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const carma_planning_msgs::msg::VehicleState &amp;&#160;</td>
          <td class="paramname"><em>ending_state_before_buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">carma_debug_ros2_msgs::msg::TrajectoryCurvatureSpeeds &amp;&#160;</td>
          <td class="paramname"><em>debug_msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html">DetailedTrajConfig</a> &amp;&#160;</td>
          <td class="paramname"><em>detailed_config</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Method converts a list of lanelet centerline points and current vehicle state into a usable list of trajectory points for trajectory planning for a Lane following maneuver. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">points</td><td>The set of points that define the current lane the vehicle is in and are defined based on the request planning maneuvers. These points must be in the same lane as the vehicle and must extend in front of it though it is fine if they also extend behind it. </td></tr>
    <tr><td class="paramname">state</td><td>The current state of the vehicle </td></tr>
    <tr><td class="paramname">state_time</td><td>The abosolute time which the provided vehicle state corresponds to</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A list of trajectory points to send to the carma planning stack </dd></dl>

<p class="definition">Definition at line <a class="el" href="basic__autonomy_8cpp_source.html#l00853">853</a> of file <a class="el" href="basic__autonomy_8cpp_source.html">basic_autonomy.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  856</span>        {</div>
<div class="line"><span class="lineno">  857</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;VehicleState: &quot;</span></div>
<div class="line"><span class="lineno">  858</span>                             &lt;&lt; <span class="stringliteral">&quot; x: &quot;</span> &lt;&lt; state.x_pos_global &lt;&lt; <span class="stringliteral">&quot; y: &quot;</span> &lt;&lt; state.y_pos_global &lt;&lt; <span class="stringliteral">&quot; yaw: &quot;</span> &lt;&lt; state.orientation</div>
<div class="line"><span class="lineno">  859</span>                             &lt;&lt; <span class="stringliteral">&quot; speed: &quot;</span> &lt;&lt; state.longitudinal_vel);</div>
<div class="line"><span class="lineno">  860</span> </div>
<div class="line"><span class="lineno">  861</span>            <a class="code hl_function" href="namespacebasic__autonomy_1_1log.html#abc6767d55d022e680ccd0d598eba5289">log::printDebugPerLine</a>(points, &amp;<a class="code hl_function" href="namespacebasic__autonomy_1_1log.html#aa5d9aec52bb2d67d8b163be5d2366c8e">log::pointSpeedPairToStream</a>);</div>
<div class="line"><span class="lineno">  862</span> </div>
<div class="line"><span class="lineno">  863</span>            <span class="keywordtype">int</span> nearest_pt_index = <a class="code hl_function" href="namespacebasic__autonomy_1_1waypoint__generation.html#a924ac023f1b51e791ca1b61b9194f44a">get_nearest_point_index</a>(points, state);</div>
<div class="line"><span class="lineno">  864</span> </div>
<div class="line"><span class="lineno">  865</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;NearestPtIndex: &quot;</span> &lt;&lt; nearest_pt_index);</div>
<div class="line"><span class="lineno">  866</span> </div>
<div class="line"><span class="lineno">  867</span>            std::vector&lt;PointSpeedPair&gt; future_points(points.begin() + nearest_pt_index + 1, points.end()); <span class="comment">// Points in front of current vehicle position</span></div>
<div class="line"><span class="lineno">  868</span> </div>
<div class="line"><span class="lineno">  869</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;Ready to call constrain_to_time_boundary: future_points size = &quot;</span> &lt;&lt; future_points.size() &lt;&lt; <span class="stringliteral">&quot;, trajectory_time_length = &quot;</span> &lt;&lt; detailed_config.<a class="code hl_variable" href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html#aeb772409ce5df1b078295282a353349f">trajectory_time_length</a>);</div>
<div class="line"><span class="lineno">  870</span> </div>
<div class="line"><span class="lineno">  871</span>            <span class="keyword">auto</span> time_bound_points = <a class="code hl_function" href="namespacebasic__autonomy_1_1waypoint__generation.html#af509efce135492493e13c9bb86329dcd">constrain_to_time_boundary</a>(future_points, detailed_config.<a class="code hl_variable" href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html#aeb772409ce5df1b078295282a353349f">trajectory_time_length</a>);</div>
<div class="line"><span class="lineno">  872</span> </div>
<div class="line"><span class="lineno">  873</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;Got time_bound_points with size:&quot;</span> &lt;&lt; time_bound_points.size());</div>
<div class="line"><span class="lineno">  874</span>            <a class="code hl_function" href="namespacebasic__autonomy_1_1log.html#abc6767d55d022e680ccd0d598eba5289">log::printDebugPerLine</a>(time_bound_points, &amp;<a class="code hl_function" href="namespacebasic__autonomy_1_1log.html#aa5d9aec52bb2d67d8b163be5d2366c8e">log::pointSpeedPairToStream</a>);</div>
<div class="line"><span class="lineno">  875</span> </div>
<div class="line"><span class="lineno">  876</span>            std::vector&lt;PointSpeedPair&gt; back_and_future = <a class="code hl_function" href="namespacebasic__autonomy_1_1waypoint__generation.html#af9a705cca66d75f0d2d8ce9e6ea2ee41">attach_past_points</a>(points, time_bound_points, nearest_pt_index, detailed_config.<a class="code hl_variable" href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html#a4c8a65b9797246e176f6245025e21b95">back_distance</a>);</div>
<div class="line"><span class="lineno">  877</span> </div>
<div class="line"><span class="lineno">  878</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;Got back_and_future points with size&quot;</span> &lt;&lt; back_and_future.size());</div>
<div class="line"><span class="lineno">  879</span>            <a class="code hl_function" href="namespacebasic__autonomy_1_1log.html#abc6767d55d022e680ccd0d598eba5289">log::printDebugPerLine</a>(back_and_future, &amp;<a class="code hl_function" href="namespacebasic__autonomy_1_1log.html#aa5d9aec52bb2d67d8b163be5d2366c8e">log::pointSpeedPairToStream</a>);</div>
<div class="line"><span class="lineno">  880</span> </div>
<div class="line"><span class="lineno">  881</span>            std::vector&lt;double&gt; speed_limits;</div>
<div class="line"><span class="lineno">  882</span>            std::vector&lt;lanelet::BasicPoint2d&gt; curve_points;</div>
<div class="line"><span class="lineno">  883</span>            <a class="code hl_function" href="namespacebasic__autonomy_1_1waypoint__generation.html#a0f07faaac8c54cc485f2bb217097326e">split_point_speed_pairs</a>(back_and_future, &amp;curve_points, &amp;speed_limits);</div>
<div class="line"><span class="lineno">  884</span> </div>
<div class="line"><span class="lineno">  885</span>            std::unique_ptr&lt;smoothing::SplineI&gt; fit_curve = <a class="code hl_function" href="namespacebasic__autonomy_1_1waypoint__generation.html#a9e0eab343d21d18c665083839d706f04">compute_fit</a>(curve_points); <span class="comment">// Compute splines based on curve points</span></div>
<div class="line"><span class="lineno">  886</span>            <span class="keywordflow">if</span> (!fit_curve)</div>
<div class="line"><span class="lineno">  887</span>            {</div>
<div class="line"><span class="lineno">  888</span>                <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;Could not fit a spline curve along the given trajectory!&quot;</span>);</div>
<div class="line"><span class="lineno">  889</span>            }</div>
<div class="line"><span class="lineno">  890</span> </div>
<div class="line"><span class="lineno">  891</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;Got fit&quot;</span>);</div>
<div class="line"><span class="lineno">  892</span> </div>
<div class="line"><span class="lineno">  893</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;speed_limits.size() &quot;</span> &lt;&lt; speed_limits.size());</div>
<div class="line"><span class="lineno">  894</span> </div>
<div class="line"><span class="lineno">  895</span>            std::vector&lt;lanelet::BasicPoint2d&gt; all_sampling_points;</div>
<div class="line"><span class="lineno">  896</span>            all_sampling_points.reserve(1 + curve_points.size() * 2);</div>
<div class="line"><span class="lineno">  897</span> </div>
<div class="line"><span class="lineno">  898</span>            std::vector&lt;double&gt; distributed_speed_limits;</div>
<div class="line"><span class="lineno">  899</span>            distributed_speed_limits.reserve(1 + curve_points.size() * 2);</div>
<div class="line"><span class="lineno">  900</span> </div>
<div class="line"><span class="lineno">  901</span>            <span class="comment">// compute total length of the trajectory to get correct number of points</span></div>
<div class="line"><span class="lineno">  902</span>            <span class="comment">// we expect using curve_resample_step_size</span></div>
<div class="line"><span class="lineno">  903</span>            std::vector&lt;double&gt; downtracks_raw = <a class="code hl_function" href="namespacecarma__wm_1_1geometry.html#adf1c6b7f1e33569b45074e4e5bbeff1d">carma_wm::geometry::compute_arc_lengths</a>(curve_points);</div>
<div class="line"><span class="lineno">  904</span> </div>
<div class="line"><span class="lineno">  905</span>            <span class="keyword">auto</span> total_step_along_curve = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(downtracks_raw.back() / detailed_config.<a class="code hl_variable" href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html#aed01f5b534f9dc52cc74022c71e2fa3c">curve_resample_step_size</a>);</div>
<div class="line"><span class="lineno">  906</span> </div>
<div class="line"><span class="lineno">  907</span>            <span class="keywordtype">int</span> current_speed_index = 0;</div>
<div class="line"><span class="lineno">  908</span>            <span class="keywordtype">size_t</span> total_point_size = curve_points.size();</div>
<div class="line"><span class="lineno">  909</span> </div>
<div class="line"><span class="lineno">  910</span>            <span class="keywordtype">double</span> step_threshold_for_next_speed = (double)total_step_along_curve / (<span class="keywordtype">double</span>)total_point_size;</div>
<div class="line"><span class="lineno">  911</span>            <span class="keywordtype">double</span> scaled_steps_along_curve = 0.0; <span class="comment">// from 0 (start) to 1 (end) for the whole trajectory</span></div>
<div class="line"><span class="lineno">  912</span>            std::vector&lt;double&gt; better_curvature;</div>
<div class="line"><span class="lineno">  913</span>            better_curvature.reserve(1 + curve_points.size() * 2);</div>
<div class="line"><span class="lineno">  914</span> </div>
<div class="line"><span class="lineno">  915</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> steps_along_curve = 0; steps_along_curve &lt; total_step_along_curve; steps_along_curve++) <span class="comment">// Resample curve at tighter resolution</span></div>
<div class="line"><span class="lineno">  916</span>            {</div>
<div class="line"><span class="lineno">  917</span>                lanelet::BasicPoint2d p = (*fit_curve)(scaled_steps_along_curve);</div>
<div class="line"><span class="lineno">  918</span> </div>
<div class="line"><span class="lineno">  919</span>                all_sampling_points.push_back(p);</div>
<div class="line"><span class="lineno">  920</span>                <span class="keywordtype">double</span> <a class="code hl_variable" href="namespaceprocess__traj__logs.html#a49cd466f330a9498d8373baecf47e071">c</a> = <a class="code hl_function" href="namespacebasic__autonomy_1_1waypoint__generation.html#ae4ca284ba04f4f76fb88bf8d20731835">compute_curvature_at</a>((*fit_curve), scaled_steps_along_curve);</div>
<div class="line"><span class="lineno">  921</span>                better_curvature.push_back(<a class="code hl_variable" href="namespaceprocess__traj__logs.html#a49cd466f330a9498d8373baecf47e071">c</a>);</div>
<div class="line"><span class="lineno">  922</span>                <span class="keywordflow">if</span> ((<span class="keywordtype">double</span>)steps_along_curve &gt; step_threshold_for_next_speed)</div>
<div class="line"><span class="lineno">  923</span>                {</div>
<div class="line"><span class="lineno">  924</span>                    step_threshold_for_next_speed += (double)total_step_along_curve / (<span class="keywordtype">double</span>)total_point_size;</div>
<div class="line"><span class="lineno">  925</span>                    current_speed_index++;</div>
<div class="line"><span class="lineno">  926</span>                }</div>
<div class="line"><span class="lineno">  927</span>                distributed_speed_limits.push_back(speed_limits[current_speed_index]); <span class="comment">// Identify speed limits for resampled points</span></div>
<div class="line"><span class="lineno">  928</span>                scaled_steps_along_curve += 1.0 / total_step_along_curve;              <span class="comment">//adding steps_along_curve_step_size</span></div>
<div class="line"><span class="lineno">  929</span>            }</div>
<div class="line"><span class="lineno">  930</span> </div>
<div class="line"><span class="lineno">  931</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;Got sampled points with size:&quot;</span> &lt;&lt; all_sampling_points.size());</div>
<div class="line"><span class="lineno">  932</span>            <a class="code hl_function" href="namespacebasic__autonomy_1_1log.html#abc6767d55d022e680ccd0d598eba5289">log::printDebugPerLine</a>(all_sampling_points, &amp;<a class="code hl_function" href="namespacebasic__autonomy_1_1log.html#a9123a8bedcfb34f1e6c1336f226956fb">log::basicPointToStream</a>);</div>
<div class="line"><span class="lineno">  933</span> </div>
<div class="line"><span class="lineno">  934</span>            std::vector&lt;double&gt; final_yaw_values = <a class="code hl_function" href="namespacecarma__wm_1_1geometry.html#ad8a3ee0bf06f85a6e7a8b5097251da2b">carma_wm::geometry::compute_tangent_orientations</a>(all_sampling_points);</div>
<div class="line"><span class="lineno">  935</span> </div>
<div class="line"><span class="lineno">  936</span>            <a class="code hl_function" href="namespacebasic__autonomy_1_1log.html#a54dc1b131f40912ecbf27ce0f42bc782">log::printDoublesPerLineWithPrefix</a>(<span class="stringliteral">&quot;raw_curvatures[i]: &quot;</span>, better_curvature);</div>
<div class="line"><span class="lineno">  937</span> </div>
<div class="line"><span class="lineno">  938</span>            std::vector&lt;double&gt; curvatures = <a class="code hl_function" href="namespacebasic__autonomy_1_1smoothing.html#afb726e75a21ada8efa3ca5561ffc9984">smoothing::moving_average_filter</a>(better_curvature, detailed_config.<a class="code hl_variable" href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html#a60a7d101e04a9a2bf755b8c5a9741354">curvature_moving_average_window_size</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  939</span>            std::vector&lt;double&gt; ideal_speeds =</div>
<div class="line"><span class="lineno">  940</span>                trajectory_utils::constrained_speeds_for_curvatures(curvatures, detailed_config.<a class="code hl_variable" href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html#a75872d4c289f3eda6a9a6cfca337534b">lateral_accel_limit</a>);</div>
<div class="line"><span class="lineno">  941</span> </div>
<div class="line"><span class="lineno">  942</span>            <a class="code hl_function" href="namespacebasic__autonomy_1_1log.html#a54dc1b131f40912ecbf27ce0f42bc782">log::printDoublesPerLineWithPrefix</a>(<span class="stringliteral">&quot;curvatures[i]: &quot;</span>, curvatures);</div>
<div class="line"><span class="lineno">  943</span>            <a class="code hl_function" href="namespacebasic__autonomy_1_1log.html#a54dc1b131f40912ecbf27ce0f42bc782">log::printDoublesPerLineWithPrefix</a>(<span class="stringliteral">&quot;ideal_speeds: &quot;</span>, ideal_speeds);</div>
<div class="line"><span class="lineno">  944</span>            <a class="code hl_function" href="namespacebasic__autonomy_1_1log.html#a54dc1b131f40912ecbf27ce0f42bc782">log::printDoublesPerLineWithPrefix</a>(<span class="stringliteral">&quot;final_yaw_values[i]: &quot;</span>, final_yaw_values);</div>
<div class="line"><span class="lineno">  945</span> </div>
<div class="line"><span class="lineno">  946</span>            std::vector&lt;double&gt; constrained_speed_limits = <a class="code hl_function" href="namespacebasic__autonomy_1_1waypoint__generation.html#ab4974a3dfe697ccc0dd1344a8e11c5e1">apply_speed_limits</a>(ideal_speeds, distributed_speed_limits);</div>
<div class="line"><span class="lineno">  947</span> </div>
<div class="line"><span class="lineno">  948</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;Processed all points in computed fit&quot;</span>);</div>
<div class="line"><span class="lineno">  949</span> </div>
<div class="line"><span class="lineno">  950</span>            <span class="keywordflow">if</span> (all_sampling_points.empty())</div>
<div class="line"><span class="lineno">  951</span>            {</div>
<div class="line"><span class="lineno">  952</span>                RCLCPP_WARN_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;No trajectory points could be generated&quot;</span>);</div>
<div class="line"><span class="lineno">  953</span>                <span class="keywordflow">return</span> {};</div>
<div class="line"><span class="lineno">  954</span>            }</div>
<div class="line"><span class="lineno">  955</span> </div>
<div class="line"><span class="lineno">  956</span>            <span class="comment">// Add current vehicle point to front of the trajectory</span></div>
<div class="line"><span class="lineno">  957</span> </div>
<div class="line"><span class="lineno">  958</span>            nearest_pt_index = <a class="code hl_function" href="namespacebasic__autonomy_1_1waypoint__generation.html#aa399a236f88f7b1c5557327fbb2ba71a">get_nearest_index_by_downtrack</a>(all_sampling_points, wm, state);</div>
<div class="line"><span class="lineno">  959</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;Current state&#39;s nearest_pt_index: &quot;</span> &lt;&lt; nearest_pt_index);</div>
<div class="line"><span class="lineno">  960</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;Curvature right now: &quot;</span> &lt;&lt; better_curvature[nearest_pt_index] &lt;&lt; <span class="stringliteral">&quot;, at state x: &quot;</span> &lt;&lt; state.x_pos_global &lt;&lt; <span class="stringliteral">&quot;, state y: &quot;</span> &lt;&lt; state.y_pos_global);</div>
<div class="line"><span class="lineno">  961</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;Corresponding to point: x: &quot;</span> &lt;&lt; all_sampling_points[nearest_pt_index].<a class="code hl_variable" href="namespaceprocess__traj__logs.html#af3ba6144a2d35a4990f1a8d04632a052">x</a>() &lt;&lt; <span class="stringliteral">&quot;, y:&quot;</span> &lt;&lt; all_sampling_points[nearest_pt_index].<a class="code hl_variable" href="namespaceprocess__traj__logs.html#a05bdb238bfbf3836fb0aa69c5aa1bb48">y</a>());</div>
<div class="line"><span class="lineno">  962</span> </div>
<div class="line"><span class="lineno">  963</span>            <span class="keywordtype">int</span> buffer_pt_index = <a class="code hl_function" href="namespacebasic__autonomy_1_1waypoint__generation.html#aa399a236f88f7b1c5557327fbb2ba71a">get_nearest_index_by_downtrack</a>(all_sampling_points, wm, ending_state_before_buffer);</div>
<div class="line"><span class="lineno">  964</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;Ending state&#39;s index before applying buffer (buffer_pt_index): &quot;</span> &lt;&lt; buffer_pt_index);</div>
<div class="line"><span class="lineno">  965</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;Corresponding to point: x: &quot;</span> &lt;&lt; all_sampling_points[buffer_pt_index].<a class="code hl_variable" href="namespaceprocess__traj__logs.html#af3ba6144a2d35a4990f1a8d04632a052">x</a>() &lt;&lt; <span class="stringliteral">&quot;, y:&quot;</span> &lt;&lt; all_sampling_points[buffer_pt_index].<a class="code hl_variable" href="namespaceprocess__traj__logs.html#a05bdb238bfbf3836fb0aa69c5aa1bb48">y</a>());</div>
<div class="line"><span class="lineno">  966</span> </div>
<div class="line"><span class="lineno">  967</span>            <span class="keywordflow">if</span>(nearest_pt_index + 1 &gt;= buffer_pt_index){</div>
<div class="line"><span class="lineno">  968</span>                </div>
<div class="line"><span class="lineno">  969</span>                lanelet::BasicPoint2d current_pos(state.x_pos_global, state.y_pos_global);</div>
<div class="line"><span class="lineno">  970</span>                lanelet::BasicPoint2d ending_pos(ending_state_before_buffer.x_pos_global, ending_state_before_buffer.y_pos_global);</div>
<div class="line"><span class="lineno">  971</span> </div>
<div class="line"><span class="lineno">  972</span>                <span class="keywordflow">if</span>(wm-&gt;routeTrackPos(ending_pos).downtrack &lt; wm-&gt;routeTrackPos(current_pos).downtrack ){</div>
<div class="line"><span class="lineno">  973</span> </div>
<div class="line"><span class="lineno">  974</span>                    RCLCPP_WARN_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;Current state is at or past the planned end distance. Couldn&#39;t generate trajectory&quot;</span>);</div>
<div class="line"><span class="lineno">  975</span>                    <span class="keywordflow">return</span> {};</div>
<div class="line"><span class="lineno">  976</span>                }</div>
<div class="line"><span class="lineno">  977</span>                <span class="keywordflow">else</span>{</div>
<div class="line"><span class="lineno">  978</span>                    <span class="comment">//Current point is behind the ending state of maneuver and a valid trajectory is possible</span></div>
<div class="line"><span class="lineno">  979</span>                    RCLCPP_WARN_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;Returning the two remaining points in the maneuver&quot;</span>);</div>
<div class="line"><span class="lineno">  980</span> </div>
<div class="line"><span class="lineno">  981</span>                    std::vector&lt;lanelet::BasicPoint2d&gt; remaining_traj_points = {current_pos, ending_pos};</div>
<div class="line"><span class="lineno">  982</span> </div>
<div class="line"><span class="lineno">  983</span>                    std::vector&lt;double&gt; downtracks = <a class="code hl_function" href="namespacecarma__wm_1_1geometry.html#adf1c6b7f1e33569b45074e4e5bbeff1d">carma_wm::geometry::compute_arc_lengths</a>(remaining_traj_points);</div>
<div class="line"><span class="lineno">  984</span>                    std::vector&lt;double&gt; speeds = {state.longitudinal_vel, state.longitudinal_vel};<span class="comment">//Keep current speed</span></div>
<div class="line"><span class="lineno">  985</span>                    std::vector&lt;double&gt; times;</div>
<div class="line"><span class="lineno">  986</span>                    trajectory_utils::conversions::speed_to_time(downtracks, speeds, &amp;times);</div>
<div class="line"><span class="lineno">  987</span>                    std::vector&lt;double&gt; yaw = {state.orientation, state.orientation}; <span class="comment">//Keep current orientation</span></div>
<div class="line"><span class="lineno">  988</span> </div>
<div class="line"><span class="lineno">  989</span>                    std::vector&lt;carma_planning_msgs::msg::TrajectoryPlanPoint&gt; traj_points =</div>
<div class="line"><span class="lineno">  990</span>                    <a class="code hl_function" href="namespacebasic__autonomy_1_1waypoint__generation.html#aba6a29cdaf0c4af10647b59bf6df4e01">trajectory_from_points_times_orientations</a>(remaining_traj_points, times, yaw, state_time, detailed_config.<a class="code hl_variable" href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html#a89ca36377e20e514abc609c5bd65a941">desired_controller_plugin</a>);</div>
<div class="line"><span class="lineno">  991</span> </div>
<div class="line"><span class="lineno">  992</span>                    <span class="keywordflow">return</span> traj_points;</div>
<div class="line"><span class="lineno">  993</span> </div>
<div class="line"><span class="lineno">  994</span>                }</div>
<div class="line"><span class="lineno">  995</span>            }</div>
<div class="line"><span class="lineno">  996</span> </div>
<div class="line"><span class="lineno">  997</span>            <span class="comment">//drop buffer points here</span></div>
<div class="line"><span class="lineno">  998</span> </div>
<div class="line"><span class="lineno">  999</span>             std::vector&lt;lanelet::BasicPoint2d&gt; future_basic_points(all_sampling_points.begin() + nearest_pt_index + 1,</div>
<div class="line"><span class="lineno"> 1000</span>                                            all_sampling_points.begin()+ buffer_pt_index);  <span class="comment">// Points in front of current vehicle position</span></div>
<div class="line"><span class="lineno"> 1001</span> </div>
<div class="line"><span class="lineno"> 1002</span>            std::vector&lt;double&gt; future_speeds(constrained_speed_limits.begin() + nearest_pt_index + 1,</div>
<div class="line"><span class="lineno"> 1003</span>                                                        constrained_speed_limits.begin() + buffer_pt_index);  <span class="comment">// Points in front of current vehicle position</span></div>
<div class="line"><span class="lineno"> 1004</span>            std::vector&lt;double&gt; future_yaw(final_yaw_values.begin() + nearest_pt_index + 1,</div>
<div class="line"><span class="lineno"> 1005</span>                                                        final_yaw_values.begin() + buffer_pt_index);  <span class="comment">// Points in front of current vehicle position</span></div>
<div class="line"><span class="lineno"> 1006</span>            std::vector&lt;double&gt;  final_actual_speeds = future_speeds;</div>
<div class="line"><span class="lineno"> 1007</span>            all_sampling_points = future_basic_points;</div>
<div class="line"><span class="lineno"> 1008</span>            final_yaw_values = future_yaw;</div>
<div class="line"><span class="lineno"> 1009</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;Trimmed future points to size: &quot;</span>&lt;&lt; future_basic_points.size());</div>
<div class="line"><span class="lineno"> 1010</span> </div>
<div class="line"><span class="lineno"> 1011</span>            lanelet::BasicPoint2d cur_veh_point(state.x_pos_global, state.y_pos_global);</div>
<div class="line"><span class="lineno"> 1012</span> </div>
<div class="line"><span class="lineno"> 1013</span>            all_sampling_points.insert(all_sampling_points.begin(),</div>
<div class="line"><span class="lineno"> 1014</span>                                       cur_veh_point); <span class="comment">// Add current vehicle position to front of sample points</span></div>
<div class="line"><span class="lineno"> 1015</span> </div>
<div class="line"><span class="lineno"> 1016</span>            final_actual_speeds.insert(final_actual_speeds.begin(), state.longitudinal_vel);</div>
<div class="line"><span class="lineno"> 1017</span> </div>
<div class="line"><span class="lineno"> 1018</span>            final_yaw_values.insert(final_yaw_values.begin(), state.orientation);</div>
<div class="line"><span class="lineno"> 1019</span> </div>
<div class="line"><span class="lineno"> 1020</span>            <span class="comment">// Compute points to local downtracks</span></div>
<div class="line"><span class="lineno"> 1021</span>            std::vector&lt;double&gt; downtracks = <a class="code hl_function" href="namespacecarma__wm_1_1geometry.html#adf1c6b7f1e33569b45074e4e5bbeff1d">carma_wm::geometry::compute_arc_lengths</a>(all_sampling_points);</div>
<div class="line"><span class="lineno"> 1022</span> </div>
<div class="line"><span class="lineno"> 1023</span>            <span class="comment">// Apply accel limits</span></div>
<div class="line"><span class="lineno"> 1024</span>            final_actual_speeds = <a class="code hl_function" href="namespacebasic__autonomy_1_1waypoint__generation.html#a84a6c11da2d9736a8f277b6afd124100">optimize_speed</a>(downtracks, final_actual_speeds, detailed_config.<a class="code hl_variable" href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html#ac27f6c12b09f9cc22e608ec1be16477c">max_accel</a>);</div>
<div class="line"><span class="lineno"> 1025</span> </div>
<div class="line"><span class="lineno"> 1026</span>            <a class="code hl_function" href="namespacebasic__autonomy_1_1log.html#a54dc1b131f40912ecbf27ce0f42bc782">log::printDoublesPerLineWithPrefix</a>(<span class="stringliteral">&quot;postAccel[i]: &quot;</span>, final_actual_speeds);</div>
<div class="line"><span class="lineno"> 1027</span> </div>
<div class="line"><span class="lineno"> 1028</span>            final_actual_speeds = <a class="code hl_function" href="namespacebasic__autonomy_1_1smoothing.html#afb726e75a21ada8efa3ca5561ffc9984">smoothing::moving_average_filter</a>(final_actual_speeds, detailed_config.<a class="code hl_variable" href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html#a4a883bd5094bdc768c05d0c3a751f219">speed_moving_average_window_size</a>);</div>
<div class="line"><span class="lineno"> 1029</span> </div>
<div class="line"><span class="lineno"> 1030</span>            <a class="code hl_function" href="namespacebasic__autonomy_1_1log.html#a54dc1b131f40912ecbf27ce0f42bc782">log::printDoublesPerLineWithPrefix</a>(<span class="stringliteral">&quot;post_average[i]: &quot;</span>, final_actual_speeds);</div>
<div class="line"><span class="lineno"> 1031</span> </div>
<div class="line"><span class="lineno"> 1032</span>            <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;s : final_actual_speeds) <span class="comment">// Limit minimum speed. TODO how to handle stopping?</span></div>
<div class="line"><span class="lineno"> 1033</span>            {</div>
<div class="line"><span class="lineno"> 1034</span>                s = std::max(s, detailed_config.<a class="code hl_variable" href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html#a4bf547260f4eb35b2df2a8ddb5b216c8">minimum_speed</a>);</div>
<div class="line"><span class="lineno"> 1035</span>            }</div>
<div class="line"><span class="lineno"> 1036</span> </div>
<div class="line"><span class="lineno"> 1037</span>            <a class="code hl_function" href="namespacebasic__autonomy_1_1log.html#a54dc1b131f40912ecbf27ce0f42bc782">log::printDoublesPerLineWithPrefix</a>(<span class="stringliteral">&quot;post_min_speed[i]: &quot;</span>, final_actual_speeds);</div>
<div class="line"><span class="lineno"> 1038</span> </div>
<div class="line"><span class="lineno"> 1039</span>            <span class="comment">// Convert speeds to times</span></div>
<div class="line"><span class="lineno"> 1040</span>            std::vector&lt;double&gt; times;</div>
<div class="line"><span class="lineno"> 1041</span>            trajectory_utils::conversions::speed_to_time(downtracks, final_actual_speeds, &amp;times);</div>
<div class="line"><span class="lineno"> 1042</span> </div>
<div class="line"><span class="lineno"> 1043</span>            <a class="code hl_function" href="namespacebasic__autonomy_1_1log.html#a54dc1b131f40912ecbf27ce0f42bc782">log::printDoublesPerLineWithPrefix</a>(<span class="stringliteral">&quot;times[i]: &quot;</span>, times);</div>
<div class="line"><span class="lineno"> 1044</span> </div>
<div class="line"><span class="lineno"> 1045</span>            <span class="comment">// Build trajectory points</span></div>
<div class="line"><span class="lineno"> 1046</span>            std::vector&lt;carma_planning_msgs::msg::TrajectoryPlanPoint&gt; traj_points =</div>
<div class="line"><span class="lineno"> 1047</span>                <a class="code hl_function" href="namespacebasic__autonomy_1_1waypoint__generation.html#aba6a29cdaf0c4af10647b59bf6df4e01">trajectory_from_points_times_orientations</a>(all_sampling_points, times, final_yaw_values, state_time, detailed_config.<a class="code hl_variable" href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html#a89ca36377e20e514abc609c5bd65a941">desired_controller_plugin</a>);</div>
<div class="line"><span class="lineno"> 1048</span> </div>
<div class="line"><span class="lineno"> 1049</span>            <span class="comment">//debug msg</span></div>
<div class="line"><span class="lineno"> 1050</span>            carma_debug_ros2_msgs::msg::TrajectoryCurvatureSpeeds msg;</div>
<div class="line"><span class="lineno"> 1051</span>            msg.velocity_profile = final_actual_speeds;</div>
<div class="line"><span class="lineno"> 1052</span>            msg.relative_downtrack = downtracks;</div>
<div class="line"><span class="lineno"> 1053</span>            msg.tangent_headings = final_yaw_values;</div>
<div class="line"><span class="lineno"> 1054</span>            std::vector&lt;double&gt; aligned_speed_limits(constrained_speed_limits.begin() + nearest_pt_index,</div>
<div class="line"><span class="lineno"> 1055</span>                                                    constrained_speed_limits.end());</div>
<div class="line"><span class="lineno"> 1056</span> </div>
<div class="line"><span class="lineno"> 1057</span>            msg.speed_limits = aligned_speed_limits;</div>
<div class="line"><span class="lineno"> 1058</span>            std::vector&lt;double&gt; aligned_curvatures(curvatures.begin() + nearest_pt_index,</div>
<div class="line"><span class="lineno"> 1059</span>                                                    curvatures.end());</div>
<div class="line"><span class="lineno"> 1060</span>            msg.curvatures = aligned_curvatures;</div>
<div class="line"><span class="lineno"> 1061</span>            msg.lat_accel_limit = detailed_config.<a class="code hl_variable" href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html#a75872d4c289f3eda6a9a6cfca337534b">lateral_accel_limit</a>;</div>
<div class="line"><span class="lineno"> 1062</span>            msg.lon_accel_limit = detailed_config.<a class="code hl_variable" href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html#ac27f6c12b09f9cc22e608ec1be16477c">max_accel</a>;</div>
<div class="line"><span class="lineno"> 1063</span>            msg.starting_state = state;</div>
<div class="line"><span class="lineno"> 1064</span>            debug_msg = msg;                                        </div>
<div class="line"><span class="lineno"> 1065</span>            </div>
<div class="line"><span class="lineno"> 1066</span> </div>
<div class="line"><span class="lineno"> 1067</span>            <span class="keywordflow">return</span> traj_points;</div>
<div class="line"><span class="lineno"> 1068</span>        }</div>
<div class="ttc" id="anamespacebasic__autonomy_1_1log_html_a54dc1b131f40912ecbf27ce0f42bc782"><div class="ttname"><a href="namespacebasic__autonomy_1_1log.html#a54dc1b131f40912ecbf27ce0f42bc782">basic_autonomy::log::printDoublesPerLineWithPrefix</a></div><div class="ttdeci">void printDoublesPerLineWithPrefix(const std::string &amp;prefix, const std::vector&lt; double &gt; &amp;values)</div><div class="ttdoc">Print a RCLCPP_DEBUG_STREAM for each value in values where the printed value is &lt;&lt; prefix &lt;&lt; value.</div><div class="ttdef"><b>Definition:</b> <a href="log_8cpp_source.html#l00045">log.cpp:45</a></div></div>
<div class="ttc" id="anamespacebasic__autonomy_1_1log_html_a9123a8bedcfb34f1e6c1336f226956fb"><div class="ttname"><a href="namespacebasic__autonomy_1_1log.html#a9123a8bedcfb34f1e6c1336f226956fb">basic_autonomy::log::basicPointToStream</a></div><div class="ttdeci">std::string basicPointToStream(lanelet::BasicPoint2d point)</div><div class="ttdoc">Helper function to convert a lanelet::BasicPoint2d to a string.</div><div class="ttdef"><b>Definition:</b> <a href="log_8cpp_source.html#l00026">log.cpp:26</a></div></div>
<div class="ttc" id="anamespacebasic__autonomy_1_1log_html_aa5d9aec52bb2d67d8b163be5d2366c8e"><div class="ttname"><a href="namespacebasic__autonomy_1_1log.html#aa5d9aec52bb2d67d8b163be5d2366c8e">basic_autonomy::log::pointSpeedPairToStream</a></div><div class="ttdeci">std::string pointSpeedPairToStream(waypoint_generation::PointSpeedPair point)</div><div class="ttdoc">Helper function to convert a PointSpeedPair to a string.</div><div class="ttdef"><b>Definition:</b> <a href="log_8cpp_source.html#l00035">log.cpp:35</a></div></div>
<div class="ttc" id="anamespacebasic__autonomy_1_1log_html_abc6767d55d022e680ccd0d598eba5289"><div class="ttname"><a href="namespacebasic__autonomy_1_1log.html#abc6767d55d022e680ccd0d598eba5289">basic_autonomy::log::printDebugPerLine</a></div><div class="ttdeci">void printDebugPerLine(const std::vector&lt; T &gt; &amp;values, std::function&lt; std::string(T)&gt; func)</div><div class="ttdoc">Print a RCLCPP_DEBUG_STREAM for each value in values where the printed value is a string returned by ...</div><div class="ttdef"><b>Definition:</b> <a href="basic__autonomy_2include_2basic__autonomy_2log_2log_8hpp_source.html#l00040">log.hpp:40</a></div></div>
<div class="ttc" id="anamespacebasic__autonomy_1_1waypoint__generation_html_a84a6c11da2d9736a8f277b6afd124100"><div class="ttname"><a href="namespacebasic__autonomy_1_1waypoint__generation.html#a84a6c11da2d9736a8f277b6afd124100">basic_autonomy::waypoint_generation::optimize_speed</a></div><div class="ttdeci">std::vector&lt; double &gt; optimize_speed(const std::vector&lt; double &gt; &amp;downtracks, const std::vector&lt; double &gt; &amp;curv_speeds, double accel_limit)</div><div class="ttdoc">Applies the longitudinal acceleration limit to each point's speed.</div><div class="ttdef"><b>Definition:</b> <a href="basic__autonomy_8cpp_source.html#l00687">basic_autonomy.cpp:687</a></div></div>
<div class="ttc" id="anamespacebasic__autonomy_1_1waypoint__generation_html_a924ac023f1b51e791ca1b61b9194f44a"><div class="ttname"><a href="namespacebasic__autonomy_1_1waypoint__generation.html#a924ac023f1b51e791ca1b61b9194f44a">basic_autonomy::waypoint_generation::get_nearest_point_index</a></div><div class="ttdeci">int get_nearest_point_index(const std::vector&lt; lanelet::BasicPoint2d &gt; &amp;points, const carma_planning_msgs::msg::VehicleState &amp;state)</div><div class="ttdoc">Returns the nearest point (in terms of cartesian 2d distance) to the provided vehicle pose in the pro...</div><div class="ttdef"><b>Definition:</b> <a href="helper__functions_8cpp_source.html#l00024">helper_functions.cpp:24</a></div></div>
<div class="ttc" id="anamespacebasic__autonomy_1_1waypoint__generation_html_ab4974a3dfe697ccc0dd1344a8e11c5e1"><div class="ttname"><a href="namespacebasic__autonomy_1_1waypoint__generation.html#ab4974a3dfe697ccc0dd1344a8e11c5e1">basic_autonomy::waypoint_generation::apply_speed_limits</a></div><div class="ttdeci">std::vector&lt; double &gt; apply_speed_limits(const std::vector&lt; double &gt; speeds, const std::vector&lt; double &gt; speed_limits)</div><div class="ttdoc">Applies the provided speed limits to the provided speeds such that each element is capped at its corr...</div><div class="ttdef"><b>Definition:</b> <a href="basic__autonomy_8cpp_source.html#l00604">basic_autonomy.cpp:604</a></div></div>
<div class="ttc" id="anamespacebasic__autonomy_1_1waypoint__generation_html_ae4ca284ba04f4f76fb88bf8d20731835"><div class="ttname"><a href="namespacebasic__autonomy_1_1waypoint__generation.html#ae4ca284ba04f4f76fb88bf8d20731835">basic_autonomy::waypoint_generation::compute_curvature_at</a></div><div class="ttdeci">double compute_curvature_at(const basic_autonomy::smoothing::SplineI &amp;fit_curve, double step_along_the_curve)</div><div class="ttdoc">Given the curvature fit, computes the curvature at the given step along the curve.</div><div class="ttdef"><b>Definition:</b> <a href="basic__autonomy_8cpp_source.html#l00843">basic_autonomy.cpp:843</a></div></div>
<div class="ttc" id="anamespacebasic__autonomy_1_1waypoint__generation_html_af509efce135492493e13c9bb86329dcd"><div class="ttname"><a href="namespacebasic__autonomy_1_1waypoint__generation.html#af509efce135492493e13c9bb86329dcd">basic_autonomy::waypoint_generation::constrain_to_time_boundary</a></div><div class="ttdeci">std::vector&lt; PointSpeedPair &gt; constrain_to_time_boundary(const std::vector&lt; PointSpeedPair &gt; &amp;points, double time_span)</div><div class="ttdoc">Reduces the input points to only those points that fit within the provided time boundary.</div><div class="ttdef"><b>Definition:</b> <a href="basic__autonomy_8cpp_source.html#l00631">basic_autonomy.cpp:631</a></div></div>
<div class="ttc" id="anamespacebasic__autonomy_1_1waypoint__generation_html_af9a705cca66d75f0d2d8ce9e6ea2ee41"><div class="ttname"><a href="namespacebasic__autonomy_1_1waypoint__generation.html#af9a705cca66d75f0d2d8ce9e6ea2ee41">basic_autonomy::waypoint_generation::attach_past_points</a></div><div class="ttdeci">std::vector&lt; PointSpeedPair &gt; attach_past_points(const std::vector&lt; PointSpeedPair &gt; &amp;points_set, std::vector&lt; PointSpeedPair &gt; future_points, const int nearest_pt_index, double back_distance)</div><div class="ttdoc">Attaches back_distance length of points behind the future points.</div><div class="ttdef"><b>Definition:</b> <a href="basic__autonomy_8cpp_source.html#l00781">basic_autonomy.cpp:781</a></div></div>
<div class="ttc" id="anamespaceprocess__traj__logs_html_a05bdb238bfbf3836fb0aa69c5aa1bb48"><div class="ttname"><a href="namespaceprocess__traj__logs.html#a05bdb238bfbf3836fb0aa69c5aa1bb48">process_traj_logs.y</a></div><div class="ttdeci">y</div><div class="ttdef"><b>Definition:</b> <a href="process__traj__logs_8py_source.html#l00129">process_traj_logs.py:129</a></div></div>
<div class="ttc" id="anamespaceprocess__traj__logs_html_a49cd466f330a9498d8373baecf47e071"><div class="ttname"><a href="namespaceprocess__traj__logs.html#a49cd466f330a9498d8373baecf47e071">process_traj_logs.c</a></div><div class="ttdeci">c</div><div class="ttdef"><b>Definition:</b> <a href="process__traj__logs_8py_source.html#l00166">process_traj_logs.py:166</a></div></div>
<div class="ttc" id="anamespaceprocess__traj__logs_html_af3ba6144a2d35a4990f1a8d04632a052"><div class="ttname"><a href="namespaceprocess__traj__logs.html#af3ba6144a2d35a4990f1a8d04632a052">process_traj_logs.x</a></div><div class="ttdeci">x</div><div class="ttdef"><b>Definition:</b> <a href="process__traj__logs_8py_source.html#l00128">process_traj_logs.py:128</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="basic__autonomy_8cpp_source.html#l00604">apply_speed_limits()</a>, <a class="el" href="basic__autonomy_8cpp_source.html#l00781">attach_past_points()</a>, <a class="el" href="basic__autonomy_8hpp_source.html#l00088">basic_autonomy::waypoint_generation::DetailedTrajConfig::back_distance</a>, <a class="el" href="basic__autonomy_8hpp_source.html#l00062">BASIC_AUTONOMY_LOGGER</a>, <a class="el" href="log_8cpp_source.html#l00026">basic_autonomy::log::basicPointToStream()</a>, <a class="el" href="process__traj__logs_8py_source.html#l00166">process_traj_logs::c</a>, <a class="el" href="Geometry_8cpp_source.html#l00498">carma_wm::geometry::compute_arc_lengths()</a>, <a class="el" href="basic__autonomy_8cpp_source.html#l00843">compute_curvature_at()</a>, <a class="el" href="basic__autonomy_8cpp_source.html#l00806">compute_fit()</a>, <a class="el" href="Geometry_8cpp_source.html#l00559">carma_wm::geometry::compute_tangent_orientations()</a>, <a class="el" href="basic__autonomy_8cpp_source.html#l00631">constrain_to_time_boundary()</a>, <a class="el" href="basic__autonomy_8hpp_source.html#l00086">basic_autonomy::waypoint_generation::DetailedTrajConfig::curvature_moving_average_window_size</a>, <a class="el" href="basic__autonomy_8hpp_source.html#l00081">basic_autonomy::waypoint_generation::DetailedTrajConfig::curve_resample_step_size</a>, <a class="el" href="basic__autonomy_8hpp_source.html#l00090">basic_autonomy::waypoint_generation::DetailedTrajConfig::desired_controller_plugin</a>, <a class="el" href="helper__functions_8cpp_source.html#l00065">get_nearest_index_by_downtrack()</a>, <a class="el" href="helper__functions_8cpp_source.html#l00024">get_nearest_point_index()</a>, <a class="el" href="basic__autonomy_8hpp_source.html#l00084">basic_autonomy::waypoint_generation::DetailedTrajConfig::lateral_accel_limit</a>, <a class="el" href="basic__autonomy_8hpp_source.html#l00083">basic_autonomy::waypoint_generation::DetailedTrajConfig::max_accel</a>, <a class="el" href="basic__autonomy_8hpp_source.html#l00082">basic_autonomy::waypoint_generation::DetailedTrajConfig::minimum_speed</a>, <a class="el" href="filters_8cpp_source.html#l00024">basic_autonomy::smoothing::moving_average_filter()</a>, <a class="el" href="basic__autonomy_8cpp_source.html#l00687">optimize_speed()</a>, <a class="el" href="log_8cpp_source.html#l00035">basic_autonomy::log::pointSpeedPairToStream()</a>, <a class="el" href="basic__autonomy_2include_2basic__autonomy_2log_2log_8hpp_source.html#l00040">basic_autonomy::log::printDebugPerLine()</a>, <a class="el" href="log_8cpp_source.html#l00045">basic_autonomy::log::printDoublesPerLineWithPrefix()</a>, <a class="el" href="basic__autonomy_8hpp_source.html#l00085">basic_autonomy::waypoint_generation::DetailedTrajConfig::speed_moving_average_window_size</a>, <a class="el" href="helper__functions_8cpp_source.html#l00083">split_point_speed_pairs()</a>, <a class="el" href="basic__autonomy_8cpp_source.html#l00750">trajectory_from_points_times_orientations()</a>, <a class="el" href="basic__autonomy_8hpp_source.html#l00080">basic_autonomy::waypoint_generation::DetailedTrajConfig::trajectory_time_length</a>, <a class="el" href="process__traj__logs_8py_source.html#l00128">process_traj_logs::x</a>, and <a class="el" href="process__traj__logs_8py_source.html#l00129">process_traj_logs::y</a>.</p>

<p class="reference">Referenced by <a class="el" href="inlanecruising__plugin_8cpp_source.html#l00049">inlanecruising_plugin::InLaneCruisingPlugin::plan_trajectory_callback()</a>, <a class="el" href="platooning__tactical__plugin_8cpp_source.html#l00044">platooning_tactical_plugin::PlatooningTacticalPlugin::plan_trajectory_cb()</a>, and <a class="el" href="light__controlled__intersection__tactical__plugin_8cpp_source.html#l00028">light_controlled_intersection_tactical_plugin::LightControlledIntersectionTacticalPlugin::planTrajectoryCB()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebasic__autonomy_1_1waypoint__generation_ad633c0c515eae2b1752ad96031e01ef8_cgraph.png" border="0" usemap="#anamespacebasic__autonomy_1_1waypoint__generation_ad633c0c515eae2b1752ad96031e01ef8_cgraph" alt=""/></div>
<map name="anamespacebasic__autonomy_1_1waypoint__generation_ad633c0c515eae2b1752ad96031e01ef8_cgraph" id="anamespacebasic__autonomy_1_1waypoint__generation_ad633c0c515eae2b1752ad96031e01ef8_cgraph">
<area shape="rect" title="Method converts a list of lanelet centerline points and current vehicle state into a usable list of t..." alt="" coords="5,499,219,555"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#ab4974a3dfe697ccc0dd1344a8e11c5e1" title="Applies the provided speed limits to the provided speeds such that each element is capped at its corr..." alt="" coords="276,5,481,47"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#af9a705cca66d75f0d2d8ce9e6ea2ee41" title="Attaches back_distance length of points behind the future points." alt="" coords="276,71,481,112"/>
<area shape="rect" href="namespacebasic__autonomy_1_1log.html#a9123a8bedcfb34f1e6c1336f226956fb" title="Helper function to convert a lanelet::BasicPoint2d to a string." alt="" coords="573,328,719,369"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#adf1c6b7f1e33569b45074e4e5bbeff1d" title="Compute the arc length at each point around the curve." alt="" coords="570,473,722,515"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#ae4ca284ba04f4f76fb88bf8d20731835" title="Given the curvature fit, computes the curvature at the given step along the curve." alt="" coords="267,136,491,177"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#a9e0eab343d21d18c665083839d706f04" title="Computes a spline based on the provided points." alt="" coords="292,332,465,373"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#ad8a3ee0bf06f85a6e7a8b5097251da2b" title="Compute an approximate orientation for the vehicle at each point along the provided centerline." alt="" coords="277,201,480,243"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#af509efce135492493e13c9bb86329dcd" title="Reduces the input points to only those points that fit within the provided time boundary." alt="" coords="292,499,465,555"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#a0f07faaac8c54cc485f2bb217097326e" title="Helper method to split a list of PointSpeedPair into separate point and speed lists." alt="" coords="559,670,733,726"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#aa399a236f88f7b1c5557327fbb2ba71a" title="Returns the nearest &quot;less than&quot; point to the provided vehicle pose in the provided list by utilizing ..." alt="" coords="292,579,465,635"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#a924ac023f1b51e791ca1b61b9194f44a" title="Returns the nearest point (in terms of cartesian 2d distance) to the provided vehicle pose in the pro..." alt="" coords="292,659,465,715"/>
<area shape="rect" href="namespacebasic__autonomy_1_1smoothing.html#afb726e75a21ada8efa3ca5561ffc9984" title="Extremely simplie moving average filter." alt="" coords="287,739,470,780"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#a84a6c11da2d9736a8f277b6afd124100" title="Applies the longitudinal acceleration limit to each point&#39;s speed." alt="" coords="286,856,471,897"/>
<area shape="rect" href="namespacebasic__autonomy_1_1log.html#a54dc1b131f40912ecbf27ce0f42bc782" title="Print a RCLCPP_DEBUG_STREAM for each value in values where the printed value is &lt;&lt; prefix &lt;&lt; value." alt="" coords="545,915,747,956"/>
<area shape="rect" href="namespacebasic__autonomy_1_1log.html#aa5d9aec52bb2d67d8b163be5d2366c8e" title="Helper function to convert a PointSpeedPair to a string." alt="" coords="292,267,465,308"/>
<area shape="rect" href="namespacebasic__autonomy_1_1log.html#abc6767d55d022e680ccd0d598eba5289" title="Print a RCLCPP_DEBUG_STREAM for each value in values where the printed value is a string returned by ..." alt="" coords="309,973,448,1015"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#aba6a29cdaf0c4af10647b59bf6df4e01" title="Method combines input points, times, orientations, and an absolute start time to form a valid carma p..." alt="" coords="273,1038,484,1094"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#a4e12c2971926486d1447e44e978f8d4d" title=" " alt="" coords="801,466,947,522"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#a9bc48b810ba18270fcc21674b55922f0" title="Compute the Euclidean distance between the two points." alt="" coords="995,466,1140,522"/>
<area shape="rect" href="classbasic__autonomy_1_1smoothing_1_1SplineI.html#a6fb15e64df8a2591023ae18fba56606f" title="Get the BasicPoint2d representing the first_deriv along the curve at t&#45;th step." alt="" coords="555,71,737,112"/>
<area shape="rect" href="classbasic__autonomy_1_1smoothing_1_1SplineI.html#aae7724df9449ea357153c86bd2e327af" title="Get the BasicPoint2d representing the first_deriv along the curve at t&#45;th step." alt="" coords="555,136,737,177"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#a126f739493756f0eb84183ea22912b93" title=" " alt="" coords="573,201,719,257"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#ae8af6cd9c27d35849c12959ab9f1b9c3" title=" " alt="" coords="801,201,947,257"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#a9dd6a1f0fa9c6f6590b83a7cc2e0d118" title="Returns the min, and its idx, from the vector of values, excluding given set of values." alt="" coords="539,849,753,891"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebasic__autonomy_1_1waypoint__generation_ad633c0c515eae2b1752ad96031e01ef8_icgraph.png" border="0" usemap="#anamespacebasic__autonomy_1_1waypoint__generation_ad633c0c515eae2b1752ad96031e01ef8_icgraph" alt=""/></div>
<map name="anamespacebasic__autonomy_1_1waypoint__generation_ad633c0c515eae2b1752ad96031e01ef8_icgraph" id="anamespacebasic__autonomy_1_1waypoint__generation_ad633c0c515eae2b1752ad96031e01ef8_icgraph">
<area shape="rect" title="Method converts a list of lanelet centerline points and current vehicle state into a usable list of t..." alt="" coords="331,85,544,141"/>
<area shape="rect" href="classinlanecruising__plugin_1_1InLaneCruisingPlugin.html#a60f695c3ed54c99c6a2dcfaf77ae55e2" title="Service callback for trajectory planning." alt="" coords="61,5,227,61"/>
<area shape="rect" href="classplatooning__tactical__plugin_1_1PlatooningTacticalPlugin.html#aee3afe082ccd5ab937dbb1c49f9e21ff" title="Service callback for trajectory planning." alt="" coords="56,85,232,141"/>
<area shape="rect" href="classlight__controlled__intersection__tactical__plugin_1_1LightControlledIntersectionTacticalPlugin.html#a124f95825dfb2728fefa245e6a0e1db7" title="Function to process the light controlled intersection tactical plugin service call for trajectory pla..." alt="" coords="5,165,283,221"/>
</map>
</div>

</div>
</div>
<a id="ae4ca284ba04f4f76fb88bf8d20731835" name="ae4ca284ba04f4f76fb88bf8d20731835"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4ca284ba04f4f76fb88bf8d20731835">&#9670;&nbsp;</a></span>compute_curvature_at()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double basic_autonomy::waypoint_generation::compute_curvature_at </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classbasic__autonomy_1_1smoothing_1_1SplineI.html">basic_autonomy::smoothing::SplineI</a> &amp;&#160;</td>
          <td class="paramname"><em>fit_curve</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>step_along_the_curve</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Given the curvature fit, computes the curvature at the given step along the curve. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">step_along_the_curve</td><td>Value in double from 0.0 (curvature start) to 1.0 (curvature end) representing where to calculate the curvature </td></tr>
    <tr><td class="paramname">fit_curve</td><td>curvature fit</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Curvature (k = 1/r, 1/meter) </dd></dl>

<p class="definition">Definition at line <a class="el" href="basic__autonomy_8cpp_source.html#l00843">843</a> of file <a class="el" href="basic__autonomy_8cpp_source.html">basic_autonomy.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  844</span>        {</div>
<div class="line"><span class="lineno">  845</span>            lanelet::BasicPoint2d f_prime_pt = fit_curve.<a class="code hl_function" href="classbasic__autonomy_1_1smoothing_1_1SplineI.html#a6fb15e64df8a2591023ae18fba56606f">first_deriv</a>(step_along_the_curve);</div>
<div class="line"><span class="lineno">  846</span>            lanelet::BasicPoint2d f_prime_prime_pt = fit_curve.<a class="code hl_function" href="classbasic__autonomy_1_1smoothing_1_1SplineI.html#aae7724df9449ea357153c86bd2e327af">second_deriv</a>(step_along_the_curve);</div>
<div class="line"><span class="lineno">  847</span>            <span class="comment">// Convert to 3d vector to do 3d vector operations like cross.</span></div>
<div class="line"><span class="lineno">  848</span>            Eigen::Vector3d f_prime = {f_prime_pt.x(), f_prime_pt.y(), 0};</div>
<div class="line"><span class="lineno">  849</span>            Eigen::Vector3d f_prime_prime = {f_prime_prime_pt.x(), f_prime_prime_pt.y(), 0};</div>
<div class="line"><span class="lineno">  850</span>            <span class="keywordflow">return</span> (f_prime.cross(f_prime_prime)).norm() / (pow(f_prime.norm(), 3));</div>
<div class="line"><span class="lineno">  851</span>        }</div>
<div class="ttc" id="aclassbasic__autonomy_1_1smoothing_1_1SplineI_html_a6fb15e64df8a2591023ae18fba56606f"><div class="ttname"><a href="classbasic__autonomy_1_1smoothing_1_1SplineI.html#a6fb15e64df8a2591023ae18fba56606f">basic_autonomy::smoothing::SplineI::first_deriv</a></div><div class="ttdeci">virtual lanelet::BasicPoint2d first_deriv(double x) const =0</div><div class="ttdoc">Get the BasicPoint2d representing the first_deriv along the curve at t-th step.</div></div>
<div class="ttc" id="aclassbasic__autonomy_1_1smoothing_1_1SplineI_html_aae7724df9449ea357153c86bd2e327af"><div class="ttname"><a href="classbasic__autonomy_1_1smoothing_1_1SplineI.html#aae7724df9449ea357153c86bd2e327af">basic_autonomy::smoothing::SplineI::second_deriv</a></div><div class="ttdeci">virtual lanelet::BasicPoint2d second_deriv(double x) const =0</div><div class="ttdoc">Get the BasicPoint2d representing the first_deriv along the curve at t-th step.</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classbasic__autonomy_1_1smoothing_1_1SplineI.html#a6fb15e64df8a2591023ae18fba56606f">basic_autonomy::smoothing::SplineI::first_deriv()</a>, and <a class="el" href="classbasic__autonomy_1_1smoothing_1_1SplineI.html#aae7724df9449ea357153c86bd2e327af">basic_autonomy::smoothing::SplineI::second_deriv()</a>.</p>

<p class="reference">Referenced by <a class="el" href="basic__autonomy_8cpp_source.html#l00853">compose_lanefollow_trajectory_from_path()</a>, and <a class="el" href="stop__controlled__intersection__tactical__plugin_8cpp_source.html#l00477">stop_controlled_intersection_tactical_plugin::StopControlledIntersectionTacticalPlugin::compose_trajectory_from_centerline()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebasic__autonomy_1_1waypoint__generation_ae4ca284ba04f4f76fb88bf8d20731835_cgraph.png" border="0" usemap="#anamespacebasic__autonomy_1_1waypoint__generation_ae4ca284ba04f4f76fb88bf8d20731835_cgraph" alt=""/></div>
<map name="anamespacebasic__autonomy_1_1waypoint__generation_ae4ca284ba04f4f76fb88bf8d20731835_cgraph" id="anamespacebasic__autonomy_1_1waypoint__generation_ae4ca284ba04f4f76fb88bf8d20731835_cgraph">
<area shape="rect" title="Given the curvature fit, computes the curvature at the given step along the curve." alt="" coords="5,39,229,80"/>
<area shape="rect" href="classbasic__autonomy_1_1smoothing_1_1SplineI.html#a6fb15e64df8a2591023ae18fba56606f" title="Get the BasicPoint2d representing the first_deriv along the curve at t&#45;th step." alt="" coords="277,5,460,47"/>
<area shape="rect" href="classbasic__autonomy_1_1smoothing_1_1SplineI.html#aae7724df9449ea357153c86bd2e327af" title="Get the BasicPoint2d representing the first_deriv along the curve at t&#45;th step." alt="" coords="277,71,460,112"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebasic__autonomy_1_1waypoint__generation_ae4ca284ba04f4f76fb88bf8d20731835_icgraph.png" border="0" usemap="#anamespacebasic__autonomy_1_1waypoint__generation_ae4ca284ba04f4f76fb88bf8d20731835_icgraph" alt=""/></div>
<map name="anamespacebasic__autonomy_1_1waypoint__generation_ae4ca284ba04f4f76fb88bf8d20731835_icgraph" id="anamespacebasic__autonomy_1_1waypoint__generation_ae4ca284ba04f4f76fb88bf8d20731835_icgraph">
<area shape="rect" title="Given the curvature fit, computes the curvature at the given step along the curve." alt="" coords="609,177,833,218"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#ad633c0c515eae2b1752ad96031e01ef8" title="Method converts a list of lanelet centerline points and current vehicle state into a usable list of t..." alt="" coords="339,105,553,161"/>
<area shape="rect" href="classstop__controlled__intersection__tactical__plugin_1_1StopControlledIntersectionTacticalPlugin.html#ae4ee772170429ec26c32ceec68f3c22f" title="Method converts a list of lanelet centerline points and current vehicle state into a usable list of t..." alt="" coords="331,206,561,277"/>
<area shape="rect" href="classinlanecruising__plugin_1_1InLaneCruisingPlugin.html#a60f695c3ed54c99c6a2dcfaf77ae55e2" title="Service callback for trajectory planning." alt="" coords="61,5,227,61"/>
<area shape="rect" href="classplatooning__tactical__plugin_1_1PlatooningTacticalPlugin.html#aee3afe082ccd5ab937dbb1c49f9e21ff" title="Service callback for trajectory planning." alt="" coords="56,85,232,141"/>
<area shape="rect" href="classlight__controlled__intersection__tactical__plugin_1_1LightControlledIntersectionTacticalPlugin.html#a124f95825dfb2728fefa245e6a0e1db7" title="Function to process the light controlled intersection tactical plugin service call for trajectory pla..." alt="" coords="5,165,283,221"/>
<area shape="rect" href="classstop__controlled__intersection__tactical__plugin_1_1StopControlledIntersectionTacticalPlugin.html#ab0bf4a699bff521ffe56736d78880926" title="Extending class provided callback which should return a planned trajectory based on the provided traj..." alt="" coords="43,246,245,317"/>
</map>
</div>

</div>
</div>
<a id="a9e0eab343d21d18c665083839d706f04" name="a9e0eab343d21d18c665083839d706f04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e0eab343d21d18c665083839d706f04">&#9670;&nbsp;</a></span>compute_fit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt; <a class="el" href="classbasic__autonomy_1_1smoothing_1_1SplineI.html">basic_autonomy::smoothing::SplineI</a> &gt; basic_autonomy::waypoint_generation::compute_fit </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; lanelet::BasicPoint2d &gt; &amp;&#160;</td>
          <td class="paramname"><em>basic_points</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes a spline based on the provided points. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">basic_points</td><td>The points to use for fitting the spline</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A spline which has been fit to the provided points </dd></dl>

<p class="definition">Definition at line <a class="el" href="basic__autonomy_8cpp_source.html#l00806">806</a> of file <a class="el" href="basic__autonomy_8cpp_source.html">basic_autonomy.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  807</span>        {</div>
<div class="line"><span class="lineno">  808</span>            <span class="keywordflow">if</span> (basic_points.size() &lt; 4)</div>
<div class="line"><span class="lineno">  809</span>            {</div>
<div class="line"><span class="lineno">  810</span>                RCLCPP_WARN_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;Insufficient Spline Points&quot;</span>);</div>
<div class="line"><span class="lineno">  811</span>                <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  812</span>            }</div>
<div class="line"><span class="lineno">  813</span>            </div>
<div class="line"><span class="lineno">  814</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;Original basic_points size: &quot;</span> &lt;&lt; basic_points.size());</div>
<div class="line"><span class="lineno">  815</span> </div>
<div class="line"><span class="lineno">  816</span>            std::vector&lt;lanelet::BasicPoint2d&gt; resized_basic_points = basic_points;</div>
<div class="line"><span class="lineno">  817</span> </div>
<div class="line"><span class="lineno">  818</span>            <span class="comment">// The large the number of points, longer it takes to calculate a spline fit</span></div>
<div class="line"><span class="lineno">  819</span>            <span class="comment">// So if the basic_points vector size is large, only the first 400 points are used to compute a spline fit. </span></div>
<div class="line"><span class="lineno">  820</span>            <span class="keywordflow">if</span> (resized_basic_points.size() &gt; 400)</div>
<div class="line"><span class="lineno">  821</span>            {</div>
<div class="line"><span class="lineno">  822</span>                resized_basic_points.resize(400);</div>
<div class="line"><span class="lineno">  823</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;Resized basic_points size: &quot;</span> &lt;&lt; resized_basic_points.size());</div>
<div class="line"><span class="lineno">  824</span> </div>
<div class="line"><span class="lineno">  825</span>                <span class="keywordtype">size_t</span> left_points_size = basic_points.size() - resized_basic_points.size();</div>
<div class="line"><span class="lineno">  826</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;Number of left out basic_points size: &quot;</span> &lt;&lt; left_points_size);</div>
<div class="line"><span class="lineno">  827</span> </div>
<div class="line"><span class="lineno">  828</span>                <span class="keywordtype">float</span> percent_points_lost = 100.0 * (float)left_points_size/basic_points.size();</div>
<div class="line"><span class="lineno">  829</span> </div>
<div class="line"><span class="lineno">  830</span>                <span class="keywordflow">if</span> (percent_points_lost &gt; 50.0)</div>
<div class="line"><span class="lineno">  831</span>                {</div>
<div class="line"><span class="lineno">  832</span>                    RCLCPP_WARN_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;More than half of basic points are ignored for spline fitting&quot;</span>);</div>
<div class="line"><span class="lineno">  833</span>                }</div>
<div class="line"><span class="lineno">  834</span>            }</div>
<div class="line"><span class="lineno">  835</span>            </div>
<div class="line"><span class="lineno">  836</span>            std::unique_ptr&lt;basic_autonomy::smoothing::SplineI&gt; spl = std::make_unique&lt;basic_autonomy::smoothing::BSpline&gt;();</div>
<div class="line"><span class="lineno">  837</span> </div>
<div class="line"><span class="lineno">  838</span>            spl-&gt;setPoints(resized_basic_points);</div>
<div class="line"><span class="lineno">  839</span> </div>
<div class="line"><span class="lineno">  840</span>            <span class="keywordflow">return</span> spl;</div>
<div class="line"><span class="lineno">  841</span>        }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="basic__autonomy_8hpp_source.html#l00062">BASIC_AUTONOMY_LOGGER</a>.</p>

<p class="reference">Referenced by <a class="el" href="basic__autonomy_8cpp_source.html#l01112">compose_lanechange_trajectory_from_path()</a>, <a class="el" href="basic__autonomy_8cpp_source.html#l00853">compose_lanefollow_trajectory_from_path()</a>, <a class="el" href="stop__controlled__intersection__tactical__plugin_8cpp_source.html#l00477">stop_controlled_intersection_tactical_plugin::StopControlledIntersectionTacticalPlugin::compose_trajectory_from_centerline()</a>, and <a class="el" href="basic__autonomy_8cpp_source.html#l00470">resample_linestring_pair_to_same_size()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebasic__autonomy_1_1waypoint__generation_a9e0eab343d21d18c665083839d706f04_icgraph.png" border="0" usemap="#anamespacebasic__autonomy_1_1waypoint__generation_a9e0eab343d21d18c665083839d706f04_icgraph" alt=""/></div>
<map name="anamespacebasic__autonomy_1_1waypoint__generation_a9e0eab343d21d18c665083839d706f04_icgraph" id="anamespacebasic__autonomy_1_1waypoint__generation_a9e0eab343d21d18c665083839d706f04_icgraph">
<area shape="rect" title="Computes a spline based on the provided points." alt="" coords="1647,126,1820,167"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#a741942c16ca54212b9adf3ddc2eea66d" title="Method converts a list of lanelet centerline points and current vehicle state into a usable list of t..." alt="" coords="847,5,1068,61"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#ad633c0c515eae2b1752ad96031e01ef8" title="Method converts a list of lanelet centerline points and current vehicle state into a usable list of t..." alt="" coords="585,165,799,221"/>
<area shape="rect" href="classstop__controlled__intersection__tactical__plugin_1_1StopControlledIntersectionTacticalPlugin.html#ae4ee772170429ec26c32ceec68f3c22f" title="Method converts a list of lanelet centerline points and current vehicle state into a usable list of t..." alt="" coords="1368,217,1599,287"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#a19cf5cf882789e1e9ed3e92d0105a8de" title="Resamples a pair of basicpoint2d lines to get lines of same number of points." alt="" coords="1380,85,1587,141"/>
<area shape="rect" href="classcooperative__lanechange_1_1CooperativeLaneChangePlugin.html#a5f0c14a409d58d6b1750c38c6bf1b34a" title="Creates a vector of Trajectory Points from maneuver information in trajectory request." alt="" coords="295,5,502,61"/>
<area shape="rect" href="classcooperative__lanechange_1_1CooperativeLaneChangePlugin.html#a8913539d8614e509910af225e18bc809" title="Extending class provided callback which should return a planned trajectory based on the provided traj..." alt="" coords="5,5,212,61"/>
<area shape="rect" href="classinlanecruising__plugin_1_1InLaneCruisingPlugin.html#a60f695c3ed54c99c6a2dcfaf77ae55e2" title="Service callback for trajectory planning." alt="" coords="315,85,482,141"/>
<area shape="rect" href="classplatooning__tactical__plugin_1_1PlatooningTacticalPlugin.html#aee3afe082ccd5ab937dbb1c49f9e21ff" title="Service callback for trajectory planning." alt="" coords="311,165,487,221"/>
<area shape="rect" href="classlight__controlled__intersection__tactical__plugin_1_1LightControlledIntersectionTacticalPlugin.html#a124f95825dfb2728fefa245e6a0e1db7" title="Function to process the light controlled intersection tactical plugin service call for trajectory pla..." alt="" coords="260,245,537,301"/>
<area shape="rect" href="classstop__controlled__intersection__tactical__plugin_1_1StopControlledIntersectionTacticalPlugin.html#ab0bf4a699bff521ffe56736d78880926" title="Extending class provided callback which should return a planned trajectory based on the provided traj..." alt="" coords="1117,217,1319,287"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#a2219ab96db87781023137bdb45af1ea2" title="Creates a vector of lane change points using parameters defined." alt="" coords="1116,85,1320,141"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#af992a6cbbdafd6e86d73976a65164e94" title="Converts a set of requested LANE_CHANGE maneuvers to point speed limit pairs." alt="" coords="864,85,1051,141"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#acdcd3bb44d31aa6405b30f151ea35ae4" title="Creates geometry profile to return a point speed pair struct for LANE FOLLOW and LANE CHANGE maneuver..." alt="" coords="597,85,787,141"/>
</map>
</div>

</div>
</div>
<a id="ada2ee63b890bfa23d67a17cf61dd0129" name="ada2ee63b890bfa23d67a17cf61dd0129"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada2ee63b890bfa23d67a17cf61dd0129">&#9670;&nbsp;</a></span>compute_heading_frame()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Eigen::Isometry2d basic_autonomy::waypoint_generation::compute_heading_frame </td>
          <td>(</td>
          <td class="paramtype">const lanelet::BasicPoint2d &amp;&#160;</td>
          <td class="paramname"><em>p1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const lanelet::BasicPoint2d &amp;&#160;</td>
          <td class="paramname"><em>p2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns a 2D coordinate frame which is located at p1 and oriented so p2 lies on the +X axis. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p1</td><td>The origin point for the frame in the parent frame </td></tr>
    <tr><td class="paramname">p2</td><td>A point in the parent frame that will define the +X axis relative to p1</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A 2D coordinate frame transform </dd></dl>

<p class="definition">Definition at line <a class="el" href="basic__autonomy_8cpp_source.html#l00623">623</a> of file <a class="el" href="basic__autonomy_8cpp_source.html">basic_autonomy.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  625</span>        {</div>
<div class="line"><span class="lineno">  626</span>            Eigen::Rotation2Dd yaw(atan2(p2.y() - p1.y(), p2.x() - p1.x()));</div>
<div class="line"><span class="lineno">  627</span> </div>
<div class="line"><span class="lineno">  628</span>            <span class="keywordflow">return</span> <a class="code hl_function" href="namespacecarma__wm_1_1geometry.html#ab51c08f5f937a6aa72b7490eeabed211">carma_wm::geometry::build2dEigenTransform</a>(p1, yaw);</div>
<div class="line"><span class="lineno">  629</span>        }</div>
<div class="ttc" id="anamespacecarma__wm_1_1geometry_html_ab51c08f5f937a6aa72b7490eeabed211"><div class="ttname"><a href="namespacecarma__wm_1_1geometry.html#ab51c08f5f937a6aa72b7490eeabed211">carma_wm::geometry::build2dEigenTransform</a></div><div class="ttdeci">Eigen::Isometry2d build2dEigenTransform(const Eigen::Vector2d &amp;position, const Eigen::Rotation2Dd &amp;rotation)</div><div class="ttdoc">Builds a 2D Eigen coordinate frame transform with not applied scaling (only translation and rotation)...</div><div class="ttdef"><b>Definition:</b> <a href="Geometry_8cpp_source.html#l00570">Geometry.cpp:570</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Geometry_8cpp_source.html#l00570">carma_wm::geometry::build2dEigenTransform()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebasic__autonomy_1_1waypoint__generation_ada2ee63b890bfa23d67a17cf61dd0129_cgraph.png" border="0" usemap="#anamespacebasic__autonomy_1_1waypoint__generation_ada2ee63b890bfa23d67a17cf61dd0129_cgraph" alt=""/></div>
<map name="anamespacebasic__autonomy_1_1waypoint__generation_ada2ee63b890bfa23d67a17cf61dd0129_cgraph" id="anamespacebasic__autonomy_1_1waypoint__generation_ada2ee63b890bfa23d67a17cf61dd0129_cgraph">
<area shape="rect" title="Returns a 2D coordinate frame which is located at p1 and oriented so p2 lies on the +X axis." alt="" coords="5,5,243,47"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#ab51c08f5f937a6aa72b7490eeabed211" title="Builds a 2D Eigen coordinate frame transform with not applied scaling (only translation and rotation)..." alt="" coords="291,5,451,47"/>
</map>
</div>

</div>
</div>
<a id="af509efce135492493e13c9bb86329dcd" name="af509efce135492493e13c9bb86329dcd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af509efce135492493e13c9bb86329dcd">&#9670;&nbsp;</a></span>constrain_to_time_boundary()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1PointSpeedPair.html">PointSpeedPair</a> &gt; basic_autonomy::waypoint_generation::constrain_to_time_boundary </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1PointSpeedPair.html">PointSpeedPair</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>points</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>time_span</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reduces the input points to only those points that fit within the provided time boundary. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">points</td><td>The input point speed pairs to reduce </td></tr>
    <tr><td class="paramname">time_span</td><td>The time span in seconds which the output points will fit within</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The subset of points that fit within time_span </dd></dl>

<p class="definition">Definition at line <a class="el" href="basic__autonomy_8cpp_source.html#l00631">631</a> of file <a class="el" href="basic__autonomy_8cpp_source.html">basic_autonomy.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  633</span>        {</div>
<div class="line"><span class="lineno">  634</span>            std::vector&lt;lanelet::BasicPoint2d&gt; basic_points;</div>
<div class="line"><span class="lineno">  635</span>            std::vector&lt;double&gt; speeds;</div>
<div class="line"><span class="lineno">  636</span>            <a class="code hl_function" href="namespacebasic__autonomy_1_1waypoint__generation.html#a0f07faaac8c54cc485f2bb217097326e">split_point_speed_pairs</a>(points, &amp;basic_points, &amp;speeds);</div>
<div class="line"><span class="lineno">  637</span> </div>
<div class="line"><span class="lineno">  638</span>            std::vector&lt;double&gt; downtracks = <a class="code hl_function" href="namespacecarma__wm_1_1geometry.html#adf1c6b7f1e33569b45074e4e5bbeff1d">carma_wm::geometry::compute_arc_lengths</a>(basic_points);</div>
<div class="line"><span class="lineno">  639</span> </div>
<div class="line"><span class="lineno">  640</span>            <span class="keywordtype">size_t</span> time_boundary_exclusive_index =</div>
<div class="line"><span class="lineno">  641</span>                trajectory_utils::time_boundary_index(downtracks, speeds, time_span);</div>
<div class="line"><span class="lineno">  642</span>            </div>
<div class="line"><span class="lineno">  643</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;time_boundary_exclusive_index = &quot;</span> &lt;&lt; time_boundary_exclusive_index);</div>
<div class="line"><span class="lineno">  644</span> </div>
<div class="line"><span class="lineno">  645</span>            <span class="keywordflow">if</span> (time_boundary_exclusive_index == 0)</div>
<div class="line"><span class="lineno">  646</span>            {</div>
<div class="line"><span class="lineno">  647</span>                <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;No points to fit in timespan&quot;</span>);</div>
<div class="line"><span class="lineno">  648</span>            }</div>
<div class="line"><span class="lineno">  649</span> </div>
<div class="line"><span class="lineno">  650</span>            std::vector&lt;PointSpeedPair&gt; time_bound_points;</div>
<div class="line"><span class="lineno">  651</span>            time_bound_points.reserve(time_boundary_exclusive_index);</div>
<div class="line"><span class="lineno">  652</span> </div>
<div class="line"><span class="lineno">  653</span>            <span class="keywordflow">if</span> (time_boundary_exclusive_index == points.size())</div>
<div class="line"><span class="lineno">  654</span>            {</div>
<div class="line"><span class="lineno">  655</span>                time_bound_points.insert(time_bound_points.end(), points.begin(),</div>
<div class="line"><span class="lineno">  656</span>                                         points.end()); <span class="comment">// All points fit within time boundary</span></div>
<div class="line"><span class="lineno">  657</span>            }</div>
<div class="line"><span class="lineno">  658</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  659</span>            {</div>
<div class="line"><span class="lineno">  660</span>                time_bound_points.insert(time_bound_points.end(), points.begin(),</div>
<div class="line"><span class="lineno">  661</span>                                         points.begin() + time_boundary_exclusive_index - 1); <span class="comment">// Limit points by time boundary</span></div>
<div class="line"><span class="lineno">  662</span>            }</div>
<div class="line"><span class="lineno">  663</span> </div>
<div class="line"><span class="lineno">  664</span>            <span class="keywordflow">return</span> time_bound_points;</div>
<div class="line"><span class="lineno">  665</span>        }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="basic__autonomy_8hpp_source.html#l00062">BASIC_AUTONOMY_LOGGER</a>, <a class="el" href="Geometry_8cpp_source.html#l00498">carma_wm::geometry::compute_arc_lengths()</a>, and <a class="el" href="helper__functions_8cpp_source.html#l00083">split_point_speed_pairs()</a>.</p>

<p class="reference">Referenced by <a class="el" href="basic__autonomy_8cpp_source.html#l00853">compose_lanefollow_trajectory_from_path()</a>, and <a class="el" href="stop__controlled__intersection__tactical__plugin_8cpp_source.html#l00477">stop_controlled_intersection_tactical_plugin::StopControlledIntersectionTacticalPlugin::compose_trajectory_from_centerline()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebasic__autonomy_1_1waypoint__generation_af509efce135492493e13c9bb86329dcd_cgraph.png" border="0" usemap="#anamespacebasic__autonomy_1_1waypoint__generation_af509efce135492493e13c9bb86329dcd_cgraph" alt=""/></div>
<map name="anamespacebasic__autonomy_1_1waypoint__generation_af509efce135492493e13c9bb86329dcd_cgraph" id="anamespacebasic__autonomy_1_1waypoint__generation_af509efce135492493e13c9bb86329dcd_cgraph">
<area shape="rect" title="Reduces the input points to only those points that fit within the provided time boundary." alt="" coords="5,41,179,97"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#adf1c6b7f1e33569b45074e4e5bbeff1d" title="Compute the arc length at each point around the curve." alt="" coords="237,13,389,54"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#a0f07faaac8c54cc485f2bb217097326e" title="Helper method to split a list of PointSpeedPair into separate point and speed lists." alt="" coords="227,77,400,133"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#a4e12c2971926486d1447e44e978f8d4d" title=" " alt="" coords="448,5,593,61"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#a9bc48b810ba18270fcc21674b55922f0" title="Compute the Euclidean distance between the two points." alt="" coords="641,5,787,61"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebasic__autonomy_1_1waypoint__generation_af509efce135492493e13c9bb86329dcd_icgraph.png" border="0" usemap="#anamespacebasic__autonomy_1_1waypoint__generation_af509efce135492493e13c9bb86329dcd_icgraph" alt=""/></div>
<map name="anamespacebasic__autonomy_1_1waypoint__generation_af509efce135492493e13c9bb86329dcd_icgraph" id="anamespacebasic__autonomy_1_1waypoint__generation_af509efce135492493e13c9bb86329dcd_icgraph">
<area shape="rect" title="Reduces the input points to only those points that fit within the provided time boundary." alt="" coords="609,169,783,225"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#ad633c0c515eae2b1752ad96031e01ef8" title="Method converts a list of lanelet centerline points and current vehicle state into a usable list of t..." alt="" coords="339,105,553,161"/>
<area shape="rect" href="classstop__controlled__intersection__tactical__plugin_1_1StopControlledIntersectionTacticalPlugin.html#ae4ee772170429ec26c32ceec68f3c22f" title="Method converts a list of lanelet centerline points and current vehicle state into a usable list of t..." alt="" coords="331,206,561,277"/>
<area shape="rect" href="classinlanecruising__plugin_1_1InLaneCruisingPlugin.html#a60f695c3ed54c99c6a2dcfaf77ae55e2" title="Service callback for trajectory planning." alt="" coords="61,5,227,61"/>
<area shape="rect" href="classplatooning__tactical__plugin_1_1PlatooningTacticalPlugin.html#aee3afe082ccd5ab937dbb1c49f9e21ff" title="Service callback for trajectory planning." alt="" coords="56,85,232,141"/>
<area shape="rect" href="classlight__controlled__intersection__tactical__plugin_1_1LightControlledIntersectionTacticalPlugin.html#a124f95825dfb2728fefa245e6a0e1db7" title="Function to process the light controlled intersection tactical plugin service call for trajectory pla..." alt="" coords="5,165,283,221"/>
<area shape="rect" href="classstop__controlled__intersection__tactical__plugin_1_1StopControlledIntersectionTacticalPlugin.html#ab0bf4a699bff521ffe56736d78880926" title="Extending class provided callback which should return a planned trajectory based on the provided traj..." alt="" coords="43,246,245,317"/>
</map>
</div>

</div>
</div>
<a id="acdcd3bb44d31aa6405b30f151ea35ae4" name="acdcd3bb44d31aa6405b30f151ea35ae4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acdcd3bb44d31aa6405b30f151ea35ae4">&#9670;&nbsp;</a></span>create_geometry_profile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1PointSpeedPair.html">PointSpeedPair</a> &gt; basic_autonomy::waypoint_generation::create_geometry_profile </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; carma_planning_msgs::msg::Maneuver &gt; &amp;&#160;</td>
          <td class="paramname"><em>maneuvers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_starting_downtrack</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacecarma__wm.html#a3ac653959e0b6198cae274d68b343228">carma_wm::WorldModelConstPtr</a> &amp;&#160;</td>
          <td class="paramname"><em>wm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">carma_planning_msgs::msg::VehicleState &amp;&#160;</td>
          <td class="paramname"><em>ending_state_before_buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const carma_planning_msgs::msg::VehicleState &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1GeneralTrajConfig.html">GeneralTrajConfig</a> &amp;&#160;</td>
          <td class="paramname"><em>general_config</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html">DetailedTrajConfig</a> &amp;&#160;</td>
          <td class="paramname"><em>detailed_config</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates geometry profile to return a point speed pair struct for LANE FOLLOW and LANE CHANGE maneuver types. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">maneuvers</td><td>The list of maneuvers to convert to geometry points and calculate associated speed </td></tr>
    <tr><td class="paramname">max_starting_downtrack</td><td>The maximum downtrack that is allowed for the first maneuver. This should be set to the vehicle position or earlier. If the first maneuver exceeds this then it's downtrack will be shifted to this value. </td></tr>
    <tr><td class="paramname">wm</td><td>Pointer to intialized world model for semantic map access </td></tr>
    <tr><td class="paramname">ending_state_before_buffer</td><td>reference to Vehicle state, which is state before applying extra points for curvature calculation that are removed later </td></tr>
    <tr><td class="paramname">state</td><td>The vehicle state at the time the function is called </td></tr>
    <tr><td class="paramname">general_config</td><td>Basic autonomy struct defined to load general config parameters from tactical plugins </td></tr>
    <tr><td class="paramname">detailed_config</td><td>Basic autonomy struct defined to load detailed config parameters from tactical plugins </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A vector of point speed pair struct which contains geometry points as basicpoint::lanelet2d and speed as a double for the maneuver </dd></dl>

<p class="definition">Definition at line <a class="el" href="basic__autonomy_8cpp_source.html#l00024">24</a> of file <a class="el" href="basic__autonomy_8cpp_source.html">basic_autonomy.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   26</span>                                                                                                                                                      {</div>
<div class="line"><span class="lineno">   27</span>            std::vector&lt;PointSpeedPair&gt; points_and_target_speeds;</div>
<div class="line"><span class="lineno">   28</span>            </div>
<div class="line"><span class="lineno">   29</span>            <span class="keywordtype">bool</span> first = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">   30</span>            std::unordered_set&lt;lanelet::Id&gt; visited_lanelets;</div>
<div class="line"><span class="lineno">   31</span> </div>
<div class="line"><span class="lineno">   32</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;VehDowntrack:&quot;</span>&lt;&lt;max_starting_downtrack);</div>
<div class="line"><span class="lineno">   33</span>            <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span> &amp;maneuver : maneuvers)</div>
<div class="line"><span class="lineno">   34</span>            {</div>
<div class="line"><span class="lineno">   35</span>                <span class="keywordtype">double</span> starting_downtrack = <a class="code hl_define" href="approaching__emergency__vehicle__plugin__node_8hpp.html#a066f948508e087006568cb6c9b0674a7">GET_MANEUVER_PROPERTY</a>(maneuver, start_dist);</div>
<div class="line"><span class="lineno">   36</span>                </div>
<div class="line"><span class="lineno">   37</span>                <span class="keywordflow">if</span>(first){</div>
<div class="line"><span class="lineno">   38</span>                    starting_downtrack = std::min(starting_downtrack, max_starting_downtrack);</div>
<div class="line"><span class="lineno">   39</span>                    first = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   40</span>                }</div>
<div class="line"><span class="lineno">   41</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;Used downtrack: &quot;</span> &lt;&lt; starting_downtrack);</div>
<div class="line"><span class="lineno">   42</span> </div>
<div class="line"><span class="lineno">   43</span>                <span class="keywordflow">if</span>(maneuver.type == carma_planning_msgs::msg::Maneuver::LANE_FOLLOWING){</div>
<div class="line"><span class="lineno">   44</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>),<span class="stringliteral">&quot;Creating Lane Follow Geometry&quot;</span>);</div>
<div class="line"><span class="lineno">   45</span>                    std::vector&lt;PointSpeedPair&gt; lane_follow_points = <a class="code hl_function" href="namespacebasic__autonomy_1_1waypoint__generation.html#aa3500af9146c0d9c80cb1b4101be01e5">create_lanefollow_geometry</a>(maneuver, starting_downtrack, wm, general_config, detailed_config, visited_lanelets);</div>
<div class="line"><span class="lineno">   46</span>                    points_and_target_speeds.insert(points_and_target_speeds.end(), lane_follow_points.begin(), lane_follow_points.end());</div>
<div class="line"><span class="lineno">   47</span>                }</div>
<div class="line"><span class="lineno">   48</span>                <span class="keywordflow">else</span> <span class="keywordflow">if</span>(maneuver.type == carma_planning_msgs::msg::Maneuver::LANE_CHANGE){</div>
<div class="line"><span class="lineno">   49</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;Creating Lane Change Geometry&quot;</span>);</div>
<div class="line"><span class="lineno">   50</span>                    std::vector&lt;PointSpeedPair&gt; lane_change_points = <a class="code hl_function" href="namespacebasic__autonomy_1_1waypoint__generation.html#af992a6cbbdafd6e86d73976a65164e94">get_lanechange_points_from_maneuver</a>(maneuver, starting_downtrack, wm, ending_state_before_buffer, state, general_config, detailed_config);</div>
<div class="line"><span class="lineno">   51</span>                    points_and_target_speeds.insert(points_and_target_speeds.end(), lane_change_points.begin(), lane_change_points.end());</div>
<div class="line"><span class="lineno">   52</span>                }</div>
<div class="line"><span class="lineno">   53</span>                <span class="keywordflow">else</span>{</div>
<div class="line"><span class="lineno">   54</span>                    <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;This maneuver type is not supported&quot;</span>);</div>
<div class="line"><span class="lineno">   55</span>                }</div>
<div class="line"><span class="lineno">   56</span>                </div>
<div class="line"><span class="lineno">   57</span>            }</div>
<div class="line"><span class="lineno">   58</span> </div>
<div class="line"><span class="lineno">   59</span>            <span class="comment">//Add buffer ending to lane follow points at the end of maneuver(s) end dist </span></div>
<div class="line"><span class="lineno">   60</span>            <span class="keywordflow">if</span>(maneuvers.back().type == carma_planning_msgs::msg::Maneuver::LANE_FOLLOWING){</div>
<div class="line"><span class="lineno">   61</span>                points_and_target_speeds = <a class="code hl_function" href="namespacebasic__autonomy_1_1waypoint__generation.html#ad56958ee3bb11064df00a37cbf948b8d">add_lanefollow_buffer</a>(wm, points_and_target_speeds, maneuvers, ending_state_before_buffer, detailed_config);</div>
<div class="line"><span class="lineno">   62</span> </div>
<div class="line"><span class="lineno">   63</span>            }</div>
<div class="line"><span class="lineno">   64</span>            <span class="keywordflow">return</span> points_and_target_speeds;</div>
<div class="line"><span class="lineno">   65</span> </div>
<div class="line"><span class="lineno">   66</span>        }</div>
<div class="ttc" id="aapproaching__emergency__vehicle__plugin__node_8hpp_html_a066f948508e087006568cb6c9b0674a7"><div class="ttname"><a href="approaching__emergency__vehicle__plugin__node_8hpp.html#a066f948508e087006568cb6c9b0674a7">GET_MANEUVER_PROPERTY</a></div><div class="ttdeci">#define GET_MANEUVER_PROPERTY(mvr, property)</div><div class="ttdoc">Macro definition to enable easier access to fields shared across the maneuver types.</div><div class="ttdef"><b>Definition:</b> <a href="approaching__emergency__vehicle__plugin__node_8hpp_source.html#l00054">approaching_emergency_vehicle_plugin_node.hpp:54</a></div></div>
<div class="ttc" id="anamespacebasic__autonomy_1_1waypoint__generation_html_aa3500af9146c0d9c80cb1b4101be01e5"><div class="ttname"><a href="namespacebasic__autonomy_1_1waypoint__generation.html#aa3500af9146c0d9c80cb1b4101be01e5">basic_autonomy::waypoint_generation::create_lanefollow_geometry</a></div><div class="ttdeci">std::vector&lt; PointSpeedPair &gt; create_lanefollow_geometry(const carma_planning_msgs::msg::Maneuver &amp;maneuver, double max_starting_downtrack, const carma_wm::WorldModelConstPtr &amp;wm, const GeneralTrajConfig &amp;general_config, const DetailedTrajConfig &amp;detailed_config, std::unordered_set&lt; lanelet::Id &gt; &amp;visited_lanelets)</div><div class="ttdoc">Converts a set of requested LANE_FOLLOWING maneuvers to point speed limit pairs.</div><div class="ttdef"><b>Definition:</b> <a href="basic__autonomy_8cpp_source.html#l00068">basic_autonomy.cpp:68</a></div></div>
<div class="ttc" id="anamespacebasic__autonomy_1_1waypoint__generation_html_ad56958ee3bb11064df00a37cbf948b8d"><div class="ttname"><a href="namespacebasic__autonomy_1_1waypoint__generation.html#ad56958ee3bb11064df00a37cbf948b8d">basic_autonomy::waypoint_generation::add_lanefollow_buffer</a></div><div class="ttdeci">std::vector&lt; PointSpeedPair &gt; add_lanefollow_buffer(const carma_wm::WorldModelConstPtr &amp;wm, std::vector&lt; PointSpeedPair &gt; &amp;points_and_target_speeds, const std::vector&lt; carma_planning_msgs::msg::Maneuver &gt; &amp;maneuvers, carma_planning_msgs::msg::VehicleState &amp;ending_state_before_buffer, const DetailedTrajConfig &amp;detailed_config)</div><div class="ttdoc">Adds extra centerline points beyond required message length to lane follow maneuver points so that th...</div><div class="ttdef"><b>Definition:</b> <a href="basic__autonomy_8cpp_source.html#l00225">basic_autonomy.cpp:225</a></div></div>
<div class="ttc" id="anamespacebasic__autonomy_1_1waypoint__generation_html_af992a6cbbdafd6e86d73976a65164e94"><div class="ttname"><a href="namespacebasic__autonomy_1_1waypoint__generation.html#af992a6cbbdafd6e86d73976a65164e94">basic_autonomy::waypoint_generation::get_lanechange_points_from_maneuver</a></div><div class="ttdeci">std::vector&lt; PointSpeedPair &gt; get_lanechange_points_from_maneuver(const carma_planning_msgs::msg::Maneuver &amp;maneuver, double max_starting_downtrack, const carma_wm::WorldModelConstPtr &amp;wm, carma_planning_msgs::msg::VehicleState &amp;ending_state_before_buffer, const carma_planning_msgs::msg::VehicleState &amp;state, const GeneralTrajConfig &amp;general_config, const DetailedTrajConfig &amp;detailed_config)</div><div class="ttdoc">Converts a set of requested LANE_CHANGE maneuvers to point speed limit pairs.</div><div class="ttdef"><b>Definition:</b> <a href="basic__autonomy_8cpp_source.html#l00532">basic_autonomy.cpp:532</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="basic__autonomy_8cpp_source.html#l00225">add_lanefollow_buffer()</a>, <a class="el" href="basic__autonomy_8hpp_source.html#l00062">BASIC_AUTONOMY_LOGGER</a>, <a class="el" href="basic__autonomy_8cpp_source.html#l00068">create_lanefollow_geometry()</a>, <a class="el" href="basic__autonomy_8cpp_source.html#l00532">get_lanechange_points_from_maneuver()</a>, and <a class="el" href="approaching__emergency__vehicle__plugin__node_8hpp_source.html#l00054">GET_MANEUVER_PROPERTY</a>.</p>

<p class="reference">Referenced by <a class="el" href="cooperative__lanechange__node_8cpp_source.html#l00564">cooperative_lanechange::CooperativeLaneChangePlugin::plan_lanechange()</a>, <a class="el" href="inlanecruising__plugin_8cpp_source.html#l00049">inlanecruising_plugin::InLaneCruisingPlugin::plan_trajectory_callback()</a>, and <a class="el" href="platooning__tactical__plugin_8cpp_source.html#l00044">platooning_tactical_plugin::PlatooningTacticalPlugin::plan_trajectory_cb()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebasic__autonomy_1_1waypoint__generation_acdcd3bb44d31aa6405b30f151ea35ae4_cgraph.png" border="0" usemap="#anamespacebasic__autonomy_1_1waypoint__generation_acdcd3bb44d31aa6405b30f151ea35ae4_cgraph" alt=""/></div>
<map name="anamespacebasic__autonomy_1_1waypoint__generation_acdcd3bb44d31aa6405b30f151ea35ae4_cgraph" id="anamespacebasic__autonomy_1_1waypoint__generation_acdcd3bb44d31aa6405b30f151ea35ae4_cgraph">
<area shape="rect" title="Creates geometry profile to return a point speed pair struct for LANE FOLLOW and LANE CHANGE maneuver..." alt="" coords="5,70,196,126"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#ad56958ee3bb11064df00a37cbf948b8d" title="Adds extra centerline points beyond required message length to lane follow maneuver points so that th..." alt="" coords="244,5,464,47"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#aa3500af9146c0d9c80cb1b4101be01e5" title="Converts a set of requested LANE_FOLLOWING maneuvers to point speed limit pairs." alt="" coords="256,70,452,126"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#af992a6cbbdafd6e86d73976a65164e94" title="Converts a set of requested LANE_CHANGE maneuvers to point speed limit pairs." alt="" coords="261,150,447,206"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#ae7d5ca280140dce2bf7bcfb78bdfd55d" title="Helper function to concatenate 2 linestrings together and return the result. Neither LineString is mo..." alt="" coords="1240,88,1412,129"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#a9bc48b810ba18270fcc21674b55922f0" title="Compute the Euclidean distance between the two points." alt="" coords="1460,138,1605,194"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#a2219ab96db87781023137bdb45af1ea2" title="Creates a vector of lane change points using parameters defined." alt="" coords="512,211,716,267"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#aa399a236f88f7b1c5557327fbb2ba71a" title="Returns the nearest &quot;less than&quot; point to the provided vehicle pose in the provided list by utilizing ..." alt="" coords="781,135,954,191"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#a924ac023f1b51e791ca1b61b9194f44a" title="Returns the nearest point (in terms of cartesian 2d distance) to the provided vehicle pose in the pro..." alt="" coords="781,215,954,271"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#a19cf5cf882789e1e9ed3e92d0105a8de" title="Resamples a pair of basicpoint2d lines to get lines of same number of points." alt="" coords="764,295,971,351"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#adf1c6b7f1e33569b45074e4e5bbeff1d" title="Compute the arc length at each point around the curve." alt="" coords="1029,225,1181,267"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#a9e0eab343d21d18c665083839d706f04" title="Computes a spline based on the provided points." alt="" coords="1019,303,1192,344"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#a4e12c2971926486d1447e44e978f8d4d" title=" " alt="" coords="1253,174,1399,230"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebasic__autonomy_1_1waypoint__generation_acdcd3bb44d31aa6405b30f151ea35ae4_icgraph.png" border="0" usemap="#anamespacebasic__autonomy_1_1waypoint__generation_acdcd3bb44d31aa6405b30f151ea35ae4_icgraph" alt=""/></div>
<map name="anamespacebasic__autonomy_1_1waypoint__generation_acdcd3bb44d31aa6405b30f151ea35ae4_icgraph" id="anamespacebasic__autonomy_1_1waypoint__generation_acdcd3bb44d31aa6405b30f151ea35ae4_icgraph">
<area shape="rect" title="Creates geometry profile to return a point speed pair struct for LANE FOLLOW and LANE CHANGE maneuver..." alt="" coords="515,85,705,141"/>
<area shape="rect" href="classcooperative__lanechange_1_1CooperativeLaneChangePlugin.html#a5f0c14a409d58d6b1750c38c6bf1b34a" title="Creates a vector of Trajectory Points from maneuver information in trajectory request." alt="" coords="260,5,467,61"/>
<area shape="rect" href="classinlanecruising__plugin_1_1InLaneCruisingPlugin.html#a60f695c3ed54c99c6a2dcfaf77ae55e2" title="Service callback for trajectory planning." alt="" coords="280,85,447,141"/>
<area shape="rect" href="classplatooning__tactical__plugin_1_1PlatooningTacticalPlugin.html#aee3afe082ccd5ab937dbb1c49f9e21ff" title="Service callback for trajectory planning." alt="" coords="275,165,451,221"/>
<area shape="rect" href="classcooperative__lanechange_1_1CooperativeLaneChangePlugin.html#a8913539d8614e509910af225e18bc809" title="Extending class provided callback which should return a planned trajectory based on the provided traj..." alt="" coords="5,5,212,61"/>
</map>
</div>

</div>
</div>
<a id="a2219ab96db87781023137bdb45af1ea2" name="a2219ab96db87781023137bdb45af1ea2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2219ab96db87781023137bdb45af1ea2">&#9670;&nbsp;</a></span>create_lanechange_geometry()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; lanelet::BasicPoint2d &gt; basic_autonomy::waypoint_generation::create_lanechange_geometry </td>
          <td>(</td>
          <td class="paramtype">lanelet::Id&#160;</td>
          <td class="paramname"><em>starting_lane_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">lanelet::Id&#160;</td>
          <td class="paramname"><em>ending_lane_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>starting_downtrack</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ending_downtrack</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacecarma__wm.html#a3ac653959e0b6198cae274d68b343228">carma_wm::WorldModelConstPtr</a> &amp;&#160;</td>
          <td class="paramname"><em>wm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classint.html">int</a>&#160;</td>
          <td class="paramname"><em>downsample_ratio</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>buffer_ending_downtrack</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a vector of lane change points using parameters defined. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">starting_lane_id</td><td>lanelet id for where lane change plan should start </td></tr>
    <tr><td class="paramname">ending_lane_id</td><td>lanelet id for where lane change plan should end </td></tr>
    <tr><td class="paramname">starting_downtrack</td><td>The downtrack distance from which the lane change maneuver starts </td></tr>
    <tr><td class="paramname">ending_downtrack</td><td>The downtrack distance at which the lane change maneuver end </td></tr>
    <tr><td class="paramname">wm</td><td>Pointer to intialized world model for semantic map access </td></tr>
    <tr><td class="paramname">downsample_ratio</td><td>TODO: add description </td></tr>
    <tr><td class="paramname">buffer_ending_downtrack</td><td>The additional downtrack beyond requested end dist used to fit points along spline</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A vector of geometry points as lanelet::basicpoint2d </dd></dl>

<p class="definition">Definition at line <a class="el" href="basic__autonomy_8cpp_source.html#l00307">307</a> of file <a class="el" href="basic__autonomy_8cpp_source.html">basic_autonomy.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  309</span>        {</div>
<div class="line"><span class="lineno">  310</span>            std::vector&lt;lanelet::BasicPoint2d&gt; centerline_points;</div>
<div class="line"><span class="lineno">  311</span> </div>
<div class="line"><span class="lineno">  312</span>            <span class="comment">//Get starting lanelet and ending lanelets</span></div>
<div class="line"><span class="lineno">  313</span>            lanelet::ConstLanelet starting_lanelet = wm-&gt;getMap()-&gt;laneletLayer.get(starting_lane_id);</div>
<div class="line"><span class="lineno">  314</span>            lanelet::ConstLanelet ending_lanelet = wm-&gt;getMap()-&gt;laneletLayer.get(ending_lane_id);</div>
<div class="line"><span class="lineno">  315</span>            </div>
<div class="line"><span class="lineno">  316</span>            lanelet::ConstLanelets starting_lane;</div>
<div class="line"><span class="lineno">  317</span>            starting_lane.push_back(starting_lanelet);</div>
<div class="line"><span class="lineno">  318</span> </div>
<div class="line"><span class="lineno">  319</span>            std::vector&lt;lanelet::BasicPoint2d&gt; reference_centerline;</div>
<div class="line"><span class="lineno">  320</span>            <span class="comment">// 400 value here is an arbitrary attempt at improving performance by reducing copy operations. </span></div>
<div class="line"><span class="lineno">  321</span>            <span class="comment">// Value picked based on annecdotal evidence from STOL system testing</span></div>
<div class="line"><span class="lineno">  322</span>            reference_centerline.reserve(400);</div>
<div class="line"><span class="lineno">  323</span>            <span class="keywordtype">bool</span> shared_boundary_found = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  324</span>            <span class="keywordtype">bool</span> is_lanechange_left = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  325</span>            </div>
<div class="line"><span class="lineno">  326</span>            lanelet::BasicLineString2d current_lanelet_centerline = starting_lanelet.centerline2d().basicLineString();</div>
<div class="line"><span class="lineno">  327</span>            lanelet::ConstLanelet current_lanelet = starting_lanelet;</div>
<div class="line"><span class="lineno">  328</span>            reference_centerline.insert(reference_centerline.end(), current_lanelet_centerline.begin(), current_lanelet_centerline.end());</div>
<div class="line"><span class="lineno">  329</span> </div>
<div class="line"><span class="lineno">  330</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;Searching for shared boundary with starting lanechange lanelet &quot;</span> &lt;&lt; std::to_string(current_lanelet.id()) &lt;&lt; <span class="stringliteral">&quot; and ending lanelet &quot;</span> &lt;&lt; std::to_string(ending_lanelet.id()));</div>
<div class="line"><span class="lineno">  331</span>            <span class="keywordflow">while</span>(!shared_boundary_found){</div>
<div class="line"><span class="lineno">  332</span>                <span class="comment">//Assumption- Adjacent lanelets share lane boundary</span></div>
<div class="line"><span class="lineno">  333</span>                <span class="keywordflow">if</span>(current_lanelet.leftBound() == ending_lanelet.rightBound()){   </div>
<div class="line"><span class="lineno">  334</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;Lanelet &quot;</span> &lt;&lt; std::to_string(current_lanelet.id()) &lt;&lt; <span class="stringliteral">&quot; shares left boundary with &quot;</span> &lt;&lt; std::to_string(ending_lanelet.id()));</div>
<div class="line"><span class="lineno">  335</span>                    is_lanechange_left = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  336</span>                    shared_boundary_found = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  337</span>                }</div>
<div class="line"><span class="lineno">  338</span> </div>
<div class="line"><span class="lineno">  339</span>                <span class="keywordflow">else</span> <span class="keywordflow">if</span>(current_lanelet.rightBound() == ending_lanelet.leftBound()){</div>
<div class="line"><span class="lineno">  340</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;Lanelet &quot;</span> &lt;&lt; std::to_string(current_lanelet.id()) &lt;&lt; <span class="stringliteral">&quot; shares right boundary with &quot;</span> &lt;&lt; std::to_string(ending_lanelet.id()));</div>
<div class="line"><span class="lineno">  341</span>                    shared_boundary_found = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  342</span>                }</div>
<div class="line"><span class="lineno">  343</span> </div>
<div class="line"><span class="lineno">  344</span>                <span class="keywordflow">else</span>{</div>
<div class="line"><span class="lineno">  345</span>                    <span class="comment">//If there are no following lanelets on route, lanechange should be completing before reaching it</span></div>
<div class="line"><span class="lineno">  346</span>                    <span class="keywordflow">if</span>(wm-&gt;getMapRoutingGraph()-&gt;following(current_lanelet, <span class="keyword">false</span>).empty())</div>
<div class="line"><span class="lineno">  347</span>                    {</div>
<div class="line"><span class="lineno">  348</span>                        <span class="comment">// Maneuver requires we travel further before completing lane change, but no routable lanelet directly ahead</span></div>
<div class="line"><span class="lineno">  349</span>                        <span class="comment">//In this case we have reached a lanelet which does not have a routable lanelet ahead + isn&#39;t adjacent to the lanelet where lane change ends</span></div>
<div class="line"><span class="lineno">  350</span>                        <span class="comment">//A lane change should have already happened at this point</span></div>
<div class="line"><span class="lineno">  351</span>                        <span class="keywordflow">throw</span>(std::invalid_argument(<span class="stringliteral">&quot;No following lanelets from current lanelet reachable without a lane change, incorrectly chosen end lanelet&quot;</span>));</div>
<div class="line"><span class="lineno">  352</span>                    }</div>
<div class="line"><span class="lineno">  353</span> </div>
<div class="line"><span class="lineno">  354</span>                    current_lanelet = wm-&gt;getMapRoutingGraph()-&gt;following(current_lanelet, <span class="keyword">false</span>).front(); </div>
<div class="line"><span class="lineno">  355</span>                    <span class="keywordflow">if</span>(current_lanelet.id() == starting_lanelet.id()){</div>
<div class="line"><span class="lineno">  356</span>                        <span class="comment">//Looped back to starting lanelet</span></div>
<div class="line"><span class="lineno">  357</span>                        <span class="keywordflow">throw</span>(std::invalid_argument(<span class="stringliteral">&quot;No lane change in path&quot;</span>));</div>
<div class="line"><span class="lineno">  358</span>                    }</div>
<div class="line"><span class="lineno">  359</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;Now checking for shared lane boundary with lanelet &quot;</span> &lt;&lt; std::to_string(current_lanelet.id()) &lt;&lt; <span class="stringliteral">&quot; and ending lanelet &quot;</span> &lt;&lt; std::to_string(ending_lanelet.id()));</div>
<div class="line"><span class="lineno">  360</span>                    <span class="keyword">auto</span> current_lanelet_linestring = current_lanelet.centerline2d().basicLineString();   </div>
<div class="line"><span class="lineno">  361</span>                    <span class="comment">//Concatenate linestring starting from + 1 to avoid overlap </span></div>
<div class="line"><span class="lineno">  362</span>                    reference_centerline.insert(reference_centerline.end(), current_lanelet_linestring.begin() + 1, current_lanelet_linestring.end());</div>
<div class="line"><span class="lineno">  363</span>                    starting_lane.push_back(current_lanelet);</div>
<div class="line"><span class="lineno">  364</span>                }</div>
<div class="line"><span class="lineno">  365</span>            }</div>
<div class="line"><span class="lineno">  366</span> </div>
<div class="line"><span class="lineno">  367</span>            <span class="comment">// Create the target lane centerline using lanelets adjacent to the lanechange lanelets in the starting lane</span></div>
<div class="line"><span class="lineno">  368</span>            std::vector&lt;lanelet::BasicPoint2d&gt; target_lane_centerline;</div>
<div class="line"><span class="lineno">  369</span>            <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> = 0;<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>&lt;starting_lane.size();++<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>){</div>
<div class="line"><span class="lineno">  370</span>                lanelet::ConstLanelet curr_end_lanelet;</div>
<div class="line"><span class="lineno">  371</span>                </div>
<div class="line"><span class="lineno">  372</span>                <span class="keywordflow">if</span>(is_lanechange_left){</div>
<div class="line"><span class="lineno">  373</span>                    </div>
<div class="line"><span class="lineno">  374</span>                    <span class="comment">//get left lanelet</span></div>
<div class="line"><span class="lineno">  375</span>                    <span class="keywordflow">if</span>(wm-&gt;getMapRoutingGraph()-&gt;left(starting_lane[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>])){</div>
<div class="line"><span class="lineno">  376</span>                        curr_end_lanelet = wm-&gt;getMapRoutingGraph()-&gt;left(starting_lane[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>]).get();</div>
<div class="line"><span class="lineno">  377</span>                    }</div>
<div class="line"><span class="lineno">  378</span>                    <span class="keywordflow">else</span>{</div>
<div class="line"><span class="lineno">  379</span>                        curr_end_lanelet = wm-&gt;getMapRoutingGraph()-&gt;adjacentLeft(starting_lane[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>]).get();</div>
<div class="line"><span class="lineno">  380</span>                    }</div>
<div class="line"><span class="lineno">  381</span>                }</div>
<div class="line"><span class="lineno">  382</span>                <span class="keywordflow">else</span>{</div>
<div class="line"><span class="lineno">  383</span> </div>
<div class="line"><span class="lineno">  384</span>                    <span class="comment">//get right lanelet</span></div>
<div class="line"><span class="lineno">  385</span>                    <span class="keywordflow">if</span>(wm-&gt;getMapRoutingGraph()-&gt;right(starting_lane[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>])){</div>
<div class="line"><span class="lineno">  386</span>                        curr_end_lanelet = wm-&gt;getMapRoutingGraph()-&gt;right(starting_lane[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>]).get();</div>
<div class="line"><span class="lineno">  387</span>                    }</div>
<div class="line"><span class="lineno">  388</span>                    <span class="keywordflow">else</span>{</div>
<div class="line"><span class="lineno">  389</span>                        curr_end_lanelet = wm-&gt;getMapRoutingGraph()-&gt;adjacentRight(starting_lane[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>]).get();</div>
<div class="line"><span class="lineno">  390</span>                    }</div>
<div class="line"><span class="lineno">  391</span>                }</div>
<div class="line"><span class="lineno">  392</span>                </div>
<div class="line"><span class="lineno">  393</span>                <span class="keyword">auto</span> target_lane_linestring = curr_end_lanelet.centerline2d().basicLineString();</div>
<div class="line"><span class="lineno">  394</span>                <span class="comment">//Concatenate linestring starting from + 1 to avoid overlap</span></div>
<div class="line"><span class="lineno">  395</span>                target_lane_centerline.insert(target_lane_centerline.end(), target_lane_linestring.begin() + 1, target_lane_linestring.end());</div>
<div class="line"><span class="lineno">  396</span>                </div>
<div class="line"><span class="lineno">  397</span>            }</div>
<div class="line"><span class="lineno">  398</span> </div>
<div class="line"><span class="lineno">  399</span>            <span class="comment">//Downsample centerlines</span></div>
<div class="line"><span class="lineno">  400</span>            <span class="comment">// 400 value here is an arbitrary attempt at improving performance by reducing copy operations. </span></div>
<div class="line"><span class="lineno">  401</span>            <span class="comment">// Value picked based on annecdotal evidence from STOL system testing</span></div>
<div class="line"><span class="lineno">  402</span> </div>
<div class="line"><span class="lineno">  403</span>            std::vector&lt;lanelet::BasicPoint2d&gt; downsampled_starting_centerline;</div>
<div class="line"><span class="lineno">  404</span>            downsampled_starting_centerline.reserve(400);</div>
<div class="line"><span class="lineno">  405</span>            downsampled_starting_centerline = carma_ros2_utils::containers::downsample_vector(reference_centerline, downsample_ratio);</div>
<div class="line"><span class="lineno">  406</span> </div>
<div class="line"><span class="lineno">  407</span>            std::vector&lt;lanelet::BasicPoint2d&gt; downsampled_target_centerline;</div>
<div class="line"><span class="lineno">  408</span>            downsampled_target_centerline.reserve(400);</div>
<div class="line"><span class="lineno">  409</span>            downsampled_target_centerline = carma_ros2_utils::containers::downsample_vector(target_lane_centerline, downsample_ratio);</div>
<div class="line"><span class="lineno">  410</span> </div>
<div class="line"><span class="lineno">  411</span>            <span class="comment">// Constrain centerlines to starting and ending downtrack</span></div>
<div class="line"><span class="lineno">  412</span>            <span class="keywordtype">int</span> start_index_starting_centerline = <a class="code hl_function" href="namespacebasic__autonomy_1_1waypoint__generation.html#aa399a236f88f7b1c5557327fbb2ba71a">waypoint_generation::get_nearest_index_by_downtrack</a>(downsampled_starting_centerline, wm, starting_downtrack);</div>
<div class="line"><span class="lineno">  413</span>            carma_planning_msgs::msg::VehicleState start_state;</div>
<div class="line"><span class="lineno">  414</span>            start_state.x_pos_global = downsampled_starting_centerline[start_index_starting_centerline].x();</div>
<div class="line"><span class="lineno">  415</span>            start_state.y_pos_global = downsampled_starting_centerline[start_index_starting_centerline].y();</div>
<div class="line"><span class="lineno">  416</span>            <span class="keywordtype">int</span> start_index_target_centerline = <a class="code hl_function" href="namespacebasic__autonomy_1_1waypoint__generation.html#a924ac023f1b51e791ca1b61b9194f44a">waypoint_generation::get_nearest_point_index</a>(downsampled_target_centerline, start_state);</div>
<div class="line"><span class="lineno">  417</span> </div>
<div class="line"><span class="lineno">  418</span>            <span class="keywordtype">int</span> end_index_target_centerline = <a class="code hl_function" href="namespacebasic__autonomy_1_1waypoint__generation.html#aa399a236f88f7b1c5557327fbb2ba71a">waypoint_generation::get_nearest_index_by_downtrack</a>(downsampled_target_centerline, wm, ending_downtrack);</div>
<div class="line"><span class="lineno">  419</span>            carma_planning_msgs::msg::VehicleState end_state;</div>
<div class="line"><span class="lineno">  420</span>            end_state.x_pos_global = downsampled_target_centerline[end_index_target_centerline].x();</div>
<div class="line"><span class="lineno">  421</span>            end_state.y_pos_global = downsampled_target_centerline[end_index_target_centerline].y();</div>
<div class="line"><span class="lineno">  422</span>            <span class="keywordtype">int</span> end_index_starting_centerline = <a class="code hl_function" href="namespacebasic__autonomy_1_1waypoint__generation.html#a924ac023f1b51e791ca1b61b9194f44a">waypoint_generation::get_nearest_point_index</a>(downsampled_starting_centerline, end_state);</div>
<div class="line"><span class="lineno">  423</span> </div>
<div class="line"><span class="lineno">  424</span>            std::vector&lt;lanelet::BasicPoint2d&gt; constrained_start_centerline(downsampled_starting_centerline.begin() + start_index_starting_centerline, downsampled_starting_centerline.begin() + end_index_starting_centerline);</div>
<div class="line"><span class="lineno">  425</span>            std::vector&lt;lanelet::BasicPoint2d&gt; constrained_target_centerline(downsampled_target_centerline.begin() + start_index_target_centerline, downsampled_target_centerline.begin() + end_index_target_centerline);</div>
<div class="line"><span class="lineno">  426</span> </div>
<div class="line"><span class="lineno">  427</span>            <span class="comment">// If constrained centerlines are not the same size - resample to ensure same size along both centerlines</span></div>
<div class="line"><span class="lineno">  428</span>            <span class="keywordflow">if</span>(constrained_start_centerline.size() != constrained_target_centerline.size())</div>
<div class="line"><span class="lineno">  429</span>            {</div>
<div class="line"><span class="lineno">  430</span>                <span class="keyword">auto</span> centerlines = <a class="code hl_function" href="namespacebasic__autonomy_1_1waypoint__generation.html#a19cf5cf882789e1e9ed3e92d0105a8de">resample_linestring_pair_to_same_size</a>(constrained_start_centerline, constrained_target_centerline);</div>
<div class="line"><span class="lineno">  431</span>                constrained_start_centerline = centerlines[0];</div>
<div class="line"><span class="lineno">  432</span>                constrained_target_centerline = centerlines[1];</div>
<div class="line"><span class="lineno">  433</span> </div>
<div class="line"><span class="lineno">  434</span>            }</div>
<div class="line"><span class="lineno">  435</span> </div>
<div class="line"><span class="lineno">  436</span>            <span class="comment">//Create Trajectory geometry</span></div>
<div class="line"><span class="lineno">  437</span>            <span class="keywordtype">double</span> delta_step = 1.0 / constrained_start_centerline.size();</div>
<div class="line"><span class="lineno">  438</span> </div>
<div class="line"><span class="lineno">  439</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> = 0; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> &lt; constrained_start_centerline.size(); ++<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>)</div>
<div class="line"><span class="lineno">  440</span>            {</div>
<div class="line"><span class="lineno">  441</span>                lanelet::BasicPoint2d current_position;</div>
<div class="line"><span class="lineno">  442</span>                lanelet::BasicPoint2d start_lane_pt = constrained_start_centerline[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>];</div>
<div class="line"><span class="lineno">  443</span>                lanelet::BasicPoint2d target_lane_pt = constrained_target_centerline[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>];</div>
<div class="line"><span class="lineno">  444</span>                <span class="keywordtype">double</span> delta = delta_step * <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>;</div>
<div class="line"><span class="lineno">  445</span>                current_position.x() = target_lane_pt.x() * delta + (1 - delta) * start_lane_pt.x();</div>
<div class="line"><span class="lineno">  446</span>                current_position.y() = target_lane_pt.y() * delta + (1 - delta) * start_lane_pt.y();</div>
<div class="line"><span class="lineno">  447</span> </div>
<div class="line"><span class="lineno">  448</span>                centerline_points.push_back(current_position);</div>
<div class="line"><span class="lineno">  449</span>            }</div>
<div class="line"><span class="lineno">  450</span> </div>
<div class="line"><span class="lineno">  451</span>            <span class="comment">// Add points from the remaining length of the target lanelet to provide sufficient distance for adding buffer</span></div>
<div class="line"><span class="lineno">  452</span>            <span class="keywordtype">double</span> dist_to_target_lane_end = lanelet::geometry::distance2d(centerline_points.back(), downsampled_target_centerline.back());</div>
<div class="line"><span class="lineno">  453</span>            centerline_points.insert(centerline_points.end(), downsampled_target_centerline.begin() + end_index_target_centerline, downsampled_target_centerline.end());</div>
<div class="line"><span class="lineno">  454</span>            </div>
<div class="line"><span class="lineno">  455</span>            <span class="comment">// If the additional distance from the remaining length of the target lanelet does not provide more than the required</span></div>
<div class="line"><span class="lineno">  456</span>            <span class="comment">// buffer_ending_downtrack, then also add points from the lanelet following the target lanelet</span></div>
<div class="line"><span class="lineno">  457</span>            <span class="keywordflow">if</span> (dist_to_target_lane_end &lt; buffer_ending_downtrack) {</div>
<div class="line"><span class="lineno">  458</span>                <span class="keyword">auto</span> following_lanelets = wm-&gt;getMapRoutingGraph()-&gt;following(ending_lanelet, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  459</span>                <span class="keywordflow">if</span>(!following_lanelets.empty()){</div>
<div class="line"><span class="lineno">  460</span>                    <span class="comment">//Arbitrarily choosing first following lanelet for buffer since points are only being used to fit spline</span></div>
<div class="line"><span class="lineno">  461</span>                    <span class="keyword">auto</span> following_lanelet_centerline = following_lanelets.front().centerline2d().basicLineString();</div>
<div class="line"><span class="lineno">  462</span>                    centerline_points.insert(centerline_points.end(), following_lanelet_centerline.begin(), </div>
<div class="line"><span class="lineno">  463</span>                                                                                following_lanelet_centerline.end());</div>
<div class="line"><span class="lineno">  464</span>                }</div>
<div class="line"><span class="lineno">  465</span>            }</div>
<div class="line"><span class="lineno">  466</span> </div>
<div class="line"><span class="lineno">  467</span>            <span class="keywordflow">return</span> centerline_points;</div>
<div class="line"><span class="lineno">  468</span>        }</div>
<div class="ttc" id="anamespacebasic__autonomy_1_1waypoint__generation_html_a19cf5cf882789e1e9ed3e92d0105a8de"><div class="ttname"><a href="namespacebasic__autonomy_1_1waypoint__generation.html#a19cf5cf882789e1e9ed3e92d0105a8de">basic_autonomy::waypoint_generation::resample_linestring_pair_to_same_size</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; lanelet::BasicPoint2d &gt; &gt; resample_linestring_pair_to_same_size(std::vector&lt; lanelet::BasicPoint2d &gt; &amp;line_1, std::vector&lt; lanelet::BasicPoint2d &gt; &amp;line_2)</div><div class="ttdoc">Resamples a pair of basicpoint2d lines to get lines of same number of points.</div><div class="ttdef"><b>Definition:</b> <a href="basic__autonomy_8cpp_source.html#l00470">basic_autonomy.cpp:470</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="basic__autonomy_8hpp_source.html#l00062">BASIC_AUTONOMY_LOGGER</a>, <a class="el" href="helper__functions_8cpp_source.html#l00065">get_nearest_index_by_downtrack()</a>, <a class="el" href="helper__functions_8cpp_source.html#l00024">get_nearest_point_index()</a>, <a class="el" href="process__bag_8py_source.html#l00059">process_bag::i</a>, and <a class="el" href="basic__autonomy_8cpp_source.html#l00470">resample_linestring_pair_to_same_size()</a>.</p>

<p class="reference">Referenced by <a class="el" href="basic__autonomy_8cpp_source.html#l00532">get_lanechange_points_from_maneuver()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebasic__autonomy_1_1waypoint__generation_a2219ab96db87781023137bdb45af1ea2_cgraph.png" border="0" usemap="#anamespacebasic__autonomy_1_1waypoint__generation_a2219ab96db87781023137bdb45af1ea2_cgraph" alt=""/></div>
<map name="anamespacebasic__autonomy_1_1waypoint__generation_a2219ab96db87781023137bdb45af1ea2_cgraph" id="anamespacebasic__autonomy_1_1waypoint__generation_a2219ab96db87781023137bdb45af1ea2_cgraph">
<area shape="rect" title="Creates a vector of lane change points using parameters defined." alt="" coords="5,85,209,141"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#aa399a236f88f7b1c5557327fbb2ba71a" title="Returns the nearest &quot;less than&quot; point to the provided vehicle pose in the provided list by utilizing ..." alt="" coords="274,5,447,61"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#a924ac023f1b51e791ca1b61b9194f44a" title="Returns the nearest point (in terms of cartesian 2d distance) to the provided vehicle pose in the pro..." alt="" coords="274,85,447,141"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#a19cf5cf882789e1e9ed3e92d0105a8de" title="Resamples a pair of basicpoint2d lines to get lines of same number of points." alt="" coords="257,165,464,221"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#adf1c6b7f1e33569b45074e4e5bbeff1d" title="Compute the arc length at each point around the curve." alt="" coords="523,139,675,181"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#a9e0eab343d21d18c665083839d706f04" title="Computes a spline based on the provided points." alt="" coords="512,205,685,246"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#a4e12c2971926486d1447e44e978f8d4d" title=" " alt="" coords="733,132,879,188"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#a9bc48b810ba18270fcc21674b55922f0" title="Compute the Euclidean distance between the two points." alt="" coords="927,132,1072,188"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebasic__autonomy_1_1waypoint__generation_a2219ab96db87781023137bdb45af1ea2_icgraph.png" border="0" usemap="#anamespacebasic__autonomy_1_1waypoint__generation_a2219ab96db87781023137bdb45af1ea2_icgraph" alt=""/></div>
<map name="anamespacebasic__autonomy_1_1waypoint__generation_a2219ab96db87781023137bdb45af1ea2_icgraph" id="anamespacebasic__autonomy_1_1waypoint__generation_a2219ab96db87781023137bdb45af1ea2_icgraph">
<area shape="rect" title="Creates a vector of lane change points using parameters defined." alt="" coords="988,85,1192,141"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#af992a6cbbdafd6e86d73976a65164e94" title="Converts a set of requested LANE_CHANGE maneuvers to point speed limit pairs." alt="" coords="753,85,940,141"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#acdcd3bb44d31aa6405b30f151ea35ae4" title="Creates geometry profile to return a point speed pair struct for LANE FOLLOW and LANE CHANGE maneuver..." alt="" coords="515,85,705,141"/>
<area shape="rect" href="classcooperative__lanechange_1_1CooperativeLaneChangePlugin.html#a5f0c14a409d58d6b1750c38c6bf1b34a" title="Creates a vector of Trajectory Points from maneuver information in trajectory request." alt="" coords="260,5,467,61"/>
<area shape="rect" href="classinlanecruising__plugin_1_1InLaneCruisingPlugin.html#a60f695c3ed54c99c6a2dcfaf77ae55e2" title="Service callback for trajectory planning." alt="" coords="280,85,447,141"/>
<area shape="rect" href="classplatooning__tactical__plugin_1_1PlatooningTacticalPlugin.html#aee3afe082ccd5ab937dbb1c49f9e21ff" title="Service callback for trajectory planning." alt="" coords="275,165,451,221"/>
<area shape="rect" href="classcooperative__lanechange_1_1CooperativeLaneChangePlugin.html#a8913539d8614e509910af225e18bc809" title="Extending class provided callback which should return a planned trajectory based on the provided traj..." alt="" coords="5,5,212,61"/>
</map>
</div>

</div>
</div>
<a id="aa1466a3966dee2e7bfb71ac6f7e62e5b" name="aa1466a3966dee2e7bfb71ac6f7e62e5b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1466a3966dee2e7bfb71ac6f7e62e5b">&#9670;&nbsp;</a></span>create_lanechange_path()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">lanelet::BasicLineString2d basic_autonomy::waypoint_generation::create_lanechange_path </td>
          <td>(</td>
          <td class="paramtype">const lanelet::ConstLanelet &amp;&#160;</td>
          <td class="paramname"><em>start_lanelet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const lanelet::ConstLanelet &amp;&#160;</td>
          <td class="paramname"><em>end_lanelet</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Given a start and end point, create a vector of points fit through a spline between the points (using a Spline library) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">start_lanelet</td><td>The lanelet from which lane change starts </td></tr>
    <tr><td class="paramname">end_lanelet</td><td>The lanelet in which lane change ends</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A linestring path from start to end fit through Spline Library </dd></dl>

</div>
</div>
<a id="aa3500af9146c0d9c80cb1b4101be01e5" name="aa3500af9146c0d9c80cb1b4101be01e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3500af9146c0d9c80cb1b4101be01e5">&#9670;&nbsp;</a></span>create_lanefollow_geometry()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1PointSpeedPair.html">PointSpeedPair</a> &gt; basic_autonomy::waypoint_generation::create_lanefollow_geometry </td>
          <td>(</td>
          <td class="paramtype">const carma_planning_msgs::msg::Maneuver &amp;&#160;</td>
          <td class="paramname"><em>maneuver</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_starting_downtrack</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacecarma__wm.html#a3ac653959e0b6198cae274d68b343228">carma_wm::WorldModelConstPtr</a> &amp;&#160;</td>
          <td class="paramname"><em>wm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1GeneralTrajConfig.html">GeneralTrajConfig</a> &amp;&#160;</td>
          <td class="paramname"><em>general_config</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html">DetailedTrajConfig</a> &amp;&#160;</td>
          <td class="paramname"><em>detailed_config</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unordered_set&lt; lanelet::Id &gt; &amp;&#160;</td>
          <td class="paramname"><em>visited_lanelets</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts a set of requested LANE_FOLLOWING maneuvers to point speed limit pairs. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">maneuvers</td><td>The list of maneuvers to convert geometry points and calculate associated speed </td></tr>
    <tr><td class="paramname">max_starting_downtrack</td><td>The maximum downtrack that is allowed for the first maneuver. This should be set to the vehicle position or earlier. If the first maneuver exceeds this then it's downtrack will be shifted to this value. </td></tr>
    <tr><td class="paramname">wm</td><td>Pointer to intialized world model for semantic map access </td></tr>
    <tr><td class="paramname">general_config</td><td>Basic autonomy struct defined to load general config parameters from tactical plugins </td></tr>
    <tr><td class="paramname">detailed_config</td><td>Basic autonomy struct defined to load detailed config parameters from tactical plugins</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>List of centerline points paired with speed limits </dd></dl>

<p class="definition">Definition at line <a class="el" href="basic__autonomy_8cpp_source.html#l00068">68</a> of file <a class="el" href="basic__autonomy_8cpp_source.html">basic_autonomy.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   71</span>        {</div>
<div class="line"><span class="lineno">   72</span>            <span class="keywordflow">if</span>(maneuver.type != carma_planning_msgs::msg::Maneuver::LANE_FOLLOWING){</div>
<div class="line"><span class="lineno">   73</span>                <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;Create_lanefollow called on a maneuver type which is not LANE_FOLLOW&quot;</span>);</div>
<div class="line"><span class="lineno">   74</span>            }</div>
<div class="line"><span class="lineno">   75</span>            std::vector&lt;PointSpeedPair&gt; points_and_target_speeds;</div>
<div class="line"><span class="lineno">   76</span> </div>
<div class="line"><span class="lineno">   77</span>            carma_planning_msgs::msg::LaneFollowingManeuver lane_following_maneuver = maneuver.lane_following_maneuver;</div>
<div class="line"><span class="lineno">   78</span> </div>
<div class="line"><span class="lineno">   79</span>            <span class="keywordflow">if</span> (maneuver.lane_following_maneuver.lane_ids.empty())</div>
<div class="line"><span class="lineno">   80</span>            {</div>
<div class="line"><span class="lineno">   81</span>                <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;No lanelets are defined for lanefollow maneuver&quot;</span>);</div>
<div class="line"><span class="lineno">   82</span>            }</div>
<div class="line"><span class="lineno">   83</span> </div>
<div class="line"><span class="lineno">   84</span>            std::vector&lt;lanelet::ConstLanelet&gt; lanelets = { wm-&gt;getMap()-&gt;laneletLayer.get(stoi(lane_following_maneuver.lane_ids[0]))}; <span class="comment">// Accept first lanelet reguardless</span></div>
<div class="line"><span class="lineno">   85</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> = 1; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> &lt; lane_following_maneuver.lane_ids.size(); <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>++) <span class="comment">// Iterate over remaining lanelets and check if they are followers of the previous lanelet</span></div>
<div class="line"><span class="lineno">   86</span>            {</div>
<div class="line"><span class="lineno">   87</span>                <span class="keyword">auto</span> ll_id = lane_following_maneuver.lane_ids[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>];</div>
<div class="line"><span class="lineno">   88</span>                <span class="keywordtype">int</span> cur_id = stoi(ll_id);</div>
<div class="line"><span class="lineno">   89</span>                <span class="keyword">auto</span> cur_ll = wm-&gt;getMap()-&gt;laneletLayer.get(cur_id);</div>
<div class="line"><span class="lineno">   90</span>                <span class="keyword">auto</span> following_lanelets = wm-&gt;getMapRoutingGraph()-&gt;following(lanelets.back());</div>
<div class="line"><span class="lineno">   91</span> </div>
<div class="line"><span class="lineno">   92</span>                <span class="keywordtype">bool</span> is_follower = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   93</span>                <span class="keywordflow">for</span> (<span class="keyword">auto</span> follower_ll : following_lanelets )</div>
<div class="line"><span class="lineno">   94</span>                {</div>
<div class="line"><span class="lineno">   95</span>                    <span class="keywordflow">if</span> (follower_ll.id() == cur_ll.id())</div>
<div class="line"><span class="lineno">   96</span>                    {</div>
<div class="line"><span class="lineno">   97</span>                        is_follower = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">   98</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">   99</span>                    }</div>
<div class="line"><span class="lineno">  100</span>                }</div>
<div class="line"><span class="lineno">  101</span> </div>
<div class="line"><span class="lineno">  102</span>                <span class="keywordflow">if</span> (!is_follower)</div>
<div class="line"><span class="lineno">  103</span>                {</div>
<div class="line"><span class="lineno">  104</span>                    <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;Invalid list of lanelets they are not followers&quot;</span>);</div>
<div class="line"><span class="lineno">  105</span>                }</div>
<div class="line"><span class="lineno">  106</span> </div>
<div class="line"><span class="lineno">  107</span>                lanelets.push_back(cur_ll); <span class="comment">// Keep lanelet</span></div>
<div class="line"><span class="lineno">  108</span> </div>
<div class="line"><span class="lineno">  109</span>            }</div>
<div class="line"><span class="lineno">  110</span> </div>
<div class="line"><span class="lineno">  111</span>            <span class="comment">// Add extra lanelet to ensure there are sufficient points for buffer</span></div>
<div class="line"><span class="lineno">  112</span>            <span class="keyword">auto</span> extra_following_lanelets = wm-&gt;getMapRoutingGraph()-&gt;following(lanelets.back());</div>
<div class="line"><span class="lineno">  113</span>           </div>
<div class="line"><span class="lineno">  114</span>            <span class="keywordflow">for</span> (<span class="keyword">auto</span> llt : wm-&gt;getRoute()-&gt;shortestPath())</div>
<div class="line"><span class="lineno">  115</span>            {</div>
<div class="line"><span class="lineno">  116</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> = 0; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> &lt; extra_following_lanelets.size(); <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>++)</div>
<div class="line"><span class="lineno">  117</span>                {</div>
<div class="line"><span class="lineno">  118</span>                    <span class="keywordflow">if</span> (llt.id() == extra_following_lanelets[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>].id())</div>
<div class="line"><span class="lineno">  119</span>                    {</div>
<div class="line"><span class="lineno">  120</span>                        lanelets.push_back(extra_following_lanelets[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>]);</div>
<div class="line"><span class="lineno">  121</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  122</span>                    }</div>
<div class="line"><span class="lineno">  123</span>                }</div>
<div class="line"><span class="lineno">  124</span>            }</div>
<div class="line"><span class="lineno">  125</span>            </div>
<div class="line"><span class="lineno">  126</span>            <span class="keywordflow">if</span> (lanelets.empty())</div>
<div class="line"><span class="lineno">  127</span>            {</div>
<div class="line"><span class="lineno">  128</span>                RCLCPP_ERROR_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;Detected no lanelets between starting downtrack: &quot;</span>&lt;&lt; starting_downtrack &lt;&lt; <span class="stringliteral">&quot;, and lane_following_maneuver.end_dist: &quot;</span>&lt;&lt; lane_following_maneuver.end_dist);</div>
<div class="line"><span class="lineno">  129</span>                <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;Detected no lanelets between starting_downtrack and end_dist&quot;</span>);</div>
<div class="line"><span class="lineno">  130</span>            }</div>
<div class="line"><span class="lineno">  131</span> </div>
<div class="line"><span class="lineno">  132</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;Maneuver&quot;</span>);</div>
<div class="line"><span class="lineno">  133</span> </div>
<div class="line"><span class="lineno">  134</span>            lanelet::BasicLineString2d downsampled_centerline;</div>
<div class="line"><span class="lineno">  135</span>            <span class="comment">// 400 value here is an arbitrary attempt at improving inlane-cruising performance by reducing copy operations. </span></div>
<div class="line"><span class="lineno">  136</span>            <span class="comment">// Value picked based on annecdotal evidence from STOL system testing</span></div>
<div class="line"><span class="lineno">  137</span>            downsampled_centerline.reserve(400);</div>
<div class="line"><span class="lineno">  138</span>            </div>
<div class="line"><span class="lineno">  139</span>            <span class="comment">//getLaneletsBetween is inclusive of lanelets between its two boundaries</span></div>
<div class="line"><span class="lineno">  140</span>            <span class="comment">//which may return lanechange lanelets, so</span></div>
<div class="line"><span class="lineno">  141</span>            <span class="comment">//exclude lanechanges and plan for only the straight part</span></div>
<div class="line"><span class="lineno">  142</span>            <span class="keywordtype">size_t</span> curr_idx = 0;</div>
<div class="line"><span class="lineno">  143</span>            <span class="keyword">auto</span> following_lanelets = wm-&gt;getMapRoutingGraph()-&gt;following(lanelets[curr_idx]);</div>
<div class="line"><span class="lineno">  144</span>            lanelet::ConstLanelets straight_lanelets;</div>
<div class="line"><span class="lineno">  145</span> </div>
<div class="line"><span class="lineno">  146</span>            <span class="keywordflow">if</span>(lanelets.size() &lt;= 1) <span class="comment">//no lane change anyways if only size 1</span></div>
<div class="line"><span class="lineno">  147</span>            {</div>
<div class="line"><span class="lineno">  148</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;Detected one straight lanelet Id:&quot;</span> &lt;&lt; lanelets[curr_idx].<span class="keywordtype">id</span>());</div>
<div class="line"><span class="lineno">  149</span>                straight_lanelets = lanelets;</div>
<div class="line"><span class="lineno">  150</span>            }</div>
<div class="line"><span class="lineno">  151</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  152</span>            {</div>
<div class="line"><span class="lineno">  153</span>                <span class="comment">// skip all lanechanges until lane follow starts</span></div>
<div class="line"><span class="lineno">  154</span>                <span class="keywordflow">while</span> (curr_idx + 1 &lt; lanelets.size() &amp;&amp; </div>
<div class="line"><span class="lineno">  155</span>                        std::find(following_lanelets.begin(),following_lanelets.end(), lanelets[curr_idx + 1]) == following_lanelets.end())</div>
<div class="line"><span class="lineno">  156</span>                {</div>
<div class="line"><span class="lineno">  157</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;As there were no directly following lanelets after this, skipping lanelet id: &quot;</span> &lt;&lt; lanelets[curr_idx].<span class="keywordtype">id</span>());</div>
<div class="line"><span class="lineno">  158</span>                    curr_idx ++;</div>
<div class="line"><span class="lineno">  159</span>                    following_lanelets = wm-&gt;getMapRoutingGraph()-&gt;following(lanelets[curr_idx]);</div>
<div class="line"><span class="lineno">  160</span>                }</div>
<div class="line"><span class="lineno">  161</span> </div>
<div class="line"><span class="lineno">  162</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;Added lanelet Id for lane follow: &quot;</span> &lt;&lt; lanelets[curr_idx].<span class="keywordtype">id</span>());</div>
<div class="line"><span class="lineno">  163</span>                <span class="comment">// guaranteed to have at least one &quot;straight&quot; lanelet (e.g the last one in the list)</span></div>
<div class="line"><span class="lineno">  164</span>                straight_lanelets.push_back(lanelets[curr_idx]);</div>
<div class="line"><span class="lineno">  165</span>                      <span class="comment">// add all lanelets on the straight road until next lanechange</span></div>
<div class="line"><span class="lineno">  166</span>                <span class="keywordflow">while</span> (curr_idx + 1 &lt; lanelets.size() &amp;&amp; </div>
<div class="line"><span class="lineno">  167</span>                        std::find(following_lanelets.begin(),following_lanelets.end(), lanelets[curr_idx + 1]) != following_lanelets.end())</div>
<div class="line"><span class="lineno">  168</span>                {</div>
<div class="line"><span class="lineno">  169</span>                    curr_idx++;</div>
<div class="line"><span class="lineno">  170</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;Added lanelet Id forlane follow: &quot;</span> &lt;&lt; lanelets[curr_idx].<span class="keywordtype">id</span>());</div>
<div class="line"><span class="lineno">  171</span>                    straight_lanelets.push_back(lanelets[curr_idx]);</div>
<div class="line"><span class="lineno">  172</span>                    following_lanelets = wm-&gt;getMapRoutingGraph()-&gt;following(lanelets[curr_idx]);</div>
<div class="line"><span class="lineno">  173</span>                }</div>
<div class="line"><span class="lineno">  174</span>                </div>
<div class="line"><span class="lineno">  175</span>            }</div>
<div class="line"><span class="lineno">  176</span>            </div>
<div class="line"><span class="lineno">  177</span>            <span class="keywordflow">for</span> (<span class="keyword">auto</span> l : straight_lanelets)</div>
<div class="line"><span class="lineno">  178</span>            {</div>
<div class="line"><span class="lineno">  179</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;Processing lanelet ID: &quot;</span> &lt;&lt; l.id());</div>
<div class="line"><span class="lineno">  180</span>                <span class="keywordflow">if</span> (visited_lanelets.find(l.id()) == visited_lanelets.end())</div>
<div class="line"><span class="lineno">  181</span>                {</div>
<div class="line"><span class="lineno">  182</span> </div>
<div class="line"><span class="lineno">  183</span>                    <span class="keywordtype">bool</span> is_turn = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  184</span>                    <span class="keywordflow">if</span>(l.hasAttribute(<span class="stringliteral">&quot;turn_direction&quot;</span>)) {</div>
<div class="line"><span class="lineno">  185</span>                        std::string turn_direction = l.attribute(<span class="stringliteral">&quot;turn_direction&quot;</span>).value();</div>
<div class="line"><span class="lineno">  186</span>                        is_turn = turn_direction.compare(<span class="stringliteral">&quot;left&quot;</span>) == 0 || turn_direction.compare(<span class="stringliteral">&quot;right&quot;</span>) == 0;</div>
<div class="line"><span class="lineno">  187</span>                    }</div>
<div class="line"><span class="lineno">  188</span>                    </div>
<div class="line"><span class="lineno">  189</span>                    lanelet::BasicLineString2d centerline = l.centerline2d().basicLineString();</div>
<div class="line"><span class="lineno">  190</span>                    lanelet::BasicLineString2d downsampled_points;</div>
<div class="line"><span class="lineno">  191</span>                    <span class="keywordflow">if</span> (is_turn) {</div>
<div class="line"><span class="lineno">  192</span>                        downsampled_points = carma_ros2_utils::containers::downsample_vector(centerline, general_config.<a class="code hl_variable" href="structbasic__autonomy_1_1waypoint__generation_1_1GeneralTrajConfig.html#a57b1703c6bbc6043c489280ca1c34041">turn_downsample_ratio</a>);</div>
<div class="line"><span class="lineno">  193</span>                    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  194</span>                        downsampled_points = carma_ros2_utils::containers::downsample_vector(centerline, general_config.<a class="code hl_variable" href="structbasic__autonomy_1_1waypoint__generation_1_1GeneralTrajConfig.html#a0ad2d91d1f739942213d5bfe7f0e861f">default_downsample_ratio</a>);</div>
<div class="line"><span class="lineno">  195</span>                    }</div>
<div class="line"><span class="lineno">  196</span>                    </div>
<div class="line"><span class="lineno">  197</span>                    <span class="keywordflow">if</span>(downsampled_centerline.size() != 0 &amp;&amp; downsampled_points.size() != 0 <span class="comment">// If this is not the first lanelet and the points are closer than 1m drop the first point to prevent overlap</span></div>
<div class="line"><span class="lineno">  198</span>                    &amp;&amp; lanelet::geometry::distance2d(downsampled_points.front(), downsampled_centerline.back()) &lt;1.2){</div>
<div class="line"><span class="lineno">  199</span>                        downsampled_points = lanelet::BasicLineString2d(downsampled_points.begin() + 1, downsampled_points.end());</div>
<div class="line"><span class="lineno">  200</span>                    }</div>
<div class="line"><span class="lineno">  201</span> </div>
<div class="line"><span class="lineno">  202</span>                    downsampled_centerline = <a class="code hl_function" href="namespacecarma__wm_1_1geometry.html#ae7d5ca280140dce2bf7bcfb78bdfd55d">carma_wm::geometry::concatenate_line_strings</a>(downsampled_centerline, downsampled_points);</div>
<div class="line"><span class="lineno">  203</span>                    visited_lanelets.insert(l.id());</div>
<div class="line"><span class="lineno">  204</span>                }</div>
<div class="line"><span class="lineno">  205</span>            }</div>
<div class="line"><span class="lineno">  206</span> </div>
<div class="line"><span class="lineno">  207</span>            <span class="keywordtype">bool</span> first = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  208</span>            <span class="keywordflow">for</span> (<span class="keyword">auto</span> p : downsampled_centerline)</div>
<div class="line"><span class="lineno">  209</span>            {</div>
<div class="line"><span class="lineno">  210</span>                <span class="keywordflow">if</span> (first &amp;&amp; !points_and_target_speeds.empty())</div>
<div class="line"><span class="lineno">  211</span>                {</div>
<div class="line"><span class="lineno">  212</span>                    first = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  213</span>                    <span class="keywordflow">continue</span>; <span class="comment">// Skip the first point if we have already added points from a previous maneuver to avoid duplicates</span></div>
<div class="line"><span class="lineno">  214</span>                }</div>
<div class="line"><span class="lineno">  215</span>                <a class="code hl_typedef" href="namespacecooperative__lanechange.html#af2521f0bb23baab64641072110316a67">PointSpeedPair</a> pair;</div>
<div class="line"><span class="lineno">  216</span>                pair.<a class="code hl_variable" href="structbasic__autonomy_1_1waypoint__generation_1_1PointSpeedPair.html#a628d9d3853745335b42ad940136d88ac">point</a> = p;</div>
<div class="line"><span class="lineno">  217</span>                pair.speed = lane_following_maneuver.end_speed;</div>
<div class="line"><span class="lineno">  218</span>                points_and_target_speeds.push_back(pair);</div>
<div class="line"><span class="lineno">  219</span>            }</div>
<div class="line"><span class="lineno">  220</span>            </div>
<div class="line"><span class="lineno">  221</span>            <span class="keywordflow">return</span> points_and_target_speeds;</div>
<div class="line"><span class="lineno">  222</span> </div>
<div class="line"><span class="lineno">  223</span>        }</div>
<div class="ttc" id="anamespacecarma__wm_1_1geometry_html_ae7d5ca280140dce2bf7bcfb78bdfd55d"><div class="ttname"><a href="namespacecarma__wm_1_1geometry.html#ae7d5ca280140dce2bf7bcfb78bdfd55d">carma_wm::geometry::concatenate_line_strings</a></div><div class="ttdeci">lanelet::BasicLineString2d concatenate_line_strings(const lanelet::BasicLineString2d &amp;l1, const lanelet::BasicLineString2d &amp;l2)</div><div class="ttdoc">Helper function to concatenate 2 linestrings together and return the result. Neither LineString is mo...</div><div class="ttdef"><b>Definition:</b> <a href="Geometry_8cpp_source.html#l00373">Geometry.cpp:373</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="basic__autonomy_8hpp_source.html#l00062">BASIC_AUTONOMY_LOGGER</a>, <a class="el" href="Geometry_8cpp_source.html#l00373">carma_wm::geometry::concatenate_line_strings()</a>, <a class="el" href="basic__autonomy_8hpp_source.html#l00073">basic_autonomy::waypoint_generation::GeneralTrajConfig::default_downsample_ratio</a>, <a class="el" href="process__bag_8py_source.html#l00059">process_bag::i</a>, <a class="el" href="basic__autonomy_8hpp_source.html#l00066">basic_autonomy::waypoint_generation::PointSpeedPair::point</a>, <a class="el" href="basic__autonomy_8hpp_source.html#l00067">basic_autonomy::waypoint_generation::PointSpeedPair::speed</a>, and <a class="el" href="basic__autonomy_8hpp_source.html#l00074">basic_autonomy::waypoint_generation::GeneralTrajConfig::turn_downsample_ratio</a>.</p>

<p class="reference">Referenced by <a class="el" href="basic__autonomy_8cpp_source.html#l00024">create_geometry_profile()</a>, and <a class="el" href="light__controlled__intersection__tactical__plugin_8cpp_source.html#l00386">light_controlled_intersection_tactical_plugin::LightControlledIntersectionTacticalPlugin::createGeometryProfile()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebasic__autonomy_1_1waypoint__generation_aa3500af9146c0d9c80cb1b4101be01e5_cgraph.png" border="0" usemap="#anamespacebasic__autonomy_1_1waypoint__generation_aa3500af9146c0d9c80cb1b4101be01e5_cgraph" alt=""/></div>
<map name="anamespacebasic__autonomy_1_1waypoint__generation_aa3500af9146c0d9c80cb1b4101be01e5_cgraph" id="anamespacebasic__autonomy_1_1waypoint__generation_aa3500af9146c0d9c80cb1b4101be01e5_cgraph">
<area shape="rect" title="Converts a set of requested LANE_FOLLOWING maneuvers to point speed limit pairs." alt="" coords="5,5,201,61"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#ae7d5ca280140dce2bf7bcfb78bdfd55d" title="Helper function to concatenate 2 linestrings together and return the result. Neither LineString is mo..." alt="" coords="249,13,421,54"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#a9bc48b810ba18270fcc21674b55922f0" title="Compute the Euclidean distance between the two points." alt="" coords="469,5,615,61"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebasic__autonomy_1_1waypoint__generation_aa3500af9146c0d9c80cb1b4101be01e5_icgraph.png" border="0" usemap="#anamespacebasic__autonomy_1_1waypoint__generation_aa3500af9146c0d9c80cb1b4101be01e5_icgraph" alt=""/></div>
<map name="anamespacebasic__autonomy_1_1waypoint__generation_aa3500af9146c0d9c80cb1b4101be01e5_icgraph" id="anamespacebasic__autonomy_1_1waypoint__generation_aa3500af9146c0d9c80cb1b4101be01e5_icgraph">
<area shape="rect" title="Converts a set of requested LANE_FOLLOWING maneuvers to point speed limit pairs." alt="" coords="940,165,1136,221"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#acdcd3bb44d31aa6405b30f151ea35ae4" title="Creates geometry profile to return a point speed pair struct for LANE FOLLOW and LANE CHANGE maneuver..." alt="" coords="643,125,834,181"/>
<area shape="rect" href="classlight__controlled__intersection__tactical__plugin_1_1LightControlledIntersectionTacticalPlugin.html#afee417a4310729540055e6c6f35eeccf" title="Creates geometry profile to return a point speed pair struct for INTERSECTION_TRANSIT maneuver types ..." alt="" coords="585,205,892,261"/>
<area shape="rect" href="classcooperative__lanechange_1_1CooperativeLaneChangePlugin.html#a5f0c14a409d58d6b1750c38c6bf1b34a" title="Creates a vector of Trajectory Points from maneuver information in trajectory request." alt="" coords="295,5,502,61"/>
<area shape="rect" href="classinlanecruising__plugin_1_1InLaneCruisingPlugin.html#a60f695c3ed54c99c6a2dcfaf77ae55e2" title="Service callback for trajectory planning." alt="" coords="315,85,482,141"/>
<area shape="rect" href="classplatooning__tactical__plugin_1_1PlatooningTacticalPlugin.html#aee3afe082ccd5ab937dbb1c49f9e21ff" title="Service callback for trajectory planning." alt="" coords="311,165,487,221"/>
<area shape="rect" href="classcooperative__lanechange_1_1CooperativeLaneChangePlugin.html#a8913539d8614e509910af225e18bc809" title="Extending class provided callback which should return a planned trajectory based on the provided traj..." alt="" coords="5,5,212,61"/>
<area shape="rect" href="classlight__controlled__intersection__tactical__plugin_1_1LightControlledIntersectionTacticalPlugin.html#a124f95825dfb2728fefa245e6a0e1db7" title="Function to process the light controlled intersection tactical plugin service call for trajectory pla..." alt="" coords="260,245,537,301"/>
</map>
</div>

</div>
</div>
<a id="a9876518513a13a569a63f225013b686f" name="a9876518513a13a569a63f225013b686f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9876518513a13a569a63f225013b686f">&#9670;&nbsp;</a></span>create_route_geom()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; lanelet::BasicPoint2d &gt; basic_autonomy::waypoint_generation::create_route_geom </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>starting_downtrack</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classint.html">int</a>&#160;</td>
          <td class="paramname"><em>starting_lane_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ending_downtrack</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacecarma__wm.html#a3ac653959e0b6198cae274d68b343228">carma_wm::WorldModelConstPtr</a> &amp;&#160;</td>
          <td class="paramname"><em>wm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a Lanelet2 Linestring from a vector or points along the geometry. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">starting_downtrack</td><td>downtrack along route where maneuver starts </td></tr>
    <tr><td class="paramname">ending_downtrack</td><td>downtrack along route where maneuver starts </td></tr>
    <tr><td class="paramname">wm</td><td>Pointer to intialized world model for semantic map access</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Points in a path from starting downtrack to ending downtrack </dd></dl>

</div>
</div>
<a id="af992a6cbbdafd6e86d73976a65164e94" name="af992a6cbbdafd6e86d73976a65164e94"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af992a6cbbdafd6e86d73976a65164e94">&#9670;&nbsp;</a></span>get_lanechange_points_from_maneuver()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1PointSpeedPair.html">PointSpeedPair</a> &gt; basic_autonomy::waypoint_generation::get_lanechange_points_from_maneuver </td>
          <td>(</td>
          <td class="paramtype">const carma_planning_msgs::msg::Maneuver &amp;&#160;</td>
          <td class="paramname"><em>maneuver</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_starting_downtrack</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacecarma__wm.html#a3ac653959e0b6198cae274d68b343228">carma_wm::WorldModelConstPtr</a> &amp;&#160;</td>
          <td class="paramname"><em>wm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">carma_planning_msgs::msg::VehicleState &amp;&#160;</td>
          <td class="paramname"><em>ending_state_before_buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const carma_planning_msgs::msg::VehicleState &amp;&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1GeneralTrajConfig.html">GeneralTrajConfig</a> &amp;&#160;</td>
          <td class="paramname"><em>general_config</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html">DetailedTrajConfig</a> &amp;&#160;</td>
          <td class="paramname"><em>detailed_config</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts a set of requested LANE_CHANGE maneuvers to point speed limit pairs. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">maneuvers</td><td>The list of maneuvers to convert </td></tr>
    <tr><td class="paramname">max_starting_downtrack</td><td>The maximum downtrack that is allowed for the first maneuver. This should be set to the vehicle position or earlier. If the first maneuver exceeds this then it's downtrack will be shifted to this value.</td></tr>
    <tr><td class="paramname">wm</td><td>Pointer to intialized world model for semantic map access </td></tr>
    <tr><td class="paramname">ending_state_before_buffer</td><td>reference to Vehicle state, which is state before applying extra points for curvature calculation that are removed later </td></tr>
    <tr><td class="paramname">state</td><td>The vehicle state at the time the function is called </td></tr>
    <tr><td class="paramname">general_config</td><td>Basic autonomy struct defined to load general config parameters from tactical plugins </td></tr>
    <tr><td class="paramname">detailed_config</td><td>Basic autonomy struct defined to load detailed config parameters from tactical plugins</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A vector of point speed pair struct which contains geometry points as basicpoint::lanelet2d and speed as a double for the maneuver </dd></dl>

<p class="definition">Definition at line <a class="el" href="basic__autonomy_8cpp_source.html#l00532">532</a> of file <a class="el" href="basic__autonomy_8cpp_source.html">basic_autonomy.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  535</span>        {</div>
<div class="line"><span class="lineno">  536</span>            <span class="keywordflow">if</span>(maneuver.type != carma_planning_msgs::msg::Maneuver::LANE_CHANGE){</div>
<div class="line"><span class="lineno">  537</span>                <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;Create_lanechange called on a maneuver type which is not LANE_CHANGE&quot;</span>);</div>
<div class="line"><span class="lineno">  538</span>            }</div>
<div class="line"><span class="lineno">  539</span>            std::vector&lt;PointSpeedPair&gt; points_and_target_speeds;</div>
<div class="line"><span class="lineno">  540</span>            std::unordered_set&lt;lanelet::Id&gt; visited_lanelets;</div>
<div class="line"><span class="lineno">  541</span> </div>
<div class="line"><span class="lineno">  542</span>            carma_planning_msgs::msg::LaneChangeManeuver lane_change_maneuver = maneuver.lane_change_maneuver;</div>
<div class="line"><span class="lineno">  543</span>            <span class="keywordtype">double</span> ending_downtrack = lane_change_maneuver.end_dist;</div>
<div class="line"><span class="lineno">  544</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;Maneuver ending downtrack:&quot;</span>&lt;&lt;ending_downtrack);</div>
<div class="line"><span class="lineno">  545</span>            <span class="keywordflow">if</span>(starting_downtrack &gt;= ending_downtrack)</div>
<div class="line"><span class="lineno">  546</span>            {</div>
<div class="line"><span class="lineno">  547</span>                <span class="keywordflow">throw</span>(std::invalid_argument(<span class="stringliteral">&quot;Start distance is greater than or equal to ending distance&quot;</span>));</div>
<div class="line"><span class="lineno">  548</span>            }</div>
<div class="line"><span class="lineno">  549</span> </div>
<div class="line"><span class="lineno">  550</span>            <span class="comment">//get route between starting and ending downtracks - downtracks should be constant for complete length of maneuver</span></div>
<div class="line"><span class="lineno">  551</span>            std::vector&lt;lanelet::BasicPoint2d&gt; route_geometry = <a class="code hl_function" href="namespacebasic__autonomy_1_1waypoint__generation.html#a2219ab96db87781023137bdb45af1ea2">create_lanechange_geometry</a>(std::stoi(lane_change_maneuver.starting_lane_id),std::stoi(lane_change_maneuver.ending_lane_id),</div>
<div class="line"><span class="lineno">  552</span>                                                                                        starting_downtrack, ending_downtrack, wm, general_config.<a class="code hl_variable" href="structbasic__autonomy_1_1waypoint__generation_1_1GeneralTrajConfig.html#a0ad2d91d1f739942213d5bfe7f0e861f">default_downsample_ratio</a>, detailed_config.<a class="code hl_variable" href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html#ae2456fd9c7e752615b59ec444c8c28ee">buffer_ending_downtrack</a>);</div>
<div class="line"><span class="lineno">  553</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;Route geometry size:&quot;</span>&lt;&lt;route_geometry.size());</div>
<div class="line"><span class="lineno">  554</span> </div>
<div class="line"><span class="lineno">  555</span>            lanelet::BasicPoint2d state_pos(state.x_pos_global, state.y_pos_global);</div>
<div class="line"><span class="lineno">  556</span>            <span class="keywordtype">double</span> current_downtrack = wm-&gt;routeTrackPos(state_pos).downtrack;</div>
<div class="line"><span class="lineno">  557</span>            <span class="keywordtype">int</span> nearest_pt_index = <a class="code hl_function" href="namespacebasic__autonomy_1_1waypoint__generation.html#aa399a236f88f7b1c5557327fbb2ba71a">get_nearest_index_by_downtrack</a>(route_geometry, wm, current_downtrack);</div>
<div class="line"><span class="lineno">  558</span>            <span class="keywordtype">int</span> ending_pt_index = <a class="code hl_function" href="namespacebasic__autonomy_1_1waypoint__generation.html#aa399a236f88f7b1c5557327fbb2ba71a">get_nearest_index_by_downtrack</a>(route_geometry, wm, ending_downtrack);</div>
<div class="line"><span class="lineno">  559</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;Nearest pt index in maneuvers to points: &quot;</span>&lt;&lt; nearest_pt_index);</div>
<div class="line"><span class="lineno">  560</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;Ending pt index in maneuvers to points: &quot;</span>&lt;&lt; ending_pt_index);</div>
<div class="line"><span class="lineno">  561</span> </div>
<div class="line"><span class="lineno">  562</span>            ending_state_before_buffer.x_pos_global = route_geometry[ending_pt_index].x();</div>
<div class="line"><span class="lineno">  563</span>            ending_state_before_buffer.y_pos_global = route_geometry[ending_pt_index].y();</div>
<div class="line"><span class="lineno">  564</span> </div>
<div class="line"><span class="lineno">  565</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;ending_state_before_buffer_:&quot;</span>&lt;&lt;ending_state_before_buffer.x_pos_global &lt;&lt; </div>
<div class="line"><span class="lineno">  566</span>                    <span class="stringliteral">&quot;, ending_state_before_buffer_.y_pos_global&quot;</span> &lt;&lt; ending_state_before_buffer.y_pos_global);</div>
<div class="line"><span class="lineno">  567</span> </div>
<div class="line"><span class="lineno">  568</span>            </div>
<div class="line"><span class="lineno">  569</span>            <span class="keywordtype">double</span> route_length = wm-&gt;getRouteEndTrackPos().downtrack;</div>
<div class="line"><span class="lineno">  570</span> </div>
<div class="line"><span class="lineno">  571</span>            <span class="keywordflow">if</span> (ending_downtrack + detailed_config.<a class="code hl_variable" href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html#ae2456fd9c7e752615b59ec444c8c28ee">buffer_ending_downtrack</a> &lt; route_length)</div>
<div class="line"><span class="lineno">  572</span>            {</div>
<div class="line"><span class="lineno">  573</span>                ending_pt_index = <a class="code hl_function" href="namespacebasic__autonomy_1_1waypoint__generation.html#aa399a236f88f7b1c5557327fbb2ba71a">get_nearest_index_by_downtrack</a>(route_geometry, wm, ending_downtrack + detailed_config.<a class="code hl_variable" href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html#ae2456fd9c7e752615b59ec444c8c28ee">buffer_ending_downtrack</a>);</div>
<div class="line"><span class="lineno">  574</span>            }</div>
<div class="line"><span class="lineno">  575</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  576</span>            {</div>
<div class="line"><span class="lineno">  577</span>                ending_pt_index = route_geometry.size() - 1;</div>
<div class="line"><span class="lineno">  578</span>            }</div>
<div class="line"><span class="lineno">  579</span> </div>
<div class="line"><span class="lineno">  580</span>            lanelet::BasicLineString2d future_route_geometry(route_geometry.begin() + nearest_pt_index, route_geometry.begin() + ending_pt_index);</div>
<div class="line"><span class="lineno">  581</span>            <span class="keywordtype">bool</span> first = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  582</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;Future geom size:&quot;</span>&lt;&lt; future_route_geometry.size());</div>
<div class="line"><span class="lineno">  583</span> </div>
<div class="line"><span class="lineno">  584</span>            <span class="keywordflow">for</span> (<span class="keyword">auto</span> p : future_route_geometry)</div>
<div class="line"><span class="lineno">  585</span>            {</div>
<div class="line"><span class="lineno">  586</span>                <span class="keywordflow">if</span> (first &amp;&amp; !points_and_target_speeds.empty())</div>
<div class="line"><span class="lineno">  587</span>                {</div>
<div class="line"><span class="lineno">  588</span>                    first = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  589</span>                    <span class="keywordflow">continue</span>; <span class="comment">// Skip the first point if we have already added points from a previous maneuver to avoid duplicates</span></div>
<div class="line"><span class="lineno">  590</span>                }</div>
<div class="line"><span class="lineno">  591</span>                <a class="code hl_typedef" href="namespacecooperative__lanechange.html#af2521f0bb23baab64641072110316a67">PointSpeedPair</a> pair;</div>
<div class="line"><span class="lineno">  592</span>                pair.<a class="code hl_variable" href="structbasic__autonomy_1_1waypoint__generation_1_1PointSpeedPair.html#a628d9d3853745335b42ad940136d88ac">point</a> = p;</div>
<div class="line"><span class="lineno">  593</span>                <span class="comment">//If current speed is above min speed, keep at current speed. Otherwise use end speed from maneuver.</span></div>
<div class="line"><span class="lineno">  594</span>                pair.speed = (state.longitudinal_vel &gt; detailed_config.<a class="code hl_variable" href="structbasic__autonomy_1_1waypoint__generation_1_1DetailedTrajConfig.html#a4bf547260f4eb35b2df2a8ddb5b216c8">minimum_speed</a>) ? state.longitudinal_vel : lane_change_maneuver.end_speed;</div>
<div class="line"><span class="lineno">  595</span>                points_and_target_speeds.push_back(pair);</div>
<div class="line"><span class="lineno">  596</span>                </div>
<div class="line"><span class="lineno">  597</span>            }</div>
<div class="line"><span class="lineno">  598</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;Const speed assigned:&quot;</span>&lt;&lt;points_and_target_speeds.back().speed);</div>
<div class="line"><span class="lineno">  599</span>            <span class="keywordflow">return</span> points_and_target_speeds;</div>
<div class="line"><span class="lineno">  600</span>            </div>
<div class="line"><span class="lineno">  601</span> </div>
<div class="line"><span class="lineno">  602</span>        } </div>
<div class="ttc" id="anamespacebasic__autonomy_1_1waypoint__generation_html_a2219ab96db87781023137bdb45af1ea2"><div class="ttname"><a href="namespacebasic__autonomy_1_1waypoint__generation.html#a2219ab96db87781023137bdb45af1ea2">basic_autonomy::waypoint_generation::create_lanechange_geometry</a></div><div class="ttdeci">std::vector&lt; lanelet::BasicPoint2d &gt; create_lanechange_geometry(lanelet::Id starting_lane_id, lanelet::Id ending_lane_id, double starting_downtrack, double ending_downtrack, const carma_wm::WorldModelConstPtr &amp;wm, int downsample_ratio, double buffer_ending_downtrack)</div><div class="ttdoc">Creates a vector of lane change points using parameters defined.</div><div class="ttdef"><b>Definition:</b> <a href="basic__autonomy_8cpp_source.html#l00307">basic_autonomy.cpp:307</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="basic__autonomy_8hpp_source.html#l00062">BASIC_AUTONOMY_LOGGER</a>, <a class="el" href="basic__autonomy_8hpp_source.html#l00089">basic_autonomy::waypoint_generation::DetailedTrajConfig::buffer_ending_downtrack</a>, <a class="el" href="basic__autonomy_8cpp_source.html#l00307">create_lanechange_geometry()</a>, <a class="el" href="basic__autonomy_8hpp_source.html#l00073">basic_autonomy::waypoint_generation::GeneralTrajConfig::default_downsample_ratio</a>, <a class="el" href="helper__functions_8cpp_source.html#l00065">get_nearest_index_by_downtrack()</a>, <a class="el" href="basic__autonomy_8hpp_source.html#l00082">basic_autonomy::waypoint_generation::DetailedTrajConfig::minimum_speed</a>, <a class="el" href="basic__autonomy_8hpp_source.html#l00066">basic_autonomy::waypoint_generation::PointSpeedPair::point</a>, and <a class="el" href="basic__autonomy_8hpp_source.html#l00067">basic_autonomy::waypoint_generation::PointSpeedPair::speed</a>.</p>

<p class="reference">Referenced by <a class="el" href="basic__autonomy_8cpp_source.html#l00024">create_geometry_profile()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebasic__autonomy_1_1waypoint__generation_af992a6cbbdafd6e86d73976a65164e94_cgraph.png" border="0" usemap="#anamespacebasic__autonomy_1_1waypoint__generation_af992a6cbbdafd6e86d73976a65164e94_cgraph" alt=""/></div>
<map name="anamespacebasic__autonomy_1_1waypoint__generation_af992a6cbbdafd6e86d73976a65164e94_cgraph" id="anamespacebasic__autonomy_1_1waypoint__generation_af992a6cbbdafd6e86d73976a65164e94_cgraph">
<area shape="rect" title="Converts a set of requested LANE_CHANGE maneuvers to point speed limit pairs." alt="" coords="5,47,192,103"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#a2219ab96db87781023137bdb45af1ea2" title="Creates a vector of lane change points using parameters defined." alt="" coords="240,79,444,135"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#aa399a236f88f7b1c5557327fbb2ba71a" title="Returns the nearest &quot;less than&quot; point to the provided vehicle pose in the provided list by utilizing ..." alt="" coords="509,5,682,61"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#a924ac023f1b51e791ca1b61b9194f44a" title="Returns the nearest point (in terms of cartesian 2d distance) to the provided vehicle pose in the pro..." alt="" coords="509,85,682,141"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#a19cf5cf882789e1e9ed3e92d0105a8de" title="Resamples a pair of basicpoint2d lines to get lines of same number of points." alt="" coords="492,165,699,221"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#adf1c6b7f1e33569b45074e4e5bbeff1d" title="Compute the arc length at each point around the curve." alt="" coords="757,139,909,181"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#a9e0eab343d21d18c665083839d706f04" title="Computes a spline based on the provided points." alt="" coords="747,205,920,246"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#a4e12c2971926486d1447e44e978f8d4d" title=" " alt="" coords="968,132,1113,188"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#a9bc48b810ba18270fcc21674b55922f0" title="Compute the Euclidean distance between the two points." alt="" coords="1161,132,1307,188"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebasic__autonomy_1_1waypoint__generation_af992a6cbbdafd6e86d73976a65164e94_icgraph.png" border="0" usemap="#anamespacebasic__autonomy_1_1waypoint__generation_af992a6cbbdafd6e86d73976a65164e94_icgraph" alt=""/></div>
<map name="anamespacebasic__autonomy_1_1waypoint__generation_af992a6cbbdafd6e86d73976a65164e94_icgraph" id="anamespacebasic__autonomy_1_1waypoint__generation_af992a6cbbdafd6e86d73976a65164e94_icgraph">
<area shape="rect" title="Converts a set of requested LANE_CHANGE maneuvers to point speed limit pairs." alt="" coords="753,85,940,141"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#acdcd3bb44d31aa6405b30f151ea35ae4" title="Creates geometry profile to return a point speed pair struct for LANE FOLLOW and LANE CHANGE maneuver..." alt="" coords="515,85,705,141"/>
<area shape="rect" href="classcooperative__lanechange_1_1CooperativeLaneChangePlugin.html#a5f0c14a409d58d6b1750c38c6bf1b34a" title="Creates a vector of Trajectory Points from maneuver information in trajectory request." alt="" coords="260,5,467,61"/>
<area shape="rect" href="classinlanecruising__plugin_1_1InLaneCruisingPlugin.html#a60f695c3ed54c99c6a2dcfaf77ae55e2" title="Service callback for trajectory planning." alt="" coords="280,85,447,141"/>
<area shape="rect" href="classplatooning__tactical__plugin_1_1PlatooningTacticalPlugin.html#aee3afe082ccd5ab937dbb1c49f9e21ff" title="Service callback for trajectory planning." alt="" coords="275,165,451,221"/>
<area shape="rect" href="classcooperative__lanechange_1_1CooperativeLaneChangePlugin.html#a8913539d8614e509910af225e18bc809" title="Extending class provided callback which should return a planned trajectory based on the provided traj..." alt="" coords="5,5,212,61"/>
</map>
</div>

</div>
</div>
<a id="a663da94d69d090be22675c21ec95fc6d" name="a663da94d69d090be22675c21ec95fc6d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a663da94d69d090be22675c21ec95fc6d">&#9670;&nbsp;</a></span>get_nearest_index_by_downtrack() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classint.html">int</a> basic_autonomy::waypoint_generation::get_nearest_index_by_downtrack </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; lanelet::BasicPoint2d &gt; &amp;&#160;</td>
          <td class="paramname"><em>points</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacecarma__wm.html#a3ac653959e0b6198cae274d68b343228">carma_wm::WorldModelConstPtr</a> &amp;&#160;</td>
          <td class="paramname"><em>wm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const carma_planning_msgs::msg::VehicleState &amp;&#160;</td>
          <td class="paramname"><em>state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Overload: Returns the nearest point to the provided vehicle pose in the provided list by utilizing the downtrack measured along the route NOTE: This function compares the downtrack, provided by routeTrackPos, of each points in the list to get the closest one to the given point's downtrack. Therefore, it is rather costlier method than comparing cartesian distance between the points and getting the closest. This way, however, the function correctly returns the end point if the given state, despite being valid, is farther than the given points and can technically be near any of them. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">points</td><td>The points to evaluate </td></tr>
    <tr><td class="paramname">state</td><td>The current vehicle state </td></tr>
    <tr><td class="paramname">wm</td><td>The carma world model</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>index of nearest point in points </dd></dl>

<p class="definition">Definition at line <a class="el" href="helper__functions_8cpp_source.html#l00108">108</a> of file <a class="el" href="helper__functions_8cpp_source.html">helper_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  110</span>    {</div>
<div class="line"><span class="lineno">  111</span>        lanelet::BasicPoint2d state_pos(state.x_pos_global, state.y_pos_global);</div>
<div class="line"><span class="lineno">  112</span>        <span class="keywordtype">double</span> ending_downtrack = wm-&gt;routeTrackPos(state_pos).downtrack;</div>
<div class="line"><span class="lineno">  113</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="namespacebasic__autonomy_1_1waypoint__generation.html#aa399a236f88f7b1c5557327fbb2ba71a">get_nearest_index_by_downtrack</a>(points, wm, ending_downtrack);</div>
<div class="line"><span class="lineno">  114</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="helper__functions_8cpp_source.html#l00065">get_nearest_index_by_downtrack()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebasic__autonomy_1_1waypoint__generation_a663da94d69d090be22675c21ec95fc6d_cgraph.png" border="0" usemap="#anamespacebasic__autonomy_1_1waypoint__generation_a663da94d69d090be22675c21ec95fc6d_cgraph" alt=""/></div>
<map name="anamespacebasic__autonomy_1_1waypoint__generation_a663da94d69d090be22675c21ec95fc6d_cgraph" id="anamespacebasic__autonomy_1_1waypoint__generation_a663da94d69d090be22675c21ec95fc6d_cgraph">
<area shape="rect" title="Overload: Returns the nearest point to the provided vehicle pose in the provided list by utilizing th..." alt="" coords="5,5,179,61"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#aa399a236f88f7b1c5557327fbb2ba71a" title="Returns the nearest &quot;less than&quot; point to the provided vehicle pose in the provided list by utilizing ..." alt="" coords="227,5,400,61"/>
</map>
</div>

</div>
</div>
<a id="aa399a236f88f7b1c5557327fbb2ba71a" name="aa399a236f88f7b1c5557327fbb2ba71a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa399a236f88f7b1c5557327fbb2ba71a">&#9670;&nbsp;</a></span>get_nearest_index_by_downtrack() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classint.html">int</a> basic_autonomy::waypoint_generation::get_nearest_index_by_downtrack </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; lanelet::BasicPoint2d &gt; &amp;&#160;</td>
          <td class="paramname"><em>points</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacecarma__wm.html#a3ac653959e0b6198cae274d68b343228">carma_wm::WorldModelConstPtr</a> &amp;&#160;</td>
          <td class="paramname"><em>wm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>target_downtrack</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the nearest "less than" point to the provided vehicle pose in the provided list by utilizing the downtrack measured along the route NOTE: This function compares the downtrack, provided by routeTrackPos, of each points in the list to get the closest one to the given point's downtrack. Therefore, it is rather costlier method than comparing cartesian distance between the points and getting the closest. This way, however, the function correctly returns the end point's index if the given state, despite being valid, is farther than the given points and can technically be near any of them. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">points</td><td>BasicLineString2d points </td></tr>
    <tr><td class="paramname">target_downtrack</td><td>target downtrack along the route to get index near to</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>index of nearest point in points </dd></dl>

<p class="definition">Definition at line <a class="el" href="helper__functions_8cpp_source.html#l00065">65</a> of file <a class="el" href="helper__functions_8cpp_source.html">helper_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   66</span>    {</div>
<div class="line"><span class="lineno">   67</span>        <span class="keywordtype">size_t</span> best_index = points.size() - 1;</div>
<div class="line"><span class="lineno">   68</span>        <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> = 0;<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> &lt; points.size(); <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>++){</div>
<div class="line"><span class="lineno">   69</span>            <span class="keywordtype">double</span> downtrack = wm-&gt;routeTrackPos(points[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>]).downtrack;</div>
<div class="line"><span class="lineno">   70</span>            <span class="keywordflow">if</span>(downtrack &gt; target_downtrack){</div>
<div class="line"><span class="lineno">   71</span>                <span class="comment">//If value is negative, best index should be index 0</span></div>
<div class="line"><span class="lineno">   72</span>                best_index = std::max((<span class="keywordtype">size_t</span>)0, <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> - 1);</div>
<div class="line"><span class="lineno">   73</span> </div>
<div class="line"><span class="lineno">   74</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;get_nearest_index_by_downtrack&gt;&gt; Found best_idx: &quot;</span> &lt;&lt; best_index&lt;&lt;<span class="stringliteral">&quot;, points[i].x(): &quot;</span> &lt;&lt; points[best_index].<a class="code hl_variable" href="namespaceprocess__traj__logs.html#af3ba6144a2d35a4990f1a8d04632a052">x</a>() &lt;&lt; <span class="stringliteral">&quot;, points[i].y(): &quot;</span> &lt;&lt; points[best_index].<a class="code hl_variable" href="namespaceprocess__traj__logs.html#a05bdb238bfbf3836fb0aa69c5aa1bb48">y</a>() &lt;&lt; <span class="stringliteral">&quot;, downtrack: &quot;</span>&lt;&lt; downtrack);</div>
<div class="line"><span class="lineno">   75</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">   76</span>            }</div>
<div class="line"><span class="lineno">   77</span>        }</div>
<div class="line"><span class="lineno">   78</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;get_nearest_index_by_downtrack&gt;&gt; Found best_idx: &quot;</span> &lt;&lt; best_index&lt;&lt;<span class="stringliteral">&quot;, points[i].x(): &quot;</span> &lt;&lt; points[best_index].<a class="code hl_variable" href="namespaceprocess__traj__logs.html#af3ba6144a2d35a4990f1a8d04632a052">x</a>() &lt;&lt; <span class="stringliteral">&quot;, points[i].y(): &quot;</span> &lt;&lt; points[best_index].<a class="code hl_variable" href="namespaceprocess__traj__logs.html#a05bdb238bfbf3836fb0aa69c5aa1bb48">y</a>());</div>
<div class="line"><span class="lineno">   79</span> </div>
<div class="line"><span class="lineno">   80</span>        <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(best_index);</div>
<div class="line"><span class="lineno">   81</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="basic__autonomy_8hpp_source.html#l00062">BASIC_AUTONOMY_LOGGER</a>, <a class="el" href="process__bag_8py_source.html#l00059">process_bag::i</a>, <a class="el" href="process__traj__logs_8py_source.html#l00128">process_traj_logs::x</a>, and <a class="el" href="process__traj__logs_8py_source.html#l00129">process_traj_logs::y</a>.</p>

<p class="reference">Referenced by <a class="el" href="basic__autonomy_8cpp_source.html#l01112">compose_lanechange_trajectory_from_path()</a>, <a class="el" href="basic__autonomy_8cpp_source.html#l00853">compose_lanefollow_trajectory_from_path()</a>, <a class="el" href="stop__controlled__intersection__tactical__plugin_8cpp_source.html#l00477">stop_controlled_intersection_tactical_plugin::StopControlledIntersectionTacticalPlugin::compose_trajectory_from_centerline()</a>, <a class="el" href="basic__autonomy_8cpp_source.html#l00307">create_lanechange_geometry()</a>, <a class="el" href="basic__autonomy_8cpp_source.html#l00532">get_lanechange_points_from_maneuver()</a>, and <a class="el" href="helper__functions_8cpp_source.html#l00097">get_nearest_index_by_downtrack()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebasic__autonomy_1_1waypoint__generation_aa399a236f88f7b1c5557327fbb2ba71a_icgraph.png" border="0" usemap="#anamespacebasic__autonomy_1_1waypoint__generation_aa399a236f88f7b1c5557327fbb2ba71a_icgraph" alt=""/></div>
<map name="anamespacebasic__autonomy_1_1waypoint__generation_aa399a236f88f7b1c5557327fbb2ba71a_icgraph" id="anamespacebasic__autonomy_1_1waypoint__generation_aa399a236f88f7b1c5557327fbb2ba71a_icgraph">
<area shape="rect" title="Returns the nearest &quot;less than&quot; point to the provided vehicle pose in the provided list by utilizing ..." alt="" coords="1395,153,1568,209"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#a741942c16ca54212b9adf3ddc2eea66d" title="Method converts a list of lanelet centerline points and current vehicle state into a usable list of t..." alt="" coords="847,5,1068,61"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#ad633c0c515eae2b1752ad96031e01ef8" title="Method converts a list of lanelet centerline points and current vehicle state into a usable list of t..." alt="" coords="585,175,799,231"/>
<area shape="rect" href="classstop__controlled__intersection__tactical__plugin_1_1StopControlledIntersectionTacticalPlugin.html#ae4ee772170429ec26c32ceec68f3c22f" title="Method converts a list of lanelet centerline points and current vehicle state into a usable list of t..." alt="" coords="1116,251,1347,322"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#a2219ab96db87781023137bdb45af1ea2" title="Creates a vector of lane change points using parameters defined." alt="" coords="1129,120,1333,176"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#af992a6cbbdafd6e86d73976a65164e94" title="Converts a set of requested LANE_CHANGE maneuvers to point speed limit pairs." alt="" coords="864,93,1051,149"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#a51d5d768864d9632b6c59acddbb804a6" title="Overload: Returns the nearest point to the provided vehicle pose in the provided list by utilizing th..." alt="" coords="1145,347,1318,403"/>
<area shape="rect" href="classcooperative__lanechange_1_1CooperativeLaneChangePlugin.html#a5f0c14a409d58d6b1750c38c6bf1b34a" title="Creates a vector of Trajectory Points from maneuver information in trajectory request." alt="" coords="295,8,502,64"/>
<area shape="rect" href="classcooperative__lanechange_1_1CooperativeLaneChangePlugin.html#a8913539d8614e509910af225e18bc809" title="Extending class provided callback which should return a planned trajectory based on the provided traj..." alt="" coords="5,8,212,64"/>
<area shape="rect" href="classinlanecruising__plugin_1_1InLaneCruisingPlugin.html#a60f695c3ed54c99c6a2dcfaf77ae55e2" title="Service callback for trajectory planning." alt="" coords="315,93,482,149"/>
<area shape="rect" href="classplatooning__tactical__plugin_1_1PlatooningTacticalPlugin.html#aee3afe082ccd5ab937dbb1c49f9e21ff" title="Service callback for trajectory planning." alt="" coords="311,173,487,229"/>
<area shape="rect" href="classlight__controlled__intersection__tactical__plugin_1_1LightControlledIntersectionTacticalPlugin.html#a124f95825dfb2728fefa245e6a0e1db7" title="Function to process the light controlled intersection tactical plugin service call for trajectory pla..." alt="" coords="260,253,537,309"/>
<area shape="rect" href="classstop__controlled__intersection__tactical__plugin_1_1StopControlledIntersectionTacticalPlugin.html#ab0bf4a699bff521ffe56736d78880926" title="Extending class provided callback which should return a planned trajectory based on the provided traj..." alt="" coords="856,251,1059,322"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#acdcd3bb44d31aa6405b30f151ea35ae4" title="Creates geometry profile to return a point speed pair struct for LANE FOLLOW and LANE CHANGE maneuver..." alt="" coords="597,93,787,149"/>
</map>
</div>

</div>
</div>
<a id="a51d5d768864d9632b6c59acddbb804a6" name="a51d5d768864d9632b6c59acddbb804a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51d5d768864d9632b6c59acddbb804a6">&#9670;&nbsp;</a></span>get_nearest_index_by_downtrack() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classint.html">int</a> basic_autonomy::waypoint_generation::get_nearest_index_by_downtrack </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1PointSpeedPair.html">PointSpeedPair</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>points</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacecarma__wm.html#a3ac653959e0b6198cae274d68b343228">carma_wm::WorldModelConstPtr</a> &amp;&#160;</td>
          <td class="paramname"><em>wm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const carma_planning_msgs::msg::VehicleState &amp;&#160;</td>
          <td class="paramname"><em>state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Overload: Returns the nearest point to the provided vehicle pose in the provided list by utilizing the downtrack measured along the route NOTE: This function compares the downtrack, provided by routeTrackPos, of each points in the list to get the closest one to the given point's downtrack. Therefore, it is rather costlier method than comparing cartesian distance between the points and getting the closest. This way, however, the function correctly returns the end point's index if the given state, despite being valid, is farther than the given points and can technically be near any of them. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">points</td><td>The points and speed pairs to evaluate </td></tr>
    <tr><td class="paramname">state</td><td>The current vehicle state </td></tr>
    <tr><td class="paramname">wm</td><td>The carma world model</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>index of nearest point in points </dd></dl>

<p class="definition">Definition at line <a class="el" href="helper__functions_8cpp_source.html#l00097">97</a> of file <a class="el" href="helper__functions_8cpp_source.html">helper_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   99</span>    {</div>
<div class="line"><span class="lineno">  100</span>        lanelet::BasicPoint2d state_pos(state.x_pos_global, state.y_pos_global);</div>
<div class="line"><span class="lineno">  101</span>        <span class="keywordtype">double</span> ending_downtrack = wm-&gt;routeTrackPos(state_pos).downtrack;</div>
<div class="line"><span class="lineno">  102</span>        std::vector&lt;lanelet::BasicPoint2d&gt; basic_points;</div>
<div class="line"><span class="lineno">  103</span>        std::vector&lt;double&gt; speeds;</div>
<div class="line"><span class="lineno">  104</span>        <a class="code hl_function" href="namespacebasic__autonomy_1_1waypoint__generation.html#a0f07faaac8c54cc485f2bb217097326e">split_point_speed_pairs</a>(points, &amp;basic_points, &amp;speeds);</div>
<div class="line"><span class="lineno">  105</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="namespacebasic__autonomy_1_1waypoint__generation.html#aa399a236f88f7b1c5557327fbb2ba71a">get_nearest_index_by_downtrack</a>(basic_points, wm, ending_downtrack);</div>
<div class="line"><span class="lineno">  106</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="helper__functions_8cpp_source.html#l00065">get_nearest_index_by_downtrack()</a>, and <a class="el" href="helper__functions_8cpp_source.html#l00083">split_point_speed_pairs()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebasic__autonomy_1_1waypoint__generation_a51d5d768864d9632b6c59acddbb804a6_cgraph.png" border="0" usemap="#anamespacebasic__autonomy_1_1waypoint__generation_a51d5d768864d9632b6c59acddbb804a6_cgraph" alt=""/></div>
<map name="anamespacebasic__autonomy_1_1waypoint__generation_a51d5d768864d9632b6c59acddbb804a6_cgraph" id="anamespacebasic__autonomy_1_1waypoint__generation_a51d5d768864d9632b6c59acddbb804a6_cgraph">
<area shape="rect" title="Overload: Returns the nearest point to the provided vehicle pose in the provided list by utilizing th..." alt="" coords="5,45,179,101"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#aa399a236f88f7b1c5557327fbb2ba71a" title="Returns the nearest &quot;less than&quot; point to the provided vehicle pose in the provided list by utilizing ..." alt="" coords="227,5,400,61"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#a0f07faaac8c54cc485f2bb217097326e" title="Helper method to split a list of PointSpeedPair into separate point and speed lists." alt="" coords="227,85,400,141"/>
</map>
</div>

</div>
</div>
<a id="a924ac023f1b51e791ca1b61b9194f44a" name="a924ac023f1b51e791ca1b61b9194f44a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a924ac023f1b51e791ca1b61b9194f44a">&#9670;&nbsp;</a></span>get_nearest_point_index() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classint.html">int</a> basic_autonomy::waypoint_generation::get_nearest_point_index </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; lanelet::BasicPoint2d &gt; &amp;&#160;</td>
          <td class="paramname"><em>points</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const carma_planning_msgs::msg::VehicleState &amp;&#160;</td>
          <td class="paramname"><em>state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the nearest point (in terms of cartesian 2d distance) to the provided vehicle pose in the provided l. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">points</td><td>The points to evaluate </td></tr>
    <tr><td class="paramname">state</td><td>The current vehicle state</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>index of nearest point in points </dd></dl>

<p class="definition">Definition at line <a class="el" href="helper__functions_8cpp_source.html#l00024">24</a> of file <a class="el" href="helper__functions_8cpp_source.html">helper_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   26</span>    {</div>
<div class="line"><span class="lineno">   27</span>        lanelet::BasicPoint2d veh_point(state.x_pos_global, state.y_pos_global);</div>
<div class="line"><span class="lineno">   28</span>        <span class="keywordtype">double</span> min_distance = std::numeric_limits&lt;double&gt;::max();</div>
<div class="line"><span class="lineno">   29</span>        <span class="keywordtype">int</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> = 0;</div>
<div class="line"><span class="lineno">   30</span>        <span class="keywordtype">int</span> best_index = 0;</div>
<div class="line"><span class="lineno">   31</span>        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; p : points)</div>
<div class="line"><span class="lineno">   32</span>        {</div>
<div class="line"><span class="lineno">   33</span>            <span class="keywordtype">double</span> distance = lanelet::geometry::distance2d(p, veh_point);</div>
<div class="line"><span class="lineno">   34</span>            <span class="keywordflow">if</span> (distance &lt; min_distance)</div>
<div class="line"><span class="lineno">   35</span>            {</div>
<div class="line"><span class="lineno">   36</span>                best_index = <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>;</div>
<div class="line"><span class="lineno">   37</span>                min_distance = distance;</div>
<div class="line"><span class="lineno">   38</span>            }</div>
<div class="line"><span class="lineno">   39</span>            <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>++;</div>
<div class="line"><span class="lineno">   40</span>        }</div>
<div class="line"><span class="lineno">   41</span>        <span class="keywordflow">return</span> best_index;</div>
<div class="line"><span class="lineno">   42</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="process__bag_8py_source.html#l00059">process_bag::i</a>.</p>

<p class="reference">Referenced by <a class="el" href="basic__autonomy_8cpp_source.html#l00853">compose_lanefollow_trajectory_from_path()</a>, <a class="el" href="stop__controlled__intersection__tactical__plugin_8cpp_source.html#l00477">stop_controlled_intersection_tactical_plugin::StopControlledIntersectionTacticalPlugin::compose_trajectory_from_centerline()</a>, and <a class="el" href="basic__autonomy_8cpp_source.html#l00307">create_lanechange_geometry()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebasic__autonomy_1_1waypoint__generation_a924ac023f1b51e791ca1b61b9194f44a_icgraph.png" border="0" usemap="#anamespacebasic__autonomy_1_1waypoint__generation_a924ac023f1b51e791ca1b61b9194f44a_icgraph" alt=""/></div>
<map name="anamespacebasic__autonomy_1_1waypoint__generation_a924ac023f1b51e791ca1b61b9194f44a_icgraph" id="anamespacebasic__autonomy_1_1waypoint__generation_a924ac023f1b51e791ca1b61b9194f44a_icgraph">
<area shape="rect" title="Returns the nearest point (in terms of cartesian 2d distance) to the provided vehicle pose in the pro..." alt="" coords="1376,161,1549,217"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#ad633c0c515eae2b1752ad96031e01ef8" title="Method converts a list of lanelet centerline points and current vehicle state into a usable list of t..." alt="" coords="585,85,799,141"/>
<area shape="rect" href="classstop__controlled__intersection__tactical__plugin_1_1StopControlledIntersectionTacticalPlugin.html#ae4ee772170429ec26c32ceec68f3c22f" title="Method converts a list of lanelet centerline points and current vehicle state into a usable list of t..." alt="" coords="1097,242,1328,313"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#a2219ab96db87781023137bdb45af1ea2" title="Creates a vector of lane change points using parameters defined." alt="" coords="1111,161,1315,217"/>
<area shape="rect" href="classinlanecruising__plugin_1_1InLaneCruisingPlugin.html#a60f695c3ed54c99c6a2dcfaf77ae55e2" title="Service callback for trajectory planning." alt="" coords="315,85,482,141"/>
<area shape="rect" href="classplatooning__tactical__plugin_1_1PlatooningTacticalPlugin.html#aee3afe082ccd5ab937dbb1c49f9e21ff" title="Service callback for trajectory planning." alt="" coords="311,165,487,221"/>
<area shape="rect" href="classlight__controlled__intersection__tactical__plugin_1_1LightControlledIntersectionTacticalPlugin.html#a124f95825dfb2728fefa245e6a0e1db7" title="Function to process the light controlled intersection tactical plugin service call for trajectory pla..." alt="" coords="260,5,537,61"/>
<area shape="rect" href="classstop__controlled__intersection__tactical__plugin_1_1StopControlledIntersectionTacticalPlugin.html#ab0bf4a699bff521ffe56736d78880926" title="Extending class provided callback which should return a planned trajectory based on the provided traj..." alt="" coords="847,242,1049,313"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#af992a6cbbdafd6e86d73976a65164e94" title="Converts a set of requested LANE_CHANGE maneuvers to point speed limit pairs." alt="" coords="855,161,1041,217"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#acdcd3bb44d31aa6405b30f151ea35ae4" title="Creates geometry profile to return a point speed pair struct for LANE FOLLOW and LANE CHANGE maneuver..." alt="" coords="597,165,787,221"/>
<area shape="rect" href="classcooperative__lanechange_1_1CooperativeLaneChangePlugin.html#a5f0c14a409d58d6b1750c38c6bf1b34a" title="Creates a vector of Trajectory Points from maneuver information in trajectory request." alt="" coords="295,245,502,301"/>
<area shape="rect" href="classcooperative__lanechange_1_1CooperativeLaneChangePlugin.html#a8913539d8614e509910af225e18bc809" title="Extending class provided callback which should return a planned trajectory based on the provided traj..." alt="" coords="5,245,212,301"/>
</map>
</div>

</div>
</div>
<a id="a9ef24fc9ed2fb1aeccb039313bdf858c" name="a9ef24fc9ed2fb1aeccb039313bdf858c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ef24fc9ed2fb1aeccb039313bdf858c">&#9670;&nbsp;</a></span>get_nearest_point_index() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classint.html">int</a> basic_autonomy::waypoint_generation::get_nearest_point_index </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1PointSpeedPair.html">PointSpeedPair</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>points</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const carma_planning_msgs::msg::VehicleState &amp;&#160;</td>
          <td class="paramname"><em>state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the nearest point (in terms of cartesian 2d distance) to the provided vehicle pose in the provided list. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">points</td><td>The points to evaluate </td></tr>
    <tr><td class="paramname">state</td><td>The current vehicle state</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>index of nearest point in points </dd></dl>

<p class="definition">Definition at line <a class="el" href="helper__functions_8cpp_source.html#l00044">44</a> of file <a class="el" href="helper__functions_8cpp_source.html">helper_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   46</span>    {</div>
<div class="line"><span class="lineno">   47</span>        lanelet::BasicPoint2d veh_point(state.x_pos_global, state.y_pos_global);</div>
<div class="line"><span class="lineno">   48</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;veh_point: &quot;</span> &lt;&lt; veh_point.x() &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; veh_point.y());</div>
<div class="line"><span class="lineno">   49</span>        <span class="keywordtype">double</span> min_distance = std::numeric_limits&lt;double&gt;::max();</div>
<div class="line"><span class="lineno">   50</span>        <span class="keywordtype">int</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> = 0;</div>
<div class="line"><span class="lineno">   51</span>        <span class="keywordtype">int</span> best_index = 0;</div>
<div class="line"><span class="lineno">   52</span>        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; p : points)</div>
<div class="line"><span class="lineno">   53</span>        {</div>
<div class="line"><span class="lineno">   54</span>            <span class="keywordtype">double</span> distance = lanelet::geometry::distance2d(p.point, veh_point);</div>
<div class="line"><span class="lineno">   55</span>            <span class="keywordflow">if</span> (distance &lt; min_distance)</div>
<div class="line"><span class="lineno">   56</span>            {</div>
<div class="line"><span class="lineno">   57</span>            best_index = <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>;</div>
<div class="line"><span class="lineno">   58</span>            min_distance = distance;</div>
<div class="line"><span class="lineno">   59</span>            }</div>
<div class="line"><span class="lineno">   60</span>            <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>++;</div>
<div class="line"><span class="lineno">   61</span>        }</div>
<div class="line"><span class="lineno">   62</span>        <span class="keywordflow">return</span> best_index;</div>
<div class="line"><span class="lineno">   63</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="basic__autonomy_8hpp_source.html#l00062">BASIC_AUTONOMY_LOGGER</a>, and <a class="el" href="process__bag_8py_source.html#l00059">process_bag::i</a>.</p>

</div>
</div>
<a id="a9dd6a1f0fa9c6f6590b83a7cc2e0d118" name="a9dd6a1f0fa9c6f6590b83a7cc2e0d118"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9dd6a1f0fa9c6f6590b83a7cc2e0d118">&#9670;&nbsp;</a></span>min_with_exclusions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::pair&lt; double, size_t &gt; basic_autonomy::waypoint_generation::min_with_exclusions </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>values</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::unordered_set&lt; size_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>excluded</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the min, and its idx, from the vector of values, excluding given set of values. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">values</td><td>vector of values </td></tr>
    <tr><td class="paramname">excluded</td><td>set of excluded values</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>minimum value and its idx </dd></dl>

<p class="definition">Definition at line <a class="el" href="basic__autonomy_8cpp_source.html#l00667">667</a> of file <a class="el" href="basic__autonomy_8cpp_source.html">basic_autonomy.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  668</span>        {</div>
<div class="line"><span class="lineno">  669</span>            <span class="keywordtype">double</span> min = std::numeric_limits&lt;double&gt;::max();</div>
<div class="line"><span class="lineno">  670</span>            <span class="keywordtype">size_t</span> best_idx = -1;</div>
<div class="line"><span class="lineno">  671</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> = 0; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> &lt; values.size(); <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>++)</div>
<div class="line"><span class="lineno">  672</span>            {</div>
<div class="line"><span class="lineno">  673</span>                <span class="keywordflow">if</span> (excluded.find(<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>) != excluded.end())</div>
<div class="line"><span class="lineno">  674</span>                {</div>
<div class="line"><span class="lineno">  675</span>                    <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  676</span>                }</div>
<div class="line"><span class="lineno">  677</span> </div>
<div class="line"><span class="lineno">  678</span>                <span class="keywordflow">if</span> (values[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>] &lt; min)</div>
<div class="line"><span class="lineno">  679</span>                {</div>
<div class="line"><span class="lineno">  680</span>                    min = values[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>];</div>
<div class="line"><span class="lineno">  681</span>                    best_idx = <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>;</div>
<div class="line"><span class="lineno">  682</span>                }</div>
<div class="line"><span class="lineno">  683</span>            }</div>
<div class="line"><span class="lineno">  684</span>            <span class="keywordflow">return</span> std::make_pair(min, best_idx);</div>
<div class="line"><span class="lineno">  685</span>        }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="process__bag_8py_source.html#l00059">process_bag::i</a>.</p>

<p class="reference">Referenced by <a class="el" href="basic__autonomy_8cpp_source.html#l00687">optimize_speed()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebasic__autonomy_1_1waypoint__generation_a9dd6a1f0fa9c6f6590b83a7cc2e0d118_icgraph.png" border="0" usemap="#anamespacebasic__autonomy_1_1waypoint__generation_a9dd6a1f0fa9c6f6590b83a7cc2e0d118_icgraph" alt=""/></div>
<map name="anamespacebasic__autonomy_1_1waypoint__generation_a9dd6a1f0fa9c6f6590b83a7cc2e0d118_icgraph" id="anamespacebasic__autonomy_1_1waypoint__generation_a9dd6a1f0fa9c6f6590b83a7cc2e0d118_icgraph">
<area shape="rect" title="Returns the min, and its idx, from the vector of values, excluding given set of values." alt="" coords="825,93,1040,134"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#a84a6c11da2d9736a8f277b6afd124100" title="Applies the longitudinal acceleration limit to each point&#39;s speed." alt="" coords="592,93,777,134"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#ad633c0c515eae2b1752ad96031e01ef8" title="Method converts a list of lanelet centerline points and current vehicle state into a usable list of t..." alt="" coords="331,85,544,141"/>
<area shape="rect" href="classinlanecruising__plugin_1_1InLaneCruisingPlugin.html#a60f695c3ed54c99c6a2dcfaf77ae55e2" title="Service callback for trajectory planning." alt="" coords="61,5,227,61"/>
<area shape="rect" href="classplatooning__tactical__plugin_1_1PlatooningTacticalPlugin.html#aee3afe082ccd5ab937dbb1c49f9e21ff" title="Service callback for trajectory planning." alt="" coords="56,85,232,141"/>
<area shape="rect" href="classlight__controlled__intersection__tactical__plugin_1_1LightControlledIntersectionTacticalPlugin.html#a124f95825dfb2728fefa245e6a0e1db7" title="Function to process the light controlled intersection tactical plugin service call for trajectory pla..." alt="" coords="5,165,283,221"/>
</map>
</div>

</div>
</div>
<a id="a84a6c11da2d9736a8f277b6afd124100" name="a84a6c11da2d9736a8f277b6afd124100"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84a6c11da2d9736a8f277b6afd124100">&#9670;&nbsp;</a></span>optimize_speed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; double &gt; basic_autonomy::waypoint_generation::optimize_speed </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>downtracks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>curv_speeds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>accel_limit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Applies the longitudinal acceleration limit to each point's speed. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">downtracks</td><td>downtrack distances corresponding to each speed </td></tr>
    <tr><td class="paramname">curv_speeds</td><td>vehicle velocity in m/s. </td></tr>
    <tr><td class="paramname">accel_limit</td><td>vehicle longitudinal acceleration in m/s^2.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>optimized speeds for each dowtrack points that satisfies longitudinal acceleration </dd></dl>

<p class="definition">Definition at line <a class="el" href="basic__autonomy_8cpp_source.html#l00687">687</a> of file <a class="el" href="basic__autonomy_8cpp_source.html">basic_autonomy.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  688</span>        {</div>
<div class="line"><span class="lineno">  689</span>            <span class="keywordflow">if</span> (downtracks.size() != curv_speeds.size())</div>
<div class="line"><span class="lineno">  690</span>            {</div>
<div class="line"><span class="lineno">  691</span>                <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;Downtracks and speeds do not have the same size&quot;</span>);</div>
<div class="line"><span class="lineno">  692</span>            }</div>
<div class="line"><span class="lineno">  693</span> </div>
<div class="line"><span class="lineno">  694</span>            <span class="keywordflow">if</span> (accel_limit &lt;= 0)</div>
<div class="line"><span class="lineno">  695</span>            {</div>
<div class="line"><span class="lineno">  696</span>                <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;Accel limits should be positive&quot;</span>);</div>
<div class="line"><span class="lineno">  697</span>            }</div>
<div class="line"><span class="lineno">  698</span> </div>
<div class="line"><span class="lineno">  699</span>            <span class="keywordtype">bool</span> optimize = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  700</span>            std::unordered_set&lt;size_t&gt; visited_idx;</div>
<div class="line"><span class="lineno">  701</span>            visited_idx.reserve(curv_speeds.size());</div>
<div class="line"><span class="lineno">  702</span> </div>
<div class="line"><span class="lineno">  703</span>            std::vector&lt;double&gt; output = curv_speeds;</div>
<div class="line"><span class="lineno">  704</span> </div>
<div class="line"><span class="lineno">  705</span>            <span class="keywordflow">while</span> (optimize)</div>
<div class="line"><span class="lineno">  706</span>            {</div>
<div class="line"><span class="lineno">  707</span>                <span class="keyword">auto</span> min_pair = <a class="code hl_function" href="namespacebasic__autonomy_1_1waypoint__generation.html#a9dd6a1f0fa9c6f6590b83a7cc2e0d118">min_with_exclusions</a>(curv_speeds, visited_idx);</div>
<div class="line"><span class="lineno">  708</span>                <span class="keywordtype">int</span> min_idx = std::get&lt;1&gt;(min_pair);</div>
<div class="line"><span class="lineno">  709</span>                <span class="keywordflow">if</span> (min_idx == -1)</div>
<div class="line"><span class="lineno">  710</span>                {</div>
<div class="line"><span class="lineno">  711</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  712</span>                }</div>
<div class="line"><span class="lineno">  713</span> </div>
<div class="line"><span class="lineno">  714</span>                visited_idx.insert(min_idx); <span class="comment">// Mark this point as visited</span></div>
<div class="line"><span class="lineno">  715</span> </div>
<div class="line"><span class="lineno">  716</span>                <span class="keywordtype">double</span> v_i = std::get&lt;0&gt;(min_pair);</div>
<div class="line"><span class="lineno">  717</span>                <span class="keywordtype">double</span> x_i = downtracks[min_idx];</div>
<div class="line"><span class="lineno">  718</span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> = min_idx - 1; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> &gt; 0; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>--)</div>
<div class="line"><span class="lineno">  719</span>                {   <span class="comment">// NOTE: Do not use size_t for i type here as -- with &gt; 0 will result in overflow</span></div>
<div class="line"><span class="lineno">  720</span>                    <span class="comment">//       First point&#39;s speed is left unchanged as it is current speed of the vehicle</span></div>
<div class="line"><span class="lineno">  721</span>                    <span class="keywordtype">double</span> v_f = curv_speeds[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>];</div>
<div class="line"><span class="lineno">  722</span>                    <span class="keywordtype">double</span> dv = v_f - v_i;</div>
<div class="line"><span class="lineno">  723</span> </div>
<div class="line"><span class="lineno">  724</span>                    <span class="keywordtype">double</span> x_f = downtracks[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>];</div>
<div class="line"><span class="lineno">  725</span>                    <span class="keywordtype">double</span> dx = x_f - x_i;</div>
<div class="line"><span class="lineno">  726</span> </div>
<div class="line"><span class="lineno">  727</span>                    <span class="keywordflow">if</span> (dv &gt; 0)</div>
<div class="line"><span class="lineno">  728</span>                    {</div>
<div class="line"><span class="lineno">  729</span>                        v_f = std::min(v_f, sqrt(v_i * v_i - 2 * accel_limit * dx)); <span class="comment">// inverting accel as we are only visiting deceleration case</span></div>
<div class="line"><span class="lineno">  730</span>                        visited_idx.insert(<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>);</div>
<div class="line"><span class="lineno">  731</span>                    }</div>
<div class="line"><span class="lineno">  732</span>                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dv &lt; 0)</div>
<div class="line"><span class="lineno">  733</span>                    {</div>
<div class="line"><span class="lineno">  734</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  735</span>                    }</div>
<div class="line"><span class="lineno">  736</span>                    output[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>] = v_f;</div>
<div class="line"><span class="lineno">  737</span>                    v_i = v_f;</div>
<div class="line"><span class="lineno">  738</span>                    x_i = x_f;</div>
<div class="line"><span class="lineno">  739</span>                }</div>
<div class="line"><span class="lineno">  740</span>            }</div>
<div class="line"><span class="lineno">  741</span> </div>
<div class="line"><span class="lineno">  742</span>            <a class="code hl_function" href="namespacebasic__autonomy_1_1log.html#a54dc1b131f40912ecbf27ce0f42bc782">log::printDoublesPerLineWithPrefix</a>(<span class="stringliteral">&quot;only_reverse[i]: &quot;</span>, output);</div>
<div class="line"><span class="lineno">  743</span> </div>
<div class="line"><span class="lineno">  744</span>            output = trajectory_utils::apply_accel_limits_by_distance(downtracks, output, accel_limit, accel_limit);</div>
<div class="line"><span class="lineno">  745</span>            <a class="code hl_function" href="namespacebasic__autonomy_1_1log.html#a54dc1b131f40912ecbf27ce0f42bc782">log::printDoublesPerLineWithPrefix</a>(<span class="stringliteral">&quot;after_forward[i]: &quot;</span>, output);</div>
<div class="line"><span class="lineno">  746</span> </div>
<div class="line"><span class="lineno">  747</span>            <span class="keywordflow">return</span> output;</div>
<div class="line"><span class="lineno">  748</span>        }</div>
<div class="ttc" id="anamespacebasic__autonomy_1_1waypoint__generation_html_a9dd6a1f0fa9c6f6590b83a7cc2e0d118"><div class="ttname"><a href="namespacebasic__autonomy_1_1waypoint__generation.html#a9dd6a1f0fa9c6f6590b83a7cc2e0d118">basic_autonomy::waypoint_generation::min_with_exclusions</a></div><div class="ttdeci">std::pair&lt; double, size_t &gt; min_with_exclusions(const std::vector&lt; double &gt; &amp;values, const std::unordered_set&lt; size_t &gt; &amp;excluded)</div><div class="ttdoc">Returns the min, and its idx, from the vector of values, excluding given set of values.</div><div class="ttdef"><b>Definition:</b> <a href="basic__autonomy_8cpp_source.html#l00667">basic_autonomy.cpp:667</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="process__bag_8py_source.html#l00059">process_bag::i</a>, <a class="el" href="basic__autonomy_8cpp_source.html#l00667">min_with_exclusions()</a>, and <a class="el" href="log_8cpp_source.html#l00045">basic_autonomy::log::printDoublesPerLineWithPrefix()</a>.</p>

<p class="reference">Referenced by <a class="el" href="basic__autonomy_8cpp_source.html#l00853">compose_lanefollow_trajectory_from_path()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebasic__autonomy_1_1waypoint__generation_a84a6c11da2d9736a8f277b6afd124100_cgraph.png" border="0" usemap="#anamespacebasic__autonomy_1_1waypoint__generation_a84a6c11da2d9736a8f277b6afd124100_cgraph" alt=""/></div>
<map name="anamespacebasic__autonomy_1_1waypoint__generation_a84a6c11da2d9736a8f277b6afd124100_cgraph" id="anamespacebasic__autonomy_1_1waypoint__generation_a84a6c11da2d9736a8f277b6afd124100_cgraph">
<area shape="rect" title="Applies the longitudinal acceleration limit to each point&#39;s speed." alt="" coords="5,39,191,80"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#a9dd6a1f0fa9c6f6590b83a7cc2e0d118" title="Returns the min, and its idx, from the vector of values, excluding given set of values." alt="" coords="239,5,453,47"/>
<area shape="rect" href="namespacebasic__autonomy_1_1log.html#a54dc1b131f40912ecbf27ce0f42bc782" title="Print a RCLCPP_DEBUG_STREAM for each value in values where the printed value is &lt;&lt; prefix &lt;&lt; value." alt="" coords="245,71,447,112"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebasic__autonomy_1_1waypoint__generation_a84a6c11da2d9736a8f277b6afd124100_icgraph.png" border="0" usemap="#anamespacebasic__autonomy_1_1waypoint__generation_a84a6c11da2d9736a8f277b6afd124100_icgraph" alt=""/></div>
<map name="anamespacebasic__autonomy_1_1waypoint__generation_a84a6c11da2d9736a8f277b6afd124100_icgraph" id="anamespacebasic__autonomy_1_1waypoint__generation_a84a6c11da2d9736a8f277b6afd124100_icgraph">
<area shape="rect" title="Applies the longitudinal acceleration limit to each point&#39;s speed." alt="" coords="592,93,777,134"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#ad633c0c515eae2b1752ad96031e01ef8" title="Method converts a list of lanelet centerline points and current vehicle state into a usable list of t..." alt="" coords="331,85,544,141"/>
<area shape="rect" href="classinlanecruising__plugin_1_1InLaneCruisingPlugin.html#a60f695c3ed54c99c6a2dcfaf77ae55e2" title="Service callback for trajectory planning." alt="" coords="61,5,227,61"/>
<area shape="rect" href="classplatooning__tactical__plugin_1_1PlatooningTacticalPlugin.html#aee3afe082ccd5ab937dbb1c49f9e21ff" title="Service callback for trajectory planning." alt="" coords="56,85,232,141"/>
<area shape="rect" href="classlight__controlled__intersection__tactical__plugin_1_1LightControlledIntersectionTacticalPlugin.html#a124f95825dfb2728fefa245e6a0e1db7" title="Function to process the light controlled intersection tactical plugin service call for trajectory pla..." alt="" coords="5,165,283,221"/>
</map>
</div>

</div>
</div>
<a id="aef0a6b216ad0be7289773e54843f747b" name="aef0a6b216ad0be7289773e54843f747b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef0a6b216ad0be7289773e54843f747b">&#9670;&nbsp;</a></span>process_trajectory_plan()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">autoware_auto_msgs::msg::Trajectory basic_autonomy::waypoint_generation::process_trajectory_plan </td>
          <td>(</td>
          <td class="paramtype">const carma_planning_msgs::msg::TrajectoryPlan &amp;&#160;</td>
          <td class="paramname"><em>tp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>vehicle_response_lag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Given a carma type of trajectory_plan, generate autoware type of trajectory accounting for speed_lag and stopping case Generated trajectory is meant to be used in autoware.auto's pure_pursuit library using set_trajectory() function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tp</td><td>trajectory plan from tactical plugins</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>trajectory plan of autoware_auto_msgs type </dd></dl>

<p class="definition">Definition at line <a class="el" href="basic__autonomy_8cpp_source.html#l01184">1184</a> of file <a class="el" href="basic__autonomy_8cpp_source.html">basic_autonomy.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1185</span>        {</div>
<div class="line"><span class="lineno"> 1186</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;Processing latest TrajectoryPlan message&quot;</span>);</div>
<div class="line"><span class="lineno"> 1187</span> </div>
<div class="line"><span class="lineno"> 1188</span>            std::vector&lt;double&gt; times;</div>
<div class="line"><span class="lineno"> 1189</span>            std::vector&lt;double&gt; downtracks;</div>
<div class="line"><span class="lineno"> 1190</span> </div>
<div class="line"><span class="lineno"> 1191</span>            std::vector&lt;carma_planning_msgs::msg::TrajectoryPlanPoint&gt; trajectory_points = tp.trajectory_points;</div>
<div class="line"><span class="lineno"> 1192</span> </div>
<div class="line"><span class="lineno"> 1193</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;Original Trajectory size:&quot;</span>&lt;&lt;trajectory_points.size());</div>
<div class="line"><span class="lineno"> 1194</span> </div>
<div class="line"><span class="lineno"> 1195</span> </div>
<div class="line"><span class="lineno"> 1196</span>            trajectory_utils::conversions::trajectory_to_downtrack_time(trajectory_points, &amp;downtracks, &amp;times);</div>
<div class="line"><span class="lineno"> 1197</span> </div>
<div class="line"><span class="lineno"> 1198</span>            <span class="comment">//detect stopping case</span></div>
<div class="line"><span class="lineno"> 1199</span>            <span class="keywordtype">size_t</span> stopping_index = 0;</div>
<div class="line"><span class="lineno"> 1200</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> = 1; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> &lt; times.size(); <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>++)</div>
<div class="line"><span class="lineno"> 1201</span>            {</div>
<div class="line"><span class="lineno"> 1202</span>                <span class="keywordflow">if</span> (times[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>] == times[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> - 1]) <span class="comment">//if exactly same, it is stopping case</span></div>
<div class="line"><span class="lineno"> 1203</span>                {</div>
<div class="line"><span class="lineno"> 1204</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;Detected a stopping case where times is exactly equal: &quot;</span> &lt;&lt; times[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>-1]);</div>
<div class="line"><span class="lineno"> 1205</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;And index of that is: &quot;</span> &lt;&lt; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> &lt;&lt; <span class="stringliteral">&quot;, where size is: &quot;</span> &lt;&lt; times.size());</div>
<div class="line"><span class="lineno"> 1206</span>                    stopping_index = <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>;</div>
<div class="line"><span class="lineno"> 1207</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1208</span>                }</div>
<div class="line"><span class="lineno"> 1209</span>            }</div>
<div class="line"><span class="lineno"> 1210</span> </div>
<div class="line"><span class="lineno"> 1211</span>            std::vector&lt;double&gt; speeds;</div>
<div class="line"><span class="lineno"> 1212</span>            trajectory_utils::conversions::time_to_speed(downtracks, times, tp.initial_longitudinal_velocity, &amp;speeds);</div>
<div class="line"><span class="lineno"> 1213</span> </div>
<div class="line"><span class="lineno"> 1214</span>            <span class="keywordflow">if</span> (speeds.size() != trajectory_points.size())</div>
<div class="line"><span class="lineno"> 1215</span>            {</div>
<div class="line"><span class="lineno"> 1216</span>                <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;Speeds and trajectory points sizes do not match&quot;</span>);</div>
<div class="line"><span class="lineno"> 1217</span>            }</div>
<div class="line"><span class="lineno"> 1218</span> </div>
<div class="line"><span class="lineno"> 1219</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> = 0; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> &lt; speeds.size(); <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>++) { <span class="comment">// Ensure 0 is min speed</span></div>
<div class="line"><span class="lineno"> 1220</span>                <span class="keywordflow">if</span> (stopping_index != 0 &amp;&amp; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> &gt;= stopping_index - 1)</div>
<div class="line"><span class="lineno"> 1221</span>                {</div>
<div class="line"><span class="lineno"> 1222</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;Made it to 0, i: &quot;</span> &lt;&lt; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>);</div>
<div class="line"><span class="lineno"> 1223</span>                    </div>
<div class="line"><span class="lineno"> 1224</span>                    speeds[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>] = 0.0;  <span class="comment">//stopping case</span></div>
<div class="line"><span class="lineno"> 1225</span>                }</div>
<div class="line"><span class="lineno"> 1226</span>                <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1227</span>                {</div>
<div class="line"><span class="lineno"> 1228</span>                    speeds[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>] = std::max(0.0, speeds[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>]);</div>
<div class="line"><span class="lineno"> 1229</span>                }</div>
<div class="line"><span class="lineno"> 1230</span>            }</div>
<div class="line"><span class="lineno"> 1231</span> </div>
<div class="line"><span class="lineno"> 1232</span>            std::vector&lt;double&gt; lag_speeds;</div>
<div class="line"><span class="lineno"> 1233</span>            lag_speeds = <a class="code hl_function" href="namespacebasic__autonomy_1_1waypoint__generation.html#a3c66a834de5e4a066c8c9011e25f8e71">apply_response_lag</a>(speeds, downtracks, vehicle_response_lag); <span class="comment">// This call requires that the first speed point be current speed to work as expected</span></div>
<div class="line"><span class="lineno"> 1234</span>                </div>
<div class="line"><span class="lineno"> 1235</span>            autoware_auto_msgs::msg::Trajectory autoware_trajectory;</div>
<div class="line"><span class="lineno"> 1236</span>            autoware_trajectory.header = tp.header;</div>
<div class="line"><span class="lineno"> 1237</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;size: &quot;</span> &lt;&lt; trajectory_points.size());</div>
<div class="line"><span class="lineno"> 1238</span>            </div>
<div class="line"><span class="lineno"> 1239</span>            <span class="keyword">auto</span> max_size = std::min(99, (<span class="keywordtype">int</span>)trajectory_points.size());  <span class="comment">//NOTE: more than this size autoware auto raises exception with &quot;Exceeded upper bound while in ACTIVE state.&quot;</span></div>
<div class="line"><span class="lineno"> 1240</span>                                                                            <span class="comment">//large portion of the points are not needed anyways </span></div>
<div class="line"><span class="lineno"> 1241</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> = 0; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> &lt; max_size; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>++)</div>
<div class="line"><span class="lineno"> 1242</span>            {</div>
<div class="line"><span class="lineno"> 1243</span>                autoware_auto_msgs::msg::TrajectoryPoint autoware_point;</div>
<div class="line"><span class="lineno"> 1244</span> </div>
<div class="line"><span class="lineno"> 1245</span>                autoware_point.x = trajectory_points[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>].x;</div>
<div class="line"><span class="lineno"> 1246</span>                autoware_point.y = trajectory_points[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>].y;</div>
<div class="line"><span class="lineno"> 1247</span>                autoware_point.longitudinal_velocity_mps = lag_speeds[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>];</div>
<div class="line"><span class="lineno"> 1248</span> </div>
<div class="line"><span class="lineno"> 1249</span>                autoware_point.time_from_start = rclcpp::Duration(times[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>] * 1e9);</div>
<div class="line"><span class="lineno"> 1250</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;Setting waypoint idx: &quot;</span> &lt;&lt; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> &lt;&lt;<span class="stringliteral">&quot;, with planner: &lt;&lt; &quot;</span> &lt;&lt; trajectory_points[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>].planner_plugin_name &lt;&lt; <span class="stringliteral">&quot;, x: &quot;</span> &lt;&lt; trajectory_points[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>].<a class="code hl_variable" href="namespaceprocess__traj__logs.html#af3ba6144a2d35a4990f1a8d04632a052">x</a> &lt;&lt; </div>
<div class="line"><span class="lineno"> 1251</span>                                        <span class="stringliteral">&quot;, y: &quot;</span> &lt;&lt; trajectory_points[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>].<a class="code hl_variable" href="namespaceprocess__traj__logs.html#a05bdb238bfbf3836fb0aa69c5aa1bb48">y</a> &lt;&lt;</div>
<div class="line"><span class="lineno"> 1252</span>                                        <span class="stringliteral">&quot;, speed: &quot;</span> &lt;&lt; lag_speeds[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>]* 2.23694 &lt;&lt; <span class="stringliteral">&quot;mph&quot;</span>);</div>
<div class="line"><span class="lineno"> 1253</span>                autoware_trajectory.points.push_back(autoware_point);</div>
<div class="line"><span class="lineno"> 1254</span>            }</div>
<div class="line"><span class="lineno"> 1255</span> </div>
<div class="line"><span class="lineno"> 1256</span>            <span class="keywordflow">return</span> autoware_trajectory;</div>
<div class="line"><span class="lineno"> 1257</span>        }</div>
<div class="ttc" id="anamespacebasic__autonomy_1_1waypoint__generation_html_a3c66a834de5e4a066c8c9011e25f8e71"><div class="ttname"><a href="namespacebasic__autonomy_1_1waypoint__generation.html#a3c66a834de5e4a066c8c9011e25f8e71">basic_autonomy::waypoint_generation::apply_response_lag</a></div><div class="ttdeci">std::vector&lt; double &gt; apply_response_lag(const std::vector&lt; double &gt; &amp;speeds, const std::vector&lt; double &gt; downtracks, double response_lag)</div><div class="ttdoc">Applies a specified response lag in seconds to the trajectory shifting the whole thing by the specifi...</div><div class="ttdef"><b>Definition:</b> <a href="basic__autonomy_8cpp_source.html#l01260">basic_autonomy.cpp:1260</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="basic__autonomy_8cpp_source.html#l01260">apply_response_lag()</a>, <a class="el" href="basic__autonomy_8hpp_source.html#l00062">BASIC_AUTONOMY_LOGGER</a>, <a class="el" href="process__bag_8py_source.html#l00059">process_bag::i</a>, <a class="el" href="process__traj__logs_8py_source.html#l00128">process_traj_logs::x</a>, and <a class="el" href="process__traj__logs_8py_source.html#l00129">process_traj_logs::y</a>.</p>

<p class="reference">Referenced by <a class="el" href="pure__pursuit__wrapper_8cpp_source.html#l00132">pure_pursuit_wrapper::PurePursuitWrapperNode::generate_command()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebasic__autonomy_1_1waypoint__generation_aef0a6b216ad0be7289773e54843f747b_cgraph.png" border="0" usemap="#anamespacebasic__autonomy_1_1waypoint__generation_aef0a6b216ad0be7289773e54843f747b_cgraph" alt=""/></div>
<map name="anamespacebasic__autonomy_1_1waypoint__generation_aef0a6b216ad0be7289773e54843f747b_cgraph" id="anamespacebasic__autonomy_1_1waypoint__generation_aef0a6b216ad0be7289773e54843f747b_cgraph">
<area shape="rect" title="Given a carma type of trajectory_plan, generate autoware type of trajectory accounting for speed_lag ..." alt="" coords="5,5,237,47"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#a3c66a834de5e4a066c8c9011e25f8e71" title="Applies a specified response lag in seconds to the trajectory shifting the whole thing by the specifi..." alt="" coords="285,5,495,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebasic__autonomy_1_1waypoint__generation_aef0a6b216ad0be7289773e54843f747b_icgraph.png" border="0" usemap="#anamespacebasic__autonomy_1_1waypoint__generation_aef0a6b216ad0be7289773e54843f747b_icgraph" alt=""/></div>
<map name="anamespacebasic__autonomy_1_1waypoint__generation_aef0a6b216ad0be7289773e54843f747b_icgraph" id="anamespacebasic__autonomy_1_1waypoint__generation_aef0a6b216ad0be7289773e54843f747b_icgraph">
<area shape="rect" title="Given a carma type of trajectory_plan, generate autoware type of trajectory accounting for speed_lag ..." alt="" coords="228,13,460,54"/>
<area shape="rect" href="classpure__pursuit__wrapper_1_1PurePursuitWrapperNode.html#a2f08ea5b6b48dd727292e1da2e28712b" title="Extending class provided method which should generate a command message which will be published to th..." alt="" coords="5,5,180,61"/>
</map>
</div>

</div>
</div>
<a id="a19cf5cf882789e1e9ed3e92d0105a8de" name="a19cf5cf882789e1e9ed3e92d0105a8de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19cf5cf882789e1e9ed3e92d0105a8de">&#9670;&nbsp;</a></span>resample_linestring_pair_to_same_size()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::vector&lt; lanelet::BasicPoint2d &gt; &gt; basic_autonomy::waypoint_generation::resample_linestring_pair_to_same_size </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; lanelet::BasicPoint2d &gt; &amp;&#160;</td>
          <td class="paramname"><em>line_1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; lanelet::BasicPoint2d &gt; &amp;&#160;</td>
          <td class="paramname"><em>line_2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Resamples a pair of basicpoint2d lines to get lines of same number of points. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">line_1</td><td>a vector of points to be resampled </td></tr>
    <tr><td class="paramname">line_2</td><td>a vector of points to be resampled</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A 2d vector with input lines resampled at same rate. The first iteration is the resampled line_1 and the resampled line_2 is the second iteration Assumption here is for lane change to happen between two adjacent lanelets, they must share a lane boundary (linestring) </dd></dl>

<p class="definition">Definition at line <a class="el" href="basic__autonomy_8cpp_source.html#l00470">470</a> of file <a class="el" href="basic__autonomy_8cpp_source.html">basic_autonomy.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  470</span>                                                                                                                                                                      {</div>
<div class="line"><span class="lineno">  471</span>            </div>
<div class="line"><span class="lineno">  472</span>            <span class="keyword">auto</span> start_time = std::chrono::high_resolution_clock::now(); <span class="comment">// Start timing the execution time for planning so it can be logged</span></div>
<div class="line"><span class="lineno">  473</span> </div>
<div class="line"><span class="lineno">  474</span>            std::vector&lt;std::vector&lt;lanelet::BasicPoint2d&gt;&gt; output;</div>
<div class="line"><span class="lineno">  475</span>            </div>
<div class="line"><span class="lineno">  476</span>            <span class="comment">//Fit centerlines to a spline</span></div>
<div class="line"><span class="lineno">  477</span>            std::unique_ptr&lt;smoothing::SplineI&gt; fit_curve_1 = <a class="code hl_function" href="namespacebasic__autonomy_1_1waypoint__generation.html#a9e0eab343d21d18c665083839d706f04">compute_fit</a>(line_1); <span class="comment">// Compute splines based on curve points</span></div>
<div class="line"><span class="lineno">  478</span>            <span class="keywordflow">if</span> (!fit_curve_1)</div>
<div class="line"><span class="lineno">  479</span>            {</div>
<div class="line"><span class="lineno">  480</span>                <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;Could not fit a spline curve along the starting_lane centerline points!&quot;</span>);</div>
<div class="line"><span class="lineno">  481</span>            }</div>
<div class="line"><span class="lineno">  482</span> </div>
<div class="line"><span class="lineno">  483</span>            std::unique_ptr&lt;smoothing::SplineI&gt; fit_curve_2 = <a class="code hl_function" href="namespacebasic__autonomy_1_1waypoint__generation.html#a9e0eab343d21d18c665083839d706f04">compute_fit</a>(line_2); <span class="comment">// Compute splines based on curve points</span></div>
<div class="line"><span class="lineno">  484</span>            <span class="keywordflow">if</span> (!fit_curve_2)</div>
<div class="line"><span class="lineno">  485</span>            {</div>
<div class="line"><span class="lineno">  486</span>                <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;Could not fit a spline curve along the ending_lane centerline points!&quot;</span>);</div>
<div class="line"><span class="lineno">  487</span>            }</div>
<div class="line"><span class="lineno">  488</span> </div>
<div class="line"><span class="lineno">  489</span>            <span class="comment">//Sample spline to get centerlines of equal size</span></div>
<div class="line"><span class="lineno">  490</span>            std::vector&lt;lanelet::BasicPoint2d&gt; all_sampling_points_line1;</div>
<div class="line"><span class="lineno">  491</span>            std::vector&lt;lanelet::BasicPoint2d&gt; all_sampling_points_line2;</div>
<div class="line"><span class="lineno">  492</span> </div>
<div class="line"><span class="lineno">  493</span>            <span class="keywordtype">size_t</span> total_point_size = std::min(line_1.size(), line_2.size());</div>
<div class="line"><span class="lineno">  494</span> </div>
<div class="line"><span class="lineno">  495</span>            all_sampling_points_line1.reserve(1 + total_point_size * 2);</div>
<div class="line"><span class="lineno">  496</span>            std::vector&lt;double&gt; downtracks_raw_line1 = <a class="code hl_function" href="namespacecarma__wm_1_1geometry.html#adf1c6b7f1e33569b45074e4e5bbeff1d">carma_wm::geometry::compute_arc_lengths</a>(line_1);</div>
<div class="line"><span class="lineno">  497</span>            <span class="comment">//int total_step_along_curve1 = static_cast&lt;int&gt;(downtracks_raw_line1.back() / 2.0);</span></div>
<div class="line"><span class="lineno">  498</span>            <span class="comment">//double step_threshold_line1 = (double)total_step_along_curve1 / (double)total_point_size;</span></div>
<div class="line"><span class="lineno">  499</span>            <span class="comment">//TODO: are we missing some computation here?  step_threshold_line1 and step_threshold_line2 are not used anywhere</span></div>
<div class="line"><span class="lineno">  500</span>            <span class="comment">//      and these calcs can be deleted (see below also).</span></div>
<div class="line"><span class="lineno">  501</span>            </div>
<div class="line"><span class="lineno">  502</span>            all_sampling_points_line2.reserve(1 + total_point_size * 2);</div>
<div class="line"><span class="lineno">  503</span>            std::vector&lt;double&gt; downtracks_raw_line2 = <a class="code hl_function" href="namespacecarma__wm_1_1geometry.html#adf1c6b7f1e33569b45074e4e5bbeff1d">carma_wm::geometry::compute_arc_lengths</a>(line_2);</div>
<div class="line"><span class="lineno">  504</span>            <span class="comment">//TODO: unused variable: int total_step_along_curve2 = static_cast&lt;int&gt;(downtracks_raw_line2.back() / 2.0);</span></div>
<div class="line"><span class="lineno">  505</span>            <span class="comment">//TODO: unused variable: double step_threshold_line2 = (double)total_step_along_curve2 / (double)total_point_size;</span></div>
<div class="line"><span class="lineno">  506</span> </div>
<div class="line"><span class="lineno">  507</span>            <span class="keywordtype">double</span> scaled_steps_along_curve = 0.0; <span class="comment">// from 0 (start) to 1 (end) for the whole trajectory</span></div>
<div class="line"><span class="lineno">  508</span>            </div>
<div class="line"><span class="lineno">  509</span>            </div>
<div class="line"><span class="lineno">  510</span>            all_sampling_points_line2.reserve(1 + total_point_size * 2);</div>
<div class="line"><span class="lineno">  511</span>            </div>
<div class="line"><span class="lineno">  512</span>            <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> = 0;<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>&lt;total_point_size; ++<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>){</div>
<div class="line"><span class="lineno">  513</span>                lanelet::BasicPoint2d p1 = (*fit_curve_1)(scaled_steps_along_curve);</div>
<div class="line"><span class="lineno">  514</span>                lanelet::BasicPoint2d p2 = (*fit_curve_2)(scaled_steps_along_curve);</div>
<div class="line"><span class="lineno">  515</span>                all_sampling_points_line1.push_back(p1);</div>
<div class="line"><span class="lineno">  516</span>                all_sampling_points_line2.push_back(p2);</div>
<div class="line"><span class="lineno">  517</span> </div>
<div class="line"><span class="lineno">  518</span>                scaled_steps_along_curve += 1.0 / total_point_size;  <span class="comment">//adding steps_along_curve_step_size</span></div>
<div class="line"><span class="lineno">  519</span>            }</div>
<div class="line"><span class="lineno">  520</span> </div>
<div class="line"><span class="lineno">  521</span>            output.push_back(all_sampling_points_line1);</div>
<div class="line"><span class="lineno">  522</span>            output.push_back(all_sampling_points_line2);</div>
<div class="line"><span class="lineno">  523</span> </div>
<div class="line"><span class="lineno">  524</span>            <span class="keyword">auto</span> end_time = std::chrono::high_resolution_clock::now();</div>
<div class="line"><span class="lineno">  525</span>            </div>
<div class="line"><span class="lineno">  526</span>            <span class="keyword">auto</span> duration = std::chrono::duration_cast&lt;std::chrono::milliseconds&gt;(end_time - start_time);</div>
<div class="line"><span class="lineno">  527</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<a class="code hl_variable" href="namespacebasic__autonomy_1_1waypoint__generation.html#a40f0df33d30f775890f99bef7a685e33">BASIC_AUTONOMY_LOGGER</a>), <span class="stringliteral">&quot;ExecutionTime for resample lane change centerlines: &quot;</span> &lt;&lt; duration.count() &lt;&lt; <span class="stringliteral">&quot; milliseconds&quot;</span>);</div>
<div class="line"><span class="lineno">  528</span> </div>
<div class="line"><span class="lineno">  529</span>            <span class="keywordflow">return</span> output;</div>
<div class="line"><span class="lineno">  530</span>        }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="basic__autonomy_8hpp_source.html#l00062">BASIC_AUTONOMY_LOGGER</a>, <a class="el" href="Geometry_8cpp_source.html#l00498">carma_wm::geometry::compute_arc_lengths()</a>, <a class="el" href="basic__autonomy_8cpp_source.html#l00806">compute_fit()</a>, and <a class="el" href="process__bag_8py_source.html#l00059">process_bag::i</a>.</p>

<p class="reference">Referenced by <a class="el" href="basic__autonomy_8cpp_source.html#l00307">create_lanechange_geometry()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebasic__autonomy_1_1waypoint__generation_a19cf5cf882789e1e9ed3e92d0105a8de_cgraph.png" border="0" usemap="#anamespacebasic__autonomy_1_1waypoint__generation_a19cf5cf882789e1e9ed3e92d0105a8de_cgraph" alt=""/></div>
<map name="anamespacebasic__autonomy_1_1waypoint__generation_a19cf5cf882789e1e9ed3e92d0105a8de_cgraph" id="anamespacebasic__autonomy_1_1waypoint__generation_a19cf5cf882789e1e9ed3e92d0105a8de_cgraph">
<area shape="rect" title="Resamples a pair of basicpoint2d lines to get lines of same number of points." alt="" coords="5,39,212,95"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#adf1c6b7f1e33569b45074e4e5bbeff1d" title="Compute the arc length at each point around the curve." alt="" coords="271,13,423,54"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#a9e0eab343d21d18c665083839d706f04" title="Computes a spline based on the provided points." alt="" coords="260,78,433,119"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#a4e12c2971926486d1447e44e978f8d4d" title=" " alt="" coords="481,5,627,61"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#a9bc48b810ba18270fcc21674b55922f0" title="Compute the Euclidean distance between the two points." alt="" coords="675,5,820,61"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebasic__autonomy_1_1waypoint__generation_a19cf5cf882789e1e9ed3e92d0105a8de_icgraph.png" border="0" usemap="#anamespacebasic__autonomy_1_1waypoint__generation_a19cf5cf882789e1e9ed3e92d0105a8de_icgraph" alt=""/></div>
<map name="anamespacebasic__autonomy_1_1waypoint__generation_a19cf5cf882789e1e9ed3e92d0105a8de_icgraph" id="anamespacebasic__autonomy_1_1waypoint__generation_a19cf5cf882789e1e9ed3e92d0105a8de_icgraph">
<area shape="rect" title="Resamples a pair of basicpoint2d lines to get lines of same number of points." alt="" coords="1240,85,1447,141"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#a2219ab96db87781023137bdb45af1ea2" title="Creates a vector of lane change points using parameters defined." alt="" coords="988,85,1192,141"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#af992a6cbbdafd6e86d73976a65164e94" title="Converts a set of requested LANE_CHANGE maneuvers to point speed limit pairs." alt="" coords="753,85,940,141"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#acdcd3bb44d31aa6405b30f151ea35ae4" title="Creates geometry profile to return a point speed pair struct for LANE FOLLOW and LANE CHANGE maneuver..." alt="" coords="515,85,705,141"/>
<area shape="rect" href="classcooperative__lanechange_1_1CooperativeLaneChangePlugin.html#a5f0c14a409d58d6b1750c38c6bf1b34a" title="Creates a vector of Trajectory Points from maneuver information in trajectory request." alt="" coords="260,5,467,61"/>
<area shape="rect" href="classinlanecruising__plugin_1_1InLaneCruisingPlugin.html#a60f695c3ed54c99c6a2dcfaf77ae55e2" title="Service callback for trajectory planning." alt="" coords="280,85,447,141"/>
<area shape="rect" href="classplatooning__tactical__plugin_1_1PlatooningTacticalPlugin.html#aee3afe082ccd5ab937dbb1c49f9e21ff" title="Service callback for trajectory planning." alt="" coords="275,165,451,221"/>
<area shape="rect" href="classcooperative__lanechange_1_1CooperativeLaneChangePlugin.html#a8913539d8614e509910af225e18bc809" title="Extending class provided callback which should return a planned trajectory based on the provided traj..." alt="" coords="5,5,212,61"/>
</map>
</div>

</div>
</div>
<a id="a0f07faaac8c54cc485f2bb217097326e" name="a0f07faaac8c54cc485f2bb217097326e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f07faaac8c54cc485f2bb217097326e">&#9670;&nbsp;</a></span>split_point_speed_pairs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void basic_autonomy::waypoint_generation::split_point_speed_pairs </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1PointSpeedPair.html">PointSpeedPair</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>points</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; lanelet::BasicPoint2d &gt; *&#160;</td>
          <td class="paramname"><em>basic_points</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>speeds</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Helper method to split a list of <a class="el" href="structbasic__autonomy_1_1waypoint__generation_1_1PointSpeedPair.html">PointSpeedPair</a> into separate point and speed lists. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">points</td><td>Point Speed pair to split </td></tr>
    <tr><td class="paramname">basic_points</td><td>points vector to be filled </td></tr>
    <tr><td class="paramname">speeds</td><td>speeds vector to be filled </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="helper__functions_8cpp_source.html#l00083">83</a> of file <a class="el" href="helper__functions_8cpp_source.html">helper_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   86</span>    {</div>
<div class="line"><span class="lineno">   87</span>        basic_points-&gt;reserve(points.size());</div>
<div class="line"><span class="lineno">   88</span>        speeds-&gt;reserve(points.size());</div>
<div class="line"><span class="lineno">   89</span> </div>
<div class="line"><span class="lineno">   90</span>        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; p : points)</div>
<div class="line"><span class="lineno">   91</span>        {</div>
<div class="line"><span class="lineno">   92</span>            basic_points-&gt;push_back(p.point);</div>
<div class="line"><span class="lineno">   93</span>            speeds-&gt;push_back(p.speed);</div>
<div class="line"><span class="lineno">   94</span>        }</div>
<div class="line"><span class="lineno">   95</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="basic__autonomy_8cpp_source.html#l01112">compose_lanechange_trajectory_from_path()</a>, <a class="el" href="basic__autonomy_8cpp_source.html#l00853">compose_lanefollow_trajectory_from_path()</a>, <a class="el" href="stop__controlled__intersection__tactical__plugin_8cpp_source.html#l00477">stop_controlled_intersection_tactical_plugin::StopControlledIntersectionTacticalPlugin::compose_trajectory_from_centerline()</a>, <a class="el" href="basic__autonomy_8cpp_source.html#l00631">constrain_to_time_boundary()</a>, and <a class="el" href="helper__functions_8cpp_source.html#l00097">get_nearest_index_by_downtrack()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebasic__autonomy_1_1waypoint__generation_a0f07faaac8c54cc485f2bb217097326e_icgraph.png" border="0" usemap="#anamespacebasic__autonomy_1_1waypoint__generation_a0f07faaac8c54cc485f2bb217097326e_icgraph" alt=""/></div>
<map name="anamespacebasic__autonomy_1_1waypoint__generation_a0f07faaac8c54cc485f2bb217097326e_icgraph" id="anamespacebasic__autonomy_1_1waypoint__generation_a0f07faaac8c54cc485f2bb217097326e_icgraph">
<area shape="rect" title="Helper method to split a list of PointSpeedPair into separate point and speed lists." alt="" coords="879,223,1052,279"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#a741942c16ca54212b9adf3ddc2eea66d" title="Method converts a list of lanelet centerline points and current vehicle state into a usable list of t..." alt="" coords="609,79,831,135"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#ad633c0c515eae2b1752ad96031e01ef8" title="Method converts a list of lanelet centerline points and current vehicle state into a usable list of t..." alt="" coords="339,165,553,221"/>
<area shape="rect" href="classstop__controlled__intersection__tactical__plugin_1_1StopControlledIntersectionTacticalPlugin.html#ae4ee772170429ec26c32ceec68f3c22f" title="Method converts a list of lanelet centerline points and current vehicle state into a usable list of t..." alt="" coords="331,281,561,351"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#af509efce135492493e13c9bb86329dcd" title="Reduces the input points to only those points that fit within the provided time boundary." alt="" coords="633,223,807,279"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#a51d5d768864d9632b6c59acddbb804a6" title="Overload: Returns the nearest point to the provided vehicle pose in the provided list by utilizing th..." alt="" coords="633,353,807,409"/>
<area shape="rect" href="classcooperative__lanechange_1_1CooperativeLaneChangePlugin.html#a5f0c14a409d58d6b1750c38c6bf1b34a" title="Creates a vector of Trajectory Points from maneuver information in trajectory request." alt="" coords="343,72,549,128"/>
<area shape="rect" href="classcooperative__lanechange_1_1CooperativeLaneChangePlugin.html#a8913539d8614e509910af225e18bc809" title="Extending class provided callback which should return a planned trajectory based on the provided traj..." alt="" coords="41,5,247,61"/>
<area shape="rect" href="classinlanecruising__plugin_1_1InLaneCruisingPlugin.html#a60f695c3ed54c99c6a2dcfaf77ae55e2" title="Service callback for trajectory planning." alt="" coords="61,85,227,141"/>
<area shape="rect" href="classplatooning__tactical__plugin_1_1PlatooningTacticalPlugin.html#aee3afe082ccd5ab937dbb1c49f9e21ff" title="Service callback for trajectory planning." alt="" coords="56,165,232,221"/>
<area shape="rect" href="classlight__controlled__intersection__tactical__plugin_1_1LightControlledIntersectionTacticalPlugin.html#a124f95825dfb2728fefa245e6a0e1db7" title="Function to process the light controlled intersection tactical plugin service call for trajectory pla..." alt="" coords="5,245,283,301"/>
<area shape="rect" href="classstop__controlled__intersection__tactical__plugin_1_1StopControlledIntersectionTacticalPlugin.html#ab0bf4a699bff521ffe56736d78880926" title="Extending class provided callback which should return a planned trajectory based on the provided traj..." alt="" coords="43,326,245,397"/>
</map>
</div>

</div>
</div>
<a id="aba6a29cdaf0c4af10647b59bf6df4e01" name="aba6a29cdaf0c4af10647b59bf6df4e01"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba6a29cdaf0c4af10647b59bf6df4e01">&#9670;&nbsp;</a></span>trajectory_from_points_times_orientations()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; carma_planning_msgs::msg::TrajectoryPlanPoint &gt; basic_autonomy::waypoint_generation::trajectory_from_points_times_orientations </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; lanelet::BasicPoint2d &gt; &amp;&#160;</td>
          <td class="paramname"><em>points</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>times</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>yaws</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">rclcpp::Time&#160;</td>
          <td class="paramname"><em>startTime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>desired_controller_plugin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Method combines input points, times, orientations, and an absolute start time to form a valid carma platform trajectory. </p>
<p >NOTE: All input vectors must be the same size. The output vector will take this size.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">points</td><td>The points in the map frame that the trajectory will follow. Units m </td></tr>
    <tr><td class="paramname">times</td><td>The times which at the vehicle should arrive at the specified points. First point should have a value of 0. Units s </td></tr>
    <tr><td class="paramname">yaws</td><td>The orientation the vehicle should achieve at each point. Units radians </td></tr>
    <tr><td class="paramname">startTime</td><td>The absolute start time which will be used to update the input relative times. Units s </td></tr>
    <tr><td class="paramname">desired_controller_plugin</td><td>The name of the controller plugin for the generated trajectory.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A list of trajectory points built from the provided inputs. </dd></dl>

<p class="definition">Definition at line <a class="el" href="basic__autonomy_8cpp_source.html#l00750">750</a> of file <a class="el" href="basic__autonomy_8cpp_source.html">basic_autonomy.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  753</span>        {</div>
<div class="line"><span class="lineno">  754</span>            <span class="keywordflow">if</span> (points.size() != times.size() || points.size() != yaws.size())</div>
<div class="line"><span class="lineno">  755</span>            {</div>
<div class="line"><span class="lineno">  756</span>                <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;All input vectors must have the same size&quot;</span>);</div>
<div class="line"><span class="lineno">  757</span>            }</div>
<div class="line"><span class="lineno">  758</span> </div>
<div class="line"><span class="lineno">  759</span>            std::vector&lt;carma_planning_msgs::msg::TrajectoryPlanPoint&gt; traj;</div>
<div class="line"><span class="lineno">  760</span>            traj.reserve(points.size());</div>
<div class="line"><span class="lineno">  761</span> </div>
<div class="line"><span class="lineno">  762</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> = 0; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> &lt; points.size(); <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>++)</div>
<div class="line"><span class="lineno">  763</span>            {</div>
<div class="line"><span class="lineno">  764</span>                carma_planning_msgs::msg::TrajectoryPlanPoint tpp;</div>
<div class="line"><span class="lineno">  765</span>                rclcpp::Duration relative_time(times[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>] * 1e9); <span class="comment">// Conversion of times[i] from seconds to nanoseconds</span></div>
<div class="line"><span class="lineno">  766</span>                tpp.target_time = startTime + relative_time;</div>
<div class="line"><span class="lineno">  767</span>                tpp.x = points[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>].x();</div>
<div class="line"><span class="lineno">  768</span>                tpp.y = points[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>].y();</div>
<div class="line"><span class="lineno">  769</span>                tpp.yaw = yaws[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>];</div>
<div class="line"><span class="lineno">  770</span>                </div>
<div class="line"><span class="lineno">  771</span>                tpp.controller_plugin_name = desired_controller_plugin;</div>
<div class="line"><span class="lineno">  772</span>                <span class="comment">//tpp.planner_plugin_name        //Planner plugin name is filled in the tactical plugin</span></div>
<div class="line"><span class="lineno">  773</span> </div>
<div class="line"><span class="lineno">  774</span>                traj.push_back(tpp);</div>
<div class="line"><span class="lineno">  775</span>            }</div>
<div class="line"><span class="lineno">  776</span> </div>
<div class="line"><span class="lineno">  777</span>            <span class="keywordflow">return</span> traj;</div>
<div class="line"><span class="lineno">  778</span>        }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="process__bag_8py_source.html#l00059">process_bag::i</a>.</p>

<p class="reference">Referenced by <a class="el" href="basic__autonomy_8cpp_source.html#l01112">compose_lanechange_trajectory_from_path()</a>, <a class="el" href="basic__autonomy_8cpp_source.html#l00853">compose_lanefollow_trajectory_from_path()</a>, and <a class="el" href="stop__controlled__intersection__tactical__plugin_8cpp_source.html#l00477">stop_controlled_intersection_tactical_plugin::StopControlledIntersectionTacticalPlugin::compose_trajectory_from_centerline()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebasic__autonomy_1_1waypoint__generation_aba6a29cdaf0c4af10647b59bf6df4e01_icgraph.png" border="0" usemap="#anamespacebasic__autonomy_1_1waypoint__generation_aba6a29cdaf0c4af10647b59bf6df4e01_icgraph" alt=""/></div>
<map name="anamespacebasic__autonomy_1_1waypoint__generation_aba6a29cdaf0c4af10647b59bf6df4e01_icgraph" id="anamespacebasic__autonomy_1_1waypoint__generation_aba6a29cdaf0c4af10647b59bf6df4e01_icgraph">
<area shape="rect" title="Method combines input points, times, orientations, and an absolute start time to form a valid carma p..." alt="" coords="864,165,1075,221"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#a741942c16ca54212b9adf3ddc2eea66d" title="Method converts a list of lanelet centerline points and current vehicle state into a usable list of t..." alt="" coords="590,45,811,101"/>
<area shape="rect" href="namespacebasic__autonomy_1_1waypoint__generation.html#ad633c0c515eae2b1752ad96031e01ef8" title="Method converts a list of lanelet centerline points and current vehicle state into a usable list of t..." alt="" coords="594,165,807,221"/>
<area shape="rect" href="classstop__controlled__intersection__tactical__plugin_1_1StopControlledIntersectionTacticalPlugin.html#ae4ee772170429ec26c32ceec68f3c22f" title="Method converts a list of lanelet centerline points and current vehicle state into a usable list of t..." alt="" coords="585,286,816,357"/>
<area shape="rect" href="classcooperative__lanechange_1_1CooperativeLaneChangePlugin.html#a5f0c14a409d58d6b1750c38c6bf1b34a" title="Creates a vector of Trajectory Points from maneuver information in trajectory request." alt="" coords="295,5,502,61"/>
<area shape="rect" href="classcooperative__lanechange_1_1CooperativeLaneChangePlugin.html#a8913539d8614e509910af225e18bc809" title="Extending class provided callback which should return a planned trajectory based on the provided traj..." alt="" coords="5,5,212,61"/>
<area shape="rect" href="classinlanecruising__plugin_1_1InLaneCruisingPlugin.html#a60f695c3ed54c99c6a2dcfaf77ae55e2" title="Service callback for trajectory planning." alt="" coords="315,85,482,141"/>
<area shape="rect" href="classplatooning__tactical__plugin_1_1PlatooningTacticalPlugin.html#aee3afe082ccd5ab937dbb1c49f9e21ff" title="Service callback for trajectory planning." alt="" coords="311,165,487,221"/>
<area shape="rect" href="classlight__controlled__intersection__tactical__plugin_1_1LightControlledIntersectionTacticalPlugin.html#a124f95825dfb2728fefa245e6a0e1db7" title="Function to process the light controlled intersection tactical plugin service call for trajectory pla..." alt="" coords="260,245,537,301"/>
<area shape="rect" href="classstop__controlled__intersection__tactical__plugin_1_1StopControlledIntersectionTacticalPlugin.html#ab0bf4a699bff521ffe56736d78880926" title="Extending class provided callback which should return a planned trajectory based on the provided traj..." alt="" coords="297,326,500,397"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a40f0df33d30f775890f99bef7a685e33" name="a40f0df33d30f775890f99bef7a685e33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40f0df33d30f775890f99bef7a685e33">&#9670;&nbsp;</a></span>BASIC_AUTONOMY_LOGGER</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::string basic_autonomy::waypoint_generation::BASIC_AUTONOMY_LOGGER = &quot;basic_autonomy&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="basic__autonomy_8hpp_source.html#l00062">62</a> of file <a class="el" href="basic__autonomy_8hpp_source.html">basic_autonomy.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="basic__autonomy_8cpp_source.html#l00225">add_lanefollow_buffer()</a>, <a class="el" href="basic__autonomy_8cpp_source.html#l00604">apply_speed_limits()</a>, <a class="el" href="basic__autonomy_8cpp_source.html#l01112">compose_lanechange_trajectory_from_path()</a>, <a class="el" href="basic__autonomy_8cpp_source.html#l00853">compose_lanefollow_trajectory_from_path()</a>, <a class="el" href="basic__autonomy_8cpp_source.html#l00806">compute_fit()</a>, <a class="el" href="basic__autonomy_8cpp_source.html#l00631">constrain_to_time_boundary()</a>, <a class="el" href="basic__autonomy_8cpp_source.html#l00024">create_geometry_profile()</a>, <a class="el" href="basic__autonomy_8cpp_source.html#l00307">create_lanechange_geometry()</a>, <a class="el" href="basic__autonomy_8cpp_source.html#l00068">create_lanefollow_geometry()</a>, <a class="el" href="basic__autonomy_8cpp_source.html#l00532">get_lanechange_points_from_maneuver()</a>, <a class="el" href="helper__functions_8cpp_source.html#l00065">get_nearest_index_by_downtrack()</a>, <a class="el" href="helper__functions_8cpp_source.html#l00044">get_nearest_point_index()</a>, <a class="el" href="basic__autonomy_8cpp_source.html#l01184">process_trajectory_plan()</a>, and <a class="el" href="basic__autonomy_8cpp_source.html#l00470">resample_linestring_pair_to_same_size()</a>.</p>

</div>
</div>
<a id="a05408c147e288f4120ad1a8c90dd3241" name="a05408c147e288f4120ad1a8c90dd3241"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05408c147e288f4120ad1a8c90dd3241">&#9670;&nbsp;</a></span>epsilon_</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const double basic_autonomy::waypoint_generation::epsilon_ = 0.0000001</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="helper__functions_8hpp_source.html#l00024">24</a> of file <a class="el" href="helper__functions_8hpp_source.html">helper_functions.hpp</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacebasic__autonomy.html">basic_autonomy</a></li><li class="navelem"><a class="el" href="namespacebasic__autonomy_1_1waypoint__generation.html">waypoint_generation</a></li>
    <li class="footer">Generated on Wed Jun 7 2023 10:29:02 for Carma-platform by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4 </li>
  </ul>
</div>
</body>
</html>
