<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Carma-platform: platooning_strategic_IHP/src/platoon_manager_ihp.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Carma-platform<span id="projectnumber">&#160;v4.2.0</span>
   </div>
   <div id="projectbrief">CARMA Platform is built on robot operating system (ROS) and utilizes open source software (OSS) that enables Cooperative Driving Automation (CDA) features to allow Automated Driving Systems to interact and cooperate with infrastructure and other vehicles through communication.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('platoon__manager__ihp_8cpp_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle"><div class="title">platoon_manager_ihp.cpp</div></div>
</div><!--header-->
<div class="contents">
<a href="platoon__manager__ihp_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">/*</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment"> * Copyright (C) 2019-2021 LEIDOS.</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment"> *</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment"> * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;); you may not</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment"> * use this file except in compliance with the License. You may obtain a copy of</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="comment"> * the License at</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="comment"> *</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="comment"> * http://www.apache.org/licenses/LICENSE-2.0</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="comment"> *</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="comment"> * Unless required by applicable law or agreed to in writing, software</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="comment"> * distributed under the License is distributed on an &quot;AS IS&quot; BASIS, WITHOUT</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="comment"> * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="comment"> * License for the specific language governing permissions and limitations under</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="comment"> * the License.</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="comment"> */</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span> </div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="comment">/*</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="comment"> * Developed by the UCLA Mobility Lab, 10/20/2021. </span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="comment"> *</span></div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span><span class="comment"> * Creator: Xu Han</span></div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="comment"> * Author: Xu Han, Xin Xia, Jiaqi Ma</span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span><span class="comment"> */</span></div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span> </div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span><span class="preprocessor">#include &quot;<a class="code" href="platoon__manager__ihp_8h.html">platoon_strategic_ihp/platoon_manager_ihp.h</a>&quot;</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span><span class="preprocessor">#include &quot;<a class="code" href="platoon__config__ihp_8h.html">platoon_strategic_ihp/platoon_config_ihp.h</a>&quot;</span></div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span><span class="preprocessor">#include &lt;boost/algorithm/string.hpp&gt;</span></div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span><span class="preprocessor">#include &lt;rclcpp/logging.hpp&gt;</span></div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span><span class="preprocessor">#include &lt;array&gt;</span></div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span> </div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span><span class="keyword">namespace </span><a class="code hl_namespace" href="namespaceplatoon__strategic__ihp.html">platoon_strategic_ihp</a></div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span>{</div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno"><a class="line" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a5239d1fb655a136e49a266d2ddf40589">   51</a></span>    <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a5239d1fb655a136e49a266d2ddf40589">PlatoonManager::PlatoonManager</a>(std::shared_ptr&lt;carma_ros2_utils::timers::TimerFactory&gt; timer_factory) : timer_factory_(std::move(timer_factory))</div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span>    {</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Top of PlatoonManager ctor.&quot;</span>);</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span>    }</div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span> </div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span> </div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span>    <span class="comment">// Update the location of the host in the vector of platoon members</span></div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno"><a class="line" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ab1710b942f6893b756b67dd6505ee90b">   58</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ab1710b942f6893b756b67dd6505ee90b">PlatoonManager::updateHostPose</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> downtrack, <span class="keyword">const</span> <span class="keywordtype">double</span> crosstrack)</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span>    {</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Host (index &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a822212181c90d3fa29f8a9aa513fab3f">hostPosInPlatoon_</a> &lt;&lt; <span class="stringliteral">&quot;): downtrack = &quot;</span> &lt;&lt; downtrack &lt;&lt; <span class="stringliteral">&quot;, crosstrack = &quot;</span> &lt;&lt; crosstrack);</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>[<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a822212181c90d3fa29f8a9aa513fab3f">hostPosInPlatoon_</a>].vehiclePosition = downtrack;</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span>        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>[<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a822212181c90d3fa29f8a9aa513fab3f">hostPosInPlatoon_</a>].vehicleCrossTrack = crosstrack;</div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>    }</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span> </div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span>    <span class="comment">// Update the speed info of the host in the vector of platoon members</span></div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno"><a class="line" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a686ffb96fbf0c728db7d12d03f1932c9">   66</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a686ffb96fbf0c728db7d12d03f1932c9">PlatoonManager::updateHostSpeeds</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> cmdSpeed, <span class="keyword">const</span> <span class="keywordtype">double</span> actualSpeed)</div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>    {</div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span>        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>[<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a822212181c90d3fa29f8a9aa513fab3f">hostPosInPlatoon_</a>].commandSpeed = cmdSpeed;</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>[<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a822212181c90d3fa29f8a9aa513fab3f">hostPosInPlatoon_</a>].vehicleSpeed = actualSpeed;</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>    }</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span> </div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>    <span class="comment">// Update/add one member&#39;s information from STATUS messages, update platoon ID if needed.  </span></div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno"><a class="line" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#aa09eb8121e30d6ee3517823766dbeea4">   73</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#aa09eb8121e30d6ee3517823766dbeea4">PlatoonManager::hostMemberUpdates</a>(<span class="keyword">const</span> std::string&amp; senderId, <span class="keyword">const</span> std::string&amp; platoonId, <span class="keyword">const</span> std::string&amp; params, </div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>                                           <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; DtD, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; CtD)</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>    {</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span> </div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>        <span class="comment">// parse params, read member data</span></div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>        std::vector&lt;std::string&gt; inputsParams;</div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>        <a class="code hl_variable" href="namespaceprocess__traj__logs.html#a3682477a3431f2a4aa182fb9a6439125">boost::algorithm::split</a>(inputsParams, params, boost::is_any_of(<span class="stringliteral">&quot;,&quot;</span>));</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>        <span class="comment">// read command speed, m/s</span></div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>        std::vector&lt;std::string&gt; cmd_parsed;</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>        <a class="code hl_variable" href="namespaceprocess__traj__logs.html#a3682477a3431f2a4aa182fb9a6439125">boost::algorithm::split</a>(cmd_parsed, inputsParams[0], boost::is_any_of(<span class="stringliteral">&quot;:&quot;</span>));</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>        <span class="keywordtype">double</span> cmdSpeed = std::stod(cmd_parsed[1]);</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>        <span class="comment">// get DtD directly instead of parsing message, m</span></div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>        <span class="keywordtype">double</span> dtDistance = DtD;</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>        <span class="comment">// get CtD directly </span></div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>        <span class="keywordtype">double</span> ctDistance = CtD;</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>        <span class="comment">// read current speed, m/s</span></div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>        std::vector&lt;std::string&gt; cur_parsed;</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>        <a class="code hl_variable" href="namespaceprocess__traj__logs.html#a3682477a3431f2a4aa182fb9a6439125">boost::algorithm::split</a>(cur_parsed, inputsParams[1], boost::is_any_of(<span class="stringliteral">&quot;:&quot;</span>));</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>        <span class="keywordtype">double</span> curSpeed = std::stod(cur_parsed[1]);</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span> </div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>        <span class="comment">// If we are currently in a follower state:</span></div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>        <span class="comment">// 1. We will update platoon ID based on leader&#39;s STATUS</span></div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>        <span class="comment">// 2. We will update platoon members info based on platoon ID for all members</span></div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a9fb744eaf988b3082397c736de1006ab">isFollower</a>) </div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>        {</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>            <span class="comment">// Sanity check</span></div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a05732c5f9b2d8f5d2c66d1cdcf793854">platoonLeaderID</a>.compare(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>[0].staticId) != 0)</div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>            {</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;///// platoonLeaderID NOT PROPERLY ASSIGNED! Value = &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a05732c5f9b2d8f5d2c66d1cdcf793854">platoonLeaderID</a></div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>                                &lt;&lt; <span class="stringliteral">&quot;, host_platoon_[0].staticId = &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>[0].staticId);</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>            }</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span> </div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>            <span class="comment">// read message status        </span></div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>            <span class="keywordtype">bool</span> isFromLeader = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a05732c5f9b2d8f5d2c66d1cdcf793854">platoonLeaderID</a> == senderId;</div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>            <span class="keywordtype">bool</span> needPlatoonIdChange = isFromLeader &amp;&amp; (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a634f99de503cccb2f2d3cb955623dde2">currentPlatoonID</a> != platoonId);</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span> </div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>            <span class="keywordflow">if</span>(needPlatoonIdChange)</div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>            {</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>                <span class="comment">// TODO: better to have leader explicitly inform us that it is merging into another platoon, rather than require us to deduce it here.</span></div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>                <span class="comment">//       This condition may also result from missing some message traffic, new leader in this platoon, or other confusion/incorrect code.</span></div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>                <span class="comment">//       Consider using a new STATUS msg param that tells members of new platoon ID and new leader ID when a change is made.</span></div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;It seems that the current leader is joining another platoon.&quot;</span>);</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;So the platoon ID is changed from &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a634f99de503cccb2f2d3cb955623dde2">currentPlatoonID</a> &lt;&lt; <span class="stringliteral">&quot; to &quot;</span> &lt;&lt; platoonId);</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>                <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a634f99de503cccb2f2d3cb955623dde2">currentPlatoonID</a> = platoonId;</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>                <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a6b4eae07dfc95c25104f95fef1f0f344">updatesOrAddMemberInfo</a>(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>, senderId, cmdSpeed, dtDistance, ctDistance, curSpeed); </div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>            } </div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a634f99de503cccb2f2d3cb955623dde2">currentPlatoonID</a> == platoonId)</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>            {</div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;This STATUS messages is from our platoon. Updating the info...&quot;</span>);</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>                <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a6b4eae07dfc95c25104f95fef1f0f344">updatesOrAddMemberInfo</a>(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>, senderId, cmdSpeed, dtDistance, ctDistance, curSpeed);</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;The first vehicle in our list is now &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>[0].staticId);</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>            } </div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>            <span class="keywordflow">else</span> <span class="comment">//sender is in a different platoon</span></div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>            {</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;This STATUS message is not from a vehicle we care about. Ignore this message with id: &quot;</span> &lt;&lt; senderId);</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>            }</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>        }</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>        <span class="keywordflow">else</span> <span class="comment">//host is leader</span></div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>        {</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>            <span class="comment">// If we are currently in any leader state, we only update platoon member based on platoon ID</span></div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Host is leader: currentPlatoonID = &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a634f99de503cccb2f2d3cb955623dde2">currentPlatoonID</a> &lt;&lt; <span class="stringliteral">&quot;, incoming platoonId = &quot;</span> &lt;&lt; platoonId);</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a634f99de503cccb2f2d3cb955623dde2">currentPlatoonID</a> == platoonId)</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>            {</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;This STATUS messages is from our platoon. Updating the info...&quot;</span>);</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>                <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a6b4eae07dfc95c25104f95fef1f0f344">updatesOrAddMemberInfo</a>(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>, senderId, cmdSpeed, dtDistance, ctDistance, curSpeed); </div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>            }</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>            <span class="keywordflow">else</span></div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>            {</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Platoon IDs not matched&quot;</span>);</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;currentPlatoonID: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a634f99de503cccb2f2d3cb955623dde2">currentPlatoonID</a>);</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;incoming platoonId: &quot;</span> &lt;&lt; platoonId);</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>            }</div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>        }</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>        </div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>        <span class="comment">// update host vehicle information each time new member is updated. Now platoon contains host vehicle.</span></div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>        std::string hostStaticId = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ae696d79ca33f496082ef462fdc9ba53b">getHostStaticID</a>();</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>        <span class="keywordtype">double</span> hostcmdSpeed = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a10f95b2573ee211d8f9b07f8d7551809">getCommandSpeed</a>();</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>        <span class="keywordtype">double</span> hostDtD = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8f79bf82a5c6ba800fd48f9ed819f606">getCurrentDowntrackDistance</a>();</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>        <span class="keywordtype">double</span> hostCtD = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ac7017e74336d2270a0d66249a46c7dbb">getCurrentCrosstrackDistance</a>();</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>        <span class="keywordtype">double</span> hostCurSpeed = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ac123534207dc3ea247cfb1281426cd84">getCurrentSpeed</a>();</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>        <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a6b4eae07dfc95c25104f95fef1f0f344">updatesOrAddMemberInfo</a>(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>, hostStaticId, hostcmdSpeed, hostDtD, hostCtD, hostCurSpeed);</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>    }</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>    </div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>    <span class="comment">// Update/add one member&#39;s information from STATUS messages, update platoon ID if needed.  </span></div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno"><a class="line" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#aef18115269a340fb9e89452acd05658f">  157</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#aef18115269a340fb9e89452acd05658f">PlatoonManager::neighborMemberUpdates</a>(<span class="keyword">const</span> std::string&amp; senderId, <span class="keyword">const</span> std::string&amp; platoonId, <span class="keyword">const</span> std::string&amp; params, </div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>                                               <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; DtD, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; CtD)</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>    {</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span> </div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>        <span class="comment">// parse params, read member data</span></div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>        std::vector&lt;std::string&gt; inputsParams;</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>        <a class="code hl_variable" href="namespaceprocess__traj__logs.html#a3682477a3431f2a4aa182fb9a6439125">boost::algorithm::split</a>(inputsParams, params, boost::is_any_of(<span class="stringliteral">&quot;,&quot;</span>));</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>        <span class="comment">// read command speed, m/s</span></div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>        std::vector&lt;std::string&gt; cmd_parsed;</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>        <a class="code hl_variable" href="namespaceprocess__traj__logs.html#a3682477a3431f2a4aa182fb9a6439125">boost::algorithm::split</a>(cmd_parsed, inputsParams[0], boost::is_any_of(<span class="stringliteral">&quot;:&quot;</span>));</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>        <span class="keywordtype">double</span> cmdSpeed = std::stod(cmd_parsed[1]);</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>        <span class="comment">// get DtD directly instead of parsing message, m</span></div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>        <span class="keywordtype">double</span> dtDistance = DtD;</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>        <span class="comment">// get CtD directly </span></div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>        <span class="keywordtype">double</span> ctDistance = CtD;</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>        <span class="comment">// read current speed, m/s</span></div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>        std::vector&lt;std::string&gt; cur_parsed;</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>        <a class="code hl_variable" href="namespaceprocess__traj__logs.html#a3682477a3431f2a4aa182fb9a6439125">boost::algorithm::split</a>(cur_parsed, inputsParams[1], boost::is_any_of(<span class="stringliteral">&quot;:&quot;</span>));</div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>        <span class="keywordtype">double</span> curSpeed = std::stod(cur_parsed[1]);</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span> </div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0fadcff41a35df3fe821f05cc1452c45">neighborPlatoonID</a> == platoonId)</div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>        {</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>            <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a6b4eae07dfc95c25104f95fef1f0f344">updatesOrAddMemberInfo</a>(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a5810c2ddb1b317d7cd7a038615844185">neighbor_platoon_</a>, senderId, cmdSpeed, dtDistance, ctDistance, curSpeed);</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;This STATUS messages is from the target platoon. Updating the info...&quot;</span>);</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;The first vehicle in that platoon is now &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a5810c2ddb1b317d7cd7a038615844185">neighbor_platoon_</a>[0].staticId);</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span> </div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>            <span class="comment">// If we have data on all members of a neighboring platoon, set a complete record flag</span></div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a36f41aa23d9cc311f1d2b017a008d0ed">neighbor_platoon_info_size_</a> &gt; 1  &amp;&amp;</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>                <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a5810c2ddb1b317d7cd7a038615844185">neighbor_platoon_</a>.size() == <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a36f41aa23d9cc311f1d2b017a008d0ed">neighbor_platoon_info_size_</a>)</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>            {</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>                <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a8f2badbbe25d2b4d26e1556fa0aa63">is_neighbor_record_complete_</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Neighbor record is complete!&quot;</span>);</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>            }</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>        } </div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>        <span class="keywordflow">else</span> <span class="comment">//sender is in a different platoon</span></div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>        {</div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;This STATUS message is not from a vehicle we care about. Ignore this message from sender: &quot;</span> </div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>                            &lt;&lt; senderId &lt;&lt; <span class="stringliteral">&quot; about platoon: &quot;</span> &lt;&lt; platoonId);</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>        }</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>    }</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>    </div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>    <span class="comment">// Check a new vehicle&#39;s existence; add its info to the platoon if not in list, update info if already existed. </span></div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno"><a class="line" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a6b4eae07dfc95c25104f95fef1f0f344">  199</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a6b4eae07dfc95c25104f95fef1f0f344">PlatoonManager::updatesOrAddMemberInfo</a>(std::vector&lt;PlatoonMember&gt;&amp; platoon, std::string senderId, <span class="keywordtype">double</span> cmdSpeed,</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>                                                <span class="keywordtype">double</span> dtDistance, <span class="keywordtype">double</span> ctDistance, <span class="keywordtype">double</span> curSpeed)</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>    {</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>        <span class="keywordtype">bool</span> isExisted = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>        <span class="keywordtype">bool</span> sortNeeded = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span> </div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>        <span class="comment">// update/add this info into the list</span></div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> = 0;  <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> &lt; platoon.size();  ++<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>){</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>            <span class="keywordflow">if</span>(platoon[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>].staticId == senderId) {</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>                <span class="keywordflow">if</span> (abs(dtDistance - platoon[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>].vehiclePosition)/(platoon[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>].vehiclePosition + 0.01) &gt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a84be50afb79607448e76211608e3349e">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a02fc34016362627529e4c64fdb231b70">significantDTDchange</a>)</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>                {</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>),  <span class="stringliteral">&quot;DTD of member &quot;</span> &lt;&lt; platoon[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>].staticId &lt;&lt; <span class="stringliteral">&quot; is changed significantly, so a new sort is needed&quot;</span>);</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span> </div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>                    sortNeeded = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>                }</div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>                platoon[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>].commandSpeed = cmdSpeed;         <span class="comment">// m/s</span></div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>                platoon[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>].vehiclePosition = dtDistance;    <span class="comment">// m </span></div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>                platoon[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>].vehicleCrossTrack = ctDistance;  <span class="comment">// m</span></div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>                platoon[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>].vehicleSpeed = curSpeed;         <span class="comment">// m/s</span></div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>                platoon[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>].timestamp = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad8aa71d91ef94d4e8d52eca90f700a5b">timer_factory_</a>-&gt;now().nanoseconds()/1000000;</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Receive and update platooning info on member &quot;</span> &lt;&lt; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> &lt;&lt; <span class="stringliteral">&quot;, ID:&quot;</span> &lt;&lt; platoon[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>].staticId);</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;    CommandSpeed       = &quot;</span> &lt;&lt; platoon[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>].commandSpeed);</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;    Actual Speed       = &quot;</span> &lt;&lt; platoon[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>].vehicleSpeed);</div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;    Downtrack Location = &quot;</span> &lt;&lt; platoon[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>].vehiclePosition);</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;    Crosstrack dist    = &quot;</span> &lt;&lt; platoon[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>].vehicleCrossTrack);</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span> </div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>                <span class="keywordflow">if</span> (senderId == <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a54c4103e4b8705ee687effb030fb7040">HostMobilityId</a>)</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>                {</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>                    <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a822212181c90d3fa29f8a9aa513fab3f">hostPosInPlatoon_</a> = <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>;</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;    This is the HOST vehicle&quot;</span>);</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>                }</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>                isExisted = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>            }</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>        }</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span> </div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>        <span class="keywordflow">if</span> (sortNeeded)</div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>        {</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>            <span class="comment">// sort the platoon member based on dowtrack distance (m) in an descending order.</span></div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>            std::sort(std::begin(platoon), std::end(platoon), [](<span class="keyword">const</span> <a class="code hl_struct" href="structplatoon__strategic__ihp_1_1PlatoonMember.html">PlatoonMember</a> &amp;<a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a>, <span class="keyword">const</span> <a class="code hl_struct" href="structplatoon__strategic__ihp_1_1PlatoonMember.html">PlatoonMember</a> &amp;b){<span class="keywordflow">return</span> <a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a>.vehiclePosition &gt; b.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonMember.html#a142a9b209014ff3b5f08020bdc43f6c2">vehiclePosition</a>;});</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Platoon is re-sorted due to large difference in dtd update.&quot;</span>);</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;    Platoon order is now:&quot;</span>);</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> = 0;  <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> &lt; platoon.size();  ++<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>)</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>            {</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>                std::string hostFlag = <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>                <span class="keywordflow">if</span> (platoon[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>].staticId == <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ae696d79ca33f496082ef462fdc9ba53b">getHostStaticID</a>())</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>                {</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>                    <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a822212181c90d3fa29f8a9aa513fab3f">hostPosInPlatoon_</a> = <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>;</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>                    hostFlag = <span class="stringliteral">&quot;Host&quot;</span>;</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>                }</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;    &quot;</span> &lt;&lt; platoon[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>].staticId &lt;&lt; <span class="stringliteral">&quot;its DTD: &quot;</span> &lt;&lt; platoon[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>].vehiclePosition &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; hostFlag);</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>            }</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>        }</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span> </div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>        <span class="comment">// if not already exist, add to platoon list.</span></div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>        <span class="keywordflow">if</span>(!isExisted) {</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>            <span class="keywordtype">long</span> cur_t = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad8aa71d91ef94d4e8d52eca90f700a5b">timer_factory_</a>-&gt;now().nanoseconds()/1000000; <span class="comment">// time in millisecond</span></div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span> </div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>            <a class="code hl_struct" href="structplatoon__strategic__ihp_1_1PlatoonMember.html">PlatoonMember</a> newMember = <a class="code hl_struct" href="structplatoon__strategic__ihp_1_1PlatoonMember.html">PlatoonMember</a>(senderId, cmdSpeed, curSpeed, dtDistance, ctDistance, cur_t);</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>            platoon.push_back(newMember);</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>            <span class="comment">// sort the platoon member based on downtrack distance (m) in an descending order.</span></div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>            std::sort(std::begin(platoon), std::end(platoon), [](<span class="keyword">const</span> <a class="code hl_struct" href="structplatoon__strategic__ihp_1_1PlatoonMember.html">PlatoonMember</a> &amp;<a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a>, <span class="keyword">const</span> <a class="code hl_struct" href="structplatoon__strategic__ihp_1_1PlatoonMember.html">PlatoonMember</a> &amp;b){<span class="keywordflow">return</span> <a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a>.vehiclePosition &gt; b.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonMember.html#a142a9b209014ff3b5f08020bdc43f6c2">vehiclePosition</a>;});</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span> </div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Add a new vehicle into our platoon list &quot;</span> &lt;&lt; newMember.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonMember.html#af1c48353e45a30b01a1d59fdd1a19c9f">staticId</a> &lt;&lt; <span class="stringliteral">&quot; platoon.size now = &quot;</span> &lt;&lt; platoon.size());</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;    Platoon order is now:&quot;</span>);</div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> = 0;  <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> &lt; platoon.size();  ++<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>)</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>            {</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>                std::string hostFlag = <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>                <span class="keywordflow">if</span> (platoon[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>].staticId == <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ae696d79ca33f496082ef462fdc9ba53b">getHostStaticID</a>())</div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>                {</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>                    <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a822212181c90d3fa29f8a9aa513fab3f">hostPosInPlatoon_</a> = <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>;</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>                    hostFlag = <span class="stringliteral">&quot;Host&quot;</span>;</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>                }</div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;    &quot;</span> &lt;&lt; platoon[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>].staticId &lt;&lt; <span class="stringliteral">&quot;its DTD: &quot;</span> &lt;&lt; platoon[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>].vehiclePosition &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; hostFlag);</div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>            }</div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>        }</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>    }</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>    </div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>    <span class="comment">// TODO: Place holder for delete member info due to dissolve operation.</span></div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span> </div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>    <span class="comment">// Get the platoon size.</span></div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno"><a class="line" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a3ef30eeb7a7cf0caccb948e6a41f92">  279</a></span>    <span class="keywordtype">int</span> <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a3ef30eeb7a7cf0caccb948e6a41f92">PlatoonManager::getHostPlatoonSize</a>() {</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;host platoon size: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>.size());</div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>.size();</div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>    }</div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span> </div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>    <span class="comment">// Reset variables to indicate there is no current action in work</span></div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno"><a class="line" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#af2f0d9818d07db4a4df484f988635201">  285</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#af2f0d9818d07db4a4df484f988635201">PlatoonManager::clearActionPlan</a>()</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>    {</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a9474313cd68557978e8dbd481d0408bc">valid</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a34c7e7384914852c5549e8d2a14dc6e9">planId</a> = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ae067830e0351c8ba271b00cb4a6f15c1">dummyID</a>;</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a38851b8c1a54cc039c86fa3576c940e4">peerId</a> = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ae067830e0351c8ba271b00cb4a6f15c1">dummyID</a>;</div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#abc319b76af0eecaba8e0fe0718457618">targetPlatoonID</a> = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ae067830e0351c8ba271b00cb4a6f15c1">dummyID</a>;</div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>        <span class="comment">// Leave the platoon &amp; leader IDs alone since we might continue to be in one</span></div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>    }</div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span> </div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>    <span class="comment">// Reset variables to indicate there is no platoon - host is a solo vehicle again</span></div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno"><a class="line" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ab1c204db4a5056621de299a9dd663c6f">  295</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ab1c204db4a5056621de299a9dd663c6f">PlatoonManager::resetHostPlatoon</a>()</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>    {</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>        <span class="comment">// Remove any elements in the platoon vector other than the host vehicle</span></div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>.size() &gt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a822212181c90d3fa29f8a9aa513fab3f">hostPosInPlatoon_</a> + 1)</div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>        {</div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>.erase(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>.begin() + <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a822212181c90d3fa29f8a9aa513fab3f">hostPosInPlatoon_</a> + 1, <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>.end());</div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>        }</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>.erase(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>.begin(), <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>.begin() + <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a822212181c90d3fa29f8a9aa513fab3f">hostPosInPlatoon_</a>);</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span> </div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>        <span class="comment">// Clean up other variables</span></div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a634f99de503cccb2f2d3cb955623dde2">currentPlatoonID</a> = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ae067830e0351c8ba271b00cb4a6f15c1">dummyID</a>;</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a05732c5f9b2d8f5d2c66d1cdcf793854">platoonLeaderID</a> = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ae067830e0351c8ba271b00cb4a6f15c1">dummyID</a>;</div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a822212181c90d3fa29f8a9aa513fab3f">hostPosInPlatoon_</a> = 0;</div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0dfb4a15be2cf69ca770fcde1bdf65f5">isCreateGap</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a5f0e8506da98a7cb29aca9750e310319">dynamic_leader_index_</a> = 0;</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>    }</div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span> </div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>    <span class="comment">// Reset variables to indicate there is no known neighbor platoon</span></div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno"><a class="line" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#abca93088e8980c97a1a24c4fff31c758">  313</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#abca93088e8980c97a1a24c4fff31c758">PlatoonManager::resetNeighborPlatoon</a>()</div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>    {</div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a5810c2ddb1b317d7cd7a038615844185">neighbor_platoon_</a>.clear();</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span>        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a36f41aa23d9cc311f1d2b017a008d0ed">neighbor_platoon_info_size_</a> = 0;</div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0fadcff41a35df3fe821f05cc1452c45">neighborPlatoonID</a> = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ae067830e0351c8ba271b00cb4a6f15c1">dummyID</a>;</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8fa6576577e52bb8e1a31fef457defa9">neighbor_platoon_leader_id_</a> = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ae067830e0351c8ba271b00cb4a6f15c1">dummyID</a>;</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a8f2badbbe25d2b4d26e1556fa0aa63">is_neighbor_record_complete_</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>    }</div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span> </div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno"><a class="line" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a26f10c9b0d02a6c0a37228583a0385a1">  322</a></span>    <span class="keywordtype">bool</span> <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a26f10c9b0d02a6c0a37228583a0385a1">PlatoonManager::removeMember</a>(<span class="keyword">const</span> <span class="keywordtype">size_t</span> mem)</div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>    {</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>        <span class="comment">// Don&#39;t remove ourselves!</span></div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a822212181c90d3fa29f8a9aa513fab3f">hostPosInPlatoon_</a> == mem)</div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>        {</div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>        }</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span> </div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span>        <span class="comment">// Don&#39;t remove a member that isn&#39;t there</span></div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>.size() &lt;= 1  ||  mem &gt;= <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>.size())</div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>        {</div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>        }</div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span> </div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>        <span class="keywordflow">if</span> (mem &lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a822212181c90d3fa29f8a9aa513fab3f">hostPosInPlatoon_</a>)</div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>        {</div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>            --<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a822212181c90d3fa29f8a9aa513fab3f">hostPosInPlatoon_</a>;</div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>        }</div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>.erase(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>.begin() + mem, <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>.begin() + mem + 1);</div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span> </div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>        <span class="comment">// If host is the only remaining member then clean up the other platoon data</span></div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>.size() == 1)</div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span>        {</div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a634f99de503cccb2f2d3cb955623dde2">currentPlatoonID</a> = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ae067830e0351c8ba271b00cb4a6f15c1">dummyID</a>;</div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a05732c5f9b2d8f5d2c66d1cdcf793854">platoonLeaderID</a> = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ae067830e0351c8ba271b00cb4a6f15c1">dummyID</a>;</div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a822212181c90d3fa29f8a9aa513fab3f">hostPosInPlatoon_</a> = 0;</div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span>        }</div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span> </div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>    }</div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span> </div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno"><a class="line" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a4a6ad6000ba1d8598e0eb7dc8e0be76b">  353</a></span>    <span class="keywordtype">bool</span> <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a4a6ad6000ba1d8598e0eb7dc8e0be76b">PlatoonManager::removeMemberById</a>(<span class="keyword">const</span> std::string <span class="keywordtype">id</span>)</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span>    {</div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>        <span class="comment">// Don&#39;t remove ourselves!</span></div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>        <span class="keywordflow">if</span> (<span class="keywordtype">id</span>.compare(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a54c4103e4b8705ee687effb030fb7040">HostMobilityId</a>) == 0)</div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>        {</div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>        }</div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span> </div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>        <span class="comment">// Search for the member with a matching ID and remove it</span></div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> m = 0;  m &lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>.size();  ++m)</div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span>        {</div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>            <span class="keywordflow">if</span> (<span class="keywordtype">id</span>.compare(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>[m].staticId) == 0)</div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>            {</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a26f10c9b0d02a6c0a37228583a0385a1">removeMember</a>(m);</div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>            }</div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>        }</div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span> </div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>        <span class="comment">// Indicate the member was not found</span></div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>    }</div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>        </div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>    <span class="comment">// Find the downtrack distance of the last vehicle of the platoon, in m.    </span></div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno"><a class="line" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a83ecd30ec7e2f7eb15c93075c8eca436">  375</a></span>    <span class="keywordtype">double</span> <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a83ecd30ec7e2f7eb15c93075c8eca436">PlatoonManager::getPlatoonRearDowntrackDistance</a>(){</div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span>        <span class="comment">// due to downtrack descending order, the 1ast vehicle in list is the platoon rear vehicle.</span></div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>        <span class="comment">// Even if host is solo, platoon size is 1 so this works.</span></div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>[<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>.size()-1].vehiclePosition;</div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>    }</div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span> </div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>    <span class="comment">// Find the downtrack distance of the first vehicle of the platoon, in m.</span></div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno"><a class="line" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#aac57cfc07168101835015859c9c7e48e">  382</a></span>    <span class="keywordtype">double</span> <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#aac57cfc07168101835015859c9c7e48e">PlatoonManager::getPlatoonFrontDowntrackDistance</a>(){</div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>        <span class="comment">// due to downtrack descending order, the firest vehicle in list is the platoon front vehicle. </span></div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>[0].vehiclePosition;</div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>    }</div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span> </div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>    <span class="comment">// Return the dynamic leader (i.e., the vehicle to follow) of the host vehicle.</span></div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno"><a class="line" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a26b94722e82060dda554ef168626727c">  388</a></span>    <a class="code hl_struct" href="structplatoon__strategic__ihp_1_1PlatoonMember.html">PlatoonMember</a> <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a26b94722e82060dda554ef168626727c">PlatoonManager::getDynamicLeader</a>(){</div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>        <a class="code hl_struct" href="structplatoon__strategic__ihp_1_1PlatoonMember.html">PlatoonMember</a> dynamicLeader;</div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;host_platoon_ size: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>.size());</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a9fb744eaf988b3082397c736de1006ab">isFollower</a>) </div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>        {</div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Leader initially set as first vehicle in platoon&quot;</span>);</div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span>            <span class="comment">// return the first vehicle in the platoon as default if no valid algorithm applied</span></div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span>            <span class="comment">// due to downtrack descending order, the platoon front veihcle is the first in list. </span></div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>            dynamicLeader = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>[0];</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a54ddd0a10d8be526c0503f3981c60456">algorithmType_</a> == <span class="stringliteral">&quot;APF_ALGORITHM&quot;</span>){</div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span>                <span class="keywordtype">size_t</span> newLeaderIndex = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a5fa3ab8c7c127c9d76f0dce1be59fe80">allPredecessorFollowing</a>();</div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span> </div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span>                <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a5f0e8506da98a7cb29aca9750e310319">dynamic_leader_index_</a> = (<a class="code hl_class" href="classint.html">int</a>)newLeaderIndex;</div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;dynamic_leader_index_: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a5f0e8506da98a7cb29aca9750e310319">dynamic_leader_index_</a>);</div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span>                <span class="keywordflow">if</span>(newLeaderIndex &lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>.size()) { <span class="comment">//this must always be true!</span></div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span>                    dynamicLeader = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>[newLeaderIndex];</div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;APF output: &quot;</span> &lt;&lt; dynamicLeader.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonMember.html#af1c48353e45a30b01a1d59fdd1a19c9f">staticId</a>);</div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>                    <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a139f10b9de2c9682c17c72115679052a">previousFunctionalDynamicLeaderIndex_</a> = newLeaderIndex;</div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span>                    <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a5b694b6fdc9f0a3d7391a3e5ae11e623">previousFunctionalDynamicLeaderID_</a> = dynamicLeader.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonMember.html#af1c48353e45a30b01a1d59fdd1a19c9f">staticId</a>;</div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span>                }</div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span>                <span class="keywordflow">else</span> <span class="comment">//something is terribly wrong in the logic!</span></div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>                {</div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span>                    RCLCPP_WARN_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;newLeaderIndex = &quot;</span> &lt;&lt; newLeaderIndex &lt;&lt; <span class="stringliteral">&quot; is invalid coming from allPredecessorFollowing!&quot;</span>);</div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>                    dynamicLeader = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>[<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a1de160740f47d9b0198e42dcbe67a6fe">getNumberOfVehicleInFront</a>() - 1];</div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>                    <span class="comment">// update index and ID </span></div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>                    <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a139f10b9de2c9682c17c72115679052a">previousFunctionalDynamicLeaderIndex_</a> = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a1de160740f47d9b0198e42dcbe67a6fe">getNumberOfVehicleInFront</a>()-1;</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>                    <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a5b694b6fdc9f0a3d7391a3e5ae11e623">previousFunctionalDynamicLeaderID_</a> = dynamicLeader.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonMember.html#af1c48353e45a30b01a1d59fdd1a19c9f">staticId</a>;</div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Based on the output of APF algorithm we start to follow our predecessor.&quot;</span>);</div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>                }</div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>            }</div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>        }</div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>        <span class="keywordflow">return</span> dynamicLeader;</div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span> </div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>    }</div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span> </div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>    <span class="comment">// The implementation of all predecessor following algorithm. Determine the dynamic leader for the host vehicle to follow.</span></div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno"><a class="line" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a5fa3ab8c7c127c9d76f0dce1be59fe80">  428</a></span>    <span class="keywordtype">int</span> <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a5fa3ab8c7c127c9d76f0dce1be59fe80">PlatoonManager::allPredecessorFollowing</a>(){</div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span> </div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>        <span class="comment">// If the host vehicle is the second follower of a platoon, it will always follow the platoon leader in the front </span></div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>        <span class="keywordflow">if</span>(<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a1de160740f47d9b0198e42dcbe67a6fe">getNumberOfVehicleInFront</a>() == 1)</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>        {</div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>            <span class="comment">// If the host is the second vehicle, then follow the leader.</span></div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;As the second vehicle in the platoon, it will always follow the leader. Case Zero&quot;</span>);</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>        }</div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span>        <span class="comment">// If there weren&#39;t a leader in the previous time step, follow the first vehicle (i.e., the platoon leader) as default.</span></div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a5b694b6fdc9f0a3d7391a3e5ae11e623">previousFunctionalDynamicLeaderID_</a> == <span class="stringliteral">&quot;&quot;</span>) {</div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;APF algorithm did not found a dynamic leader in previous time step. Case one&quot;</span>);</div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span>            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>        }</div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span> </div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>        <span class="comment">//***** Formulate speed and downtrack vector *****//</span></div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>        <span class="comment">// Update host vehicle info when update member info, so platoon list include host vehicle, direct use platoon size for downtrack/speed vector.</span></div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span>        <span class="comment">// Record downtrack distance (m) of each member</span></div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span>        std::vector&lt;double&gt; downtrackDistance(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a822212181c90d3fa29f8a9aa513fab3f">hostPosInPlatoon_</a>);</div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span>        <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> = 0; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> &lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a822212181c90d3fa29f8a9aa513fab3f">hostPosInPlatoon_</a>; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>++) {</div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span>            downtrackDistance[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>] = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>].vehiclePosition; <span class="comment">// m</span></div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span>        }</div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span>        <span class="comment">// Record speed (m/s) of each member</span></div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>        std::vector&lt;double&gt; speed(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>.size());</div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span>        <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> = 0; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> &lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>.size(); <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>++) {</div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span>            speed[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>] = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>].vehicleSpeed; <span class="comment">// m/s</span></div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>        }</div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>        </div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span> </div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>        <span class="comment">// If the distance headway between the subject vehicle and its predecessor is an issue</span></div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span>        <span class="comment">// according to the &quot;min_gap&quot; and &quot;max_gap&quot; thresholds, then it should follow its predecessor</span></div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span>        <span class="comment">// The following line will not throw exception because the length of downtrack array is larger than two in this case</span></div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span>        <span class="keywordtype">double</span> distHeadwayWithPredecessor = downtrackDistance[<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a822212181c90d3fa29f8a9aa513fab3f">hostPosInPlatoon_</a> - 1] - downtrackDistance[<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a822212181c90d3fa29f8a9aa513fab3f">hostPosInPlatoon_</a>];</div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span>        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0ade0fd8797f0e76b16846cb1b0cb951">gapWithPred_</a> = distHeadwayWithPredecessor;</div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>        <span class="keywordflow">if</span>(<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ab6bac9590984959b2a6988c329090235">insufficientGapWithPredecessor</a>(distHeadwayWithPredecessor)) {</div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;APF algorithm decides there is an issue with the gap with preceding vehicle: &quot;</span> &lt;&lt; distHeadwayWithPredecessor &lt;&lt; <span class="stringliteral">&quot; m. Case Two&quot;</span>);</div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span>            <span class="keywordflow">return</span> <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a822212181c90d3fa29f8a9aa513fab3f">hostPosInPlatoon_</a> - 1;</div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span>        }</div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span>        <span class="keywordflow">else</span>{</div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>            <span class="comment">// implementation of the main part of APF algorithm</span></div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span>            <span class="comment">// calculate the time headway between every consecutive pair of vehicles</span></div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span>            std::vector&lt;double&gt; timeHeadways = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#aea48de69a49b77ff87145342a0790363">calculateTimeHeadway</a>(downtrackDistance, speed);</div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;APF calculate time headways: &quot;</span> );</div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span>            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code hl_variable" href="pointer_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a> : timeHeadways)</div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span>            {</div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;APF time headways: &quot;</span> &lt;&lt; <a class="code hl_variable" href="pointer_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a>);</div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span>            }</div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;APF found the previous dynamic leader is &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a5b694b6fdc9f0a3d7391a3e5ae11e623">previousFunctionalDynamicLeaderID_</a>);</div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span>            <span class="comment">// if the previous dynamic leader is the first vehicle in the platoon</span></div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span>            </div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a139f10b9de2c9682c17c72115679052a">previousFunctionalDynamicLeaderIndex_</a> == 0) {</div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span> </div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span>                <span class="comment">// If there is a violation, the return value is the desired dynamic leader index</span></div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;APF use violations on lower boundary or maximum spacing to choose dynamic leader. Case Three.&quot;</span>);</div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span>                <span class="keywordflow">return</span> <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a24583fcb6596efbb2772001a58c36588">determineDynamicLeaderBasedOnViolation</a>(timeHeadways);</div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span>            }</div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span>            <span class="keywordflow">else</span>{</div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span>                <span class="comment">// if the previous dynamic leader is not the first vehicle</span></div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span>                <span class="comment">// get the time headway between every consecutive pair of vehicles from index Of Previous dynamic Leader</span></div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span>                std::vector&lt;double&gt; partialTimeHeadways = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#addb3708590b81f46b27e612b6e945cea">getTimeHeadwayFromIndex</a>(timeHeadways, <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a139f10b9de2c9682c17c72115679052a">previousFunctionalDynamicLeaderIndex_</a>);</div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span>                <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code hl_variable" href="pointer_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a> : partialTimeHeadways)</div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>                {</div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;APF partial time headways: &quot;</span> &lt;&lt; <a class="code hl_variable" href="pointer_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a>);</div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span>                }</div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span>                <span class="keywordtype">int</span> closestLowerBoundaryViolation = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ae747d7f17a417d2fa30227d71925489d">findLowerBoundaryViolationClosestToTheHostVehicle</a>(partialTimeHeadways);</div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span>                <span class="keywordtype">int</span> closestMaximumSpacingViolation = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a10ff5ed73a7a5f72b96fc5b1a928bfe3">findMaximumSpacingViolationClosestToTheHostVehicle</a>(partialTimeHeadways);</div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span>                <span class="comment">// if there are no violations anywhere between the subject vehicle and the current dynamic leader,</span></div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span>                <span class="comment">// then depending on the time headways of the ENTIRE platoon, the subject vehicle may switch</span></div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span>                <span class="comment">// dynamic leader further downstream. This is because the subject vehicle has determined that there are</span></div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span>                <span class="comment">// no time headways between itself and the current dynamic leader which would cause the platoon to be unsafe.</span></div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span>                <span class="comment">// if there are violations somewhere betweent the subject vehicle and the current dynamic leader,</span></div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span>                <span class="comment">// then rather than assigning dynamic leadership further DOWNSTREAM, we must go further UPSTREAM in the following lines</span></div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span>                <span class="keywordflow">if</span>(closestLowerBoundaryViolation == -1 &amp;&amp; closestMaximumSpacingViolation == -1) {</div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span>                    <span class="comment">// In order for the subject vehicle to assign dynamic leadership further downstream,</span></div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span>                    <span class="comment">// two criteria must be satisfied: first the leading vehicle and its immediate follower must</span></div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span>                    <span class="comment">// have a time headway greater than &quot;upper_boundary.&quot; The purpose of this criteria is to</span></div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span>                    <span class="comment">// introduce a hysteresis in order to eliminate the possibility of a vehicle continually switching back </span></div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span>                    <span class="comment">// and forth between two dynamic leaders because one of the time headways is hovering right around</span></div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span>                    <span class="comment">// the &quot;lower_boundary&quot; threshold; second the leading vehicle and its predecessor must have</span></div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span>                    <span class="comment">// a time headway less than &quot;min_spacing&quot; second. Just as with &quot;upper_boundary&quot;, &quot;min_spacing&quot; exists to</span></div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span>                    <span class="comment">// introduce a hysteresis where dynamic leaders are continually being switched.</span></div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span>                    <span class="keywordtype">bool</span> condition1 = timeHeadways[<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a139f10b9de2c9682c17c72115679052a">previousFunctionalDynamicLeaderIndex_</a>] &gt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a84be50afb79607448e76211608e3349e">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a86f41d2a717f645e273182875afee435">headawayStableLowerBond</a>; </div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span>                    <span class="keywordtype">bool</span> condition2 = timeHeadways[<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a139f10b9de2c9682c17c72115679052a">previousFunctionalDynamicLeaderIndex_</a> - 1] &lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a84be50afb79607448e76211608e3349e">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a75c1cc22d698c88b0772ffa7c664dd24">headawayStableUpperBond</a>; </div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span>                    </div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span>                    <span class="comment">//we may switch dynamic leader further downstream</span></div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>                    <span class="keywordflow">if</span>(condition1 &amp;&amp; condition2) {</div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span>                        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;APF found two conditions for assigning local dynamic leadership further downstream are satisfied. Case Four&quot;</span>);</div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span>                        <span class="keywordflow">return</span> <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a24583fcb6596efbb2772001a58c36588">determineDynamicLeaderBasedOnViolation</a>(timeHeadways);</div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span>                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span>                        </div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span>                        <span class="comment">// We may not switch dynamic leadership to another vehicle further downstream because some criteria are not satisfied</span></div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span>                        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;APF found two conditions for assigning local dynamic leadership further downstream are not satisfied. Case Five.&quot;</span>);</div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span>                        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;condition1: &quot;</span> &lt;&lt; condition1 &lt;&lt; <span class="stringliteral">&quot; &amp; condition2: &quot;</span> &lt;&lt; condition2);</div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span>                        <span class="keywordflow">return</span> <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a139f10b9de2c9682c17c72115679052a">previousFunctionalDynamicLeaderIndex_</a>;</div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span>                    }</div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>                } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(closestLowerBoundaryViolation != -1 &amp;&amp; closestMaximumSpacingViolation == -1) {</div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>                    <span class="comment">// The rest four cases have roughly the same logic: locate the closest violation and assign dynamic leadership accordingly</span></div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>                    </div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;APF found closestLowerBoundaryViolation on partial time headways. Case Six.&quot;</span>);</div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span>                    <span class="keywordflow">return</span> <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a139f10b9de2c9682c17c72115679052a">previousFunctionalDynamicLeaderIndex_</a> - 1 + closestLowerBoundaryViolation;</div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span> </div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span>                } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(closestLowerBoundaryViolation == -1 &amp;&amp; closestMaximumSpacingViolation != -1) {</div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span>                    </div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;APF found closestMaximumSpacingViolation on partial time headways. Case Seven.&quot;</span>);</div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>                    <span class="keywordflow">return</span> <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a139f10b9de2c9682c17c72115679052a">previousFunctionalDynamicLeaderIndex_</a> + closestMaximumSpacingViolation;</div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span>                } <span class="keywordflow">else</span>{</div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;APF found closestMaximumSpacingViolation and closestLowerBoundaryViolation on partial time headways.&quot;</span>);</div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span>                    <span class="keywordflow">if</span>(closestLowerBoundaryViolation &gt; closestMaximumSpacingViolation) {</div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span>                        </div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span>                        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;closest LowerBoundaryViolation is higher than closestMaximumSpacingViolation on partial time headways. Case Eight.&quot;</span>);</div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span>                        <span class="keywordflow">return</span> <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a139f10b9de2c9682c17c72115679052a">previousFunctionalDynamicLeaderIndex_</a> - 1 + closestLowerBoundaryViolation;</div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span>                    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(closestLowerBoundaryViolation &lt; closestMaximumSpacingViolation) {</div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span>                        </div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span>                        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;closestMaximumSpacingViolation is higher than closestLowerBoundaryViolation on partial time headways. Case Nine.&quot;</span>);</div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span>                        <span class="keywordflow">return</span> <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a139f10b9de2c9682c17c72115679052a">previousFunctionalDynamicLeaderIndex_</a> + closestMaximumSpacingViolation;</div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span>                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span>                        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;APF dynamic Leader selection parameter is wrong!&quot;</span>);</div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span>                        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span>                    }</div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span>                }</div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span>            }</div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span> </div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span>        }</div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span>    }</div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span> </div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span>    <span class="comment">// Find the time headaway (s) sub-list based on the platoon wise comprehensive time headaway list, starting index is indicated by the parameter: &quot;start&quot;. </span></div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno"><a class="line" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#addb3708590b81f46b27e612b6e945cea">  564</a></span>    std::vector&lt;double&gt; <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#addb3708590b81f46b27e612b6e945cea">PlatoonManager::getTimeHeadwayFromIndex</a>(std::vector&lt;double&gt; timeHeadways, <span class="keywordtype">int</span> start)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span>        std::vector&lt;double&gt; result(timeHeadways.begin() + start-1, timeHeadways.end());</div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span>        <span class="keywordflow">return</span> result;</div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span>    }</div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span>    </div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span>    <span class="comment">// Determine if the gap (m) between host and predecessor is big enough, with regards to minGap_ (m) and maxGap_ (m).</span></div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno"><a class="line" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ab6bac9590984959b2a6988c329090235">  570</a></span>    <span class="keywordtype">bool</span> <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ab6bac9590984959b2a6988c329090235">PlatoonManager::insufficientGapWithPredecessor</a>(<span class="keywordtype">double</span> distanceToPredVehicle) {</div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span>        </div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span>        <span class="comment">// For normal operation, gap &gt; minGap is necessary. </span></div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span>        <span class="keywordtype">bool</span> frontGapIsTooSmall = distanceToPredVehicle &lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a84be50afb79607448e76211608e3349e">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a48ef7a059feb15a64cb77e29b76eb2b1">minCutinGap</a>; </div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span>        </div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span>        <span class="comment">// Host vehicle was following predecessor vehicle. --&gt; The predecessor vehicle was violating gap threshold.</span></div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span>        <span class="keywordtype">bool</span> previousLeaderIsPredecessor = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a5b694b6fdc9f0a3d7391a3e5ae11e623">previousFunctionalDynamicLeaderID_</a> == <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>[<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>.size() - 1].staticId; </div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span>        </div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span>        <span class="comment">// Gap greater than maxGap_ is necessary for host to stop choosing predecessor as dynamic leader. </span></div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span>        <span class="keywordtype">bool</span> frontGapIsNotLargeEnough = distanceToPredVehicle &lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a84be50afb79607448e76211608e3349e">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a2c210ff37063f1c702ddec0d454238b2">maxCutinGap</a> &amp;&amp; previousLeaderIsPredecessor;</div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span> </div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span>        <span class="keywordflow">return</span> (frontGapIsTooSmall || frontGapIsNotLargeEnough);</div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span>    }</div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span> </div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span>    <span class="comment">// Calculate the time headway (s) behind each vehicle of the platoon. If no one behind or following car stoped, return infinity.</span></div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno"><a class="line" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#aea48de69a49b77ff87145342a0790363">  585</a></span>    std::vector&lt;double&gt; <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#aea48de69a49b77ff87145342a0790363">PlatoonManager::calculateTimeHeadway</a>(std::vector&lt;double&gt; downtrackDistance, std::vector&lt;double&gt; speed)<span class="keyword"> const</span>{</div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span>        std::vector&lt;double&gt; timeHeadways(downtrackDistance.size() - 1);</div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span>        <span class="comment">// Due to downtrack descending order, the platoon member with smaller index has larger downtrack, hence closer to the front of the platoon.</span></div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> = 0; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> &lt; timeHeadways.size(); <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>++){</div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span>            <span class="comment">// Calculate time headaway between the vehicle behind. </span></div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span>            <span class="keywordflow">if</span> (speed[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>+1] &gt;= <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a84be50afb79607448e76211608e3349e">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a0219322f3dd8e56a7be6681e4c77708d">ss_theta</a>) <span class="comment">// speed is in m/s</span></div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span>            {</div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span>                timeHeadways[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>] = (downtrackDistance[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>] - downtrackDistance[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>+1]) / speed[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>+1]; <span class="comment">// downtrack is in m, speed is in m/s.</span></div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span>            }</div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span>            <span class="comment">// If no one behind or following car stoped, return infinity. </span></div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span>            <span class="keywordflow">else</span></div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span>            {</div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span>                timeHeadways[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>] = std::numeric_limits&lt;double&gt;::infinity();</div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span>            }</div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span>        }</div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>        <span class="keywordflow">return</span> timeHeadways; <span class="comment">// time is in s.</span></div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span>    }</div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span> </div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span>    <span class="comment">// Determine the dynamic leader ID based on gap threshold violation&#39;s index.</span></div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno"><a class="line" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a24583fcb6596efbb2772001a58c36588">  604</a></span>    <span class="keywordtype">int</span> <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a24583fcb6596efbb2772001a58c36588">PlatoonManager::determineDynamicLeaderBasedOnViolation</a>(std::vector&lt;double&gt; timeHeadways){</div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>        </div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span>        <span class="comment">// Find the closest violations. </span></div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span>        <span class="keywordtype">int</span> closestLowerBoundaryViolation = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ae747d7f17a417d2fa30227d71925489d">findLowerBoundaryViolationClosestToTheHostVehicle</a>(timeHeadways);</div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span>        <span class="keywordtype">int</span> closestMaximumSpacingViolation = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a10ff5ed73a7a5f72b96fc5b1a928bfe3">findMaximumSpacingViolationClosestToTheHostVehicle</a>(timeHeadways);</div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span>        </div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span>        <span class="comment">// Compare the violation locations, always following the closer violation vehicle (larger index) first, then the furthur ones.</span></div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span>        <span class="keywordflow">if</span>(closestLowerBoundaryViolation &gt; closestMaximumSpacingViolation) {</div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;APF found violation on closestLowerBoundaryViolation at &quot;</span> &lt;&lt; closestLowerBoundaryViolation);</div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span>            <span class="keywordflow">return</span> closestLowerBoundaryViolation; <span class="comment">// Min violation, following the vehicle that is in font of the violating gap.</span></div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span>        } </div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(closestLowerBoundaryViolation &lt; closestMaximumSpacingViolation){</div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;APF found violation on closestMaximumSpacingViolation at &quot;</span> &lt;&lt; closestMaximumSpacingViolation);</div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span>            <span class="keywordflow">return</span> closestMaximumSpacingViolation + 1; <span class="comment">// Max violation, follow the vehicle that is behinf the violating gap.</span></div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span>        }</div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span>        <span class="keywordflow">else</span>{</div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;APF found no violations on both closestLowerBoundaryViolation and closestMaximumSpacingViolation&quot;</span>);</div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span>        }</div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span>    }</div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span> </div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>    <span class="comment">// Find the lower boundary violation vehicle that closest to the host vehicle. If no violation found, return -1.</span></div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno"><a class="line" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ae747d7f17a417d2fa30227d71925489d">  639</a></span>    <span class="keywordtype">int</span> <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ae747d7f17a417d2fa30227d71925489d">PlatoonManager::findLowerBoundaryViolationClosestToTheHostVehicle</a>(std::vector&lt;double&gt; timeHeadways)<span class="keyword"> const</span>{</div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span>        <span class="comment">// Due to descending downtrack order, the search starts from the platoon rear, which corresponds to last in list.</span></div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> = timeHeadways.size()-1; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> &gt;= 0; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>--) {</div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span>            <span class="keywordflow">if</span>(timeHeadways[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>] &lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a84be50afb79607448e76211608e3349e">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a674f088482c677e215b4842b9b8552f5">minAllowableHeadaway</a>)  <span class="comment">// in s</span></div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span>            {</div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span>                <span class="keywordflow">return</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>;</div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span>            }</div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span>        }</div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span>    }</div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span>    </div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span>    <span class="comment">// Find the maximum spacing violation vehicle that closest to the host vehicle. If no violation found, return -1.</span></div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno"><a class="line" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a10ff5ed73a7a5f72b96fc5b1a928bfe3">  651</a></span>    <span class="keywordtype">int</span> <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a10ff5ed73a7a5f72b96fc5b1a928bfe3">PlatoonManager::findMaximumSpacingViolationClosestToTheHostVehicle</a>(std::vector&lt;double&gt; timeHeadways)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span>        <span class="comment">// UCLA: Add maxAllowableHeadaway adjuster to increase the threshold during gap creating period.</span></div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span>        <span class="keywordtype">double</span> maxAllowableHeadaway_adjusted = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a84be50afb79607448e76211608e3349e">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#af3ea8d899c219ad4793f649a566fe6e8">maxAllowableHeadaway</a>;</div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno">  654</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0dfb4a15be2cf69ca770fcde1bdf65f5">isCreateGap</a>) {</div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span>            <span class="comment">// adjust maximum allowed headway to allow for a bigger gap </span></div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span>            maxAllowableHeadaway_adjusted = maxAllowableHeadaway_adjusted*(1 + <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a84be50afb79607448e76211608e3349e">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a52907b228ff49305bd3c1e6977a1dac4">createGapAdjuster</a>);</div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span>            } </div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span>        </div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span>        <span class="comment">//  Due to descending downtrack order, the search starts from the platoon rear, which corresponds to last in list.</span></div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> = timeHeadways.size()-1; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> &gt;= 0 ; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>--) {</div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span>            <span class="keywordflow">if</span>(timeHeadways[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>] &gt; maxAllowableHeadaway_adjusted) <span class="comment">// in s</span></div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span>            {</div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span>                <span class="keywordflow">return</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>;</div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span>            }</div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span>        }</div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span>    }</div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span> </div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span>    <span class="comment">// Change the local platoon manager from follower operation state to leader operation state for single vehicle status change. </span></div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span>    <span class="comment">// This could happen because host is 2nd in line and leader is departing, or because APF algorithm decided host&#39;s gap is too</span></div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span>    <span class="comment">// large and we need to separate from front part of platoon.</span></div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno"><a class="line" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#af80fc61208f8a6e2efefdcfcc37ce980">  672</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#af80fc61208f8a6e2efefdcfcc37ce980">PlatoonManager::changeFromFollowerToLeader</a>() {</div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span>        </div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span>        <span class="comment">// Get current host info - assumes departing leader or front of platoon hasn&#39;t already been removed from the vector</span></div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno">  675</span>        <a class="code hl_struct" href="structplatoon__strategic__ihp_1_1PlatoonMember.html">PlatoonMember</a> hostInfo = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>[<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a822212181c90d3fa29f8a9aa513fab3f">hostPosInPlatoon_</a>];</div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span>        </div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span>        <span class="comment">// Clear the front part of the platoon info, since we are splitting off from it; leaves host as element 0</span></div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a822212181c90d3fa29f8a9aa513fab3f">hostPosInPlatoon_</a> &gt; 0)</div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span>        {</div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>.erase(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>.begin(), <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>.begin() + <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a822212181c90d3fa29f8a9aa513fab3f">hostPosInPlatoon_</a>);</div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span>        }<span class="keywordflow">else</span></div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span>        {</div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span>            RCLCPP_WARN(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;### Host becoming leader, but is already at index 0 in host_platoon_ vector!  Vector unchanged.&quot;</span>);</div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span>        }</div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno">  685</span> </div>
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno">  686</span>        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a822212181c90d3fa29f8a9aa513fab3f">hostPosInPlatoon_</a> = 0;</div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span>        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a9fb744eaf988b3082397c736de1006ab">isFollower</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span>        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a634f99de503cccb2f2d3cb955623dde2">currentPlatoonID</a> = <a class="code hl_function" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5">boost::uuids::to_string</a>(boost::uuids::random_generator()());</div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span>        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a5b694b6fdc9f0a3d7391a3e5ae11e623">previousFunctionalDynamicLeaderID_</a> = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span>        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a139f10b9de2c9682c17c72115679052a">previousFunctionalDynamicLeaderIndex_</a> = -1;</div>
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;The platoon manager is changed from follower state to leader state. New platoon ID = &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a634f99de503cccb2f2d3cb955623dde2">currentPlatoonID</a>);</div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span>    }</div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno">  693</span> </div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span>    <span class="comment">// Change the local platoon manager from leader operation state to follower operation state for single vehicle status change.</span></div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span>    <span class="comment">// This could happen because another vehicle did a front join and host is now 2nd in line, or because host was a solo vehicle</span></div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno">  696</span>    <span class="comment">// that just completed joining a platoon at any position.</span></div>
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno">  697</span>    <span class="comment">// Note: The platoon list will be firstly reset to only include the new leader and the host, then allowed to gradually repopulate via</span></div>
<div class="line"><a id="l00698" name="l00698"></a><span class="lineno">  698</span>    <span class="comment">// updateMembers() as new MobilityOperation messages come in.</span></div>
<div class="line"><a id="l00699" name="l00699"></a><span class="lineno"><a class="line" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#aa589c920c9684b42bf8f675c072ddb6b">  699</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#aa589c920c9684b42bf8f675c072ddb6b">PlatoonManager::changeFromLeaderToFollower</a>(std::string newPlatoonId, std::string newLeaderId) {</div>
<div class="line"><a id="l00700" name="l00700"></a><span class="lineno">  700</span>        </div>
<div class="line"><a id="l00701" name="l00701"></a><span class="lineno">  701</span>        <span class="comment">// Save the current host info</span></div>
<div class="line"><a id="l00702" name="l00702"></a><span class="lineno">  702</span>        <a class="code hl_struct" href="structplatoon__strategic__ihp_1_1PlatoonMember.html">PlatoonMember</a> hostInfo = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>[<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a822212181c90d3fa29f8a9aa513fab3f">hostPosInPlatoon_</a>];</div>
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno">  703</span>        </div>
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno">  704</span>        <span class="comment">// Clear contents of the platoon vector and rebuild it with the two known members at this time, leader &amp; host.</span></div>
<div class="line"><a id="l00705" name="l00705"></a><span class="lineno">  705</span>        <span class="comment">// Remaining leader info and info about any other members will get populated as messages come in.</span></div>
<div class="line"><a id="l00706" name="l00706"></a><span class="lineno">  706</span>        <a class="code hl_struct" href="structplatoon__strategic__ihp_1_1PlatoonMember.html">PlatoonMember</a> newLeader = <a class="code hl_struct" href="structplatoon__strategic__ihp_1_1PlatoonMember.html">PlatoonMember</a>();</div>
<div class="line"><a id="l00707" name="l00707"></a><span class="lineno">  707</span>        newLeader.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonMember.html#af1c48353e45a30b01a1d59fdd1a19c9f">staticId</a> = newLeaderId;</div>
<div class="line"><a id="l00708" name="l00708"></a><span class="lineno">  708</span>        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>.clear();</div>
<div class="line"><a id="l00709" name="l00709"></a><span class="lineno">  709</span>        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>.push_back(newLeader); <span class="comment">//can get location info updated later with a STATUS or INFO message</span></div>
<div class="line"><a id="l00710" name="l00710"></a><span class="lineno">  710</span>        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>.push_back(hostInfo);</div>
<div class="line"><a id="l00711" name="l00711"></a><span class="lineno">  711</span> </div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno">  712</span>        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a822212181c90d3fa29f8a9aa513fab3f">hostPosInPlatoon_</a> = 1; <span class="comment">//since host was previously leader it is now guaranteed to be 2nd in the line (index 1)</span></div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span>        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a9fb744eaf988b3082397c736de1006ab">isFollower</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span>        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a634f99de503cccb2f2d3cb955623dde2">currentPlatoonID</a> = newPlatoonId;</div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span> </div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span>        <span class="comment">// Clear the record of neighbor platoon, since we likely just joined it</span></div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno">  717</span>        <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#abca93088e8980c97a1a24c4fff31c758">resetNeighborPlatoon</a>();</div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno">  718</span> </div>
<div class="line"><a id="l00719" name="l00719"></a><span class="lineno">  719</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;The platoon manager is changed from leader state to follower state. Platoon vector re-initialized. Plan ID = &quot;</span> &lt;&lt; newPlatoonId);</div>
<div class="line"><a id="l00720" name="l00720"></a><span class="lineno">  720</span>    }</div>
<div class="line"><a id="l00721" name="l00721"></a><span class="lineno">  721</span> </div>
<div class="line"><a id="l00722" name="l00722"></a><span class="lineno">  722</span>    <span class="comment">// Return the number of vehicles in the front of the host vehicle. If host is leader or a single vehicle, return 0.</span></div>
<div class="line"><a id="l00723" name="l00723"></a><span class="lineno"><a class="line" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a1de160740f47d9b0198e42dcbe67a6fe">  723</a></span>    <span class="keywordtype">int</span> <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a1de160740f47d9b0198e42dcbe67a6fe">PlatoonManager::getNumberOfVehicleInFront</a>() {</div>
<div class="line"><a id="l00724" name="l00724"></a><span class="lineno">  724</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a822212181c90d3fa29f8a9aa513fab3f">hostPosInPlatoon_</a>;</div>
<div class="line"><a id="l00725" name="l00725"></a><span class="lineno">  725</span>    }</div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno">  726</span> </div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span>    <span class="comment">// Return the distance (m) to the predecessor vehicle.</span></div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno"><a class="line" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a472f726662a0702881c52b4da95bd457">  728</a></span>    <span class="keywordtype">double</span> <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a472f726662a0702881c52b4da95bd457">PlatoonManager::getDistanceToPredVehicle</a>() {</div>
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno">  729</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0ade0fd8797f0e76b16846cb1b0cb951">gapWithPred_</a>;</div>
<div class="line"><a id="l00730" name="l00730"></a><span class="lineno">  730</span>    }</div>
<div class="line"><a id="l00731" name="l00731"></a><span class="lineno">  731</span> </div>
<div class="line"><a id="l00732" name="l00732"></a><span class="lineno">  732</span>    <span class="comment">// Return the current host vehicle speed in m/s.</span></div>
<div class="line"><a id="l00733" name="l00733"></a><span class="lineno"><a class="line" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ac123534207dc3ea247cfb1281426cd84">  733</a></span>    <span class="keywordtype">double</span> <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ac123534207dc3ea247cfb1281426cd84">PlatoonManager::getCurrentSpeed</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00734" name="l00734"></a><span class="lineno">  734</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>[<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a822212181c90d3fa29f8a9aa513fab3f">hostPosInPlatoon_</a>].vehicleSpeed;</div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span>    }</div>
<div class="line"><a id="l00736" name="l00736"></a><span class="lineno">  736</span> </div>
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno">  737</span>    <span class="comment">// Return the current command speed of host vehicle in m/s.</span></div>
<div class="line"><a id="l00738" name="l00738"></a><span class="lineno"><a class="line" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a10f95b2573ee211d8f9b07f8d7551809">  738</a></span>    <span class="keywordtype">double</span> <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a10f95b2573ee211d8f9b07f8d7551809">PlatoonManager::getCommandSpeed</a>()<span class="keyword"> const</span></div>
<div class="line"><a id="l00739" name="l00739"></a><span class="lineno">  739</span><span class="keyword">    </span>{</div>
<div class="line"><a id="l00740" name="l00740"></a><span class="lineno">  740</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>[<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a822212181c90d3fa29f8a9aa513fab3f">hostPosInPlatoon_</a>].commandSpeed;</div>
<div class="line"><a id="l00741" name="l00741"></a><span class="lineno">  741</span>    }</div>
<div class="line"><a id="l00742" name="l00742"></a><span class="lineno">  742</span> </div>
<div class="line"><a id="l00743" name="l00743"></a><span class="lineno">  743</span>    <span class="comment">// Return the current downtrack distance in m.</span></div>
<div class="line"><a id="l00744" name="l00744"></a><span class="lineno"><a class="line" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8f79bf82a5c6ba800fd48f9ed819f606">  744</a></span>    <span class="keywordtype">double</span> <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8f79bf82a5c6ba800fd48f9ed819f606">PlatoonManager::getCurrentDowntrackDistance</a>()<span class="keyword"> const</span></div>
<div class="line"><a id="l00745" name="l00745"></a><span class="lineno">  745</span><span class="keyword">    </span>{</div>
<div class="line"><a id="l00746" name="l00746"></a><span class="lineno">  746</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>[<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a822212181c90d3fa29f8a9aa513fab3f">hostPosInPlatoon_</a>].vehiclePosition;</div>
<div class="line"><a id="l00747" name="l00747"></a><span class="lineno">  747</span>    }</div>
<div class="line"><a id="l00748" name="l00748"></a><span class="lineno">  748</span> </div>
<div class="line"><a id="l00749" name="l00749"></a><span class="lineno">  749</span>    <span class="comment">// Return the current crosstrack distance, in m.</span></div>
<div class="line"><a id="l00750" name="l00750"></a><span class="lineno"><a class="line" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ac7017e74336d2270a0d66249a46c7dbb">  750</a></span>    <span class="keywordtype">double</span> <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ac7017e74336d2270a0d66249a46c7dbb">PlatoonManager::getCurrentCrosstrackDistance</a>()<span class="keyword"> const</span></div>
<div class="line"><a id="l00751" name="l00751"></a><span class="lineno">  751</span><span class="keyword">    </span>{</div>
<div class="line"><a id="l00752" name="l00752"></a><span class="lineno">  752</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>[<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a822212181c90d3fa29f8a9aa513fab3f">hostPosInPlatoon_</a>].vehicleCrossTrack;</div>
<div class="line"><a id="l00753" name="l00753"></a><span class="lineno">  753</span>    }</div>
<div class="line"><a id="l00754" name="l00754"></a><span class="lineno">  754</span> </div>
<div class="line"><a id="l00755" name="l00755"></a><span class="lineno">  755</span>    <span class="comment">// UCLA: return the host vehicle static ID.</span></div>
<div class="line"><a id="l00756" name="l00756"></a><span class="lineno"><a class="line" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ae696d79ca33f496082ef462fdc9ba53b">  756</a></span>    std::string <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ae696d79ca33f496082ef462fdc9ba53b">PlatoonManager::getHostStaticID</a>()<span class="keyword"> const</span></div>
<div class="line"><a id="l00757" name="l00757"></a><span class="lineno">  757</span><span class="keyword">    </span>{</div>
<div class="line"><a id="l00758" name="l00758"></a><span class="lineno">  758</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a54c4103e4b8705ee687effb030fb7040">HostMobilityId</a>;</div>
<div class="line"><a id="l00759" name="l00759"></a><span class="lineno">  759</span>    }</div>
<div class="line"><a id="l00760" name="l00760"></a><span class="lineno">  760</span> </div>
<div class="line"><a id="l00761" name="l00761"></a><span class="lineno">  761</span>    <span class="comment">// Return the physical length from platoon front vehicle (front bumper) to platoon rear vehicle (rear bumper) in m.</span></div>
<div class="line"><a id="l00762" name="l00762"></a><span class="lineno"><a class="line" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#af19d3e4a88f6875cf802442b183694a0">  762</a></span>    <span class="keywordtype">double</span> <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#af19d3e4a88f6875cf802442b183694a0">PlatoonManager::getCurrentPlatoonLength</a>() {</div>
<div class="line"><a id="l00763" name="l00763"></a><span class="lineno">  763</span>        <span class="comment">//this works even if platoon size is 1 (can&#39;t be 0)</span></div>
<div class="line"><a id="l00764" name="l00764"></a><span class="lineno">  764</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>[0].vehiclePosition - <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>[<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>.size() - 1].vehiclePosition + <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a84be50afb79607448e76211608e3349e">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#ae1ec2bca75a9c7f5c9f2855007f48fba">vehicleLength</a>; </div>
<div class="line"><a id="l00765" name="l00765"></a><span class="lineno">  765</span>    }</div>
<div class="line"><a id="l00766" name="l00766"></a><span class="lineno">  766</span> </div>
<div class="line"><a id="l00767" name="l00767"></a><span class="lineno">  767</span>    <span class="comment">// ---------------------- UCLA: IHP platoon trajectory regulation --------------------------- //</span></div>
<div class="line"><a id="l00768" name="l00768"></a><span class="lineno">  768</span>    <span class="comment">// Calculate the time headway summation of the vehicle in front of the host</span></div>
<div class="line"><a id="l00769" name="l00769"></a><span class="lineno"><a class="line" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acde63c37282d68d2a407359d735d3446">  769</a></span>    <span class="keywordtype">double</span> <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acde63c37282d68d2a407359d735d3446">PlatoonManager::getPredecessorTimeHeadwaySum</a>()</div>
<div class="line"><a id="l00770" name="l00770"></a><span class="lineno">  770</span>    {</div>
<div class="line"><a id="l00771" name="l00771"></a><span class="lineno">  771</span>        <span class="comment">// 1. read dtd vector </span></div>
<div class="line"><a id="l00772" name="l00772"></a><span class="lineno">  772</span>        <span class="comment">// dtd vector </span></div>
<div class="line"><a id="l00773" name="l00773"></a><span class="lineno">  773</span>        std::vector&lt;double&gt; downtrackDistance(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>.size());</div>
<div class="line"><a id="l00774" name="l00774"></a><span class="lineno">  774</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> = 0; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> &lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>.size(); <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>++)</div>
<div class="line"><a id="l00775" name="l00775"></a><span class="lineno">  775</span>        {</div>
<div class="line"><a id="l00776" name="l00776"></a><span class="lineno">  776</span>            downtrackDistance[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>] = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>].vehiclePosition;</div>
<div class="line"><a id="l00777" name="l00777"></a><span class="lineno">  777</span>        }</div>
<div class="line"><a id="l00778" name="l00778"></a><span class="lineno">  778</span>        <span class="comment">// speed vector</span></div>
<div class="line"><a id="l00779" name="l00779"></a><span class="lineno">  779</span>        std::vector&lt;double&gt; speed(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>.size());</div>
<div class="line"><a id="l00780" name="l00780"></a><span class="lineno">  780</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> = 0; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> &lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>.size(); <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>++)</div>
<div class="line"><a id="l00781" name="l00781"></a><span class="lineno">  781</span>        {</div>
<div class="line"><a id="l00782" name="l00782"></a><span class="lineno">  782</span>            speed[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>] = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>].vehicleSpeed;</div>
<div class="line"><a id="l00783" name="l00783"></a><span class="lineno">  783</span>        }</div>
<div class="line"><a id="l00784" name="l00784"></a><span class="lineno">  784</span> </div>
<div class="line"><a id="l00785" name="l00785"></a><span class="lineno">  785</span>        <span class="comment">// 2. find the summation of &quot;veh_len/veh_speed&quot; for all predecessors</span></div>
<div class="line"><a id="l00786" name="l00786"></a><span class="lineno">  786</span>        <span class="keywordtype">double</span> tmp_time_hdw = 0.0;</div>
<div class="line"><a id="l00787" name="l00787"></a><span class="lineno">  787</span>        <span class="keywordtype">double</span> cur_dtd;</div>
<div class="line"><a id="l00788" name="l00788"></a><span class="lineno">  788</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> index = 0; index &lt; downtrackDistance.size(); index++)</div>
<div class="line"><a id="l00789" name="l00789"></a><span class="lineno">  789</span>        {</div>
<div class="line"><a id="l00790" name="l00790"></a><span class="lineno">  790</span>            cur_dtd = downtrackDistance[index];</div>
<div class="line"><a id="l00791" name="l00791"></a><span class="lineno">  791</span>            <span class="keywordflow">if</span> (cur_dtd &gt; <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8f79bf82a5c6ba800fd48f9ed819f606">getCurrentDowntrackDistance</a>())</div>
<div class="line"><a id="l00792" name="l00792"></a><span class="lineno">  792</span>            {</div>
<div class="line"><a id="l00793" name="l00793"></a><span class="lineno">  793</span>                <span class="comment">// greater dtd ==&gt; in front of host veh </span></div>
<div class="line"><a id="l00794" name="l00794"></a><span class="lineno">  794</span>                tmp_time_hdw += <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a84be50afb79607448e76211608e3349e">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#ae1ec2bca75a9c7f5c9f2855007f48fba">vehicleLength</a> / (speed[index] + 0.00001);</div>
<div class="line"><a id="l00795" name="l00795"></a><span class="lineno">  795</span>            }</div>
<div class="line"><a id="l00796" name="l00796"></a><span class="lineno">  796</span>        }</div>
<div class="line"><a id="l00797" name="l00797"></a><span class="lineno">  797</span> </div>
<div class="line"><a id="l00798" name="l00798"></a><span class="lineno">  798</span>        <span class="comment">// Return the calcualted value</span></div>
<div class="line"><a id="l00799" name="l00799"></a><span class="lineno">  799</span>        <span class="keywordflow">return</span> tmp_time_hdw;</div>
<div class="line"><a id="l00800" name="l00800"></a><span class="lineno">  800</span>    }</div>
<div class="line"><a id="l00801" name="l00801"></a><span class="lineno">  801</span> </div>
<div class="line"><a id="l00802" name="l00802"></a><span class="lineno">  802</span>    <span class="comment">// Return the predecessor speed </span></div>
<div class="line"><a id="l00803" name="l00803"></a><span class="lineno"><a class="line" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#abee9a2b28eac60e3a326656ada2d7630">  803</a></span>    <span class="keywordtype">double</span> <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#abee9a2b28eac60e3a326656ada2d7630">PlatoonManager::getPredecessorSpeed</a>()</div>
<div class="line"><a id="l00804" name="l00804"></a><span class="lineno">  804</span>    {</div>
<div class="line"><a id="l00805" name="l00805"></a><span class="lineno">  805</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>[<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a822212181c90d3fa29f8a9aa513fab3f">hostPosInPlatoon_</a>].vehicleSpeed; <span class="comment">// m/s </span></div>
<div class="line"><a id="l00806" name="l00806"></a><span class="lineno">  806</span>    }</div>
<div class="line"><a id="l00807" name="l00807"></a><span class="lineno">  807</span> </div>
<div class="line"><a id="l00808" name="l00808"></a><span class="lineno">  808</span>    <span class="comment">// Return the predecessor location</span></div>
<div class="line"><a id="l00809" name="l00809"></a><span class="lineno"><a class="line" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8dcec182e6480989f16493cdae76e445">  809</a></span>    <span class="keywordtype">double</span> <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8dcec182e6480989f16493cdae76e445">PlatoonManager::getPredecessorPosition</a>()</div>
<div class="line"><a id="l00810" name="l00810"></a><span class="lineno">  810</span>    {</div>
<div class="line"><a id="l00811" name="l00811"></a><span class="lineno">  811</span>        <span class="comment">// Read host index. </span></div>
<div class="line"><a id="l00812" name="l00812"></a><span class="lineno">  812</span>        <span class="keywordtype">int</span> host_platoon_index = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a1de160740f47d9b0198e42dcbe67a6fe">getNumberOfVehicleInFront</a>();</div>
<div class="line"><a id="l00813" name="l00813"></a><span class="lineno">  813</span> </div>
<div class="line"><a id="l00814" name="l00814"></a><span class="lineno">  814</span>        <span class="comment">// Return speed</span></div>
<div class="line"><a id="l00815" name="l00815"></a><span class="lineno">  815</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>[host_platoon_index].vehiclePosition; <span class="comment">// m</span></div>
<div class="line"><a id="l00816" name="l00816"></a><span class="lineno">  816</span>    }</div>
<div class="line"><a id="l00817" name="l00817"></a><span class="lineno">  817</span> </div>
<div class="line"><a id="l00818" name="l00818"></a><span class="lineno">  818</span>    <span class="comment">// Trajectory based platoon trajectory regulation.</span></div>
<div class="line"><a id="l00819" name="l00819"></a><span class="lineno"><a class="line" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad0416740bcfdcccbd91a810d8b3ebbd5">  819</a></span>    <span class="keywordtype">double</span> <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad0416740bcfdcccbd91a810d8b3ebbd5">PlatoonManager::getIHPDesPosFollower</a>(<span class="keywordtype">double</span> time_step)</div>
<div class="line"><a id="l00820" name="l00820"></a><span class="lineno">  820</span>    {</div>
<div class="line"><a id="l00829" name="l00829"></a><span class="lineno">  829</span>        <span class="comment">// 1. read dtd vector </span></div>
<div class="line"><a id="l00830" name="l00830"></a><span class="lineno">  830</span>        <span class="comment">// dtd vector </span></div>
<div class="line"><a id="l00831" name="l00831"></a><span class="lineno">  831</span>        std::vector&lt;double&gt; downtrackDistance(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>.size());</div>
<div class="line"><a id="l00832" name="l00832"></a><span class="lineno">  832</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> = 0; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> &lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>.size(); <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>++)</div>
<div class="line"><a id="l00833" name="l00833"></a><span class="lineno">  833</span>        {</div>
<div class="line"><a id="l00834" name="l00834"></a><span class="lineno">  834</span>            downtrackDistance[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>] = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>].vehiclePosition;</div>
<div class="line"><a id="l00835" name="l00835"></a><span class="lineno">  835</span>        }</div>
<div class="line"><a id="l00836" name="l00836"></a><span class="lineno">  836</span>        <span class="comment">// speed vector</span></div>
<div class="line"><a id="l00837" name="l00837"></a><span class="lineno">  837</span>        std::vector&lt;double&gt; speed(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>.size());</div>
<div class="line"><a id="l00838" name="l00838"></a><span class="lineno">  838</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> = 0; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> &lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>.size(); <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>++)</div>
<div class="line"><a id="l00839" name="l00839"></a><span class="lineno">  839</span>        {</div>
<div class="line"><a id="l00840" name="l00840"></a><span class="lineno">  840</span>            speed[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>] = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>].vehicleSpeed;</div>
<div class="line"><a id="l00841" name="l00841"></a><span class="lineno">  841</span>        }</div>
<div class="line"><a id="l00842" name="l00842"></a><span class="lineno">  842</span> </div>
<div class="line"><a id="l00843" name="l00843"></a><span class="lineno">  843</span>        <span class="comment">// 2. find the summation of &quot;veh_len/veh_speed&quot; for all predecessors</span></div>
<div class="line"><a id="l00844" name="l00844"></a><span class="lineno">  844</span>        <span class="keywordtype">double</span> tmp_time_hdw = 0.0;</div>
<div class="line"><a id="l00845" name="l00845"></a><span class="lineno">  845</span>        <span class="keywordtype">double</span> cur_dtd;</div>
<div class="line"><a id="l00846" name="l00846"></a><span class="lineno">  846</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> index = 0; index &lt; downtrackDistance.size(); index++)</div>
<div class="line"><a id="l00847" name="l00847"></a><span class="lineno">  847</span>        {</div>
<div class="line"><a id="l00848" name="l00848"></a><span class="lineno">  848</span>            cur_dtd = downtrackDistance[index];</div>
<div class="line"><a id="l00849" name="l00849"></a><span class="lineno">  849</span>            <span class="keywordflow">if</span> (cur_dtd &gt; <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8f79bf82a5c6ba800fd48f9ed819f606">getCurrentDowntrackDistance</a>())</div>
<div class="line"><a id="l00850" name="l00850"></a><span class="lineno">  850</span>            {</div>
<div class="line"><a id="l00851" name="l00851"></a><span class="lineno">  851</span>                <span class="comment">// greater dtd ==&gt; in front of host veh </span></div>
<div class="line"><a id="l00852" name="l00852"></a><span class="lineno">  852</span>                tmp_time_hdw += <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a84be50afb79607448e76211608e3349e">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#ae1ec2bca75a9c7f5c9f2855007f48fba">vehicleLength</a> / (speed[index] + 0.00001);</div>
<div class="line"><a id="l00853" name="l00853"></a><span class="lineno">  853</span>            }</div>
<div class="line"><a id="l00854" name="l00854"></a><span class="lineno">  854</span>        }</div>
<div class="line"><a id="l00855" name="l00855"></a><span class="lineno">  855</span> </div>
<div class="line"><a id="l00856" name="l00856"></a><span class="lineno">  856</span>        <span class="comment">// 3. read host veh and front veh info </span></div>
<div class="line"><a id="l00857" name="l00857"></a><span class="lineno">  857</span>        <span class="comment">// Predecessor vehicle data.</span></div>
<div class="line"><a id="l00858" name="l00858"></a><span class="lineno">  858</span>        <span class="keywordtype">double</span> pred_spd = speed[<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a1de160740f47d9b0198e42dcbe67a6fe">getNumberOfVehicleInFront</a>()-1]; <span class="comment">// m/s </span></div>
<div class="line"><a id="l00859" name="l00859"></a><span class="lineno">  859</span>        <span class="keywordtype">double</span> pred_pos = downtrackDistance[<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a1de160740f47d9b0198e42dcbe67a6fe">getNumberOfVehicleInFront</a>()-1]; <span class="comment">// m</span></div>
<div class="line"><a id="l00860" name="l00860"></a><span class="lineno">  860</span>        </div>
<div class="line"><a id="l00861" name="l00861"></a><span class="lineno">  861</span>        <span class="comment">// host data. </span></div>
<div class="line"><a id="l00862" name="l00862"></a><span class="lineno">  862</span>        <span class="keywordtype">double</span> ego_spd = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ac123534207dc3ea247cfb1281426cd84">getCurrentSpeed</a>(); <span class="comment">// m/s</span></div>
<div class="line"><a id="l00863" name="l00863"></a><span class="lineno">  863</span>        <span class="keywordtype">double</span> ego_pos = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8f79bf82a5c6ba800fd48f9ed819f606">getCurrentDowntrackDistance</a>(); <span class="comment">// m</span></div>
<div class="line"><a id="l00864" name="l00864"></a><span class="lineno">  864</span>        </div>
<div class="line"><a id="l00865" name="l00865"></a><span class="lineno">  865</span>        <span class="comment">// platoon position index</span></div>
<div class="line"><a id="l00866" name="l00866"></a><span class="lineno">  866</span>        <span class="keywordtype">int</span> pos_idx = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a1de160740f47d9b0198e42dcbe67a6fe">getNumberOfVehicleInFront</a>();</div>
<div class="line"><a id="l00867" name="l00867"></a><span class="lineno">  867</span> </div>
<div class="line"><a id="l00868" name="l00868"></a><span class="lineno">  868</span>        <span class="keywordtype">double</span> desirePlatoonGap = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a84be50afb79607448e76211608e3349e">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a63ddcdd4c1280f41bc9ddb0bc16e2b93">intra_tau</a>; <span class="comment">//s</span></div>
<div class="line"><a id="l00869" name="l00869"></a><span class="lineno">  869</span>        </div>
<div class="line"><a id="l00870" name="l00870"></a><span class="lineno">  870</span>        <span class="comment">// IHP desired position calculation methods</span></div>
<div class="line"><a id="l00871" name="l00871"></a><span class="lineno">  871</span>        <span class="keywordtype">double</span> pos_g; <span class="comment">// desired downtrack position calculated with time-gap, in m.</span></div>
<div class="line"><a id="l00872" name="l00872"></a><span class="lineno">  872</span>        <span class="keywordtype">double</span> pos_h; <span class="comment">// desired downtrack position calculated with distance headaway, in m.</span></div>
<div class="line"><a id="l00873" name="l00873"></a><span class="lineno">  873</span> </div>
<div class="line"><a id="l00874" name="l00874"></a><span class="lineno">  874</span>        <span class="comment">// 4. IHP gap regualtion </span></div>
<div class="line"><a id="l00875" name="l00875"></a><span class="lineno">  875</span>        </div>
<div class="line"><a id="l00876" name="l00876"></a><span class="lineno">  876</span>        <span class="comment">// intermediate variables </span></div>
<div class="line"><a id="l00877" name="l00877"></a><span class="lineno">  877</span>        <span class="keywordtype">double</span> timeGapAndStepRatio = desirePlatoonGap/time_step;      <span class="comment">// The ratio between desired platoon time gap and the current time_step.</span></div>
<div class="line"><a id="l00878" name="l00878"></a><span class="lineno">  878</span>        <span class="keywordtype">double</span> totalTimeGap = desirePlatoonGap*pos_idx;               <span class="comment">// The overall time gap from host vehicle to the platoon leader, in s.</span></div>
<div class="line"><a id="l00879" name="l00879"></a><span class="lineno">  879</span> </div>
<div class="line"><a id="l00880" name="l00880"></a><span class="lineno">  880</span>        <span class="comment">// calcilate pos_gap and pos_headway</span></div>
<div class="line"><a id="l00881" name="l00881"></a><span class="lineno">  881</span>        <span class="keywordflow">if</span> ((pred_spd &lt;= ego_spd) &amp;&amp; (ego_spd &lt;= <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a84be50afb79607448e76211608e3349e">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a0219322f3dd8e56a7be6681e4c77708d">ss_theta</a>))</div>
<div class="line"><a id="l00882" name="l00882"></a><span class="lineno">  882</span>        {</div>
<div class="line"><a id="l00883" name="l00883"></a><span class="lineno">  883</span>            <span class="comment">// ---&gt; 4.1 pos_g </span></div>
<div class="line"><a id="l00884" name="l00884"></a><span class="lineno">  884</span>            pos_g = (pred_pos - <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a84be50afb79607448e76211608e3349e">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#ae1ec2bca75a9c7f5c9f2855007f48fba">vehicleLength</a> - <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a84be50afb79607448e76211608e3349e">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a590c350d5c11aeba533aa5fddcb73bb2">standstill</a> + ego_pos*timeGapAndStepRatio) / (1 + timeGapAndStepRatio);</div>
<div class="line"><a id="l00885" name="l00885"></a><span class="lineno">  885</span>            <span class="comment">// ---&gt; 4.2 pos_h</span></div>
<div class="line"><a id="l00886" name="l00886"></a><span class="lineno">  886</span>            <span class="keywordtype">double</span> pos_h_nom = (pred_pos - <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a84be50afb79607448e76211608e3349e">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a590c350d5c11aeba533aa5fddcb73bb2">standstill</a> + ego_pos*(totalTimeGap + tmp_time_hdw)/time_step);</div>
<div class="line"><a id="l00887" name="l00887"></a><span class="lineno">  887</span>            <span class="keywordtype">double</span> pos_h_denom = (1 + ((totalTimeGap + tmp_time_hdw)/time_step));</div>
<div class="line"><a id="l00888" name="l00888"></a><span class="lineno">  888</span>            pos_h = pos_h_nom/pos_h_denom;</div>
<div class="line"><a id="l00889" name="l00889"></a><span class="lineno">  889</span> </div>
<div class="line"><a id="l00890" name="l00890"></a><span class="lineno">  890</span>        }</div>
<div class="line"><a id="l00891" name="l00891"></a><span class="lineno">  891</span>        <span class="keywordflow">else</span></div>
<div class="line"><a id="l00892" name="l00892"></a><span class="lineno">  892</span>        {   </div>
<div class="line"><a id="l00893" name="l00893"></a><span class="lineno">  893</span>            <span class="comment">// ---&gt; 4.1 pos_g </span></div>
<div class="line"><a id="l00894" name="l00894"></a><span class="lineno">  894</span>            pos_g = (pred_pos - <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a84be50afb79607448e76211608e3349e">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#ae1ec2bca75a9c7f5c9f2855007f48fba">vehicleLength</a> + ego_pos*(timeGapAndStepRatio)) / (1 + timeGapAndStepRatio);</div>
<div class="line"><a id="l00895" name="l00895"></a><span class="lineno">  895</span>            <span class="comment">// ---&gt; 4.2 pos_h</span></div>
<div class="line"><a id="l00896" name="l00896"></a><span class="lineno">  896</span>            <span class="keywordtype">double</span> pos_h_nom = (pred_pos + ego_pos*(totalTimeGap + tmp_time_hdw)/time_step);</div>
<div class="line"><a id="l00897" name="l00897"></a><span class="lineno">  897</span>            <span class="keywordtype">double</span> pos_h_denom = (1 + ((totalTimeGap + tmp_time_hdw)/time_step));</div>
<div class="line"><a id="l00898" name="l00898"></a><span class="lineno">  898</span>            pos_h = pos_h_nom/pos_h_denom;</div>
<div class="line"><a id="l00899" name="l00899"></a><span class="lineno">  899</span>        }</div>
<div class="line"><a id="l00900" name="l00900"></a><span class="lineno">  900</span> </div>
<div class="line"><a id="l00901" name="l00901"></a><span class="lineno">  901</span>        <span class="comment">// ---&gt; 4.3 desire speed and desire location </span></div>
<div class="line"><a id="l00902" name="l00902"></a><span class="lineno">  902</span>        <span class="keywordtype">double</span> pos_des = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a84be50afb79607448e76211608e3349e">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a7f7c75e78767a304bbca12ce49c91cf8">gap_weight</a>*pos_g + (1.0 - <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a84be50afb79607448e76211608e3349e">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a7f7c75e78767a304bbca12ce49c91cf8">gap_weight</a>)*pos_h;</div>
<div class="line"><a id="l00903" name="l00903"></a><span class="lineno">  903</span>        <span class="comment">// double des_spd = (pos_des - ego_pos) / time_step;</span></div>
<div class="line"><a id="l00904" name="l00904"></a><span class="lineno">  904</span> </div>
<div class="line"><a id="l00905" name="l00905"></a><span class="lineno">  905</span>        <span class="comment">// ---&gt; 4.4 return IHP calculated desired location</span></div>
<div class="line"><a id="l00906" name="l00906"></a><span class="lineno">  906</span>        <span class="keywordflow">return</span> pos_des;</div>
<div class="line"><a id="l00907" name="l00907"></a><span class="lineno">  907</span>    }</div>
<div class="line"><a id="l00908" name="l00908"></a><span class="lineno">  908</span> </div>
<div class="line"><a id="l00909" name="l00909"></a><span class="lineno">  909</span>    <span class="comment">// UCLA: find the index of the closest vehicle in the target platoon that is in front of the host vehicle (cut-in joiner).</span></div>
<div class="line"><a id="l00910" name="l00910"></a><span class="lineno">  910</span>    <span class="comment">// Note: The joiner will cut-in at the back of this vehicle, which make this index points to the vehicle that is leading the cut-in gap.</span></div>
<div class="line"><a id="l00911" name="l00911"></a><span class="lineno"><a class="line" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a891585489dfbd709f71347784744ed58">  911</a></span>    <span class="keywordtype">int</span> <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a891585489dfbd709f71347784744ed58">PlatoonManager::getClosestIndex</a>(<span class="keywordtype">double</span> joinerDtD)</div>
<div class="line"><a id="l00912" name="l00912"></a><span class="lineno">  912</span>    {   </div>
<div class="line"><a id="l00913" name="l00913"></a><span class="lineno">  913</span>        <span class="comment">/*</span></div>
<div class="line"><a id="l00914" name="l00914"></a><span class="lineno">  914</span><span class="comment">            A naive way to find the closest member that is in front of the host that point to the gap to join the platoon.</span></div>
<div class="line"><a id="l00915" name="l00915"></a><span class="lineno">  915</span><span class="comment">            Note: The potential gap leading vehicle should be in front of the joiner (i.e., gap leading vehicle&#39;s dtd &gt; joiner&#39;s dtd).</span></div>
<div class="line"><a id="l00916" name="l00916"></a><span class="lineno">  916</span><span class="comment">                  If the joiner is already in front of the platoon leader, this function will return -1 (i.e., cut-in front).</span></div>
<div class="line"><a id="l00917" name="l00917"></a><span class="lineno">  917</span><span class="comment">        */</span></div>
<div class="line"><a id="l00918" name="l00918"></a><span class="lineno">  918</span> </div>
<div class="line"><a id="l00919" name="l00919"></a><span class="lineno">  919</span>        <span class="keywordtype">double</span> min_diff = 99999.0;</div>
<div class="line"><a id="l00920" name="l00920"></a><span class="lineno">  920</span>        <span class="keywordtype">int</span> cut_in_index = -1; <span class="comment">//-2 is meaningless default</span></div>
<div class="line"><a id="l00921" name="l00921"></a><span class="lineno">  921</span> </div>
<div class="line"><a id="l00922" name="l00922"></a><span class="lineno">  922</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;neighbor_platoon_.size(): &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a5810c2ddb1b317d7cd7a038615844185">neighbor_platoon_</a>.size());</div>
<div class="line"><a id="l00923" name="l00923"></a><span class="lineno">  923</span> </div>
<div class="line"><a id="l00924" name="l00924"></a><span class="lineno">  924</span>        <span class="comment">// Loop through all target platoon members  </span></div>
<div class="line"><a id="l00925" name="l00925"></a><span class="lineno">  925</span>        <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> = 0; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> &lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a5810c2ddb1b317d7cd7a038615844185">neighbor_platoon_</a>.size(); <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>++) </div>
<div class="line"><a id="l00926" name="l00926"></a><span class="lineno">  926</span>        {</div>
<div class="line"><a id="l00927" name="l00927"></a><span class="lineno">  927</span>            <span class="keywordtype">double</span> current_member_dtd = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a5810c2ddb1b317d7cd7a038615844185">neighbor_platoon_</a>[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>].vehiclePosition; </div>
<div class="line"><a id="l00928" name="l00928"></a><span class="lineno">  928</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;current_member_dtd: &quot;</span>&lt;&lt; current_member_dtd);</div>
<div class="line"><a id="l00929" name="l00929"></a><span class="lineno">  929</span>            <span class="keywordtype">double</span> curent_dtd_diff = current_member_dtd - joinerDtD;</div>
<div class="line"><a id="l00930" name="l00930"></a><span class="lineno">  930</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;curent_dtd_diff: &quot;</span>&lt;&lt; curent_dtd_diff);</div>
<div class="line"><a id="l00931" name="l00931"></a><span class="lineno">  931</span>            <span class="comment">// update min index</span></div>
<div class="line"><a id="l00932" name="l00932"></a><span class="lineno">  932</span>            <span class="keywordflow">if</span> (curent_dtd_diff &gt; 0 &amp;&amp; curent_dtd_diff &lt; min_diff)</div>
<div class="line"><a id="l00933" name="l00933"></a><span class="lineno">  933</span>            {</div>
<div class="line"><a id="l00934" name="l00934"></a><span class="lineno">  934</span>                min_diff = current_member_dtd;</div>
<div class="line"><a id="l00935" name="l00935"></a><span class="lineno">  935</span>                cut_in_index = <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>;</div>
<div class="line"><a id="l00936" name="l00936"></a><span class="lineno">  936</span>            }</div>
<div class="line"><a id="l00937" name="l00937"></a><span class="lineno">  937</span>        }</div>
<div class="line"><a id="l00938" name="l00938"></a><span class="lineno">  938</span>        </div>
<div class="line"><a id="l00939" name="l00939"></a><span class="lineno">  939</span>        <span class="keywordflow">return</span> cut_in_index;</div>
<div class="line"><a id="l00940" name="l00940"></a><span class="lineno">  940</span>    }</div>
<div class="line"><a id="l00941" name="l00941"></a><span class="lineno">  941</span> </div>
<div class="line"><a id="l00942" name="l00942"></a><span class="lineno">  942</span>    <span class="comment">// UCLA: find the current cut-in join gap size in downtrack distance (m). The origin of the vehicle when calculating DtD is locate at the rear axle. </span></div>
<div class="line"><a id="l00943" name="l00943"></a><span class="lineno"><a class="line" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ab159ce5c69ca45c1cabc2501a7b5ce12">  943</a></span>    <span class="keywordtype">double</span> <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ab159ce5c69ca45c1cabc2501a7b5ce12">PlatoonManager::getCutInGap</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> gap_leading_index, <span class="keyword">const</span> <span class="keywordtype">double</span> joinerDtD)</div>
<div class="line"><a id="l00944" name="l00944"></a><span class="lineno">  944</span>    {</div>
<div class="line"><a id="l00945" name="l00945"></a><span class="lineno">  945</span>        <span class="comment">/*</span></div>
<div class="line"><a id="l00946" name="l00946"></a><span class="lineno">  946</span><span class="comment">            Locate the target cut-in join gap size based on the index.   </span></div>
<div class="line"><a id="l00947" name="l00947"></a><span class="lineno">  947</span><span class="comment">        */</span></div>
<div class="line"><a id="l00948" name="l00948"></a><span class="lineno">  948</span> </div>
<div class="line"><a id="l00949" name="l00949"></a><span class="lineno">  949</span>        <span class="comment">// Initiate variables </span></div>
<div class="line"><a id="l00950" name="l00950"></a><span class="lineno">  950</span>        <span class="keywordtype">double</span> gap_size = -0.999;</div>
<div class="line"><a id="l00951" name="l00951"></a><span class="lineno">  951</span>        <span class="keywordtype">size_t</span> index = 0;</div>
<div class="line"><a id="l00952" name="l00952"></a><span class="lineno">  952</span>        <span class="keywordflow">if</span> (gap_leading_index &gt;= 0)</div>
<div class="line"><a id="l00953" name="l00953"></a><span class="lineno">  953</span>        {</div>
<div class="line"><a id="l00954" name="l00954"></a><span class="lineno">  954</span>            index = <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(gap_leading_index);</div>
<div class="line"><a id="l00955" name="l00955"></a><span class="lineno">  955</span>        }</div>
<div class="line"><a id="l00956" name="l00956"></a><span class="lineno">  956</span> </div>
<div class="line"><a id="l00957" name="l00957"></a><span class="lineno">  957</span>        <span class="comment">// cut-in from front </span></div>
<div class="line"><a id="l00958" name="l00958"></a><span class="lineno">  958</span>        <span class="keywordflow">if</span> (gap_leading_index == -1)</div>
<div class="line"><a id="l00959" name="l00959"></a><span class="lineno">  959</span>        {</div>
<div class="line"><a id="l00960" name="l00960"></a><span class="lineno">  960</span>            <span class="keywordtype">double</span> gap_rear_dtd = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a5810c2ddb1b317d7cd7a038615844185">neighbor_platoon_</a>[0].vehiclePosition;</div>
<div class="line"><a id="l00961" name="l00961"></a><span class="lineno">  961</span>            gap_size = joinerDtD - gap_rear_dtd - <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a84be50afb79607448e76211608e3349e">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#ae1ec2bca75a9c7f5c9f2855007f48fba">vehicleLength</a>;</div>
<div class="line"><a id="l00962" name="l00962"></a><span class="lineno">  962</span>        }</div>
<div class="line"><a id="l00963" name="l00963"></a><span class="lineno">  963</span>        <span class="comment">// cut-in from behind </span></div>
<div class="line"><a id="l00964" name="l00964"></a><span class="lineno">  964</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (index == <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a5810c2ddb1b317d7cd7a038615844185">neighbor_platoon_</a>.size() - 1)</div>
<div class="line"><a id="l00965" name="l00965"></a><span class="lineno">  965</span>        {    </div>
<div class="line"><a id="l00966" name="l00966"></a><span class="lineno">  966</span>            <span class="keywordtype">double</span> gap_leading_dtd = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a5810c2ddb1b317d7cd7a038615844185">neighbor_platoon_</a>[index].vehiclePosition;</div>
<div class="line"><a id="l00967" name="l00967"></a><span class="lineno">  967</span>            gap_size = gap_leading_dtd - joinerDtD - <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a84be50afb79607448e76211608e3349e">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#ae1ec2bca75a9c7f5c9f2855007f48fba">vehicleLength</a>;;</div>
<div class="line"><a id="l00968" name="l00968"></a><span class="lineno">  968</span>        }</div>
<div class="line"><a id="l00969" name="l00969"></a><span class="lineno">  969</span>        <span class="comment">// cut-in in the middle</span></div>
<div class="line"><a id="l00970" name="l00970"></a><span class="lineno">  970</span>        <span class="keywordflow">else</span></div>
<div class="line"><a id="l00971" name="l00971"></a><span class="lineno">  971</span>        {</div>
<div class="line"><a id="l00972" name="l00972"></a><span class="lineno">  972</span>            <span class="keywordtype">double</span> gap_leading_dtd = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a5810c2ddb1b317d7cd7a038615844185">neighbor_platoon_</a>[index].vehiclePosition;</div>
<div class="line"><a id="l00973" name="l00973"></a><span class="lineno">  973</span>            <span class="keywordtype">double</span> gap_rear_dtd = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a5810c2ddb1b317d7cd7a038615844185">neighbor_platoon_</a>[index + 1].vehiclePosition;</div>
<div class="line"><a id="l00974" name="l00974"></a><span class="lineno">  974</span>            gap_size = gap_leading_dtd - gap_rear_dtd - <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a84be50afb79607448e76211608e3349e">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#ae1ec2bca75a9c7f5c9f2855007f48fba">vehicleLength</a>;</div>
<div class="line"><a id="l00975" name="l00975"></a><span class="lineno">  975</span>        }</div>
<div class="line"><a id="l00976" name="l00976"></a><span class="lineno">  976</span> </div>
<div class="line"><a id="l00977" name="l00977"></a><span class="lineno">  977</span>        <span class="comment">// return gap_size value</span></div>
<div class="line"><a id="l00978" name="l00978"></a><span class="lineno">  978</span>        <span class="keywordflow">return</span> gap_size;</div>
<div class="line"><a id="l00979" name="l00979"></a><span class="lineno">  979</span>    }</div>
<div class="line"><a id="l00980" name="l00980"></a><span class="lineno">  980</span>}</div>
<div class="ttc" id="aclassint_html"><div class="ttname"><a href="classint.html">int</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_a05732c5f9b2d8f5d2c66d1cdcf793854"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a05732c5f9b2d8f5d2c66d1cdcf793854">platoon_strategic_ihp::PlatoonManager::platoonLeaderID</a></div><div class="ttdeci">std::string platoonLeaderID</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00367">platoon_manager_ihp.h:367</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_a0ade0fd8797f0e76b16846cb1b0cb951"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0ade0fd8797f0e76b16846cb1b0cb951">platoon_strategic_ihp::PlatoonManager::gapWithPred_</a></div><div class="ttdeci">double gapWithPred_</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00434">platoon_manager_ihp.h:434</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_a0d0a209aaf6bc5c61a30b091a78cb39d"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">platoon_strategic_ihp::PlatoonManager::current_plan</a></div><div class="ttdeci">ActionPlan current_plan</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00376">platoon_manager_ihp.h:376</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_a0dfb4a15be2cf69ca770fcde1bdf65f5"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0dfb4a15be2cf69ca770fcde1bdf65f5">platoon_strategic_ihp::PlatoonManager::isCreateGap</a></div><div class="ttdeci">bool isCreateGap</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00407">platoon_manager_ihp.h:407</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_a0fadcff41a35df3fe821f05cc1452c45"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0fadcff41a35df3fe821f05cc1452c45">platoon_strategic_ihp::PlatoonManager::neighborPlatoonID</a></div><div class="ttdeci">std::string neighborPlatoonID</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00392">platoon_manager_ihp.h:392</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_a10f95b2573ee211d8f9b07f8d7551809"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a10f95b2573ee211d8f9b07f8d7551809">platoon_strategic_ihp::PlatoonManager::getCommandSpeed</a></div><div class="ttdeci">double getCommandSpeed() const</div><div class="ttdoc">Returns command speed. in m/s.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00738">platoon_manager_ihp.cpp:738</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_a10ff5ed73a7a5f72b96fc5b1a928bfe3"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a10ff5ed73a7a5f72b96fc5b1a928bfe3">platoon_strategic_ihp::PlatoonManager::findMaximumSpacingViolationClosestToTheHostVehicle</a></div><div class="ttdeci">int findMaximumSpacingViolationClosestToTheHostVehicle(std::vector&lt; double &gt; timeHeadways) const</div><div class="ttdoc">Find the closest vehicle to the host vehicle that violates the (time headaway) maximum spacing condit...</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00651">platoon_manager_ihp.cpp:651</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_a139f10b9de2c9682c17c72115679052a"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a139f10b9de2c9682c17c72115679052a">platoon_strategic_ihp::PlatoonManager::previousFunctionalDynamicLeaderIndex_</a></div><div class="ttdeci">int previousFunctionalDynamicLeaderIndex_</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00429">platoon_manager_ihp.h:429</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_a1de160740f47d9b0198e42dcbe67a6fe"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a1de160740f47d9b0198e42dcbe67a6fe">platoon_strategic_ihp::PlatoonManager::getNumberOfVehicleInFront</a></div><div class="ttdeci">int getNumberOfVehicleInFront()</div><div class="ttdoc">Get number of vehicles in front of host vehicle inside platoon.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00723">platoon_manager_ihp.cpp:723</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_a24583fcb6596efbb2772001a58c36588"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a24583fcb6596efbb2772001a58c36588">platoon_strategic_ihp::PlatoonManager::determineDynamicLeaderBasedOnViolation</a></div><div class="ttdeci">int determineDynamicLeaderBasedOnViolation(std::vector&lt; double &gt; timeHeadways)</div><div class="ttdoc">Determine the proper vehicle to follow based the time headway of each member. Note that the host will...</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00604">platoon_manager_ihp.cpp:604</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_a26b94722e82060dda554ef168626727c"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a26b94722e82060dda554ef168626727c">platoon_strategic_ihp::PlatoonManager::getDynamicLeader</a></div><div class="ttdeci">PlatoonMember getDynamicLeader()</div><div class="ttdoc">Returns dynamic leader of the host vehicle.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00388">platoon_manager_ihp.cpp:388</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_a26f10c9b0d02a6c0a37228583a0385a1"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a26f10c9b0d02a6c0a37228583a0385a1">platoon_strategic_ihp::PlatoonManager::removeMember</a></div><div class="ttdeci">bool removeMember(const size_t mem)</div><div class="ttdoc">Removes a single member from the internal record of platoon members.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00322">platoon_manager_ihp.cpp:322</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_a36f41aa23d9cc311f1d2b017a008d0ed"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a36f41aa23d9cc311f1d2b017a008d0ed">platoon_strategic_ihp::PlatoonManager::neighbor_platoon_info_size_</a></div><div class="ttdeci">size_t neighbor_platoon_info_size_</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00387">platoon_manager_ihp.h:387</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_a472f726662a0702881c52b4da95bd457"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a472f726662a0702881c52b4da95bd457">platoon_strategic_ihp::PlatoonManager::getDistanceToPredVehicle</a></div><div class="ttdeci">double getDistanceToPredVehicle()</div><div class="ttdoc">Returns distance to the predessecor vehicle, in m.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00728">platoon_manager_ihp.cpp:728</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_a4a6ad6000ba1d8598e0eb7dc8e0be76b"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a4a6ad6000ba1d8598e0eb7dc8e0be76b">platoon_strategic_ihp::PlatoonManager::removeMemberById</a></div><div class="ttdeci">bool removeMemberById(const std::string id)</div><div class="ttdoc">Removes a single member from the internal record of platoon members.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00353">platoon_manager_ihp.cpp:353</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_a5239d1fb655a136e49a266d2ddf40589"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a5239d1fb655a136e49a266d2ddf40589">platoon_strategic_ihp::PlatoonManager::PlatoonManager</a></div><div class="ttdeci">PlatoonManager(std::shared_ptr&lt; carma_ros2_utils::timers::TimerFactory &gt; timer_factory)</div><div class="ttdoc">Constructor.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00051">platoon_manager_ihp.cpp:51</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_a54c4103e4b8705ee687effb030fb7040"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a54c4103e4b8705ee687effb030fb7040">platoon_strategic_ihp::PlatoonManager::HostMobilityId</a></div><div class="ttdeci">std::string HostMobilityId</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00404">platoon_manager_ihp.h:404</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_a54ddd0a10d8be526c0503f3981c60456"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a54ddd0a10d8be526c0503f3981c60456">platoon_strategic_ihp::PlatoonManager::algorithmType_</a></div><div class="ttdeci">std::string algorithmType_</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00439">platoon_manager_ihp.h:439</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_a5810c2ddb1b317d7cd7a038615844185"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a5810c2ddb1b317d7cd7a038615844185">platoon_strategic_ihp::PlatoonManager::neighbor_platoon_</a></div><div class="ttdeci">std::vector&lt; PlatoonMember &gt; neighbor_platoon_</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00384">platoon_manager_ihp.h:384</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_a5b694b6fdc9f0a3d7391a3e5ae11e623"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a5b694b6fdc9f0a3d7391a3e5ae11e623">platoon_strategic_ihp::PlatoonManager::previousFunctionalDynamicLeaderID_</a></div><div class="ttdeci">std::string previousFunctionalDynamicLeaderID_</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00428">platoon_manager_ihp.h:428</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_a5f0e8506da98a7cb29aca9750e310319"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a5f0e8506da98a7cb29aca9750e310319">platoon_strategic_ihp::PlatoonManager::dynamic_leader_index_</a></div><div class="ttdeci">size_t dynamic_leader_index_</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00409">platoon_manager_ihp.h:409</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_a5fa3ab8c7c127c9d76f0dce1be59fe80"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a5fa3ab8c7c127c9d76f0dce1be59fe80">platoon_strategic_ihp::PlatoonManager::allPredecessorFollowing</a></div><div class="ttdeci">int allPredecessorFollowing()</div><div class="ttdoc">This is the implementation of all predecessor following (APF) algorithm for leader selection in a pla...</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00428">platoon_manager_ihp.cpp:428</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_a634f99de503cccb2f2d3cb955623dde2"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a634f99de503cccb2f2d3cb955623dde2">platoon_strategic_ihp::PlatoonManager::currentPlatoonID</a></div><div class="ttdeci">std::string currentPlatoonID</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00364">platoon_manager_ihp.h:364</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_a686ffb96fbf0c728db7d12d03f1932c9"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a686ffb96fbf0c728db7d12d03f1932c9">platoon_strategic_ihp::PlatoonManager::updateHostSpeeds</a></div><div class="ttdeci">void updateHostSpeeds(const double cmdSpeed, const double actualSpeed)</div><div class="ttdoc">Stores the latest info on host vehicle's command &amp; actual speeds.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00066">platoon_manager_ihp.cpp:66</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_a6b4eae07dfc95c25104f95fef1f0f344"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a6b4eae07dfc95c25104f95fef1f0f344">platoon_strategic_ihp::PlatoonManager::updatesOrAddMemberInfo</a></div><div class="ttdeci">void updatesOrAddMemberInfo(std::vector&lt; PlatoonMember &gt; &amp;platoon, std::string senderId, double cmdSpeed, double dtDistance, double ctDistance, double curSpeed)</div><div class="ttdoc">Updates the list of vehicles in the specified platoon, based on info available from a mobility operat...</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00199">platoon_manager_ihp.cpp:199</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_a822212181c90d3fa29f8a9aa513fab3f"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a822212181c90d3fa29f8a9aa513fab3f">platoon_strategic_ihp::PlatoonManager::hostPosInPlatoon_</a></div><div class="ttdeci">size_t hostPosInPlatoon_</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00373">platoon_manager_ihp.h:373</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_a83ecd30ec7e2f7eb15c93075c8eca436"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a83ecd30ec7e2f7eb15c93075c8eca436">platoon_strategic_ihp::PlatoonManager::getPlatoonRearDowntrackDistance</a></div><div class="ttdeci">double getPlatoonRearDowntrackDistance()</div><div class="ttdoc">Returns downtrack distance of the rear vehicle in platoon, in m.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00375">platoon_manager_ihp.cpp:375</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_a84be50afb79607448e76211608e3349e"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a84be50afb79607448e76211608e3349e">platoon_strategic_ihp::PlatoonManager::config_</a></div><div class="ttdeci">PlatoonPluginConfig config_</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00417">platoon_manager_ihp.h:417</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_a891585489dfbd709f71347784744ed58"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a891585489dfbd709f71347784744ed58">platoon_strategic_ihp::PlatoonManager::getClosestIndex</a></div><div class="ttdeci">int getClosestIndex(double joinerDtD)</div><div class="ttdoc">UCLA: Return joiner's desired position in terms of target platoon index to cut into the platoon....</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00911">platoon_manager_ihp.cpp:911</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_a8a3ef30eeb7a7cf0caccb948e6a41f92"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a3ef30eeb7a7cf0caccb948e6a41f92">platoon_strategic_ihp::PlatoonManager::getHostPlatoonSize</a></div><div class="ttdeci">int getHostPlatoonSize()</div><div class="ttdoc">Returns total size of the platoon , in number of vehicles.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00279">platoon_manager_ihp.cpp:279</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_a8a8f2badbbe25d2b4d26e1556fa0aa63"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a8f2badbbe25d2b4d26e1556fa0aa63">platoon_strategic_ihp::PlatoonManager::is_neighbor_record_complete_</a></div><div class="ttdeci">bool is_neighbor_record_complete_</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00398">platoon_manager_ihp.h:398</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_a8dcec182e6480989f16493cdae76e445"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8dcec182e6480989f16493cdae76e445">platoon_strategic_ihp::PlatoonManager::getPredecessorPosition</a></div><div class="ttdeci">double getPredecessorPosition()</div><div class="ttdoc">UCLA: Return the position of the preceding vehicle, in m.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00809">platoon_manager_ihp.cpp:809</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_a8f79bf82a5c6ba800fd48f9ed819f606"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8f79bf82a5c6ba800fd48f9ed819f606">platoon_strategic_ihp::PlatoonManager::getCurrentDowntrackDistance</a></div><div class="ttdeci">double getCurrentDowntrackDistance() const</div><div class="ttdoc">Returns current downtrack distance, in m.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00744">platoon_manager_ihp.cpp:744</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_a8fa6576577e52bb8e1a31fef457defa9"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8fa6576577e52bb8e1a31fef457defa9">platoon_strategic_ihp::PlatoonManager::neighbor_platoon_leader_id_</a></div><div class="ttdeci">std::string neighbor_platoon_leader_id_</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00395">platoon_manager_ihp.h:395</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_a9fb744eaf988b3082397c736de1006ab"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a9fb744eaf988b3082397c736de1006ab">platoon_strategic_ihp::PlatoonManager::isFollower</a></div><div class="ttdeci">bool isFollower</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00379">platoon_manager_ihp.h:379</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_aa09eb8121e30d6ee3517823766dbeea4"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#aa09eb8121e30d6ee3517823766dbeea4">platoon_strategic_ihp::PlatoonManager::hostMemberUpdates</a></div><div class="ttdeci">void hostMemberUpdates(const std::string &amp;senderId, const std::string &amp;platoonId, const std::string &amp;params, const double &amp;DtD, const double &amp;CtD)</div><div class="ttdoc">Update information for members of the host's platoon based on a mobility operation STATUS message.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00073">platoon_manager_ihp.cpp:73</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_aa589c920c9684b42bf8f675c072ddb6b"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#aa589c920c9684b42bf8f675c072ddb6b">platoon_strategic_ihp::PlatoonManager::changeFromLeaderToFollower</a></div><div class="ttdeci">void changeFromLeaderToFollower(std::string newPlatoonId, std::string newLeaderId)</div><div class="ttdoc">Update status when state change from Leader to Follower.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00699">platoon_manager_ihp.cpp:699</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_aac57cfc07168101835015859c9c7e48e"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#aac57cfc07168101835015859c9c7e48e">platoon_strategic_ihp::PlatoonManager::getPlatoonFrontDowntrackDistance</a></div><div class="ttdeci">double getPlatoonFrontDowntrackDistance()</div><div class="ttdoc">UCLA: Return the platoon leader downtrack distance, in m.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00382">platoon_manager_ihp.cpp:382</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_ab159ce5c69ca45c1cabc2501a7b5ce12"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ab159ce5c69ca45c1cabc2501a7b5ce12">platoon_strategic_ihp::PlatoonManager::getCutInGap</a></div><div class="ttdeci">double getCutInGap(const int gap_leading_index, const double joinerDtD)</div><div class="ttdoc">UCLA: Return the current actual gap size in the target platoon for cut-in join, in m....</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00943">platoon_manager_ihp.cpp:943</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_ab1710b942f6893b756b67dd6505ee90b"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ab1710b942f6893b756b67dd6505ee90b">platoon_strategic_ihp::PlatoonManager::updateHostPose</a></div><div class="ttdeci">void updateHostPose(const double downtrack, const double crosstrack)</div><div class="ttdoc">Stores the latest info on location of the host vehicle.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00058">platoon_manager_ihp.cpp:58</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_ab1c204db4a5056621de299a9dd663c6f"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ab1c204db4a5056621de299a9dd663c6f">platoon_strategic_ihp::PlatoonManager::resetHostPlatoon</a></div><div class="ttdeci">void resetHostPlatoon()</div><div class="ttdoc">Resets all variables that might indicate other members of the host's platoon; sets the host back to s...</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00295">platoon_manager_ihp.cpp:295</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_ab6bac9590984959b2a6988c329090235"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ab6bac9590984959b2a6988c329090235">platoon_strategic_ihp::PlatoonManager::insufficientGapWithPredecessor</a></div><div class="ttdeci">bool insufficientGapWithPredecessor(double distanceToPredVehicle)</div><div class="ttdoc">Check the gap with the predecessor vehicle.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00570">platoon_manager_ihp.cpp:570</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_abc319b76af0eecaba8e0fe0718457618"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#abc319b76af0eecaba8e0fe0718457618">platoon_strategic_ihp::PlatoonManager::targetPlatoonID</a></div><div class="ttdeci">std::string targetPlatoonID</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00390">platoon_manager_ihp.h:390</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_abca93088e8980c97a1a24c4fff31c758"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#abca93088e8980c97a1a24c4fff31c758">platoon_strategic_ihp::PlatoonManager::resetNeighborPlatoon</a></div><div class="ttdeci">void resetNeighborPlatoon()</div><div class="ttdoc">Resets all variables that describe a neighbor platoon, so that no neighbor is known.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00313">platoon_manager_ihp.cpp:313</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_abee9a2b28eac60e3a326656ada2d7630"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#abee9a2b28eac60e3a326656ada2d7630">platoon_strategic_ihp::PlatoonManager::getPredecessorSpeed</a></div><div class="ttdeci">double getPredecessorSpeed()</div><div class="ttdoc">UCLA: Return the speed of the preceding vehicle, in m/s.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00803">platoon_manager_ihp.cpp:803</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_ac123534207dc3ea247cfb1281426cd84"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ac123534207dc3ea247cfb1281426cd84">platoon_strategic_ihp::PlatoonManager::getCurrentSpeed</a></div><div class="ttdeci">double getCurrentSpeed() const</div><div class="ttdoc">Returns current speed, in m/s.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00733">platoon_manager_ihp.cpp:733</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_ac7017e74336d2270a0d66249a46c7dbb"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ac7017e74336d2270a0d66249a46c7dbb">platoon_strategic_ihp::PlatoonManager::getCurrentCrosstrackDistance</a></div><div class="ttdeci">double getCurrentCrosstrackDistance() const</div><div class="ttdoc">Returns current crosstrack distance, in m.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00750">platoon_manager_ihp.cpp:750</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_acde63c37282d68d2a407359d735d3446"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acde63c37282d68d2a407359d735d3446">platoon_strategic_ihp::PlatoonManager::getPredecessorTimeHeadwaySum</a></div><div class="ttdeci">double getPredecessorTimeHeadwaySum()</div><div class="ttdoc">UCLA: Return the time headway summation of all predecessors, in s.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00769">platoon_manager_ihp.cpp:769</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_ad0416740bcfdcccbd91a810d8b3ebbd5"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad0416740bcfdcccbd91a810d8b3ebbd5">platoon_strategic_ihp::PlatoonManager::getIHPDesPosFollower</a></div><div class="ttdeci">double getIHPDesPosFollower(double dt)</div><div class="ttdoc">UCLA: Return follower's desired position (i.e., downtrack, in m) that maintains the desired intra-pla...</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00819">platoon_manager_ihp.cpp:819</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_ad408d9fd019a1f61369db874447f4ace"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">platoon_strategic_ihp::PlatoonManager::host_platoon_</a></div><div class="ttdeci">std::vector&lt; PlatoonMember &gt; host_platoon_</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00361">platoon_manager_ihp.h:361</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_ad8aa71d91ef94d4e8d52eca90f700a5b"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad8aa71d91ef94d4e8d52eca90f700a5b">platoon_strategic_ihp::PlatoonManager::timer_factory_</a></div><div class="ttdeci">std::shared_ptr&lt; carma_ros2_utils::timers::TimerFactory &gt; timer_factory_</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00412">platoon_manager_ihp.h:412</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_addb3708590b81f46b27e612b6e945cea"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#addb3708590b81f46b27e612b6e945cea">platoon_strategic_ihp::PlatoonManager::getTimeHeadwayFromIndex</a></div><div class="ttdeci">std::vector&lt; double &gt; getTimeHeadwayFromIndex(std::vector&lt; double &gt; timeHeadways, int start) const</div><div class="ttdoc">Return a sub-vector of the platoon-wise time headaways vector that start with a given index.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00564">platoon_manager_ihp.cpp:564</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_ae067830e0351c8ba271b00cb4a6f15c1"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ae067830e0351c8ba271b00cb4a6f15c1">platoon_strategic_ihp::PlatoonManager::dummyID</a></div><div class="ttdeci">const std::string dummyID</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00358">platoon_manager_ihp.h:358</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_ae696d79ca33f496082ef462fdc9ba53b"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ae696d79ca33f496082ef462fdc9ba53b">platoon_strategic_ihp::PlatoonManager::getHostStaticID</a></div><div class="ttdeci">std::string getHostStaticID() const</div><div class="ttdoc">Returns current host static ID as a string.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00756">platoon_manager_ihp.cpp:756</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_ae747d7f17a417d2fa30227d71925489d"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ae747d7f17a417d2fa30227d71925489d">platoon_strategic_ihp::PlatoonManager::findLowerBoundaryViolationClosestToTheHostVehicle</a></div><div class="ttdeci">int findLowerBoundaryViolationClosestToTheHostVehicle(std::vector&lt; double &gt; timeHeadways) const</div><div class="ttdoc">Find the closest vehicle to the host vehicle that violates the (time headaway) lower boundary conditi...</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00639">platoon_manager_ihp.cpp:639</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_aea48de69a49b77ff87145342a0790363"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#aea48de69a49b77ff87145342a0790363">platoon_strategic_ihp::PlatoonManager::calculateTimeHeadway</a></div><div class="ttdeci">std::vector&lt; double &gt; calculateTimeHeadway(std::vector&lt; double &gt; downtrackDistance, std::vector&lt; double &gt; speed) const</div><div class="ttdoc">Calculate the time headaway of each platoon member and save as a vector.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00585">platoon_manager_ihp.cpp:585</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_aef18115269a340fb9e89452acd05658f"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#aef18115269a340fb9e89452acd05658f">platoon_strategic_ihp::PlatoonManager::neighborMemberUpdates</a></div><div class="ttdeci">void neighborMemberUpdates(const std::string &amp;senderId, const std::string &amp;platoonId, const std::string &amp;params, const double &amp;DtD, const double &amp;CtD)</div><div class="ttdoc">Update information for members of a neighboring platoon based on a mobility operation STATUS message.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00157">platoon_manager_ihp.cpp:157</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_af19d3e4a88f6875cf802442b183694a0"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#af19d3e4a88f6875cf802442b183694a0">platoon_strategic_ihp::PlatoonManager::getCurrentPlatoonLength</a></div><div class="ttdeci">double getCurrentPlatoonLength()</div><div class="ttdoc">Returns overall length of the platoon. in m.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00762">platoon_manager_ihp.cpp:762</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_af2f0d9818d07db4a4df484f988635201"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#af2f0d9818d07db4a4df484f988635201">platoon_strategic_ihp::PlatoonManager::clearActionPlan</a></div><div class="ttdeci">void clearActionPlan()</div><div class="ttdoc">Resets necessary variables to indicate that the current ActionPlan is dead.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00285">platoon_manager_ihp.cpp:285</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_af80fc61208f8a6e2efefdcfcc37ce980"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#af80fc61208f8a6e2efefdcfcc37ce980">platoon_strategic_ihp::PlatoonManager::changeFromFollowerToLeader</a></div><div class="ttdeci">void changeFromFollowerToLeader()</div><div class="ttdoc">Update status when state change from Follower to Leader.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00672">platoon_manager_ihp.cpp:672</a></div></div>
<div class="ttc" id="anamespacecarma__cooperative__perception_html_a64b708654c8aecb09122d39577df31b5"><div class="ttname"><a href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5">carma_cooperative_perception::to_string</a></div><div class="ttdeci">auto to_string(const UtmZone &amp;zone) -&gt; std::string</div><div class="ttdef"><b>Definition:</b> <a href="utm__zone_8cpp_source.html#l00021">utm_zone.cpp:21</a></div></div>
<div class="ttc" id="anamespaceplatoon__strategic__ihp_html"><div class="ttname"><a href="namespaceplatoon__strategic__ihp.html">platoon_strategic_ihp</a></div><div class="ttdef"><b>Definition:</b> <a href="platoon__config__ihp_8h_source.html#l00021">platoon_config_ihp.h:22</a></div></div>
<div class="ttc" id="anamespaceprocess__bag_html_af102a02c97622dd30b0dbf7bafb0d199"><div class="ttname"><a href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">process_bag.i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="process__bag_8py_source.html#l00059">process_bag.py:59</a></div></div>
<div class="ttc" id="anamespaceprocess__traj__logs_html_a3682477a3431f2a4aa182fb9a6439125"><div class="ttname"><a href="namespaceprocess__traj__logs.html#a3682477a3431f2a4aa182fb9a6439125">process_traj_logs.split</a></div><div class="ttdeci">split</div><div class="ttdef"><b>Definition:</b> <a href="process__traj__logs_8py_source.html#l00165">process_traj_logs.py:165</a></div></div>
<div class="ttc" id="aplatoon__config__ihp_8h_html"><div class="ttname"><a href="platoon__config__ihp_8h.html">platoon_config_ihp.h</a></div></div>
<div class="ttc" id="aplatoon__manager__ihp_8h_html"><div class="ttname"><a href="platoon__manager__ihp_8h.html">platoon_manager_ihp.h</a></div></div>
<div class="ttc" id="apointer_8h_html_a32aff7c6c4cd253fdf6563677afab5ce"><div class="ttname"><a href="pointer_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a></div><div class="ttdeci">const GenericPointer&lt; typename T::ValueType &gt; T2 value</div><div class="ttdef"><b>Definition:</b> <a href="pointer_8h_source.html#l01222">pointer.h:1222</a></div></div>
<div class="ttc" id="apointer_8h_html_aeeddce917cf130d62c370b8f216026dd"><div class="ttname"><a href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a></div><div class="ttdeci">const GenericPointer&lt; typename T::ValueType &gt; T2 T::AllocatorType &amp; a</div><div class="ttdef"><b>Definition:</b> <a href="pointer_8h_source.html#l01121">pointer.h:1121</a></div></div>
<div class="ttc" id="astructplatoon__strategic__ihp_1_1ActionPlan_html_a34c7e7384914852c5549e8d2a14dc6e9"><div class="ttname"><a href="structplatoon__strategic__ihp_1_1ActionPlan.html#a34c7e7384914852c5549e8d2a14dc6e9">platoon_strategic_ihp::ActionPlan::planId</a></div><div class="ttdeci">std::string planId</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00049">platoon_manager_ihp.h:49</a></div></div>
<div class="ttc" id="astructplatoon__strategic__ihp_1_1ActionPlan_html_a38851b8c1a54cc039c86fa3576c940e4"><div class="ttname"><a href="structplatoon__strategic__ihp_1_1ActionPlan.html#a38851b8c1a54cc039c86fa3576c940e4">platoon_strategic_ihp::ActionPlan::peerId</a></div><div class="ttdeci">std::string peerId</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00050">platoon_manager_ihp.h:50</a></div></div>
<div class="ttc" id="astructplatoon__strategic__ihp_1_1ActionPlan_html_a9474313cd68557978e8dbd481d0408bc"><div class="ttname"><a href="structplatoon__strategic__ihp_1_1ActionPlan.html#a9474313cd68557978e8dbd481d0408bc">platoon_strategic_ihp::ActionPlan::valid</a></div><div class="ttdeci">bool valid</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00047">platoon_manager_ihp.h:47</a></div></div>
<div class="ttc" id="astructplatoon__strategic__ihp_1_1PlatoonMember_html"><div class="ttname"><a href="structplatoon__strategic__ihp_1_1PlatoonMember.html">platoon_strategic_ihp::PlatoonMember</a></div><div class="ttdoc">Platoon member info.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00096">platoon_manager_ihp.h:97</a></div></div>
<div class="ttc" id="astructplatoon__strategic__ihp_1_1PlatoonMember_html_a142a9b209014ff3b5f08020bdc43f6c2"><div class="ttname"><a href="structplatoon__strategic__ihp_1_1PlatoonMember.html#a142a9b209014ff3b5f08020bdc43f6c2">platoon_strategic_ihp::PlatoonMember::vehiclePosition</a></div><div class="ttdeci">double vehiclePosition</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00105">platoon_manager_ihp.h:105</a></div></div>
<div class="ttc" id="astructplatoon__strategic__ihp_1_1PlatoonMember_html_af1c48353e45a30b01a1d59fdd1a19c9f"><div class="ttname"><a href="structplatoon__strategic__ihp_1_1PlatoonMember.html#af1c48353e45a30b01a1d59fdd1a19c9f">platoon_strategic_ihp::PlatoonMember::staticId</a></div><div class="ttdeci">std::string staticId</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00099">platoon_manager_ihp.h:99</a></div></div>
<div class="ttc" id="astructplatoon__strategic__ihp_1_1PlatoonPluginConfig_html_a0219322f3dd8e56a7be6681e4c77708d"><div class="ttname"><a href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a0219322f3dd8e56a7be6681e4c77708d">platoon_strategic_ihp::PlatoonPluginConfig::ss_theta</a></div><div class="ttdeci">double ss_theta</div><div class="ttdoc">Parameter sets for IHP platoon trajectory regulation algorithm. Please refer to the updated design do...</div><div class="ttdef"><b>Definition:</b> <a href="platoon__config__ihp_8h_source.html#l00078">platoon_config_ihp.h:78</a></div></div>
<div class="ttc" id="astructplatoon__strategic__ihp_1_1PlatoonPluginConfig_html_a02fc34016362627529e4c64fdb231b70"><div class="ttname"><a href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a02fc34016362627529e4c64fdb231b70">platoon_strategic_ihp::PlatoonPluginConfig::significantDTDchange</a></div><div class="ttdeci">double significantDTDchange</div><div class="ttdef"><b>Definition:</b> <a href="platoon__config__ihp_8h_source.html#l00090">platoon_config_ihp.h:90</a></div></div>
<div class="ttc" id="astructplatoon__strategic__ihp_1_1PlatoonPluginConfig_html_a2c210ff37063f1c702ddec0d454238b2"><div class="ttname"><a href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a2c210ff37063f1c702ddec0d454238b2">platoon_strategic_ihp::PlatoonPluginConfig::maxCutinGap</a></div><div class="ttdeci">double maxCutinGap</div><div class="ttdef"><b>Definition:</b> <a href="platoon__config__ihp_8h_source.html#l00061">platoon_config_ihp.h:61</a></div></div>
<div class="ttc" id="astructplatoon__strategic__ihp_1_1PlatoonPluginConfig_html_a48ef7a059feb15a64cb77e29b76eb2b1"><div class="ttname"><a href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a48ef7a059feb15a64cb77e29b76eb2b1">platoon_strategic_ihp::PlatoonPluginConfig::minCutinGap</a></div><div class="ttdeci">double minCutinGap</div><div class="ttdef"><b>Definition:</b> <a href="platoon__config__ihp_8h_source.html#l00060">platoon_config_ihp.h:60</a></div></div>
<div class="ttc" id="astructplatoon__strategic__ihp_1_1PlatoonPluginConfig_html_a52907b228ff49305bd3c1e6977a1dac4"><div class="ttname"><a href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a52907b228ff49305bd3c1e6977a1dac4">platoon_strategic_ihp::PlatoonPluginConfig::createGapAdjuster</a></div><div class="ttdeci">double createGapAdjuster</div><div class="ttdef"><b>Definition:</b> <a href="platoon__config__ihp_8h_source.html#l00066">platoon_config_ihp.h:66</a></div></div>
<div class="ttc" id="astructplatoon__strategic__ihp_1_1PlatoonPluginConfig_html_a590c350d5c11aeba533aa5fddcb73bb2"><div class="ttname"><a href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a590c350d5c11aeba533aa5fddcb73bb2">platoon_strategic_ihp::PlatoonPluginConfig::standstill</a></div><div class="ttdeci">double standstill</div><div class="ttdef"><b>Definition:</b> <a href="platoon__config__ihp_8h_source.html#l00079">platoon_config_ihp.h:79</a></div></div>
<div class="ttc" id="astructplatoon__strategic__ihp_1_1PlatoonPluginConfig_html_a63ddcdd4c1280f41bc9ddb0bc16e2b93"><div class="ttname"><a href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a63ddcdd4c1280f41bc9ddb0bc16e2b93">platoon_strategic_ihp::PlatoonPluginConfig::intra_tau</a></div><div class="ttdeci">double intra_tau</div><div class="ttdef"><b>Definition:</b> <a href="platoon__config__ihp_8h_source.html#l00081">platoon_config_ihp.h:81</a></div></div>
<div class="ttc" id="astructplatoon__strategic__ihp_1_1PlatoonPluginConfig_html_a674f088482c677e215b4842b9b8552f5"><div class="ttname"><a href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a674f088482c677e215b4842b9b8552f5">platoon_strategic_ihp::PlatoonPluginConfig::minAllowableHeadaway</a></div><div class="ttdeci">double minAllowableHeadaway</div><div class="ttdef"><b>Definition:</b> <a href="platoon__config__ihp_8h_source.html#l00055">platoon_config_ihp.h:55</a></div></div>
<div class="ttc" id="astructplatoon__strategic__ihp_1_1PlatoonPluginConfig_html_a75c1cc22d698c88b0772ffa7c664dd24"><div class="ttname"><a href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a75c1cc22d698c88b0772ffa7c664dd24">platoon_strategic_ihp::PlatoonPluginConfig::headawayStableUpperBond</a></div><div class="ttdeci">double headawayStableUpperBond</div><div class="ttdef"><b>Definition:</b> <a href="platoon__config__ihp_8h_source.html#l00058">platoon_config_ihp.h:58</a></div></div>
<div class="ttc" id="astructplatoon__strategic__ihp_1_1PlatoonPluginConfig_html_a7f7c75e78767a304bbca12ce49c91cf8"><div class="ttname"><a href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a7f7c75e78767a304bbca12ce49c91cf8">platoon_strategic_ihp::PlatoonPluginConfig::gap_weight</a></div><div class="ttdeci">double gap_weight</div><div class="ttdef"><b>Definition:</b> <a href="platoon__config__ihp_8h_source.html#l00082">platoon_config_ihp.h:82</a></div></div>
<div class="ttc" id="astructplatoon__strategic__ihp_1_1PlatoonPluginConfig_html_a86f41d2a717f645e273182875afee435"><div class="ttname"><a href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a86f41d2a717f645e273182875afee435">platoon_strategic_ihp::PlatoonPluginConfig::headawayStableLowerBond</a></div><div class="ttdeci">double headawayStableLowerBond</div><div class="ttdef"><b>Definition:</b> <a href="platoon__config__ihp_8h_source.html#l00056">platoon_config_ihp.h:56</a></div></div>
<div class="ttc" id="astructplatoon__strategic__ihp_1_1PlatoonPluginConfig_html_ae1ec2bca75a9c7f5c9f2855007f48fba"><div class="ttname"><a href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#ae1ec2bca75a9c7f5c9f2855007f48fba">platoon_strategic_ihp::PlatoonPluginConfig::vehicleLength</a></div><div class="ttdeci">double vehicleLength</div><div class="ttdef"><b>Definition:</b> <a href="platoon__config__ihp_8h_source.html#l00030">platoon_config_ihp.h:30</a></div></div>
<div class="ttc" id="astructplatoon__strategic__ihp_1_1PlatoonPluginConfig_html_af3ea8d899c219ad4793f649a566fe6e8"><div class="ttname"><a href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#af3ea8d899c219ad4793f649a566fe6e8">platoon_strategic_ihp::PlatoonPluginConfig::maxAllowableHeadaway</a></div><div class="ttdeci">double maxAllowableHeadaway</div><div class="ttdef"><b>Definition:</b> <a href="platoon__config__ihp_8h_source.html#l00057">platoon_config_ihp.h:57</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_0d280ea680cb3816dd23904a40b97608.html">platooning_strategic_IHP</a></li><li class="navelem"><a class="el" href="dir_447d90d857961c60ac8ea0d4ac598dbd.html">src</a></li><li class="navelem"><a class="el" href="platoon__manager__ihp_8cpp.html">platoon_manager_ihp.cpp</a></li>
    <li class="footer">Generated on Thu Feb 1 2024 17:56:51 for Carma-platform by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4 </li>
  </ul>
</div>
</body>
</html>
