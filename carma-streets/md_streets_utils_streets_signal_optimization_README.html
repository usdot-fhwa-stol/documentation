<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Carma-streets: Streets Signal Optimization Library</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Carma-streets<span id="projectnumber">&#160;v4.2.0</span>
   </div>
   <div id="projectbrief">CARMA Streets is a component of CARMA ecosystem that improves the efficiency and performance of the Transportation Systems Management and Operations (TSMO) strategies.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('md_streets_utils_streets_signal_optimization_README.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Streets Signal Optimization Library </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md95"></a>
Introduction</h1>
<p >This library is intended to contain logic for selecting/generating an optimal desired phase plan. This library consists of two main classes: <b>streets_desired_phase_plan_generator</b> and <b>streets_desired_phase_plan_arbitrator</b>. In summary, <b>streets_desired_phase_plan_generator</b> generates a list of candidate desired phase plans where each desired phase plan has one extra fixed future movement group compared with the modified spat. <b>streets_desired_phase_plan_arbitrator</b> selects the one that maximizes/minimizes the objective measure which is a function of vehicle delays.</p>
<h1><a class="anchor" id="autotoc_md96"></a>
streets_desired_phase_plan_generator</h1>
<p >The <b>streets_desired_phase_plan_generator</b> generates a list of candidate desired phase plans. Each desired phase plan has a list of movement groups with their start times, end times, and the included signal groups <a class="el" href="streets__utils_2streets__desired__phase__plan_2README_8md.html">streets_desired_phase_plan library documentation</a>.</p>
<p >The main method is <b>streets_desired_phase_plan_generator::generate_desire_phase_plan_list.()</b> which returns the desired phase plan list and takes the following parameters:</p><ul>
<li>intersection_info pointer (<a class="el" href="classOpenAPI_1_1OAIIntersection__info.html">OpenAPI::OAIIntersection_info</a>), this pointer has the intersection geometry information.</li>
<li>vehicle id to vehicle object (<b>streets_vehicle_list::vehicle</b>) mapping.</li>
<li>intersection_state object from spat (<b><a class="el" href="structsignal__phase__and__timing_1_1intersection__state.html">signal_phase_and_timing::intersection_state</a></b>).</li>
<li>and a list of candidate movement groups (<b><a class="el" href="structstreets__signal__optimization_1_1movement__groups.html">streets_signal_optimization::movement_groups</a></b>). If the returned desired phase plan list is empty, either there are no vehicles that can enter the intersection box during any new fixed future movement group, or the number of fixed future movement groups are greater than or equal to the desired number of fixed futre movement groups.</li>
</ul>
<p ><b>streets_desired_phase_plan_generator</b> allows you to configure the <b>streets_desired_phase_plan_generator_configuration</b> parameters and <b>intersection_info_ptrstreets_vehicle_scheduler::signalized_vehicle_scheduler</b> publicly. Note that if the configuration parameters are not set before <b>streets_desired_phase_plan_generator::generate_desire_phase_plan_list.()</b> method, this method will set the configuration parameters to a set of default values.</p>
<h1><a class="anchor" id="autotoc_md97"></a>
streets_desired phase plan arbitrator</h1>
<p >The desired phase plan arbitrator include a series of steps to choose the optimzied desired phase plan from a list of orignal candidate desired phase plan.</p>
<p >The sample data for incoming list of candidate desire phase plan in JSON format is below:</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  &quot;desired_phase_plan_list&quot;: [</div>
<div class="line">    {</div>
<div class="line">      &quot;timestamp&quot;: 12121212121,</div>
<div class="line">      &quot;desired_phase_plan&quot;: [</div>
<div class="line">        {</div>
<div class="line">          &quot;signal_groups&quot;: [1, 5],//MG A</div>
<div class="line">          &quot;start_time&quot;: 1660747993,</div>
<div class="line">          &quot;end_time&quot;: 1660747998</div>
<div class="line">        },</div>
<div class="line">        {</div>
<div class="line">          &quot;signal_groups&quot;: [2, 6],//MG D</div>
<div class="line">          &quot;start_time&quot;: 1660747993,</div>
<div class="line">          &quot;end_time&quot;: 1660747998</div>
<div class="line">        },</div>
<div class="line">        {</div>
<div class="line">          &quot;signal_groups&quot;: [3, 7],//MG E</div>
<div class="line">          &quot;start_time&quot;: 1660747993,</div>
<div class="line">          &quot;end_time&quot;: 1660747998</div>
<div class="line">        } //Possible option1 //MG E</div>
<div class="line">      ]</div>
<div class="line">    },</div>
<div class="line">    {</div>
<div class="line">        &quot;timestamp&quot;: 12121212121,</div>
<div class="line">        &quot;desired_phase_plan&quot;: [</div>
<div class="line">          {</div>
<div class="line">            &quot;signal_groups&quot;: [1, 5],//MG A</div>
<div class="line">            &quot;start_time&quot;: 1660747993,</div>
<div class="line">            &quot;end_time&quot;: 1660747998</div>
<div class="line">          },</div>
<div class="line">          {</div>
<div class="line">            &quot;signal_groups&quot;: [2, 6],//MG D</div>
<div class="line">            &quot;start_time&quot;: 1660747993,</div>
<div class="line">            &quot;end_time&quot;: 1660747998</div>
<div class="line">          },</div>
<div class="line">          {</div>
<div class="line">            &quot;signal_groups&quot;: [3, 7],//MG E</div>
<div class="line">            &quot;start_time&quot;: 1660747993,</div>
<div class="line">            &quot;end_time&quot;: 1660748998</div>
<div class="line">          } //Possible option2 MG E</div>
<div class="line">        ]</div>
<div class="line">      },</div>
<div class="line">      {</div>
<div class="line">          &quot;timestamp&quot;: 12121212121,</div>
<div class="line">          &quot;desired_phase_plan&quot;: [</div>
<div class="line">            {</div>
<div class="line">              &quot;signal_groups&quot;: [1, 5],//MG A</div>
<div class="line">              &quot;start_time&quot;: 1660747993,</div>
<div class="line">              &quot;end_time&quot;: 1660747998</div>
<div class="line">            },</div>
<div class="line">            {</div>
<div class="line">              &quot;signal_groups&quot;: [2, 6],//MG D</div>
<div class="line">              &quot;start_time&quot;: 1660747993,</div>
<div class="line">              &quot;end_time&quot;: 1660747998</div>
<div class="line">            },</div>
<div class="line">            {</div>
<div class="line">              &quot;signal_groups&quot;: [4,7],//MG E</div>
<div class="line">              &quot;start_time&quot;: 1660747993,</div>
<div class="line">              &quot;end_time&quot;: 1660748998</div>
<div class="line">            } //Possible option3 MG E</div>
<div class="line">          ]</div>
<div class="line">        },</div>
<div class="line">      {</div>
<div class="line">          &quot;timestamp&quot;: 12121212121,</div>
<div class="line">          &quot;desired_phase_plan&quot;: [</div>
<div class="line">            {</div>
<div class="line">              &quot;signal_groups&quot;: [1, 5],//MG A</div>
<div class="line">              &quot;start_time&quot;: 1660747993,</div>
<div class="line">              &quot;end_time&quot;: 1660747998</div>
<div class="line">            },</div>
<div class="line">            {</div>
<div class="line">              &quot;signal_groups&quot;: [2, 6],//MG D</div>
<div class="line">              &quot;start_time&quot;: 1660747993,</div>
<div class="line">              &quot;end_time&quot;: 1660747998</div>
<div class="line">            },</div>
<div class="line">            {</div>
<div class="line">              &quot;signal_groups&quot;: [3,7],//MG E</div>
<div class="line">              &quot;start_time&quot;: 1660747993,</div>
<div class="line">              &quot;end_time&quot;: 1660749998</div>
<div class="line">            } //Possible option4 MG E</div>
<div class="line">          ]</div>
<div class="line">        },</div>
<div class="line">        {</div>
<div class="line">      &quot;timestamp&quot;: 12121212121,</div>
<div class="line">      &quot;desired_phase_plan&quot;: [</div>
<div class="line">        {</div>
<div class="line">          &quot;signal_groups&quot;: [1, 5],//MG A</div>
<div class="line">          &quot;start_time&quot;: 1660747993,</div>
<div class="line">          &quot;end_time&quot;: 1660747998</div>
<div class="line">        },</div>
<div class="line">        {</div>
<div class="line">          &quot;signal_groups&quot;: [2, 6],//MG D</div>
<div class="line">          &quot;start_time&quot;: 1660747993,</div>
<div class="line">          &quot;end_time&quot;: 1660747998</div>
<div class="line">        },</div>
<div class="line">        {</div>
<div class="line">          &quot;signal_groups&quot;: [4, 8],//MG H</div>
<div class="line">          &quot;start_time&quot;: 1660747993,</div>
<div class="line">          &quot;end_time&quot;: 1660747998</div>
<div class="line">        } //Possible option1 //MG H</div>
<div class="line">      ]</div>
<div class="line">    },</div>
<div class="line">    {</div>
<div class="line">        &quot;timestamp&quot;: 12121212121,</div>
<div class="line">        &quot;desired_phase_plan&quot;: [</div>
<div class="line">          {</div>
<div class="line">            &quot;signal_groups&quot;: [1, 5],//MG A</div>
<div class="line">            &quot;start_time&quot;: 1660747993,</div>
<div class="line">            &quot;end_time&quot;: 1660747998</div>
<div class="line">          },</div>
<div class="line">          {</div>
<div class="line">            &quot;signal_groups&quot;: [2, 6],//MG D</div>
<div class="line">            &quot;start_time&quot;: 1660747993,</div>
<div class="line">            &quot;end_time&quot;: 1660747998</div>
<div class="line">          },</div>
<div class="line">          {</div>
<div class="line">            &quot;signal_groups&quot;:  [4, 8],//MG H</div>
<div class="line">            &quot;start_time&quot;: 1660747993,</div>
<div class="line">            &quot;end_time&quot;: 1660748998</div>
<div class="line">          } //Possible option2 MG H</div>
<div class="line">        ]</div>
<div class="line">      },</div>
<div class="line">      {</div>
<div class="line">          &quot;timestamp&quot;: 12121212121,</div>
<div class="line">          &quot;desired_phase_plan&quot;: [</div>
<div class="line">            {</div>
<div class="line">              &quot;signal_groups&quot;: [1, 5],//MG A</div>
<div class="line">              &quot;start_time&quot;: 1660747993,</div>
<div class="line">              &quot;end_time&quot;: 1660747998</div>
<div class="line">            },</div>
<div class="line">            {</div>
<div class="line">              &quot;signal_groups&quot;: [2, 6],//MG D</div>
<div class="line">              &quot;start_time&quot;: 1660747993,</div>
<div class="line">              &quot;end_time&quot;: 1660747998</div>
<div class="line">            },</div>
<div class="line">            {</div>
<div class="line">              &quot;signal_groups&quot;:  [4, 8],//MG H</div>
<div class="line">              &quot;start_time&quot;: 1660747993,</div>
<div class="line">              &quot;end_time&quot;: 1660748998</div>
<div class="line">            } //Possible option3 MG H</div>
<div class="line">          ]</div>
<div class="line">        },</div>
<div class="line">      {</div>
<div class="line">          &quot;timestamp&quot;: 12121212121,</div>
<div class="line">          &quot;desired_phase_plan&quot;: [</div>
<div class="line">            {</div>
<div class="line">              &quot;signal_groups&quot;: [1, 5],//MG A</div>
<div class="line">              &quot;start_time&quot;: 1660747993,</div>
<div class="line">              &quot;end_time&quot;: 1660747998</div>
<div class="line">            },</div>
<div class="line">            {</div>
<div class="line">              &quot;signal_groups&quot;: [2, 6],//MG D</div>
<div class="line">              &quot;start_time&quot;: 1660747993,</div>
<div class="line">              &quot;end_time&quot;: 1660747998</div>
<div class="line">            },</div>
<div class="line">            {</div>
<div class="line">              &quot;signal_groups&quot;:  [4, 8],//MG H</div>
<div class="line">              &quot;start_time&quot;: 1660747993,</div>
<div class="line">              &quot;end_time&quot;: 1660749998</div>
<div class="line">            } //Possible option4 MG H</div>
<div class="line">          ]</div>
<div class="line">        }</div>
<div class="line">  ]</div>
<div class="line">}</div>
</div><!-- fragment --><ul>
<li>Signal group: A single movement or group of movements in an intersection that are controlled by a single phase. <img src="https://user-images.githubusercontent.com/62157949/194932912-faca0739-7212-452c-a723-8f446f90ac00.png" alt="image" class="inline"/></li>
<li>Step 1: Iterate over all movement groups in each candidate desired phase plan.<ul>
<li>Step 2: Make a local copy of SPAT and Update SPAT with each candidate desired phase plan iteration</li>
<li>Step 3: Given the SPAT and list of vehicles near the intersection, calculating estimated entering time (ET) and get vehicles' schedule</li>
<li>Step 4: Given vehicle schedule, calculating delay measure. Keep track of each candidate desired phase plan and delay measure mapping</li>
</ul>
</li>
<li>Step 5: Find the highest delay measure, its mapping candidate desired phase plan is the chosen desired phase plan.</li>
</ul>
<h2><a class="anchor" id="autotoc_md98"></a>
Use of desired phase plan arbitrator lib</h2>
<ul>
<li>streets_desired_phase_plan_arbitrator class provides algorithm or call other library to determine the optimized desired phase plan.</li>
</ul>
<div class="fragment"><div class="line">streets_desired_phase_plan select_optimal_dpp( </div>
<div class="line">                  dpp_list, </div>
<div class="line">                  intersection_info_ptr, </div>
<div class="line">                  spat_ptr, </div>
<div class="line">                  tsc_config_state, </div>
<div class="line">                  veh_list_ptr, </div>
<div class="line">                  initial_green_buffer, </div>
<div class="line">                  inal_green_buffer)</div>
<div class="line"> </div>
<div class="line">Type Parameters:</div>
<div class="line">  dpp_list - std::vector&lt;streets_desired_phase_plan::streets_desired_phase_plan&gt;</div>
<div class="line">  intersection_info_ptr - std::shared_ptr&lt;OpenAPI::OAIIntersection_info&gt; </div>
<div class="line">  spat_ptr - std::shared_ptr&lt;signal_phase_and_timing::spat&gt;</div>
<div class="line">  tsc_config_state - std::shared_ptr&lt;streets_tsc_configuration::tsc_configuration_state&gt;</div>
<div class="line">  veh_list_ptr - const std::shared_ptr&lt;streets_vehicles::vehicle_list&gt;</div>
<div class="line">  initial_green_buffer - uint64_t</div>
<div class="line">  final_green_buffer - uint64_t</div>
<div class="line"> </div>
<div class="line">Parameters:</div>
<div class="line">  dpp_list - List of candidate desired phase plan list</div>
<div class="line">  intersection_info_ptr - A pointer to intersection model information </div>
<div class="line">  spat_ptr - Streets defined signal timing and phasing message type</div>
<div class="line">  tsc_config_state - Traffic signal controller configuration state</div>
<div class="line">  veh_list_ptr - A pointer to a list of vehicles</div>
<div class="line">  initial_green_buffer - Configuration parameter for initial green buffer</div>
<div class="line">  final_green_buffer - Configuration parameter for final green buffer</div>
<div class="line"> </div>
<div class="line">Returns:</div>
<div class="line">  An instance of desired phase plan.</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Tue Jun 6 2023 22:17:06 for Carma-streets by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4 </li>
  </ul>
</div>
</body>
</html>
