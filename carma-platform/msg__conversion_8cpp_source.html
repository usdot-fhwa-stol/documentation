<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Carma-platform: carma_cooperative_perception/src/msg_conversion.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Carma-platform<span id="projectnumber">&#160;v4.2.0</span>
   </div>
   <div id="projectbrief">CARMA Platform is built on robot operating system (ROS) and utilizes open source software (OSS) that enables Cooperative Driving Automation (CDA) features to allow Automated Driving Systems to interact and cooperate with infrastructure and other vehicles through communication.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('msg__conversion_8cpp_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle"><div class="title">msg_conversion.cpp</div></div>
</div><!--header-->
<div class="contents">
<a href="msg__conversion_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">// Copyright 2023 Leidos</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment">//</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment">// you may not use this file except in compliance with the License.</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment">// You may obtain a copy of the License at</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="comment">//</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="comment">//     http://www.apache.org/licenses/LICENSE-2.0</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="comment">//</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="comment">// Unless required by applicable law or agreed to in writing, software</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="comment">// distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="comment">// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="comment">// See the License for the specific language governing permissions and</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="comment">// limitations under the License.</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span> </div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="preprocessor">#include &quot;<a class="code" href="msg__conversion_8hpp.html">carma_cooperative_perception/msg_conversion.hpp</a>&quot;</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span> </div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="preprocessor">#include &lt;tf2_geometry_msgs/tf2_geometry_msgs.h&gt;</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="preprocessor">#include &lt;carma_cooperative_perception_interfaces/msg/track.hpp&gt;</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="preprocessor">#include &lt;carma_cooperative_perception_interfaces/msg/track_list.hpp&gt;</span></div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span><span class="preprocessor">#include &lt;carma_perception_msgs/msg/external_object.hpp&gt;</span></div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="preprocessor">#include &lt;carma_perception_msgs/msg/external_object_list.hpp&gt;</span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span><span class="preprocessor">#include &lt;j2735_v2x_msgs/msg/d_date_time.hpp&gt;</span></div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span><span class="preprocessor">#include &lt;j2735_v2x_msgs/msg/personal_device_user_type.hpp&gt;</span></div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span><span class="preprocessor">#include &lt;j2735_v2x_msgs/to_floating_point.hpp&gt;</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span><span class="preprocessor">#include &lt;j3224_v2x_msgs/msg/detected_object_data.hpp&gt;</span></div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span><span class="preprocessor">#include &lt;j3224_v2x_msgs/msg/measurement_time_offset.hpp&gt;</span></div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span><span class="preprocessor">#include &lt;j3224_v2x_msgs/msg/object_type.hpp&gt;</span></div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span> </div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span><span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span><span class="preprocessor">#include &lt;cctype&gt;</span></div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span><span class="preprocessor">#include &lt;charconv&gt;</span></div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span><span class="preprocessor">#include &lt;chrono&gt;</span></div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span><span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span><span class="preprocessor">#include &lt;limits&gt;</span></div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span><span class="preprocessor">#include &lt;numeric&gt;</span></div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span><span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span><span class="preprocessor">#include &lt;utility&gt;</span></div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span> </div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span><span class="preprocessor">#include &lt;proj.h&gt;</span></div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span><span class="preprocessor">#include &lt;gsl/pointers&gt;</span></div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span><span class="preprocessor">#include &lt;memory&gt;</span></div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span> </div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span><span class="preprocessor">#include &quot;<a class="code" href="geodetic_8hpp.html">carma_cooperative_perception/geodetic.hpp</a>&quot;</span></div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span><span class="preprocessor">#include &quot;<a class="code" href="j2735__types_8hpp.html">carma_cooperative_perception/j2735_types.hpp</a>&quot;</span></div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span><span class="preprocessor">#include &quot;<a class="code" href="j3224__types_8hpp.html">carma_cooperative_perception/j3224_types.hpp</a>&quot;</span></div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span><span class="preprocessor">#include &quot;<a class="code" href="units__extensions_8hpp.html">carma_cooperative_perception/units_extensions.hpp</a>&quot;</span></div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span> </div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span><span class="preprocessor">#include &lt;lanelet2_core/geometry/Lanelet.h&gt;</span></div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span><span class="preprocessor">#include &lt;lanelet2_extension/projection/local_frame_projector.h&gt;</span></div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span><span class="preprocessor">#include &lt;boost/date_time/posix_time/conversion.hpp&gt;</span></div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span><span class="preprocessor">#include &lt;boost/date_time/posix_time/posix_time_io.hpp&gt;</span></div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span><span class="preprocessor">#include &quot;boost/date_time/posix_time/posix_time.hpp&quot;</span></div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span> </div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span><span class="keyword">namespace </span><a class="code hl_namespace" href="namespacecarma__cooperative__perception.html">carma_cooperative_perception</a></div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span>{</div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno"><a class="line" href="namespacecarma__cooperative__perception.html#a93be41b790d86ff89621727ece68aee0">   56</a></span><span class="keyword">auto</span> <a class="code hl_function" href="namespacecarma__cooperative__perception.html#a93be41b790d86ff89621727ece68aee0">to_time_msg</a>(<span class="keyword">const</span> <a class="code hl_struct" href="structcarma__cooperative__perception_1_1DDateTime.html">DDateTime</a> &amp; d_date_time) -&gt; builtin_interfaces::msg::Time</div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span>{</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>  <span class="keywordtype">double</span> seconds;</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span>  <span class="keyword">const</span> <span class="keyword">auto</span> fractional_secs{</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>    std::modf(<a class="code hl_function" href="namespacecarma__cooperative__perception.html#adab0ef7041c6108afdad006aa2c59c2f">remove_units</a>(d_date_time.second.value_or(units::time::second_t{0.0})), &amp;seconds)};</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span> </div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span>  builtin_interfaces::msg::Time msg;</div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>  msg.sec = <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="stdint_8h.html#ab1967d8591af1a4e48c37fd2b0f184d0">std::int32_t</a><span class="keyword">&gt;</span>(seconds);</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span>  msg.nanosec = <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="stdint_8h.html#ab1967d8591af1a4e48c37fd2b0f184d0">std::int32_t</a><span class="keyword">&gt;</span>(fractional_secs * 1e9);</div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span> </div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span>  <span class="keywordflow">return</span> msg;</div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>}</div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span> </div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno"><a class="line" href="namespacecarma__cooperative__perception.html#a5cff4b79b8e989798643db61de547f33">   69</a></span><span class="keyword">auto</span> <a class="code hl_function" href="namespacecarma__cooperative__perception.html#a5cff4b79b8e989798643db61de547f33">calc_detection_time_stamp</a>(<a class="code hl_struct" href="structcarma__cooperative__perception_1_1DDateTime.html">DDateTime</a> sdsm_time, <span class="keyword">const</span> <a class="code hl_struct" href="structcarma__cooperative__perception_1_1MeasurementTimeOffset.html">MeasurementTimeOffset</a> &amp; offset)</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>  -&gt; <a class="code hl_struct" href="structcarma__cooperative__perception_1_1DDateTime.html">DDateTime</a></div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>{</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>  sdsm_time.<a class="code hl_variable" href="structcarma__cooperative__perception_1_1DDateTime.html#ae869970cf347d99db44f14bdefd07015">second</a>.value() += offset.measurement_time_offset;</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span> </div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>  <span class="keywordflow">return</span> sdsm_time;</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>}</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span> </div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno"><a class="line" href="namespacecarma__cooperative__perception.html#a7a17e53626d5605eac626f1865b50bbc">   77</a></span><span class="keyword">auto</span> <a class="code hl_function" href="namespacecarma__cooperative__perception.html#a7a17e53626d5605eac626f1865b50bbc">ned_to_enu</a>(<span class="keyword">const</span> <a class="code hl_struct" href="structcarma__cooperative__perception_1_1PositionOffsetXYZ.html">PositionOffsetXYZ</a> &amp; offset_ned) <span class="keyword">noexcept</span></div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>{</div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>  <span class="keyword">auto</span> offset_enu{offset_ned};</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span> </div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>  <span class="comment">// NED to ENU: swap x and y axis and negate z axis</span></div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>  offset_enu.offset_x = offset_ned.offset_y;</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>  offset_enu.offset_y = offset_ned.offset_x;</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span> </div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>  <span class="keywordflow">if</span> (offset_enu.offset_z) {</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>    offset_enu.offset_z.value() *= -1;</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>  }</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span> </div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>  <span class="keywordflow">return</span> offset_enu;</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>}</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span> </div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno"><a class="line" href="namespacecarma__cooperative__perception.html#a474b64d6a2ea8e06828f03e3aca6dccb">   92</a></span><span class="keyword">auto</span> <a class="code hl_function" href="namespacecarma__cooperative__perception.html#a474b64d6a2ea8e06828f03e3aca6dccb">to_ddate_time_msg</a>(<span class="keyword">const</span> builtin_interfaces::msg::Time &amp; builtin_time)</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>  -&gt; j2735_v2x_msgs::msg::DDateTime</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>{</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>  j2735_v2x_msgs::msg::DDateTime ddate_time_output;</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span> </div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>  <span class="comment">// Add the time components from epoch seconds</span></div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>  boost::posix_time::ptime posix_time = boost::posix_time::from_time_t(builtin_time.sec) +</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>                                        boost::posix_time::nanosec(builtin_time.nanosec);</div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span> </div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>  <span class="keyword">const</span> <span class="keyword">auto</span> time_stamp_year = posix_time.date().year();</div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>  <span class="keyword">const</span> <span class="keyword">auto</span> time_stamp_month = posix_time.date().month();</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>  <span class="keyword">const</span> <span class="keyword">auto</span> time_stamp_day = posix_time.date().day();</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span> </div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>  <span class="keyword">const</span> <span class="keyword">auto</span> hours_of_day = posix_time.time_of_day().hours();</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>  <span class="keyword">const</span> <span class="keyword">auto</span> minutes_of_hour = posix_time.time_of_day().minutes();</div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>  <span class="keyword">const</span> <span class="keyword">auto</span> seconds_of_minute = posix_time.time_of_day().seconds();</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span> </div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>  ddate_time_output.presence_vector = 0;</div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span> </div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>  ddate_time_output.presence_vector |= j2735_v2x_msgs::msg::DDateTime::YEAR;</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>  ddate_time_output.year.year = time_stamp_year;</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>  ddate_time_output.presence_vector |= j2735_v2x_msgs::msg::DDateTime::MONTH;</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>  ddate_time_output.month.month = time_stamp_month;</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>  ddate_time_output.presence_vector |= j2735_v2x_msgs::msg::DDateTime::DAY;</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>  ddate_time_output.day.day = time_stamp_day;</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>  ddate_time_output.presence_vector |= j2735_v2x_msgs::msg::DDateTime::HOUR;</div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>  ddate_time_output.hour.hour = hours_of_day;</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>  ddate_time_output.presence_vector |= j2735_v2x_msgs::msg::DDateTime::MINUTE;</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>  ddate_time_output.minute.minute = minutes_of_hour;</div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>  ddate_time_output.presence_vector |= j2735_v2x_msgs::msg::DDateTime::SECOND;</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>  ddate_time_output.second.millisecond = seconds_of_minute;</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span> </div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>  <span class="keywordflow">return</span> ddate_time_output;</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>}</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span> </div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno"><a class="line" href="namespacecarma__cooperative__perception.html#a1af75f3bf9d8fb2977056c0f870374d4">  127</a></span><span class="keyword">auto</span> <a class="code hl_function" href="namespacecarma__cooperative__perception.html#a1af75f3bf9d8fb2977056c0f870374d4">calc_sdsm_time_offset</a>(</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>  <span class="keyword">const</span> builtin_interfaces::msg::Time &amp; external_object_list_stamp,</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>  <span class="keyword">const</span> builtin_interfaces::msg::Time &amp; external_object_stamp)</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>  -&gt; carma_v2x_msgs::msg::MeasurementTimeOffset</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>{</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>  carma_v2x_msgs::msg::MeasurementTimeOffset time_offset;</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span> </div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>  boost::posix_time::ptime external_object_list_time =</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>    boost::posix_time::from_time_t(external_object_list_stamp.sec) +</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>    boost::posix_time::nanosec(external_object_list_stamp.nanosec);</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span> </div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>  boost::posix_time::ptime external_object_time =</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>    boost::posix_time::from_time_t(external_object_stamp.sec) +</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>    boost::posix_time::nanosec(external_object_stamp.nanosec);</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span> </div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>  boost::posix_time::time_duration offset_duration =</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>    (external_object_list_time - external_object_time);</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span> </div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>  time_offset.measurement_time_offset = offset_duration.total_seconds();</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span> </div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>  <span class="keywordflow">return</span> time_offset;</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>}</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span> </div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno"><a class="line" href="namespacecarma__cooperative__perception.html#ae31d51adeb5455f98be9395fb9d863a9">  150</a></span><span class="keyword">auto</span> <a class="code hl_function" href="namespacecarma__cooperative__perception.html#ae31d51adeb5455f98be9395fb9d863a9">to_position_msg</a>(<span class="keyword">const</span> <a class="code hl_struct" href="structcarma__cooperative__perception_1_1UtmCoordinate.html">UtmCoordinate</a> &amp; position_utm) -&gt; geometry_msgs::msg::Point</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>{</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>  geometry_msgs::msg::Point msg;</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span> </div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>  msg.x = <a class="code hl_function" href="namespacecarma__cooperative__perception.html#adab0ef7041c6108afdad006aa2c59c2f">remove_units</a>(position_utm.easting);</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>  msg.y = <a class="code hl_function" href="namespacecarma__cooperative__perception.html#adab0ef7041c6108afdad006aa2c59c2f">remove_units</a>(position_utm.northing);</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>  msg.z = <a class="code hl_function" href="namespacecarma__cooperative__perception.html#adab0ef7041c6108afdad006aa2c59c2f">remove_units</a>(position_utm.elevation);</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span> </div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>  <span class="keywordflow">return</span> msg;</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>}</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span> </div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno"><a class="line" href="namespacecarma__cooperative__perception.html#a4a3797a06bb3299d1381b49df84429e5">  161</a></span><span class="keyword">auto</span> <a class="code hl_function" href="namespacecarma__cooperative__perception.html#ae31d51adeb5455f98be9395fb9d863a9">to_position_msg</a>(<span class="keyword">const</span> <a class="code hl_struct" href="structcarma__cooperative__perception_1_1MapCoordinate.html">MapCoordinate</a> &amp; position_map) -&gt; geometry_msgs::msg::Point</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>{</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>  geometry_msgs::msg::Point msg;</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span> </div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>  msg.x = <a class="code hl_function" href="namespacecarma__cooperative__perception.html#adab0ef7041c6108afdad006aa2c59c2f">remove_units</a>(position_map.easting);</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>  msg.y = <a class="code hl_function" href="namespacecarma__cooperative__perception.html#adab0ef7041c6108afdad006aa2c59c2f">remove_units</a>(position_map.northing);</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>  msg.z = <a class="code hl_function" href="namespacecarma__cooperative__perception.html#adab0ef7041c6108afdad006aa2c59c2f">remove_units</a>(position_map.elevation);</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span> </div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>  <span class="keywordflow">return</span> msg;</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>}</div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span> </div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno"><a class="line" href="namespacecarma__cooperative__perception.html#aa0ac6f02134ae7a4a1909c51c4ba6d2e">  172</a></span><span class="keyword">auto</span> <a class="code hl_function" href="namespacecarma__cooperative__perception.html#aa0ac6f02134ae7a4a1909c51c4ba6d2e">heading_to_enu_yaw</a>(<span class="keyword">const</span> units::angle::degree_t &amp; heading) -&gt; units::angle::degree_t</div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>{</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>  <span class="keywordflow">return</span> units::angle::degree_t{std::fmod(-(<a class="code hl_function" href="namespacecarma__cooperative__perception.html#adab0ef7041c6108afdad006aa2c59c2f">remove_units</a>(heading) - 90.0) + 360.0, 360.0)};</div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>}</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span> </div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno"><a class="line" href="namespacecarma__cooperative__perception.html#a067dbaa6dc9efb21503e30ac03908c7d">  177</a></span><span class="keyword">auto</span> <a class="code hl_function" href="namespacecarma__cooperative__perception.html#a067dbaa6dc9efb21503e30ac03908c7d">enu_orientation_to_true_heading</a>(</div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>  <span class="keywordtype">double</span> yaw, <span class="keyword">const</span> lanelet::BasicPoint3d &amp; obj_pose,</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>  <span class="keyword">const</span> std::shared_ptr&lt;lanelet::projection::LocalFrameProjector&gt; &amp; map_projection)</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>  -&gt; units::angle::degree_t</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>{</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>  <span class="comment">// Get object geodetic position</span></div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>  lanelet::GPSPoint wgs_obj_pose = map_projection-&gt;reverse(obj_pose);</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span> </div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>  <span class="comment">// Get WGS84 Heading</span></div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>  gsl::owner&lt;PJ_CONTEXT *&gt; context = proj_context_create();</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>  gsl::owner&lt;PJ *&gt; transform = proj_create(context, map_projection-&gt;ECEF_PROJ_STR);</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>  units::angle::degree_t grid_heading{std::fmod(90 - yaw + 360, 360)};</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span> </div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>  <span class="keyword">const</span> <span class="keyword">auto</span> factors = proj_factors(</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>    transform, proj_coord(proj_torad(wgs_obj_pose.lon), proj_torad(wgs_obj_pose.lat), 0, 0));</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>  units::angle::degree_t grid_convergence{proj_todeg(factors.meridian_convergence)};</div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span> </div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>  <span class="keyword">auto</span> wgs_heading = grid_convergence + grid_heading;</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span> </div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>  proj_destroy(transform);</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>  proj_context_destroy(context);</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span> </div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>  <span class="keywordflow">return</span> wgs_heading;</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>}</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span> </div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span><span class="comment">// determine the object position offset in m from the current reference pose</span></div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span><span class="comment">// in map frame and external object pose</span></div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno"><a class="line" href="namespacecarma__cooperative__perception.html#aa241195bfca659e39d36f0c72cbe7dde">  204</a></span><span class="keyword">auto</span> <a class="code hl_function" href="namespacecarma__cooperative__perception.html#aa241195bfca659e39d36f0c72cbe7dde">calc_relative_position</a>(</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>  <span class="keyword">const</span> geometry_msgs::msg::PoseStamped &amp; source_pose,</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>  <span class="keyword">const</span> carma_v2x_msgs::msg::PositionOffsetXYZ &amp; position_offset)</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>  -&gt; carma_v2x_msgs::msg::PositionOffsetXYZ</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>{</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>  carma_v2x_msgs::msg::PositionOffsetXYZ adjusted_offset;</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span> </div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>  adjusted_offset.offset_x.object_distance =</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>    position_offset.offset_x.object_distance - source_pose.pose.position.x;</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>  adjusted_offset.offset_y.object_distance =</div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>    position_offset.offset_y.object_distance - source_pose.pose.position.y;</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>  adjusted_offset.offset_z.object_distance =</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>    position_offset.offset_z.object_distance - source_pose.pose.position.z;</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>  adjusted_offset.presence_vector = carma_v2x_msgs::msg::PositionOffsetXYZ::HAS_OFFSET_Z;</div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span> </div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>  <span class="keywordflow">return</span> adjusted_offset;</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>}</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span> </div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno"><a class="line" href="namespacecarma__cooperative__perception.html#afc3289cc4274cc16b86cbb6f169b149b">  222</a></span><span class="keyword">auto</span> <a class="code hl_function" href="namespacecarma__cooperative__perception.html#afc3289cc4274cc16b86cbb6f169b149b">transform_pose_from_map_to_wgs84</a>(</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>  <span class="keyword">const</span> geometry_msgs::msg::PoseStamped &amp; source_pose,</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>  <span class="keyword">const</span> std::shared_ptr&lt;lanelet::projection::LocalFrameProjector&gt; &amp; map_projection)</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>  -&gt; carma_v2x_msgs::msg::Position3D</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>{</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>  carma_v2x_msgs::msg::Position3D ref_pos;</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>  lanelet::BasicPoint3d source_pose_basicpoint{</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>    source_pose.pose.position.x, source_pose.pose.position.y, 0.0};</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span> </div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>  lanelet::GPSPoint wgs84_ref_pose = map_projection-&gt;reverse(source_pose_basicpoint);</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span> </div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>  ref_pos.longitude = wgs84_ref_pose.lon;</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>  ref_pos.latitude = wgs84_ref_pose.lat;</div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>  ref_pos.elevation = wgs84_ref_pose.ele;</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>  ref_pos.elevation_exists = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span> </div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>  <span class="keywordflow">return</span> ref_pos;</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>}</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span> </div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno"><a class="line" href="namespacecarma__cooperative__perception.html#a0744e4e2672612a387326dbef5e5b632">  241</a></span><span class="keyword">auto</span> <a class="code hl_function" href="namespacecarma__cooperative__perception.html#a0744e4e2672612a387326dbef5e5b632">to_detection_list_msg</a>(</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>  <span class="keyword">const</span> carma_v2x_msgs::msg::SensorDataSharingMessage &amp; sdsm, std::string_view georeference)</div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>  -&gt; carma_cooperative_perception_interfaces::msg::DetectionList</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>{</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>  carma_cooperative_perception_interfaces::msg::DetectionList detection_list;</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span> </div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>  <span class="keyword">const</span> <span class="keyword">auto</span> ref_pos_3d{<a class="code hl_function" href="structcarma__cooperative__perception_1_1Position3D.html#af394078671528953d9717b750a595168">Position3D::from_msg</a>(sdsm.ref_pos)};</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>  <span class="keyword">const</span> <a class="code hl_struct" href="structcarma__cooperative__perception_1_1Wgs84Coordinate.html">Wgs84Coordinate</a> ref_pos_wgs84{</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>    ref_pos_3d.<a class="code hl_variable" href="structcarma__cooperative__perception_1_1Wgs84Coordinate.html#aeadbc11ce34d77b0057824fe52cea8dd">latitude</a>, ref_pos_3d.longitude, ref_pos_3d.elevation.value()};</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>  <span class="keyword">const</span> <span class="keyword">auto</span> ref_pos_map{<a class="code hl_function" href="namespacecarma__cooperative__perception.html#a62911a303fe3652fb937a2503b563e21">project_to_carma_map</a>(ref_pos_wgs84, georeference)};</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span> </div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; object_data : sdsm.objects.detected_object_data) {</div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>    <span class="keyword">const</span> <span class="keyword">auto</span> common_data{object_data.detected_object_common_data};</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span> </div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>    <a class="code hl_typedef" href="namespacecarma__cooperative__perception.html#a5e779cee7548e2a337b47a4d41dbb7c1">carma_cooperative_perception_interfaces::msg::Detection</a> detection;</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>    detection.header.frame_id = <span class="stringliteral">&quot;map&quot;</span>;</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span> </div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>    <span class="keyword">const</span> <span class="keyword">auto</span> detection_time{<a class="code hl_function" href="namespacecarma__cooperative__perception.html#a5cff4b79b8e989798643db61de547f33">calc_detection_time_stamp</a>(</div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>      <a class="code hl_function" href="structcarma__cooperative__perception_1_1DDateTime.html#aa652587c61d227c825f9b82fc4784915">DDateTime::from_msg</a>(sdsm.sdsm_time_stamp),</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>      <a class="code hl_function" href="structcarma__cooperative__perception_1_1MeasurementTimeOffset.html#a0820c7b605ed0293419b10b8f7eee715">MeasurementTimeOffset::from_msg</a>(common_data.measurement_time))};</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span> </div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>    detection.header.stamp = <a class="code hl_function" href="namespacecarma__cooperative__perception.html#a93be41b790d86ff89621727ece68aee0">to_time_msg</a>(detection_time);</div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span> </div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>    <span class="comment">// TemporaryID and octet string terms come from the SAE J2735 message definitions</span></div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>    <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keyword">auto</span> <a class="code hl_function" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5">to_string</a> = [](<span class="keyword">const</span> std::vector&lt;std::uint8_t&gt; &amp; temporary_id) {</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>      std::string str;</div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>      str.reserve(2 * std::size(temporary_id));  <span class="comment">// Two hex characters per octet string</span></div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span> </div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>      std::array&lt;char, 2&gt; buffer;</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; octet_string : temporary_id) {</div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>        std::to_chars(std::begin(buffer), std::end(buffer), octet_string, 16);</div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>        str.push_back(std::toupper(std::get&lt;0&gt;(buffer)));</div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>        str.push_back(std::toupper(std::get&lt;1&gt;(buffer)));</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>      }</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span> </div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>      <span class="keywordflow">return</span> str;</div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>    };</div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span> </div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>    detection.id =</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>      <a class="code hl_function" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5">to_string</a>(sdsm.source_id.id) + <span class="stringliteral">&quot;-&quot;</span> + <a class="code hl_function" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5">std::to_string</a>(common_data.detected_id.object_id);</div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span> </div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>    <span class="keyword">const</span> <span class="keyword">auto</span> pos_offset_enu{<a class="code hl_function" href="namespacecarma__cooperative__perception.html#a7a17e53626d5605eac626f1865b50bbc">ned_to_enu</a>(<a class="code hl_function" href="structcarma__cooperative__perception_1_1PositionOffsetXYZ.html#a094715553928cccc0c23616e8f4e2654">PositionOffsetXYZ::from_msg</a>(common_data.pos))};</div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>    detection.pose.pose.position = <a class="code hl_function" href="namespacecarma__cooperative__perception.html#ae31d51adeb5455f98be9395fb9d863a9">to_position_msg</a>(<a class="code hl_struct" href="structcarma__cooperative__perception_1_1MapCoordinate.html">MapCoordinate</a>{</div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>      ref_pos_map.<a class="code hl_variable" href="structcarma__cooperative__perception_1_1MapCoordinate.html#a70ca6b501f497dba865ea4b3333b04da">easting</a> + pos_offset_enu.offset_x, ref_pos_map.northing + pos_offset_enu.offset_y,</div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>      ref_pos_map.elevation + pos_offset_enu.offset_z.value_or(units::length::meter_t{0.0})});</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span> </div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>    <span class="comment">// Pose covariance is flattened 6x6 matrix with rows/columns of x, y, z, roll, pitch, yaw</span></div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>    <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>      detection.pose.covariance.at(0) =</div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>        0.5 * std::pow(j2735_v2x_msgs::to_double(common_data.pos_confidence.pos).value(), 2);</div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>      detection.pose.covariance.at(7) =</div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>        0.5 * std::pow(j2735_v2x_msgs::to_double(common_data.pos_confidence.pos).value(), 2);</div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::bad_optional_access &amp;) {</div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>      <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;missing position confidence&quot;</span>);</div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>    }</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span> </div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>    <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>      detection.pose.covariance.at(14) =</div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>        0.5 * std::pow(j2735_v2x_msgs::to_double(common_data.pos_confidence.elevation).value(), 2);</div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::bad_optional_access &amp;) {</div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>      <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;missing elevation confidence&quot;</span>);</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>    }</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span> </div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>    <span class="keyword">const</span> <span class="keyword">auto</span> true_heading{units::angle::degree_t{<a class="code hl_function" href="structcarma__cooperative__perception_1_1Heading.html#a489e9438fe854b7b4570a5258e40b8bc">Heading::from_msg</a>(common_data.heading).heading}};</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span> </div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>    <span class="comment">// Note: This should really use the detection&#39;s WGS-84 position, so the</span></div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>    <span class="comment">// convergence will be off slightly. TODO</span></div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>    <span class="keyword">const</span> units::angle::degree_t grid_convergence{</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>      <a class="code hl_function" href="namespacecarma__cooperative__perception.html#a3bd1f30dbbb27e495fb1733fe2133e3a">calculate_grid_convergence</a>(ref_pos_wgs84, georeference)};</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span> </div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>    <span class="keyword">const</span> <span class="keyword">auto</span> grid_heading{true_heading - grid_convergence};</div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>    <span class="keyword">const</span> <span class="keyword">auto</span> enu_yaw{<a class="code hl_function" href="namespacecarma__cooperative__perception.html#aa0ac6f02134ae7a4a1909c51c4ba6d2e">heading_to_enu_yaw</a>(grid_heading)};</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span> </div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>    tf2::Quaternion quat_tf;</div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>    quat_tf.setRPY(0, 0, <a class="code hl_function" href="namespacecarma__cooperative__perception.html#adab0ef7041c6108afdad006aa2c59c2f">remove_units</a>(units::angle::radian_t{enu_yaw}));</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span>    detection.pose.pose.orientation = tf2::toMsg(quat_tf);</div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span> </div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>    <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>      <span class="comment">// Pose covariance is flattened 6x6 matrix with rows/columns of x, y, z, roll, pitch, yaw</span></div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>      detection.pose.covariance.at(35) =</div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>        0.5 * std::pow(j2735_v2x_msgs::to_double(common_data.heading_conf).value(), 2);</div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::bad_optional_access &amp;) {</div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>      <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;missing heading confidence&quot;</span>);</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>    }</div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span> </div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>    <span class="keyword">const</span> <span class="keyword">auto</span> speed{<a class="code hl_function" href="structcarma__cooperative__perception_1_1Speed.html#a90f18ea379f0e9fef015718f594ad3f0">Speed::from_msg</a>(common_data.speed)};</div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>    detection.twist.twist.linear.x =</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>      <a class="code hl_function" href="namespacecarma__cooperative__perception.html#adab0ef7041c6108afdad006aa2c59c2f">remove_units</a>(units::velocity::meters_per_second_t{speed.speed});</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span> </div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span>    <span class="keyword">const</span> <span class="keyword">auto</span> speed_z{<a class="code hl_function" href="structcarma__cooperative__perception_1_1Speed.html#a90f18ea379f0e9fef015718f594ad3f0">Speed::from_msg</a>(common_data.speed_z)};</div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>    detection.twist.twist.linear.z =</div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>      <a class="code hl_function" href="namespacecarma__cooperative__perception.html#adab0ef7041c6108afdad006aa2c59c2f">remove_units</a>(units::velocity::meters_per_second_t{speed_z.speed});</div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span> </div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>    <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>      <span class="comment">// Twist covariance is flattened 6x6 matrix with rows/columns of x, y, z, roll, pitch, yaw</span></div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>      detection.twist.covariance.at(0) =</div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>        0.5 * std::pow(j2735_v2x_msgs::to_double(common_data.speed_confidence).value(), 2);</div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::bad_optional_access &amp;) {</div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>      <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;missing speed confidence&quot;</span>);</div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>    }</div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span> </div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>    <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>      detection.twist.covariance.at(14) =</div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span>        0.5 * std::pow(j2735_v2x_msgs::to_double(common_data.speed_confidence_z).value(), 2);</div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span>    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::bad_optional_access &amp;) {</div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span>      <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;missing z-speed confidence&quot;</span>);</div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span>    }</div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span> </div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>    <span class="keyword">const</span> <span class="keyword">auto</span> accel_set{<a class="code hl_function" href="structcarma__cooperative__perception_1_1AccelerationSet4Way.html#a14edd98c25bf9b758ed41400ee1fb157">AccelerationSet4Way::from_msg</a>(common_data.accel_4_way)};</div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span>    detection.twist.twist.angular.z =</div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>      <a class="code hl_function" href="namespacecarma__cooperative__perception.html#adab0ef7041c6108afdad006aa2c59c2f">remove_units</a>(units::angular_velocity::degrees_per_second_t{accel_set.yaw_rate});</div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span> </div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>    <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span>      detection.twist.covariance.at(35) =</div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>        0.5 * std::pow(j2735_v2x_msgs::to_double(common_data.acc_cfd_yaw).value(), 2);</div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::bad_optional_access &amp;) {</div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>      <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;missing yaw-rate confidence&quot;</span>);</div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>    }</div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span> </div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>    <span class="keywordflow">switch</span> (common_data.obj_type.object_type) {</div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>      <span class="keywordflow">case</span> common_data.obj_type.ANIMAL:</div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>        detection.motion_model = detection.MOTION_MODEL_CTRV;</div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span>        <span class="comment">// We don&#39;t have a good semantic class mapping for animals</span></div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>        detection.semantic_class = detection.SEMANTIC_CLASS_UNKNOWN;</div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>      <span class="keywordflow">case</span> common_data.obj_type.VRU:</div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>        detection.motion_model = detection.MOTION_MODEL_CTRV;</div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>        detection.semantic_class = detection.SEMANTIC_CLASS_PEDESTRIAN;</div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>      <span class="keywordflow">case</span> common_data.obj_type.VEHICLE:</div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>        detection.motion_model = detection.MOTION_MODEL_CTRV;</div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>        detection.semantic_class = detection.SEMANTIC_CLASS_SMALL_VEHICLE;</div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>      <span class="keywordflow">default</span>:</div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>        detection.motion_model = detection.MOTION_MODEL_CTRV;</div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span>        detection.semantic_class = detection.SEMANTIC_CLASS_UNKNOWN;</div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>    }</div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span> </div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>    detection_list.detections.push_back(std::move(detection));</div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span>  }</div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span> </div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>  <span class="keywordflow">return</span> detection_list;</div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>}</div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span> </div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno"><a class="line" href="namespacecarma__cooperative__perception.html#a69f997a3745c682c72182bae54fa09cb">  385</a></span><span class="keyword">auto</span> <a class="code hl_function" href="namespacecarma__cooperative__perception.html#a69f997a3745c682c72182bae54fa09cb">to_detection_msg</a>(</div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span>  <span class="keyword">const</span> carma_perception_msgs::msg::ExternalObject &amp; <span class="keywordtype">object</span>,</div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>  <span class="keyword">const</span> <a class="code hl_struct" href="structcarma__cooperative__perception_1_1MotionModelMapping.html">MotionModelMapping</a> &amp; motion_model_mapping)</div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span>  -&gt; <a class="code hl_typedef" href="namespacecarma__cooperative__perception.html#a5e779cee7548e2a337b47a4d41dbb7c1">carma_cooperative_perception_interfaces::msg::Detection</a></div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>{</div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>  <a class="code hl_typedef" href="namespacecarma__cooperative__perception.html#a5e779cee7548e2a337b47a4d41dbb7c1">carma_cooperative_perception_interfaces::msg::Detection</a> detection;</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span> </div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>  detection.header = <span class="keywordtype">object</span>.header;</div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span> </div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span>  <span class="keywordflow">if</span> (<span class="keywordtype">object</span>.presence_vector &amp; <span class="keywordtype">object</span>.BSM_ID_PRESENCE_VECTOR) {</div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span>    detection.id = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>    std::transform(</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span>      std::cbegin(<span class="keywordtype">object</span>.bsm_id), std::cend(<span class="keywordtype">object</span>.bsm_id), std::back_inserter(detection.id),</div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span>      [](<span class="keyword">const</span> <span class="keyword">auto</span> &amp; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>) { return i + <span class="stringliteral">&#39;0&#39;</span>; });</div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span>  }</div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span> </div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span>  <span class="keywordflow">if</span> (<span class="keywordtype">object</span>.presence_vector &amp; <span class="keywordtype">object</span>.ID_PRESENCE_VECTOR) {</div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span>    detection.id += <span class="charliteral">&#39;-&#39;</span> + <a class="code hl_function" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5">std::to_string</a>(<span class="keywordtype">object</span>.<span class="keywordtype">id</span>);</div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span>  }</div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span> </div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>  <span class="keywordflow">if</span> (<span class="keywordtype">object</span>.presence_vector &amp; <span class="keywordtype">object</span>.POSE_PRESENCE_VECTOR) {</div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span>    detection.pose = <span class="keywordtype">object</span>.pose;</div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span>  }</div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span> </div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>  <span class="keywordflow">if</span> (<span class="keywordtype">object</span>.presence_vector &amp; <span class="keywordtype">object</span>.VELOCITY_PRESENCE_VECTOR) {</div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span>    detection.twist = <span class="keywordtype">object</span>.velocity;</div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span>  }</div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span> </div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>  <span class="keywordflow">if</span> (<span class="keywordtype">object</span>.presence_vector &amp; <span class="keywordtype">object</span>.OBJECT_TYPE_PRESENCE_VECTOR) {</div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>    <span class="keywordflow">switch</span> (<span class="keywordtype">object</span>.object_type) {</div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>      <span class="keywordflow">case</span> <span class="keywordtype">object</span>.SMALL_VEHICLE:</div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>        detection.motion_model = motion_model_mapping.small_vehicle_model;</div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>        detection.semantic_class = detection.SEMANTIC_CLASS_SMALL_VEHICLE;</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>      <span class="keywordflow">case</span> <span class="keywordtype">object</span>.LARGE_VEHICLE:</div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>        detection.motion_model = motion_model_mapping.large_vehicle_model;</div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>        detection.semantic_class = detection.SEMANTIC_CLASS_LARGE_VEHICLE;</div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>      <span class="keywordflow">case</span> <span class="keywordtype">object</span>.MOTORCYCLE:</div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span>        detection.motion_model = motion_model_mapping.motorcycle_model;</div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>        detection.semantic_class = detection.SEMANTIC_CLASS_MOTORCYCLE;</div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>      <span class="keywordflow">case</span> <span class="keywordtype">object</span>.PEDESTRIAN:</div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>        detection.motion_model = motion_model_mapping.pedestrian_model;</div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>        detection.semantic_class = detection.SEMANTIC_CLASS_PEDESTRIAN;</div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>      <span class="keywordflow">case</span> <span class="keywordtype">object</span>.UNKNOWN:</div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>      <span class="keywordflow">default</span>:</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>        detection.motion_model = motion_model_mapping.unknown_model;</div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>        detection.semantic_class = detection.SEMANTIC_CLASS_UNKNOWN;</div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>    }</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>  }</div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span> </div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span>  <span class="keywordflow">return</span> detection;</div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span>}</div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span> </div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno"><a class="line" href="namespacecarma__cooperative__perception.html#ac8158101b15237e9b566a2d1b5129a02">  441</a></span><span class="keyword">auto</span> <a class="code hl_function" href="namespacecarma__cooperative__perception.html#a0744e4e2672612a387326dbef5e5b632">to_detection_list_msg</a>(</div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span>  <span class="keyword">const</span> carma_perception_msgs::msg::ExternalObjectList &amp; object_list,</div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>  <span class="keyword">const</span> <a class="code hl_struct" href="structcarma__cooperative__perception_1_1MotionModelMapping.html">MotionModelMapping</a> &amp; motion_model_mapping)</div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>  -&gt; carma_cooperative_perception_interfaces::msg::DetectionList</div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>{</div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>  carma_cooperative_perception_interfaces::msg::DetectionList detection_list;</div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span> </div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span>  std::transform(</div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span>    std::cbegin(object_list.objects), std::cend(object_list.objects),</div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span>    std::back_inserter(detection_list.detections),</div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span>    [&amp;motion_model_mapping = std::as_const(motion_model_mapping)](<span class="keyword">const</span> <span class="keyword">auto</span> &amp; <span class="keywordtype">object</span>) {</div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span>      return to_detection_msg(object, motion_model_mapping);</div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>    });</div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span> </div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span>  <span class="keywordflow">return</span> detection_list;</div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>}</div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span> </div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno"><a class="line" href="namespacecarma__cooperative__perception.html#a9cabc2246eeda1223c88e5933da6a021">  458</a></span><span class="keyword">auto</span> <a class="code hl_function" href="namespacecarma__cooperative__perception.html#a9cabc2246eeda1223c88e5933da6a021">to_external_object_msg</a>(<span class="keyword">const</span> <a class="code hl_typedef" href="namespacecarma__cooperative__perception.html#aedfce236df3f84ec5ebc8b4013798808">carma_cooperative_perception_interfaces::msg::Track</a> &amp; track)</div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span>  -&gt; carma_perception_msgs::msg::ExternalObject</div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>{</div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span>  carma_perception_msgs::msg::ExternalObject <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>;</div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span>  <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.header = track.header;</div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span>  <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.presence_vector = 0;</div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span> </div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>  <span class="keyword">const</span> <span class="keyword">auto</span> to_numeric_id = [](std::string string_id) -&gt; std::optional&lt;uint32_t&gt; {</div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span>    <span class="keyword">auto</span> non_digit_start = std::remove_if(</div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span>      std::begin(string_id), std::end(string_id),</div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span>      [](<span class="keyword">const</span> <span class="keyword">auto</span> &amp; ch) { <span class="keywordflow">return</span> !std::isdigit(ch); });</div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span> </div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>    <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">std::uint32_t</a> numeric_id;</div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span>    <span class="keyword">const</span> <span class="keyword">auto</span> digit_substr_size{std::distance(std::begin(string_id), non_digit_start)};</div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span>    <span class="keywordflow">if</span> (</div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span>      std::from_chars(string_id.c_str(), string_id.c_str() + digit_substr_size, numeric_id).ec ==</div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span>      std::errc{}) {</div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span>      <span class="keywordflow">return</span> numeric_id;</div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span>    }</div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span> </div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span>    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span>  };</div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span> </div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span>  <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> numeric_id{to_numeric_id(track.id)}) {</div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span>    <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.presence_vector |= <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.ID_PRESENCE_VECTOR;</div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span>    <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.id = numeric_id.value();</div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span>    <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.presence_vector &amp;= <a class="code hl_namespace" href="namespaceexternal__object.html">~external_object</a>.ID_PRESENCE_VECTOR;</div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span>  }</div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span> </div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span>  <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.presence_vector |= <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.POSE_PRESENCE_VECTOR;</div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span>  <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.pose = track.pose;</div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span> </div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span>  <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.presence_vector |= <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.VELOCITY_PRESENCE_VECTOR;</div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span> </div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>  <span class="keyword">const</span> <span class="keyword">auto</span> track_longitudinal_velocity{track.twist.twist.linear.x};</div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span>  <span class="keyword">const</span> <span class="keyword">auto</span> track_orientation = track.pose.pose.orientation;</div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span> </div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span>  tf2::Quaternion q(</div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span>    track_orientation.x, track_orientation.y, track_orientation.z, track_orientation.w);</div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span>  tf2::Matrix3x3 m(q);</div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span>  <span class="keywordtype">double</span> roll, pitch, yaw;</div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span>  m.getRPY(roll, pitch, yaw);</div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span> </div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span>  <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.velocity.twist.linear.x = track_longitudinal_velocity * std::cos(yaw);</div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span>  <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.velocity.twist.linear.y = track_longitudinal_velocity * std::sin(yaw);</div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span> </div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span>  <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.object_type = track.semantic_class;</div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span> </div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span>  <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.presence_vector |= <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.OBJECT_TYPE_PRESENCE_VECTOR;</div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span>  <span class="keywordflow">switch</span> (track.semantic_class) {</div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span>    <span class="keywordflow">case</span> track.SEMANTIC_CLASS_SMALL_VEHICLE:</div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span>      <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.object_type = <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.SMALL_VEHICLE;</div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span>    <span class="keywordflow">case</span> track.SEMANTIC_CLASS_LARGE_VEHICLE:</div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span>      <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.object_type = <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.LARGE_VEHICLE;</div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span>    <span class="keywordflow">case</span> track.SEMANTIC_CLASS_MOTORCYCLE:</div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>      <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.object_type = <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.MOTORCYCLE;</div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>    <span class="keywordflow">case</span> track.SEMANTIC_CLASS_PEDESTRIAN:</div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span>      <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.object_type = <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.PEDESTRIAN;</div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span>    <span class="keywordflow">case</span> track.SEMANTIC_CLASS_UNKNOWN:</div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span>      <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.object_type = <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.UNKNOWN;</div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span>  }</div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span> </div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span>  <span class="keywordflow">return</span> <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>;</div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span>}</div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span> </div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno"><a class="line" href="namespacecarma__cooperative__perception.html#a13db834a01ebe6cd88589a6c69f86934">  529</a></span><span class="keyword">auto</span> <a class="code hl_function" href="namespacecarma__cooperative__perception.html#a13db834a01ebe6cd88589a6c69f86934">to_external_object_list_msg</a>(</div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>  <span class="keyword">const</span> carma_cooperative_perception_interfaces::msg::TrackList &amp; track_list)</div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>  -&gt; carma_perception_msgs::msg::ExternalObjectList</div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span>{</div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>  carma_perception_msgs::msg::ExternalObjectList external_object_list;</div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span> </div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; track : track_list.tracks) {</div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span>    external_object_list.objects.push_back(<a class="code hl_function" href="namespacecarma__cooperative__perception.html#a9cabc2246eeda1223c88e5933da6a021">to_external_object_msg</a>(track));</div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span>  }</div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span> </div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>  <span class="keywordflow">return</span> external_object_list;</div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>}</div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span> </div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno"><a class="line" href="namespacecarma__cooperative__perception.html#ab6036e69ab09cb1c6fe0512e8e704c92">  542</a></span><span class="keyword">auto</span> <a class="code hl_function" href="namespacecarma__cooperative__perception.html#ab6036e69ab09cb1c6fe0512e8e704c92">to_sdsm_msg</a>(</div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span>  <span class="keyword">const</span> carma_perception_msgs::msg::ExternalObjectList &amp; external_object_list,</div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span>  <span class="keyword">const</span> geometry_msgs::msg::PoseStamped &amp; current_pose,</div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span>  <span class="keyword">const</span> std::shared_ptr&lt;lanelet::projection::LocalFrameProjector&gt; &amp; map_projection)</div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span>  -&gt; carma_v2x_msgs::msg::SensorDataSharingMessage</div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span>{</div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span>  carma_v2x_msgs::msg::SensorDataSharingMessage sdsm;</div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span>  carma_v2x_msgs::msg::DetectedObjectList detected_object_list;</div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span> </div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span>  sdsm.sdsm_time_stamp = <a class="code hl_function" href="namespacecarma__cooperative__perception.html#a474b64d6a2ea8e06828f03e3aca6dccb">to_ddate_time_msg</a>(external_object_list.header.stamp);</div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span> </div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span>  sdsm.ref_pos = <a class="code hl_function" href="namespacecarma__cooperative__perception.html#afc3289cc4274cc16b86cbb6f169b149b">transform_pose_from_map_to_wgs84</a>(current_pose, map_projection);</div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span> </div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span>  <span class="comment">// Convert external objects within the list to detected_object_data</span></div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a> : external_object_list.objects) {</div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span>    <span class="keyword">auto</span> sdsm_detected_object = <a class="code hl_function" href="namespacecarma__cooperative__perception.html#a7d047352f180efa034647181b142049f">to_detected_object_data_msg</a>(<a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>, map_projection);</div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span> </div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span>    <span class="comment">// Calculate the time offset between individual objects and the respective SDSM container msg</span></div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span>    sdsm_detected_object.detected_object_common_data.measurement_time =</div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span>      <a class="code hl_function" href="namespacecarma__cooperative__perception.html#a1af75f3bf9d8fb2977056c0f870374d4">calc_sdsm_time_offset</a>(<a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.header.stamp, <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.header.stamp);</div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span> </div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span>    <span class="comment">// Calculate the position offset from the current reference pose (in m)</span></div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span>    sdsm_detected_object.detected_object_common_data.pos =</div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span>      <a class="code hl_function" href="namespacecarma__cooperative__perception.html#aa241195bfca659e39d36f0c72cbe7dde">calc_relative_position</a>(current_pose, sdsm_detected_object.detected_object_common_data.pos);</div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span> </div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span>    detected_object_list.detected_object_data.push_back(sdsm_detected_object);</div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span>  }</div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span>  sdsm.objects = detected_object_list;</div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span> </div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span>  <span class="keywordflow">return</span> sdsm;</div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span>}</div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span> </div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno"><a class="line" href="namespacecarma__cooperative__perception.html#a7d047352f180efa034647181b142049f">  574</a></span><span class="keyword">auto</span> <a class="code hl_function" href="namespacecarma__cooperative__perception.html#a7d047352f180efa034647181b142049f">to_detected_object_data_msg</a>(</div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span>  <span class="keyword">const</span> carma_perception_msgs::msg::ExternalObject &amp; <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>,</div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span>  <span class="keyword">const</span> std::shared_ptr&lt;lanelet::projection::LocalFrameProjector&gt; &amp; map_projection)</div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span>  -&gt; carma_v2x_msgs::msg::DetectedObjectData</div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span>{</div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span>  carma_v2x_msgs::msg::DetectedObjectData detected_object_data;</div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span>  detected_object_data.presence_vector = 0;</div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span> </div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span>  carma_v2x_msgs::msg::DetectedObjectCommonData detected_object_common_data;</div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span>  detected_object_common_data.presence_vector = 0;</div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span> </div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span>  <span class="comment">// common data //////////</span></div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span> </div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span>  <span class="comment">// obj_type_conf - convert from percentile, cast to proper uint type</span></div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span>  <span class="keywordflow">if</span> (<a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.presence_vector &amp; <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.OBJECT_TYPE_PRESENCE_VECTOR) {</div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span>    detected_object_common_data.obj_type_cfd.classification_confidence =</div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span>      <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">std::uint8_t</a><span class="keyword">&gt;</span>(<a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.confidence * 100);</div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span>  }</div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span> </div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span>  <span class="comment">// detected_id - cast proper type</span></div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span>  <span class="keywordflow">if</span> (<a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.presence_vector &amp; <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.ID_PRESENCE_VECTOR) {</div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span>    detected_object_common_data.detected_id.object_id =</div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span>      <span class="keyword">static_cast&lt;</span><a class="code hl_typedef" href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">std::uint16_t</a><span class="keyword">&gt;</span>(<a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.id);</div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span>  }</div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span> </div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span>  <span class="comment">// pos - Add offset to ref_pos to get object position</span></div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>  <span class="comment">// in map frame -&gt; convert to WGS84 coordinates for sdsm</span></div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span> </div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span>  <span class="comment">// To get offset: Subtract the external object pose from</span></div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span>  <span class="comment">// the current vehicle location given by the current_pose topic</span></div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span>  <span class="keywordflow">if</span> (<a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.presence_vector &amp; <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.POSE_PRESENCE_VECTOR) {</div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>    detected_object_common_data.pos.offset_x.object_distance =</div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span>      <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>(<a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.pose.pose.position.x);</div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span>    detected_object_common_data.pos.offset_y.object_distance =</div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span>      <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>(<a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.pose.pose.position.y);</div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span>    detected_object_common_data.pos.offset_z.object_distance =</div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span>      <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>(<a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.pose.pose.position.z);</div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span>  }</div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span> </div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span>  <span class="comment">// speed/speed_z - convert vector velocity to scalar speed val given x/y components</span></div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span>  <span class="keywordflow">if</span> (<a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.presence_vector &amp; <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.VELOCITY_PRESENCE_VECTOR) {</div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span>    detected_object_common_data.speed.speed =</div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span>      std::hypot(<a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.velocity.twist.linear.x, <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.velocity.twist.linear.y);</div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span> </div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span>    detected_object_common_data.presence_vector |=</div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span>      carma_v2x_msgs::msg::DetectedObjectCommonData::HAS_SPEED_Z;</div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span>    detected_object_common_data.speed_z.speed = <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.velocity.twist.linear.z;</div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span> </div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span>    <span class="comment">// heading - convert ang vel to scale heading</span></div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span>    lanelet::BasicPoint3d external_object_position{</div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span>      <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.pose.pose.position.x, <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.pose.pose.position.y,</div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span>      <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.pose.pose.position.z};</div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span>    <span class="comment">// Get yaw from orientation</span></div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span>    <span class="keyword">auto</span> obj_orientation = <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.pose.pose.orientation;</div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span>    tf2::Quaternion q(obj_orientation.x, obj_orientation.y, obj_orientation.z, obj_orientation.w);</div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span>    tf2::Matrix3x3 m(q);</div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span>    <span class="keywordtype">double</span> roll, pitch, yaw;</div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span>    m.getRPY(roll, pitch, yaw);</div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span> </div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span>    detected_object_common_data.heading.heading =</div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>      <a class="code hl_function" href="namespacecarma__cooperative__perception.html#adab0ef7041c6108afdad006aa2c59c2f">remove_units</a>(<a class="code hl_function" href="namespacecarma__cooperative__perception.html#a067dbaa6dc9efb21503e30ac03908c7d">enu_orientation_to_true_heading</a>(yaw, external_object_position, map_projection));</div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span>  }</div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span> </div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span>  <span class="comment">// optional data (determine based on object type)</span></div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>  <span class="comment">// use object type struct for better control</span></div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span>  carma_v2x_msgs::msg::DetectedObjectOptionalData detected_object_optional_data;</div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span> </div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span>  <span class="keywordflow">switch</span> (<a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.object_type) {</div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span>    <span class="keywordflow">case</span> <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.SMALL_VEHICLE:</div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span>      detected_object_common_data.obj_type.object_type = j3224_v2x_msgs::msg::ObjectType::VEHICLE;</div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span> </div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span>      <span class="keywordflow">if</span> (<a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.presence_vector &amp; <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.SIZE_PRESENCE_VECTOR) {</div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span>        detected_object_optional_data.det_veh.presence_vector =</div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span>          carma_v2x_msgs::msg::DetectedVehicleData::HAS_SIZE;</div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span>        detected_object_optional_data.det_veh.presence_vector |=</div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span>          carma_v2x_msgs::msg::DetectedVehicleData::HAS_HEIGHT;</div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span> </div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span>        detected_object_optional_data.det_veh.size.vehicle_width = <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.size.y;</div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span>        detected_object_optional_data.det_veh.size.vehicle_length = <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.size.x;</div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span>        detected_object_optional_data.det_veh.height.vehicle_height = <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.size.z;</div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno">  654</span>      }</div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span>    <span class="keywordflow">case</span> <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.LARGE_VEHICLE:</div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span>      detected_object_common_data.obj_type.object_type = j3224_v2x_msgs::msg::ObjectType::VEHICLE;</div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span> </div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span>      <span class="keywordflow">if</span> (<a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.presence_vector &amp; <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.SIZE_PRESENCE_VECTOR) {</div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span>        detected_object_optional_data.det_veh.presence_vector =</div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span>          carma_v2x_msgs::msg::DetectedVehicleData::HAS_SIZE;</div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span>        detected_object_optional_data.det_veh.presence_vector |=</div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span>          carma_v2x_msgs::msg::DetectedVehicleData::HAS_HEIGHT;</div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span> </div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span>        detected_object_optional_data.det_veh.size.vehicle_width = <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.size.y;</div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span>        detected_object_optional_data.det_veh.size.vehicle_length = <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.size.x;</div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span>        detected_object_optional_data.det_veh.height.vehicle_height = <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.size.z;</div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span>      }</div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span>    <span class="keywordflow">case</span> <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.MOTORCYCLE:</div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span>      detected_object_common_data.obj_type.object_type = j3224_v2x_msgs::msg::ObjectType::VEHICLE;</div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span> </div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span>      <span class="keywordflow">if</span> (<a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.presence_vector &amp; <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.SIZE_PRESENCE_VECTOR) {</div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span>        detected_object_optional_data.det_veh.presence_vector =</div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno">  675</span>          carma_v2x_msgs::msg::DetectedVehicleData::HAS_SIZE;</div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span>        detected_object_optional_data.det_veh.presence_vector |=</div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span>          carma_v2x_msgs::msg::DetectedVehicleData::HAS_HEIGHT;</div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span> </div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span>        detected_object_optional_data.det_veh.size.vehicle_width = <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.size.y;</div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span>        detected_object_optional_data.det_veh.size.vehicle_length = <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.size.x;</div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span>        detected_object_optional_data.det_veh.height.vehicle_height = <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.size.z;</div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span>      }</div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span>    <span class="keywordflow">case</span> <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.PEDESTRIAN:</div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno">  685</span>      detected_object_common_data.obj_type.object_type = j3224_v2x_msgs::msg::ObjectType::VRU;</div>
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno">  686</span> </div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span>      detected_object_optional_data.det_vru.presence_vector =</div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span>        carma_v2x_msgs::msg::DetectedVRUData::HAS_BASIC_TYPE;</div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span>      detected_object_optional_data.det_vru.basic_type.type |=</div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span>        j2735_v2x_msgs::msg::PersonalDeviceUserType::A_PEDESTRIAN;</div>
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span> </div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno">  693</span>    <span class="keywordflow">case</span> <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.UNKNOWN:</div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span>      detected_object_common_data.obj_type.object_type = j3224_v2x_msgs::msg::ObjectType::UNKNOWN;</div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno">  696</span> </div>
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno">  697</span>      <span class="keywordflow">if</span> (<a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.presence_vector &amp; <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.SIZE_PRESENCE_VECTOR) {</div>
<div class="line"><a id="l00698" name="l00698"></a><span class="lineno">  698</span>        detected_object_optional_data.det_obst.obst_size.width.size_value = <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.size.y;</div>
<div class="line"><a id="l00699" name="l00699"></a><span class="lineno">  699</span>        detected_object_optional_data.det_obst.obst_size.length.size_value = <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.size.x;</div>
<div class="line"><a id="l00700" name="l00700"></a><span class="lineno">  700</span> </div>
<div class="line"><a id="l00701" name="l00701"></a><span class="lineno">  701</span>        detected_object_optional_data.det_obst.obst_size.presence_vector =</div>
<div class="line"><a id="l00702" name="l00702"></a><span class="lineno">  702</span>          carma_v2x_msgs::msg::ObstacleSize::HAS_HEIGHT;</div>
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno">  703</span>        detected_object_optional_data.det_obst.obst_size.height.size_value = <a class="code hl_namespace" href="namespaceexternal__object.html">external_object</a>.size.z;</div>
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno">  704</span>      }</div>
<div class="line"><a id="l00705" name="l00705"></a><span class="lineno">  705</span>  }</div>
<div class="line"><a id="l00706" name="l00706"></a><span class="lineno">  706</span> </div>
<div class="line"><a id="l00707" name="l00707"></a><span class="lineno">  707</span>  detected_object_data.detected_object_common_data = std::move(detected_object_common_data);</div>
<div class="line"><a id="l00708" name="l00708"></a><span class="lineno">  708</span>  detected_object_data.detected_object_optional_data = std::move(detected_object_optional_data);</div>
<div class="line"><a id="l00709" name="l00709"></a><span class="lineno">  709</span> </div>
<div class="line"><a id="l00710" name="l00710"></a><span class="lineno">  710</span>  <span class="keywordflow">return</span> detected_object_data;</div>
<div class="line"><a id="l00711" name="l00711"></a><span class="lineno">  711</span>}</div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno">  712</span> </div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span>}  <span class="comment">// namespace carma_cooperative_perception</span></div>
<div class="ttc" id="ageodetic_8hpp_html"><div class="ttname"><a href="geodetic_8hpp.html">geodetic.hpp</a></div></div>
<div class="ttc" id="aj2735__types_8hpp_html"><div class="ttname"><a href="j2735__types_8hpp.html">j2735_types.hpp</a></div></div>
<div class="ttc" id="aj3224__types_8hpp_html"><div class="ttname"><a href="j3224__types_8hpp.html">j3224_types.hpp</a></div></div>
<div class="ttc" id="amsg__conversion_8hpp_html"><div class="ttname"><a href="msg__conversion_8hpp.html">msg_conversion.hpp</a></div></div>
<div class="ttc" id="anamespacecarma__cooperative__perception_html"><div class="ttname"><a href="namespacecarma__cooperative__perception.html">carma_cooperative_perception</a></div><div class="ttdef"><b>Definition:</b> <a href="detection__list__viz__component_8hpp_source.html#l00022">detection_list_viz_component.hpp:23</a></div></div>
<div class="ttc" id="anamespacecarma__cooperative__perception_html_a067dbaa6dc9efb21503e30ac03908c7d"><div class="ttname"><a href="namespacecarma__cooperative__perception.html#a067dbaa6dc9efb21503e30ac03908c7d">carma_cooperative_perception::enu_orientation_to_true_heading</a></div><div class="ttdeci">auto enu_orientation_to_true_heading(double yaw, const lanelet::BasicPoint3d &amp;obj_pose, const std::shared_ptr&lt; lanelet::projection::LocalFrameProjector &gt; &amp;map_projection) -&gt; units::angle::degree_t</div><div class="ttdef"><b>Definition:</b> <a href="msg__conversion_8cpp_source.html#l00177">msg_conversion.cpp:177</a></div></div>
<div class="ttc" id="anamespacecarma__cooperative__perception_html_a0744e4e2672612a387326dbef5e5b632"><div class="ttname"><a href="namespacecarma__cooperative__perception.html#a0744e4e2672612a387326dbef5e5b632">carma_cooperative_perception::to_detection_list_msg</a></div><div class="ttdeci">auto to_detection_list_msg(const carma_v2x_msgs::msg::SensorDataSharingMessage &amp;sdsm, std::string_view georeference) -&gt; carma_cooperative_perception_interfaces::msg::DetectionList</div><div class="ttdef"><b>Definition:</b> <a href="msg__conversion_8cpp_source.html#l00241">msg_conversion.cpp:241</a></div></div>
<div class="ttc" id="anamespacecarma__cooperative__perception_html_a13db834a01ebe6cd88589a6c69f86934"><div class="ttname"><a href="namespacecarma__cooperative__perception.html#a13db834a01ebe6cd88589a6c69f86934">carma_cooperative_perception::to_external_object_list_msg</a></div><div class="ttdeci">auto to_external_object_list_msg(const carma_cooperative_perception_interfaces::msg::TrackList &amp;track_list) -&gt; carma_perception_msgs::msg::ExternalObjectList</div><div class="ttdef"><b>Definition:</b> <a href="msg__conversion_8cpp_source.html#l00529">msg_conversion.cpp:529</a></div></div>
<div class="ttc" id="anamespacecarma__cooperative__perception_html_a1af75f3bf9d8fb2977056c0f870374d4"><div class="ttname"><a href="namespacecarma__cooperative__perception.html#a1af75f3bf9d8fb2977056c0f870374d4">carma_cooperative_perception::calc_sdsm_time_offset</a></div><div class="ttdeci">auto calc_sdsm_time_offset(const builtin_interfaces::msg::Time &amp;external_object_list_time, const builtin_interfaces::msg::Time &amp;external_object_time) -&gt; carma_v2x_msgs::msg::MeasurementTimeOffset</div><div class="ttdef"><b>Definition:</b> <a href="msg__conversion_8cpp_source.html#l00127">msg_conversion.cpp:127</a></div></div>
<div class="ttc" id="anamespacecarma__cooperative__perception_html_a3bd1f30dbbb27e495fb1733fe2133e3a"><div class="ttname"><a href="namespacecarma__cooperative__perception.html#a3bd1f30dbbb27e495fb1733fe2133e3a">carma_cooperative_perception::calculate_grid_convergence</a></div><div class="ttdeci">auto calculate_grid_convergence(const Wgs84Coordinate &amp;position, const UtmZone &amp;zone) -&gt; units::angle::degree_t</div><div class="ttdoc">Calculate grid convergence at a given position.</div><div class="ttdef"><b>Definition:</b> <a href="geodetic_8cpp_source.html#l00154">geodetic.cpp:154</a></div></div>
<div class="ttc" id="anamespacecarma__cooperative__perception_html_a474b64d6a2ea8e06828f03e3aca6dccb"><div class="ttname"><a href="namespacecarma__cooperative__perception.html#a474b64d6a2ea8e06828f03e3aca6dccb">carma_cooperative_perception::to_ddate_time_msg</a></div><div class="ttdeci">auto to_ddate_time_msg(const builtin_interfaces::msg::Time &amp;builtin_time) -&gt; j2735_v2x_msgs::msg::DDateTime</div><div class="ttdef"><b>Definition:</b> <a href="msg__conversion_8cpp_source.html#l00092">msg_conversion.cpp:92</a></div></div>
<div class="ttc" id="anamespacecarma__cooperative__perception_html_a5cff4b79b8e989798643db61de547f33"><div class="ttname"><a href="namespacecarma__cooperative__perception.html#a5cff4b79b8e989798643db61de547f33">carma_cooperative_perception::calc_detection_time_stamp</a></div><div class="ttdeci">auto calc_detection_time_stamp(DDateTime d_date_time, const MeasurementTimeOffset &amp;offset) -&gt; DDateTime</div><div class="ttdef"><b>Definition:</b> <a href="msg__conversion_8cpp_source.html#l00069">msg_conversion.cpp:69</a></div></div>
<div class="ttc" id="anamespacecarma__cooperative__perception_html_a5e779cee7548e2a337b47a4d41dbb7c1"><div class="ttname"><a href="namespacecarma__cooperative__perception.html#a5e779cee7548e2a337b47a4d41dbb7c1">carma_cooperative_perception::Detection</a></div><div class="ttdeci">std::variant&lt; multiple_object_tracking::CtrvDetection, multiple_object_tracking::CtraDetection &gt; Detection</div><div class="ttdef"><b>Definition:</b> <a href="multiple__object__tracker__component_8hpp_source.html#l00034">multiple_object_tracker_component.hpp:35</a></div></div>
<div class="ttc" id="anamespacecarma__cooperative__perception_html_a62911a303fe3652fb937a2503b563e21"><div class="ttname"><a href="namespacecarma__cooperative__perception.html#a62911a303fe3652fb937a2503b563e21">carma_cooperative_perception::project_to_carma_map</a></div><div class="ttdeci">auto project_to_carma_map(const Wgs84Coordinate &amp;coordinate, std::string_view proj_string) -&gt; MapCoordinate</div><div class="ttdef"><b>Definition:</b> <a href="geodetic_8cpp_source.html#l00055">geodetic.cpp:55</a></div></div>
<div class="ttc" id="anamespacecarma__cooperative__perception_html_a64b708654c8aecb09122d39577df31b5"><div class="ttname"><a href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5">carma_cooperative_perception::to_string</a></div><div class="ttdeci">auto to_string(const UtmZone &amp;zone) -&gt; std::string</div><div class="ttdef"><b>Definition:</b> <a href="utm__zone_8cpp_source.html#l00021">utm_zone.cpp:21</a></div></div>
<div class="ttc" id="anamespacecarma__cooperative__perception_html_a69f997a3745c682c72182bae54fa09cb"><div class="ttname"><a href="namespacecarma__cooperative__perception.html#a69f997a3745c682c72182bae54fa09cb">carma_cooperative_perception::to_detection_msg</a></div><div class="ttdeci">auto to_detection_msg(const carma_perception_msgs::msg::ExternalObject &amp;object, const MotionModelMapping &amp;motion_model_mapping) -&gt; carma_cooperative_perception_interfaces::msg::Detection</div><div class="ttdef"><b>Definition:</b> <a href="msg__conversion_8cpp_source.html#l00385">msg_conversion.cpp:385</a></div></div>
<div class="ttc" id="anamespacecarma__cooperative__perception_html_a7a17e53626d5605eac626f1865b50bbc"><div class="ttname"><a href="namespacecarma__cooperative__perception.html#a7a17e53626d5605eac626f1865b50bbc">carma_cooperative_perception::ned_to_enu</a></div><div class="ttdeci">auto ned_to_enu(const PositionOffsetXYZ &amp;offset_ned) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="msg__conversion_8cpp_source.html#l00077">msg_conversion.cpp:77</a></div></div>
<div class="ttc" id="anamespacecarma__cooperative__perception_html_a7d047352f180efa034647181b142049f"><div class="ttname"><a href="namespacecarma__cooperative__perception.html#a7d047352f180efa034647181b142049f">carma_cooperative_perception::to_detected_object_data_msg</a></div><div class="ttdeci">auto to_detected_object_data_msg(const carma_perception_msgs::msg::ExternalObject &amp;external_object, const std::shared_ptr&lt; lanelet::projection::LocalFrameProjector &gt; &amp;map_projection) -&gt; carma_v2x_msgs::msg::DetectedObjectData</div><div class="ttdef"><b>Definition:</b> <a href="msg__conversion_8cpp_source.html#l00574">msg_conversion.cpp:574</a></div></div>
<div class="ttc" id="anamespacecarma__cooperative__perception_html_a93be41b790d86ff89621727ece68aee0"><div class="ttname"><a href="namespacecarma__cooperative__perception.html#a93be41b790d86ff89621727ece68aee0">carma_cooperative_perception::to_time_msg</a></div><div class="ttdeci">auto to_time_msg(const DDateTime &amp;d_date_time) -&gt; builtin_interfaces::msg::Time</div><div class="ttdef"><b>Definition:</b> <a href="msg__conversion_8cpp_source.html#l00056">msg_conversion.cpp:56</a></div></div>
<div class="ttc" id="anamespacecarma__cooperative__perception_html_a9cabc2246eeda1223c88e5933da6a021"><div class="ttname"><a href="namespacecarma__cooperative__perception.html#a9cabc2246eeda1223c88e5933da6a021">carma_cooperative_perception::to_external_object_msg</a></div><div class="ttdeci">auto to_external_object_msg(const carma_cooperative_perception_interfaces::msg::Track &amp;track) -&gt; carma_perception_msgs::msg::ExternalObject</div><div class="ttdef"><b>Definition:</b> <a href="msg__conversion_8cpp_source.html#l00458">msg_conversion.cpp:458</a></div></div>
<div class="ttc" id="anamespacecarma__cooperative__perception_html_aa0ac6f02134ae7a4a1909c51c4ba6d2e"><div class="ttname"><a href="namespacecarma__cooperative__perception.html#aa0ac6f02134ae7a4a1909c51c4ba6d2e">carma_cooperative_perception::heading_to_enu_yaw</a></div><div class="ttdeci">auto heading_to_enu_yaw(const units::angle::degree_t &amp;heading) -&gt; units::angle::degree_t</div><div class="ttdef"><b>Definition:</b> <a href="msg__conversion_8cpp_source.html#l00172">msg_conversion.cpp:172</a></div></div>
<div class="ttc" id="anamespacecarma__cooperative__perception_html_aa241195bfca659e39d36f0c72cbe7dde"><div class="ttname"><a href="namespacecarma__cooperative__perception.html#aa241195bfca659e39d36f0c72cbe7dde">carma_cooperative_perception::calc_relative_position</a></div><div class="ttdeci">auto calc_relative_position(const geometry_msgs::msg::PoseStamped &amp;current_pose, const carma_v2x_msgs::msg::PositionOffsetXYZ &amp;detected_object_data) -&gt; carma_v2x_msgs::msg::PositionOffsetXYZ</div><div class="ttdef"><b>Definition:</b> <a href="msg__conversion_8cpp_source.html#l00204">msg_conversion.cpp:204</a></div></div>
<div class="ttc" id="anamespacecarma__cooperative__perception_html_ab6036e69ab09cb1c6fe0512e8e704c92"><div class="ttname"><a href="namespacecarma__cooperative__perception.html#ab6036e69ab09cb1c6fe0512e8e704c92">carma_cooperative_perception::to_sdsm_msg</a></div><div class="ttdeci">auto to_sdsm_msg(const carma_perception_msgs::msg::ExternalObjectList &amp;external_object_list, const geometry_msgs::msg::PoseStamped &amp;current_pose, const std::shared_ptr&lt; lanelet::projection::LocalFrameProjector &gt; &amp;map_projection) -&gt; carma_v2x_msgs::msg::SensorDataSharingMessage</div><div class="ttdef"><b>Definition:</b> <a href="msg__conversion_8cpp_source.html#l00542">msg_conversion.cpp:542</a></div></div>
<div class="ttc" id="anamespacecarma__cooperative__perception_html_adab0ef7041c6108afdad006aa2c59c2f"><div class="ttname"><a href="namespacecarma__cooperative__perception.html#adab0ef7041c6108afdad006aa2c59c2f">carma_cooperative_perception::remove_units</a></div><div class="ttdeci">constexpr auto remove_units(const T &amp;value)</div><div class="ttdef"><b>Definition:</b> <a href="units__extensions_8hpp_source.html#l00025">units_extensions.hpp:25</a></div></div>
<div class="ttc" id="anamespacecarma__cooperative__perception_html_ae31d51adeb5455f98be9395fb9d863a9"><div class="ttname"><a href="namespacecarma__cooperative__perception.html#ae31d51adeb5455f98be9395fb9d863a9">carma_cooperative_perception::to_position_msg</a></div><div class="ttdeci">auto to_position_msg(const UtmCoordinate &amp;position_utm) -&gt; geometry_msgs::msg::Point</div><div class="ttdef"><b>Definition:</b> <a href="msg__conversion_8cpp_source.html#l00150">msg_conversion.cpp:150</a></div></div>
<div class="ttc" id="anamespacecarma__cooperative__perception_html_aedfce236df3f84ec5ebc8b4013798808"><div class="ttname"><a href="namespacecarma__cooperative__perception.html#aedfce236df3f84ec5ebc8b4013798808">carma_cooperative_perception::Track</a></div><div class="ttdeci">std::variant&lt; multiple_object_tracking::CtrvTrack, multiple_object_tracking::CtraTrack &gt; Track</div><div class="ttdef"><b>Definition:</b> <a href="multiple__object__tracker__component_8hpp_source.html#l00036">multiple_object_tracker_component.hpp:37</a></div></div>
<div class="ttc" id="anamespacecarma__cooperative__perception_html_afc3289cc4274cc16b86cbb6f169b149b"><div class="ttname"><a href="namespacecarma__cooperative__perception.html#afc3289cc4274cc16b86cbb6f169b149b">carma_cooperative_perception::transform_pose_from_map_to_wgs84</a></div><div class="ttdeci">auto transform_pose_from_map_to_wgs84(const geometry_msgs::msg::PoseStamped &amp;source_pose, const std::shared_ptr&lt; lanelet::projection::LocalFrameProjector &gt; &amp;map_projection) -&gt; carma_v2x_msgs::msg::Position3D</div><div class="ttdef"><b>Definition:</b> <a href="msg__conversion_8cpp_source.html#l00222">msg_conversion.cpp:222</a></div></div>
<div class="ttc" id="anamespaceexternal__object_html"><div class="ttname"><a href="namespaceexternal__object.html">external_object</a></div><div class="ttdef"><b>Definition:</b> <a href="external__object_8py_source.html#l00001">external_object.py:1</a></div></div>
<div class="ttc" id="anamespaceprocess__bag_html_af102a02c97622dd30b0dbf7bafb0d199"><div class="ttname"><a href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">process_bag.i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="process__bag_8py_source.html#l00059">process_bag.py:59</a></div></div>
<div class="ttc" id="astdint_8h_html_a273cf69d639a59973b6019625df33e30"><div class="ttname"><a href="stdint_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></div><div class="ttdeci">unsigned short uint16_t</div><div class="ttdef"><b>Definition:</b> <a href="stdint_8h_source.html#l00125">stdint.h:125</a></div></div>
<div class="ttc" id="astdint_8h_html_a435d1572bf3f880d55459d9805097f62"><div class="ttname"><a href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a></div><div class="ttdeci">unsigned int uint32_t</div><div class="ttdef"><b>Definition:</b> <a href="stdint_8h_source.html#l00126">stdint.h:126</a></div></div>
<div class="ttc" id="astdint_8h_html_ab1967d8591af1a4e48c37fd2b0f184d0"><div class="ttname"><a href="stdint_8h.html#ab1967d8591af1a4e48c37fd2b0f184d0">int32_t</a></div><div class="ttdeci">signed int int32_t</div><div class="ttdef"><b>Definition:</b> <a href="stdint_8h_source.html#l00123">stdint.h:123</a></div></div>
<div class="ttc" id="astdint_8h_html_aba7bc1797add20fe3efdf37ced1182c5"><div class="ttname"><a href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a></div><div class="ttdeci">unsigned char uint8_t</div><div class="ttdef"><b>Definition:</b> <a href="stdint_8h_source.html#l00124">stdint.h:124</a></div></div>
<div class="ttc" id="astructcarma__cooperative__perception_1_1AccelerationSet4Way_html_a14edd98c25bf9b758ed41400ee1fb157"><div class="ttname"><a href="structcarma__cooperative__perception_1_1AccelerationSet4Way.html#a14edd98c25bf9b758ed41400ee1fb157">carma_cooperative_perception::AccelerationSet4Way::from_msg</a></div><div class="ttdeci">static auto from_msg(const j2735_v2x_msgs::msg::AccelerationSet4Way &amp;msg) -&gt; AccelerationSet4Way</div><div class="ttdef"><b>Definition:</b> <a href="j2735__types_8cpp_source.html#l00055">j2735_types.cpp:55</a></div></div>
<div class="ttc" id="astructcarma__cooperative__perception_1_1DDateTime_html"><div class="ttname"><a href="structcarma__cooperative__perception_1_1DDateTime.html">carma_cooperative_perception::DDateTime</a></div><div class="ttdef"><b>Definition:</b> <a href="j2735__types_8hpp_source.html#l00036">j2735_types.hpp:37</a></div></div>
<div class="ttc" id="astructcarma__cooperative__perception_1_1DDateTime_html_aa652587c61d227c825f9b82fc4784915"><div class="ttname"><a href="structcarma__cooperative__perception_1_1DDateTime.html#aa652587c61d227c825f9b82fc4784915">carma_cooperative_perception::DDateTime::from_msg</a></div><div class="ttdeci">static auto from_msg(const j2735_v2x_msgs::msg::DDateTime &amp;msg) -&gt; DDateTime</div><div class="ttdef"><b>Definition:</b> <a href="j2735__types_8cpp_source.html#l00019">j2735_types.cpp:19</a></div></div>
<div class="ttc" id="astructcarma__cooperative__perception_1_1DDateTime_html_ae869970cf347d99db44f14bdefd07015"><div class="ttname"><a href="structcarma__cooperative__perception_1_1DDateTime.html#ae869970cf347d99db44f14bdefd07015">carma_cooperative_perception::DDateTime::second</a></div><div class="ttdeci">std::optional&lt; units::time::second_t &gt; second</div><div class="ttdef"><b>Definition:</b> <a href="j2735__types_8hpp_source.html#l00043">j2735_types.hpp:43</a></div></div>
<div class="ttc" id="astructcarma__cooperative__perception_1_1Heading_html_a489e9438fe854b7b4570a5258e40b8bc"><div class="ttname"><a href="structcarma__cooperative__perception_1_1Heading.html#a489e9438fe854b7b4570a5258e40b8bc">carma_cooperative_perception::Heading::from_msg</a></div><div class="ttdeci">static auto from_msg(const j2735_v2x_msgs::msg::Heading &amp;heading) -&gt; Heading</div><div class="ttdef"><b>Definition:</b> <a href="j2735__types_8cpp_source.html#l00101">j2735_types.cpp:101</a></div></div>
<div class="ttc" id="astructcarma__cooperative__perception_1_1MapCoordinate_html"><div class="ttname"><a href="structcarma__cooperative__perception_1_1MapCoordinate.html">carma_cooperative_perception::MapCoordinate</a></div><div class="ttdef"><b>Definition:</b> <a href="geodetic_8hpp_source.html#l00039">geodetic.hpp:40</a></div></div>
<div class="ttc" id="astructcarma__cooperative__perception_1_1MapCoordinate_html_a70ca6b501f497dba865ea4b3333b04da"><div class="ttname"><a href="structcarma__cooperative__perception_1_1MapCoordinate.html#a70ca6b501f497dba865ea4b3333b04da">carma_cooperative_perception::MapCoordinate::easting</a></div><div class="ttdeci">units::length::meter_t easting</div><div class="ttdef"><b>Definition:</b> <a href="geodetic_8hpp_source.html#l00041">geodetic.hpp:41</a></div></div>
<div class="ttc" id="astructcarma__cooperative__perception_1_1MeasurementTimeOffset_html"><div class="ttname"><a href="structcarma__cooperative__perception_1_1MeasurementTimeOffset.html">carma_cooperative_perception::MeasurementTimeOffset</a></div><div class="ttdef"><b>Definition:</b> <a href="j3224__types_8hpp_source.html#l00041">j3224_types.hpp:42</a></div></div>
<div class="ttc" id="astructcarma__cooperative__perception_1_1MeasurementTimeOffset_html_a0820c7b605ed0293419b10b8f7eee715"><div class="ttname"><a href="structcarma__cooperative__perception_1_1MeasurementTimeOffset.html#a0820c7b605ed0293419b10b8f7eee715">carma_cooperative_perception::MeasurementTimeOffset::from_msg</a></div><div class="ttdeci">static auto from_msg(const j3224_v2x_msgs::msg::MeasurementTimeOffset &amp;msg) -&gt; MeasurementTimeOffset</div><div class="ttdef"><b>Definition:</b> <a href="j3224__types_8cpp_source.html#l00047">j3224_types.cpp:47</a></div></div>
<div class="ttc" id="astructcarma__cooperative__perception_1_1MotionModelMapping_html"><div class="ttname"><a href="structcarma__cooperative__perception_1_1MotionModelMapping.html">carma_cooperative_perception::MotionModelMapping</a></div><div class="ttdef"><b>Definition:</b> <a href="msg__conversion_8hpp_source.html#l00075">msg_conversion.hpp:76</a></div></div>
<div class="ttc" id="astructcarma__cooperative__perception_1_1Position3D_html_af394078671528953d9717b750a595168"><div class="ttname"><a href="structcarma__cooperative__perception_1_1Position3D.html#af394078671528953d9717b750a595168">carma_cooperative_perception::Position3D::from_msg</a></div><div class="ttdeci">static auto from_msg(const j2735_v2x_msgs::msg::Position3D &amp;msg) -&gt; Position3D</div><div class="ttdef"><b>Definition:</b> <a href="j2735__types_8cpp_source.html#l00075">j2735_types.cpp:75</a></div></div>
<div class="ttc" id="astructcarma__cooperative__perception_1_1PositionOffsetXYZ_html"><div class="ttname"><a href="structcarma__cooperative__perception_1_1PositionOffsetXYZ.html">carma_cooperative_perception::PositionOffsetXYZ</a></div><div class="ttdef"><b>Definition:</b> <a href="j3224__types_8hpp_source.html#l00028">j3224_types.hpp:29</a></div></div>
<div class="ttc" id="astructcarma__cooperative__perception_1_1PositionOffsetXYZ_html_a094715553928cccc0c23616e8f4e2654"><div class="ttname"><a href="structcarma__cooperative__perception_1_1PositionOffsetXYZ.html#a094715553928cccc0c23616e8f4e2654">carma_cooperative_perception::PositionOffsetXYZ::from_msg</a></div><div class="ttdeci">static auto from_msg(const j3224_v2x_msgs::msg::PositionOffsetXYZ &amp;msg) -&gt; PositionOffsetXYZ</div><div class="ttdef"><b>Definition:</b> <a href="j3224__types_8cpp_source.html#l00019">j3224_types.cpp:19</a></div></div>
<div class="ttc" id="astructcarma__cooperative__perception_1_1Speed_html_a90f18ea379f0e9fef015718f594ad3f0"><div class="ttname"><a href="structcarma__cooperative__perception_1_1Speed.html#a90f18ea379f0e9fef015718f594ad3f0">carma_cooperative_perception::Speed::from_msg</a></div><div class="ttdeci">static auto from_msg(const j2735_v2x_msgs::msg::Speed &amp;speed) -&gt; Speed</div><div class="ttdef"><b>Definition:</b> <a href="j2735__types_8cpp_source.html#l00111">j2735_types.cpp:111</a></div></div>
<div class="ttc" id="astructcarma__cooperative__perception_1_1UtmCoordinate_html"><div class="ttname"><a href="structcarma__cooperative__perception_1_1UtmCoordinate.html">carma_cooperative_perception::UtmCoordinate</a></div><div class="ttdoc">Represents a position using UTM coordinates.</div><div class="ttdef"><b>Definition:</b> <a href="geodetic_8hpp_source.html#l00049">geodetic.hpp:50</a></div></div>
<div class="ttc" id="astructcarma__cooperative__perception_1_1Wgs84Coordinate_html"><div class="ttname"><a href="structcarma__cooperative__perception_1_1Wgs84Coordinate.html">carma_cooperative_perception::Wgs84Coordinate</a></div><div class="ttdoc">Represents a position using WGS-84 coordinates.</div><div class="ttdef"><b>Definition:</b> <a href="geodetic_8hpp_source.html#l00032">geodetic.hpp:33</a></div></div>
<div class="ttc" id="astructcarma__cooperative__perception_1_1Wgs84Coordinate_html_aeadbc11ce34d77b0057824fe52cea8dd"><div class="ttname"><a href="structcarma__cooperative__perception_1_1Wgs84Coordinate.html#aeadbc11ce34d77b0057824fe52cea8dd">carma_cooperative_perception::Wgs84Coordinate::latitude</a></div><div class="ttdeci">units::angle::degree_t latitude</div><div class="ttdef"><b>Definition:</b> <a href="geodetic_8hpp_source.html#l00034">geodetic.hpp:34</a></div></div>
<div class="ttc" id="aunits__extensions_8hpp_html"><div class="ttname"><a href="units__extensions_8hpp.html">units_extensions.hpp</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_de73b34821d297bc7072366944012629.html">carma_cooperative_perception</a></li><li class="navelem"><a class="el" href="dir_18b6d8ada02823679ceefdf3a51fdefd.html">src</a></li><li class="navelem"><a class="el" href="msg__conversion_8cpp.html">msg_conversion.cpp</a></li>
    <li class="footer">Generated on Tue Mar 5 2024 22:23:40 for Carma-platform by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4 </li>
  </ul>
</div>
</body>
</html>
