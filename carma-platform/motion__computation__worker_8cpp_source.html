<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Carma-platform: motion_computation/src/motion_computation_worker.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Carma-platform<span id="projectnumber">&#160;v4.2.0</span>
   </div>
   <div id="projectbrief">CARMA Platform is built on robot operating system (ROS) and utilizes open source software (OSS) that enables Cooperative Driving Automation (CDA) features to allow Automated Driving Systems to interact and cooperate with infrastructure and other vehicles through communication.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('motion__computation__worker_8cpp_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle"><div class="title">motion_computation_worker.cpp</div></div>
</div><!--header-->
<div class="contents">
<a href="motion__computation__worker_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">// Copyright 2019-2023 Leidos</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment">//</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment">// you may not use this file except in compliance with the License.</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment">// You may obtain a copy of the License at</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="comment">//</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="comment">//     http://www.apache.org/licenses/LICENSE-2.0</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="comment">//</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="comment">// Unless required by applicable law or agreed to in writing, software</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="comment">// distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="comment">// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="comment">// See the License for the specific language governing permissions and</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="comment">// limitations under the License.</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span> </div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="preprocessor">#include &quot;<a class="code" href="motion__computation__worker_8hpp.html">motion_computation/motion_computation_worker.hpp</a>&quot;</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="preprocessor">#include &lt;wgs84_utils/proj_tools.h&gt;</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="preprocessor">#include &lt;memory&gt;</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="preprocessor">#include &quot;<a class="code" href="message__conversions_8hpp.html">motion_computation/message_conversions.hpp</a>&quot;</span></div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span> </div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="keyword">namespace </span><a class="code hl_namespace" href="namespacemotion__computation.html">motion_computation</a></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span>{</div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span> </div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno"><a class="line" href="classmotion__computation_1_1MotionComputationWorker.html#acd5a1fcc357f5824c5fd358bc52873e4">   24</a></span><a class="code hl_function" href="classmotion__computation_1_1MotionComputationWorker.html#acd5a1fcc357f5824c5fd358bc52873e4">MotionComputationWorker::MotionComputationWorker</a>(</div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span>  <span class="keyword">const</span> <a class="code hl_typedef" href="classmotion__computation_1_1MotionComputationWorker.html#a9aad378cce19f70eb8840ea4600fcccb">PublishObjectCallback</a> &amp; obj_pub,</div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span>  rclcpp::node_interfaces::NodeLoggingInterface::SharedPtr logger,</div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span>  rclcpp::node_interfaces::NodeClockInterface::SharedPtr node_clock)</div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span>: obj_pub_(obj_pub), logger_(logger), node_clock_(node_clock)</div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span>{</div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span>}</div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span> </div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno"><a class="line" href="classmotion__computation_1_1MotionComputationWorker.html#a33ea3fe0d96620798fe778aebaf5b244">   32</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classmotion__computation_1_1MotionComputationWorker.html#a33ea3fe0d96620798fe778aebaf5b244">MotionComputationWorker::predictionLogic</a>(</div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span>  carma_perception_msgs::msg::ExternalObjectList::UniquePtr obj_list)</div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span>{</div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span>  carma_perception_msgs::msg::ExternalObjectList sensor_list;</div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span>  sensor_list.header = obj_list-&gt;header;</div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span> </div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> obj : obj_list-&gt;objects) {</div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span>    <span class="comment">// Header contains the frame rest of the fields will use</span></div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span>    <span class="comment">// obj.header = obj_list.objects[i].header;</span></div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span> </div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span>    <span class="comment">// Object id. Matching ids on a topic should refer to the same object within</span></div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span>    <span class="comment">// some time period, expanded</span></div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span>    <span class="comment">// obj.id = obj_list.objects[i].id;</span></div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span> </div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span>    <span class="comment">// Update the object type and generate predictions using CV or CTRV vehicle models.</span></div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span>    <span class="comment">// If the object is a bicycle or motor vehicle use CTRV otherwise use CV.</span></div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span> </div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span>    <span class="keywordtype">bool</span> use_ctrv_model;</div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span> </div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span>    <span class="keywordflow">if</span> (obj.object_type == obj.UNKNOWN) {</div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span>      use_ctrv_model = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (obj.object_type == obj.MOTORCYCLE) {</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span>      use_ctrv_model = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (obj.object_type == obj.SMALL_VEHICLE) {</div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span>      use_ctrv_model = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (obj.object_type == obj.LARGE_VEHICLE) {</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>      use_ctrv_model = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (obj.object_type == obj.PEDESTRIAN) {</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>      use_ctrv_model = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span>      obj.object_type = obj.UNKNOWN;</div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>      use_ctrv_model = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span>    }  <span class="comment">// end if-else</span></div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span> </div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span>    <span class="keywordflow">if</span> (use_ctrv_model == <span class="keyword">true</span>) {</div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>      obj.predictions = motion_predict::ctrv::predictPeriod(</div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span>        obj, <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a75a91331d4caf17b295a821b7a29119d">prediction_time_step_</a>, <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a2b00f2256a1762699ce4d873dff0754e">prediction_period_</a>, <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a3abe5df93c5f4696797a144953119f07">prediction_process_noise_max_</a>,</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>        <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a33f5389aa7cc8457cc9810781e4e7569">prediction_confidence_drop_rate_</a>);</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>      obj.predictions = motion_predict::cv::predictPeriod(</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>        obj, <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a75a91331d4caf17b295a821b7a29119d">prediction_time_step_</a>, <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a2b00f2256a1762699ce4d873dff0754e">prediction_period_</a>, <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#ad8abb22138f9974cb82eeabfbcd5bb07">cv_x_accel_noise_</a>, <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a4dbb52fc92b8345ec6d62108c73ca299">cv_y_accel_noise_</a>,</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>        <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a3abe5df93c5f4696797a144953119f07">prediction_process_noise_max_</a>, <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a33f5389aa7cc8457cc9810781e4e7569">prediction_confidence_drop_rate_</a>);</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>    }</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>    sensor_list.objects.emplace_back(obj);</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>  }  <span class="comment">// end for-loop</span></div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span> </div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>  <span class="comment">// Synchronize all data to the current sensor data timestamp</span></div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>  carma_perception_msgs::msg::ExternalObjectList synchronization_base_objects;</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>  synchronization_base_objects.header =</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>    sensor_list</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>      .header;  <span class="comment">// Use the current sensing stamp as the sync point even if sensor data is not used</span></div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span> </div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a69d455e77570113355e84c6eb33b7048">enable_sensor_processing_</a>) {</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>    <span class="comment">// If using sensor data add it to the base synchronization list since it</span></div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>    <span class="comment">// already is at the desired time</span></div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span> </div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>    synchronization_base_objects.objects = sensor_list.objects;</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span> </div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#ad282d001b3a63ace2ab5456484da5e53">enable_bsm_processing_</a> || <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#ab21b0e0accf676fcf19e5eb57430d79c">enable_psm_processing_</a> || <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#aa3bf88e34198e07a6d056a0d27d04575">enable_mobility_path_processing_</a>) {</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>    <span class="comment">// Since we use the new sensor data as the sync point we will still be</span></div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>    <span class="comment">// synchronizing but to an empty list</span></div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>    synchronization_base_objects.objects.clear();</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span> </div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>    RCLCPP_WARN_STREAM(</div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>      <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a6a97268cc2703045349e70af791e5856">logger_</a>-&gt;get_logger(),</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>      <span class="stringliteral">&quot;Not configured to publish any data publishing empty object list. Operating like this is NOT &quot;</span></div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>      <span class="stringliteral">&quot;advised.&quot;</span>);</div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span> </div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>    <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#ad7ea03c34b8cb277f4a99ea5b6ef7a33">obj_pub_</a>(synchronization_base_objects);</div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>    <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a1a3aa0e53d8931645b9cb4c1e1f9999b">bsm_list_</a>.objects.clear();</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>    <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a528c5c257f58e5102f6a268d4fe0eb45">bsm_obj_id_map_</a>.clear();</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>    <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a43bf7980171df291fc8e41b978f01da6">psm_list_</a>.objects.clear();</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>    <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a716c579f206b023a78f068ceaeb6356f">psm_obj_id_map_</a>.clear();</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>    <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a4644ab2f5f3c1666478d7df96d42a4a3">mobility_path_list_</a>.objects.clear();</div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>    <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#adf18dbb989d5bdac136894cc1fd5f46b">mobility_path_obj_id_map_</a>.clear();</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span> </div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>  }</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span> </div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>  <span class="comment">// Start synchronizing all the enabled data streams</span></div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#ad282d001b3a63ace2ab5456484da5e53">enable_bsm_processing_</a>) {</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>    synchronization_base_objects = <a class="code hl_function" href="classmotion__computation_1_1MotionComputationWorker.html#a49a5ef12b634224276cc3d8efa5f64e9">synchronizeAndAppend</a>(synchronization_base_objects, <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a1a3aa0e53d8931645b9cb4c1e1f9999b">bsm_list_</a>);</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>  }</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span> </div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#ab21b0e0accf676fcf19e5eb57430d79c">enable_psm_processing_</a>) {</div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>    synchronization_base_objects = <a class="code hl_function" href="classmotion__computation_1_1MotionComputationWorker.html#a49a5ef12b634224276cc3d8efa5f64e9">synchronizeAndAppend</a>(synchronization_base_objects, <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a43bf7980171df291fc8e41b978f01da6">psm_list_</a>);</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>  }</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span> </div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#aa3bf88e34198e07a6d056a0d27d04575">enable_mobility_path_processing_</a>) {</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>    synchronization_base_objects =</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>      <a class="code hl_function" href="classmotion__computation_1_1MotionComputationWorker.html#a49a5ef12b634224276cc3d8efa5f64e9">synchronizeAndAppend</a>(synchronization_base_objects, <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a4644ab2f5f3c1666478d7df96d42a4a3">mobility_path_list_</a>);</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>  }</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span> </div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>  <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#ad7ea03c34b8cb277f4a99ea5b6ef7a33">obj_pub_</a>(synchronization_base_objects);</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>  <span class="comment">// Clear msg queue since it is published</span></div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>  <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a4644ab2f5f3c1666478d7df96d42a4a3">mobility_path_list_</a>.objects.clear();</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>  <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#adf18dbb989d5bdac136894cc1fd5f46b">mobility_path_obj_id_map_</a>.clear();</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>  <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a1a3aa0e53d8931645b9cb4c1e1f9999b">bsm_list_</a>.objects.clear();</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>  <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a528c5c257f58e5102f6a268d4fe0eb45">bsm_obj_id_map_</a>.clear();</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>  <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a43bf7980171df291fc8e41b978f01da6">psm_list_</a>.objects.clear();</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>  <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a716c579f206b023a78f068ceaeb6356f">psm_obj_id_map_</a>.clear();</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>}</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span> </div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno"><a class="line" href="classmotion__computation_1_1MotionComputationWorker.html#a1f1f0e8054453be917cac5a0779a1ffc">  136</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classmotion__computation_1_1MotionComputationWorker.html#a1f1f0e8054453be917cac5a0779a1ffc">MotionComputationWorker::georeferenceCallback</a>(<span class="keyword">const</span> std_msgs::msg::String::UniquePtr msg)</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>{</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>  <span class="comment">// Build projector from proj string</span></div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>  <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a601902717851b06edd88dcd9f8c07127">map_projector_</a> = std::make_shared&lt;lanelet::projection::LocalFrameProjector&gt;(msg-&gt;data.c_str());</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span> </div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>  std::string axis =</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>    wgs84_utils::proj_tools::getAxisFromProjString(msg-&gt;data);  <span class="comment">// Extract axis for orientation calc</span></div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span> </div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>  RCLCPP_INFO_STREAM(<a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a6a97268cc2703045349e70af791e5856">logger_</a>-&gt;get_logger(), <span class="stringliteral">&quot;Extracted Axis: &quot;</span> &lt;&lt; axis);</div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span> </div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>  <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a4661782a56d39e53ffd369f943d7bcf5">ned_in_map_rotation_</a> =</div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>    wgs84_utils::proj_tools::getRotationOfNEDFromProjAxis(axis);  <span class="comment">// Extract map rotation from axis</span></div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span> </div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>  RCLCPP_DEBUG_STREAM(</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>    <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a6a97268cc2703045349e70af791e5856">logger_</a>-&gt;get_logger(), <span class="stringliteral">&quot;Extracted NED in Map Rotation (x,y,z,w) : ( &quot;</span></div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>                             &lt;&lt; <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a4661782a56d39e53ffd369f943d7bcf5">ned_in_map_rotation_</a>.getX() &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a4661782a56d39e53ffd369f943d7bcf5">ned_in_map_rotation_</a>.getY()</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>                             &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a4661782a56d39e53ffd369f943d7bcf5">ned_in_map_rotation_</a>.getZ() &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>                             &lt;&lt; <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a4661782a56d39e53ffd369f943d7bcf5">ned_in_map_rotation_</a>.getW());</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>}</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span> </div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno"><a class="line" href="classmotion__computation_1_1MotionComputationWorker.html#af16420fdd8ee92f0c238d76c83342049">  156</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classmotion__computation_1_1MotionComputationWorker.html#af16420fdd8ee92f0c238d76c83342049">MotionComputationWorker::setPredictionTimeStep</a>(<span class="keywordtype">double</span> time_step)</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>{</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>  <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a75a91331d4caf17b295a821b7a29119d">prediction_time_step_</a> = time_step;</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>}</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span> </div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno"><a class="line" href="classmotion__computation_1_1MotionComputationWorker.html#ab9f033ba771d1dbbb98c967b43da1cd5">  161</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classmotion__computation_1_1MotionComputationWorker.html#ab9f033ba771d1dbbb98c967b43da1cd5">MotionComputationWorker::setPredictionPeriod</a>(<span class="keywordtype">double</span> period) { <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a2b00f2256a1762699ce4d873dff0754e">prediction_period_</a> = period; }</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span> </div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno"><a class="line" href="classmotion__computation_1_1MotionComputationWorker.html#ab001e498303974201377c2b784389973">  163</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classmotion__computation_1_1MotionComputationWorker.html#ab001e498303974201377c2b784389973">MotionComputationWorker::setXAccelerationNoise</a>(<span class="keywordtype">double</span> noise) { <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#ad8abb22138f9974cb82eeabfbcd5bb07">cv_x_accel_noise_</a> = noise; }</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span> </div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno"><a class="line" href="classmotion__computation_1_1MotionComputationWorker.html#a99826ad27ee8221471ff5dda2fdd767c">  165</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classmotion__computation_1_1MotionComputationWorker.html#a99826ad27ee8221471ff5dda2fdd767c">MotionComputationWorker::setYAccelerationNoise</a>(<span class="keywordtype">double</span> noise) { <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a4dbb52fc92b8345ec6d62108c73ca299">cv_y_accel_noise_</a> = noise; }</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span> </div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno"><a class="line" href="classmotion__computation_1_1MotionComputationWorker.html#ad351b4970f99d385587d38351b437e04">  167</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classmotion__computation_1_1MotionComputationWorker.html#ad351b4970f99d385587d38351b437e04">MotionComputationWorker::setProcessNoiseMax</a>(<span class="keywordtype">double</span> noise_max)</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>{</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>  <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a3abe5df93c5f4696797a144953119f07">prediction_process_noise_max_</a> = noise_max;</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>}</div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span> </div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno"><a class="line" href="classmotion__computation_1_1MotionComputationWorker.html#a1aa33aa1c449181a67811d6384f29517">  172</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classmotion__computation_1_1MotionComputationWorker.html#a1aa33aa1c449181a67811d6384f29517">MotionComputationWorker::setConfidenceDropRate</a>(<span class="keywordtype">double</span> drop_rate)</div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>{</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>  <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a33f5389aa7cc8457cc9810781e4e7569">prediction_confidence_drop_rate_</a> = drop_rate;</div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>}</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span> </div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno"><a class="line" href="classmotion__computation_1_1MotionComputationWorker.html#aa1c0d03124e0faca92fc932881fcf9c3">  177</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classmotion__computation_1_1MotionComputationWorker.html#aa1c0d03124e0faca92fc932881fcf9c3">MotionComputationWorker::setDetectionInputFlags</a>(</div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>  <span class="keywordtype">bool</span> enable_sensor_processing, <span class="keywordtype">bool</span> enable_bsm_processing, <span class="keywordtype">bool</span> enable_psm_processing,</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>  <span class="keywordtype">bool</span> enable_mobility_path_processing)</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>{</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>  <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a69d455e77570113355e84c6eb33b7048">enable_sensor_processing_</a> = enable_sensor_processing;</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>  <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#ad282d001b3a63ace2ab5456484da5e53">enable_bsm_processing_</a> = enable_bsm_processing;</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>  <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#ab21b0e0accf676fcf19e5eb57430d79c">enable_psm_processing_</a> = enable_psm_processing;</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>  <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#aa3bf88e34198e07a6d056a0d27d04575">enable_mobility_path_processing_</a> = enable_mobility_path_processing;</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>}</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span> </div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno"><a class="line" href="classmotion__computation_1_1MotionComputationWorker.html#ac4b94de8991236d24c73160bfcd85902">  187</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classmotion__computation_1_1MotionComputationWorker.html#ac4b94de8991236d24c73160bfcd85902">MotionComputationWorker::mobilityPathCallback</a>(</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>  <span class="keyword">const</span> carma_v2x_msgs::msg::MobilityPath::UniquePtr msg)</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>{</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a601902717851b06edd88dcd9f8c07127">map_projector_</a>) {</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>    RCLCPP_ERROR(</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>      <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a6a97268cc2703045349e70af791e5856">logger_</a>-&gt;get_logger(), <span class="stringliteral">&quot;Map projection not available yet so ignoring MobilityPath messages&quot;</span>);</div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>  }</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span> </div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#aa3bf88e34198e07a6d056a0d27d04575">enable_mobility_path_processing_</a>) {</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>    RCLCPP_WARN(</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>      <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a6a97268cc2703045349e70af791e5856">logger_</a>-&gt;get_logger(),</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>      <span class="stringliteral">&quot;enable_mobility_path_processing is false so ignoring MobilityPath messages&quot;</span>);</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>  }</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span> </div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>  carma_perception_msgs::msg::ExternalObject obj_msg;</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>  <a class="code hl_function" href="namespacemotion__computation_1_1conversion.html#a9884e63460f3d5f5e2b755354984dc29">conversion::convert</a>(*msg, obj_msg, *<a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a601902717851b06edd88dcd9f8c07127">map_projector_</a>);</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span> </div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>  <span class="comment">// Check if this mobility path is from an object already being queded.</span></div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>  <span class="comment">// If so then update the existing object, if not add it to the queue</span></div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#adf18dbb989d5bdac136894cc1fd5f46b">mobility_path_obj_id_map_</a>.find(obj_msg.id) != <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#adf18dbb989d5bdac136894cc1fd5f46b">mobility_path_obj_id_map_</a>.end()) {</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>    <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a4644ab2f5f3c1666478d7df96d42a4a3">mobility_path_list_</a>.objects[<a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#adf18dbb989d5bdac136894cc1fd5f46b">mobility_path_obj_id_map_</a>[obj_msg.id]] = obj_msg;</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span> </div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>    <span class="comment">// Add the new object to the queue and save its index</span></div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>    <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#adf18dbb989d5bdac136894cc1fd5f46b">mobility_path_obj_id_map_</a>[obj_msg.id] = <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a4644ab2f5f3c1666478d7df96d42a4a3">mobility_path_list_</a>.objects.size();</div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>    <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a4644ab2f5f3c1666478d7df96d42a4a3">mobility_path_list_</a>.objects.push_back(obj_msg);</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>  }</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>}</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span> </div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno"><a class="line" href="classmotion__computation_1_1MotionComputationWorker.html#a4d67a9ee5932611188f5b8f9182520f2">  218</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classmotion__computation_1_1MotionComputationWorker.html#a4d67a9ee5932611188f5b8f9182520f2">MotionComputationWorker::psmCallback</a>(<span class="keyword">const</span> carma_v2x_msgs::msg::PSM::UniquePtr msg)</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>{</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a601902717851b06edd88dcd9f8c07127">map_projector_</a>) {</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>    RCLCPP_DEBUG_STREAM(</div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>      <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a6a97268cc2703045349e70af791e5856">logger_</a>-&gt;get_logger(), <span class="stringliteral">&quot;Map projection not available yet so ignoring PSM messages&quot;</span>);</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>  }</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span> </div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#ab21b0e0accf676fcf19e5eb57430d79c">enable_psm_processing_</a>) {</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>    RCLCPP_DEBUG_STREAM(</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>      <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a6a97268cc2703045349e70af791e5856">logger_</a>-&gt;get_logger(), <span class="stringliteral">&quot;enable_psm_processing is false so ignoring PSM messages&quot;</span>);</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>  }</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span> </div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>  carma_perception_msgs::msg::ExternalObject obj_msg;</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>  <a class="code hl_function" href="namespacemotion__computation_1_1conversion.html#a9884e63460f3d5f5e2b755354984dc29">conversion::convert</a>(</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>    *msg, obj_msg, <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#ad16fbbcd1551e7af616d9f5270ca3d24">map_frame_id_</a>, <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a2b00f2256a1762699ce4d873dff0754e">prediction_period_</a>, <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a75a91331d4caf17b295a821b7a29119d">prediction_time_step_</a>, *<a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a601902717851b06edd88dcd9f8c07127">map_projector_</a>,</div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>    <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a4661782a56d39e53ffd369f943d7bcf5">ned_in_map_rotation_</a>, <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#aba7073627f99c92ccb34784ab27f0131">node_clock_</a>);</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span> </div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>  <span class="comment">// Check if this psm is from an object already being queded.</span></div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>  <span class="comment">// If so then update the existing object, if not add it to the queue</span></div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a716c579f206b023a78f068ceaeb6356f">psm_obj_id_map_</a>.find(obj_msg.id) != <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a716c579f206b023a78f068ceaeb6356f">psm_obj_id_map_</a>.end()) {</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>    <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a43bf7980171df291fc8e41b978f01da6">psm_list_</a>.objects[<a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a716c579f206b023a78f068ceaeb6356f">psm_obj_id_map_</a>[obj_msg.id]] = obj_msg;</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span> </div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>    <span class="comment">// Add the new object to the queue and save its index</span></div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>    <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a716c579f206b023a78f068ceaeb6356f">psm_obj_id_map_</a>[obj_msg.id] = <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a43bf7980171df291fc8e41b978f01da6">psm_list_</a>.objects.size();</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>    <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a43bf7980171df291fc8e41b978f01da6">psm_list_</a>.objects.push_back(obj_msg);</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>  }</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>}</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span> </div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno"><a class="line" href="classmotion__computation_1_1MotionComputationWorker.html#a5e3044066ec8779205710e50b90a2c08">  249</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classmotion__computation_1_1MotionComputationWorker.html#a5e3044066ec8779205710e50b90a2c08">MotionComputationWorker::bsmCallback</a>(<span class="keyword">const</span> carma_v2x_msgs::msg::BSM::UniquePtr msg)</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>{</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a601902717851b06edd88dcd9f8c07127">map_projector_</a>) {</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>    RCLCPP_DEBUG_STREAM(</div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>      <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a6a97268cc2703045349e70af791e5856">logger_</a>-&gt;get_logger(), <span class="stringliteral">&quot;Map projection not available yet so ignoring PSM messages&quot;</span>);</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>  }</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span> </div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#ad282d001b3a63ace2ab5456484da5e53">enable_bsm_processing_</a>) {</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>    RCLCPP_DEBUG_STREAM(</div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>      <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a6a97268cc2703045349e70af791e5856">logger_</a>-&gt;get_logger(), <span class="stringliteral">&quot;enable_bsm_processing is false so ignoring BSM messages&quot;</span>);</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>  }</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span> </div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>  carma_perception_msgs::msg::ExternalObject obj_msg;</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>  <a class="code hl_function" href="namespacemotion__computation_1_1conversion.html#a9884e63460f3d5f5e2b755354984dc29">conversion::convert</a>(</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>    *msg, obj_msg, <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#ad16fbbcd1551e7af616d9f5270ca3d24">map_frame_id_</a>, <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a2b00f2256a1762699ce4d873dff0754e">prediction_period_</a>, <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a75a91331d4caf17b295a821b7a29119d">prediction_time_step_</a>, *<a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a601902717851b06edd88dcd9f8c07127">map_projector_</a>,</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>    <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a4661782a56d39e53ffd369f943d7bcf5">ned_in_map_rotation_</a>);</div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span> </div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>  <span class="comment">// Check if this bsm is from an object already being queded.</span></div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>  <span class="comment">// If so then update the existing object, if not add it to the queue</span></div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a528c5c257f58e5102f6a268d4fe0eb45">bsm_obj_id_map_</a>.find(obj_msg.id) != <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a528c5c257f58e5102f6a268d4fe0eb45">bsm_obj_id_map_</a>.end()) {</div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>    <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a1a3aa0e53d8931645b9cb4c1e1f9999b">bsm_list_</a>.objects[<a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a528c5c257f58e5102f6a268d4fe0eb45">bsm_obj_id_map_</a>[obj_msg.id]] = obj_msg;</div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span> </div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>    <span class="comment">// Add the new object to the queue and save its index</span></div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>    <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a528c5c257f58e5102f6a268d4fe0eb45">bsm_obj_id_map_</a>[obj_msg.id] = <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a1a3aa0e53d8931645b9cb4c1e1f9999b">bsm_list_</a>.objects.size();</div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>    <a class="code hl_variable" href="classmotion__computation_1_1MotionComputationWorker.html#a1a3aa0e53d8931645b9cb4c1e1f9999b">bsm_list_</a>.objects.push_back(obj_msg);</div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>  }</div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>}</div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span> </div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno"><a class="line" href="classmotion__computation_1_1MotionComputationWorker.html#a49a5ef12b634224276cc3d8efa5f64e9">  280</a></span>carma_perception_msgs::msg::ExternalObjectList <a class="code hl_function" href="classmotion__computation_1_1MotionComputationWorker.html#a49a5ef12b634224276cc3d8efa5f64e9">MotionComputationWorker::synchronizeAndAppend</a>(</div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>  <span class="keyword">const</span> carma_perception_msgs::msg::ExternalObjectList &amp; base_objects,</div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>  carma_perception_msgs::msg::ExternalObjectList new_objects)<span class="keyword"> const</span></div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span><span class="keyword"></span>{</div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>  carma_perception_msgs::msg::ExternalObjectList output_list;</div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>  output_list.header = base_objects.header;</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>  output_list.objects.reserve(base_objects.objects.size() + new_objects.objects.size());</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span> </div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>  <span class="comment">// Compare time_stamps of first elements of each list as they are guaranteed to be the</span></div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>  <span class="comment">// earliest of the respective lists</span></div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span> </div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; obj : new_objects.objects) {</div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>    <span class="comment">// interpolate and match timesteps</span></div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>    obj = <a class="code hl_function" href="classmotion__computation_1_1MotionComputationWorker.html#aeef9e93bc84a885e83223b726470fb78">matchAndInterpolateTimeStamp</a>(obj, rclcpp::Time(base_objects.header.stamp));</div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>  }</div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span> </div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>  output_list.objects.insert(</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>    output_list.objects.begin(), base_objects.objects.begin(), base_objects.objects.end());</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>  output_list.objects.insert(</div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>    output_list.objects.end(), new_objects.objects.begin(), new_objects.objects.end());</div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>  <span class="keywordflow">return</span> output_list;</div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>}</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span> </div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno"><a class="line" href="classmotion__computation_1_1MotionComputationWorker.html#aeef9e93bc84a885e83223b726470fb78">  303</a></span>carma_perception_msgs::msg::ExternalObject <a class="code hl_function" href="classmotion__computation_1_1MotionComputationWorker.html#aeef9e93bc84a885e83223b726470fb78">MotionComputationWorker::matchAndInterpolateTimeStamp</a>(</div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>  carma_perception_msgs::msg::ExternalObject path, <span class="keyword">const</span> rclcpp::Time &amp; time_to_match)<span class="keyword"> const</span></div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span><span class="keyword"></span>{</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>  carma_perception_msgs::msg::ExternalObject output = path;</div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>  <span class="comment">// empty predictions</span></div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>  output.predictions = {};</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span> </div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>  <span class="comment">// add the first point to start of the predictions to easily loop over</span></div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>  carma_perception_msgs::msg::PredictedState prev_state;</div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>  prev_state.header.stamp = output.header.stamp;</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span>  prev_state.predicted_position.orientation = output.pose.pose.orientation;</div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>  prev_state.predicted_velocity = output.velocity.twist;</div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>  prev_state.predicted_position.position.x = output.pose.pose.position.x;</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span>  prev_state.predicted_position.position.y = output.pose.pose.position.y;</div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>  prev_state.predicted_position.position.z = output.pose.pose.position.z;</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>  path.predictions.insert(path.predictions.begin(), prev_state);</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span> </div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>  rclcpp::Time curr_time_to_match = time_to_match;</div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span> </div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>  <span class="comment">// because of this logic, we would not encounter mobility path</span></div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>  <span class="comment">// that starts later than the time we are trying to match (which is starting</span></div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>  <span class="comment">// time of sensed objects)</span></div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>  <span class="keywordtype">bool</span> is_first_point = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>  carma_perception_msgs::msg::PredictedState new_state;</div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span> &amp; curr_state : path.predictions) {</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>    <span class="keywordflow">if</span> (curr_time_to_match &gt; curr_state.header.stamp) {</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>      prev_state = curr_state;</div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>    }</div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span> </div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>    <span class="keywordflow">if</span> (is_first_point)  <span class="comment">// we store in the body if it is the first point, not predictions</span></div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>    {</div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>      <span class="comment">// reaching here means curr_state starts later than the time we are trying to match</span></div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>      <span class="comment">// copy old unchanged parts</span></div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>      new_state.header.stamp = curr_time_to_match;</div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>      new_state.predicted_velocity = prev_state.predicted_velocity;</div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>      new_state.predicted_position.orientation = prev_state.predicted_position.orientation;</div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span> </div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>      <span class="comment">// interpolate position</span></div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>      rclcpp::Duration delta_t = rclcpp::Time(curr_state.header.stamp) - curr_time_to_match;</div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>      rclcpp::Duration pred_delta_t =</div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span>        rclcpp::Time(curr_state.header.stamp) - rclcpp::Time(prev_state.header.stamp);</div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span>      <span class="keywordtype">double</span> ratio;</div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span>      <span class="keywordflow">if</span> (pred_delta_t.seconds() &lt; 0.00000001) {  <span class="comment">// Divide by zero check</span></div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span>        <span class="comment">// This can only happen if effectively all 3 points are on top of each other</span></div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span>        <span class="comment">// which is extremely unlikely</span></div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>        ratio = 0.0;</div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>        ratio = delta_t.seconds() / pred_delta_t.seconds();</div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span>      }</div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span> </div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span>      <span class="keywordtype">double</span> delta_x =</div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>        curr_state.predicted_position.position.x - prev_state.predicted_position.position.x;</div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>      <span class="keywordtype">double</span> delta_y =</div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>        curr_state.predicted_position.position.y - prev_state.predicted_position.position.y;</div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>      <span class="keywordtype">double</span> delta_z =</div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>        curr_state.predicted_position.position.z - prev_state.predicted_position.position.z;</div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>      <span class="comment">// we are &quot;stepping back in time&quot; to match the position</span></div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>      new_state.predicted_position.position.x =</div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>        curr_state.predicted_position.position.x - delta_x * ratio;</div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span>      new_state.predicted_position.position.y =</div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>        curr_state.predicted_position.position.y - delta_y * ratio;</div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>      new_state.predicted_position.position.z =</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>        curr_state.predicted_position.position.z - delta_z * ratio;</div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span> </div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>      output.header.stamp = curr_time_to_match;</div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>      output.pose.pose.orientation = new_state.predicted_position.orientation;</div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>      output.velocity.twist = new_state.predicted_velocity;</div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>      output.pose.pose.position.x = new_state.predicted_position.position.x;</div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>      output.pose.pose.position.y = new_state.predicted_position.position.y;</div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>      output.pose.pose.position.z = new_state.predicted_position.position.z;</div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>      is_first_point = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span> </div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>      output.predictions.push_back(curr_state);</div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>    }</div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>  }</div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span> </div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>  <span class="keywordflow">return</span> output;</div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>}</div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span> </div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>}  <span class="comment">// namespace motion_computation</span></div>
<div class="ttc" id="aclassmotion__computation_1_1MotionComputationWorker_html_a1a3aa0e53d8931645b9cb4c1e1f9999b"><div class="ttname"><a href="classmotion__computation_1_1MotionComputationWorker.html#a1a3aa0e53d8931645b9cb4c1e1f9999b">motion_computation::MotionComputationWorker::bsm_list_</a></div><div class="ttdeci">carma_perception_msgs::msg::ExternalObjectList bsm_list_</div><div class="ttdef"><b>Definition:</b> <a href="motion__computation__worker_8hpp_source.html#l00153">motion_computation_worker.hpp:153</a></div></div>
<div class="ttc" id="aclassmotion__computation_1_1MotionComputationWorker_html_a1aa33aa1c449181a67811d6384f29517"><div class="ttname"><a href="classmotion__computation_1_1MotionComputationWorker.html#a1aa33aa1c449181a67811d6384f29517">motion_computation::MotionComputationWorker::setConfidenceDropRate</a></div><div class="ttdeci">void setConfidenceDropRate(double drop_rate)</div><div class="ttdef"><b>Definition:</b> <a href="motion__computation__worker_8cpp_source.html#l00172">motion_computation_worker.cpp:172</a></div></div>
<div class="ttc" id="aclassmotion__computation_1_1MotionComputationWorker_html_a1f1f0e8054453be917cac5a0779a1ffc"><div class="ttname"><a href="classmotion__computation_1_1MotionComputationWorker.html#a1f1f0e8054453be917cac5a0779a1ffc">motion_computation::MotionComputationWorker::georeferenceCallback</a></div><div class="ttdeci">void georeferenceCallback(const std_msgs::msg::String::UniquePtr msg)</div><div class="ttdoc">Callback for map projection string to define lat/lon -&gt; map conversion.</div><div class="ttdef"><b>Definition:</b> <a href="motion__computation__worker_8cpp_source.html#l00136">motion_computation_worker.cpp:136</a></div></div>
<div class="ttc" id="aclassmotion__computation_1_1MotionComputationWorker_html_a2b00f2256a1762699ce4d873dff0754e"><div class="ttname"><a href="classmotion__computation_1_1MotionComputationWorker.html#a2b00f2256a1762699ce4d873dff0754e">motion_computation::MotionComputationWorker::prediction_period_</a></div><div class="ttdeci">double prediction_period_</div><div class="ttdef"><b>Definition:</b> <a href="motion__computation__worker_8hpp_source.html#l00131">motion_computation_worker.hpp:131</a></div></div>
<div class="ttc" id="aclassmotion__computation_1_1MotionComputationWorker_html_a33ea3fe0d96620798fe778aebaf5b244"><div class="ttname"><a href="classmotion__computation_1_1MotionComputationWorker.html#a33ea3fe0d96620798fe778aebaf5b244">motion_computation::MotionComputationWorker::predictionLogic</a></div><div class="ttdeci">void predictionLogic(carma_perception_msgs::msg::ExternalObjectList::UniquePtr obj_list)</div><div class="ttdoc">Function to populate duplicated detected objects along with their velocity, yaw, yaw_rate and static/...</div><div class="ttdef"><b>Definition:</b> <a href="motion__computation__worker_8cpp_source.html#l00032">motion_computation_worker.cpp:32</a></div></div>
<div class="ttc" id="aclassmotion__computation_1_1MotionComputationWorker_html_a33f5389aa7cc8457cc9810781e4e7569"><div class="ttname"><a href="classmotion__computation_1_1MotionComputationWorker.html#a33f5389aa7cc8457cc9810781e4e7569">motion_computation::MotionComputationWorker::prediction_confidence_drop_rate_</a></div><div class="ttdeci">double prediction_confidence_drop_rate_</div><div class="ttdef"><b>Definition:</b> <a href="motion__computation__worker_8hpp_source.html#l00135">motion_computation_worker.hpp:135</a></div></div>
<div class="ttc" id="aclassmotion__computation_1_1MotionComputationWorker_html_a3abe5df93c5f4696797a144953119f07"><div class="ttname"><a href="classmotion__computation_1_1MotionComputationWorker.html#a3abe5df93c5f4696797a144953119f07">motion_computation::MotionComputationWorker::prediction_process_noise_max_</a></div><div class="ttdeci">double prediction_process_noise_max_</div><div class="ttdef"><b>Definition:</b> <a href="motion__computation__worker_8hpp_source.html#l00134">motion_computation_worker.hpp:134</a></div></div>
<div class="ttc" id="aclassmotion__computation_1_1MotionComputationWorker_html_a43bf7980171df291fc8e41b978f01da6"><div class="ttname"><a href="classmotion__computation_1_1MotionComputationWorker.html#a43bf7980171df291fc8e41b978f01da6">motion_computation::MotionComputationWorker::psm_list_</a></div><div class="ttdeci">carma_perception_msgs::msg::ExternalObjectList psm_list_</div><div class="ttdef"><b>Definition:</b> <a href="motion__computation__worker_8hpp_source.html#l00154">motion_computation_worker.hpp:154</a></div></div>
<div class="ttc" id="aclassmotion__computation_1_1MotionComputationWorker_html_a4644ab2f5f3c1666478d7df96d42a4a3"><div class="ttname"><a href="classmotion__computation_1_1MotionComputationWorker.html#a4644ab2f5f3c1666478d7df96d42a4a3">motion_computation::MotionComputationWorker::mobility_path_list_</a></div><div class="ttdeci">carma_perception_msgs::msg::ExternalObjectList mobility_path_list_</div><div class="ttdef"><b>Definition:</b> <a href="motion__computation__worker_8hpp_source.html#l00152">motion_computation_worker.hpp:152</a></div></div>
<div class="ttc" id="aclassmotion__computation_1_1MotionComputationWorker_html_a4661782a56d39e53ffd369f943d7bcf5"><div class="ttname"><a href="classmotion__computation_1_1MotionComputationWorker.html#a4661782a56d39e53ffd369f943d7bcf5">motion_computation::MotionComputationWorker::ned_in_map_rotation_</a></div><div class="ttdeci">tf2::Quaternion ned_in_map_rotation_</div><div class="ttdef"><b>Definition:</b> <a href="motion__computation__worker_8hpp_source.html#l00164">motion_computation_worker.hpp:164</a></div></div>
<div class="ttc" id="aclassmotion__computation_1_1MotionComputationWorker_html_a49a5ef12b634224276cc3d8efa5f64e9"><div class="ttname"><a href="classmotion__computation_1_1MotionComputationWorker.html#a49a5ef12b634224276cc3d8efa5f64e9">motion_computation::MotionComputationWorker::synchronizeAndAppend</a></div><div class="ttdeci">carma_perception_msgs::msg::ExternalObjectList synchronizeAndAppend(const carma_perception_msgs::msg::ExternalObjectList &amp;base_objects, carma_perception_msgs::msg::ExternalObjectList new_objects) const</div><div class="ttdoc">Appends external objects list behind base_objects. This does not do sensor fusion....</div><div class="ttdef"><b>Definition:</b> <a href="motion__computation__worker_8cpp_source.html#l00280">motion_computation_worker.cpp:280</a></div></div>
<div class="ttc" id="aclassmotion__computation_1_1MotionComputationWorker_html_a4d67a9ee5932611188f5b8f9182520f2"><div class="ttname"><a href="classmotion__computation_1_1MotionComputationWorker.html#a4d67a9ee5932611188f5b8f9182520f2">motion_computation::MotionComputationWorker::psmCallback</a></div><div class="ttdeci">void psmCallback(const carma_v2x_msgs::msg::PSM::UniquePtr msg)</div><div class="ttdef"><b>Definition:</b> <a href="motion__computation__worker_8cpp_source.html#l00218">motion_computation_worker.cpp:218</a></div></div>
<div class="ttc" id="aclassmotion__computation_1_1MotionComputationWorker_html_a4dbb52fc92b8345ec6d62108c73ca299"><div class="ttname"><a href="classmotion__computation_1_1MotionComputationWorker.html#a4dbb52fc92b8345ec6d62108c73ca299">motion_computation::MotionComputationWorker::cv_y_accel_noise_</a></div><div class="ttdeci">double cv_y_accel_noise_</div><div class="ttdef"><b>Definition:</b> <a href="motion__computation__worker_8hpp_source.html#l00133">motion_computation_worker.hpp:133</a></div></div>
<div class="ttc" id="aclassmotion__computation_1_1MotionComputationWorker_html_a528c5c257f58e5102f6a268d4fe0eb45"><div class="ttname"><a href="classmotion__computation_1_1MotionComputationWorker.html#a528c5c257f58e5102f6a268d4fe0eb45">motion_computation::MotionComputationWorker::bsm_obj_id_map_</a></div><div class="ttdeci">std::unordered_map&lt; uint32_t, size_t &gt; bsm_obj_id_map_</div><div class="ttdef"><b>Definition:</b> <a href="motion__computation__worker_8hpp_source.html#l00158">motion_computation_worker.hpp:158</a></div></div>
<div class="ttc" id="aclassmotion__computation_1_1MotionComputationWorker_html_a5e3044066ec8779205710e50b90a2c08"><div class="ttname"><a href="classmotion__computation_1_1MotionComputationWorker.html#a5e3044066ec8779205710e50b90a2c08">motion_computation::MotionComputationWorker::bsmCallback</a></div><div class="ttdeci">void bsmCallback(const carma_v2x_msgs::msg::BSM::UniquePtr msg)</div><div class="ttdef"><b>Definition:</b> <a href="motion__computation__worker_8cpp_source.html#l00249">motion_computation_worker.cpp:249</a></div></div>
<div class="ttc" id="aclassmotion__computation_1_1MotionComputationWorker_html_a601902717851b06edd88dcd9f8c07127"><div class="ttname"><a href="classmotion__computation_1_1MotionComputationWorker.html#a601902717851b06edd88dcd9f8c07127">motion_computation::MotionComputationWorker::map_projector_</a></div><div class="ttdeci">std::shared_ptr&lt; lanelet::projection::LocalFrameProjector &gt; map_projector_</div><div class="ttdef"><b>Definition:</b> <a href="motion__computation__worker_8hpp_source.html#l00161">motion_computation_worker.hpp:161</a></div></div>
<div class="ttc" id="aclassmotion__computation_1_1MotionComputationWorker_html_a69d455e77570113355e84c6eb33b7048"><div class="ttname"><a href="classmotion__computation_1_1MotionComputationWorker.html#a69d455e77570113355e84c6eb33b7048">motion_computation::MotionComputationWorker::enable_sensor_processing_</a></div><div class="ttdeci">bool enable_sensor_processing_</div><div class="ttdef"><b>Definition:</b> <a href="motion__computation__worker_8hpp_source.html#l00138">motion_computation_worker.hpp:138</a></div></div>
<div class="ttc" id="aclassmotion__computation_1_1MotionComputationWorker_html_a6a97268cc2703045349e70af791e5856"><div class="ttname"><a href="classmotion__computation_1_1MotionComputationWorker.html#a6a97268cc2703045349e70af791e5856">motion_computation::MotionComputationWorker::logger_</a></div><div class="ttdeci">rclcpp::node_interfaces::NodeLoggingInterface::SharedPtr logger_</div><div class="ttdef"><b>Definition:</b> <a href="motion__computation__worker_8hpp_source.html#l00147">motion_computation_worker.hpp:147</a></div></div>
<div class="ttc" id="aclassmotion__computation_1_1MotionComputationWorker_html_a716c579f206b023a78f068ceaeb6356f"><div class="ttname"><a href="classmotion__computation_1_1MotionComputationWorker.html#a716c579f206b023a78f068ceaeb6356f">motion_computation::MotionComputationWorker::psm_obj_id_map_</a></div><div class="ttdeci">std::unordered_map&lt; uint32_t, size_t &gt; psm_obj_id_map_</div><div class="ttdef"><b>Definition:</b> <a href="motion__computation__worker_8hpp_source.html#l00159">motion_computation_worker.hpp:159</a></div></div>
<div class="ttc" id="aclassmotion__computation_1_1MotionComputationWorker_html_a75a91331d4caf17b295a821b7a29119d"><div class="ttname"><a href="classmotion__computation_1_1MotionComputationWorker.html#a75a91331d4caf17b295a821b7a29119d">motion_computation::MotionComputationWorker::prediction_time_step_</a></div><div class="ttdeci">double prediction_time_step_</div><div class="ttdef"><b>Definition:</b> <a href="motion__computation__worker_8hpp_source.html#l00130">motion_computation_worker.hpp:130</a></div></div>
<div class="ttc" id="aclassmotion__computation_1_1MotionComputationWorker_html_a99826ad27ee8221471ff5dda2fdd767c"><div class="ttname"><a href="classmotion__computation_1_1MotionComputationWorker.html#a99826ad27ee8221471ff5dda2fdd767c">motion_computation::MotionComputationWorker::setYAccelerationNoise</a></div><div class="ttdeci">void setYAccelerationNoise(double noise)</div><div class="ttdef"><b>Definition:</b> <a href="motion__computation__worker_8cpp_source.html#l00165">motion_computation_worker.cpp:165</a></div></div>
<div class="ttc" id="aclassmotion__computation_1_1MotionComputationWorker_html_a9aad378cce19f70eb8840ea4600fcccb"><div class="ttname"><a href="classmotion__computation_1_1MotionComputationWorker.html#a9aad378cce19f70eb8840ea4600fcccb">motion_computation::MotionComputationWorker::PublishObjectCallback</a></div><div class="ttdeci">std::function&lt; void(const carma_perception_msgs::msg::ExternalObjectList &amp;)&gt; PublishObjectCallback</div><div class="ttdef"><b>Definition:</b> <a href="motion__computation__worker_8hpp_source.html#l00048">motion_computation_worker.hpp:49</a></div></div>
<div class="ttc" id="aclassmotion__computation_1_1MotionComputationWorker_html_aa1c0d03124e0faca92fc932881fcf9c3"><div class="ttname"><a href="classmotion__computation_1_1MotionComputationWorker.html#aa1c0d03124e0faca92fc932881fcf9c3">motion_computation::MotionComputationWorker::setDetectionInputFlags</a></div><div class="ttdeci">void setDetectionInputFlags(bool enable_sensor_processing, bool enable_bsm_processing, bool enable_psm_processing, bool enable_mobility_path_processing)</div><div class="ttdef"><b>Definition:</b> <a href="motion__computation__worker_8cpp_source.html#l00177">motion_computation_worker.cpp:177</a></div></div>
<div class="ttc" id="aclassmotion__computation_1_1MotionComputationWorker_html_aa3bf88e34198e07a6d056a0d27d04575"><div class="ttname"><a href="classmotion__computation_1_1MotionComputationWorker.html#aa3bf88e34198e07a6d056a0d27d04575">motion_computation::MotionComputationWorker::enable_mobility_path_processing_</a></div><div class="ttdeci">bool enable_mobility_path_processing_</div><div class="ttdef"><b>Definition:</b> <a href="motion__computation__worker_8hpp_source.html#l00141">motion_computation_worker.hpp:141</a></div></div>
<div class="ttc" id="aclassmotion__computation_1_1MotionComputationWorker_html_ab001e498303974201377c2b784389973"><div class="ttname"><a href="classmotion__computation_1_1MotionComputationWorker.html#ab001e498303974201377c2b784389973">motion_computation::MotionComputationWorker::setXAccelerationNoise</a></div><div class="ttdeci">void setXAccelerationNoise(double noise)</div><div class="ttdef"><b>Definition:</b> <a href="motion__computation__worker_8cpp_source.html#l00163">motion_computation_worker.cpp:163</a></div></div>
<div class="ttc" id="aclassmotion__computation_1_1MotionComputationWorker_html_ab21b0e0accf676fcf19e5eb57430d79c"><div class="ttname"><a href="classmotion__computation_1_1MotionComputationWorker.html#ab21b0e0accf676fcf19e5eb57430d79c">motion_computation::MotionComputationWorker::enable_psm_processing_</a></div><div class="ttdeci">bool enable_psm_processing_</div><div class="ttdef"><b>Definition:</b> <a href="motion__computation__worker_8hpp_source.html#l00140">motion_computation_worker.hpp:140</a></div></div>
<div class="ttc" id="aclassmotion__computation_1_1MotionComputationWorker_html_ab9f033ba771d1dbbb98c967b43da1cd5"><div class="ttname"><a href="classmotion__computation_1_1MotionComputationWorker.html#ab9f033ba771d1dbbb98c967b43da1cd5">motion_computation::MotionComputationWorker::setPredictionPeriod</a></div><div class="ttdeci">void setPredictionPeriod(double period)</div><div class="ttdef"><b>Definition:</b> <a href="motion__computation__worker_8cpp_source.html#l00161">motion_computation_worker.cpp:161</a></div></div>
<div class="ttc" id="aclassmotion__computation_1_1MotionComputationWorker_html_aba7073627f99c92ccb34784ab27f0131"><div class="ttname"><a href="classmotion__computation_1_1MotionComputationWorker.html#aba7073627f99c92ccb34784ab27f0131">motion_computation::MotionComputationWorker::node_clock_</a></div><div class="ttdeci">rclcpp::node_interfaces::NodeClockInterface::SharedPtr node_clock_</div><div class="ttdef"><b>Definition:</b> <a href="motion__computation__worker_8hpp_source.html#l00149">motion_computation_worker.hpp:149</a></div></div>
<div class="ttc" id="aclassmotion__computation_1_1MotionComputationWorker_html_ac4b94de8991236d24c73160bfcd85902"><div class="ttname"><a href="classmotion__computation_1_1MotionComputationWorker.html#ac4b94de8991236d24c73160bfcd85902">motion_computation::MotionComputationWorker::mobilityPathCallback</a></div><div class="ttdeci">void mobilityPathCallback(const carma_v2x_msgs::msg::MobilityPath::UniquePtr msg)</div><div class="ttdef"><b>Definition:</b> <a href="motion__computation__worker_8cpp_source.html#l00187">motion_computation_worker.cpp:187</a></div></div>
<div class="ttc" id="aclassmotion__computation_1_1MotionComputationWorker_html_acd5a1fcc357f5824c5fd358bc52873e4"><div class="ttname"><a href="classmotion__computation_1_1MotionComputationWorker.html#acd5a1fcc357f5824c5fd358bc52873e4">motion_computation::MotionComputationWorker::MotionComputationWorker</a></div><div class="ttdeci">MotionComputationWorker(const PublishObjectCallback &amp;obj_pub, rclcpp::node_interfaces::NodeLoggingInterface::SharedPtr logger, rclcpp::node_interfaces::NodeClockInterface::SharedPtr node_clock)</div><div class="ttdoc">Constructor for MotionComputationWorker.</div><div class="ttdef"><b>Definition:</b> <a href="motion__computation__worker_8cpp_source.html#l00024">motion_computation_worker.cpp:24</a></div></div>
<div class="ttc" id="aclassmotion__computation_1_1MotionComputationWorker_html_ad16fbbcd1551e7af616d9f5270ca3d24"><div class="ttname"><a href="classmotion__computation_1_1MotionComputationWorker.html#ad16fbbcd1551e7af616d9f5270ca3d24">motion_computation::MotionComputationWorker::map_frame_id_</a></div><div class="ttdeci">std::string map_frame_id_</div><div class="ttdef"><b>Definition:</b> <a href="motion__computation__worker_8hpp_source.html#l00144">motion_computation_worker.hpp:144</a></div></div>
<div class="ttc" id="aclassmotion__computation_1_1MotionComputationWorker_html_ad282d001b3a63ace2ab5456484da5e53"><div class="ttname"><a href="classmotion__computation_1_1MotionComputationWorker.html#ad282d001b3a63ace2ab5456484da5e53">motion_computation::MotionComputationWorker::enable_bsm_processing_</a></div><div class="ttdeci">bool enable_bsm_processing_</div><div class="ttdef"><b>Definition:</b> <a href="motion__computation__worker_8hpp_source.html#l00139">motion_computation_worker.hpp:139</a></div></div>
<div class="ttc" id="aclassmotion__computation_1_1MotionComputationWorker_html_ad351b4970f99d385587d38351b437e04"><div class="ttname"><a href="classmotion__computation_1_1MotionComputationWorker.html#ad351b4970f99d385587d38351b437e04">motion_computation::MotionComputationWorker::setProcessNoiseMax</a></div><div class="ttdeci">void setProcessNoiseMax(double noise_max)</div><div class="ttdef"><b>Definition:</b> <a href="motion__computation__worker_8cpp_source.html#l00167">motion_computation_worker.cpp:167</a></div></div>
<div class="ttc" id="aclassmotion__computation_1_1MotionComputationWorker_html_ad7ea03c34b8cb277f4a99ea5b6ef7a33"><div class="ttname"><a href="classmotion__computation_1_1MotionComputationWorker.html#ad7ea03c34b8cb277f4a99ea5b6ef7a33">motion_computation::MotionComputationWorker::obj_pub_</a></div><div class="ttdeci">PublishObjectCallback obj_pub_</div><div class="ttdef"><b>Definition:</b> <a href="motion__computation__worker_8hpp_source.html#l00126">motion_computation_worker.hpp:126</a></div></div>
<div class="ttc" id="aclassmotion__computation_1_1MotionComputationWorker_html_ad8abb22138f9974cb82eeabfbcd5bb07"><div class="ttname"><a href="classmotion__computation_1_1MotionComputationWorker.html#ad8abb22138f9974cb82eeabfbcd5bb07">motion_computation::MotionComputationWorker::cv_x_accel_noise_</a></div><div class="ttdeci">double cv_x_accel_noise_</div><div class="ttdef"><b>Definition:</b> <a href="motion__computation__worker_8hpp_source.html#l00132">motion_computation_worker.hpp:132</a></div></div>
<div class="ttc" id="aclassmotion__computation_1_1MotionComputationWorker_html_adf18dbb989d5bdac136894cc1fd5f46b"><div class="ttname"><a href="classmotion__computation_1_1MotionComputationWorker.html#adf18dbb989d5bdac136894cc1fd5f46b">motion_computation::MotionComputationWorker::mobility_path_obj_id_map_</a></div><div class="ttdeci">std::unordered_map&lt; uint32_t, size_t &gt; mobility_path_obj_id_map_</div><div class="ttdef"><b>Definition:</b> <a href="motion__computation__worker_8hpp_source.html#l00157">motion_computation_worker.hpp:157</a></div></div>
<div class="ttc" id="aclassmotion__computation_1_1MotionComputationWorker_html_aeef9e93bc84a885e83223b726470fb78"><div class="ttname"><a href="classmotion__computation_1_1MotionComputationWorker.html#aeef9e93bc84a885e83223b726470fb78">motion_computation::MotionComputationWorker::matchAndInterpolateTimeStamp</a></div><div class="ttdeci">carma_perception_msgs::msg::ExternalObject matchAndInterpolateTimeStamp(carma_perception_msgs::msg::ExternalObject path, const rclcpp::Time &amp;time_to_match) const</div><div class="ttdoc">It cuts ExternalObject's prediction points before the time_to_match. And uses the average velocity in...</div><div class="ttdef"><b>Definition:</b> <a href="motion__computation__worker_8cpp_source.html#l00303">motion_computation_worker.cpp:303</a></div></div>
<div class="ttc" id="aclassmotion__computation_1_1MotionComputationWorker_html_af16420fdd8ee92f0c238d76c83342049"><div class="ttname"><a href="classmotion__computation_1_1MotionComputationWorker.html#af16420fdd8ee92f0c238d76c83342049">motion_computation::MotionComputationWorker::setPredictionTimeStep</a></div><div class="ttdeci">void setPredictionTimeStep(double time_step)</div><div class="ttdef"><b>Definition:</b> <a href="motion__computation__worker_8cpp_source.html#l00156">motion_computation_worker.cpp:156</a></div></div>
<div class="ttc" id="amessage__conversions_8hpp_html"><div class="ttname"><a href="message__conversions_8hpp.html">message_conversions.hpp</a></div></div>
<div class="ttc" id="amotion__computation__worker_8hpp_html"><div class="ttname"><a href="motion__computation__worker_8hpp.html">motion_computation_worker.hpp</a></div></div>
<div class="ttc" id="anamespacemotion__computation_1_1conversion_html_a9884e63460f3d5f5e2b755354984dc29"><div class="ttname"><a href="namespacemotion__computation_1_1conversion.html#a9884e63460f3d5f5e2b755354984dc29">motion_computation::conversion::convert</a></div><div class="ttdeci">void convert(const carma_v2x_msgs::msg::PSM &amp;in_msg, carma_perception_msgs::msg::ExternalObject &amp;out_msg, const std::string &amp;map_frame_id, double pred_period, double pred_step_size, const lanelet::projection::LocalFrameProjector &amp;map_projector, const tf2::Quaternion &amp;ned_in_map_rotation, rclcpp::node_interfaces::NodeClockInterface::SharedPtr node_clock)</div><div class="ttdef"><b>Definition:</b> <a href="psm__to__external__object__convertor_8cpp_source.html#l00038">psm_to_external_object_convertor.cpp:38</a></div></div>
<div class="ttc" id="anamespacemotion__computation_html"><div class="ttname"><a href="namespacemotion__computation.html">motion_computation</a></div><div class="ttdef"><b>Definition:</b> <a href="mobility__path__to__external__object__helpers_8hpp_source.html#l00028">mobility_path_to_external_object_helpers.hpp:29</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_63e6aad264477fa7f28f31d2fc233dbe.html">motion_computation</a></li><li class="navelem"><a class="el" href="dir_54c025c2a7d69c52f0ce93d682ccc770.html">src</a></li><li class="navelem"><a class="el" href="motion__computation__worker_8cpp.html">motion_computation_worker.cpp</a></li>
    <li class="footer">Generated on Wed Dec 27 2023 20:51:50 for Carma-platform by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4 </li>
  </ul>
</div>
</body>
</html>
