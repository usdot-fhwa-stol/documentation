<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Carma-platform: carma_wm::WMListenerWorker Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Carma-platform<span id="projectnumber">&#160;v4.2.0</span>
   </div>
   <div id="projectbrief">CARMA Platform is built on robot operating system (ROS) and utilizes open source software (OSS) that enables Cooperative Driving Automation (CDA) features to allow Automated Driving Systems to interact and cooperate with infrastructure and other vehicles through communication.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classcarma__wm_1_1WMListenerWorker.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classcarma__wm_1_1WMListenerWorker-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">carma_wm::WMListenerWorker Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Backend logic class for <a class="el" href="classcarma__wm_1_1WMListener.html" title="Class which provies automated subscription and threading support for the world model.">WMListener</a>.  
 <a href="classcarma__wm_1_1WMListenerWorker.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="WMListenerWorker_8hpp_source.html">WMListenerWorker.hpp</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for carma_wm::WMListenerWorker:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm_1_1WMListenerWorker__coll__graph.png" border="0" usemap="#acarma__wm_1_1WMListenerWorker_coll__map" alt="Collaboration graph"/></div>
<map name="acarma__wm_1_1WMListenerWorker_coll__map" id="acarma__wm_1_1WMListenerWorker_coll__map">
<area shape="rect" title="Backend logic class for WMListener." alt="" coords="473,248,680,575"/>
<area shape="rect" title=" " alt="" coords="5,5,164,97"/>
<area shape="rect" href="classbool.html" title=" " alt="" coords="188,13,235,90"/>
<area shape="rect" title=" " alt="" coords="315,13,433,90"/>
<area shape="rect" title=" " alt="" coords="471,13,531,90"/>
<area shape="rect" title=" " alt="" coords="625,13,681,90"/>
<area shape="rect" title=" " alt="" coords="708,5,925,97"/>
<area shape="rect" title=" " alt="" coords="949,5,1119,97"/>
<area shape="rect" title=" " alt="" coords="1155,13,1201,90"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ae5b964291859114c54b1f726d8cdeda2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm_1_1WMListenerWorker.html#ae5b964291859114c54b1f726d8cdeda2">WMListenerWorker</a> ()</td></tr>
<tr class="memdesc:ae5b964291859114c54b1f726d8cdeda2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="classcarma__wm_1_1WMListenerWorker.html#ae5b964291859114c54b1f726d8cdeda2">More...</a><br /></td></tr>
<tr class="separator:ae5b964291859114c54b1f726d8cdeda2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad46406f4874729f47b079b52f4ebb213"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacecarma__wm.html#a3ac653959e0b6198cae274d68b343228">WorldModelConstPtr</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm_1_1WMListenerWorker.html#ad46406f4874729f47b079b52f4ebb213">getWorldModel</a> () const</td></tr>
<tr class="memdesc:ad46406f4874729f47b079b52f4ebb213"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="classcarma__wm_1_1WMListenerWorker.html#ad46406f4874729f47b079b52f4ebb213">More...</a><br /></td></tr>
<tr class="separator:ad46406f4874729f47b079b52f4ebb213"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4490dd5c93ee3ade6e62d5e66dfc3c6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm_1_1WMListenerWorker.html#ad4490dd5c93ee3ade6e62d5e66dfc3c6">mapCallback</a> (const autoware_lanelet2_msgs::msg::MapBin::UniquePtr map_msg)</td></tr>
<tr class="memdesc:ad4490dd5c93ee3ade6e62d5e66dfc3c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback for new map messages. Updates the underlying map.  <a href="classcarma__wm_1_1WMListenerWorker.html#ad4490dd5c93ee3ade6e62d5e66dfc3c6">More...</a><br /></td></tr>
<tr class="separator:ad4490dd5c93ee3ade6e62d5e66dfc3c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e2fb75fe96504aa76691cfecd5dd35f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm_1_1WMListenerWorker.html#a3e2fb75fe96504aa76691cfecd5dd35f">mapUpdateCallback</a> (autoware_lanelet2_msgs::msg::MapBin::UniquePtr geofence_msg)</td></tr>
<tr class="memdesc:a3e2fb75fe96504aa76691cfecd5dd35f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback for new map update messages (geofence). Updates the underlying map.  <a href="classcarma__wm_1_1WMListenerWorker.html#a3e2fb75fe96504aa76691cfecd5dd35f">More...</a><br /></td></tr>
<tr class="separator:a3e2fb75fe96504aa76691cfecd5dd35f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad441355e4885986b80ebf067d8b704c0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm_1_1WMListenerWorker.html#ad441355e4885986b80ebf067d8b704c0">routeCallback</a> (const carma_planning_msgs::msg::Route::UniquePtr route_msg)</td></tr>
<tr class="memdesc:ad441355e4885986b80ebf067d8b704c0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback for route message.  <a href="classcarma__wm_1_1WMListenerWorker.html#ad441355e4885986b80ebf067d8b704c0">More...</a><br /></td></tr>
<tr class="separator:ad441355e4885986b80ebf067d8b704c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38932f2ab0756134602631ebbbd4d2a2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm_1_1WMListenerWorker.html#a38932f2ab0756134602631ebbbd4d2a2">roadwayObjectListCallback</a> (const carma_perception_msgs::msg::RoadwayObstacleList::UniquePtr msg)</td></tr>
<tr class="memdesc:a38932f2ab0756134602631ebbbd4d2a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback for roadway objects msg.  <a href="classcarma__wm_1_1WMListenerWorker.html#a38932f2ab0756134602631ebbbd4d2a2">More...</a><br /></td></tr>
<tr class="separator:a38932f2ab0756134602631ebbbd4d2a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e8ee5810146dbad79df2a2424e8b2d7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm_1_1WMListenerWorker.html#a6e8ee5810146dbad79df2a2424e8b2d7">setMapCallback</a> (std::function&lt; void()&gt; <a class="el" href="helper_8cpp.html#ac0f7f7ec5375e47d4c681359431356b9">callback</a>)</td></tr>
<tr class="memdesc:a6e8ee5810146dbad79df2a2424e8b2d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allows user to set a callback to be triggered when a map update is received.  <a href="classcarma__wm_1_1WMListenerWorker.html#a6e8ee5810146dbad79df2a2424e8b2d7">More...</a><br /></td></tr>
<tr class="separator:a6e8ee5810146dbad79df2a2424e8b2d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a531f3557b64b85c4cd3a068ba7094a2d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm_1_1WMListenerWorker.html#a531f3557b64b85c4cd3a068ba7094a2d">setRouteCallback</a> (std::function&lt; void()&gt; <a class="el" href="helper_8cpp.html#ac0f7f7ec5375e47d4c681359431356b9">callback</a>)</td></tr>
<tr class="memdesc:a531f3557b64b85c4cd3a068ba7094a2d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allows user to set a callback to be triggered when a route update is received.  <a href="classcarma__wm_1_1WMListenerWorker.html#a531f3557b64b85c4cd3a068ba7094a2d">More...</a><br /></td></tr>
<tr class="separator:a531f3557b64b85c4cd3a068ba7094a2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32f22fd00a2f0fff3690d5f0b4ff2eb5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm_1_1WMListenerWorker.html#a32f22fd00a2f0fff3690d5f0b4ff2eb5">setConfigSpeedLimit</a> (double config_lim)</td></tr>
<tr class="memdesc:a32f22fd00a2f0fff3690d5f0b4ff2eb5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allows user to set a callback to be triggered when a map update is received.  <a href="classcarma__wm_1_1WMListenerWorker.html#a32f22fd00a2f0fff3690d5f0b4ff2eb5">More...</a><br /></td></tr>
<tr class="separator:a32f22fd00a2f0fff3690d5f0b4ff2eb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a2d5eac51fade96787fe5056c357afa"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm_1_1WMListenerWorker.html#a4a2d5eac51fade96787fe5056c357afa">getConfigSpeedLimit</a> () const</td></tr>
<tr class="memdesc:a4a2d5eac51fade96787fe5056c357afa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the current configured speed limit value.  <a href="classcarma__wm_1_1WMListenerWorker.html#a4a2d5eac51fade96787fe5056c357afa">More...</a><br /></td></tr>
<tr class="separator:a4a2d5eac51fade96787fe5056c357afa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae84a214a0c12c4ccc3bce45c17a97bf9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm_1_1WMListenerWorker.html#ae84a214a0c12c4ccc3bce45c17a97bf9">setVehicleParticipationType</a> (std::string participant)</td></tr>
<tr class="memdesc:ae84a214a0c12c4ccc3bce45c17a97bf9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allows user to set a callback to be triggered when a map update is received.  <a href="classcarma__wm_1_1WMListenerWorker.html#ae84a214a0c12c4ccc3bce45c17a97bf9">More...</a><br /></td></tr>
<tr class="separator:ae84a214a0c12c4ccc3bce45c17a97bf9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0c115081f19ec29b215e6edeb110d4c"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm_1_1WMListenerWorker.html#ac0c115081f19ec29b215e6edeb110d4c">getVehicleParticipationType</a> () const</td></tr>
<tr class="memdesc:ac0c115081f19ec29b215e6edeb110d4c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the Vehicle Participation Type value.  <a href="classcarma__wm_1_1WMListenerWorker.html#ac0c115081f19ec29b215e6edeb110d4c">More...</a><br /></td></tr>
<tr class="separator:ac0c115081f19ec29b215e6edeb110d4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75d47a05771e1d53c0c8f516e290d4a2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm_1_1WMListenerWorker.html#a75d47a05771e1d53c0c8f516e290d4a2">checkIfReRoutingNeeded</a> () const</td></tr>
<tr class="memdesc:a75d47a05771e1d53c0c8f516e290d4a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if re-routing is needed and returns re-routing flag.  <a href="classcarma__wm_1_1WMListenerWorker.html#a75d47a05771e1d53c0c8f516e290d4a2">More...</a><br /></td></tr>
<tr class="separator:a75d47a05771e1d53c0c8f516e290d4a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c2fcc147efbee76b18ad285f0555d2c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm_1_1WMListenerWorker.html#a4c2fcc147efbee76b18ad285f0555d2c">enableUpdatesWithoutRoute</a> ()</td></tr>
<tr class="memdesc:a4c2fcc147efbee76b18ad285f0555d2c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enable updates without route and set route_node_flag_ as true.  <a href="classcarma__wm_1_1WMListenerWorker.html#a4c2fcc147efbee76b18ad285f0555d2c">More...</a><br /></td></tr>
<tr class="separator:a4c2fcc147efbee76b18ad285f0555d2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a614654b7b374ed1d24537e347d49389f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacecarma__wm.html#a23411d3d299da623ec379efbc1a5b14a">LaneletRoutingGraphPtr</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm_1_1WMListenerWorker.html#a614654b7b374ed1d24537e347d49389f">routingGraphFromMsg</a> (const autoware_lanelet2_msgs::msg::RoutingGraph &amp;msg, lanelet::LaneletMapPtr map) const</td></tr>
<tr class="memdesc:a614654b7b374ed1d24537e347d49389f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper function to convert a routing graph message into a actual RoutingGraph object.  <a href="classcarma__wm_1_1WMListenerWorker.html#a614654b7b374ed1d24537e347d49389f">More...</a><br /></td></tr>
<tr class="separator:a614654b7b374ed1d24537e347d49389f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a361dabf49aae12e4fea515da492a4c5b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm_1_1WMListenerWorker.html#a361dabf49aae12e4fea515da492a4c5b">incomingSpatCallback</a> (const carma_v2x_msgs::msg::SPAT::UniquePtr spat_msg)</td></tr>
<tr class="memdesc:a361dabf49aae12e4fea515da492a4c5b"><td class="mdescLeft">&#160;</td><td class="mdescRight">incoming spat message  <a href="classcarma__wm_1_1WMListenerWorker.html#a361dabf49aae12e4fea515da492a4c5b">More...</a><br /></td></tr>
<tr class="separator:a361dabf49aae12e4fea515da492a4c5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba49ce4302c5629cc030363e0f0d810d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm_1_1WMListenerWorker.html#aba49ce4302c5629cc030363e0f0d810d">isUsingSimTime</a> (<a class="el" href="classbool.html">bool</a> use_sim_time)</td></tr>
<tr class="memdesc:aba49ce4302c5629cc030363e0f0d810d"><td class="mdescLeft">&#160;</td><td class="mdescRight">set true if simulation_mode is on  <a href="classcarma__wm_1_1WMListenerWorker.html#aba49ce4302c5629cc030363e0f0d810d">More...</a><br /></td></tr>
<tr class="separator:aba49ce4302c5629cc030363e0f0d810d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-methods" name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a5cffb02708d8e8421ad56c4e7dd21b81"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm_1_1WMListenerWorker.html#a5cffb02708d8e8421ad56c4e7dd21b81">newRegemUpdateHelper</a> (lanelet::Lanelet parent_llt, lanelet::RegulatoryElement *regem) const</td></tr>
<tr class="memdesc:a5cffb02708d8e8421ad56c4e7dd21b81"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is a helper function updates the parent_llt with specified regem. This function is needed as we need to dynamic_cast from general regem to specific type of regem based on the geofence.  <a href="classcarma__wm_1_1WMListenerWorker.html#a5cffb02708d8e8421ad56c4e7dd21b81">More...</a><br /></td></tr>
<tr class="separator:a5cffb02708d8e8421ad56c4e7dd21b81"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a4ea1ac169b8ba4a72dd72b4e8723257e"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="classcarma__wm_1_1CARMAWorldModel.html">CARMAWorldModel</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm_1_1WMListenerWorker.html#a4ea1ac169b8ba4a72dd72b4e8723257e">world_model_</a></td></tr>
<tr class="separator:a4ea1ac169b8ba4a72dd72b4e8723257e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acab7ad4d3841c78cf96da2deec5c751b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm_1_1WMListenerWorker.html#acab7ad4d3841c78cf96da2deec5c751b">use_sim_time_</a></td></tr>
<tr class="separator:acab7ad4d3841c78cf96da2deec5c751b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c2e638e8fdc934482ba9076a5ca7bb5"><td class="memItemLeft" align="right" valign="top">std::function&lt; void()&gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm_1_1WMListenerWorker.html#a3c2e638e8fdc934482ba9076a5ca7bb5">map_callback_</a></td></tr>
<tr class="separator:a3c2e638e8fdc934482ba9076a5ca7bb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a81ac013a5e920b47e6c12d338446cc"><td class="memItemLeft" align="right" valign="top">std::function&lt; void()&gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm_1_1WMListenerWorker.html#a8a81ac013a5e920b47e6c12d338446cc">route_callback_</a></td></tr>
<tr class="separator:a8a81ac013a5e920b47e6c12d338446cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84466a412323d469f5a53bbd9fbcaf6d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm_1_1WMListenerWorker.html#a84466a412323d469f5a53bbd9fbcaf6d">config_speed_limit_</a></td></tr>
<tr class="separator:a84466a412323d469f5a53bbd9fbcaf6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae0b14b4566a06ba1c99e46e79de0fba"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm_1_1WMListenerWorker.html#aae0b14b4566a06ba1c99e46e79de0fba">current_map_version_</a> = 0</td></tr>
<tr class="separator:aae0b14b4566a06ba1c99e46e79de0fba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f06d6bbeae107d1f91bbf2cad94288f"><td class="memItemLeft" align="right" valign="top">std::queue&lt; autoware_lanelet2_msgs::msg::MapBin::UniquePtr &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm_1_1WMListenerWorker.html#a7f06d6bbeae107d1f91bbf2cad94288f">map_update_queue_</a></td></tr>
<tr class="separator:a7f06d6bbeae107d1f91bbf2cad94288f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a295aefa7073627e0c645ab19ec123a73"><td class="memItemLeft" align="right" valign="top">boost::optional&lt; carma_planning_msgs::msg::Route &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm_1_1WMListenerWorker.html#a295aefa7073627e0c645ab19ec123a73">delayed_route_msg_</a></td></tr>
<tr class="separator:a295aefa7073627e0c645ab19ec123a73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acae1ff63ff0f396de4e3f1bb9ab492bb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm_1_1WMListenerWorker.html#acae1ff63ff0f396de4e3f1bb9ab492bb">recompute_route_flag_</a> =false</td></tr>
<tr class="separator:acae1ff63ff0f396de4e3f1bb9ab492bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a310d6ebc20c42f055541025291337b57"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm_1_1WMListenerWorker.html#a310d6ebc20c42f055541025291337b57">rerouting_flag_</a> =false</td></tr>
<tr class="separator:a310d6ebc20c42f055541025291337b57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39cbf05af713a84fb396c36da3551df5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm_1_1WMListenerWorker.html#a39cbf05af713a84fb396c36da3551df5">route_node_flag_</a> =false</td></tr>
<tr class="separator:a39cbf05af713a84fb396c36da3551df5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae838d10e2677708b7b86c13fbb62d452"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm_1_1WMListenerWorker.html#ae838d10e2677708b7b86c13fbb62d452">most_recent_update_msg_seq_</a> = -1</td></tr>
<tr class="separator:ae838d10e2677708b7b86c13fbb62d452"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Backend logic class for <a class="el" href="classcarma__wm_1_1WMListener.html" title="Class which provies automated subscription and threading support for the world model.">WMListener</a>. </p>

<p class="definition">Definition at line <a class="el" href="WMListenerWorker_8hpp_source.html#l00033">33</a> of file <a class="el" href="WMListenerWorker_8hpp_source.html">WMListenerWorker.hpp</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ae5b964291859114c54b1f726d8cdeda2" name="ae5b964291859114c54b1f726d8cdeda2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5b964291859114c54b1f726d8cdeda2">&#9670;&nbsp;</a></span>WMListenerWorker()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">carma_wm::WMListenerWorker::WMListenerWorker </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>

<p class="definition">Definition at line <a class="el" href="WMListenerWorker_8cpp_source.html#l00045">45</a> of file <a class="el" href="WMListenerWorker_8cpp_source.html">WMListenerWorker.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   46</span>{</div>
<div class="line"><span class="lineno">   47</span>  <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a4ea1ac169b8ba4a72dd72b4e8723257e">world_model_</a>.reset(<span class="keyword">new</span> CARMAWorldModel);</div>
<div class="line"><span class="lineno">   48</span>}</div>
<div class="ttc" id="aclasscarma__wm_1_1WMListenerWorker_html_a4ea1ac169b8ba4a72dd72b4e8723257e"><div class="ttname"><a href="classcarma__wm_1_1WMListenerWorker.html#a4ea1ac169b8ba4a72dd72b4e8723257e">carma_wm::WMListenerWorker::world_model_</a></div><div class="ttdeci">std::shared_ptr&lt; CARMAWorldModel &gt; world_model_</div><div class="ttdef"><b>Definition:</b> <a href="WMListenerWorker_8hpp_source.html#l00145">WMListenerWorker.hpp:145</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMListenerWorker_8hpp_source.html#l00145">world_model_</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a75d47a05771e1d53c0c8f516e290d4a2" name="a75d47a05771e1d53c0c8f516e290d4a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75d47a05771e1d53c0c8f516e290d4a2">&#9670;&nbsp;</a></span>checkIfReRoutingNeeded()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> carma_wm::WMListenerWorker::checkIfReRoutingNeeded </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if re-routing is needed and returns re-routing flag. </p>

<p class="definition">Definition at line <a class="el" href="WMListenerWorker_8cpp_source.html#l00109">109</a> of file <a class="el" href="WMListenerWorker_8cpp_source.html">WMListenerWorker.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  110</span>{</div>
<div class="line"><span class="lineno">  111</span>  <span class="keywordflow">return</span> <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a310d6ebc20c42f055541025291337b57">rerouting_flag_</a>;</div>
<div class="line"><span class="lineno">  112</span>}</div>
<div class="ttc" id="aclasscarma__wm_1_1WMListenerWorker_html_a310d6ebc20c42f055541025291337b57"><div class="ttname"><a href="classcarma__wm_1_1WMListenerWorker.html#a310d6ebc20c42f055541025291337b57">carma_wm::WMListenerWorker::rerouting_flag_</a></div><div class="ttdeci">bool rerouting_flag_</div><div class="ttdef"><b>Definition:</b> <a href="WMListenerWorker_8hpp_source.html#l00157">WMListenerWorker.hpp:157</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMListenerWorker_8hpp_source.html#l00157">rerouting_flag_</a>.</p>

</div>
</div>
<a id="a4c2fcc147efbee76b18ad285f0555d2c" name="a4c2fcc147efbee76b18ad285f0555d2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c2fcc147efbee76b18ad285f0555d2c">&#9670;&nbsp;</a></span>enableUpdatesWithoutRoute()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void carma_wm::WMListenerWorker::enableUpdatesWithoutRoute </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enable updates without route and set route_node_flag_ as true. </p>

<p class="definition">Definition at line <a class="el" href="WMListenerWorker_8cpp_source.html#l00114">114</a> of file <a class="el" href="WMListenerWorker_8cpp_source.html">WMListenerWorker.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  115</span>{</div>
<div class="line"><span class="lineno">  116</span>  <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a39cbf05af713a84fb396c36da3551df5">route_node_flag_</a>=<span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  117</span>}</div>
<div class="ttc" id="aclasscarma__wm_1_1WMListenerWorker_html_a39cbf05af713a84fb396c36da3551df5"><div class="ttname"><a href="classcarma__wm_1_1WMListenerWorker.html#a39cbf05af713a84fb396c36da3551df5">carma_wm::WMListenerWorker::route_node_flag_</a></div><div class="ttdeci">bool route_node_flag_</div><div class="ttdef"><b>Definition:</b> <a href="WMListenerWorker_8hpp_source.html#l00158">WMListenerWorker.hpp:158</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMListenerWorker_8hpp_source.html#l00158">route_node_flag_</a>.</p>

</div>
</div>
<a id="a4a2d5eac51fade96787fe5056c357afa" name="a4a2d5eac51fade96787fe5056c357afa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a2d5eac51fade96787fe5056c357afa">&#9670;&nbsp;</a></span>getConfigSpeedLimit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double carma_wm::WMListenerWorker::getConfigSpeedLimit </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the current configured speed limit value. </p>

<p class="definition">Definition at line <a class="el" href="WMListenerWorker_8cpp_source.html#l00698">698</a> of file <a class="el" href="WMListenerWorker_8cpp_source.html">WMListenerWorker.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  699</span>{</div>
<div class="line"><span class="lineno">  700</span>  <span class="keywordflow">return</span> <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a84466a412323d469f5a53bbd9fbcaf6d">config_speed_limit_</a>;</div>
<div class="line"><span class="lineno">  701</span>}</div>
<div class="ttc" id="aclasscarma__wm_1_1WMListenerWorker_html_a84466a412323d469f5a53bbd9fbcaf6d"><div class="ttname"><a href="classcarma__wm_1_1WMListenerWorker.html#a84466a412323d469f5a53bbd9fbcaf6d">carma_wm::WMListenerWorker::config_speed_limit_</a></div><div class="ttdeci">double config_speed_limit_</div><div class="ttdef"><b>Definition:</b> <a href="WMListenerWorker_8hpp_source.html#l00150">WMListenerWorker.hpp:150</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMListenerWorker_8hpp_source.html#l00150">config_speed_limit_</a>.</p>

</div>
</div>
<a id="ac0c115081f19ec29b215e6edeb110d4c" name="ac0c115081f19ec29b215e6edeb110d4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0c115081f19ec29b215e6edeb110d4c">&#9670;&nbsp;</a></span>getVehicleParticipationType()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string carma_wm::WMListenerWorker::getVehicleParticipationType </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the Vehicle Participation Type value. </p>

<p class="definition">Definition at line <a class="el" href="WMListenerWorker_8cpp_source.html#l00567">567</a> of file <a class="el" href="WMListenerWorker_8cpp_source.html">WMListenerWorker.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  568</span>{</div>
<div class="line"><span class="lineno">  569</span>  <span class="keywordflow">return</span> <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a4ea1ac169b8ba4a72dd72b4e8723257e">world_model_</a>-&gt;getVehicleParticipationType();</div>
<div class="line"><span class="lineno">  570</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMListenerWorker_8hpp_source.html#l00145">world_model_</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMListenerWorker_8cpp_source.html#l00448">routingGraphFromMsg()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm_1_1WMListenerWorker_ac0c115081f19ec29b215e6edeb110d4c_icgraph.png" border="0" usemap="#aclasscarma__wm_1_1WMListenerWorker_ac0c115081f19ec29b215e6edeb110d4c_icgraph" alt=""/></div>
<map name="aclasscarma__wm_1_1WMListenerWorker_ac0c115081f19ec29b215e6edeb110d4c_icgraph" id="aclasscarma__wm_1_1WMListenerWorker_ac0c115081f19ec29b215e6edeb110d4c_icgraph">
<area shape="rect" title="Returns the Vehicle Participation Type value." alt="" coords="1219,35,1421,76"/>
<area shape="rect" href="classcarma__wm_1_1WMListenerWorker.html#a614654b7b374ed1d24537e347d49389f" title="Helper function to convert a routing graph message into a actual RoutingGraph object." alt="" coords="968,35,1171,76"/>
<area shape="rect" href="classcarma__wm_1_1WMListenerWorker.html#a3e2fb75fe96504aa76691cfecd5dd35f" title="Callback for new map update messages (geofence). Updates the underlying map." alt="" coords="717,35,920,76"/>
<area shape="rect" href="classcarma__wm_1_1WMListenerWorker.html#ad4490dd5c93ee3ade6e62d5e66dfc3c6" title="Callback for new map messages. Updates the underlying map." alt="" coords="216,5,419,47"/>
<area shape="rect" href="classcarma__wm_1_1WMListenerWorker.html#ad441355e4885986b80ebf067d8b704c0" title="Callback for route message." alt="" coords="467,64,669,105"/>
<area shape="rect" href="classcarma__wm_1_1WMListener.html#ae8f498999a2d8365543b153d7b536e38" title="Constructor which can be used to specify threading behavior of this class." alt="" coords="5,35,168,76"/>
</map>
</div>

</div>
</div>
<a id="ad46406f4874729f47b079b52f4ebb213" name="ad46406f4874729f47b079b52f4ebb213"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad46406f4874729f47b079b52f4ebb213">&#9670;&nbsp;</a></span>getWorldModel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacecarma__wm.html#a3ac653959e0b6198cae274d68b343228">WorldModelConstPtr</a> carma_wm::WMListenerWorker::getWorldModel </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>

<p class="definition">Definition at line <a class="el" href="WMListenerWorker_8cpp_source.html#l00050">50</a> of file <a class="el" href="WMListenerWorker_8cpp_source.html">WMListenerWorker.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   51</span>{</div>
<div class="line"><span class="lineno">   52</span>  <span class="keywordflow">return</span> std::static_pointer_cast&lt;const WorldModel&gt;(<a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a4ea1ac169b8ba4a72dd72b4e8723257e">world_model_</a>);  <span class="comment">// Cast pointer to const variant</span></div>
<div class="line"><span class="lineno">   53</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMListenerWorker_8hpp_source.html#l00145">world_model_</a>.</p>

</div>
</div>
<a id="a361dabf49aae12e4fea515da492a4c5b" name="a361dabf49aae12e4fea515da492a4c5b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a361dabf49aae12e4fea515da492a4c5b">&#9670;&nbsp;</a></span>incomingSpatCallback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void carma_wm::WMListenerWorker::incomingSpatCallback </td>
          <td>(</td>
          <td class="paramtype">const carma_v2x_msgs::msg::SPAT::UniquePtr&#160;</td>
          <td class="paramname"><em>spat_msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>incoming spat message </p>

<p class="definition">Definition at line <a class="el" href="WMListenerWorker_8cpp_source.html#l00104">104</a> of file <a class="el" href="WMListenerWorker_8cpp_source.html">WMListenerWorker.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  105</span>{</div>
<div class="line"><span class="lineno">  106</span>  <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a4ea1ac169b8ba4a72dd72b4e8723257e">world_model_</a>-&gt;processSpatFromMsg(*spat_msg, <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#acab7ad4d3841c78cf96da2deec5c751b">use_sim_time_</a>);</div>
<div class="line"><span class="lineno">  107</span>}</div>
<div class="ttc" id="aclasscarma__wm_1_1WMListenerWorker_html_acab7ad4d3841c78cf96da2deec5c751b"><div class="ttname"><a href="classcarma__wm_1_1WMListenerWorker.html#acab7ad4d3841c78cf96da2deec5c751b">carma_wm::WMListenerWorker::use_sim_time_</a></div><div class="ttdeci">bool use_sim_time_</div><div class="ttdef"><b>Definition:</b> <a href="WMListenerWorker_8hpp_source.html#l00146">WMListenerWorker.hpp:146</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMListenerWorker_8hpp_source.html#l00146">use_sim_time_</a>, and <a class="el" href="WMListenerWorker_8hpp_source.html#l00145">world_model_</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMListener_8cpp_source.html#l00025">carma_wm::WMListener::WMListener()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm_1_1WMListenerWorker_a361dabf49aae12e4fea515da492a4c5b_icgraph.png" border="0" usemap="#aclasscarma__wm_1_1WMListenerWorker_a361dabf49aae12e4fea515da492a4c5b_icgraph" alt=""/></div>
<map name="aclasscarma__wm_1_1WMListenerWorker_a361dabf49aae12e4fea515da492a4c5b_icgraph" id="aclasscarma__wm_1_1WMListenerWorker_a361dabf49aae12e4fea515da492a4c5b_icgraph">
<area shape="rect" title="incoming spat message" alt="" coords="216,5,419,47"/>
<area shape="rect" href="classcarma__wm_1_1WMListener.html#ae8f498999a2d8365543b153d7b536e38" title="Constructor which can be used to specify threading behavior of this class." alt="" coords="5,5,168,47"/>
</map>
</div>

</div>
</div>
<a id="aba49ce4302c5629cc030363e0f0d810d" name="aba49ce4302c5629cc030363e0f0d810d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba49ce4302c5629cc030363e0f0d810d">&#9670;&nbsp;</a></span>isUsingSimTime()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void carma_wm::WMListenerWorker::isUsingSimTime </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>use_sim_time</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>set true if simulation_mode is on </p>

<p class="definition">Definition at line <a class="el" href="WMListenerWorker_8cpp_source.html#l00693">693</a> of file <a class="el" href="WMListenerWorker_8cpp_source.html">WMListenerWorker.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  694</span>{</div>
<div class="line"><span class="lineno">  695</span>  <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#acab7ad4d3841c78cf96da2deec5c751b">use_sim_time_</a> = use_sim_time;</div>
<div class="line"><span class="lineno">  696</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMListenerWorker_8hpp_source.html#l00146">use_sim_time_</a>.</p>

</div>
</div>
<a id="ad4490dd5c93ee3ade6e62d5e66dfc3c6" name="ad4490dd5c93ee3ade6e62d5e66dfc3c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4490dd5c93ee3ade6e62d5e66dfc3c6">&#9670;&nbsp;</a></span>mapCallback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void carma_wm::WMListenerWorker::mapCallback </td>
          <td>(</td>
          <td class="paramtype">const autoware_lanelet2_msgs::msg::MapBin::UniquePtr&#160;</td>
          <td class="paramname"><em>map_msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Callback for new map messages. Updates the underlying map. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">map_msg</td><td>The new map messages to generate the map from </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="WMListenerWorker_8cpp_source.html#l00056">56</a> of file <a class="el" href="WMListenerWorker_8cpp_source.html">WMListenerWorker.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   57</span>{</div>
<div class="line"><span class="lineno">   58</span>  <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#aae0b14b4566a06ba1c99e46e79de0fba">current_map_version_</a> = map_msg-&gt;map_version;</div>
<div class="line"><span class="lineno">   59</span> </div>
<div class="line"><span class="lineno">   60</span>  lanelet::LaneletMapPtr new_map(<span class="keyword">new</span> lanelet::LaneletMap);</div>
<div class="line"><span class="lineno">   61</span> </div>
<div class="line"><span class="lineno">   62</span>  <a class="code hl_function" href="namespacecarma__wm.html#a3c6c82d3e0fcfc7dd50176a453598911">lanelet::utils::conversion::fromBinMsg</a>(*map_msg, new_map);</div>
<div class="line"><span class="lineno">   63</span> </div>
<div class="line"><span class="lineno">   64</span>  <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a4ea1ac169b8ba4a72dd72b4e8723257e">world_model_</a>-&gt;setMap(new_map, <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#aae0b14b4566a06ba1c99e46e79de0fba">current_map_version_</a>);</div>
<div class="line"><span class="lineno">   65</span> </div>
<div class="line"><span class="lineno">   66</span>  <span class="comment">// After setting map evaluate the current update queue to apply any updates that arrived before the map</span></div>
<div class="line"><span class="lineno">   67</span>  <span class="keywordtype">bool</span> more_updates_to_apply = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">   68</span>  <span class="keywordflow">while</span>(!<a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a7f06d6bbeae107d1f91bbf2cad94288f">map_update_queue_</a>.empty() &amp;&amp; more_updates_to_apply) {</div>
<div class="line"><span class="lineno">   69</span>    </div>
<div class="line"><span class="lineno">   70</span>    <span class="keyword">auto</span> update = std::move(<a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a7f06d6bbeae107d1f91bbf2cad94288f">map_update_queue_</a>.front()); <span class="comment">// Get first update</span></div>
<div class="line"><span class="lineno">   71</span>    <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a7f06d6bbeae107d1f91bbf2cad94288f">map_update_queue_</a>.pop(); <span class="comment">// Remove update from queue</span></div>
<div class="line"><span class="lineno">   72</span> </div>
<div class="line"><span class="lineno">   73</span>    <span class="keywordflow">if</span> (update-&gt;map_version &lt; <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#aae0b14b4566a06ba1c99e46e79de0fba">current_map_version_</a>) { <span class="comment">// Drop any so far unapplied updates for the previous map</span></div>
<div class="line"><span class="lineno">   74</span>      RCLCPP_WARN_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm::WMListenerWorker&quot;</span>), <span class="stringliteral">&quot;There were unapplied updates in carma_wm when a new map was received.&quot;</span>);</div>
<div class="line"><span class="lineno">   75</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">   76</span>    }</div>
<div class="line"><span class="lineno">   77</span>    <span class="keywordflow">if</span> (update-&gt;map_version == <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#aae0b14b4566a06ba1c99e46e79de0fba">current_map_version_</a>) { <span class="comment">// Current update goes with current map</span></div>
<div class="line"><span class="lineno">   78</span>      <a class="code hl_function" href="classcarma__wm_1_1WMListenerWorker.html#a3e2fb75fe96504aa76691cfecd5dd35f">mapUpdateCallback</a>(std::move(update)); <span class="comment">// Apply the update</span></div>
<div class="line"><span class="lineno">   79</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">   80</span>      RCLCPP_INFO_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm::WMListenerWorker&quot;</span>), <span class="stringliteral">&quot;Done applying updates for new map. However, more updates are waiting for a future map.&quot;</span>);</div>
<div class="line"><span class="lineno">   81</span>      more_updates_to_apply = <span class="keyword">false</span>; <span class="comment">// If there is more updates queued that are not for this map version assume they are for a future map version</span></div>
<div class="line"><span class="lineno">   82</span>    }</div>
<div class="line"><span class="lineno">   83</span> </div>
<div class="line"><span class="lineno">   84</span>  }</div>
<div class="line"><span class="lineno">   85</span> </div>
<div class="line"><span class="lineno">   86</span>  <span class="comment">// Call user defined map callback</span></div>
<div class="line"><span class="lineno">   87</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a3c2e638e8fdc934482ba9076a5ca7bb5">map_callback_</a>)</div>
<div class="line"><span class="lineno">   88</span>  {</div>
<div class="line"><span class="lineno">   89</span>    <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a3c2e638e8fdc934482ba9076a5ca7bb5">map_callback_</a>();</div>
<div class="line"><span class="lineno">   90</span>  }</div>
<div class="line"><span class="lineno">   91</span> </div>
<div class="line"><span class="lineno">   92</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a295aefa7073627e0c645ab19ec123a73">delayed_route_msg_</a>) {</div>
<div class="line"><span class="lineno">   93</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a295aefa7073627e0c645ab19ec123a73">delayed_route_msg_</a>.get().map_version == <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#aae0b14b4566a06ba1c99e46e79de0fba">current_map_version_</a>) { <span class="comment">// If there is a delayed route message to apply then do so</span></div>
<div class="line"><span class="lineno">   94</span>      <a class="code hl_function" href="classcarma__wm_1_1WMListenerWorker.html#ad441355e4885986b80ebf067d8b704c0">routeCallback</a>(std::make_unique&lt;carma_planning_msgs::msg::Route&gt;(<a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a295aefa7073627e0c645ab19ec123a73">delayed_route_msg_</a>.get()));</div>
<div class="line"><span class="lineno">   95</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a295aefa7073627e0c645ab19ec123a73">delayed_route_msg_</a>.get().map_version &lt; <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#aae0b14b4566a06ba1c99e46e79de0fba">current_map_version_</a>) {</div>
<div class="line"><span class="lineno">   96</span>      RCLCPP_WARN_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm::WMListenerWorker&quot;</span>), <span class="stringliteral">&quot;Dropping delayed route message which was never applied as updated map was not recieved&quot;</span>);</div>
<div class="line"><span class="lineno">   97</span>      <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a295aefa7073627e0c645ab19ec123a73">delayed_route_msg_</a> = boost::none;</div>
<div class="line"><span class="lineno">   98</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">   99</span>      RCLCPP_INFO_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm::WMListenerWorker&quot;</span>), <span class="stringliteral">&quot;There is a delayed route message still waiting to be applied in carma_wm&quot;</span>);</div>
<div class="line"><span class="lineno">  100</span>    }</div>
<div class="line"><span class="lineno">  101</span>  }</div>
<div class="line"><span class="lineno">  102</span>}</div>
<div class="ttc" id="aclasscarma__wm_1_1WMListenerWorker_html_a295aefa7073627e0c645ab19ec123a73"><div class="ttname"><a href="classcarma__wm_1_1WMListenerWorker.html#a295aefa7073627e0c645ab19ec123a73">carma_wm::WMListenerWorker::delayed_route_msg_</a></div><div class="ttdeci">boost::optional&lt; carma_planning_msgs::msg::Route &gt; delayed_route_msg_</div><div class="ttdef"><b>Definition:</b> <a href="WMListenerWorker_8hpp_source.html#l00154">WMListenerWorker.hpp:154</a></div></div>
<div class="ttc" id="aclasscarma__wm_1_1WMListenerWorker_html_a3c2e638e8fdc934482ba9076a5ca7bb5"><div class="ttname"><a href="classcarma__wm_1_1WMListenerWorker.html#a3c2e638e8fdc934482ba9076a5ca7bb5">carma_wm::WMListenerWorker::map_callback_</a></div><div class="ttdeci">std::function&lt; void()&gt; map_callback_</div><div class="ttdef"><b>Definition:</b> <a href="WMListenerWorker_8hpp_source.html#l00147">WMListenerWorker.hpp:147</a></div></div>
<div class="ttc" id="aclasscarma__wm_1_1WMListenerWorker_html_a3e2fb75fe96504aa76691cfecd5dd35f"><div class="ttname"><a href="classcarma__wm_1_1WMListenerWorker.html#a3e2fb75fe96504aa76691cfecd5dd35f">carma_wm::WMListenerWorker::mapUpdateCallback</a></div><div class="ttdeci">void mapUpdateCallback(autoware_lanelet2_msgs::msg::MapBin::UniquePtr geofence_msg)</div><div class="ttdoc">Callback for new map update messages (geofence). Updates the underlying map.</div><div class="ttdef"><b>Definition:</b> <a href="WMListenerWorker_8cpp_source.html#l00146">WMListenerWorker.cpp:146</a></div></div>
<div class="ttc" id="aclasscarma__wm_1_1WMListenerWorker_html_a7f06d6bbeae107d1f91bbf2cad94288f"><div class="ttname"><a href="classcarma__wm_1_1WMListenerWorker.html#a7f06d6bbeae107d1f91bbf2cad94288f">carma_wm::WMListenerWorker::map_update_queue_</a></div><div class="ttdeci">std::queue&lt; autoware_lanelet2_msgs::msg::MapBin::UniquePtr &gt; map_update_queue_</div><div class="ttdef"><b>Definition:</b> <a href="WMListenerWorker_8hpp_source.html#l00153">WMListenerWorker.hpp:153</a></div></div>
<div class="ttc" id="aclasscarma__wm_1_1WMListenerWorker_html_aae0b14b4566a06ba1c99e46e79de0fba"><div class="ttname"><a href="classcarma__wm_1_1WMListenerWorker.html#aae0b14b4566a06ba1c99e46e79de0fba">carma_wm::WMListenerWorker::current_map_version_</a></div><div class="ttdeci">size_t current_map_version_</div><div class="ttdef"><b>Definition:</b> <a href="WMListenerWorker_8hpp_source.html#l00152">WMListenerWorker.hpp:152</a></div></div>
<div class="ttc" id="aclasscarma__wm_1_1WMListenerWorker_html_ad441355e4885986b80ebf067d8b704c0"><div class="ttname"><a href="classcarma__wm_1_1WMListenerWorker.html#ad441355e4885986b80ebf067d8b704c0">carma_wm::WMListenerWorker::routeCallback</a></div><div class="ttdeci">void routeCallback(const carma_planning_msgs::msg::Route::UniquePtr route_msg)</div><div class="ttdoc">Callback for route message.</div><div class="ttdef"><b>Definition:</b> <a href="WMListenerWorker_8cpp_source.html#l00578">WMListenerWorker.cpp:578</a></div></div>
<div class="ttc" id="anamespacecarma__wm_html_a3c6c82d3e0fcfc7dd50176a453598911"><div class="ttname"><a href="namespacecarma__wm.html#a3c6c82d3e0fcfc7dd50176a453598911">carma_wm::fromBinMsg</a></div><div class="ttdeci">void fromBinMsg(const autoware_lanelet2_msgs::msg::MapBin &amp;msg, std::shared_ptr&lt; carma_wm::TrafficControl &gt; gf_ptr, lanelet::LaneletMapPtr lanelet_map=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="TrafficControl_8cpp_source.html#l00040">TrafficControl.cpp:40</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMListenerWorker_8hpp_source.html#l00152">current_map_version_</a>, <a class="el" href="WMListenerWorker_8hpp_source.html#l00154">delayed_route_msg_</a>, <a class="el" href="TrafficControl_8cpp_source.html#l00040">carma_wm::fromBinMsg()</a>, <a class="el" href="WMListenerWorker_8hpp_source.html#l00147">map_callback_</a>, <a class="el" href="WMListenerWorker_8hpp_source.html#l00153">map_update_queue_</a>, <a class="el" href="WMListenerWorker_8cpp_source.html#l00146">mapUpdateCallback()</a>, <a class="el" href="WMListenerWorker_8cpp_source.html#l00578">routeCallback()</a>, and <a class="el" href="WMListenerWorker_8hpp_source.html#l00145">world_model_</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMListener_8cpp_source.html#l00025">carma_wm::WMListener::WMListener()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm_1_1WMListenerWorker_ad4490dd5c93ee3ade6e62d5e66dfc3c6_cgraph.png" border="0" usemap="#aclasscarma__wm_1_1WMListenerWorker_ad4490dd5c93ee3ade6e62d5e66dfc3c6_cgraph" alt=""/></div>
<map name="aclasscarma__wm_1_1WMListenerWorker_ad4490dd5c93ee3ade6e62d5e66dfc3c6_cgraph" id="aclasscarma__wm_1_1WMListenerWorker_ad4490dd5c93ee3ade6e62d5e66dfc3c6_cgraph">
<area shape="rect" title="Callback for new map messages. Updates the underlying map." alt="" coords="5,49,208,90"/>
<area shape="rect" href="namespacecarma__wm.html#a3c6c82d3e0fcfc7dd50176a453598911" title=" " alt="" coords="794,5,957,32"/>
<area shape="rect" href="classcarma__wm_1_1WMListenerWorker.html#a3e2fb75fe96504aa76691cfecd5dd35f" title="Callback for new map update messages (geofence). Updates the underlying map." alt="" coords="507,82,709,123"/>
<area shape="rect" href="classcarma__wm_1_1WMListenerWorker.html#ad441355e4885986b80ebf067d8b704c0" title="Callback for route message." alt="" coords="256,107,459,149"/>
<area shape="rect" href="namespacecarma__wm.html#aae8a9e16b161a8edf05ca9df4307a5ec" title=" " alt="" coords="757,57,993,98"/>
<area shape="rect" href="classcarma__wm_1_1WMListenerWorker.html#a5cffb02708d8e8421ad56c4e7dd21b81" title="This is a helper function updates the parent_llt with specified regem. This function is needed as we ..." alt="" coords="774,122,977,163"/>
<area shape="rect" href="classcarma__wm_1_1WMListenerWorker.html#a614654b7b374ed1d24537e347d49389f" title="Helper function to convert a routing graph message into a actual RoutingGraph object." alt="" coords="774,187,977,229"/>
<area shape="rect" href="namespacecarma__wm.html#a4c3b7aaa05aea0c95189c98c5d902cf8" title=" " alt="" coords="1041,129,1260,156"/>
<area shape="rect" href="classcarma__wm_1_1WMListenerWorker.html#ac0c115081f19ec29b215e6edeb110d4c" title="Returns the Vehicle Participation Type value." alt="" coords="1049,187,1252,229"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm_1_1WMListenerWorker_ad4490dd5c93ee3ade6e62d5e66dfc3c6_icgraph.png" border="0" usemap="#aclasscarma__wm_1_1WMListenerWorker_ad4490dd5c93ee3ade6e62d5e66dfc3c6_icgraph" alt=""/></div>
<map name="aclasscarma__wm_1_1WMListenerWorker_ad4490dd5c93ee3ade6e62d5e66dfc3c6_icgraph" id="aclasscarma__wm_1_1WMListenerWorker_ad4490dd5c93ee3ade6e62d5e66dfc3c6_icgraph">
<area shape="rect" title="Callback for new map messages. Updates the underlying map." alt="" coords="216,5,419,47"/>
<area shape="rect" href="classcarma__wm_1_1WMListener.html#ae8f498999a2d8365543b153d7b536e38" title="Constructor which can be used to specify threading behavior of this class." alt="" coords="5,5,168,47"/>
</map>
</div>

</div>
</div>
<a id="a3e2fb75fe96504aa76691cfecd5dd35f" name="a3e2fb75fe96504aa76691cfecd5dd35f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e2fb75fe96504aa76691cfecd5dd35f">&#9670;&nbsp;</a></span>mapUpdateCallback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void carma_wm::WMListenerWorker::mapUpdateCallback </td>
          <td>(</td>
          <td class="paramtype">autoware_lanelet2_msgs::msg::MapBin::UniquePtr&#160;</td>
          <td class="paramname"><em>geofence_msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Callback for new map update messages (geofence). Updates the underlying map. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">geofence_msg</td><td>The new map update messages to generate the map edits from </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="WMListenerWorker_8cpp_source.html#l00146">146</a> of file <a class="el" href="WMListenerWorker_8cpp_source.html">WMListenerWorker.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  147</span>{</div>
<div class="line"><span class="lineno">  148</span>  RCLCPP_INFO_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm::WMListenerWorker&quot;</span>), <span class="stringliteral">&quot;Map Update Being Evaluated. SeqNum: &quot;</span> &lt;&lt; geofence_msg-&gt;seq_id);</div>
<div class="line"><span class="lineno">  149</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a310d6ebc20c42f055541025291337b57">rerouting_flag_</a>) <span class="comment">// no update should be applied if rerouting </span></div>
<div class="line"><span class="lineno">  150</span>  {</div>
<div class="line"><span class="lineno">  151</span>    RCLCPP_INFO_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm::WMListenerWorker&quot;</span>), <span class="stringliteral">&quot;Currently new route is being processed. Queueing this update. Received seq: &quot;</span> &lt;&lt; geofence_msg-&gt;seq_id &lt;&lt; <span class="stringliteral">&quot; prev seq: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#ae838d10e2677708b7b86c13fbb62d452">most_recent_update_msg_seq_</a>);</div>
<div class="line"><span class="lineno">  152</span>    <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a7f06d6bbeae107d1f91bbf2cad94288f">map_update_queue_</a>.emplace(std::move(geofence_msg));</div>
<div class="line"><span class="lineno">  153</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  154</span>  }</div>
<div class="line"><span class="lineno">  155</span>  <span class="keywordflow">if</span> (geofence_msg-&gt;seq_id &lt;= <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#ae838d10e2677708b7b86c13fbb62d452">most_recent_update_msg_seq_</a>) {</div>
<div class="line"><span class="lineno">  156</span>    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm::WMListenerWorker&quot;</span>), <span class="stringliteral">&quot;Dropping map update which has already been processed. Received seq: &quot;</span> &lt;&lt; geofence_msg-&gt;seq_id &lt;&lt; <span class="stringliteral">&quot; prev seq: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#ae838d10e2677708b7b86c13fbb62d452">most_recent_update_msg_seq_</a>);</div>
<div class="line"><span class="lineno">  157</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  158</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!<a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a4ea1ac169b8ba4a72dd72b4e8723257e">world_model_</a>-&gt;getMap() || current_map_version_ &lt; geofence_msg-&gt;map_version) { <span class="comment">// If our current map version is older than the version target by this update</span></div>
<div class="line"><span class="lineno">  159</span>    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm::WMListenerWorker&quot;</span>), <span class="stringliteral">&quot;Update received for newer map version than available. Queueing update until map is available.&quot;</span>);</div>
<div class="line"><span class="lineno">  160</span>    <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a7f06d6bbeae107d1f91bbf2cad94288f">map_update_queue_</a>.emplace(std::move(geofence_msg));</div>
<div class="line"><span class="lineno">  161</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  162</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#aae0b14b4566a06ba1c99e46e79de0fba">current_map_version_</a> &gt; geofence_msg-&gt;map_version) { <span class="comment">// If this update is for an older map</span></div>
<div class="line"><span class="lineno">  163</span>    RCLCPP_WARN_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm::WMListenerWorker&quot;</span>), <span class="stringliteral">&quot;Dropping old map update as newer map is already available.&quot;</span>);</div>
<div class="line"><span class="lineno">  164</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  165</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#ae838d10e2677708b7b86c13fbb62d452">most_recent_update_msg_seq_</a> + 1 &lt; geofence_msg-&gt;seq_id) {</div>
<div class="line"><span class="lineno">  166</span>    RCLCPP_INFO_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm::WMListenerWorker&quot;</span>), <span class="stringliteral">&quot;Queuing map update as we are waiting on an earlier update to be applied. most_recent_update_msg_seq_: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#ae838d10e2677708b7b86c13fbb62d452">most_recent_update_msg_seq_</a> &lt;&lt; <span class="stringliteral">&quot;geofence_msg-&gt;seq_id: &quot;</span> &lt;&lt; geofence_msg-&gt;seq_id);</div>
<div class="line"><span class="lineno">  167</span>    <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a7f06d6bbeae107d1f91bbf2cad94288f">map_update_queue_</a>.emplace(std::move(geofence_msg));</div>
<div class="line"><span class="lineno">  168</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  169</span>  }</div>
<div class="line"><span class="lineno">  170</span> </div>
<div class="line"><span class="lineno">  171</span> </div>
<div class="line"><span class="lineno">  172</span>  <span class="keywordflow">if</span>(geofence_msg-&gt;invalidates_route==<span class="keyword">true</span> &amp;&amp; <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a4ea1ac169b8ba4a72dd72b4e8723257e">world_model_</a>-&gt;getRoute())</div>
<div class="line"><span class="lineno">  173</span>  {  </div>
<div class="line"><span class="lineno">  174</span>    <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a310d6ebc20c42f055541025291337b57">rerouting_flag_</a>=<span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  175</span>    <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#acae1ff63ff0f396de4e3f1bb9ab492bb">recompute_route_flag_</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  176</span> </div>
<div class="line"><span class="lineno">  177</span>    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm::WMListenerWorker&quot;</span>), <span class="stringliteral">&quot;Received notice that route has been invalidated in mapUpdateCallback&quot;</span>);</div>
<div class="line"><span class="lineno">  178</span> </div>
<div class="line"><span class="lineno">  179</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a39cbf05af713a84fb396c36da3551df5">route_node_flag_</a>!=<span class="keyword">true</span>)</div>
<div class="line"><span class="lineno">  180</span>    {</div>
<div class="line"><span class="lineno">  181</span>     RCLCPP_INFO_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm::WMListenerWorker&quot;</span>), <span class="stringliteral">&quot;Route is not yet available. Therefore queueing the update&quot;</span>);</div>
<div class="line"><span class="lineno">  182</span>     <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a7f06d6bbeae107d1f91bbf2cad94288f">map_update_queue_</a>.emplace(std::move(geofence_msg));</div>
<div class="line"><span class="lineno">  183</span>     <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  184</span>    }</div>
<div class="line"><span class="lineno">  185</span>  }</div>
<div class="line"><span class="lineno">  186</span> </div>
<div class="line"><span class="lineno">  187</span>  <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#ae838d10e2677708b7b86c13fbb62d452">most_recent_update_msg_seq_</a> = geofence_msg-&gt;seq_id; <span class="comment">// Update current sequence count</span></div>
<div class="line"><span class="lineno">  188</span> </div>
<div class="line"><span class="lineno">  189</span>  <span class="keyword">auto</span> gf_ptr = std::shared_ptr&lt;carma_wm::TrafficControl&gt;(<span class="keyword">new</span> <a class="code hl_class" href="classcarma__wm_1_1TrafficControl.html">carma_wm::TrafficControl</a>);</div>
<div class="line"><span class="lineno">  190</span>  </div>
<div class="line"><span class="lineno">  191</span>  <span class="comment">// convert ros msg to geofence object</span></div>
<div class="line"><span class="lineno">  192</span>  <a class="code hl_function" href="namespacecarma__wm.html#a3c6c82d3e0fcfc7dd50176a453598911">carma_wm::fromBinMsg</a>(*geofence_msg, gf_ptr, <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a4ea1ac169b8ba4a72dd72b4e8723257e">world_model_</a>-&gt;getMutableMap());</div>
<div class="line"><span class="lineno">  193</span> </div>
<div class="line"><span class="lineno">  194</span>  RCLCPP_INFO_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm::WMListenerWorker&quot;</span>), <span class="stringliteral">&quot;Processing Map Update with Geofence Id:&quot;</span> &lt;&lt; gf_ptr-&gt;id_);</div>
<div class="line"><span class="lineno">  195</span>  </div>
<div class="line"><span class="lineno">  196</span>  RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm::WMListenerWorker&quot;</span>), <span class="stringliteral">&quot;Geofence id&quot;</span> &lt;&lt; gf_ptr-&gt;id_ &lt;&lt; <span class="stringliteral">&quot; requests addition of lanelets size: &quot;</span> &lt;&lt; gf_ptr-&gt;lanelet_additions_.size());</div>
<div class="line"><span class="lineno">  197</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> llt : gf_ptr-&gt;lanelet_additions_)</div>
<div class="line"><span class="lineno">  198</span>  {</div>
<div class="line"><span class="lineno">  199</span>    <span class="comment">// world model here should blindly accept the map update received</span></div>
<div class="line"><span class="lineno">  200</span>    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm::WMListenerWorker&quot;</span>), <span class="stringliteral">&quot;Adding new lanelet with id: &quot;</span> &lt;&lt; llt.id());</div>
<div class="line"><span class="lineno">  201</span>    <span class="keyword">auto</span> left = llt.leftBound3d(); <span class="comment">//new lanelet coming in</span></div>
<div class="line"><span class="lineno">  202</span>    </div>
<div class="line"><span class="lineno">  203</span>    <span class="comment">// updating incoming points&#39; memory addresses with local ones of same ids</span></div>
<div class="line"><span class="lineno">  204</span>    <span class="comment">// so that lanelet library can recognize they are same objects </span></div>
<div class="line"><span class="lineno">  205</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> = 0; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> &lt; left.size(); <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> ++)</div>
<div class="line"><span class="lineno">  206</span>    {</div>
<div class="line"><span class="lineno">  207</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a4ea1ac169b8ba4a72dd72b4e8723257e">world_model_</a>-&gt;getMutableMap()-&gt;pointLayer.exists(left[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>].id())) <span class="comment">//rewrite the memory address of new pts with that of local</span></div>
<div class="line"><span class="lineno">  208</span>      {</div>
<div class="line"><span class="lineno">  209</span>        llt.leftBound3d()[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>] = <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a4ea1ac169b8ba4a72dd72b4e8723257e">world_model_</a>-&gt;getMutableMap()-&gt;pointLayer.get(left[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>].<span class="keywordtype">id</span>());</div>
<div class="line"><span class="lineno">  210</span>      }</div>
<div class="line"><span class="lineno">  211</span>    }</div>
<div class="line"><span class="lineno">  212</span>    <span class="keyword">auto</span> right = llt.rightBound3d(); <span class="comment">//new lanelet coming in</span></div>
<div class="line"><span class="lineno">  213</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> = 0; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> &lt; right.size(); <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> ++)</div>
<div class="line"><span class="lineno">  214</span>    {</div>
<div class="line"><span class="lineno">  215</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a4ea1ac169b8ba4a72dd72b4e8723257e">world_model_</a>-&gt;getMutableMap()-&gt;pointLayer.exists(right[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>].id())) <span class="comment">//rewrite the memory address of new pts with that of local</span></div>
<div class="line"><span class="lineno">  216</span>      {</div>
<div class="line"><span class="lineno">  217</span>        llt.rightBound3d()[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>] = <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a4ea1ac169b8ba4a72dd72b4e8723257e">world_model_</a>-&gt;getMutableMap()-&gt;pointLayer.get(right[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>].<span class="keywordtype">id</span>());</div>
<div class="line"><span class="lineno">  218</span>      }</div>
<div class="line"><span class="lineno">  219</span>    }</div>
<div class="line"><span class="lineno">  220</span> </div>
<div class="line"><span class="lineno">  221</span>    <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a4ea1ac169b8ba4a72dd72b4e8723257e">world_model_</a>-&gt;getMutableMap()-&gt;add(llt);</div>
<div class="line"><span class="lineno">  222</span>  }</div>
<div class="line"><span class="lineno">  223</span> </div>
<div class="line"><span class="lineno">  224</span>  RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm::WMListenerWorker&quot;</span>), <span class="stringliteral">&quot;Geofence id&quot;</span> &lt;&lt; gf_ptr-&gt;id_ &lt;&lt; <span class="stringliteral">&quot; sends record of traffic_lights_id size: &quot;</span> &lt;&lt; gf_ptr-&gt;traffic_light_id_lookup_.size());</div>
<div class="line"><span class="lineno">  225</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> pair : gf_ptr-&gt;traffic_light_id_lookup_)</div>
<div class="line"><span class="lineno">  226</span>  {</div>
<div class="line"><span class="lineno">  227</span>    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm::WMListenerWorker&quot;</span>), <span class="stringliteral">&quot;Adding new pair for traffic light ids: &quot;</span> &lt;&lt; pair.first &lt;&lt; <span class="stringliteral">&quot;, and lanelet::Id: &quot;</span> &lt;&lt; pair.second);</div>
<div class="line"><span class="lineno">  228</span>    <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a4ea1ac169b8ba4a72dd72b4e8723257e">world_model_</a>-&gt;setTrafficLightIds(pair.first, pair.second);</div>
<div class="line"><span class="lineno">  229</span>  }</div>
<div class="line"><span class="lineno">  230</span> </div>
<div class="line"><span class="lineno">  231</span>  RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm::WMListenerWorker&quot;</span>), <span class="stringliteral">&quot;Geofence id&quot;</span> &lt;&lt; gf_ptr-&gt;id_ &lt;&lt; <span class="stringliteral">&quot; sends record of intersections size: &quot;</span> &lt;&lt; gf_ptr-&gt;sim_.intersection_id_to_regem_id_.size());</div>
<div class="line"><span class="lineno">  232</span>  <span class="keywordflow">if</span> (gf_ptr-&gt;sim_.intersection_id_to_regem_id_.size() &gt; 0)</div>
<div class="line"><span class="lineno">  233</span>  {</div>
<div class="line"><span class="lineno">  234</span>    <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a4ea1ac169b8ba4a72dd72b4e8723257e">world_model_</a>-&gt;sim_ = gf_ptr-&gt;sim_;</div>
<div class="line"><span class="lineno">  235</span>    <a class="code hl_function" href="namespacecarma__wm.html#aae8a9e16b161a8edf05ca9df4307a5ec">logSignalizedIntersectionManager</a>(<a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a4ea1ac169b8ba4a72dd72b4e8723257e">world_model_</a>-&gt;sim_);</div>
<div class="line"><span class="lineno">  236</span>  }</div>
<div class="line"><span class="lineno">  237</span> </div>
<div class="line"><span class="lineno">  238</span>  RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm::WMListenerWorker&quot;</span>), <span class="stringliteral">&quot;Geofence id&quot;</span> &lt;&lt; gf_ptr-&gt;id_ &lt;&lt; <span class="stringliteral">&quot; requests removal of size: &quot;</span> &lt;&lt; gf_ptr-&gt;remove_list_.size());</div>
<div class="line"><span class="lineno">  239</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> pair : gf_ptr-&gt;remove_list_)</div>
<div class="line"><span class="lineno">  240</span>  {</div>
<div class="line"><span class="lineno">  241</span>    <span class="keyword">auto</span> parent_llt = <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a4ea1ac169b8ba4a72dd72b4e8723257e">world_model_</a>-&gt;getMutableMap()-&gt;laneletLayer.get(pair.first);</div>
<div class="line"><span class="lineno">  242</span>    <span class="comment">// we can only check by id, if the element is there</span></div>
<div class="line"><span class="lineno">  243</span>    <span class="comment">// this is only for speed optimization, as world model here should blindly accept the map update received</span></div>
<div class="line"><span class="lineno">  244</span>    <span class="keyword">auto</span> regems_copy_to_check = parent_llt.regulatoryElements(); <span class="comment">// save local copy as the regem can be deleted during iteration</span></div>
<div class="line"><span class="lineno">  245</span>    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm::WMListenerWorker&quot;</span>), <span class="stringliteral">&quot;Regems found in lanelet: &quot;</span> &lt;&lt; regems_copy_to_check.size());</div>
<div class="line"><span class="lineno">  246</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> regem: regems_copy_to_check)</div>
<div class="line"><span class="lineno">  247</span>    {</div>
<div class="line"><span class="lineno">  248</span>      <span class="comment">// we can&#39;t use the deserialized element as its data address conflicts the one in this node</span></div>
<div class="line"><span class="lineno">  249</span>      <span class="keywordflow">if</span> (pair.second-&gt;id() == regem-&gt;id()) <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a4ea1ac169b8ba4a72dd72b4e8723257e">world_model_</a>-&gt;getMutableMap()-&gt;remove(parent_llt, regem);</div>
<div class="line"><span class="lineno">  250</span>    }</div>
<div class="line"><span class="lineno">  251</span>    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm::WMListenerWorker&quot;</span>), <span class="stringliteral">&quot;Regems left in lanelet after removal: &quot;</span> &lt;&lt; parent_llt.regulatoryElements().size());</div>
<div class="line"><span class="lineno">  252</span> </div>
<div class="line"><span class="lineno">  253</span>  }</div>
<div class="line"><span class="lineno">  254</span>  </div>
<div class="line"><span class="lineno">  255</span>  RCLCPP_INFO_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm::WMListenerWorker&quot;</span>), <span class="stringliteral">&quot;Geofence id&quot;</span> &lt;&lt; gf_ptr-&gt;id_ &lt;&lt; <span class="stringliteral">&quot; requests update of size: &quot;</span> &lt;&lt; gf_ptr-&gt;update_list_.size());</div>
<div class="line"><span class="lineno">  256</span> </div>
<div class="line"><span class="lineno">  257</span>  <span class="comment">// we should extract general regem to specific type of regem the geofence specifies</span></div>
<div class="line"><span class="lineno">  258</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> pair : gf_ptr-&gt;update_list_)</div>
<div class="line"><span class="lineno">  259</span>  {</div>
<div class="line"><span class="lineno">  260</span> </div>
<div class="line"><span class="lineno">  261</span>    <span class="keyword">auto</span> parent_llt = <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a4ea1ac169b8ba4a72dd72b4e8723257e">world_model_</a>-&gt;getMutableMap()-&gt;laneletLayer.get(pair.first);</div>
<div class="line"><span class="lineno">  262</span> </div>
<div class="line"><span class="lineno">  263</span>    <span class="keyword">auto</span> regemptr_it = <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a4ea1ac169b8ba4a72dd72b4e8723257e">world_model_</a>-&gt;getMutableMap()-&gt;regulatoryElementLayer.find(pair.second-&gt;id());</div>
<div class="line"><span class="lineno">  264</span> </div>
<div class="line"><span class="lineno">  265</span>    <span class="comment">// if this regem is already in the map.</span></div>
<div class="line"><span class="lineno">  266</span>    <span class="comment">// This section is expected to be called to add back regulations which were previously removed by expired geofences.</span></div>
<div class="line"><span class="lineno">  267</span>    <span class="keywordflow">if</span> (regemptr_it != <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a4ea1ac169b8ba4a72dd72b4e8723257e">world_model_</a>-&gt;getMutableMap()-&gt;regulatoryElementLayer.end())  </div>
<div class="line"><span class="lineno">  268</span>    {</div>
<div class="line"><span class="lineno">  269</span> </div>
<div class="line"><span class="lineno">  270</span>      RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm::WMListenerWorker&quot;</span>), <span class="stringliteral">&quot;Reapplying previously existing element for lanelet id:&quot;</span> &lt;&lt; parent_llt.id() &lt;&lt; <span class="stringliteral">&quot;, and regem id: &quot;</span> &lt;&lt; regemptr_it-&gt;get()-&gt;id());</div>
<div class="line"><span class="lineno">  271</span>      <span class="comment">// again we should use the element with correct data address to be consistent</span></div>
<div class="line"><span class="lineno">  272</span>      <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a4ea1ac169b8ba4a72dd72b4e8723257e">world_model_</a>-&gt;getMutableMap()-&gt;update(parent_llt, *regemptr_it);</div>
<div class="line"><span class="lineno">  273</span>    }</div>
<div class="line"><span class="lineno">  274</span>    <span class="keywordflow">else</span> <span class="comment">// Updates are treated as new regulations after the old value was removed. In both cases we enter this block. </span></div>
<div class="line"><span class="lineno">  275</span>    {</div>
<div class="line"><span class="lineno">  276</span>      RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm::WMListenerWorker&quot;</span>), <span class="stringliteral">&quot;New regulatory element at lanelet: &quot;</span> &lt;&lt; parent_llt.id() &lt;&lt; <span class="stringliteral">&quot;, and id: &quot;</span> &lt;&lt; pair.second-&gt;id());</div>
<div class="line"><span class="lineno">  277</span>      <a class="code hl_function" href="classcarma__wm_1_1WMListenerWorker.html#a5cffb02708d8e8421ad56c4e7dd21b81">newRegemUpdateHelper</a>(parent_llt, pair.second.get());</div>
<div class="line"><span class="lineno">  278</span>    }</div>
<div class="line"><span class="lineno">  279</span>  }</div>
<div class="line"><span class="lineno">  280</span>  </div>
<div class="line"><span class="lineno">  281</span>  <span class="comment">// set the Map to trigger a new route graph construction if rerouting was required by the updates and a new graph was not provided</span></div>
<div class="line"><span class="lineno">  282</span>  <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a4ea1ac169b8ba4a72dd72b4e8723257e">world_model_</a>-&gt;setMap(<a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a4ea1ac169b8ba4a72dd72b4e8723257e">world_model_</a>-&gt;getMutableMap(), <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#aae0b14b4566a06ba1c99e46e79de0fba">current_map_version_</a>, <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#acae1ff63ff0f396de4e3f1bb9ab492bb">recompute_route_flag_</a> &amp;&amp; !geofence_msg-&gt;has_routing_graph );</div>
<div class="line"><span class="lineno">  283</span> </div>
<div class="line"><span class="lineno">  284</span>  <span class="comment">// If a new graph was provided then set that graph</span></div>
<div class="line"><span class="lineno">  285</span>  <span class="comment">// recompute_route_flag_ not checked here to support the case of the first map or map version changing</span></div>
<div class="line"><span class="lineno">  286</span>  <span class="keywordflow">if</span> (geofence_msg-&gt;has_routing_graph) {</div>
<div class="line"><span class="lineno">  287</span> </div>
<div class="line"><span class="lineno">  288</span>    <a class="code hl_typedef" href="namespacecarma__wm.html#a23411d3d299da623ec379efbc1a5b14a">LaneletRoutingGraphPtr</a> graph = <a class="code hl_function" href="classcarma__wm_1_1WMListenerWorker.html#a614654b7b374ed1d24537e347d49389f">routingGraphFromMsg</a>(geofence_msg-&gt;routing_graph, <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a4ea1ac169b8ba4a72dd72b4e8723257e">world_model_</a>-&gt;getMutableMap());</div>
<div class="line"><span class="lineno">  289</span> </div>
<div class="line"><span class="lineno">  290</span>    <span class="keywordflow">if</span> (!graph) {</div>
<div class="line"><span class="lineno">  291</span>      <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;Map updated provided routing graph which could not be applied to the current map.&quot;</span>);</div>
<div class="line"><span class="lineno">  292</span>    }</div>
<div class="line"><span class="lineno">  293</span> </div>
<div class="line"><span class="lineno">  294</span>    <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a4ea1ac169b8ba4a72dd72b4e8723257e">world_model_</a>-&gt;setRoutingGraph(graph);</div>
<div class="line"><span class="lineno">  295</span> </div>
<div class="line"><span class="lineno">  296</span>  }</div>
<div class="line"><span class="lineno">  297</span> </div>
<div class="line"><span class="lineno">  298</span>  <span class="comment">// no need to reroute again unless received invalidated msg again</span></div>
<div class="line"><span class="lineno">  299</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#acae1ff63ff0f396de4e3f1bb9ab492bb">recompute_route_flag_</a>)</div>
<div class="line"><span class="lineno">  300</span>    <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#acae1ff63ff0f396de4e3f1bb9ab492bb">recompute_route_flag_</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  301</span>  </div>
<div class="line"><span class="lineno">  302</span> </div>
<div class="line"><span class="lineno">  303</span>  RCLCPP_INFO_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm::WMListenerWorker&quot;</span>), <span class="stringliteral">&quot;Finished Applying the Map Update with Geofence Id:&quot;</span> &lt;&lt; gf_ptr-&gt;id_); </div>
<div class="line"><span class="lineno">  304</span> </div>
<div class="line"><span class="lineno">  305</span>  <span class="comment">// Call user defined map callback</span></div>
<div class="line"><span class="lineno">  306</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a3c2e638e8fdc934482ba9076a5ca7bb5">map_callback_</a>)</div>
<div class="line"><span class="lineno">  307</span>  {</div>
<div class="line"><span class="lineno">  308</span>    RCLCPP_INFO_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm::WMListenerWorker&quot;</span>), <span class="stringliteral">&quot;Calling user defined map update callback&quot;</span>);</div>
<div class="line"><span class="lineno">  309</span>    <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a3c2e638e8fdc934482ba9076a5ca7bb5">map_callback_</a>();</div>
<div class="line"><span class="lineno">  310</span>  }</div>
<div class="line"><span class="lineno">  311</span>}</div>
<div class="ttc" id="aclasscarma__wm_1_1TrafficControl_html"><div class="ttname"><a href="classcarma__wm_1_1TrafficControl.html">carma_wm::TrafficControl</a></div><div class="ttdef"><b>Definition:</b> <a href="TrafficControl_8hpp_source.html#l00049">TrafficControl.hpp:50</a></div></div>
<div class="ttc" id="aclasscarma__wm_1_1WMListenerWorker_html_a5cffb02708d8e8421ad56c4e7dd21b81"><div class="ttname"><a href="classcarma__wm_1_1WMListenerWorker.html#a5cffb02708d8e8421ad56c4e7dd21b81">carma_wm::WMListenerWorker::newRegemUpdateHelper</a></div><div class="ttdeci">void newRegemUpdateHelper(lanelet::Lanelet parent_llt, lanelet::RegulatoryElement *regem) const</div><div class="ttdoc">This is a helper function updates the parent_llt with specified regem. This function is needed as we ...</div><div class="ttdef"><b>Definition:</b> <a href="WMListenerWorker_8cpp_source.html#l00321">WMListenerWorker.cpp:321</a></div></div>
<div class="ttc" id="aclasscarma__wm_1_1WMListenerWorker_html_a614654b7b374ed1d24537e347d49389f"><div class="ttname"><a href="classcarma__wm_1_1WMListenerWorker.html#a614654b7b374ed1d24537e347d49389f">carma_wm::WMListenerWorker::routingGraphFromMsg</a></div><div class="ttdeci">LaneletRoutingGraphPtr routingGraphFromMsg(const autoware_lanelet2_msgs::msg::RoutingGraph &amp;msg, lanelet::LaneletMapPtr map) const</div><div class="ttdoc">Helper function to convert a routing graph message into a actual RoutingGraph object.</div><div class="ttdef"><b>Definition:</b> <a href="WMListenerWorker_8cpp_source.html#l00448">WMListenerWorker.cpp:448</a></div></div>
<div class="ttc" id="aclasscarma__wm_1_1WMListenerWorker_html_acae1ff63ff0f396de4e3f1bb9ab492bb"><div class="ttname"><a href="classcarma__wm_1_1WMListenerWorker.html#acae1ff63ff0f396de4e3f1bb9ab492bb">carma_wm::WMListenerWorker::recompute_route_flag_</a></div><div class="ttdeci">bool recompute_route_flag_</div><div class="ttdef"><b>Definition:</b> <a href="WMListenerWorker_8hpp_source.html#l00156">WMListenerWorker.hpp:156</a></div></div>
<div class="ttc" id="aclasscarma__wm_1_1WMListenerWorker_html_ae838d10e2677708b7b86c13fbb62d452"><div class="ttname"><a href="classcarma__wm_1_1WMListenerWorker.html#ae838d10e2677708b7b86c13fbb62d452">carma_wm::WMListenerWorker::most_recent_update_msg_seq_</a></div><div class="ttdeci">long most_recent_update_msg_seq_</div><div class="ttdef"><b>Definition:</b> <a href="WMListenerWorker_8hpp_source.html#l00159">WMListenerWorker.hpp:159</a></div></div>
<div class="ttc" id="anamespacecarma__wm_html_a23411d3d299da623ec379efbc1a5b14a"><div class="ttname"><a href="namespacecarma__wm.html#a23411d3d299da623ec379efbc1a5b14a">carma_wm::LaneletRoutingGraphPtr</a></div><div class="ttdeci">std::shared_ptr&lt; lanelet::routing::RoutingGraph &gt; LaneletRoutingGraphPtr</div><div class="ttdef"><b>Definition:</b> <a href="WorldModel_8hpp_source.html#l00050">WorldModel.hpp:50</a></div></div>
<div class="ttc" id="anamespacecarma__wm_html_aae8a9e16b161a8edf05ca9df4307a5ec"><div class="ttname"><a href="namespacecarma__wm.html#aae8a9e16b161a8edf05ca9df4307a5ec">carma_wm::logSignalizedIntersectionManager</a></div><div class="ttdeci">void logSignalizedIntersectionManager(const carma_wm::SignalizedIntersectionManager &amp;sim)</div><div class="ttdef"><b>Definition:</b> <a href="WMListenerWorker_8cpp_source.html#l00120">WMListenerWorker.cpp:120</a></div></div>
<div class="ttc" id="anamespaceprocess__bag_html_af102a02c97622dd30b0dbf7bafb0d199"><div class="ttname"><a href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">process_bag.i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="process__bag_8py_source.html#l00059">process_bag.py:59</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMListenerWorker_8hpp_source.html#l00152">current_map_version_</a>, <a class="el" href="TrafficControl_8cpp_source.html#l00040">carma_wm::fromBinMsg()</a>, <a class="el" href="process__bag_8py_source.html#l00059">process_bag::i</a>, <a class="el" href="WMListenerWorker_8cpp_source.html#l00120">carma_wm::logSignalizedIntersectionManager()</a>, <a class="el" href="WMListenerWorker_8hpp_source.html#l00147">map_callback_</a>, <a class="el" href="WMListenerWorker_8hpp_source.html#l00153">map_update_queue_</a>, <a class="el" href="WMListenerWorker_8hpp_source.html#l00159">most_recent_update_msg_seq_</a>, <a class="el" href="WMListenerWorker_8cpp_source.html#l00321">newRegemUpdateHelper()</a>, <a class="el" href="WMListenerWorker_8hpp_source.html#l00156">recompute_route_flag_</a>, <a class="el" href="WMListenerWorker_8hpp_source.html#l00157">rerouting_flag_</a>, <a class="el" href="WMListenerWorker_8hpp_source.html#l00158">route_node_flag_</a>, <a class="el" href="WMListenerWorker_8cpp_source.html#l00448">routingGraphFromMsg()</a>, and <a class="el" href="WMListenerWorker_8hpp_source.html#l00145">world_model_</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMListenerWorker_8cpp_source.html#l00056">mapCallback()</a>, and <a class="el" href="WMListenerWorker_8cpp_source.html#l00578">routeCallback()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm_1_1WMListenerWorker_a3e2fb75fe96504aa76691cfecd5dd35f_cgraph.png" border="0" usemap="#aclasscarma__wm_1_1WMListenerWorker_a3e2fb75fe96504aa76691cfecd5dd35f_cgraph" alt=""/></div>
<map name="aclasscarma__wm_1_1WMListenerWorker_a3e2fb75fe96504aa76691cfecd5dd35f_cgraph" id="aclasscarma__wm_1_1WMListenerWorker_a3e2fb75fe96504aa76691cfecd5dd35f_cgraph">
<area shape="rect" title="Callback for new map update messages (geofence). Updates the underlying map." alt="" coords="5,90,208,131"/>
<area shape="rect" href="namespacecarma__wm.html#a3c6c82d3e0fcfc7dd50176a453598911" title=" " alt="" coords="293,5,455,32"/>
<area shape="rect" href="namespacecarma__wm.html#aae8a9e16b161a8edf05ca9df4307a5ec" title=" " alt="" coords="256,57,492,98"/>
<area shape="rect" href="classcarma__wm_1_1WMListenerWorker.html#a5cffb02708d8e8421ad56c4e7dd21b81" title="This is a helper function updates the parent_llt with specified regem. This function is needed as we ..." alt="" coords="273,122,475,163"/>
<area shape="rect" href="classcarma__wm_1_1WMListenerWorker.html#a614654b7b374ed1d24537e347d49389f" title="Helper function to convert a routing graph message into a actual RoutingGraph object." alt="" coords="273,187,475,229"/>
<area shape="rect" href="namespacecarma__wm.html#a4c3b7aaa05aea0c95189c98c5d902cf8" title=" " alt="" coords="540,129,759,156"/>
<area shape="rect" href="classcarma__wm_1_1WMListenerWorker.html#ac0c115081f19ec29b215e6edeb110d4c" title="Returns the Vehicle Participation Type value." alt="" coords="548,187,751,229"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm_1_1WMListenerWorker_a3e2fb75fe96504aa76691cfecd5dd35f_icgraph.png" border="0" usemap="#aclasscarma__wm_1_1WMListenerWorker_a3e2fb75fe96504aa76691cfecd5dd35f_icgraph" alt=""/></div>
<map name="aclasscarma__wm_1_1WMListenerWorker_a3e2fb75fe96504aa76691cfecd5dd35f_icgraph" id="aclasscarma__wm_1_1WMListenerWorker_a3e2fb75fe96504aa76691cfecd5dd35f_icgraph">
<area shape="rect" title="Callback for new map update messages (geofence). Updates the underlying map." alt="" coords="717,35,920,76"/>
<area shape="rect" href="classcarma__wm_1_1WMListenerWorker.html#ad4490dd5c93ee3ade6e62d5e66dfc3c6" title="Callback for new map messages. Updates the underlying map." alt="" coords="216,5,419,47"/>
<area shape="rect" href="classcarma__wm_1_1WMListenerWorker.html#ad441355e4885986b80ebf067d8b704c0" title="Callback for route message." alt="" coords="467,64,669,105"/>
<area shape="rect" href="classcarma__wm_1_1WMListener.html#ae8f498999a2d8365543b153d7b536e38" title="Constructor which can be used to specify threading behavior of this class." alt="" coords="5,35,168,76"/>
</map>
</div>

</div>
</div>
<a id="a5cffb02708d8e8421ad56c4e7dd21b81" name="a5cffb02708d8e8421ad56c4e7dd21b81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5cffb02708d8e8421ad56c4e7dd21b81">&#9670;&nbsp;</a></span>newRegemUpdateHelper()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void carma_wm::WMListenerWorker::newRegemUpdateHelper </td>
          <td>(</td>
          <td class="paramtype">lanelet::Lanelet&#160;</td>
          <td class="paramname"><em>parent_llt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">lanelet::RegulatoryElement *&#160;</td>
          <td class="paramname"><em>regem</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This is a helper function updates the parent_llt with specified regem. This function is needed as we need to dynamic_cast from general regem to specific type of regem based on the geofence. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">parent_llt</td><td>The Lanelet that need to register the regem </td></tr>
    <tr><td class="paramname">regem</td><td>lanelet::RegulatoryElement* which is the type that the serializer decodes from binary NOTE: Currently this function supports items in <a class="el" href="namespacecarma__wm.html#ac09d7a77e6f8f955651e7afa16136bf1">carma_wm::GeofenceType</a> </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="WMListenerWorker_8cpp_source.html#l00321">321</a> of file <a class="el" href="WMListenerWorker_8cpp_source.html">WMListenerWorker.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  322</span>{</div>
<div class="line"><span class="lineno">  323</span>  <span class="keyword">auto</span> factory_regem = lanelet::RegulatoryElementFactory::create(regem-&gt;attribute(lanelet::AttributeName::Subtype).value(),</div>
<div class="line"><span class="lineno">  324</span>                                                            std::const_pointer_cast&lt;lanelet::RegulatoryElementData&gt;(regem-&gt;constData()));</div>
<div class="line"><span class="lineno">  325</span> </div>
<div class="line"><span class="lineno">  326</span>  <span class="comment">// we should extract general regem to specific type of regem the geofence specifies</span></div>
<div class="line"><span class="lineno">  327</span>  <span class="keywordflow">switch</span>(<a class="code hl_function" href="namespacecarma__wm.html#a4c3b7aaa05aea0c95189c98c5d902cf8">resolveGeofenceType</a>(regem-&gt;attribute(lanelet::AttributeName::Subtype).value()))</div>
<div class="line"><span class="lineno">  328</span>  {</div>
<div class="line"><span class="lineno">  329</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespacecarma__wm.html#ac09d7a77e6f8f955651e7afa16136bf1a0acb40e631b1fdde545715ce5080ce82">GeofenceType::PASSING_CONTROL_LINE</a>:</div>
<div class="line"><span class="lineno">  330</span>    {</div>
<div class="line"><span class="lineno">  331</span>      lanelet::PassingControlLinePtr control_line = std::dynamic_pointer_cast&lt;lanelet::PassingControlLine&gt;(factory_regem);</div>
<div class="line"><span class="lineno">  332</span>      <span class="keywordflow">if</span> (control_line)</div>
<div class="line"><span class="lineno">  333</span>      {</div>
<div class="line"><span class="lineno">  334</span>        <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a4ea1ac169b8ba4a72dd72b4e8723257e">world_model_</a>-&gt;getMutableMap()-&gt;update(parent_llt, control_line);</div>
<div class="line"><span class="lineno">  335</span>      }</div>
<div class="line"><span class="lineno">  336</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  337</span>      {</div>
<div class="line"><span class="lineno">  338</span>        std::invalid_argument(<span class="stringliteral">&quot;Dynamic Pointer cast failed on getting valid control line&quot;</span>);</div>
<div class="line"><span class="lineno">  339</span>      }</div>
<div class="line"><span class="lineno">  340</span> </div>
<div class="line"><span class="lineno">  341</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  342</span>    }</div>
<div class="line"><span class="lineno">  343</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespacecarma__wm.html#ac09d7a77e6f8f955651e7afa16136bf1a56a6787427d0254f508836bebdea7700">GeofenceType::DIGITAL_SPEED_LIMIT</a>:</div>
<div class="line"><span class="lineno">  344</span>    {</div>
<div class="line"><span class="lineno">  345</span>      lanelet::DigitalSpeedLimitPtr speed = std::dynamic_pointer_cast&lt;lanelet::DigitalSpeedLimit&gt;(factory_regem);</div>
<div class="line"><span class="lineno">  346</span>      <span class="keywordflow">if</span> (speed)</div>
<div class="line"><span class="lineno">  347</span>      {</div>
<div class="line"><span class="lineno">  348</span>        <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a4ea1ac169b8ba4a72dd72b4e8723257e">world_model_</a>-&gt;getMutableMap()-&gt;update(parent_llt, speed);</div>
<div class="line"><span class="lineno">  349</span>      }</div>
<div class="line"><span class="lineno">  350</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  351</span>      {</div>
<div class="line"><span class="lineno">  352</span>        std::invalid_argument(<span class="stringliteral">&quot;Dynamic Pointer cast failed on getting valid speed limit&quot;</span>);</div>
<div class="line"><span class="lineno">  353</span>      }</div>
<div class="line"><span class="lineno">  354</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  355</span>    }</div>
<div class="line"><span class="lineno">  356</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespacecarma__wm.html#ac09d7a77e6f8f955651e7afa16136bf1a3342d8a1648c3c7b49348bdebb6a67d8">GeofenceType::REGION_ACCESS_RULE</a>:</div>
<div class="line"><span class="lineno">  357</span>    {</div>
<div class="line"><span class="lineno">  358</span> </div>
<div class="line"><span class="lineno">  359</span>      lanelet::RegionAccessRulePtr rar = std::dynamic_pointer_cast&lt;lanelet::RegionAccessRule&gt;(factory_regem);</div>
<div class="line"><span class="lineno">  360</span>      <span class="keywordflow">if</span> (rar)</div>
<div class="line"><span class="lineno">  361</span>      {</div>
<div class="line"><span class="lineno">  362</span>        <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a4ea1ac169b8ba4a72dd72b4e8723257e">world_model_</a>-&gt;getMutableMap()-&gt;update(parent_llt, rar);</div>
<div class="line"><span class="lineno">  363</span>      }</div>
<div class="line"><span class="lineno">  364</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  365</span>      {</div>
<div class="line"><span class="lineno">  366</span>        std::invalid_argument(<span class="stringliteral">&quot;Dynamic Pointer cast failed on getting valid region access rule&quot;</span>);</div>
<div class="line"><span class="lineno">  367</span>      }</div>
<div class="line"><span class="lineno">  368</span>      </div>
<div class="line"><span class="lineno">  369</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  370</span>    }</div>
<div class="line"><span class="lineno">  371</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespacecarma__wm.html#ac09d7a77e6f8f955651e7afa16136bf1a72fb3f0a086a3e9014953c51396b9f63">GeofenceType::DIGITAL_MINIMUM_GAP</a>:</div>
<div class="line"><span class="lineno">  372</span>    {</div>
<div class="line"><span class="lineno">  373</span> </div>
<div class="line"><span class="lineno">  374</span>      lanelet::DigitalMinimumGapPtr min_gap = std::dynamic_pointer_cast&lt;lanelet::DigitalMinimumGap&gt;(factory_regem);</div>
<div class="line"><span class="lineno">  375</span>      <span class="keywordflow">if</span> (min_gap)</div>
<div class="line"><span class="lineno">  376</span>      {</div>
<div class="line"><span class="lineno">  377</span>        <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a4ea1ac169b8ba4a72dd72b4e8723257e">world_model_</a>-&gt;getMutableMap()-&gt;update(parent_llt, min_gap);</div>
<div class="line"><span class="lineno">  378</span>      }</div>
<div class="line"><span class="lineno">  379</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  380</span>      {</div>
<div class="line"><span class="lineno">  381</span>        std::invalid_argument(<span class="stringliteral">&quot;Dynamic Pointer cast failed on getting valid minimum gap rule&quot;</span>);</div>
<div class="line"><span class="lineno">  382</span>      }</div>
<div class="line"><span class="lineno">  383</span>      </div>
<div class="line"><span class="lineno">  384</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  385</span>    }</div>
<div class="line"><span class="lineno">  386</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespacecarma__wm.html#ac09d7a77e6f8f955651e7afa16136bf1a165080307b64c43de1a0939d3bf047ae">GeofenceType::DIRECTION_OF_TRAVEL</a>:</div>
<div class="line"><span class="lineno">  387</span>    {</div>
<div class="line"><span class="lineno">  388</span> </div>
<div class="line"><span class="lineno">  389</span>      lanelet::DirectionOfTravelPtr dot = std::dynamic_pointer_cast&lt;lanelet::DirectionOfTravel&gt;(factory_regem);</div>
<div class="line"><span class="lineno">  390</span>      <span class="keywordflow">if</span> (dot)</div>
<div class="line"><span class="lineno">  391</span>      {</div>
<div class="line"><span class="lineno">  392</span>        <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a4ea1ac169b8ba4a72dd72b4e8723257e">world_model_</a>-&gt;getMutableMap()-&gt;update(parent_llt, dot);</div>
<div class="line"><span class="lineno">  393</span>      }</div>
<div class="line"><span class="lineno">  394</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  395</span>      {</div>
<div class="line"><span class="lineno">  396</span>        std::invalid_argument(<span class="stringliteral">&quot;Dynamic Pointer cast failed on getting valid direction of travel&quot;</span>);</div>
<div class="line"><span class="lineno">  397</span>      }</div>
<div class="line"><span class="lineno">  398</span>      </div>
<div class="line"><span class="lineno">  399</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  400</span>    }</div>
<div class="line"><span class="lineno">  401</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespacecarma__wm.html#ac09d7a77e6f8f955651e7afa16136bf1a3ef9e3ed7808c7c32a48e954fad71c04">GeofenceType::STOP_RULE</a>:</div>
<div class="line"><span class="lineno">  402</span>    {</div>
<div class="line"><span class="lineno">  403</span> </div>
<div class="line"><span class="lineno">  404</span>      lanelet::StopRulePtr sr = std::dynamic_pointer_cast&lt;lanelet::StopRule&gt;(factory_regem);</div>
<div class="line"><span class="lineno">  405</span>      <span class="keywordflow">if</span> (sr)</div>
<div class="line"><span class="lineno">  406</span>      {</div>
<div class="line"><span class="lineno">  407</span>        <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a4ea1ac169b8ba4a72dd72b4e8723257e">world_model_</a>-&gt;getMutableMap()-&gt;update(parent_llt, sr);</div>
<div class="line"><span class="lineno">  408</span>      }</div>
<div class="line"><span class="lineno">  409</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  410</span>      {</div>
<div class="line"><span class="lineno">  411</span>        std::invalid_argument(<span class="stringliteral">&quot;Dynamic Pointer cast failed on getting valid stop rule&quot;</span>);</div>
<div class="line"><span class="lineno">  412</span>      }</div>
<div class="line"><span class="lineno">  413</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  414</span>    }</div>
<div class="line"><span class="lineno">  415</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespacecarma__wm.html#ac09d7a77e6f8f955651e7afa16136bf1a269b80a3c3f0b44a73071e21d4ab36c2">GeofenceType::CARMA_TRAFFIC_LIGHT</a>:</div>
<div class="line"><span class="lineno">  416</span>    {</div>
<div class="line"><span class="lineno">  417</span>      lanelet::CarmaTrafficSignalPtr ctl = std::dynamic_pointer_cast&lt;lanelet::CarmaTrafficSignal&gt;(factory_regem);</div>
<div class="line"><span class="lineno">  418</span>      <span class="keywordflow">if</span> (ctl)</div>
<div class="line"><span class="lineno">  419</span>      {</div>
<div class="line"><span class="lineno">  420</span>        <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a4ea1ac169b8ba4a72dd72b4e8723257e">world_model_</a>-&gt;getMutableMap()-&gt;update(parent_llt, ctl);</div>
<div class="line"><span class="lineno">  421</span>      }</div>
<div class="line"><span class="lineno">  422</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  423</span>      {</div>
<div class="line"><span class="lineno">  424</span>        std::invalid_argument(<span class="stringliteral">&quot;Dynamic Pointer cast failed on getting valid carma traffic signal&quot;</span>);</div>
<div class="line"><span class="lineno">  425</span>      }</div>
<div class="line"><span class="lineno">  426</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  427</span>    }</div>
<div class="line"><span class="lineno">  428</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespacecarma__wm.html#ac09d7a77e6f8f955651e7afa16136bf1a5183fcbc60f37b81f9ca22d76af71867">GeofenceType::SIGNALIZED_INTERSECTION</a>:</div>
<div class="line"><span class="lineno">  429</span>    {</div>
<div class="line"><span class="lineno">  430</span>      lanelet::SignalizedIntersectionPtr si = std::dynamic_pointer_cast&lt;lanelet::SignalizedIntersection&gt;(factory_regem);</div>
<div class="line"><span class="lineno">  431</span>      <span class="keywordflow">if</span> (si)</div>
<div class="line"><span class="lineno">  432</span>      {</div>
<div class="line"><span class="lineno">  433</span>        <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a4ea1ac169b8ba4a72dd72b4e8723257e">world_model_</a>-&gt;getMutableMap()-&gt;update(parent_llt, si);</div>
<div class="line"><span class="lineno">  434</span>      }</div>
<div class="line"><span class="lineno">  435</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  436</span>      {</div>
<div class="line"><span class="lineno">  437</span>        std::invalid_argument(<span class="stringliteral">&quot;Dynamic Pointer cast failed on getting valid signalized intersection&quot;</span>);</div>
<div class="line"><span class="lineno">  438</span>      }</div>
<div class="line"><span class="lineno">  439</span>      </div>
<div class="line"><span class="lineno">  440</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  441</span>    }</div>
<div class="line"><span class="lineno">  442</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  443</span>      RCLCPP_WARN_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm::WMListenerWorker&quot;</span>), <span class="stringliteral">&quot;World Model instance received an unsupported geofence type in its map update callback!&quot;</span>);</div>
<div class="line"><span class="lineno">  444</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  445</span>  }</div>
<div class="line"><span class="lineno">  446</span>}</div>
<div class="ttc" id="anamespacecarma__wm_html_a4c3b7aaa05aea0c95189c98c5d902cf8"><div class="ttname"><a href="namespacecarma__wm.html#a4c3b7aaa05aea0c95189c98c5d902cf8">carma_wm::resolveGeofenceType</a></div><div class="ttdeci">GeofenceType resolveGeofenceType(const std::string &amp;rule_name)</div><div class="ttdef"><b>Definition:</b> <a href="WMListenerWorker_8cpp_source.html#l00031">WMListenerWorker.cpp:31</a></div></div>
<div class="ttc" id="anamespacecarma__wm_html_ac09d7a77e6f8f955651e7afa16136bf1a0acb40e631b1fdde545715ce5080ce82"><div class="ttname"><a href="namespacecarma__wm.html#ac09d7a77e6f8f955651e7afa16136bf1a0acb40e631b1fdde545715ce5080ce82">carma_wm::GeofenceType::PASSING_CONTROL_LINE</a></div><div class="ttdeci">@ PASSING_CONTROL_LINE</div></div>
<div class="ttc" id="anamespacecarma__wm_html_ac09d7a77e6f8f955651e7afa16136bf1a165080307b64c43de1a0939d3bf047ae"><div class="ttname"><a href="namespacecarma__wm.html#ac09d7a77e6f8f955651e7afa16136bf1a165080307b64c43de1a0939d3bf047ae">carma_wm::GeofenceType::DIRECTION_OF_TRAVEL</a></div><div class="ttdeci">@ DIRECTION_OF_TRAVEL</div></div>
<div class="ttc" id="anamespacecarma__wm_html_ac09d7a77e6f8f955651e7afa16136bf1a269b80a3c3f0b44a73071e21d4ab36c2"><div class="ttname"><a href="namespacecarma__wm.html#ac09d7a77e6f8f955651e7afa16136bf1a269b80a3c3f0b44a73071e21d4ab36c2">carma_wm::GeofenceType::CARMA_TRAFFIC_LIGHT</a></div><div class="ttdeci">@ CARMA_TRAFFIC_LIGHT</div></div>
<div class="ttc" id="anamespacecarma__wm_html_ac09d7a77e6f8f955651e7afa16136bf1a3342d8a1648c3c7b49348bdebb6a67d8"><div class="ttname"><a href="namespacecarma__wm.html#ac09d7a77e6f8f955651e7afa16136bf1a3342d8a1648c3c7b49348bdebb6a67d8">carma_wm::GeofenceType::REGION_ACCESS_RULE</a></div><div class="ttdeci">@ REGION_ACCESS_RULE</div></div>
<div class="ttc" id="anamespacecarma__wm_html_ac09d7a77e6f8f955651e7afa16136bf1a3ef9e3ed7808c7c32a48e954fad71c04"><div class="ttname"><a href="namespacecarma__wm.html#ac09d7a77e6f8f955651e7afa16136bf1a3ef9e3ed7808c7c32a48e954fad71c04">carma_wm::GeofenceType::STOP_RULE</a></div><div class="ttdeci">@ STOP_RULE</div></div>
<div class="ttc" id="anamespacecarma__wm_html_ac09d7a77e6f8f955651e7afa16136bf1a5183fcbc60f37b81f9ca22d76af71867"><div class="ttname"><a href="namespacecarma__wm.html#ac09d7a77e6f8f955651e7afa16136bf1a5183fcbc60f37b81f9ca22d76af71867">carma_wm::GeofenceType::SIGNALIZED_INTERSECTION</a></div><div class="ttdeci">@ SIGNALIZED_INTERSECTION</div></div>
<div class="ttc" id="anamespacecarma__wm_html_ac09d7a77e6f8f955651e7afa16136bf1a56a6787427d0254f508836bebdea7700"><div class="ttname"><a href="namespacecarma__wm.html#ac09d7a77e6f8f955651e7afa16136bf1a56a6787427d0254f508836bebdea7700">carma_wm::GeofenceType::DIGITAL_SPEED_LIMIT</a></div><div class="ttdeci">@ DIGITAL_SPEED_LIMIT</div></div>
<div class="ttc" id="anamespacecarma__wm_html_ac09d7a77e6f8f955651e7afa16136bf1a72fb3f0a086a3e9014953c51396b9f63"><div class="ttname"><a href="namespacecarma__wm.html#ac09d7a77e6f8f955651e7afa16136bf1a72fb3f0a086a3e9014953c51396b9f63">carma_wm::GeofenceType::DIGITAL_MINIMUM_GAP</a></div><div class="ttdeci">@ DIGITAL_MINIMUM_GAP</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacecarma__wm.html#ac09d7a77e6f8f955651e7afa16136bf1a269b80a3c3f0b44a73071e21d4ab36c2">carma_wm::CARMA_TRAFFIC_LIGHT</a>, <a class="el" href="namespacecarma__wm.html#ac09d7a77e6f8f955651e7afa16136bf1a72fb3f0a086a3e9014953c51396b9f63">carma_wm::DIGITAL_MINIMUM_GAP</a>, <a class="el" href="namespacecarma__wm.html#ac09d7a77e6f8f955651e7afa16136bf1a56a6787427d0254f508836bebdea7700">carma_wm::DIGITAL_SPEED_LIMIT</a>, <a class="el" href="namespacecarma__wm.html#ac09d7a77e6f8f955651e7afa16136bf1a165080307b64c43de1a0939d3bf047ae">carma_wm::DIRECTION_OF_TRAVEL</a>, <a class="el" href="namespacecarma__wm.html#ac09d7a77e6f8f955651e7afa16136bf1a0acb40e631b1fdde545715ce5080ce82">carma_wm::PASSING_CONTROL_LINE</a>, <a class="el" href="namespacecarma__wm.html#ac09d7a77e6f8f955651e7afa16136bf1a3342d8a1648c3c7b49348bdebb6a67d8">carma_wm::REGION_ACCESS_RULE</a>, <a class="el" href="WMListenerWorker_8cpp_source.html#l00031">carma_wm::resolveGeofenceType()</a>, <a class="el" href="namespacecarma__wm.html#ac09d7a77e6f8f955651e7afa16136bf1a5183fcbc60f37b81f9ca22d76af71867">carma_wm::SIGNALIZED_INTERSECTION</a>, <a class="el" href="namespacecarma__wm.html#ac09d7a77e6f8f955651e7afa16136bf1a3ef9e3ed7808c7c32a48e954fad71c04">carma_wm::STOP_RULE</a>, and <a class="el" href="WMListenerWorker_8hpp_source.html#l00145">world_model_</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMListenerWorker_8cpp_source.html#l00146">mapUpdateCallback()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm_1_1WMListenerWorker_a5cffb02708d8e8421ad56c4e7dd21b81_cgraph.png" border="0" usemap="#aclasscarma__wm_1_1WMListenerWorker_a5cffb02708d8e8421ad56c4e7dd21b81_cgraph" alt=""/></div>
<map name="aclasscarma__wm_1_1WMListenerWorker_a5cffb02708d8e8421ad56c4e7dd21b81_cgraph" id="aclasscarma__wm_1_1WMListenerWorker_a5cffb02708d8e8421ad56c4e7dd21b81_cgraph">
<area shape="rect" title="This is a helper function updates the parent_llt with specified regem. This function is needed as we ..." alt="" coords="5,5,208,47"/>
<area shape="rect" href="namespacecarma__wm.html#a4c3b7aaa05aea0c95189c98c5d902cf8" title=" " alt="" coords="256,13,475,39"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm_1_1WMListenerWorker_a5cffb02708d8e8421ad56c4e7dd21b81_icgraph.png" border="0" usemap="#aclasscarma__wm_1_1WMListenerWorker_a5cffb02708d8e8421ad56c4e7dd21b81_icgraph" alt=""/></div>
<map name="aclasscarma__wm_1_1WMListenerWorker_a5cffb02708d8e8421ad56c4e7dd21b81_icgraph" id="aclasscarma__wm_1_1WMListenerWorker_a5cffb02708d8e8421ad56c4e7dd21b81_icgraph">
<area shape="rect" title="This is a helper function updates the parent_llt with specified regem. This function is needed as we ..." alt="" coords="968,35,1171,76"/>
<area shape="rect" href="classcarma__wm_1_1WMListenerWorker.html#a3e2fb75fe96504aa76691cfecd5dd35f" title="Callback for new map update messages (geofence). Updates the underlying map." alt="" coords="717,35,920,76"/>
<area shape="rect" href="classcarma__wm_1_1WMListenerWorker.html#ad4490dd5c93ee3ade6e62d5e66dfc3c6" title="Callback for new map messages. Updates the underlying map." alt="" coords="216,5,419,47"/>
<area shape="rect" href="classcarma__wm_1_1WMListenerWorker.html#ad441355e4885986b80ebf067d8b704c0" title="Callback for route message." alt="" coords="467,64,669,105"/>
<area shape="rect" href="classcarma__wm_1_1WMListener.html#ae8f498999a2d8365543b153d7b536e38" title="Constructor which can be used to specify threading behavior of this class." alt="" coords="5,35,168,76"/>
</map>
</div>

</div>
</div>
<a id="a38932f2ab0756134602631ebbbd4d2a2" name="a38932f2ab0756134602631ebbbd4d2a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38932f2ab0756134602631ebbbd4d2a2">&#9670;&nbsp;</a></span>roadwayObjectListCallback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void carma_wm::WMListenerWorker::roadwayObjectListCallback </td>
          <td>(</td>
          <td class="paramtype">const carma_perception_msgs::msg::RoadwayObstacleList::UniquePtr&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Callback for roadway objects msg. </p>

<p class="definition">Definition at line <a class="el" href="WMListenerWorker_8cpp_source.html#l00572">572</a> of file <a class="el" href="WMListenerWorker_8cpp_source.html">WMListenerWorker.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  573</span>{</div>
<div class="line"><span class="lineno">  574</span>  <span class="comment">// this topic publishes only the objects that are on the road</span></div>
<div class="line"><span class="lineno">  575</span>  <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a4ea1ac169b8ba4a72dd72b4e8723257e">world_model_</a>-&gt;setRoadwayObjects(msg-&gt;roadway_obstacles);</div>
<div class="line"><span class="lineno">  576</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMListenerWorker_8hpp_source.html#l00145">world_model_</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMListener_8cpp_source.html#l00025">carma_wm::WMListener::WMListener()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm_1_1WMListenerWorker_a38932f2ab0756134602631ebbbd4d2a2_icgraph.png" border="0" usemap="#aclasscarma__wm_1_1WMListenerWorker_a38932f2ab0756134602631ebbbd4d2a2_icgraph" alt=""/></div>
<map name="aclasscarma__wm_1_1WMListenerWorker_a38932f2ab0756134602631ebbbd4d2a2_icgraph" id="aclasscarma__wm_1_1WMListenerWorker_a38932f2ab0756134602631ebbbd4d2a2_icgraph">
<area shape="rect" title="Callback for roadway objects msg." alt="" coords="216,5,419,47"/>
<area shape="rect" href="classcarma__wm_1_1WMListener.html#ae8f498999a2d8365543b153d7b536e38" title="Constructor which can be used to specify threading behavior of this class." alt="" coords="5,5,168,47"/>
</map>
</div>

</div>
</div>
<a id="ad441355e4885986b80ebf067d8b704c0" name="ad441355e4885986b80ebf067d8b704c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad441355e4885986b80ebf067d8b704c0">&#9670;&nbsp;</a></span>routeCallback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void carma_wm::WMListenerWorker::routeCallback </td>
          <td>(</td>
          <td class="paramtype">const carma_planning_msgs::msg::Route::UniquePtr&#160;</td>
          <td class="paramname"><em>route_msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Callback for route message. </p>

<p class="definition">Definition at line <a class="el" href="WMListenerWorker_8cpp_source.html#l00578">578</a> of file <a class="el" href="WMListenerWorker_8cpp_source.html">WMListenerWorker.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  579</span>{</div>
<div class="line"><span class="lineno">  580</span>  <span class="keywordflow">if</span> (route_msg-&gt;map_version &lt; <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#aae0b14b4566a06ba1c99e46e79de0fba">current_map_version_</a>) {</div>
<div class="line"><span class="lineno">  581</span>    RCLCPP_WARN_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm::WMListenerWorker&quot;</span>), <span class="stringliteral">&quot;Route message rejected as it is for an older map&quot;</span>);</div>
<div class="line"><span class="lineno">  582</span>    <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a310d6ebc20c42f055541025291337b57">rerouting_flag_</a> = <span class="keyword">false</span>; <span class="comment">// Clear any blockers on map updates as the route we were waiting for is no longer valid</span></div>
<div class="line"><span class="lineno">  583</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  584</span>  }</div>
<div class="line"><span class="lineno">  585</span> </div>
<div class="line"><span class="lineno">  586</span>  <span class="keywordflow">if</span> (route_msg-&gt;map_version &gt; <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#aae0b14b4566a06ba1c99e46e79de0fba">current_map_version_</a>) {</div>
<div class="line"><span class="lineno">  587</span>    RCLCPP_WARN_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm::WMListenerWorker&quot;</span>), <span class="stringliteral">&quot;Route message received for future map. Delaying application until map is recieved&quot;</span>);</div>
<div class="line"><span class="lineno">  588</span>    <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a295aefa7073627e0c645ab19ec123a73">delayed_route_msg_</a> = *route_msg;</div>
<div class="line"><span class="lineno">  589</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  590</span>  }</div>
<div class="line"><span class="lineno">  591</span> </div>
<div class="line"><span class="lineno">  592</span>  <span class="keywordtype">bool</span> route_invalidated_by_queued_map_update = <span class="keyword">false</span>; <span class="comment">// Flag to indicate whether this new route has been invalidated due to one of the applied queued map updates</span></div>
<div class="line"><span class="lineno">  593</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a310d6ebc20c42f055541025291337b57">rerouting_flag_</a>==<span class="keyword">true</span> &amp;&amp; route_msg-&gt;is_rerouted )</div>
<div class="line"><span class="lineno">  594</span> </div>
<div class="line"><span class="lineno">  595</span>  {</div>
<div class="line"><span class="lineno">  596</span> </div>
<div class="line"><span class="lineno">  597</span>    <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a310d6ebc20c42f055541025291337b57">rerouting_flag_</a> = <span class="keyword">false</span>; <span class="comment">// Reset flag since the route node has finished re-routing</span></div>
<div class="line"><span class="lineno">  598</span> </div>
<div class="line"><span class="lineno">  599</span>    <span class="comment">// After setting map evaluate the current update queue to apply any updates that arrived before the map</span></div>
<div class="line"><span class="lineno">  600</span>    <span class="keywordtype">bool</span> more_updates_to_apply = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  601</span>    <span class="keywordflow">while</span>(!<a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a7f06d6bbeae107d1f91bbf2cad94288f">map_update_queue_</a>.empty() &amp;&amp; more_updates_to_apply) {</div>
<div class="line"><span class="lineno">  602</span> </div>
<div class="line"><span class="lineno">  603</span>      <span class="keyword">auto</span> update = std::move(<a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a7f06d6bbeae107d1f91bbf2cad94288f">map_update_queue_</a>.front()); <span class="comment">// Get first update</span></div>
<div class="line"><span class="lineno">  604</span>      <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a7f06d6bbeae107d1f91bbf2cad94288f">map_update_queue_</a>.pop(); <span class="comment">// Remove update from queue     </span></div>
<div class="line"><span class="lineno">  605</span> </div>
<div class="line"><span class="lineno">  606</span>      <span class="keywordflow">if</span> (update-&gt;map_version &lt; <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#aae0b14b4566a06ba1c99e46e79de0fba">current_map_version_</a>) { <span class="comment">// Drop any so far unapplied updates for the current map</span></div>
<div class="line"><span class="lineno">  607</span>        RCLCPP_WARN_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm::WMListenerWorker&quot;</span>), <span class="stringliteral">&quot;Apply from reroute: There were unapplied updates in carma_wm when a new map was recieved.&quot;</span>);</div>
<div class="line"><span class="lineno">  608</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  609</span>      }</div>
<div class="line"><span class="lineno">  610</span>      <span class="keywordflow">if</span> (update-&gt;map_version == <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#aae0b14b4566a06ba1c99e46e79de0fba">current_map_version_</a>) { <span class="comment">// Current update goes with current map which is also the map used by this route</span></div>
<div class="line"><span class="lineno">  611</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm::WMListenerWorker&quot;</span>), <span class="stringliteral">&quot;Applying queued update after route was recieved. &quot;</span>);</div>
<div class="line"><span class="lineno">  612</span> </div>
<div class="line"><span class="lineno">  613</span>        <span class="keywordflow">if</span> (update-&gt;invalidates_route == <span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno">  614</span>          RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm::WMListenerWorker&quot;</span>), <span class="stringliteral">&quot;Applied queued map update has invalidated the route.&quot;</span>);</div>
<div class="line"><span class="lineno">  615</span>          route_invalidated_by_queued_map_update = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  616</span>        }</div>
<div class="line"><span class="lineno">  617</span> </div>
<div class="line"><span class="lineno">  618</span>        update-&gt;invalidates_route=<span class="keyword">false</span>; <span class="comment">// Do not trigger recomputation of routing graph in mapUpdateCallback; recomputation of routing graph will occur outside of this loop</span></div>
<div class="line"><span class="lineno">  619</span> </div>
<div class="line"><span class="lineno">  620</span>        <a class="code hl_function" href="classcarma__wm_1_1WMListenerWorker.html#a3e2fb75fe96504aa76691cfecd5dd35f">mapUpdateCallback</a>(std::move(update)); <span class="comment">// Apply the update</span></div>
<div class="line"><span class="lineno">  621</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  622</span>        RCLCPP_INFO_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm::WMListenerWorker&quot;</span>), <span class="stringliteral">&quot;Apply from reroute: Done applying updates for new map. However, more updates are waiting for a future map.&quot;</span>);</div>
<div class="line"><span class="lineno">  623</span>        more_updates_to_apply = <span class="keyword">false</span>; <span class="comment">// If there is more updates queued that are not for this map version assume they are for a future map version</span></div>
<div class="line"><span class="lineno">  624</span>      }</div>
<div class="line"><span class="lineno">  625</span> </div>
<div class="line"><span class="lineno">  626</span>    }</div>
<div class="line"><span class="lineno">  627</span> </div>
<div class="line"><span class="lineno">  628</span>  }</div>
<div class="line"><span class="lineno">  629</span> </div>
<div class="line"><span class="lineno">  630</span>  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a4ea1ac169b8ba4a72dd72b4e8723257e">world_model_</a>-&gt;getMap()) { <span class="comment">// This check is a bit redundant but still useful from a debugging perspective as the alternative is a segfault</span></div>
<div class="line"><span class="lineno">  631</span>    RCLCPP_ERROR_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm::WMListenerWorker&quot;</span>), <span class="stringliteral">&quot;WMListener received a route before a map was available. Dropping route message.&quot;</span>);</div>
<div class="line"><span class="lineno">  632</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  633</span>  }</div>
<div class="line"><span class="lineno">  634</span> </div>
<div class="line"><span class="lineno">  635</span>  <span class="comment">// If one of the applied queued map updates invalidated the route, then the routing graph must be updated again for the route node</span></div>
<div class="line"><span class="lineno">  636</span>  <span class="keywordflow">if</span> (route_invalidated_by_queued_map_update &amp;&amp; <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a39cbf05af713a84fb396c36da3551df5">route_node_flag_</a>){</div>
<div class="line"><span class="lineno">  637</span>    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm::WMListenerWorker&quot;</span>),<span class="stringliteral">&quot;At least one applied queued map update has invalidated the route. Routing graph will be recomputed.&quot;</span>);</div>
<div class="line"><span class="lineno">  638</span>    <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a4ea1ac169b8ba4a72dd72b4e8723257e">world_model_</a>-&gt;setMap(<a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a4ea1ac169b8ba4a72dd72b4e8723257e">world_model_</a>-&gt;getMutableMap(), <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#aae0b14b4566a06ba1c99e46e79de0fba">current_map_version_</a>, route_invalidated_by_queued_map_update);</div>
<div class="line"><span class="lineno">  639</span>    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm::WMListenerWorker&quot;</span>),<span class="stringliteral">&quot;Finished recomputing the routing graph for the applied queued map update(s)&quot;</span>);</div>
<div class="line"><span class="lineno">  640</span> </div>
<div class="line"><span class="lineno">  641</span>    <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a310d6ebc20c42f055541025291337b57">rerouting_flag_</a> = <span class="keyword">true</span>; <span class="comment">// Set flag to trigger a route update by the route node due to the updated routing graph</span></div>
<div class="line"><span class="lineno">  642</span> </div>
<div class="line"><span class="lineno">  643</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  644</span>  }</div>
<div class="line"><span class="lineno">  645</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  646</span>    <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a310d6ebc20c42f055541025291337b57">rerouting_flag_</a> = <span class="keyword">false</span>; <span class="comment">// Reset flag since no applied queued map updates invalidated the route for the route node</span></div>
<div class="line"><span class="lineno">  647</span> </div>
<div class="line"><span class="lineno">  648</span>    <span class="keyword">auto</span> path = lanelet::ConstLanelets();</div>
<div class="line"><span class="lineno">  649</span>    <span class="keywordflow">for</span>(<span class="keyword">auto</span> <span class="keywordtype">id</span> : route_msg-&gt;shortest_path_lanelet_ids)</div>
<div class="line"><span class="lineno">  650</span>    {</div>
<div class="line"><span class="lineno">  651</span>      <span class="keyword">auto</span> ll = <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a4ea1ac169b8ba4a72dd72b4e8723257e">world_model_</a>-&gt;getMap()-&gt;laneletLayer.get(<span class="keywordtype">id</span>);</div>
<div class="line"><span class="lineno">  652</span>      path.push_back(ll);</div>
<div class="line"><span class="lineno">  653</span>    }</div>
<div class="line"><span class="lineno">  654</span> </div>
<div class="line"><span class="lineno">  655</span>    <span class="keyword">auto</span> route_opt = path.size() == 1 ? <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a4ea1ac169b8ba4a72dd72b4e8723257e">world_model_</a>-&gt;getMapRoutingGraph()-&gt;getRoute(path.front(), path.back())</div>
<div class="line"><span class="lineno">  656</span>                                : <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a4ea1ac169b8ba4a72dd72b4e8723257e">world_model_</a>-&gt;getMapRoutingGraph()-&gt;getRouteVia(path.front(), lanelet::ConstLanelets(path.begin() + 1, path.end() - 1), path.back());</div>
<div class="line"><span class="lineno">  657</span>    <span class="keywordflow">if</span>(route_opt.is_initialized()) {</div>
<div class="line"><span class="lineno">  658</span>      RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm::WMListenerWorker&quot;</span>), <span class="stringliteral">&quot;Setting route in world model&quot;</span>);</div>
<div class="line"><span class="lineno">  659</span>      <span class="keyword">auto</span> ptr = std::make_shared&lt;lanelet::routing::Route&gt;(std::move(route_opt.get()));</div>
<div class="line"><span class="lineno">  660</span>      <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a4ea1ac169b8ba4a72dd72b4e8723257e">world_model_</a>-&gt;setRoute(ptr);</div>
<div class="line"><span class="lineno">  661</span>    }</div>
<div class="line"><span class="lineno">  662</span> </div>
<div class="line"><span class="lineno">  663</span>    <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a4ea1ac169b8ba4a72dd72b4e8723257e">world_model_</a>-&gt;setRouteEndPoint({route_msg-&gt;end_point.x,route_msg-&gt;end_point.y,route_msg-&gt;end_point.z});</div>
<div class="line"><span class="lineno">  664</span>    <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a4ea1ac169b8ba4a72dd72b4e8723257e">world_model_</a>-&gt;setRouteName(route_msg-&gt;route_name);</div>
<div class="line"><span class="lineno">  665</span> </div>
<div class="line"><span class="lineno">  666</span>    <span class="comment">// Call route_callback_</span></div>
<div class="line"><span class="lineno">  667</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a8a81ac013a5e920b47e6c12d338446cc">route_callback_</a>)</div>
<div class="line"><span class="lineno">  668</span>    {</div>
<div class="line"><span class="lineno">  669</span>      <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a8a81ac013a5e920b47e6c12d338446cc">route_callback_</a>();</div>
<div class="line"><span class="lineno">  670</span>    }</div>
<div class="line"><span class="lineno">  671</span> </div>
<div class="line"><span class="lineno">  672</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  673</span>  }</div>
<div class="line"><span class="lineno">  674</span>}</div>
<div class="ttc" id="aclasscarma__wm_1_1WMListenerWorker_html_a8a81ac013a5e920b47e6c12d338446cc"><div class="ttname"><a href="classcarma__wm_1_1WMListenerWorker.html#a8a81ac013a5e920b47e6c12d338446cc">carma_wm::WMListenerWorker::route_callback_</a></div><div class="ttdeci">std::function&lt; void()&gt; route_callback_</div><div class="ttdef"><b>Definition:</b> <a href="WMListenerWorker_8hpp_source.html#l00148">WMListenerWorker.hpp:148</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMListenerWorker_8hpp_source.html#l00152">current_map_version_</a>, <a class="el" href="WMListenerWorker_8hpp_source.html#l00154">delayed_route_msg_</a>, <a class="el" href="WMListenerWorker_8hpp_source.html#l00153">map_update_queue_</a>, <a class="el" href="WMListenerWorker_8cpp_source.html#l00146">mapUpdateCallback()</a>, <a class="el" href="WMListenerWorker_8hpp_source.html#l00157">rerouting_flag_</a>, <a class="el" href="WMListenerWorker_8hpp_source.html#l00148">route_callback_</a>, <a class="el" href="WMListenerWorker_8hpp_source.html#l00158">route_node_flag_</a>, and <a class="el" href="WMListenerWorker_8hpp_source.html#l00145">world_model_</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMListener_8cpp_source.html#l00025">carma_wm::WMListener::WMListener()</a>, and <a class="el" href="WMListenerWorker_8cpp_source.html#l00056">mapCallback()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm_1_1WMListenerWorker_ad441355e4885986b80ebf067d8b704c0_cgraph.png" border="0" usemap="#aclasscarma__wm_1_1WMListenerWorker_ad441355e4885986b80ebf067d8b704c0_cgraph" alt=""/></div>
<map name="aclasscarma__wm_1_1WMListenerWorker_ad441355e4885986b80ebf067d8b704c0_cgraph" id="aclasscarma__wm_1_1WMListenerWorker_ad441355e4885986b80ebf067d8b704c0_cgraph">
<area shape="rect" title="Callback for route message." alt="" coords="5,90,208,131"/>
<area shape="rect" href="classcarma__wm_1_1WMListenerWorker.html#a3e2fb75fe96504aa76691cfecd5dd35f" title="Callback for new map update messages (geofence). Updates the underlying map." alt="" coords="256,90,459,131"/>
<area shape="rect" href="namespacecarma__wm.html#a3c6c82d3e0fcfc7dd50176a453598911" title=" " alt="" coords="543,5,706,32"/>
<area shape="rect" href="namespacecarma__wm.html#aae8a9e16b161a8edf05ca9df4307a5ec" title=" " alt="" coords="507,57,743,98"/>
<area shape="rect" href="classcarma__wm_1_1WMListenerWorker.html#a5cffb02708d8e8421ad56c4e7dd21b81" title="This is a helper function updates the parent_llt with specified regem. This function is needed as we ..." alt="" coords="523,122,726,163"/>
<area shape="rect" href="classcarma__wm_1_1WMListenerWorker.html#a614654b7b374ed1d24537e347d49389f" title="Helper function to convert a routing graph message into a actual RoutingGraph object." alt="" coords="523,187,726,229"/>
<area shape="rect" href="namespacecarma__wm.html#a4c3b7aaa05aea0c95189c98c5d902cf8" title=" " alt="" coords="791,129,1009,156"/>
<area shape="rect" href="classcarma__wm_1_1WMListenerWorker.html#ac0c115081f19ec29b215e6edeb110d4c" title="Returns the Vehicle Participation Type value." alt="" coords="799,187,1001,229"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm_1_1WMListenerWorker_ad441355e4885986b80ebf067d8b704c0_icgraph.png" border="0" usemap="#aclasscarma__wm_1_1WMListenerWorker_ad441355e4885986b80ebf067d8b704c0_icgraph" alt=""/></div>
<map name="aclasscarma__wm_1_1WMListenerWorker_ad441355e4885986b80ebf067d8b704c0_icgraph" id="aclasscarma__wm_1_1WMListenerWorker_ad441355e4885986b80ebf067d8b704c0_icgraph">
<area shape="rect" title="Callback for route message." alt="" coords="467,5,669,47"/>
<area shape="rect" href="classcarma__wm_1_1WMListener.html#ae8f498999a2d8365543b153d7b536e38" title="Constructor which can be used to specify threading behavior of this class." alt="" coords="5,5,168,47"/>
<area shape="rect" href="classcarma__wm_1_1WMListenerWorker.html#ad4490dd5c93ee3ade6e62d5e66dfc3c6" title="Callback for new map messages. Updates the underlying map." alt="" coords="216,35,419,76"/>
</map>
</div>

</div>
</div>
<a id="a614654b7b374ed1d24537e347d49389f" name="a614654b7b374ed1d24537e347d49389f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a614654b7b374ed1d24537e347d49389f">&#9670;&nbsp;</a></span>routingGraphFromMsg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacecarma__wm.html#a23411d3d299da623ec379efbc1a5b14a">LaneletRoutingGraphPtr</a> carma_wm::WMListenerWorker::routingGraphFromMsg </td>
          <td>(</td>
          <td class="paramtype">const autoware_lanelet2_msgs::msg::RoutingGraph &amp;&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">lanelet::LaneletMapPtr&#160;</td>
          <td class="paramname"><em>map</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Helper function to convert a routing graph message into a actual RoutingGraph object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>The graph message to convert </td></tr>
    <tr><td class="paramname">map</td><td>The base map this graph applies to</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>nullptr if the graph could not be constructed or the provided graph does not match the map </dd></dl>

<p class="definition">Definition at line <a class="el" href="WMListenerWorker_8cpp_source.html#l00448">448</a> of file <a class="el" href="WMListenerWorker_8cpp_source.html">WMListenerWorker.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  448</span>                                                                                                                                             {</div>
<div class="line"><span class="lineno">  449</span> </div>
<div class="line"><span class="lineno">  450</span>  <span class="keywordflow">if</span> (msg.participant_type.compare(<a class="code hl_function" href="classcarma__wm_1_1WMListenerWorker.html#ac0c115081f19ec29b215e6edeb110d4c">getVehicleParticipationType</a>()) != 0) {</div>
<div class="line"><span class="lineno">  451</span> </div>
<div class="line"><span class="lineno">  452</span>    RCLCPP_ERROR_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm::WMListenerWorker&quot;</span>),<span class="stringliteral">&quot;Received routing graph does not have matching vehicle type for world model. WM Type: &quot;</span> </div>
<div class="line"><span class="lineno">  453</span>      &lt;&lt; <a class="code hl_function" href="classcarma__wm_1_1WMListenerWorker.html#ac0c115081f19ec29b215e6edeb110d4c">getVehicleParticipationType</a>() </div>
<div class="line"><span class="lineno">  454</span>      &lt;&lt; <span class="stringliteral">&quot; graph type: &quot;</span> &lt;&lt; msg.participant_type</div>
<div class="line"><span class="lineno">  455</span>    );</div>
<div class="line"><span class="lineno">  456</span> </div>
<div class="line"><span class="lineno">  457</span>    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  458</span>  }</div>
<div class="line"><span class="lineno">  459</span> </div>
<div class="line"><span class="lineno">  460</span>  <span class="comment">// Get the lists of passable lanelets and areas</span></div>
<div class="line"><span class="lineno">  461</span>  <span class="comment">// Both these lists must be populated in the same order as the message to support later logic</span></div>
<div class="line"><span class="lineno">  462</span>  lanelet::ConstLanelets passable_lanelets;</div>
<div class="line"><span class="lineno">  463</span>  lanelet::ConstAreas passable_areas;</div>
<div class="line"><span class="lineno">  464</span> </div>
<div class="line"><span class="lineno">  465</span>  passable_lanelets.reserve(msg.lanelet_vertices.size());</div>
<div class="line"><span class="lineno">  466</span>  passable_areas.reserve(msg.area_vertices.size());</div>
<div class="line"><span class="lineno">  467</span> </div>
<div class="line"><span class="lineno">  468</span>  <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  469</span> </div>
<div class="line"><span class="lineno">  470</span>    <span class="comment">// All the passable lanelets and areas should be included as a vertext so just iterate over each and store</span></div>
<div class="line"><span class="lineno">  471</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> vertex : msg.lanelet_vertices) {</div>
<div class="line"><span class="lineno">  472</span>      passable_lanelets.emplace_back(map-&gt;laneletLayer.get(vertex.lanelet_or_area));</div>
<div class="line"><span class="lineno">  473</span>    }</div>
<div class="line"><span class="lineno">  474</span> </div>
<div class="line"><span class="lineno">  475</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> vertex : msg.area_vertices) {</div>
<div class="line"><span class="lineno">  476</span>      passable_areas.emplace_back(map-&gt;areaLayer.get(vertex.lanelet_or_area));</div>
<div class="line"><span class="lineno">  477</span>    }</div>
<div class="line"><span class="lineno">  478</span> </div>
<div class="line"><span class="lineno">  479</span>  } <span class="keywordflow">catch</span>(<span class="keyword">const</span> lanelet::NoSuchPrimitiveError&amp; e) {</div>
<div class="line"><span class="lineno">  480</span> </div>
<div class="line"><span class="lineno">  481</span>    RCLCPP_ERROR_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm::WMListenerWorker&quot;</span>), <span class="stringliteral">&quot;Received routing graph specifies lanelets which do not match the current map version. Actual exception: &quot;</span> &lt;&lt; e.what());</div>
<div class="line"><span class="lineno">  482</span> </div>
<div class="line"><span class="lineno">  483</span>    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  484</span>  }</div>
<div class="line"><span class="lineno">  485</span> </div>
<div class="line"><span class="lineno">  486</span> </div>
<div class="line"><span class="lineno">  487</span>  <span class="comment">// Build the submap</span></div>
<div class="line"><span class="lineno">  488</span>  <span class="comment">// This operation does increase in time as the number of lanelets and areas increase</span></div>
<div class="line"><span class="lineno">  489</span>  <span class="comment">// however testing shows it to less than 1% of the total routing graph build time so this is a reasonable operation to keep</span></div>
<div class="line"><span class="lineno">  490</span>  <span class="keyword">auto</span> passable_map = lanelet::utils::createConstSubmap(passable_lanelets, passable_areas);</div>
<div class="line"><span class="lineno">  491</span> </div>
<div class="line"><span class="lineno">  492</span>  <span class="comment">// This is the actual graph object which is used to initialize a RoutingGraph</span></div>
<div class="line"><span class="lineno">  493</span>  <span class="keyword">auto</span> graph = std::make_unique&lt;lanelet::routing::internal::RoutingGraphGraph&gt;(msg.num_unique_routing_cost_ids);</div>
<div class="line"><span class="lineno">  494</span> </div>
<div class="line"><span class="lineno">  495</span>  <span class="comment">// Vertex must be added first then the edge can be added</span></div>
<div class="line"><span class="lineno">  496</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> ll : passable_lanelets) {</div>
<div class="line"><span class="lineno">  497</span>    graph-&gt;addVertex(lanelet::routing::internal::VertexInfo{ll});</div>
<div class="line"><span class="lineno">  498</span>  }</div>
<div class="line"><span class="lineno">  499</span> </div>
<div class="line"><span class="lineno">  500</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> area : passable_areas) {</div>
<div class="line"><span class="lineno">  501</span>    graph-&gt;addVertex(lanelet::routing::internal::VertexInfo{area});</div>
<div class="line"><span class="lineno">  502</span>  }</div>
<div class="line"><span class="lineno">  503</span> </div>
<div class="line"><span class="lineno">  504</span>  <span class="comment">// Now we can add edges</span></div>
<div class="line"><span class="lineno">  505</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> = 0; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> &lt; msg.lanelet_vertices.size(); ++<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>) {</div>
<div class="line"><span class="lineno">  506</span> </div>
<div class="line"><span class="lineno">  507</span>    <span class="keyword">auto</span> vertex = msg.lanelet_vertices[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>];</div>
<div class="line"><span class="lineno">  508</span>    <span class="keyword">auto</span> <a class="code hl_namespace" href="namespacelanelet.html">lanelet</a> = passable_lanelets[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>]; <span class="comment">// passable_lanelets should be in the same order based on how its constructed</span></div>
<div class="line"><span class="lineno">  509</span> </div>
<div class="line"><span class="lineno">  510</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; vertex.lanelet_or_area_ids.size(); ++j) {</div>
<div class="line"><span class="lineno">  511</span> </div>
<div class="line"><span class="lineno">  512</span>      lanelet::routing::RelationType relation;</div>
<div class="line"><span class="lineno">  513</span> </div>
<div class="line"><span class="lineno">  514</span>      <span class="comment">// Get relation</span></div>
<div class="line"><span class="lineno">  515</span>      <span class="keywordflow">switch</span> (vertex.edge_relations[j])</div>
<div class="line"><span class="lineno">  516</span>      {</div>
<div class="line"><span class="lineno">  517</span>        <span class="keywordflow">case</span> autoware_lanelet2_msgs::msg::RoutingGraphVertexAndEdges::RELATION_SUCCESSOR:</div>
<div class="line"><span class="lineno">  518</span>          relation = lanelet::routing::RelationType::Successor; <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  519</span> </div>
<div class="line"><span class="lineno">  520</span>        <span class="keywordflow">case</span> autoware_lanelet2_msgs::msg::RoutingGraphVertexAndEdges::RELATION_LEFT:</div>
<div class="line"><span class="lineno">  521</span>          relation = <a class="code hl_enumvalue" href="namespacesci__strategic__plugin.html#a566a001705be58d1fa9b8b13ba6e3677a0614364ce8a300e7a392919c4753d8a8">lanelet::routing::RelationType::Left</a>; <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  522</span> </div>
<div class="line"><span class="lineno">  523</span>        <span class="keywordflow">case</span> autoware_lanelet2_msgs::msg::RoutingGraphVertexAndEdges::RELATION_RIGHT:</div>
<div class="line"><span class="lineno">  524</span>          relation = <a class="code hl_enumvalue" href="namespacesci__strategic__plugin.html#a566a001705be58d1fa9b8b13ba6e3677ae56f9187e18e7976a4565df987d0962e">lanelet::routing::RelationType::Right</a>; <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  525</span> </div>
<div class="line"><span class="lineno">  526</span>        <span class="keywordflow">case</span> autoware_lanelet2_msgs::msg::RoutingGraphVertexAndEdges::RELATION_ADJACENT_LEFT:</div>
<div class="line"><span class="lineno">  527</span>          relation = lanelet::routing::RelationType::AdjacentLeft; <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  528</span> </div>
<div class="line"><span class="lineno">  529</span>        <span class="keywordflow">case</span> autoware_lanelet2_msgs::msg::RoutingGraphVertexAndEdges::RELATION_ADJACENT_RIGHT:</div>
<div class="line"><span class="lineno">  530</span>          relation = lanelet::routing::RelationType::AdjacentRight; <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  531</span> </div>
<div class="line"><span class="lineno">  532</span>        <span class="keywordflow">case</span> autoware_lanelet2_msgs::msg::RoutingGraphVertexAndEdges::RELATION_CONFLICTING:</div>
<div class="line"><span class="lineno">  533</span>          relation = lanelet::routing::RelationType::Conflicting; <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  534</span> </div>
<div class="line"><span class="lineno">  535</span>        <span class="keywordflow">case</span> autoware_lanelet2_msgs::msg::RoutingGraphVertexAndEdges::RELATION_AREA:</div>
<div class="line"><span class="lineno">  536</span>          relation = lanelet::routing::RelationType::Area; <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  537</span> </div>
<div class="line"><span class="lineno">  538</span>        <span class="keywordflow">default</span>: <span class="comment">// Treat default as RELATION_NONE</span></div>
<div class="line"><span class="lineno">  539</span>          relation = lanelet::routing::RelationType::None; <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  540</span>      }</div>
<div class="line"><span class="lineno">  541</span> </div>
<div class="line"><span class="lineno">  542</span>      <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  543</span> </div>
<div class="line"><span class="lineno">  544</span>        <span class="comment">// Create edge</span></div>
<div class="line"><span class="lineno">  545</span>        graph-&gt;addEdge(</div>
<div class="line"><span class="lineno">  546</span>          <a class="code hl_namespace" href="namespacelanelet.html">lanelet</a>, </div>
<div class="line"><span class="lineno">  547</span>          map-&gt;laneletLayer.get(vertex.lanelet_or_area_ids[j]), </div>
<div class="line"><span class="lineno">  548</span>          lanelet::routing::internal::EdgeInfo{vertex.edge_routing_costs[j], vertex.edge_routing_cost_source_ids[j], relation}</div>
<div class="line"><span class="lineno">  549</span>        );</div>
<div class="line"><span class="lineno">  550</span> </div>
<div class="line"><span class="lineno">  551</span>      }  <span class="keywordflow">catch</span>(<span class="keyword">const</span> lanelet::NoSuchPrimitiveError&amp; e) {</div>
<div class="line"><span class="lineno">  552</span> </div>
<div class="line"><span class="lineno">  553</span>        RCLCPP_ERROR_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm::WMListenerWorker&quot;</span>),<span class="stringliteral">&quot;Received routing graph specifies lanelets which do not match the current map version. Not found lanelet or area: &quot;</span> </div>
<div class="line"><span class="lineno">  554</span>          &lt;&lt; vertex.lanelet_or_area_ids[j] &lt;&lt; <span class="stringliteral">&quot; Actual exception: &quot;</span> &lt;&lt; e.what());</div>
<div class="line"><span class="lineno">  555</span> </div>
<div class="line"><span class="lineno">  556</span>        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  557</span>      }</div>
<div class="line"><span class="lineno">  558</span> </div>
<div class="line"><span class="lineno">  559</span>    }</div>
<div class="line"><span class="lineno">  560</span>  }</div>
<div class="line"><span class="lineno">  561</span> </div>
<div class="line"><span class="lineno">  562</span>  <span class="comment">// Build and return the final initialized routing graph</span></div>
<div class="line"><span class="lineno">  563</span>  <span class="keywordflow">return</span> std::make_shared&lt;lanelet::routing::RoutingGraph&gt;(std::move(graph), std::move(passable_map));</div>
<div class="line"><span class="lineno">  564</span> </div>
<div class="line"><span class="lineno">  565</span>}</div>
<div class="ttc" id="aclasscarma__wm_1_1WMListenerWorker_html_ac0c115081f19ec29b215e6edeb110d4c"><div class="ttname"><a href="classcarma__wm_1_1WMListenerWorker.html#ac0c115081f19ec29b215e6edeb110d4c">carma_wm::WMListenerWorker::getVehicleParticipationType</a></div><div class="ttdeci">std::string getVehicleParticipationType() const</div><div class="ttdoc">Returns the Vehicle Participation Type value.</div><div class="ttdef"><b>Definition:</b> <a href="WMListenerWorker_8cpp_source.html#l00567">WMListenerWorker.cpp:567</a></div></div>
<div class="ttc" id="anamespacelanelet_html"><div class="ttname"><a href="namespacelanelet.html">lanelet</a></div><div class="ttdef"><b>Definition:</b> <a href="MapConformer_8hpp_source.html#l00038">MapConformer.hpp:39</a></div></div>
<div class="ttc" id="anamespacesci__strategic__plugin_html_a566a001705be58d1fa9b8b13ba6e3677a0614364ce8a300e7a392919c4753d8a8"><div class="ttname"><a href="namespacesci__strategic__plugin.html#a566a001705be58d1fa9b8b13ba6e3677a0614364ce8a300e7a392919c4753d8a8">sci_strategic_plugin::Left</a></div><div class="ttdeci">@ Left</div><div class="ttdef"><b>Definition:</b> <a href="sci__strategic__plugin_8hpp_source.html#l00046">sci_strategic_plugin.hpp:45</a></div></div>
<div class="ttc" id="anamespacesci__strategic__plugin_html_a566a001705be58d1fa9b8b13ba6e3677ae56f9187e18e7976a4565df987d0962e"><div class="ttname"><a href="namespacesci__strategic__plugin.html#a566a001705be58d1fa9b8b13ba6e3677ae56f9187e18e7976a4565df987d0962e">sci_strategic_plugin::Right</a></div><div class="ttdeci">@ Right</div><div class="ttdef"><b>Definition:</b> <a href="sci__strategic__plugin_8hpp_source.html#l00044">sci_strategic_plugin.hpp:44</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMListenerWorker_8cpp_source.html#l00567">getVehicleParticipationType()</a>, <a class="el" href="process__bag_8py_source.html#l00059">process_bag::i</a>, <a class="el" href="sci__strategic__plugin_8hpp_source.html#l00045">sci_strategic_plugin::Left</a>, and <a class="el" href="sci__strategic__plugin_8hpp_source.html#l00044">sci_strategic_plugin::Right</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMListenerWorker_8cpp_source.html#l00146">mapUpdateCallback()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm_1_1WMListenerWorker_a614654b7b374ed1d24537e347d49389f_cgraph.png" border="0" usemap="#aclasscarma__wm_1_1WMListenerWorker_a614654b7b374ed1d24537e347d49389f_cgraph" alt=""/></div>
<map name="aclasscarma__wm_1_1WMListenerWorker_a614654b7b374ed1d24537e347d49389f_cgraph" id="aclasscarma__wm_1_1WMListenerWorker_a614654b7b374ed1d24537e347d49389f_cgraph">
<area shape="rect" title="Helper function to convert a routing graph message into a actual RoutingGraph object." alt="" coords="5,5,208,47"/>
<area shape="rect" href="classcarma__wm_1_1WMListenerWorker.html#ac0c115081f19ec29b215e6edeb110d4c" title="Returns the Vehicle Participation Type value." alt="" coords="256,5,459,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm_1_1WMListenerWorker_a614654b7b374ed1d24537e347d49389f_icgraph.png" border="0" usemap="#aclasscarma__wm_1_1WMListenerWorker_a614654b7b374ed1d24537e347d49389f_icgraph" alt=""/></div>
<map name="aclasscarma__wm_1_1WMListenerWorker_a614654b7b374ed1d24537e347d49389f_icgraph" id="aclasscarma__wm_1_1WMListenerWorker_a614654b7b374ed1d24537e347d49389f_icgraph">
<area shape="rect" title="Helper function to convert a routing graph message into a actual RoutingGraph object." alt="" coords="968,35,1171,76"/>
<area shape="rect" href="classcarma__wm_1_1WMListenerWorker.html#a3e2fb75fe96504aa76691cfecd5dd35f" title="Callback for new map update messages (geofence). Updates the underlying map." alt="" coords="717,35,920,76"/>
<area shape="rect" href="classcarma__wm_1_1WMListenerWorker.html#ad4490dd5c93ee3ade6e62d5e66dfc3c6" title="Callback for new map messages. Updates the underlying map." alt="" coords="216,5,419,47"/>
<area shape="rect" href="classcarma__wm_1_1WMListenerWorker.html#ad441355e4885986b80ebf067d8b704c0" title="Callback for route message." alt="" coords="467,64,669,105"/>
<area shape="rect" href="classcarma__wm_1_1WMListener.html#ae8f498999a2d8365543b153d7b536e38" title="Constructor which can be used to specify threading behavior of this class." alt="" coords="5,35,168,76"/>
</map>
</div>

</div>
</div>
<a id="a32f22fd00a2f0fff3690d5f0b4ff2eb5" name="a32f22fd00a2f0fff3690d5f0b4ff2eb5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a32f22fd00a2f0fff3690d5f0b4ff2eb5">&#9670;&nbsp;</a></span>setConfigSpeedLimit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void carma_wm::WMListenerWorker::setConfigSpeedLimit </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>config_lim</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allows user to set a callback to be triggered when a map update is received. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">config_lim</td><td>A callback function that will be triggered after the world model receives a new map update </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="WMListenerWorker_8cpp_source.html#l00686">686</a> of file <a class="el" href="WMListenerWorker_8cpp_source.html">WMListenerWorker.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  687</span>{</div>
<div class="line"><span class="lineno">  688</span>  <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a84466a412323d469f5a53bbd9fbcaf6d">config_speed_limit_</a> = config_lim;</div>
<div class="line"><span class="lineno">  689</span>  <span class="comment">//Function to load config_limit into CarmaWorldModel</span></div>
<div class="line"><span class="lineno">  690</span>   <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a4ea1ac169b8ba4a72dd72b4e8723257e">world_model_</a>-&gt;setConfigSpeedLimit(<a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a84466a412323d469f5a53bbd9fbcaf6d">config_speed_limit_</a>);</div>
<div class="line"><span class="lineno">  691</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMListenerWorker_8hpp_source.html#l00150">config_speed_limit_</a>, and <a class="el" href="WMListenerWorker_8hpp_source.html#l00145">world_model_</a>.</p>

</div>
</div>
<a id="a6e8ee5810146dbad79df2a2424e8b2d7" name="a6e8ee5810146dbad79df2a2424e8b2d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e8ee5810146dbad79df2a2424e8b2d7">&#9670;&nbsp;</a></span>setMapCallback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void carma_wm::WMListenerWorker::setMapCallback </td>
          <td>(</td>
          <td class="paramtype">std::function&lt; void()&gt;&#160;</td>
          <td class="paramname"><em>callback</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allows user to set a callback to be triggered when a map update is received. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">callback</td><td>A callback function that will be triggered after the world model receives a new map update </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="WMListenerWorker_8cpp_source.html#l00676">676</a> of file <a class="el" href="WMListenerWorker_8cpp_source.html">WMListenerWorker.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  677</span>{</div>
<div class="line"><span class="lineno">  678</span>  <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a3c2e638e8fdc934482ba9076a5ca7bb5">map_callback_</a> = <a class="code hl_function" href="helper_8cpp.html#ac0f7f7ec5375e47d4c681359431356b9">callback</a>;</div>
<div class="line"><span class="lineno">  679</span>}</div>
<div class="ttc" id="ahelper_8cpp_html_ac0f7f7ec5375e47d4c681359431356b9"><div class="ttname"><a href="helper_8cpp.html#ac0f7f7ec5375e47d4c681359431356b9">callback</a></div><div class="ttdeci">bool callback(cav_srvs::PlanTrajectory::Request &amp;req, cav_srvs::PlanTrajectory::Response &amp;res)</div><div class="ttdef"><b>Definition:</b> <a href="helper_8cpp_source.html#l00021">helper.cpp:21</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="helper_8cpp_source.html#l00021">callback()</a>, and <a class="el" href="WMListenerWorker_8hpp_source.html#l00147">map_callback_</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm_1_1WMListenerWorker_a6e8ee5810146dbad79df2a2424e8b2d7_cgraph.png" border="0" usemap="#aclasscarma__wm_1_1WMListenerWorker_a6e8ee5810146dbad79df2a2424e8b2d7_cgraph" alt=""/></div>
<map name="aclasscarma__wm_1_1WMListenerWorker_a6e8ee5810146dbad79df2a2424e8b2d7_cgraph" id="aclasscarma__wm_1_1WMListenerWorker_a6e8ee5810146dbad79df2a2424e8b2d7_cgraph">
<area shape="rect" title="Allows user to set a callback to be triggered when a map update is received." alt="" coords="5,5,208,47"/>
<area shape="rect" href="helper_8cpp.html#ac0f7f7ec5375e47d4c681359431356b9" title=" " alt="" coords="256,13,327,39"/>
</map>
</div>

</div>
</div>
<a id="a531f3557b64b85c4cd3a068ba7094a2d" name="a531f3557b64b85c4cd3a068ba7094a2d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a531f3557b64b85c4cd3a068ba7094a2d">&#9670;&nbsp;</a></span>setRouteCallback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void carma_wm::WMListenerWorker::setRouteCallback </td>
          <td>(</td>
          <td class="paramtype">std::function&lt; void()&gt;&#160;</td>
          <td class="paramname"><em>callback</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allows user to set a callback to be triggered when a route update is received. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">callback</td><td>A callback function that will be triggered after the world model is updated with a new route </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="WMListenerWorker_8cpp_source.html#l00681">681</a> of file <a class="el" href="WMListenerWorker_8cpp_source.html">WMListenerWorker.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  682</span>{</div>
<div class="line"><span class="lineno">  683</span>  <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a8a81ac013a5e920b47e6c12d338446cc">route_callback_</a> = <a class="code hl_function" href="helper_8cpp.html#ac0f7f7ec5375e47d4c681359431356b9">callback</a>;</div>
<div class="line"><span class="lineno">  684</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="helper_8cpp_source.html#l00021">callback()</a>, and <a class="el" href="WMListenerWorker_8hpp_source.html#l00148">route_callback_</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm_1_1WMListenerWorker_a531f3557b64b85c4cd3a068ba7094a2d_cgraph.png" border="0" usemap="#aclasscarma__wm_1_1WMListenerWorker_a531f3557b64b85c4cd3a068ba7094a2d_cgraph" alt=""/></div>
<map name="aclasscarma__wm_1_1WMListenerWorker_a531f3557b64b85c4cd3a068ba7094a2d_cgraph" id="aclasscarma__wm_1_1WMListenerWorker_a531f3557b64b85c4cd3a068ba7094a2d_cgraph">
<area shape="rect" title="Allows user to set a callback to be triggered when a route update is received." alt="" coords="5,5,208,47"/>
<area shape="rect" href="helper_8cpp.html#ac0f7f7ec5375e47d4c681359431356b9" title=" " alt="" coords="256,13,327,39"/>
</map>
</div>

</div>
</div>
<a id="ae84a214a0c12c4ccc3bce45c17a97bf9" name="ae84a214a0c12c4ccc3bce45c17a97bf9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae84a214a0c12c4ccc3bce45c17a97bf9">&#9670;&nbsp;</a></span>setVehicleParticipationType()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void carma_wm::WMListenerWorker::setVehicleParticipationType </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>participant</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allows user to set a callback to be triggered when a map update is received. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">participant</td><td>A callback function that will be triggered after the world model receives a new map update </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="WMListenerWorker_8cpp_source.html#l00703">703</a> of file <a class="el" href="WMListenerWorker_8cpp_source.html">WMListenerWorker.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  704</span>{  </div>
<div class="line"><span class="lineno">  705</span>  <span class="comment">//Function to load participation type into CarmaWorldModel</span></div>
<div class="line"><span class="lineno">  706</span>  <a class="code hl_variable" href="classcarma__wm_1_1WMListenerWorker.html#a4ea1ac169b8ba4a72dd72b4e8723257e">world_model_</a>-&gt;setVehicleParticipationType(participant);</div>
<div class="line"><span class="lineno">  707</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMListenerWorker_8hpp_source.html#l00145">world_model_</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a84466a412323d469f5a53bbd9fbcaf6d" name="a84466a412323d469f5a53bbd9fbcaf6d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84466a412323d469f5a53bbd9fbcaf6d">&#9670;&nbsp;</a></span>config_speed_limit_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double carma_wm::WMListenerWorker::config_speed_limit_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMListenerWorker_8hpp_source.html#l00150">150</a> of file <a class="el" href="WMListenerWorker_8hpp_source.html">WMListenerWorker.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMListenerWorker_8cpp_source.html#l00698">getConfigSpeedLimit()</a>, and <a class="el" href="WMListenerWorker_8cpp_source.html#l00686">setConfigSpeedLimit()</a>.</p>

</div>
</div>
<a id="aae0b14b4566a06ba1c99e46e79de0fba" name="aae0b14b4566a06ba1c99e46e79de0fba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae0b14b4566a06ba1c99e46e79de0fba">&#9670;&nbsp;</a></span>current_map_version_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t carma_wm::WMListenerWorker::current_map_version_ = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMListenerWorker_8hpp_source.html#l00152">152</a> of file <a class="el" href="WMListenerWorker_8hpp_source.html">WMListenerWorker.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMListenerWorker_8cpp_source.html#l00056">mapCallback()</a>, <a class="el" href="WMListenerWorker_8cpp_source.html#l00146">mapUpdateCallback()</a>, and <a class="el" href="WMListenerWorker_8cpp_source.html#l00578">routeCallback()</a>.</p>

</div>
</div>
<a id="a295aefa7073627e0c645ab19ec123a73" name="a295aefa7073627e0c645ab19ec123a73"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a295aefa7073627e0c645ab19ec123a73">&#9670;&nbsp;</a></span>delayed_route_msg_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">boost::optional&lt;carma_planning_msgs::msg::Route&gt; carma_wm::WMListenerWorker::delayed_route_msg_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMListenerWorker_8hpp_source.html#l00154">154</a> of file <a class="el" href="WMListenerWorker_8hpp_source.html">WMListenerWorker.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMListenerWorker_8cpp_source.html#l00056">mapCallback()</a>, and <a class="el" href="WMListenerWorker_8cpp_source.html#l00578">routeCallback()</a>.</p>

</div>
</div>
<a id="a3c2e638e8fdc934482ba9076a5ca7bb5" name="a3c2e638e8fdc934482ba9076a5ca7bb5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c2e638e8fdc934482ba9076a5ca7bb5">&#9670;&nbsp;</a></span>map_callback_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::function&lt;void()&gt; carma_wm::WMListenerWorker::map_callback_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMListenerWorker_8hpp_source.html#l00147">147</a> of file <a class="el" href="WMListenerWorker_8hpp_source.html">WMListenerWorker.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMListenerWorker_8cpp_source.html#l00056">mapCallback()</a>, <a class="el" href="WMListenerWorker_8cpp_source.html#l00146">mapUpdateCallback()</a>, and <a class="el" href="WMListenerWorker_8cpp_source.html#l00676">setMapCallback()</a>.</p>

</div>
</div>
<a id="a7f06d6bbeae107d1f91bbf2cad94288f" name="a7f06d6bbeae107d1f91bbf2cad94288f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f06d6bbeae107d1f91bbf2cad94288f">&#9670;&nbsp;</a></span>map_update_queue_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::queue&lt;autoware_lanelet2_msgs::msg::MapBin::UniquePtr&gt; carma_wm::WMListenerWorker::map_update_queue_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMListenerWorker_8hpp_source.html#l00153">153</a> of file <a class="el" href="WMListenerWorker_8hpp_source.html">WMListenerWorker.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMListenerWorker_8cpp_source.html#l00056">mapCallback()</a>, <a class="el" href="WMListenerWorker_8cpp_source.html#l00146">mapUpdateCallback()</a>, and <a class="el" href="WMListenerWorker_8cpp_source.html#l00578">routeCallback()</a>.</p>

</div>
</div>
<a id="ae838d10e2677708b7b86c13fbb62d452" name="ae838d10e2677708b7b86c13fbb62d452"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae838d10e2677708b7b86c13fbb62d452">&#9670;&nbsp;</a></span>most_recent_update_msg_seq_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">long carma_wm::WMListenerWorker::most_recent_update_msg_seq_ = -1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMListenerWorker_8hpp_source.html#l00159">159</a> of file <a class="el" href="WMListenerWorker_8hpp_source.html">WMListenerWorker.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMListenerWorker_8cpp_source.html#l00146">mapUpdateCallback()</a>.</p>

</div>
</div>
<a id="acae1ff63ff0f396de4e3f1bb9ab492bb" name="acae1ff63ff0f396de4e3f1bb9ab492bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acae1ff63ff0f396de4e3f1bb9ab492bb">&#9670;&nbsp;</a></span>recompute_route_flag_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> carma_wm::WMListenerWorker::recompute_route_flag_ =false</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMListenerWorker_8hpp_source.html#l00156">156</a> of file <a class="el" href="WMListenerWorker_8hpp_source.html">WMListenerWorker.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMListenerWorker_8cpp_source.html#l00146">mapUpdateCallback()</a>.</p>

</div>
</div>
<a id="a310d6ebc20c42f055541025291337b57" name="a310d6ebc20c42f055541025291337b57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a310d6ebc20c42f055541025291337b57">&#9670;&nbsp;</a></span>rerouting_flag_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> carma_wm::WMListenerWorker::rerouting_flag_ =false</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMListenerWorker_8hpp_source.html#l00157">157</a> of file <a class="el" href="WMListenerWorker_8hpp_source.html">WMListenerWorker.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMListenerWorker_8cpp_source.html#l00109">checkIfReRoutingNeeded()</a>, <a class="el" href="WMListenerWorker_8cpp_source.html#l00146">mapUpdateCallback()</a>, and <a class="el" href="WMListenerWorker_8cpp_source.html#l00578">routeCallback()</a>.</p>

</div>
</div>
<a id="a8a81ac013a5e920b47e6c12d338446cc" name="a8a81ac013a5e920b47e6c12d338446cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a81ac013a5e920b47e6c12d338446cc">&#9670;&nbsp;</a></span>route_callback_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::function&lt;void()&gt; carma_wm::WMListenerWorker::route_callback_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMListenerWorker_8hpp_source.html#l00148">148</a> of file <a class="el" href="WMListenerWorker_8hpp_source.html">WMListenerWorker.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMListenerWorker_8cpp_source.html#l00578">routeCallback()</a>, and <a class="el" href="WMListenerWorker_8cpp_source.html#l00681">setRouteCallback()</a>.</p>

</div>
</div>
<a id="a39cbf05af713a84fb396c36da3551df5" name="a39cbf05af713a84fb396c36da3551df5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39cbf05af713a84fb396c36da3551df5">&#9670;&nbsp;</a></span>route_node_flag_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> carma_wm::WMListenerWorker::route_node_flag_ =false</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMListenerWorker_8hpp_source.html#l00158">158</a> of file <a class="el" href="WMListenerWorker_8hpp_source.html">WMListenerWorker.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMListenerWorker_8cpp_source.html#l00114">enableUpdatesWithoutRoute()</a>, <a class="el" href="WMListenerWorker_8cpp_source.html#l00146">mapUpdateCallback()</a>, and <a class="el" href="WMListenerWorker_8cpp_source.html#l00578">routeCallback()</a>.</p>

</div>
</div>
<a id="acab7ad4d3841c78cf96da2deec5c751b" name="acab7ad4d3841c78cf96da2deec5c751b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acab7ad4d3841c78cf96da2deec5c751b">&#9670;&nbsp;</a></span>use_sim_time_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> carma_wm::WMListenerWorker::use_sim_time_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMListenerWorker_8hpp_source.html#l00146">146</a> of file <a class="el" href="WMListenerWorker_8hpp_source.html">WMListenerWorker.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMListenerWorker_8cpp_source.html#l00104">incomingSpatCallback()</a>, and <a class="el" href="WMListenerWorker_8cpp_source.html#l00693">isUsingSimTime()</a>.</p>

</div>
</div>
<a id="a4ea1ac169b8ba4a72dd72b4e8723257e" name="a4ea1ac169b8ba4a72dd72b4e8723257e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ea1ac169b8ba4a72dd72b4e8723257e">&#9670;&nbsp;</a></span>world_model_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_ptr&lt;<a class="el" href="classcarma__wm_1_1CARMAWorldModel.html">CARMAWorldModel</a>&gt; carma_wm::WMListenerWorker::world_model_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMListenerWorker_8hpp_source.html#l00145">145</a> of file <a class="el" href="WMListenerWorker_8hpp_source.html">WMListenerWorker.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMListenerWorker_8cpp_source.html#l00045">WMListenerWorker()</a>, <a class="el" href="WMListenerWorker_8cpp_source.html#l00567">getVehicleParticipationType()</a>, <a class="el" href="WMListenerWorker_8cpp_source.html#l00050">getWorldModel()</a>, <a class="el" href="WMListenerWorker_8cpp_source.html#l00104">incomingSpatCallback()</a>, <a class="el" href="WMListenerWorker_8cpp_source.html#l00056">mapCallback()</a>, <a class="el" href="WMListenerWorker_8cpp_source.html#l00146">mapUpdateCallback()</a>, <a class="el" href="WMListenerWorker_8cpp_source.html#l00321">newRegemUpdateHelper()</a>, <a class="el" href="WMListenerWorker_8cpp_source.html#l00572">roadwayObjectListCallback()</a>, <a class="el" href="WMListenerWorker_8cpp_source.html#l00578">routeCallback()</a>, <a class="el" href="WMListenerWorker_8cpp_source.html#l00686">setConfigSpeedLimit()</a>, and <a class="el" href="WMListenerWorker_8cpp_source.html#l00703">setVehicleParticipationType()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>carma_wm/src/<a class="el" href="WMListenerWorker_8hpp_source.html">WMListenerWorker.hpp</a></li>
<li>carma_wm/src/<a class="el" href="WMListenerWorker_8cpp_source.html">WMListenerWorker.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacecarma__wm.html">carma_wm</a></li><li class="navelem"><a class="el" href="classcarma__wm_1_1WMListenerWorker.html">WMListenerWorker</a></li>
    <li class="footer">Generated on Fri Nov 3 2023 19:56:35 for Carma-platform by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4 </li>
  </ul>
</div>
</body>
</html>
