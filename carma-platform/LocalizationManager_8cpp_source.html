<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Carma-platform: localization_manager/src/LocalizationManager.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Carma-platform<span id="projectnumber">&#160;v4.2.0</span>
   </div>
   <div id="projectbrief">CARMA Platform is built on robot operating system (ROS) and utilizes open source software (OSS) that enables Cooperative Driving Automation (CDA) features to allow Automated Driving Systems to interact and cooperate with infrastructure and other vehicles through communication.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('LocalizationManager_8cpp_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle"><div class="title">LocalizationManager.cpp</div></div>
</div><!--header-->
<div class="contents">
<a href="LocalizationManager_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">/*</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment"> * Copyright (C) 2022 LEIDOS.</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment"> *</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment"> * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;); you may not</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment"> * use this file except in compliance with the License. You may obtain a copy of</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="comment"> * the License at</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="comment"> *</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="comment"> * http://www.apache.org/licenses/LICENSE-2.0</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="comment"> *</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="comment"> * Unless required by applicable law or agreed to in writing, software</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="comment"> * distributed under the License is distributed on an &quot;AS IS&quot; BASIS, WITHOUT</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="comment"> * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="comment"> * License for the specific language governing permissions and limitations under</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="comment"> * the License.</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="comment"> */</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span> </div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="preprocessor">#include &lt;tf2_geometry_msgs/tf2_geometry_msgs.h&gt;</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="preprocessor">#include &quot;<a class="code" href="LocalizationManager_8hpp.html">localization_manager/LocalizationManager.hpp</a>&quot;</span></div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span> </div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="keyword">namespace </span><a class="code hl_namespace" href="namespacelocalization__manager.html">localization_manager</a></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span>{</div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span>    <span class="comment">// Initialize static values</span></div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span>    <span class="keyword">const</span> std::unordered_set&lt;std::string&gt; <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a852f8fa433424784ce64e712a5f1a9e6">LocalizationManager::LIDAR_FAILURE_STRINGS</a>({<span class="stringliteral">&quot;One LIDAR Failed&quot;</span>, <span class="stringliteral">&quot;Both LIDARS Failed&quot;</span>});</div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span> </div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno"><a class="line" href="classlocalization__manager_1_1LocalizationManager.html#acbb7d81be472c3ec96f3d700b7ca823c">   26</a></span>    <a class="code hl_function" href="classlocalization__manager_1_1LocalizationManager.html#acbb7d81be472c3ec96f3d700b7ca823c">LocalizationManager::LocalizationManager</a>(<a class="code hl_typedef" href="classlocalization__manager_1_1LocalizationManager.html#ac75e2c2af5e2a75a6ee3ce23ce2a290d">PosePublisher</a> pose_pub,</div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span>                                             <a class="code hl_typedef" href="classlocalization__manager_1_1LocalizationManager.html#a7b5d0959c7592ae97ad032a3e1e9f2a3">StatePublisher</a> state_pub, <a class="code hl_typedef" href="classlocalization__manager_1_1LocalizationManager.html#aef7191d344d1c87a83903453ab82eb76">ManagedInitialPosePublisher</a> initialpose_pub,</div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span>                                             <span class="keyword">const</span> <a class="code hl_struct" href="structlocalization__manager_1_1LocalizationManagerConfig.html">LocalizationManagerConfig</a> &amp;config,</div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span>                                             rclcpp::node_interfaces::NodeLoggingInterface::SharedPtr logger,</div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span>                                             std::unique_ptr&lt;carma_ros2_utils::timers::TimerFactory&gt; timer_factory)</div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span>        : pose_pub_(pose_pub), state_pub_(state_pub), initialpose_pub_(initialpose_pub), config_(config), logger_(logger), timer_factory_(std::move(timer_factory)), transition_table_(static_cast&lt;<a class="code hl_enumeration" href="namespacelocalization__manager.html#a9b86b848ab2c2216f0987be7c5007b70">LocalizerMode</a>&gt;(config_.localization_mode))</div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span> </div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span>    {</div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span> </div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span>        <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a8f6a02f44f6812384262295e1e8ad132">transition_table_</a>.<a class="code hl_function" href="classlocalization__manager_1_1LocalizationTransitionTable.html#af6e9734499a3487b0f6c732466804a66">setTransitionCallback</a>(std::bind(&amp;<a class="code hl_function" href="classlocalization__manager_1_1LocalizationManager.html#a37e91016dd16e328bec5041afaf5bc0c">LocalizationManager::stateTransitionCallback</a>, <span class="keyword">this</span>,</div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span>                                                          std::placeholders::_1, std::placeholders::_2,</div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span>                                                          std::placeholders::_3));</div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span>        <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a9d753ea64cf1496b644e9245e13f387c">timer_clock_type_</a> = <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a673a02a2282dcbeff6d9df5f91c1f8d6">timer_factory_</a>-&gt;now().get_clock_type();</div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span>    }</div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span> </div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno"><a class="line" href="classlocalization__manager_1_1LocalizationManager.html#a6a06b312cdda09ab9b945daf69710c66">   41</a></span>    <span class="keywordtype">double</span> <a class="code hl_function" href="classlocalization__manager_1_1LocalizationManager.html#a6a06b312cdda09ab9b945daf69710c66">LocalizationManager::computeFreq</a>(<span class="keyword">const</span> rclcpp::Time &amp;old_stamp, <span class="keyword">const</span> rclcpp::Time &amp;new_stamp)<span class="keyword"> const</span></div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span><span class="keyword">    </span>{</div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span>        <span class="keywordflow">return</span> 1.0 / (new_stamp - old_stamp).seconds(); <span class="comment">// Convert delta to frequency (Hz = 1/s)</span></div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span>    }</div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span> </div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno"><a class="line" href="classlocalization__manager_1_1LocalizationManager.html#ad26090538f61ea866d2e4729ab6a0a91">   46</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classlocalization__manager_1_1LocalizationManager.html#ad26090538f61ea866d2e4729ab6a0a91">LocalizationManager::setConfig</a>(<span class="keyword">const</span> <a class="code hl_struct" href="structlocalization__manager_1_1LocalizationManagerConfig.html">LocalizationManagerConfig</a>&amp; config)</div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span>    {</div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span>        <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a4caa21b1d191857bc60a786ead351554">config_</a> = config;</div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span>    }</div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span> </div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno"><a class="line" href="classlocalization__manager_1_1LocalizationManager.html#ace5b1b34adeeab50c2b3d47591e6c7c9">   51</a></span>    <span class="keywordtype">double</span> <a class="code hl_function" href="classlocalization__manager_1_1LocalizationManager.html#ace5b1b34adeeab50c2b3d47591e6c7c9">LocalizationManager::computeNDTFreq</a>(<span class="keyword">const</span> rclcpp::Time &amp;new_stamp)</div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span>    {</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#ab81bcd2a98e3d1194a8fd1f2f5794bf5">prev_ndt_stamp_</a>)</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span>        { <span class="comment">// Check if this is the first data point</span></div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span>            <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#ab81bcd2a98e3d1194a8fd1f2f5794bf5">prev_ndt_stamp_</a> = new_stamp;</div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span>            <span class="comment">// When no historic data is available force the frequency into the operational range</span></div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span>            <span class="keywordflow">return</span> <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a4caa21b1d191857bc60a786ead351554">config_</a>.<a class="code hl_variable" href="structlocalization__manager_1_1LocalizationManagerConfig.html#ae10dc543a160a4932983ca4fb8770dac">ndt_frequency_degraded_threshold</a> * 2;</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>        }</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span> </div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>        <span class="keywordflow">if</span> (new_stamp &lt;= rclcpp::Time(<a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#ab81bcd2a98e3d1194a8fd1f2f5794bf5">prev_ndt_stamp_</a>.get(), <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a9d753ea64cf1496b644e9245e13f387c">timer_clock_type_</a>))</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>        {</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span>            RCLCPP_ERROR_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;localization_manager&quot;</span>), <span class="stringliteral">&quot;LocalizationManager received NDT data out of order. Prev stamp was &quot;</span></div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>                                                                                &lt;&lt; <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#ab81bcd2a98e3d1194a8fd1f2f5794bf5">prev_ndt_stamp_</a>.get().seconds() &lt;&lt; <span class="stringliteral">&quot; new stamp is &quot;</span> &lt;&lt; new_stamp.seconds());</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span>            <span class="comment">// When invalid data is received from NDT force the frequency into the fault range</span></div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span>            <span class="keywordflow">return</span> <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a4caa21b1d191857bc60a786ead351554">config_</a>.<a class="code hl_variable" href="structlocalization__manager_1_1LocalizationManagerConfig.html#ae0ca2842f7b10c7af545b5d3d16e87fc">ndt_frequency_fault_threshold</a> / 2;</div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span>        }</div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="classlocalization__manager_1_1LocalizationManager.html#a6a06b312cdda09ab9b945daf69710c66">computeFreq</a>(rclcpp::Time(<a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#ab81bcd2a98e3d1194a8fd1f2f5794bf5">prev_ndt_stamp_</a>.get(), <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a9d753ea64cf1496b644e9245e13f387c">timer_clock_type_</a>), new_stamp); <span class="comment">// Convert delta to frequency (Hz = 1/s)</span></div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span>    }</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span> </div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno"><a class="line" href="classlocalization__manager_1_1LocalizationManager.html#a027f5aab97b4a77bdbea02a2cf585115">   70</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classlocalization__manager_1_1LocalizationManager.html#a027f5aab97b4a77bdbea02a2cf585115">LocalizationManager::poseAndStatsCallback</a>(<span class="keyword">const</span> geometry_msgs::msg::PoseStamped::ConstPtr pose,</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>                                                   <span class="keyword">const</span> autoware_msgs::msg::NDTStat::ConstPtr stats)</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>    {</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>        <span class="keywordtype">double</span> ndt_freq = <a class="code hl_function" href="classlocalization__manager_1_1LocalizationManager.html#ace5b1b34adeeab50c2b3d47591e6c7c9">computeNDTFreq</a>(rclcpp::Time(pose-&gt;header.stamp, <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a9d753ea64cf1496b644e9245e13f387c">timer_clock_type_</a>));</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;localization_manager&quot;</span>), <span class="stringliteral">&quot;Received pose resulting in frequency value of &quot;</span> &lt;&lt; ndt_freq &lt;&lt; <span class="stringliteral">&quot; with score of &quot;</span> &lt;&lt; stats-&gt;score);</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span> </div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>        <span class="keywordflow">if</span> (stats-&gt;score &gt;= <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a4caa21b1d191857bc60a786ead351554">config_</a>.<a class="code hl_variable" href="structlocalization__manager_1_1LocalizationManagerConfig.html#a0cdb308c05aa70c80687938f4f043949">fitness_score_fault_threshold</a> || ndt_freq &lt;= <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a4caa21b1d191857bc60a786ead351554">config_</a>.<a class="code hl_variable" href="structlocalization__manager_1_1LocalizationManagerConfig.html#ae0ca2842f7b10c7af545b5d3d16e87fc">ndt_frequency_fault_threshold</a>)</div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>        {</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>            <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a8f6a02f44f6812384262295e1e8ad132">transition_table_</a>.<a class="code hl_function" href="classlocalization__manager_1_1LocalizationTransitionTable.html#a0f5e05d562934f0e04d7f64f9d2fd95c">signal</a>(<a class="code hl_enumvalue" href="namespacelocalization__manager.html#af61876be3f0f4998db813dd549c8bf4aa57fb0eaa7867d3c150558b918cf8c32d">LocalizationSignal::UNUSABLE_NDT_FREQ_OR_FITNESS_SCORE</a>);</div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>        }</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (stats-&gt;score &gt;= <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a4caa21b1d191857bc60a786ead351554">config_</a>.<a class="code hl_variable" href="structlocalization__manager_1_1LocalizationManagerConfig.html#a37547042fb173223e33c8a1a7ecb5b1a">fitness_score_degraded_threshold</a> || ndt_freq &lt;= <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a4caa21b1d191857bc60a786ead351554">config_</a>.<a class="code hl_variable" href="structlocalization__manager_1_1LocalizationManagerConfig.html#ae10dc543a160a4932983ca4fb8770dac">ndt_frequency_degraded_threshold</a>)</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>        {</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>            <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a8f6a02f44f6812384262295e1e8ad132">transition_table_</a>.<a class="code hl_function" href="classlocalization__manager_1_1LocalizationTransitionTable.html#a0f5e05d562934f0e04d7f64f9d2fd95c">signal</a>(<a class="code hl_enumvalue" href="namespacelocalization__manager.html#af61876be3f0f4998db813dd549c8bf4aa30b13d34b135451276460125d3bebae5">LocalizationSignal::POOR_NDT_FREQ_OR_FITNESS_SCORE</a>);</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>        }</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>        <span class="keywordflow">else</span></div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>        {</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>            <span class="comment">// In GNSS_WITH_NDT_INIT mode, we shouldn&#39;t switch back to NDT and only rely on GPS</span></div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>            <span class="keywordflow">if</span> (!(<span class="keyword">static_cast&lt;</span><a class="code hl_enumeration" href="namespacelocalization__manager.html#a9b86b848ab2c2216f0987be7c5007b70">LocalizerMode</a><span class="keyword">&gt;</span>(<a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a4caa21b1d191857bc60a786ead351554">config_</a>.<a class="code hl_variable" href="structlocalization__manager_1_1LocalizationManagerConfig.html#a4a33f8febd8d330d70727a20dd242550">localization_mode</a>) == <a class="code hl_enumvalue" href="namespacelocalization__manager.html#a9b86b848ab2c2216f0987be7c5007b70a90db69d58f7274bfad34570f2fdce99c">LocalizerMode::GNSS_WITH_NDT_INIT</a> &amp;&amp;</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>                  <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a8f6a02f44f6812384262295e1e8ad132">transition_table_</a>.<a class="code hl_function" href="classlocalization__manager_1_1LocalizationTransitionTable.html#aeec5e1584741de33c3c5f23f3ebe529a">getState</a>() == <a class="code hl_enumvalue" href="namespacelocalization__manager.html#a539480c89bbebadc494867fa841b35d1a30e9fbe62db0831f32b1be44a883350c">LocalizationState::DEGRADED_NO_LIDAR_FIX</a> &amp;&amp;</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>                  <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a06d56bb3fcbc47135a84653fb202dd47">lidar_init_sequential_timesteps_counter_</a> &gt;= <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a4caa21b1d191857bc60a786ead351554">config_</a>.<a class="code hl_variable" href="structlocalization__manager_1_1LocalizationManagerConfig.html#aed78bd42d681c0ace463dddc4dbf36f1">sequential_timesteps_until_gps_operation</a>))</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>            {</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>                <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a8f6a02f44f6812384262295e1e8ad132">transition_table_</a>.<a class="code hl_function" href="classlocalization__manager_1_1LocalizationTransitionTable.html#a0f5e05d562934f0e04d7f64f9d2fd95c">signal</a>(<a class="code hl_enumvalue" href="namespacelocalization__manager.html#af61876be3f0f4998db813dd549c8bf4aaa0e8cc642780818952c89ed5c6626a78">LocalizationSignal::GOOD_NDT_FREQ_AND_FITNESS_SCORE</a>);</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>            }</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>        }</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span> </div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>        <span class="keyword">const</span> <a class="code hl_enumeration" href="namespacelocalization__manager.html#a539480c89bbebadc494867fa841b35d1">LocalizationState</a> state = <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a8f6a02f44f6812384262295e1e8ad132">transition_table_</a>.<a class="code hl_function" href="classlocalization__manager_1_1LocalizationTransitionTable.html#aeec5e1584741de33c3c5f23f3ebe529a">getState</a>();</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span> </div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>        <span class="keywordflow">if</span> (<span class="keyword">static_cast&lt;</span><a class="code hl_enumeration" href="namespacelocalization__manager.html#a9b86b848ab2c2216f0987be7c5007b70">LocalizerMode</a><span class="keyword">&gt;</span>(<a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a4caa21b1d191857bc60a786ead351554">config_</a>.<a class="code hl_variable" href="structlocalization__manager_1_1LocalizationManagerConfig.html#a4a33f8febd8d330d70727a20dd242550">localization_mode</a>) == <a class="code hl_enumvalue" href="namespacelocalization__manager.html#a9b86b848ab2c2216f0987be7c5007b70a90db69d58f7274bfad34570f2fdce99c">LocalizerMode::GNSS_WITH_NDT_INIT</a> &amp;&amp; state == <a class="code hl_enumvalue" href="namespacelocalization__manager.html#a539480c89bbebadc494867fa841b35d1ac97e79e14549c9f528427e36c90ae782">LocalizationState::OPERATIONAL</a> &amp;&amp; <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a4728052763f8223186c97e3169126062">last_raw_gnss_value_</a>)</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>        {</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;localization_manager&quot;</span>), <span class="stringliteral">&quot;lidar_init_sequential_timesteps_counter_: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a06d56bb3fcbc47135a84653fb202dd47">lidar_init_sequential_timesteps_counter_</a>);</div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a06d56bb3fcbc47135a84653fb202dd47">lidar_init_sequential_timesteps_counter_</a> &lt; <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a4caa21b1d191857bc60a786ead351554">config_</a>.<a class="code hl_variable" href="structlocalization__manager_1_1LocalizationManagerConfig.html#aed78bd42d681c0ace463dddc4dbf36f1">sequential_timesteps_until_gps_operation</a>)</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>            {</div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a39c9636657b5d522204253456836b13b">is_sequential_</a>)</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>                    <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a06d56bb3fcbc47135a84653fb202dd47">lidar_init_sequential_timesteps_counter_</a>++;</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span> </div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>                <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a39c9636657b5d522204253456836b13b">is_sequential_</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>            }</div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>            <span class="keywordflow">else</span></div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>            {</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>                <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a8f6a02f44f6812384262295e1e8ad132">transition_table_</a>.<a class="code hl_function" href="classlocalization__manager_1_1LocalizationTransitionTable.html#a0f5e05d562934f0e04d7f64f9d2fd95c">signal</a>(<a class="code hl_enumvalue" href="namespacelocalization__manager.html#af61876be3f0f4998db813dd549c8bf4aaaa3e4a1e1b08ccd33ff7cfb1d64aa575">LocalizationSignal::LIDAR_INITIALIZED_SWITCH_TO_GPS</a>);</div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;localization_manager&quot;</span>), <span class="stringliteral">&quot;Switched to LIDAR_INITIALIZED_SWITCH_TO_GPS at lidar_init_sequential_timesteps_counter_: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a06d56bb3fcbc47135a84653fb202dd47">lidar_init_sequential_timesteps_counter_</a></div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>                                                                                                                                                                            &lt;&lt; <span class="stringliteral">&quot;, with new state: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a8f6a02f44f6812384262295e1e8ad132">transition_table_</a>.<a class="code hl_function" href="classlocalization__manager_1_1LocalizationTransitionTable.html#aeec5e1584741de33c3c5f23f3ebe529a">getState</a>());</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>            }</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>        }</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!(<span class="keyword">static_cast&lt;</span><a class="code hl_enumeration" href="namespacelocalization__manager.html#a9b86b848ab2c2216f0987be7c5007b70">LocalizerMode</a><span class="keyword">&gt;</span>(<a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a4caa21b1d191857bc60a786ead351554">config_</a>.<a class="code hl_variable" href="structlocalization__manager_1_1LocalizationManagerConfig.html#a4a33f8febd8d330d70727a20dd242550">localization_mode</a>) == <a class="code hl_enumvalue" href="namespacelocalization__manager.html#a9b86b848ab2c2216f0987be7c5007b70a90db69d58f7274bfad34570f2fdce99c">LocalizerMode::GNSS_WITH_NDT_INIT</a> &amp;&amp;</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>                   state == <a class="code hl_enumvalue" href="namespacelocalization__manager.html#a539480c89bbebadc494867fa841b35d1a30e9fbe62db0831f32b1be44a883350c">LocalizationState::DEGRADED_NO_LIDAR_FIX</a> &amp;&amp;</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>                   <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a4728052763f8223186c97e3169126062">last_raw_gnss_value_</a> &amp;&amp;</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>                   <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a06d56bb3fcbc47135a84653fb202dd47">lidar_init_sequential_timesteps_counter_</a> &gt;= <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a4caa21b1d191857bc60a786ead351554">config_</a>.<a class="code hl_variable" href="structlocalization__manager_1_1LocalizationManagerConfig.html#aed78bd42d681c0ace463dddc4dbf36f1">sequential_timesteps_until_gps_operation</a>)) <span class="comment">// don&#39;t reset counter if Lidar initialized and switched to GPS</span></div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>                                                                                                                  <span class="comment">// as it will reset state to OPERATIONAL</span></div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>        {</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>            <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a39c9636657b5d522204253456836b13b">is_sequential_</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>            <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a06d56bb3fcbc47135a84653fb202dd47">lidar_init_sequential_timesteps_counter_</a> = 0;</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;localization_manager&quot;</span>), <span class="stringliteral">&quot;Resetting lidar_init_sequential_timesteps_counter_: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a06d56bb3fcbc47135a84653fb202dd47">lidar_init_sequential_timesteps_counter_</a> &lt;&lt; <span class="stringliteral">&quot;, with new state: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a8f6a02f44f6812384262295e1e8ad132">transition_table_</a>.<a class="code hl_function" href="classlocalization__manager_1_1LocalizationTransitionTable.html#aeec5e1584741de33c3c5f23f3ebe529a">getState</a>());</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>        }</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span> </div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>        <span class="keywordflow">if</span> (state == <a class="code hl_enumvalue" href="namespacelocalization__manager.html#a539480c89bbebadc494867fa841b35d1ac97e79e14549c9f528427e36c90ae782">LocalizationState::OPERATIONAL</a> &amp;&amp; <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a4728052763f8223186c97e3169126062">last_raw_gnss_value_</a>)</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>        {</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>            tf2::Vector3 ndt_translation(pose-&gt;pose.position.x, pose-&gt;pose.position.y, pose-&gt;pose.position.z);</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span> </div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>            tf2::Vector3 gnss_translation(<a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a4728052763f8223186c97e3169126062">last_raw_gnss_value_</a>-&gt;pose.position.x, <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a4728052763f8223186c97e3169126062">last_raw_gnss_value_</a>-&gt;pose.position.y, <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a4728052763f8223186c97e3169126062">last_raw_gnss_value_</a>-&gt;pose.position.z);</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span> </div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>            <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#aafd6886f83ce04f8d2c49ca0b85b9a9a">gnss_offset_</a> = ndt_translation - gnss_translation;</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>        }</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span> </div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>        <span class="keywordflow">if</span> (state != <a class="code hl_enumvalue" href="namespacelocalization__manager.html#a539480c89bbebadc494867fa841b35d1a30e9fbe62db0831f32b1be44a883350c">LocalizationState::DEGRADED_NO_LIDAR_FIX</a>)</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>        {</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;localization_manager&quot;</span>), <span class="stringliteral">&quot;Publishing mixed pose with lidar_init_sequential_timesteps_counter_: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a06d56bb3fcbc47135a84653fb202dd47">lidar_init_sequential_timesteps_counter_</a> &lt;&lt; <span class="stringliteral">&quot;, and state&quot;</span> &lt;&lt; state);</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>            <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#ac4e5f615aa35031d88ce289d832dcb02">current_pose_</a> = *pose;</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>        }</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span> </div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>        <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#ab81bcd2a98e3d1194a8fd1f2f5794bf5">prev_ndt_stamp_</a> = pose-&gt;header.stamp;</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>    }</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span> </div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno"><a class="line" href="classlocalization__manager_1_1LocalizationManager.html#a2804818f7ee388d2eca7bcbd3e27f908">  143</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classlocalization__manager_1_1LocalizationManager.html#a2804818f7ee388d2eca7bcbd3e27f908">LocalizationManager::gnssPoseCallback</a>(<span class="keyword">const</span> geometry_msgs::msg::PoseStamped::SharedPtr msg)</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>    {</div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>        <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a4728052763f8223186c97e3169126062">last_raw_gnss_value_</a> = *msg;</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>        <span class="comment">// Just like ndt_matching the gnss pose is treated as an initialize signal if the system is not yet intialized</span></div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a8f6a02f44f6812384262295e1e8ad132">transition_table_</a>.<a class="code hl_function" href="classlocalization__manager_1_1LocalizationTransitionTable.html#aeec5e1584741de33c3c5f23f3ebe529a">getState</a>() == <a class="code hl_enumvalue" href="namespacelocalization__manager.html#a539480c89bbebadc494867fa841b35d1add652546039b18970b8dcf2cff824268">LocalizationState::UNINITIALIZED</a>)</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>        {</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>            <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a06d56bb3fcbc47135a84653fb202dd47">lidar_init_sequential_timesteps_counter_</a> = 0;</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>            <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a8f6a02f44f6812384262295e1e8ad132">transition_table_</a>.<a class="code hl_function" href="classlocalization__manager_1_1LocalizationTransitionTable.html#a0f5e05d562934f0e04d7f64f9d2fd95c">signal</a>(<a class="code hl_enumvalue" href="namespacelocalization__manager.html#af61876be3f0f4998db813dd549c8bf4aa3abd129e0314ad9fd7f7587a2465d94b">LocalizationSignal::INITIAL_POSE</a>);</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span> </div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>            geometry_msgs::msg::PoseWithCovarianceStamped new_initial_pose;</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>            new_initial_pose.header = msg-&gt;header;</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>            new_initial_pose.pose.pose = msg-&gt;pose;</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span> </div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>            <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#ad607aaab0ad2cc47bc4793106f54616e">initialpose_pub_</a>(new_initial_pose);</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>        }</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span> </div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a8f6a02f44f6812384262295e1e8ad132">transition_table_</a>.<a class="code hl_function" href="classlocalization__manager_1_1LocalizationTransitionTable.html#aeec5e1584741de33c3c5f23f3ebe529a">getState</a>() == <a class="code hl_enumvalue" href="namespacelocalization__manager.html#a539480c89bbebadc494867fa841b35d1a30e9fbe62db0831f32b1be44a883350c">LocalizationState::DEGRADED_NO_LIDAR_FIX</a>)</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>        {</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>            geometry_msgs::msg::PoseStamped corrected_pose = *msg;</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#aafd6886f83ce04f8d2c49ca0b85b9a9a">gnss_offset_</a>)</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>            {</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>                corrected_pose.pose.position.x = corrected_pose.pose.position.x + <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#aafd6886f83ce04f8d2c49ca0b85b9a9a">gnss_offset_</a>-&gt;x();</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>                corrected_pose.pose.position.y = corrected_pose.pose.position.y + <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#aafd6886f83ce04f8d2c49ca0b85b9a9a">gnss_offset_</a>-&gt;y();</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>                corrected_pose.pose.position.z = corrected_pose.pose.position.z + <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#aafd6886f83ce04f8d2c49ca0b85b9a9a">gnss_offset_</a>-&gt;z();</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>            }</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;localization_manager&quot;</span>), <span class="stringliteral">&quot;Publishing GNSS pose with lidar_init_sequential_timesteps_counter_: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a06d56bb3fcbc47135a84653fb202dd47">lidar_init_sequential_timesteps_counter_</a>);</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>            <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#ac4e5f615aa35031d88ce289d832dcb02">current_pose_</a> = corrected_pose;</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>        }</div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>    }</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span> </div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno"><a class="line" href="classlocalization__manager_1_1LocalizationManager.html#a43d2dc2970c35c4d6a12293ec240e84a">  173</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classlocalization__manager_1_1LocalizationManager.html#a43d2dc2970c35c4d6a12293ec240e84a">LocalizationManager::initialPoseCallback</a>(<span class="keyword">const</span> geometry_msgs::msg::PoseWithCovarianceStamped::SharedPtr msg)</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>    {</div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>        <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a06d56bb3fcbc47135a84653fb202dd47">lidar_init_sequential_timesteps_counter_</a> = 0;</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>        <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a8f6a02f44f6812384262295e1e8ad132">transition_table_</a>.<a class="code hl_function" href="classlocalization__manager_1_1LocalizationTransitionTable.html#a0f5e05d562934f0e04d7f64f9d2fd95c">signal</a>(<a class="code hl_enumvalue" href="namespacelocalization__manager.html#af61876be3f0f4998db813dd549c8bf4aa3abd129e0314ad9fd7f7587a2465d94b">LocalizationSignal::INITIAL_POSE</a>);</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>        <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#ac4e5f615aa35031d88ce289d832dcb02">current_pose_</a> = boost::none; <span class="comment">// Reset the current pose until a new pose is recieved</span></div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>        <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#ad607aaab0ad2cc47bc4793106f54616e">initialpose_pub_</a>(*msg);      <span class="comment">// Forward the initial pose to the rest of the system</span></div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>    }</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span> </div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno"><a class="line" href="classlocalization__manager_1_1LocalizationManager.html#a9e4c9b82f1d519c27cc82bc5c9231121">  181</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classlocalization__manager_1_1LocalizationManager.html#a9e4c9b82f1d519c27cc82bc5c9231121">LocalizationManager::systemAlertCallback</a>(<span class="keyword">const</span> carma_msgs::msg::SystemAlert::SharedPtr alert)</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>    {</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a852f8fa433424784ce64e712a5f1a9e6">LIDAR_FAILURE_STRINGS</a>.find(alert-&gt;description) != <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a852f8fa433424784ce64e712a5f1a9e6">LIDAR_FAILURE_STRINGS</a>.end())</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>        {</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>            <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a8f6a02f44f6812384262295e1e8ad132">transition_table_</a>.<a class="code hl_function" href="classlocalization__manager_1_1LocalizationTransitionTable.html#a0f5e05d562934f0e04d7f64f9d2fd95c">signal</a>(<a class="code hl_enumvalue" href="namespacelocalization__manager.html#af61876be3f0f4998db813dd549c8bf4aa6b2aa1c5eb86ace61332b4358866497e">LocalizationSignal::LIDAR_SENSOR_FAILURE</a>);</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>        }</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>    }</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span> </div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno"><a class="line" href="classlocalization__manager_1_1LocalizationManager.html#a180b8d484c93d7faea1a707a0d586a79">  189</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classlocalization__manager_1_1LocalizationManager.html#a180b8d484c93d7faea1a707a0d586a79">LocalizationManager::timerCallback</a>(<span class="keyword">const</span> <a class="code hl_enumeration" href="namespacelocalization__manager.html#a539480c89bbebadc494867fa841b35d1">LocalizationState</a> origin_state)</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>    {</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>        <span class="comment">// If there is already a timer callback in progress or the expected state has changed then return</span></div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>        <span class="keywordflow">if</span> (origin_state != <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a8f6a02f44f6812384262295e1e8ad132">transition_table_</a>.<a class="code hl_function" href="classlocalization__manager_1_1LocalizationTransitionTable.html#aeec5e1584741de33c3c5f23f3ebe529a">getState</a>())</div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>        {</div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>        }</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span> </div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>        <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a8f6a02f44f6812384262295e1e8ad132">transition_table_</a>.<a class="code hl_function" href="classlocalization__manager_1_1LocalizationTransitionTable.html#a0f5e05d562934f0e04d7f64f9d2fd95c">signal</a>(<a class="code hl_enumvalue" href="namespacelocalization__manager.html#af61876be3f0f4998db813dd549c8bf4aa070a0fb40f6c308ab544b227660aadff">LocalizationSignal::TIMEOUT</a>);</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>    }</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span> </div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno"><a class="line" href="classlocalization__manager_1_1LocalizationManager.html#a357d15f4b553adac7c730e66a0b99cbf">  200</a></span>    <a class="code hl_typedef" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="code hl_function" href="classlocalization__manager_1_1LocalizationManager.html#a357d15f4b553adac7c730e66a0b99cbf">LocalizationManager::nextId</a>()</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>    {</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>        <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a56f2d3375a21dea78754e388dac1997e">next_id_</a>++;</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a56f2d3375a21dea78754e388dac1997e">next_id_</a>;</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>    }</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span> </div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno"><a class="line" href="classlocalization__manager_1_1LocalizationManager.html#a83866ff4e7229989b0a265a98e3d50b4">  206</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classlocalization__manager_1_1LocalizationManager.html#a83866ff4e7229989b0a265a98e3d50b4">LocalizationManager::clearTimers</a>()</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>    {</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>        std::lock_guard&lt;std::mutex&gt; guard(<a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a6b70bd02d34a73dfc7b05ae9e63d0502">mutex_</a>);</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span> </div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>        <span class="comment">// Clear expired timers</span></div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>        <span class="keyword">auto</span> it = <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#ae067b5ec0c115080299c03529f3b2861">timers_</a>.begin();</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>        <span class="keywordflow">while</span> (it != <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#ae067b5ec0c115080299c03529f3b2861">timers_</a>.end())</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>        {</div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>            <span class="comment">// Check if timer is marked for deletion</span></div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>            <span class="keywordflow">if</span> (it-&gt;second.second)</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>            {</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>                <span class="comment">// erase() function returns the iterator of the next to last deleted element</span></div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>                it = <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#ae067b5ec0c115080299c03529f3b2861">timers_</a>.erase(it);</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>            }</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>            <span class="keywordflow">else</span></div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>            {</div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>                it++;</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>            }</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>        }</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>    }</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span> </div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno"><a class="line" href="classlocalization__manager_1_1LocalizationManager.html#a37e91016dd16e328bec5041afaf5bc0c">  227</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classlocalization__manager_1_1LocalizationManager.html#a37e91016dd16e328bec5041afaf5bc0c">LocalizationManager::stateTransitionCallback</a>(<a class="code hl_enumeration" href="namespacelocalization__manager.html#a539480c89bbebadc494867fa841b35d1">LocalizationState</a> prev_state, <a class="code hl_enumeration" href="namespacelocalization__manager.html#a539480c89bbebadc494867fa841b35d1">LocalizationState</a> new_state,</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>                                                      <a class="code hl_enumeration" href="namespacelocalization__manager.html#af61876be3f0f4998db813dd549c8bf4a">LocalizationSignal</a> signal)</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>    {</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>        RCLCPP_INFO_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;localization_manager&quot;</span>), <span class="stringliteral">&quot;State transition from &quot;</span> &lt;&lt; prev_state &lt;&lt; <span class="stringliteral">&quot; to &quot;</span> &lt;&lt; new_state &lt;&lt; <span class="stringliteral">&quot; with signal &quot;</span> &lt;&lt; signal);</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>        <span class="comment">// Mark the expired timers as expired if any</span></div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#ad5798343089ac239263eb82275aad228">current_timer_</a>)</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>        {</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>            <span class="comment">// NOTE unit testing of current algorithm depends on all timers being one-shot timers.</span></div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>            <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#ae067b5ec0c115080299c03529f3b2861">timers_</a>[<a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a1b6c443414a7d5e417e365ef0bd0c254">current_timer_id_</a>].second = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>        }</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span> </div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>        <span class="keywordflow">switch</span> (new_state)</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>        {</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespacelocalization__manager.html#a539480c89bbebadc494867fa841b35d1a86bf8c89d85949f8f45cde2f73fce113">LocalizationState::INITIALIZING</a>:</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>            <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#aafd6886f83ce04f8d2c49ca0b85b9a9a">gnss_offset_</a> = boost::none;</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>            <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#ab81bcd2a98e3d1194a8fd1f2f5794bf5">prev_ndt_stamp_</a> = boost::none;</div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span> </div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>            <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a1b6c443414a7d5e417e365ef0bd0c254">current_timer_id_</a> = <a class="code hl_function" href="classlocalization__manager_1_1LocalizationManager.html#a357d15f4b553adac7c730e66a0b99cbf">nextId</a>();</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>            <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#ad5798343089ac239263eb82275aad228">current_timer_</a> = <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a673a02a2282dcbeff6d9df5f91c1f8d6">timer_factory_</a>-&gt;buildTimer(<a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a1b6c443414a7d5e417e365ef0bd0c254">current_timer_id_</a>, rclcpp::Duration(<a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a4caa21b1d191857bc60a786ead351554">config_</a>.<a class="code hl_variable" href="structlocalization__manager_1_1LocalizationManagerConfig.html#a815937ae2f121dea77ae1308f666a1f9">auto_initialization_timeout</a> * 1e6),</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>                                                        std::bind(&amp;<a class="code hl_function" href="classlocalization__manager_1_1LocalizationManager.html#a180b8d484c93d7faea1a707a0d586a79">LocalizationManager::timerCallback</a>, <span class="keyword">this</span>, new_state), <span class="keyword">true</span>, <span class="keyword">true</span>);</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span> </div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>            <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#ae067b5ec0c115080299c03529f3b2861">timers_</a>[<a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a1b6c443414a7d5e417e365ef0bd0c254">current_timer_id_</a>] = std::make_pair(std::move(<a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#ad5798343089ac239263eb82275aad228">current_timer_</a>), <span class="keyword">false</span>); <span class="comment">// Add start timer to map by Id</span></div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespacelocalization__manager.html#a539480c89bbebadc494867fa841b35d1a30e9fbe62db0831f32b1be44a883350c">LocalizationState::DEGRADED_NO_LIDAR_FIX</a>:</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>            <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a1b6c443414a7d5e417e365ef0bd0c254">current_timer_id_</a> = <a class="code hl_function" href="classlocalization__manager_1_1LocalizationManager.html#a357d15f4b553adac7c730e66a0b99cbf">nextId</a>();</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>            <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#ad5798343089ac239263eb82275aad228">current_timer_</a> = <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a673a02a2282dcbeff6d9df5f91c1f8d6">timer_factory_</a>-&gt;buildTimer(<a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a1b6c443414a7d5e417e365ef0bd0c254">current_timer_id_</a>, rclcpp::Duration(<a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a4caa21b1d191857bc60a786ead351554">config_</a>.<a class="code hl_variable" href="structlocalization__manager_1_1LocalizationManagerConfig.html#a0755604ab7b77f80fcd3ae0cb467099d">gnss_only_operation_timeout</a> * 1e6),</div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>                                                        std::bind(&amp;<a class="code hl_function" href="classlocalization__manager_1_1LocalizationManager.html#a180b8d484c93d7faea1a707a0d586a79">LocalizationManager::timerCallback</a>, <span class="keyword">this</span>, new_state), <span class="keyword">true</span>, <span class="keyword">true</span>);</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span> </div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>            <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#ae067b5ec0c115080299c03529f3b2861">timers_</a>[<a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a1b6c443414a7d5e417e365ef0bd0c254">current_timer_id_</a>] = std::make_pair(std::move(<a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#ad5798343089ac239263eb82275aad228">current_timer_</a>), <span class="keyword">false</span>); <span class="comment">// Add start timer to map by Id</span></div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span> </div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>        <span class="keywordflow">default</span>:</div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>        }</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>    }</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span> </div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno"><a class="line" href="classlocalization__manager_1_1LocalizationManager.html#a0ce2b35dcab57bd0abc4ad9c10f5a24e">  263</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classlocalization__manager_1_1LocalizationManager.html#a0ce2b35dcab57bd0abc4ad9c10f5a24e">LocalizationManager::posePubTick</a>()</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>    {</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>        <span class="comment">// Clear any expired timers</span></div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>        <a class="code hl_function" href="classlocalization__manager_1_1LocalizationManager.html#a83866ff4e7229989b0a265a98e3d50b4">clearTimers</a>();</div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span> </div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>        <span class="comment">// Evaluate NDT Frequency if we have started receiving messages</span></div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>        <span class="comment">// This check provides protection against excessively long NDT computation times that do not trigger the callback</span></div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#ab81bcd2a98e3d1194a8fd1f2f5794bf5">prev_ndt_stamp_</a>)</div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>        {</div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>            <span class="keywordtype">double</span> freq = <a class="code hl_function" href="classlocalization__manager_1_1LocalizationManager.html#a6a06b312cdda09ab9b945daf69710c66">computeFreq</a>(rclcpp::Time(<a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#ab81bcd2a98e3d1194a8fd1f2f5794bf5">prev_ndt_stamp_</a>.get(), <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a9d753ea64cf1496b644e9245e13f387c">timer_clock_type_</a>), <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a673a02a2282dcbeff6d9df5f91c1f8d6">timer_factory_</a>-&gt;now());</div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>            <span class="keywordflow">if</span> (freq &lt;= <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a4caa21b1d191857bc60a786ead351554">config_</a>.<a class="code hl_variable" href="structlocalization__manager_1_1LocalizationManagerConfig.html#ae0ca2842f7b10c7af545b5d3d16e87fc">ndt_frequency_fault_threshold</a>)</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>            {</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>                <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a8f6a02f44f6812384262295e1e8ad132">transition_table_</a>.<a class="code hl_function" href="classlocalization__manager_1_1LocalizationTransitionTable.html#a0f5e05d562934f0e04d7f64f9d2fd95c">signal</a>(<a class="code hl_enumvalue" href="namespacelocalization__manager.html#af61876be3f0f4998db813dd549c8bf4aa57fb0eaa7867d3c150558b918cf8c32d">LocalizationSignal::UNUSABLE_NDT_FREQ_OR_FITNESS_SCORE</a>);</div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>            }</div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (freq &lt;= <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a4caa21b1d191857bc60a786ead351554">config_</a>.<a class="code hl_variable" href="structlocalization__manager_1_1LocalizationManagerConfig.html#ae10dc543a160a4932983ca4fb8770dac">ndt_frequency_degraded_threshold</a>)</div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>            {</div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>                <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a8f6a02f44f6812384262295e1e8ad132">transition_table_</a>.<a class="code hl_function" href="classlocalization__manager_1_1LocalizationTransitionTable.html#a0f5e05d562934f0e04d7f64f9d2fd95c">signal</a>(<a class="code hl_enumvalue" href="namespacelocalization__manager.html#af61876be3f0f4998db813dd549c8bf4aa30b13d34b135451276460125d3bebae5">LocalizationSignal::POOR_NDT_FREQ_OR_FITNESS_SCORE</a>);</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>            }</div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>        }</div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span> </div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>        <span class="comment">// check if last gnss time stamp is older than threshold and send the corresponding signal</span></div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a4728052763f8223186c97e3169126062">last_raw_gnss_value_</a> &amp;&amp; <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a673a02a2282dcbeff6d9df5f91c1f8d6">timer_factory_</a>-&gt;now() - rclcpp::Time(<a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a4728052763f8223186c97e3169126062">last_raw_gnss_value_</a>-&gt;header.stamp, <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a9d753ea64cf1496b644e9245e13f387c">timer_clock_type_</a>) &gt; rclcpp::Duration(<a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a4caa21b1d191857bc60a786ead351554">config_</a>.<a class="code hl_variable" href="structlocalization__manager_1_1LocalizationManagerConfig.html#ab27470df69b8ee345f9cbcd2f668b714">gnss_data_timeout</a> * 1e6))</div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>        {</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>            <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a8f6a02f44f6812384262295e1e8ad132">transition_table_</a>.<a class="code hl_function" href="classlocalization__manager_1_1LocalizationTransitionTable.html#a0f5e05d562934f0e04d7f64f9d2fd95c">signal</a>(<a class="code hl_enumvalue" href="namespacelocalization__manager.html#af61876be3f0f4998db813dd549c8bf4aa37815e2063ce32e3d059ed60121d98e7">LocalizationSignal::GNSS_DATA_TIMEOUT</a>);</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>        }</div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span> </div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>        <span class="comment">// Used in LocalizerMode::GNSS_WITH_NDT_INIT</span></div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>        <span class="comment">// If the state is not Operational with good NDT, or already using GPS only, we reset the counter</span></div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a8f6a02f44f6812384262295e1e8ad132">transition_table_</a>.<a class="code hl_function" href="classlocalization__manager_1_1LocalizationTransitionTable.html#aeec5e1584741de33c3c5f23f3ebe529a">getState</a>() != <a class="code hl_enumvalue" href="namespacelocalization__manager.html#a539480c89bbebadc494867fa841b35d1ac97e79e14549c9f528427e36c90ae782">LocalizationState::OPERATIONAL</a> &amp;&amp;</div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>            <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a8f6a02f44f6812384262295e1e8ad132">transition_table_</a>.<a class="code hl_function" href="classlocalization__manager_1_1LocalizationTransitionTable.html#aeec5e1584741de33c3c5f23f3ebe529a">getState</a>() != <a class="code hl_enumvalue" href="namespacelocalization__manager.html#a539480c89bbebadc494867fa841b35d1a30e9fbe62db0831f32b1be44a883350c">LocalizationState::DEGRADED_NO_LIDAR_FIX</a>)</div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>        {</div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>            <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a06d56bb3fcbc47135a84653fb202dd47">lidar_init_sequential_timesteps_counter_</a> = 0;</div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;localization_manager&quot;</span>), <span class="stringliteral">&quot;Resetting lidar_init_sequential_timesteps_counter_: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a06d56bb3fcbc47135a84653fb202dd47">lidar_init_sequential_timesteps_counter_</a> &lt;&lt; <span class="stringliteral">&quot;, with new state: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a8f6a02f44f6812384262295e1e8ad132">transition_table_</a>.<a class="code hl_function" href="classlocalization__manager_1_1LocalizationTransitionTable.html#aeec5e1584741de33c3c5f23f3ebe529a">getState</a>());</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>        }</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span> </div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>        <span class="comment">// Publish current pose message if available</span></div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#ac4e5f615aa35031d88ce289d832dcb02">current_pose_</a>)</div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>        {</div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>            <span class="keyword">auto</span> pose_to_publish = *<a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#ac4e5f615aa35031d88ce289d832dcb02">current_pose_</a>;</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>            <span class="keywordflow">if</span> (<span class="keyword">static_cast&lt;</span><a class="code hl_enumeration" href="namespacelocalization__manager.html#a9b86b848ab2c2216f0987be7c5007b70">LocalizerMode</a><span class="keyword">&gt;</span>(<a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a4caa21b1d191857bc60a786ead351554">config_</a>.<a class="code hl_variable" href="structlocalization__manager_1_1LocalizationManagerConfig.html#a4a33f8febd8d330d70727a20dd242550">localization_mode</a>) == <a class="code hl_enumvalue" href="namespacelocalization__manager.html#a9b86b848ab2c2216f0987be7c5007b70a0430b40fe2d8ddf273cd76756b9ea35a">LocalizerMode::GNSS_WITH_FIXED_OFFSET</a>)</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>            {</div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>                pose_to_publish.pose.position.x += <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a4caa21b1d191857bc60a786ead351554">config_</a>.<a class="code hl_variable" href="structlocalization__manager_1_1LocalizationManagerConfig.html#aa4973d8be04cfc255e6adbb883a8b7d8">x_offset</a>;</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>                pose_to_publish.pose.position.y += <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a4caa21b1d191857bc60a786ead351554">config_</a>.<a class="code hl_variable" href="structlocalization__manager_1_1LocalizationManagerConfig.html#ab2809bbed39929923e3637be4f43c069">y_offset</a>;</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>                pose_to_publish.pose.position.z += <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a4caa21b1d191857bc60a786ead351554">config_</a>.<a class="code hl_variable" href="structlocalization__manager_1_1LocalizationManagerConfig.html#a1809d3864ece9da5caddbae982d26253">z_offset</a>;</div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>            }</div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>            <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#aa33a58bf865e068cde48d411f16e1299">pose_pub_</a>(pose_to_publish);</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>        }</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span> </div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>        <span class="comment">// Create and publish status report message</span></div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>        carma_localization_msgs::msg::LocalizationStatusReport msg = <a class="code hl_function" href="namespacelocalization__manager.html#a0dd225fbc4cf3989bc6a2b0a78b57eb8">stateToMsg</a>(<a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a8f6a02f44f6812384262295e1e8ad132">transition_table_</a>.<a class="code hl_function" href="classlocalization__manager_1_1LocalizationTransitionTable.html#aeec5e1584741de33c3c5f23f3ebe529a">getState</a>(), <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a673a02a2282dcbeff6d9df5f91c1f8d6">timer_factory_</a>-&gt;now());</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span>        <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a93edbdcc39c9116097b2ccd3249852c5">state_pub_</a>(msg);</div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>    }</div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span> </div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno"><a class="line" href="classlocalization__manager_1_1LocalizationManager.html#ab14aa24430db99e65ffc1fa52aa34dd0">  316</a></span>    <a class="code hl_enumeration" href="namespacelocalization__manager.html#a539480c89bbebadc494867fa841b35d1">LocalizationState</a> <a class="code hl_function" href="classlocalization__manager_1_1LocalizationManager.html#ab14aa24430db99e65ffc1fa52aa34dd0">LocalizationManager::getState</a>()<span class="keyword"> const</span></div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span><span class="keyword">    </span>{</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="classlocalization__manager_1_1LocalizationManager.html#a8f6a02f44f6812384262295e1e8ad132">transition_table_</a>.<a class="code hl_function" href="classlocalization__manager_1_1LocalizationTransitionTable.html#aeec5e1584741de33c3c5f23f3ebe529a">getState</a>();</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>    }</div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span> </div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>}</div>
<div class="ttc" id="aLocalizationManager_8hpp_html"><div class="ttname"><a href="LocalizationManager_8hpp.html">LocalizationManager.hpp</a></div></div>
<div class="ttc" id="aclasslocalization__manager_1_1LocalizationManager_html_a027f5aab97b4a77bdbea02a2cf585115"><div class="ttname"><a href="classlocalization__manager_1_1LocalizationManager.html#a027f5aab97b4a77bdbea02a2cf585115">localization_manager::LocalizationManager::poseAndStatsCallback</a></div><div class="ttdeci">void poseAndStatsCallback(const geometry_msgs::msg::PoseStamped::ConstPtr pose, const autoware_msgs::msg::NDTStat::ConstPtr stats)</div><div class="ttdoc">Synced callback for the NDT reported pose and status messages.</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationManager_8cpp_source.html#l00070">LocalizationManager.cpp:70</a></div></div>
<div class="ttc" id="aclasslocalization__manager_1_1LocalizationManager_html_a06d56bb3fcbc47135a84653fb202dd47"><div class="ttname"><a href="classlocalization__manager_1_1LocalizationManager.html#a06d56bb3fcbc47135a84653fb202dd47">localization_manager::LocalizationManager::lidar_init_sequential_timesteps_counter_</a></div><div class="ttdeci">int lidar_init_sequential_timesteps_counter_</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationManager_8hpp_source.html#l00150">LocalizationManager.hpp:150</a></div></div>
<div class="ttc" id="aclasslocalization__manager_1_1LocalizationManager_html_a0ce2b35dcab57bd0abc4ad9c10f5a24e"><div class="ttname"><a href="classlocalization__manager_1_1LocalizationManager.html#a0ce2b35dcab57bd0abc4ad9c10f5a24e">localization_manager::LocalizationManager::posePubTick</a></div><div class="ttdeci">void posePubTick()</div><div class="ttdoc">Timer callback that controls the publication of the selected pose and status report.</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationManager_8cpp_source.html#l00263">LocalizationManager.cpp:263</a></div></div>
<div class="ttc" id="aclasslocalization__manager_1_1LocalizationManager_html_a180b8d484c93d7faea1a707a0d586a79"><div class="ttname"><a href="classlocalization__manager_1_1LocalizationManager.html#a180b8d484c93d7faea1a707a0d586a79">localization_manager::LocalizationManager::timerCallback</a></div><div class="ttdeci">void timerCallback(const LocalizationState origin_state)</div><div class="ttdoc">Callback for timeouts. Used to trigger timeout signals for the state machine.</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationManager_8cpp_source.html#l00189">LocalizationManager.cpp:189</a></div></div>
<div class="ttc" id="aclasslocalization__manager_1_1LocalizationManager_html_a1b6c443414a7d5e417e365ef0bd0c254"><div class="ttname"><a href="classlocalization__manager_1_1LocalizationManager.html#a1b6c443414a7d5e417e365ef0bd0c254">localization_manager::LocalizationManager::current_timer_id_</a></div><div class="ttdeci">uint32_t current_timer_id_</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationManager_8hpp_source.html#l00165">LocalizationManager.hpp:165</a></div></div>
<div class="ttc" id="aclasslocalization__manager_1_1LocalizationManager_html_a2804818f7ee388d2eca7bcbd3e27f908"><div class="ttname"><a href="classlocalization__manager_1_1LocalizationManager.html#a2804818f7ee388d2eca7bcbd3e27f908">localization_manager::LocalizationManager::gnssPoseCallback</a></div><div class="ttdeci">void gnssPoseCallback(const geometry_msgs::msg::PoseStamped::SharedPtr msg)</div><div class="ttdoc">Callback for new GNSS messages.</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationManager_8cpp_source.html#l00143">LocalizationManager.cpp:143</a></div></div>
<div class="ttc" id="aclasslocalization__manager_1_1LocalizationManager_html_a357d15f4b553adac7c730e66a0b99cbf"><div class="ttname"><a href="classlocalization__manager_1_1LocalizationManager.html#a357d15f4b553adac7c730e66a0b99cbf">localization_manager::LocalizationManager::nextId</a></div><div class="ttdeci">uint32_t nextId()</div><div class="ttdoc">Generates the next id to be used for a timer.</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationManager_8cpp_source.html#l00200">LocalizationManager.cpp:200</a></div></div>
<div class="ttc" id="aclasslocalization__manager_1_1LocalizationManager_html_a37e91016dd16e328bec5041afaf5bc0c"><div class="ttname"><a href="classlocalization__manager_1_1LocalizationManager.html#a37e91016dd16e328bec5041afaf5bc0c">localization_manager::LocalizationManager::stateTransitionCallback</a></div><div class="ttdeci">void stateTransitionCallback(LocalizationState prev_state, LocalizationState new_state, LocalizationSignal signal)</div><div class="ttdoc">Callback for when a new state was triggered. Allows creation of entry/exit behavior for states.</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationManager_8cpp_source.html#l00227">LocalizationManager.cpp:227</a></div></div>
<div class="ttc" id="aclasslocalization__manager_1_1LocalizationManager_html_a39c9636657b5d522204253456836b13b"><div class="ttname"><a href="classlocalization__manager_1_1LocalizationManager.html#a39c9636657b5d522204253456836b13b">localization_manager::LocalizationManager::is_sequential_</a></div><div class="ttdeci">bool is_sequential_</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationManager_8hpp_source.html#l00151">LocalizationManager.hpp:151</a></div></div>
<div class="ttc" id="aclasslocalization__manager_1_1LocalizationManager_html_a43d2dc2970c35c4d6a12293ec240e84a"><div class="ttname"><a href="classlocalization__manager_1_1LocalizationManager.html#a43d2dc2970c35c4d6a12293ec240e84a">localization_manager::LocalizationManager::initialPoseCallback</a></div><div class="ttdeci">void initialPoseCallback(const geometry_msgs::msg::PoseWithCovarianceStamped::SharedPtr msg)</div><div class="ttdoc">Callback for the initial pose provided by Rviz or some external localization initializer.</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationManager_8cpp_source.html#l00173">LocalizationManager.cpp:173</a></div></div>
<div class="ttc" id="aclasslocalization__manager_1_1LocalizationManager_html_a4728052763f8223186c97e3169126062"><div class="ttname"><a href="classlocalization__manager_1_1LocalizationManager.html#a4728052763f8223186c97e3169126062">localization_manager::LocalizationManager::last_raw_gnss_value_</a></div><div class="ttdeci">boost::optional&lt; geometry_msgs::msg::PoseStamped &gt; last_raw_gnss_value_</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationManager_8hpp_source.html#l00152">LocalizationManager.hpp:152</a></div></div>
<div class="ttc" id="aclasslocalization__manager_1_1LocalizationManager_html_a4caa21b1d191857bc60a786ead351554"><div class="ttname"><a href="classlocalization__manager_1_1LocalizationManager.html#a4caa21b1d191857bc60a786ead351554">localization_manager::LocalizationManager::config_</a></div><div class="ttdeci">LocalizationManagerConfig config_</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationManager_8hpp_source.html#l00144">LocalizationManager.hpp:144</a></div></div>
<div class="ttc" id="aclasslocalization__manager_1_1LocalizationManager_html_a56f2d3375a21dea78754e388dac1997e"><div class="ttname"><a href="classlocalization__manager_1_1LocalizationManager.html#a56f2d3375a21dea78754e388dac1997e">localization_manager::LocalizationManager::next_id_</a></div><div class="ttdeci">uint32_t next_id_</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationManager_8hpp_source.html#l00164">LocalizationManager.hpp:164</a></div></div>
<div class="ttc" id="aclasslocalization__manager_1_1LocalizationManager_html_a673a02a2282dcbeff6d9df5f91c1f8d6"><div class="ttname"><a href="classlocalization__manager_1_1LocalizationManager.html#a673a02a2282dcbeff6d9df5f91c1f8d6">localization_manager::LocalizationManager::timer_factory_</a></div><div class="ttdeci">std::unique_ptr&lt; carma_ros2_utils::timers::TimerFactory &gt; timer_factory_</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationManager_8hpp_source.html#l00161">LocalizationManager.hpp:161</a></div></div>
<div class="ttc" id="aclasslocalization__manager_1_1LocalizationManager_html_a6a06b312cdda09ab9b945daf69710c66"><div class="ttname"><a href="classlocalization__manager_1_1LocalizationManager.html#a6a06b312cdda09ab9b945daf69710c66">localization_manager::LocalizationManager::computeFreq</a></div><div class="ttdeci">double computeFreq(const rclcpp::Time &amp;old_stamp, const rclcpp::Time &amp;new_stamp) const</div><div class="ttdoc">Helper function to compute the instantaneous frequency between two times.</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationManager_8cpp_source.html#l00041">LocalizationManager.cpp:41</a></div></div>
<div class="ttc" id="aclasslocalization__manager_1_1LocalizationManager_html_a6b70bd02d34a73dfc7b05ae9e63d0502"><div class="ttname"><a href="classlocalization__manager_1_1LocalizationManager.html#a6b70bd02d34a73dfc7b05ae9e63d0502">localization_manager::LocalizationManager::mutex_</a></div><div class="ttdeci">std::mutex mutex_</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationManager_8hpp_source.html#l00160">LocalizationManager.hpp:160</a></div></div>
<div class="ttc" id="aclasslocalization__manager_1_1LocalizationManager_html_a7b5d0959c7592ae97ad032a3e1e9f2a3"><div class="ttname"><a href="classlocalization__manager_1_1LocalizationManager.html#a7b5d0959c7592ae97ad032a3e1e9f2a3">localization_manager::LocalizationManager::StatePublisher</a></div><div class="ttdeci">std::function&lt; void(const carma_localization_msgs::msg::LocalizationStatusReport &amp;)&gt; StatePublisher</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationManager_8hpp_source.html#l00046">LocalizationManager.hpp:46</a></div></div>
<div class="ttc" id="aclasslocalization__manager_1_1LocalizationManager_html_a83866ff4e7229989b0a265a98e3d50b4"><div class="ttname"><a href="classlocalization__manager_1_1LocalizationManager.html#a83866ff4e7229989b0a265a98e3d50b4">localization_manager::LocalizationManager::clearTimers</a></div><div class="ttdeci">void clearTimers()</div><div class="ttdoc">Clears the expired timers from the memory of this scheduler.</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationManager_8cpp_source.html#l00206">LocalizationManager.cpp:206</a></div></div>
<div class="ttc" id="aclasslocalization__manager_1_1LocalizationManager_html_a852f8fa433424784ce64e712a5f1a9e6"><div class="ttname"><a href="classlocalization__manager_1_1LocalizationManager.html#a852f8fa433424784ce64e712a5f1a9e6">localization_manager::LocalizationManager::LIDAR_FAILURE_STRINGS</a></div><div class="ttdeci">static const std::unordered_set&lt; std::string &gt; LIDAR_FAILURE_STRINGS</div><div class="ttdoc">The set of strings which mark a lidar failure in a system alert message.</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationManager_8hpp_source.html#l00138">LocalizationManager.hpp:138</a></div></div>
<div class="ttc" id="aclasslocalization__manager_1_1LocalizationManager_html_a8f6a02f44f6812384262295e1e8ad132"><div class="ttname"><a href="classlocalization__manager_1_1LocalizationManager.html#a8f6a02f44f6812384262295e1e8ad132">localization_manager::LocalizationManager::transition_table_</a></div><div class="ttdeci">LocalizationTransitionTable transition_table_</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationManager_8hpp_source.html#l00146">LocalizationManager.hpp:146</a></div></div>
<div class="ttc" id="aclasslocalization__manager_1_1LocalizationManager_html_a93edbdcc39c9116097b2ccd3249852c5"><div class="ttname"><a href="classlocalization__manager_1_1LocalizationManager.html#a93edbdcc39c9116097b2ccd3249852c5">localization_manager::LocalizationManager::state_pub_</a></div><div class="ttdeci">StatePublisher state_pub_</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationManager_8hpp_source.html#l00141">LocalizationManager.hpp:141</a></div></div>
<div class="ttc" id="aclasslocalization__manager_1_1LocalizationManager_html_a9d753ea64cf1496b644e9245e13f387c"><div class="ttname"><a href="classlocalization__manager_1_1LocalizationManager.html#a9d753ea64cf1496b644e9245e13f387c">localization_manager::LocalizationManager::timer_clock_type_</a></div><div class="ttdeci">rcl_clock_type_t timer_clock_type_</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationManager_8hpp_source.html#l00166">LocalizationManager.hpp:166</a></div></div>
<div class="ttc" id="aclasslocalization__manager_1_1LocalizationManager_html_a9e4c9b82f1d519c27cc82bc5c9231121"><div class="ttname"><a href="classlocalization__manager_1_1LocalizationManager.html#a9e4c9b82f1d519c27cc82bc5c9231121">localization_manager::LocalizationManager::systemAlertCallback</a></div><div class="ttdeci">void systemAlertCallback(const carma_msgs::msg::SystemAlert::SharedPtr alert)</div><div class="ttdoc">Callback for SystemAlert data. Used to check for lidar failure.</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationManager_8cpp_source.html#l00181">LocalizationManager.cpp:181</a></div></div>
<div class="ttc" id="aclasslocalization__manager_1_1LocalizationManager_html_aa33a58bf865e068cde48d411f16e1299"><div class="ttname"><a href="classlocalization__manager_1_1LocalizationManager.html#aa33a58bf865e068cde48d411f16e1299">localization_manager::LocalizationManager::pose_pub_</a></div><div class="ttdeci">PosePublisher pose_pub_</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationManager_8hpp_source.html#l00140">LocalizationManager.hpp:140</a></div></div>
<div class="ttc" id="aclasslocalization__manager_1_1LocalizationManager_html_aafd6886f83ce04f8d2c49ca0b85b9a9a"><div class="ttname"><a href="classlocalization__manager_1_1LocalizationManager.html#aafd6886f83ce04f8d2c49ca0b85b9a9a">localization_manager::LocalizationManager::gnss_offset_</a></div><div class="ttdeci">boost::optional&lt; tf2::Vector3 &gt; gnss_offset_</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationManager_8hpp_source.html#l00153">LocalizationManager.hpp:153</a></div></div>
<div class="ttc" id="aclasslocalization__manager_1_1LocalizationManager_html_ab14aa24430db99e65ffc1fa52aa34dd0"><div class="ttname"><a href="classlocalization__manager_1_1LocalizationManager.html#ab14aa24430db99e65ffc1fa52aa34dd0">localization_manager::LocalizationManager::getState</a></div><div class="ttdeci">LocalizationState getState() const</div><div class="ttdoc">Returns the current localization state.</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationManager_8cpp_source.html#l00316">LocalizationManager.cpp:316</a></div></div>
<div class="ttc" id="aclasslocalization__manager_1_1LocalizationManager_html_ab81bcd2a98e3d1194a8fd1f2f5794bf5"><div class="ttname"><a href="classlocalization__manager_1_1LocalizationManager.html#ab81bcd2a98e3d1194a8fd1f2f5794bf5">localization_manager::LocalizationManager::prev_ndt_stamp_</a></div><div class="ttdeci">boost::optional&lt; rclcpp::Time &gt; prev_ndt_stamp_</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationManager_8hpp_source.html#l00148">LocalizationManager.hpp:148</a></div></div>
<div class="ttc" id="aclasslocalization__manager_1_1LocalizationManager_html_ac4e5f615aa35031d88ce289d832dcb02"><div class="ttname"><a href="classlocalization__manager_1_1LocalizationManager.html#ac4e5f615aa35031d88ce289d832dcb02">localization_manager::LocalizationManager::current_pose_</a></div><div class="ttdeci">boost::optional&lt; geometry_msgs::msg::PoseStamped &gt; current_pose_</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationManager_8hpp_source.html#l00154">LocalizationManager.hpp:154</a></div></div>
<div class="ttc" id="aclasslocalization__manager_1_1LocalizationManager_html_ac75e2c2af5e2a75a6ee3ce23ce2a290d"><div class="ttname"><a href="classlocalization__manager_1_1LocalizationManager.html#ac75e2c2af5e2a75a6ee3ce23ce2a290d">localization_manager::LocalizationManager::PosePublisher</a></div><div class="ttdeci">std::function&lt; void(const geometry_msgs::msg::PoseStamped &amp;)&gt; PosePublisher</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationManager_8hpp_source.html#l00044">LocalizationManager.hpp:44</a></div></div>
<div class="ttc" id="aclasslocalization__manager_1_1LocalizationManager_html_acbb7d81be472c3ec96f3d700b7ca823c"><div class="ttname"><a href="classlocalization__manager_1_1LocalizationManager.html#acbb7d81be472c3ec96f3d700b7ca823c">localization_manager::LocalizationManager::LocalizationManager</a></div><div class="ttdeci">LocalizationManager(PosePublisher pose_pub, StatePublisher state_pub, ManagedInitialPosePublisher initialpose_pub, const LocalizationManagerConfig &amp;config, rclcpp::node_interfaces::NodeLoggingInterface::SharedPtr logger, std::unique_ptr&lt; carma_ros2_utils::timers::TimerFactory &gt; timer_factory)</div><div class="ttdoc">Constructor.</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationManager_8cpp_source.html#l00026">LocalizationManager.cpp:26</a></div></div>
<div class="ttc" id="aclasslocalization__manager_1_1LocalizationManager_html_ace5b1b34adeeab50c2b3d47591e6c7c9"><div class="ttname"><a href="classlocalization__manager_1_1LocalizationManager.html#ace5b1b34adeeab50c2b3d47591e6c7c9">localization_manager::LocalizationManager::computeNDTFreq</a></div><div class="ttdeci">double computeNDTFreq(const rclcpp::Time &amp;new_stamp)</div><div class="ttdoc">Helper function to both compute the NDT Frequency and update the previous pose timestamp.</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationManager_8cpp_source.html#l00051">LocalizationManager.cpp:51</a></div></div>
<div class="ttc" id="aclasslocalization__manager_1_1LocalizationManager_html_ad26090538f61ea866d2e4729ab6a0a91"><div class="ttname"><a href="classlocalization__manager_1_1LocalizationManager.html#ad26090538f61ea866d2e4729ab6a0a91">localization_manager::LocalizationManager::setConfig</a></div><div class="ttdeci">void setConfig(const LocalizationManagerConfig &amp;config)</div><div class="ttdoc">Set config.</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationManager_8cpp_source.html#l00046">LocalizationManager.cpp:46</a></div></div>
<div class="ttc" id="aclasslocalization__manager_1_1LocalizationManager_html_ad5798343089ac239263eb82275aad228"><div class="ttname"><a href="classlocalization__manager_1_1LocalizationManager.html#ad5798343089ac239263eb82275aad228">localization_manager::LocalizationManager::current_timer_</a></div><div class="ttdeci">TimerUniquePtr current_timer_</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationManager_8hpp_source.html#l00163">LocalizationManager.hpp:163</a></div></div>
<div class="ttc" id="aclasslocalization__manager_1_1LocalizationManager_html_ad607aaab0ad2cc47bc4793106f54616e"><div class="ttname"><a href="classlocalization__manager_1_1LocalizationManager.html#ad607aaab0ad2cc47bc4793106f54616e">localization_manager::LocalizationManager::initialpose_pub_</a></div><div class="ttdeci">ManagedInitialPosePublisher initialpose_pub_</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationManager_8hpp_source.html#l00142">LocalizationManager.hpp:142</a></div></div>
<div class="ttc" id="aclasslocalization__manager_1_1LocalizationManager_html_ae067b5ec0c115080299c03529f3b2861"><div class="ttname"><a href="classlocalization__manager_1_1LocalizationManager.html#ae067b5ec0c115080299c03529f3b2861">localization_manager::LocalizationManager::timers_</a></div><div class="ttdeci">std::unordered_map&lt; uint32_t, std::pair&lt; TimerUniquePtr, bool &gt; &gt; timers_</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationManager_8hpp_source.html#l00162">LocalizationManager.hpp:162</a></div></div>
<div class="ttc" id="aclasslocalization__manager_1_1LocalizationManager_html_aef7191d344d1c87a83903453ab82eb76"><div class="ttname"><a href="classlocalization__manager_1_1LocalizationManager.html#aef7191d344d1c87a83903453ab82eb76">localization_manager::LocalizationManager::ManagedInitialPosePublisher</a></div><div class="ttdeci">std::function&lt; void(const geometry_msgs::msg::PoseWithCovarianceStamped &amp;)&gt; ManagedInitialPosePublisher</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationManager_8hpp_source.html#l00045">LocalizationManager.hpp:45</a></div></div>
<div class="ttc" id="aclasslocalization__manager_1_1LocalizationTransitionTable_html_a0f5e05d562934f0e04d7f64f9d2fd95c"><div class="ttname"><a href="classlocalization__manager_1_1LocalizationTransitionTable.html#a0f5e05d562934f0e04d7f64f9d2fd95c">localization_manager::LocalizationTransitionTable::signal</a></div><div class="ttdeci">void signal(LocalizationSignal signal)</div><div class="ttdoc">Trigger signal for the transition table.</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationTransitionTable_8cpp_source.html#l00219">LocalizationTransitionTable.cpp:219</a></div></div>
<div class="ttc" id="aclasslocalization__manager_1_1LocalizationTransitionTable_html_aeec5e1584741de33c3c5f23f3ebe529a"><div class="ttname"><a href="classlocalization__manager_1_1LocalizationTransitionTable.html#aeec5e1584741de33c3c5f23f3ebe529a">localization_manager::LocalizationTransitionTable::getState</a></div><div class="ttdeci">LocalizationState getState() const</div><div class="ttdoc">Returns the current state.</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationTransitionTable_8cpp_source.html#l00024">LocalizationTransitionTable.cpp:24</a></div></div>
<div class="ttc" id="aclasslocalization__manager_1_1LocalizationTransitionTable_html_af6e9734499a3487b0f6c732466804a66"><div class="ttname"><a href="classlocalization__manager_1_1LocalizationTransitionTable.html#af6e9734499a3487b0f6c732466804a66">localization_manager::LocalizationTransitionTable::setTransitionCallback</a></div><div class="ttdeci">void setTransitionCallback(TransitionCallback cb)</div><div class="ttdoc">Callback setting function. The provided callback will be triggered any time the current state changes...</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationTransitionTable_8cpp_source.html#l00247">LocalizationTransitionTable.cpp:247</a></div></div>
<div class="ttc" id="anamespacelocalization__manager_html"><div class="ttname"><a href="namespacelocalization__manager.html">localization_manager</a></div><div class="ttdef"><b>Definition:</b> <a href="localization__manager__node_8hpp_source.html#l00039">localization_manager_node.hpp:40</a></div></div>
<div class="ttc" id="anamespacelocalization__manager_html_a0dd225fbc4cf3989bc6a2b0a78b57eb8"><div class="ttname"><a href="namespacelocalization__manager.html#a0dd225fbc4cf3989bc6a2b0a78b57eb8">localization_manager::stateToMsg</a></div><div class="ttdeci">carma_localization_msgs::msg::LocalizationStatusReport stateToMsg(LocalizationState state, const rclcpp::Time &amp;stamp)</div><div class="ttdoc">Helper function to convert LocalizationState objects into LocalizationStatusReport ROS messages.</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationTypes_8cpp_source.html#l00068">LocalizationTypes.cpp:68</a></div></div>
<div class="ttc" id="anamespacelocalization__manager_html_a539480c89bbebadc494867fa841b35d1"><div class="ttname"><a href="namespacelocalization__manager.html#a539480c89bbebadc494867fa841b35d1">localization_manager::LocalizationState</a></div><div class="ttdeci">LocalizationState</div><div class="ttdoc">Enum describing the possible states of the localization system.</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationTypes_8hpp_source.html#l00041">LocalizationTypes.hpp:42</a></div></div>
<div class="ttc" id="anamespacelocalization__manager_html_a539480c89bbebadc494867fa841b35d1a30e9fbe62db0831f32b1be44a883350c"><div class="ttname"><a href="namespacelocalization__manager.html#a539480c89bbebadc494867fa841b35d1a30e9fbe62db0831f32b1be44a883350c">localization_manager::LocalizationState::DEGRADED_NO_LIDAR_FIX</a></div><div class="ttdeci">@ DEGRADED_NO_LIDAR_FIX</div></div>
<div class="ttc" id="anamespacelocalization__manager_html_a539480c89bbebadc494867fa841b35d1a86bf8c89d85949f8f45cde2f73fce113"><div class="ttname"><a href="namespacelocalization__manager.html#a539480c89bbebadc494867fa841b35d1a86bf8c89d85949f8f45cde2f73fce113">localization_manager::LocalizationState::INITIALIZING</a></div><div class="ttdeci">@ INITIALIZING</div></div>
<div class="ttc" id="anamespacelocalization__manager_html_a539480c89bbebadc494867fa841b35d1ac97e79e14549c9f528427e36c90ae782"><div class="ttname"><a href="namespacelocalization__manager.html#a539480c89bbebadc494867fa841b35d1ac97e79e14549c9f528427e36c90ae782">localization_manager::LocalizationState::OPERATIONAL</a></div><div class="ttdeci">@ OPERATIONAL</div></div>
<div class="ttc" id="anamespacelocalization__manager_html_a539480c89bbebadc494867fa841b35d1add652546039b18970b8dcf2cff824268"><div class="ttname"><a href="namespacelocalization__manager.html#a539480c89bbebadc494867fa841b35d1add652546039b18970b8dcf2cff824268">localization_manager::LocalizationState::UNINITIALIZED</a></div><div class="ttdeci">@ UNINITIALIZED</div></div>
<div class="ttc" id="anamespacelocalization__manager_html_a9b86b848ab2c2216f0987be7c5007b70"><div class="ttname"><a href="namespacelocalization__manager.html#a9b86b848ab2c2216f0987be7c5007b70">localization_manager::LocalizerMode</a></div><div class="ttdeci">LocalizerMode</div><div class="ttdoc">Enum describing the possible operational modes of the LocalizationManager.</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationTypes_8hpp_source.html#l00025">LocalizationTypes.hpp:26</a></div></div>
<div class="ttc" id="anamespacelocalization__manager_html_a9b86b848ab2c2216f0987be7c5007b70a0430b40fe2d8ddf273cd76756b9ea35a"><div class="ttname"><a href="namespacelocalization__manager.html#a9b86b848ab2c2216f0987be7c5007b70a0430b40fe2d8ddf273cd76756b9ea35a">localization_manager::GNSS_WITH_FIXED_OFFSET</a></div><div class="ttdeci">@ GNSS_WITH_FIXED_OFFSET</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationTypes_8hpp_source.html#l00033">LocalizationTypes.hpp:32</a></div></div>
<div class="ttc" id="anamespacelocalization__manager_html_a9b86b848ab2c2216f0987be7c5007b70a90db69d58f7274bfad34570f2fdce99c"><div class="ttname"><a href="namespacelocalization__manager.html#a9b86b848ab2c2216f0987be7c5007b70a90db69d58f7274bfad34570f2fdce99c">localization_manager::GNSS_WITH_NDT_INIT</a></div><div class="ttdeci">@ GNSS_WITH_NDT_INIT</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationTypes_8hpp_source.html#l00031">LocalizationTypes.hpp:31</a></div></div>
<div class="ttc" id="anamespacelocalization__manager_html_af61876be3f0f4998db813dd549c8bf4a"><div class="ttname"><a href="namespacelocalization__manager.html#af61876be3f0f4998db813dd549c8bf4a">localization_manager::LocalizationSignal</a></div><div class="ttdeci">LocalizationSignal</div><div class="ttdoc">Enum describing the possible signals to change the current LocalizationState.</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationTypes_8hpp_source.html#l00067">LocalizationTypes.hpp:68</a></div></div>
<div class="ttc" id="anamespacelocalization__manager_html_af61876be3f0f4998db813dd549c8bf4aa070a0fb40f6c308ab544b227660aadff"><div class="ttname"><a href="namespacelocalization__manager.html#af61876be3f0f4998db813dd549c8bf4aa070a0fb40f6c308ab544b227660aadff">localization_manager::LocalizationSignal::TIMEOUT</a></div><div class="ttdeci">@ TIMEOUT</div></div>
<div class="ttc" id="anamespacelocalization__manager_html_af61876be3f0f4998db813dd549c8bf4aa30b13d34b135451276460125d3bebae5"><div class="ttname"><a href="namespacelocalization__manager.html#af61876be3f0f4998db813dd549c8bf4aa30b13d34b135451276460125d3bebae5">localization_manager::LocalizationSignal::POOR_NDT_FREQ_OR_FITNESS_SCORE</a></div><div class="ttdeci">@ POOR_NDT_FREQ_OR_FITNESS_SCORE</div></div>
<div class="ttc" id="anamespacelocalization__manager_html_af61876be3f0f4998db813dd549c8bf4aa37815e2063ce32e3d059ed60121d98e7"><div class="ttname"><a href="namespacelocalization__manager.html#af61876be3f0f4998db813dd549c8bf4aa37815e2063ce32e3d059ed60121d98e7">localization_manager::LocalizationSignal::GNSS_DATA_TIMEOUT</a></div><div class="ttdeci">@ GNSS_DATA_TIMEOUT</div></div>
<div class="ttc" id="anamespacelocalization__manager_html_af61876be3f0f4998db813dd549c8bf4aa3abd129e0314ad9fd7f7587a2465d94b"><div class="ttname"><a href="namespacelocalization__manager.html#af61876be3f0f4998db813dd549c8bf4aa3abd129e0314ad9fd7f7587a2465d94b">localization_manager::LocalizationSignal::INITIAL_POSE</a></div><div class="ttdeci">@ INITIAL_POSE</div></div>
<div class="ttc" id="anamespacelocalization__manager_html_af61876be3f0f4998db813dd549c8bf4aa57fb0eaa7867d3c150558b918cf8c32d"><div class="ttname"><a href="namespacelocalization__manager.html#af61876be3f0f4998db813dd549c8bf4aa57fb0eaa7867d3c150558b918cf8c32d">localization_manager::LocalizationSignal::UNUSABLE_NDT_FREQ_OR_FITNESS_SCORE</a></div><div class="ttdeci">@ UNUSABLE_NDT_FREQ_OR_FITNESS_SCORE</div></div>
<div class="ttc" id="anamespacelocalization__manager_html_af61876be3f0f4998db813dd549c8bf4aa6b2aa1c5eb86ace61332b4358866497e"><div class="ttname"><a href="namespacelocalization__manager.html#af61876be3f0f4998db813dd549c8bf4aa6b2aa1c5eb86ace61332b4358866497e">localization_manager::LocalizationSignal::LIDAR_SENSOR_FAILURE</a></div><div class="ttdeci">@ LIDAR_SENSOR_FAILURE</div></div>
<div class="ttc" id="anamespacelocalization__manager_html_af61876be3f0f4998db813dd549c8bf4aaa0e8cc642780818952c89ed5c6626a78"><div class="ttname"><a href="namespacelocalization__manager.html#af61876be3f0f4998db813dd549c8bf4aaa0e8cc642780818952c89ed5c6626a78">localization_manager::LocalizationSignal::GOOD_NDT_FREQ_AND_FITNESS_SCORE</a></div><div class="ttdeci">@ GOOD_NDT_FREQ_AND_FITNESS_SCORE</div></div>
<div class="ttc" id="anamespacelocalization__manager_html_af61876be3f0f4998db813dd549c8bf4aaaa3e4a1e1b08ccd33ff7cfb1d64aa575"><div class="ttname"><a href="namespacelocalization__manager.html#af61876be3f0f4998db813dd549c8bf4aaaa3e4a1e1b08ccd33ff7cfb1d64aa575">localization_manager::LocalizationSignal::LIDAR_INITIALIZED_SWITCH_TO_GPS</a></div><div class="ttdeci">@ LIDAR_INITIALIZED_SWITCH_TO_GPS</div></div>
<div class="ttc" id="astdint_8h_html_a435d1572bf3f880d55459d9805097f62"><div class="ttname"><a href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a></div><div class="ttdeci">unsigned int uint32_t</div><div class="ttdef"><b>Definition:</b> <a href="stdint_8h_source.html#l00126">stdint.h:126</a></div></div>
<div class="ttc" id="astructlocalization__manager_1_1LocalizationManagerConfig_html"><div class="ttname"><a href="structlocalization__manager_1_1LocalizationManagerConfig.html">localization_manager::LocalizationManagerConfig</a></div><div class="ttdoc">Struct to store the configuration settings for the LocalizationManager class.</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationManagerConfig_8hpp_source.html#l00024">LocalizationManagerConfig.hpp:25</a></div></div>
<div class="ttc" id="astructlocalization__manager_1_1LocalizationManagerConfig_html_a0755604ab7b77f80fcd3ae0cb467099d"><div class="ttname"><a href="structlocalization__manager_1_1LocalizationManagerConfig.html#a0755604ab7b77f80fcd3ae0cb467099d">localization_manager::LocalizationManagerConfig::gnss_only_operation_timeout</a></div><div class="ttdeci">int gnss_only_operation_timeout</div><div class="ttdoc">Timeout in ms for GNSS only operation. Ignored when in GNSS mode.</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationManagerConfig_8hpp_source.html#l00040">LocalizationManagerConfig.hpp:40</a></div></div>
<div class="ttc" id="astructlocalization__manager_1_1LocalizationManagerConfig_html_a0cdb308c05aa70c80687938f4f043949"><div class="ttname"><a href="structlocalization__manager_1_1LocalizationManagerConfig.html#a0cdb308c05aa70c80687938f4f043949">localization_manager::LocalizationManagerConfig::fitness_score_fault_threshold</a></div><div class="ttdeci">double fitness_score_fault_threshold</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationManagerConfig_8hpp_source.html#l00030">LocalizationManagerConfig.hpp:30</a></div></div>
<div class="ttc" id="astructlocalization__manager_1_1LocalizationManagerConfig_html_a1809d3864ece9da5caddbae982d26253"><div class="ttname"><a href="structlocalization__manager_1_1LocalizationManagerConfig.html#a1809d3864ece9da5caddbae982d26253">localization_manager::LocalizationManagerConfig::z_offset</a></div><div class="ttdeci">double z_offset</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationManagerConfig_8hpp_source.html#l00053">LocalizationManagerConfig.hpp:53</a></div></div>
<div class="ttc" id="astructlocalization__manager_1_1LocalizationManagerConfig_html_a37547042fb173223e33c8a1a7ecb5b1a"><div class="ttname"><a href="structlocalization__manager_1_1LocalizationManagerConfig.html#a37547042fb173223e33c8a1a7ecb5b1a">localization_manager::LocalizationManagerConfig::fitness_score_degraded_threshold</a></div><div class="ttdeci">double fitness_score_degraded_threshold</div><div class="ttdoc">NDT Fitness score above which the localization is considered in a degraded state.</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationManagerConfig_8hpp_source.html#l00027">LocalizationManagerConfig.hpp:27</a></div></div>
<div class="ttc" id="astructlocalization__manager_1_1LocalizationManagerConfig_html_a4a33f8febd8d330d70727a20dd242550"><div class="ttname"><a href="structlocalization__manager_1_1LocalizationManagerConfig.html#a4a33f8febd8d330d70727a20dd242550">localization_manager::LocalizationManagerConfig::localization_mode</a></div><div class="ttdeci">int localization_mode</div><div class="ttdoc">Localization mode to use.</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationManagerConfig_8hpp_source.html#l00047">LocalizationManagerConfig.hpp:47</a></div></div>
<div class="ttc" id="astructlocalization__manager_1_1LocalizationManagerConfig_html_a815937ae2f121dea77ae1308f666a1f9"><div class="ttname"><a href="structlocalization__manager_1_1LocalizationManagerConfig.html#a815937ae2f121dea77ae1308f666a1f9">localization_manager::LocalizationManagerConfig::auto_initialization_timeout</a></div><div class="ttdeci">int auto_initialization_timeout</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationManagerConfig_8hpp_source.html#l00038">LocalizationManagerConfig.hpp:38</a></div></div>
<div class="ttc" id="astructlocalization__manager_1_1LocalizationManagerConfig_html_aa4973d8be04cfc255e6adbb883a8b7d8"><div class="ttname"><a href="structlocalization__manager_1_1LocalizationManagerConfig.html#aa4973d8be04cfc255e6adbb883a8b7d8">localization_manager::LocalizationManagerConfig::x_offset</a></div><div class="ttdeci">double x_offset</div><div class="ttdoc">GPS Offset to apply if that mode is enabled.</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationManagerConfig_8hpp_source.html#l00051">LocalizationManagerConfig.hpp:51</a></div></div>
<div class="ttc" id="astructlocalization__manager_1_1LocalizationManagerConfig_html_ab27470df69b8ee345f9cbcd2f668b714"><div class="ttname"><a href="structlocalization__manager_1_1LocalizationManagerConfig.html#ab27470df69b8ee345f9cbcd2f668b714">localization_manager::LocalizationManagerConfig::gnss_data_timeout</a></div><div class="ttdeci">int gnss_data_timeout</div><div class="ttdoc">GNSS Data timeout. If exceeded the system will assume the GNSS is no longer functional....</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationManagerConfig_8hpp_source.html#l00045">LocalizationManagerConfig.hpp:45</a></div></div>
<div class="ttc" id="astructlocalization__manager_1_1LocalizationManagerConfig_html_ab2809bbed39929923e3637be4f43c069"><div class="ttname"><a href="structlocalization__manager_1_1LocalizationManagerConfig.html#ab2809bbed39929923e3637be4f43c069">localization_manager::LocalizationManagerConfig::y_offset</a></div><div class="ttdeci">double y_offset</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationManagerConfig_8hpp_source.html#l00052">LocalizationManagerConfig.hpp:52</a></div></div>
<div class="ttc" id="astructlocalization__manager_1_1LocalizationManagerConfig_html_ae0ca2842f7b10c7af545b5d3d16e87fc"><div class="ttname"><a href="structlocalization__manager_1_1LocalizationManagerConfig.html#ae0ca2842f7b10c7af545b5d3d16e87fc">localization_manager::LocalizationManagerConfig::ndt_frequency_fault_threshold</a></div><div class="ttdeci">double ndt_frequency_fault_threshold</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationManagerConfig_8hpp_source.html#l00035">LocalizationManagerConfig.hpp:35</a></div></div>
<div class="ttc" id="astructlocalization__manager_1_1LocalizationManagerConfig_html_ae10dc543a160a4932983ca4fb8770dac"><div class="ttname"><a href="structlocalization__manager_1_1LocalizationManagerConfig.html#ae10dc543a160a4932983ca4fb8770dac">localization_manager::LocalizationManagerConfig::ndt_frequency_degraded_threshold</a></div><div class="ttdeci">double ndt_frequency_degraded_threshold</div><div class="ttdoc">NDT solution frequency below which the localization is considered in a degraded state.</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationManagerConfig_8hpp_source.html#l00032">LocalizationManagerConfig.hpp:32</a></div></div>
<div class="ttc" id="astructlocalization__manager_1_1LocalizationManagerConfig_html_aed78bd42d681c0ace463dddc4dbf36f1"><div class="ttname"><a href="structlocalization__manager_1_1LocalizationManagerConfig.html#aed78bd42d681c0ace463dddc4dbf36f1">localization_manager::LocalizationManagerConfig::sequential_timesteps_until_gps_operation</a></div><div class="ttdeci">int sequential_timesteps_until_gps_operation</div><div class="ttdef"><b>Definition:</b> <a href="LocalizationManagerConfig_8hpp_source.html#l00043">LocalizationManagerConfig.hpp:43</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_5e0ca44c07024f7586a0751084a58b32.html">localization_manager</a></li><li class="navelem"><a class="el" href="dir_7b6475aba64bc5ad640d5aa6002b9a27.html">src</a></li><li class="navelem"><a class="el" href="LocalizationManager_8cpp.html">LocalizationManager.cpp</a></li>
    <li class="footer">Generated on Tue Jan 2 2024 16:06:03 for Carma-platform by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4 </li>
  </ul>
</div>
</body>
</html>
