<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Carma-streets: streets_vehicle_scheduler::vehicle_scheduler Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Carma-streets<span id="projectnumber">&#160;v4.2.0</span>
   </div>
   <div id="projectbrief">CARMA Streets is a component of CARMA ecosystem that improves the efficiency and performance of the Transportation Systems Management and Operations (TSMO) strategies.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classstreets__vehicle__scheduler_1_1vehicle__scheduler.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classstreets__vehicle__scheduler_1_1vehicle__scheduler-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">streets_vehicle_scheduler::vehicle_scheduler Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div></div>
</div><!--header-->
<div class="contents">

<p>Abstract Class for extend to implement scheduling business logic.  
 <a href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="vehicle__scheduler_8h_source.html">vehicle_scheduler.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for streets_vehicle_scheduler::vehicle_scheduler:</div>
<div class="dyncontent">
<div class="center"><img src="classstreets__vehicle__scheduler_1_1vehicle__scheduler__inherit__graph.png" border="0" usemap="#astreets__vehicle__scheduler_1_1vehicle__scheduler_inherit__map" alt="Inheritance graph"/></div>
<map name="astreets__vehicle__scheduler_1_1vehicle__scheduler_inherit__map" id="astreets__vehicle__scheduler_1_1vehicle__scheduler_inherit__map">
<area shape="rect" title="Abstract Class for extend to implement scheduling business logic." alt="" coords="133,5,306,215"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html" title=" " alt="" coords="5,270,209,831"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler.html" title=" " alt="" coords="233,263,429,839"/>
</map>
</div>
<div class="dynheader">
Collaboration diagram for streets_vehicle_scheduler::vehicle_scheduler:</div>
<div class="dyncontent">
<div class="center"><img src="classstreets__vehicle__scheduler_1_1vehicle__scheduler__coll__graph.png" border="0" usemap="#astreets__vehicle__scheduler_1_1vehicle__scheduler_coll__map" alt="Collaboration graph"/></div>
<map name="astreets__vehicle__scheduler_1_1vehicle__scheduler_coll__map" id="astreets__vehicle__scheduler_1_1vehicle__scheduler_coll__map">
<area shape="rect" title="Abstract Class for extend to implement scheduling business logic." alt="" coords="5,160,179,369"/>
<area shape="rect" title=" " alt="" coords="13,5,171,97"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a26f9acdf3e3fa08c8025bf4daebd1376"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#a26f9acdf3e3fa08c8025bf4daebd1376">vehicle_scheduler</a> ()=default</td></tr>
<tr class="memdesc:a26f9acdf3e3fa08c8025bf4daebd1376"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct a new vehicle scheduler object.  <a href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#a26f9acdf3e3fa08c8025bf4daebd1376">More...</a><br /></td></tr>
<tr class="separator:a26f9acdf3e3fa08c8025bf4daebd1376"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4ebf26e4aae6538e7481220b2df3488"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#ab4ebf26e4aae6538e7481220b2df3488">~vehicle_scheduler</a> ()=default</td></tr>
<tr class="memdesc:ab4ebf26e4aae6538e7481220b2df3488"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroy the vehicle scheduler object.  <a href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#ab4ebf26e4aae6538e7481220b2df3488">More...</a><br /></td></tr>
<tr class="separator:ab4ebf26e4aae6538e7481220b2df3488"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68ae44ddfa8ae16f298b2798ed93b9d2"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#a68ae44ddfa8ae16f298b2798ed93b9d2">schedule_vehicles</a> (std::unordered_map&lt; std::string, <a class="el" href="structstreets__vehicles_1_1vehicle.html">streets_vehicles::vehicle</a> &gt; &amp;vehicles, std::shared_ptr&lt; <a class="el" href="structstreets__vehicle__scheduler_1_1intersection__schedule.html">intersection_schedule</a> &gt; &amp;schedule)=0</td></tr>
<tr class="memdesc:a68ae44ddfa8ae16f298b2798ed93b9d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Virtual method to schedule vehicle. Different implementations of vehicle scheduler can implement custom business logic for scheduling vehicle while taking advantage of polymorphism to dynamically assign class at runtime.  <a href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#a68ae44ddfa8ae16f298b2798ed93b9d2">More...</a><br /></td></tr>
<tr class="separator:a68ae44ddfa8ae16f298b2798ed93b9d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a843b25b73b376d77df5a8d5e77f818d2"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="classOpenAPI_1_1OAIIntersection__info.html">OpenAPI::OAIIntersection_info</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#a843b25b73b376d77df5a8d5e77f818d2">get_intersection_info</a> () const</td></tr>
<tr class="memdesc:a843b25b73b376d77df5a8d5e77f818d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the intersection info object.  <a href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#a843b25b73b376d77df5a8d5e77f818d2">More...</a><br /></td></tr>
<tr class="separator:a843b25b73b376d77df5a8d5e77f818d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b666aed7fe6d72a268315baeb1f85e1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#a8b666aed7fe6d72a268315baeb1f85e1">set_intersection_info</a> (std::shared_ptr&lt; <a class="el" href="classOpenAPI_1_1OAIIntersection__info.html">OpenAPI::OAIIntersection_info</a> &gt; _intersection_info)</td></tr>
<tr class="memdesc:a8b666aed7fe6d72a268315baeb1f85e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the intersection info object.  <a href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#a8b666aed7fe6d72a268315baeb1f85e1">More...</a><br /></td></tr>
<tr class="separator:a8b666aed7fe6d72a268315baeb1f85e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-methods" name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a85947f43b293504a108619374c0c0dae"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#a85947f43b293504a108619374c0c0dae">estimate_vehicles_at_common_time</a> (std::unordered_map&lt; std::string, <a class="el" href="structstreets__vehicles_1_1vehicle.html">streets_vehicles::vehicle</a> &gt; &amp;vehicles, const u_int64_t timestamp) const</td></tr>
<tr class="memdesc:a85947f43b293504a108619374c0c0dae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Method to estimate all vehicle's speed and location at a common future time. The time needs to be time since epoch in milliseconds. To predict vehicle location and speed at future time, current kinematic information is used including speed and current acceleration.  <a href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#a85947f43b293504a108619374c0c0dae">More...</a><br /></td></tr>
<tr class="separator:a85947f43b293504a108619374c0c0dae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8916add714bef70d8f48efc0ccfca7b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classOpenAPI_1_1OAILanelet__info.html">OpenAPI::OAILanelet_info</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#af8916add714bef70d8f48efc0ccfca7b">get_entry_lanelet_info</a> (const <a class="el" href="structstreets__vehicles_1_1vehicle.html">streets_vehicles::vehicle</a> &amp;veh) const</td></tr>
<tr class="memdesc:af8916add714bef70d8f48efc0ccfca7b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper method to get entry lane OAILanelet_info from intersection information given a vehicle.  <a href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#af8916add714bef70d8f48efc0ccfca7b">More...</a><br /></td></tr>
<tr class="separator:af8916add714bef70d8f48efc0ccfca7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2c80eb87e5a9cabaad660544003663c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classOpenAPI_1_1OAILanelet__info.html">OpenAPI::OAILanelet_info</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#af2c80eb87e5a9cabaad660544003663c">get_link_lanelet_info</a> (const <a class="el" href="structstreets__vehicles_1_1vehicle.html">streets_vehicles::vehicle</a> &amp;veh) const</td></tr>
<tr class="memdesc:af2c80eb87e5a9cabaad660544003663c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper method to get link lane OAILanelet_info from intersection information given a vehicle.  <a href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#af2c80eb87e5a9cabaad660544003663c">More...</a><br /></td></tr>
<tr class="separator:af2c80eb87e5a9cabaad660544003663c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-attribs" name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a5fa37276e5ccb41e38cbef573e830e8e"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="classOpenAPI_1_1OAIIntersection__info.html">OpenAPI::OAIIntersection_info</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#a5fa37276e5ccb41e38cbef573e830e8e">intersection_info</a></td></tr>
<tr class="memdesc:a5fa37276e5ccb41e38cbef573e830e8e"><td class="mdescLeft">&#160;</td><td class="mdescRight">shared pointer to intersection information required for scheduling.  <a href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#a5fa37276e5ccb41e38cbef573e830e8e">More...</a><br /></td></tr>
<tr class="separator:a5fa37276e5ccb41e38cbef573e830e8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Abstract Class for extend to implement scheduling business logic. </p>

<p class="definition">Definition at line <a class="el" href="vehicle__scheduler_8h_source.html#l00020">20</a> of file <a class="el" href="vehicle__scheduler_8h_source.html">vehicle_scheduler.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a26f9acdf3e3fa08c8025bf4daebd1376" name="a26f9acdf3e3fa08c8025bf4daebd1376"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26f9acdf3e3fa08c8025bf4daebd1376">&#9670;&nbsp;</a></span>vehicle_scheduler()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">streets_vehicle_scheduler::vehicle_scheduler::vehicle_scheduler </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">default</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Construct a new vehicle scheduler object. </p>

</div>
</div>
<a id="ab4ebf26e4aae6538e7481220b2df3488" name="ab4ebf26e4aae6538e7481220b2df3488"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4ebf26e4aae6538e7481220b2df3488">&#9670;&nbsp;</a></span>~vehicle_scheduler()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual streets_vehicle_scheduler::vehicle_scheduler::~vehicle_scheduler </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span><span class="mlabel">default</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Destroy the vehicle scheduler object. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a85947f43b293504a108619374c0c0dae" name="a85947f43b293504a108619374c0c0dae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85947f43b293504a108619374c0c0dae">&#9670;&nbsp;</a></span>estimate_vehicles_at_common_time()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void streets_vehicle_scheduler::vehicle_scheduler::estimate_vehicles_at_common_time </td>
          <td>(</td>
          <td class="paramtype">std::unordered_map&lt; std::string, <a class="el" href="structstreets__vehicles_1_1vehicle.html">streets_vehicles::vehicle</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>vehicles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const u_int64_t&#160;</td>
          <td class="paramname"><em>timestamp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Method to estimate all vehicle's speed and location at a common future time. The time needs to be time since epoch in milliseconds. To predict vehicle location and speed at future time, current kinematic information is used including speed and current acceleration. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">vehicles</td><td>Vehicle for which to calculate future position and speed. </td></tr>
    <tr><td class="paramname">timestamp</td><td>Current or future time in milliseconds since epoch </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classstreets__vehicle__scheduler_1_1scheduling__exception.html" title="Runtime error related to processing status intent vehicle updates.">scheduling_exception</a></td><td>if vehicle update time for any vehicle is more recent than timestamp. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="vehicle__scheduler_8cpp_source.html#l00049">49</a> of file <a class="el" href="vehicle__scheduler_8cpp_source.html">vehicle_scheduler.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   50</span>                                                                                                 {</div>
<div class="line"><span class="lineno">   51</span>        std::vector&lt;std::string&gt; vehicles_to_remove;</div>
<div class="line"><span class="lineno">   52</span>        <span class="keywordflow">for</span> ( <span class="keyword">auto</span> &amp;[v_id, veh]: vehicles) {</div>
<div class="line"><span class="lineno">   53</span>            <span class="comment">// Time difference in seconds</span></div>
<div class="line"><span class="lineno">   54</span>            <span class="keywordtype">double</span> delta_t = (((double)<a class="code hl_variable" href="namespacesimulate__mobilityoperation.html#a53dff21a6d447ca660693de3432b79d0">timestamp</a>) - ((double)veh._cur_time))/1000.0;</div>
<div class="line"><span class="lineno">   55</span>            SPDLOG_TRACE(<span class="stringliteral">&quot;Schedule timestamp {0} vs vehicle timestamp {1}.&quot;</span>, <a class="code hl_variable" href="namespacesimulate__mobilityoperation.html#a53dff21a6d447ca660693de3432b79d0">timestamp</a>, veh._cur_time);</div>
<div class="line"><span class="lineno">   56</span>            <span class="keywordflow">if</span> ( delta_t &gt; 5 ) {</div>
<div class="line"><span class="lineno">   57</span>                SPDLOG_WARN(<span class="stringliteral">&quot;Vehicle update {0} is older than 5 s and no longer considered for scheduling!&quot;</span>, veh._id);</div>
<div class="line"><span class="lineno">   58</span>                vehicles_to_remove.push_back(veh._id);</div>
<div class="line"><span class="lineno">   59</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">   60</span>            }</div>
<div class="line"><span class="lineno">   61</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( delta_t &gt; 0.2) {</div>
<div class="line"><span class="lineno">   62</span>                SPDLOG_WARN(<span class="stringliteral">&quot;Vehicle update {0} is older than 200 ms!&quot;</span>, veh._id);</div>
<div class="line"><span class="lineno">   63</span>            }</div>
<div class="line"><span class="lineno">   64</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( delta_t &lt; 0) {</div>
<div class="line"><span class="lineno">   65</span>                SPDLOG_WARN(<span class="stringliteral">&quot;Timestamp {0} is earlier that latest vehicle {1} update timestamp {2}. Vehicles can only be scheduled for current or future time.&quot;</span></div>
<div class="line"><span class="lineno">   66</span>                            , <a class="code hl_variable" href="namespacesimulate__mobilityoperation.html#a53dff21a6d447ca660693de3432b79d0">timestamp</a>, veh._id, veh._cur_time );</div>
<div class="line"><span class="lineno">   67</span>                vehicles_to_remove.push_back( veh._id);</div>
<div class="line"><span class="lineno">   68</span>                <span class="keywordflow">continue</span>;     </div>
<div class="line"><span class="lineno">   69</span>            }</div>
<div class="line"><span class="lineno">   70</span>            <span class="comment">// estimate future speed.</span></div>
<div class="line"><span class="lineno">   71</span>            <span class="keywordtype">double</span> v_final = veh._cur_speed + veh._cur_accel*delta_t;</div>
<div class="line"><span class="lineno">   72</span>            <span class="comment">// estimate change in distance</span></div>
<div class="line"><span class="lineno">   73</span>            <span class="keywordtype">double</span> delta_x = ((v_final + veh._cur_speed)/2.0)*delta_t;</div>
<div class="line"><span class="lineno">   74</span>            SPDLOG_TRACE(<span class="stringliteral">&quot;Setting speed for vehicle {0} from {1}m/s to {2}m/s.&quot;</span>, </div>
<div class="line"><span class="lineno">   75</span>                            veh._id, </div>
<div class="line"><span class="lineno">   76</span>                            veh._cur_speed, </div>
<div class="line"><span class="lineno">   77</span>                            v_final );</div>
<div class="line"><span class="lineno">   78</span>            veh._cur_speed = v_final;</div>
<div class="line"><span class="lineno">   79</span>            veh._cur_time =  <a class="code hl_variable" href="namespacesimulate__mobilityoperation.html#a53dff21a6d447ca660693de3432b79d0">timestamp</a>;</div>
<div class="line"><span class="lineno">   80</span>            <span class="comment">// Estimate distance to end of lanelet</span></div>
<div class="line"><span class="lineno">   81</span>            <span class="keywordflow">if</span> ( veh._cur_distance - delta_x &gt;= 0.0) {</div>
<div class="line"><span class="lineno">   82</span>                SPDLOG_TRACE(<span class="stringliteral">&quot;Setting distance for vehicle {0} from {1}m to {2}m.&quot;</span>, </div>
<div class="line"><span class="lineno">   83</span>                            veh._id, </div>
<div class="line"><span class="lineno">   84</span>                            veh._cur_distance, </div>
<div class="line"><span class="lineno">   85</span>                            veh._cur_distance-delta_x );</div>
<div class="line"><span class="lineno">   86</span> </div>
<div class="line"><span class="lineno">   87</span>                veh._cur_distance -= delta_x;</div>
<div class="line"><span class="lineno">   88</span>            }</div>
<div class="line"><span class="lineno">   89</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">   90</span>                <span class="comment">// TODO: Could add lanelet transition estimation with intersection model information.</span></div>
<div class="line"><span class="lineno">   91</span>                veh._cur_distance =  0.0;</div>
<div class="line"><span class="lineno">   92</span>            }</div>
<div class="line"><span class="lineno">   93</span>            <span class="comment">// Remove all future points not older than timestamp for estimation.</span></div>
<div class="line"><span class="lineno">   94</span>            <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = veh._future_info.begin() ; it != veh._future_info.end(); it++ ) {</div>
<div class="line"><span class="lineno">   95</span>                <span class="keywordflow">if</span> ( <a class="code hl_variable" href="namespacesimulate__mobilityoperation.html#a53dff21a6d447ca660693de3432b79d0">timestamp</a> &gt; it-&gt;timestamp ) {</div>
<div class="line"><span class="lineno">   96</span>                    veh._future_info.erase( it--);</div>
<div class="line"><span class="lineno">   97</span>                }</div>
<div class="line"><span class="lineno">   98</span>            }</div>
<div class="line"><span class="lineno">   99</span> </div>
<div class="line"><span class="lineno">  100</span>        }</div>
<div class="line"><span class="lineno">  101</span>        <span class="comment">// Remove Old vehicle from consideration</span></div>
<div class="line"><span class="lineno">  102</span>        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;vehicle : vehicles_to_remove) {</div>
<div class="line"><span class="lineno">  103</span>            vehicles.erase(vehicle);</div>
<div class="line"><span class="lineno">  104</span>        }</div>
<div class="line"><span class="lineno">  105</span>    }</div>
<div class="ttc" id="anamespacesimulate__mobilityoperation_html_a53dff21a6d447ca660693de3432b79d0"><div class="ttname"><a href="namespacesimulate__mobilityoperation.html#a53dff21a6d447ca660693de3432b79d0">simulate_mobilityoperation.timestamp</a></div><div class="ttdeci">int timestamp</div><div class="ttdef"><b>Definition:</b> <a href="simulate__mobilityoperation_8py_source.html#l00026">simulate_mobilityoperation.py:26</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="simulate__mobilityoperation_8py_source.html#l00026">simulate_mobilityoperation::timestamp</a>.</p>

<p class="reference">Referenced by <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00009">streets_vehicle_scheduler::all_stop_vehicle_scheduler::schedule_vehicles()</a>, and <a class="el" href="signalized__vehicle__scheduler_8cpp_source.html#l00005">streets_vehicle_scheduler::signalized_vehicle_scheduler::schedule_vehicles()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classstreets__vehicle__scheduler_1_1vehicle__scheduler_a85947f43b293504a108619374c0c0dae_icgraph.png" border="0" usemap="#aclassstreets__vehicle__scheduler_1_1vehicle__scheduler_a85947f43b293504a108619374c0c0dae_icgraph" alt=""/></div>
<map name="aclassstreets__vehicle__scheduler_1_1vehicle__scheduler_a85947f43b293504a108619374c0c0dae_icgraph" id="aclassstreets__vehicle__scheduler_1_1vehicle__scheduler_a85947f43b293504a108619374c0c0dae_icgraph">
<area shape="rect" title="Method to estimate all vehicle&#39;s speed and location at a common future time. The time needs to be tim..." alt="" coords="249,45,437,101"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a930961b3e285b2a2d08f4276ffa22658" title="Method to schedule vehicles. Given and empty intersection_schedule object and a map of vehicles and v..." alt="" coords="11,5,195,61"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler.html#a2572fdbb86e141df40174d618fe2a3d0" title="Method to schedule vehicles. Given and empty intersection_schedule shared pointer and a map of vehicl..." alt="" coords="5,85,201,141"/>
</map>
</div>

</div>
</div>
<a id="af8916add714bef70d8f48efc0ccfca7b" name="af8916add714bef70d8f48efc0ccfca7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8916add714bef70d8f48efc0ccfca7b">&#9670;&nbsp;</a></span>get_entry_lanelet_info()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classOpenAPI_1_1OAILanelet__info.html">OpenAPI::OAILanelet_info</a> streets_vehicle_scheduler::vehicle_scheduler::get_entry_lanelet_info </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structstreets__vehicles_1_1vehicle.html">streets_vehicles::vehicle</a> &amp;&#160;</td>
          <td class="paramname"><em>veh</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Helper method to get entry lane OAILanelet_info from intersection information given a vehicle. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">veh</td><td>Vehicle for which to find entry lane OAILanlet_info. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="classOpenAPI_1_1OAILanelet__info.html">OpenAPI::OAILanelet_info</a> for entry lane. </dd></dl>

<p class="definition">Definition at line <a class="el" href="vehicle__scheduler_8cpp_source.html#l00013">13</a> of file <a class="el" href="vehicle__scheduler_8cpp_source.html">vehicle_scheduler.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   13</span>                                                                                                            {</div>
<div class="line"><span class="lineno">   14</span>        <a class="code hl_class" href="classOpenAPI_1_1OAILanelet__info.html">OpenAPI::OAILanelet_info</a> entry_lane;</div>
<div class="line"><span class="lineno">   15</span>        <span class="keywordtype">bool</span> is_found = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   16</span>        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;lanelet : <a class="code hl_variable" href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#a5fa37276e5ccb41e38cbef573e830e8e">intersection_info</a>-&gt;getEntryLanelets() ) {</div>
<div class="line"><span class="lineno">   17</span>            <span class="keywordtype">int</span> lane_id =lanelet.<a class="code hl_function" href="classOpenAPI_1_1OAILanelet__info.html#a489d1a475686159298697bccabd2bd52">getId</a>();</div>
<div class="line"><span class="lineno">   18</span>            <span class="keywordflow">if</span> ( lane_id == veh.<a class="code hl_variable" href="structstreets__vehicles_1_1vehicle.html#a4ef0e2e811b0f5cb00f14b89a353c3b5">_entry_lane_id</a> ) {</div>
<div class="line"><span class="lineno">   19</span>                entry_lane =  lanelet;</div>
<div class="line"><span class="lineno">   20</span>                is_found = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">   21</span>            }</div>
<div class="line"><span class="lineno">   22</span>            </div>
<div class="line"><span class="lineno">   23</span>        }</div>
<div class="line"><span class="lineno">   24</span>        <span class="keywordflow">if</span> (!is_found) {</div>
<div class="line"><span class="lineno">   25</span>            <span class="keywordflow">throw</span> scheduling_exception(<span class="stringliteral">&quot;No entry lane &quot;</span> + <a class="code hl_function" href="ntcip__1202__ext_8h.html#a576de7b60eacee3f1a70393a005502cd">std::to_string</a>(veh.<a class="code hl_variable" href="structstreets__vehicles_1_1vehicle.html#adc3dab0260f149fc908b9b7d49e1ba99">_cur_lane_id</a>) + <span class="stringliteral">&quot; found in intersection info!&quot;</span>);</div>
<div class="line"><span class="lineno">   26</span>        }</div>
<div class="line"><span class="lineno">   27</span>        <span class="keywordflow">return</span> entry_lane;</div>
<div class="line"><span class="lineno">   28</span> </div>
<div class="line"><span class="lineno">   29</span>    }</div>
<div class="ttc" id="aclassOpenAPI_1_1OAILanelet__info_html"><div class="ttname"><a href="classOpenAPI_1_1OAILanelet__info.html">OpenAPI::OAILanelet_info</a></div><div class="ttdef"><b>Definition:</b> <a href="intersection__client__api_2OAILanelet__info_8h_source.html#l00031">OAILanelet_info.h:31</a></div></div>
<div class="ttc" id="aclassOpenAPI_1_1OAILanelet__info_html_a489d1a475686159298697bccabd2bd52"><div class="ttname"><a href="classOpenAPI_1_1OAILanelet__info.html#a489d1a475686159298697bccabd2bd52">OpenAPI::OAILanelet_info::getId</a></div><div class="ttdeci">qint32 getId() const</div><div class="ttdef"><b>Definition:</b> <a href="intersection__client__api_2OAILanelet__info_8cpp_source.html#l00121">OAILanelet_info.cpp:121</a></div></div>
<div class="ttc" id="aclassstreets__vehicle__scheduler_1_1vehicle__scheduler_html_a5fa37276e5ccb41e38cbef573e830e8e"><div class="ttname"><a href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#a5fa37276e5ccb41e38cbef573e830e8e">streets_vehicle_scheduler::vehicle_scheduler::intersection_info</a></div><div class="ttdeci">std::shared_ptr&lt; OpenAPI::OAIIntersection_info &gt; intersection_info</div><div class="ttdoc">shared pointer to intersection information required for scheduling.</div><div class="ttdef"><b>Definition:</b> <a href="vehicle__scheduler_8h_source.html#l00026">vehicle_scheduler.h:26</a></div></div>
<div class="ttc" id="antcip__1202__ext_8h_html_a576de7b60eacee3f1a70393a005502cd"><div class="ttname"><a href="ntcip__1202__ext_8h.html#a576de7b60eacee3f1a70393a005502cd">to_string</a></div><div class="ttdeci">std::string to_string() const</div><div class="ttdoc">Returns std::string representation of ntcip_1202_ext message including phase_times array.</div></div>
<div class="ttc" id="astructstreets__vehicles_1_1vehicle_html_a4ef0e2e811b0f5cb00f14b89a353c3b5"><div class="ttname"><a href="structstreets__vehicles_1_1vehicle.html#a4ef0e2e811b0f5cb00f14b89a353c3b5">streets_vehicles::vehicle::_entry_lane_id</a></div><div class="ttdeci">int _entry_lane_id</div><div class="ttdef"><b>Definition:</b> <a href="vehicle_8h_source.html#l00051">vehicle.h:51</a></div></div>
<div class="ttc" id="astructstreets__vehicles_1_1vehicle_html_adc3dab0260f149fc908b9b7d49e1ba99"><div class="ttname"><a href="structstreets__vehicles_1_1vehicle.html#adc3dab0260f149fc908b9b7d49e1ba99">streets_vehicles::vehicle::_cur_lane_id</a></div><div class="ttdeci">int _cur_lane_id</div><div class="ttdef"><b>Definition:</b> <a href="vehicle_8h_source.html#l00049">vehicle.h:49</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="vehicle_8h_source.html#l00049">streets_vehicles::vehicle::_cur_lane_id</a>, <a class="el" href="vehicle_8h_source.html#l00051">streets_vehicles::vehicle::_entry_lane_id</a>, <a class="el" href="intersection__client__api_2OAILanelet__info_8cpp_source.html#l00121">OpenAPI::OAILanelet_info::getId()</a>, <a class="el" href="vehicle__scheduler_8h_source.html#l00026">intersection_info</a>, and <a class="el" href="ntcip__1202__ext_8h.html#a576de7b60eacee3f1a70393a005502cd">to_string()</a>.</p>

<p class="reference">Referenced by <a class="el" href="signalized__vehicle__scheduler_8cpp_source.html#l00247">streets_vehicle_scheduler::signalized_vehicle_scheduler::calculate_earliest_entering_time()</a>, and <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00390">streets_vehicle_scheduler::all_stop_vehicle_scheduler::estimate_earliest_time_to_stop_bar()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classstreets__vehicle__scheduler_1_1vehicle__scheduler_af8916add714bef70d8f48efc0ccfca7b_cgraph.png" border="0" usemap="#aclassstreets__vehicle__scheduler_1_1vehicle__scheduler_af8916add714bef70d8f48efc0ccfca7b_cgraph" alt=""/></div>
<map name="aclassstreets__vehicle__scheduler_1_1vehicle__scheduler_af8916add714bef70d8f48efc0ccfca7b_cgraph" id="aclassstreets__vehicle__scheduler_1_1vehicle__scheduler_af8916add714bef70d8f48efc0ccfca7b_cgraph">
<area shape="rect" title="Helper method to get entry lane OAILanelet_info from intersection information given a vehicle." alt="" coords="5,27,179,83"/>
<area shape="rect" href="classOpenAPI_1_1OAILanelet__info.html#a489d1a475686159298697bccabd2bd52" title=" " alt="" coords="227,5,373,47"/>
<area shape="rect" href="ntcip__1202__ext_8h.html#a576de7b60eacee3f1a70393a005502cd" title="Returns std::string representation of ntcip_1202_ext message including phase_times array." alt="" coords="264,71,336,98"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classstreets__vehicle__scheduler_1_1vehicle__scheduler_af8916add714bef70d8f48efc0ccfca7b_icgraph.png" border="0" usemap="#aclassstreets__vehicle__scheduler_1_1vehicle__scheduler_af8916add714bef70d8f48efc0ccfca7b_icgraph" alt=""/></div>
<map name="aclassstreets__vehicle__scheduler_1_1vehicle__scheduler_af8916add714bef70d8f48efc0ccfca7b_icgraph" id="aclassstreets__vehicle__scheduler_1_1vehicle__scheduler_af8916add714bef70d8f48efc0ccfca7b_icgraph">
<area shape="rect" title="Helper method to get entry lane OAILanelet_info from intersection information given a vehicle." alt="" coords="1000,49,1173,105"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler.html#a616f990b94f85cbe7c8ac5ecc215d41c" title="Method to use vehicle kinematic information to estimate earliest possible entering time (EET) for an ..." alt="" coords="737,5,952,61"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#ad5f0462b2d82168b7b71dcfd15eaa7f2" title="Method to use vehicle kinematic information to estimate earliest possible time stopping time for a ve..." alt="" coords="753,86,937,157"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler.html#a4d00a1ab964b44569653d414280a3419" title="Estimate an entering time (ET) for a given Entering Vehicle (EV). ET is estimated based on the EV&#39;s e..." alt="" coords="493,5,689,61"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler.html#ac41bc42db46cbbf7a037486fa46dd7e0" title="Schedule all Entering Vehicles (EVs). Method first organizes all EVs into lists based on their entry ..." alt="" coords="249,5,445,61"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler.html#a2572fdbb86e141df40174d618fe2a3d0" title="Method to schedule vehicles. Given and empty intersection_schedule shared pointer and a map of vehicl..." alt="" coords="5,5,201,61"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#acd0ec98c5efc93aadb38563e3b98d1bb" title="Schedule all Entering Vehicles (EVs). Method first organizes all EVs into lists based on their entry ..." alt="" coords="499,93,683,149"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a930961b3e285b2a2d08f4276ffa22658" title="Method to schedule vehicles. Given and empty intersection_schedule object and a map of vehicles and v..." alt="" coords="255,93,439,149"/>
</map>
</div>

</div>
</div>
<a id="a843b25b73b376d77df5a8d5e77f818d2" name="a843b25b73b376d77df5a8d5e77f818d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a843b25b73b376d77df5a8d5e77f818d2">&#9670;&nbsp;</a></span>get_intersection_info()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_ptr&lt; <a class="el" href="classOpenAPI_1_1OAIIntersection__info.html">OpenAPI::OAIIntersection_info</a> &gt; streets_vehicle_scheduler::vehicle_scheduler::get_intersection_info </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the intersection info object. </p>
<dl class="section return"><dt>Returns</dt><dd>std::shared_ptr&lt;OpenAPI::OAIIntersection_info&gt; </dd></dl>

<p class="definition">Definition at line <a class="el" href="vehicle__scheduler_8cpp_source.html#l00004">4</a> of file <a class="el" href="vehicle__scheduler_8cpp_source.html">vehicle_scheduler.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">    4</span>                                                                                             {</div>
<div class="line"><span class="lineno">    5</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#a5fa37276e5ccb41e38cbef573e830e8e">intersection_info</a>;</div>
<div class="line"><span class="lineno">    6</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="vehicle__scheduler_8h_source.html#l00026">intersection_info</a>.</p>

</div>
</div>
<a id="af2c80eb87e5a9cabaad660544003663c" name="af2c80eb87e5a9cabaad660544003663c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2c80eb87e5a9cabaad660544003663c">&#9670;&nbsp;</a></span>get_link_lanelet_info()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classOpenAPI_1_1OAILanelet__info.html">OpenAPI::OAILanelet_info</a> streets_vehicle_scheduler::vehicle_scheduler::get_link_lanelet_info </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structstreets__vehicles_1_1vehicle.html">streets_vehicles::vehicle</a> &amp;&#160;</td>
          <td class="paramname"><em>veh</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Helper method to get link lane OAILanelet_info from intersection information given a vehicle. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">veh</td><td>Vehicle for which to find link lane OAILanlet_info. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="classOpenAPI_1_1OAILanelet__info.html">OpenAPI::OAILanelet_info</a> for link lane. </dd></dl>

<p class="definition">Definition at line <a class="el" href="vehicle__scheduler_8cpp_source.html#l00031">31</a> of file <a class="el" href="vehicle__scheduler_8cpp_source.html">vehicle_scheduler.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   31</span>                                                                                                            {</div>
<div class="line"><span class="lineno">   32</span>        <a class="code hl_class" href="classOpenAPI_1_1OAILanelet__info.html">OpenAPI::OAILanelet_info</a> link_lane;</div>
<div class="line"><span class="lineno">   33</span>        <span class="keywordtype">bool</span> is_found = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   34</span>        <span class="keywordflow">for</span> ( <span class="keyword">const</span> <span class="keyword">auto</span> &amp;lanelet : <a class="code hl_variable" href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#a5fa37276e5ccb41e38cbef573e830e8e">intersection_info</a>-&gt;getLinkLanelets() ) {</div>
<div class="line"><span class="lineno">   35</span>            <span class="keywordtype">int</span> lane_id = lanelet.<a class="code hl_function" href="classOpenAPI_1_1OAILanelet__info.html#a489d1a475686159298697bccabd2bd52">getId</a>();</div>
<div class="line"><span class="lineno">   36</span>            <span class="keywordflow">if</span> ( lane_id == veh.<a class="code hl_variable" href="structstreets__vehicles_1_1vehicle.html#aaa9cbe97b2343b3f14841c1ed2bc8e3d">_link_id</a> ) {</div>
<div class="line"><span class="lineno">   37</span>                link_lane =  lanelet;</div>
<div class="line"><span class="lineno">   38</span>                is_found = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">   39</span>            }</div>
<div class="line"><span class="lineno">   40</span>            </div>
<div class="line"><span class="lineno">   41</span>        }</div>
<div class="line"><span class="lineno">   42</span>        <span class="keywordflow">if</span> (!is_found) {</div>
<div class="line"><span class="lineno">   43</span>            <span class="keywordflow">throw</span> scheduling_exception(<span class="stringliteral">&quot;No link lane &quot;</span> + <a class="code hl_function" href="ntcip__1202__ext_8h.html#a576de7b60eacee3f1a70393a005502cd">std::to_string</a>(veh.<a class="code hl_variable" href="structstreets__vehicles_1_1vehicle.html#adc3dab0260f149fc908b9b7d49e1ba99">_cur_lane_id</a>) + <span class="stringliteral">&quot; found in intersection info!&quot;</span>);</div>
<div class="line"><span class="lineno">   44</span>        }</div>
<div class="line"><span class="lineno">   45</span>        <span class="keywordflow">return</span> link_lane;</div>
<div class="line"><span class="lineno">   46</span> </div>
<div class="line"><span class="lineno">   47</span>    }</div>
<div class="ttc" id="astructstreets__vehicles_1_1vehicle_html_aaa9cbe97b2343b3f14841c1ed2bc8e3d"><div class="ttname"><a href="structstreets__vehicles_1_1vehicle.html#aaa9cbe97b2343b3f14841c1ed2bc8e3d">streets_vehicles::vehicle::_link_id</a></div><div class="ttdeci">int _link_id</div><div class="ttdef"><b>Definition:</b> <a href="vehicle_8h_source.html#l00055">vehicle.h:55</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="vehicle_8h_source.html#l00049">streets_vehicles::vehicle::_cur_lane_id</a>, <a class="el" href="vehicle_8h_source.html#l00055">streets_vehicles::vehicle::_link_id</a>, <a class="el" href="intersection__client__api_2OAILanelet__info_8cpp_source.html#l00121">OpenAPI::OAILanelet_info::getId()</a>, <a class="el" href="vehicle__scheduler_8h_source.html#l00026">intersection_info</a>, and <a class="el" href="ntcip__1202__ext_8h.html#a576de7b60eacee3f1a70393a005502cd">to_string()</a>.</p>

<p class="reference">Referenced by <a class="el" href="signalized__vehicle__scheduler_8cpp_source.html#l00247">streets_vehicle_scheduler::signalized_vehicle_scheduler::calculate_earliest_entering_time()</a>, <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00432">streets_vehicle_scheduler::all_stop_vehicle_scheduler::consider_departure_position_permutation()</a>, <a class="el" href="signalized__vehicle__scheduler_8cpp_source.html#l00384">streets_vehicle_scheduler::signalized_vehicle_scheduler::estimate_clearance_time()</a>, <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00368">streets_vehicle_scheduler::all_stop_vehicle_scheduler::estimate_entering_time_for_ev()</a>, <a class="el" href="signalized__vehicle__scheduler_8cpp_source.html#l00190">streets_vehicle_scheduler::signalized_vehicle_scheduler::estimate_et()</a>, <a class="el" href="signalized__vehicle__scheduler_8cpp_source.html#l00046">streets_vehicle_scheduler::signalized_vehicle_scheduler::schedule_dvs()</a>, <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00117">streets_vehicle_scheduler::all_stop_vehicle_scheduler::schedule_dvs()</a>, and <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00230">streets_vehicle_scheduler::all_stop_vehicle_scheduler::schedule_evs()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classstreets__vehicle__scheduler_1_1vehicle__scheduler_af2c80eb87e5a9cabaad660544003663c_cgraph.png" border="0" usemap="#aclassstreets__vehicle__scheduler_1_1vehicle__scheduler_af2c80eb87e5a9cabaad660544003663c_cgraph" alt=""/></div>
<map name="aclassstreets__vehicle__scheduler_1_1vehicle__scheduler_af2c80eb87e5a9cabaad660544003663c_cgraph" id="aclassstreets__vehicle__scheduler_1_1vehicle__scheduler_af2c80eb87e5a9cabaad660544003663c_cgraph">
<area shape="rect" title="Helper method to get link lane OAILanelet_info from intersection information given a vehicle." alt="" coords="5,27,179,83"/>
<area shape="rect" href="classOpenAPI_1_1OAILanelet__info.html#a489d1a475686159298697bccabd2bd52" title=" " alt="" coords="227,5,373,47"/>
<area shape="rect" href="ntcip__1202__ext_8h.html#a576de7b60eacee3f1a70393a005502cd" title="Returns std::string representation of ntcip_1202_ext message including phase_times array." alt="" coords="264,71,336,98"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classstreets__vehicle__scheduler_1_1vehicle__scheduler_af2c80eb87e5a9cabaad660544003663c_icgraph.png" border="0" usemap="#aclassstreets__vehicle__scheduler_1_1vehicle__scheduler_af2c80eb87e5a9cabaad660544003663c_icgraph" alt=""/></div>
<map name="aclassstreets__vehicle__scheduler_1_1vehicle__scheduler_af2c80eb87e5a9cabaad660544003663c_icgraph" id="aclassstreets__vehicle__scheduler_1_1vehicle__scheduler_af2c80eb87e5a9cabaad660544003663c_icgraph">
<area shape="rect" title="Helper method to get link lane OAILanelet_info from intersection information given a vehicle." alt="" coords="1000,223,1173,279"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler.html#a616f990b94f85cbe7c8ac5ecc215d41c" title="Method to use vehicle kinematic information to estimate earliest possible entering time (EET) for an ..." alt="" coords="737,124,952,180"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler.html#a4d00a1ab964b44569653d414280a3419" title="Estimate an entering time (ET) for a given Entering Vehicle (EV). ET is estimated based on the EV&#39;s e..." alt="" coords="493,124,689,180"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a77c415e3ef29a00acc67c7aac87a270b" title="Creates and intersection schedule for a given RDV departure order. RDV departure order is based on rd..." alt="" coords="749,386,940,457"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler.html#a1cce3f6e4da6ae1804dfd6a49305baf2" title="Estimate clearance time of a vehicle given it&#39;s current speed." alt="" coords="747,44,943,100"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler.html#a4ff15023fb9c14d1765ebe78d3d3a944" title="Estimate the intersection departure times (dt&#39;s) for all currently Departing Vehicle (DVs) based on k..." alt="" coords="493,44,689,100"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a9b5ee4ffdbd82cbf0c48f7981e7dff9c" title="Estimates an entering time (ET) for a given Entering Vehicle (EV). This method first searches among t..." alt="" coords="741,255,948,311"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#acd0ec98c5efc93aadb38563e3b98d1bb" title="Schedule all Entering Vehicles (EVs). Method first organizes all EVs into lists based on their entry ..." alt="" coords="499,311,683,367"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a16230014f5d43ef2546a54496c08a9cd" title="Schedule all currently Departing Vehicle (DVs). Estimate intersection departure times (dt&#39;s) for each..." alt="" coords="499,471,683,527"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler.html#ac41bc42db46cbbf7a037486fa46dd7e0" title="Schedule all Entering Vehicles (EVs). Method first organizes all EVs into lists based on their entry ..." alt="" coords="249,120,445,176"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler.html#a2572fdbb86e141df40174d618fe2a3d0" title="Method to schedule vehicles. Given and empty intersection_schedule shared pointer and a map of vehicl..." alt="" coords="5,84,201,140"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a0729a968f0b8f0b0ec11453157df101c" title="Schedule all currently Ready to Depart Vehicles (RDVs). Consider all possible RDV departure orders...." alt="" coords="499,391,683,447"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a930961b3e285b2a2d08f4276ffa22658" title="Method to schedule vehicles. Given and empty intersection_schedule object and a map of vehicles and v..." alt="" coords="255,391,439,447"/>
</map>
</div>

</div>
</div>
<a id="a68ae44ddfa8ae16f298b2798ed93b9d2" name="a68ae44ddfa8ae16f298b2798ed93b9d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68ae44ddfa8ae16f298b2798ed93b9d2">&#9670;&nbsp;</a></span>schedule_vehicles()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void streets_vehicle_scheduler::vehicle_scheduler::schedule_vehicles </td>
          <td>(</td>
          <td class="paramtype">std::unordered_map&lt; std::string, <a class="el" href="structstreets__vehicles_1_1vehicle.html">streets_vehicles::vehicle</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>vehicles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="structstreets__vehicle__scheduler_1_1intersection__schedule.html">intersection_schedule</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>schedule</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Virtual method to schedule vehicle. Different implementations of vehicle scheduler can implement custom business logic for scheduling vehicle while taking advantage of polymorphism to dynamically assign class at runtime. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">vehicles</td><td>unordered map of vehicles to schedule. </td></tr>
    <tr><td class="paramname">schedule</td><td>empty <a class="el" href="structstreets__vehicle__scheduler_1_1intersection__schedule.html" title="Struct to store vehicle schedules for all vehicle in an intersection. Includes a timestamp in millise...">intersection_schedule</a> shared pointer which is returned by reference to provide calculated scheduling information. </td></tr>
  </table>
  </dd>
</dl>

<p>Implemented in <a class="el" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a930961b3e285b2a2d08f4276ffa22658">streets_vehicle_scheduler::all_stop_vehicle_scheduler</a>, and <a class="el" href="classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler.html#a2572fdbb86e141df40174d618fe2a3d0">streets_vehicle_scheduler::signalized_vehicle_scheduler</a>.</p>

</div>
</div>
<a id="a8b666aed7fe6d72a268315baeb1f85e1" name="a8b666aed7fe6d72a268315baeb1f85e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b666aed7fe6d72a268315baeb1f85e1">&#9670;&nbsp;</a></span>set_intersection_info()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void streets_vehicle_scheduler::vehicle_scheduler::set_intersection_info </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classOpenAPI_1_1OAIIntersection__info.html">OpenAPI::OAIIntersection_info</a> &gt;&#160;</td>
          <td class="paramname"><em>_intersection_info</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the intersection info object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">_intersection_info</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="vehicle__scheduler_8cpp_source.html#l00008">8</a> of file <a class="el" href="vehicle__scheduler_8cpp_source.html">vehicle_scheduler.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">    8</span>                                                                                                                {</div>
<div class="line"><span class="lineno">    9</span>        <a class="code hl_variable" href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#a5fa37276e5ccb41e38cbef573e830e8e">intersection_info</a> = _intersection_info;</div>
<div class="line"><span class="lineno">   10</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="vehicle__scheduler_8h_source.html#l00026">intersection_info</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a5fa37276e5ccb41e38cbef573e830e8e" name="a5fa37276e5ccb41e38cbef573e830e8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5fa37276e5ccb41e38cbef573e830e8e">&#9670;&nbsp;</a></span>intersection_info</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_ptr&lt;<a class="el" href="classOpenAPI_1_1OAIIntersection__info.html">OpenAPI::OAIIntersection_info</a>&gt; streets_vehicle_scheduler::vehicle_scheduler::intersection_info</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>shared pointer to intersection information required for scheduling. </p>

<p class="definition">Definition at line <a class="el" href="vehicle__scheduler_8h_source.html#l00026">26</a> of file <a class="el" href="vehicle__scheduler_8h_source.html">vehicle_scheduler.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="signalized__vehicle__scheduler_8cpp_source.html#l00147">streets_vehicle_scheduler::signalized_vehicle_scheduler::find_movement_state_for_lane()</a>, <a class="el" href="vehicle__scheduler_8cpp_source.html#l00013">get_entry_lanelet_info()</a>, <a class="el" href="vehicle__scheduler_8cpp_source.html#l00004">get_intersection_info()</a>, <a class="el" href="vehicle__scheduler_8cpp_source.html#l00031">get_link_lanelet_info()</a>, <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00230">streets_vehicle_scheduler::all_stop_vehicle_scheduler::schedule_evs()</a>, <a class="el" href="signalized__vehicle__scheduler_8cpp_source.html#l00078">streets_vehicle_scheduler::signalized_vehicle_scheduler::schedule_evs()</a>, and <a class="el" href="vehicle__scheduler_8cpp_source.html#l00008">set_intersection_info()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>streets_utils/streets_vehicle_scheduler/include/<a class="el" href="vehicle__scheduler_8h_source.html">vehicle_scheduler.h</a></li>
<li>streets_utils/streets_vehicle_scheduler/src/<a class="el" href="vehicle__scheduler_8cpp_source.html">vehicle_scheduler.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacestreets__vehicle__scheduler.html">streets_vehicle_scheduler</a></li><li class="navelem"><a class="el" href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html">vehicle_scheduler</a></li>
    <li class="footer">Generated on Tue Jan 3 2023 14:34:45 for Carma-streets by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4 </li>
  </ul>
</div>
</body>
</html>
