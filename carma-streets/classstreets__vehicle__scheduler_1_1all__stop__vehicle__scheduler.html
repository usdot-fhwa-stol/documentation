<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Carma-streets: streets_vehicle_scheduler::all_stop_vehicle_scheduler Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Carma-streets<span id="projectnumber">&#160;v4.2.0</span>
   </div>
   <div id="projectbrief">CARMA Streets is a component of CARMA ecosystem that improves the efficiency and performance of the Transportation Systems Management and Operations (TSMO) strategies.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">streets_vehicle_scheduler::all_stop_vehicle_scheduler Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="all__stop__vehicle__scheduler_8h_source.html">all_stop_vehicle_scheduler.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for streets_vehicle_scheduler::all_stop_vehicle_scheduler:</div>
<div class="dyncontent">
<div class="center"><img src="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler__inherit__graph.png" border="0" usemap="#astreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_inherit__map" alt="Inheritance graph"/></div>
<map name="astreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_inherit__map" id="astreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_inherit__map">
<area shape="rect" title=" " alt="" coords="5,263,209,824"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html" title="Abstract Class for extend to implement scheduling business logic." alt="" coords="21,5,194,215"/>
</map>
</div>
<div class="dynheader">
Collaboration diagram for streets_vehicle_scheduler::all_stop_vehicle_scheduler:</div>
<div class="dyncontent">
<div class="center"><img src="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler__coll__graph.png" border="0" usemap="#astreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_coll__map" alt="Collaboration graph"/></div>
<map name="astreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_coll__map" id="astreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_coll__map">
<area shape="rect" title=" " alt="" coords="263,447,467,964"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html" title="Abstract Class for extend to implement scheduling business logic." alt="" coords="5,160,179,369"/>
<area shape="rect" title=" " alt="" coords="13,5,171,97"/>
<area shape="rect" title=" " alt="" coords="203,219,349,311"/>
<area shape="rect" title=" " alt="" coords="421,226,489,303"/>
<area shape="rect" title=" " alt="" coords="591,226,630,303"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ab4a2d24aef35503f3ff8eeaacc07bb9d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#ab4a2d24aef35503f3ff8eeaacc07bb9d">all_stop_vehicle_scheduler</a> ()=default</td></tr>
<tr class="memdesc:ab4a2d24aef35503f3ff8eeaacc07bb9d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct a new all stop vehicle scheduler object.  <a href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#ab4a2d24aef35503f3ff8eeaacc07bb9d">More...</a><br /></td></tr>
<tr class="separator:ab4a2d24aef35503f3ff8eeaacc07bb9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad40be3e19c0eca5e076b1e5831a7e85f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#ad40be3e19c0eca5e076b1e5831a7e85f">~all_stop_vehicle_scheduler</a> () override=default</td></tr>
<tr class="memdesc:ad40be3e19c0eca5e076b1e5831a7e85f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroy the all stop vehicle scheduler object.  <a href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#ad40be3e19c0eca5e076b1e5831a7e85f">More...</a><br /></td></tr>
<tr class="separator:ad40be3e19c0eca5e076b1e5831a7e85f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a930961b3e285b2a2d08f4276ffa22658"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a930961b3e285b2a2d08f4276ffa22658">schedule_vehicles</a> (std::unordered_map&lt; std::string, <a class="el" href="structstreets__vehicles_1_1vehicle.html">streets_vehicles::vehicle</a> &gt; &amp;vehicles, std::shared_ptr&lt; <a class="el" href="structstreets__vehicle__scheduler_1_1intersection__schedule.html">intersection_schedule</a> &gt; &amp;schedule) override</td></tr>
<tr class="memdesc:a930961b3e285b2a2d08f4276ffa22658"><td class="mdescLeft">&#160;</td><td class="mdescRight">Method to schedule vehicles. Given and empty <a class="el" href="structstreets__vehicle__scheduler_1_1intersection__schedule.html" title="Struct to store vehicle schedules for all vehicle in an intersection. Includes a timestamp in millise...">intersection_schedule</a> object and a map of vehicles and vehicle ids. This method will populate the intersection schedule with a schedule for each EV,RDV and DV in the vehicle map based on UC 1 scheduling logic to minimize delay for a all way stop intersection.  <a href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a930961b3e285b2a2d08f4276ffa22658">More...</a><br /></td></tr>
<tr class="separator:a930961b3e285b2a2d08f4276ffa22658"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37514ae17d938eff80b44304ab81cdda"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a37514ae17d938eff80b44304ab81cdda">set_entering_time_buffer</a> (const uint64_t buffer)</td></tr>
<tr class="memdesc:a37514ae17d938eff80b44304ab81cdda"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the entering time buffer (ms). This value is used to account for the time it takes a vehicle stopped before the stop bar at an entry lane to exit the entry lane and enter the link lane once given access.  <a href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a37514ae17d938eff80b44304ab81cdda">More...</a><br /></td></tr>
<tr class="separator:a37514ae17d938eff80b44304ab81cdda"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b4afb653bc02a75e3c113806c9f4004"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a4b4afb653bc02a75e3c113806c9f4004">set_flexibility_limit</a> (const int limit)</td></tr>
<tr class="memdesc:a4b4afb653bc02a75e3c113806c9f4004"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the flexibility limit. This limit controls how much departure position can change for any given vehicle between successive intersection schedule calculations. Each subsequent intersection scheduling calculation may have a slightly different departure order. This value controls how much this departure order can change.A value of 1 represents that vehicles departure position can change by one between two intersection schedules.  <a href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a4b4afb653bc02a75e3c113806c9f4004">More...</a><br /></td></tr>
<tr class="separator:a4b4afb653bc02a75e3c113806c9f4004"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classstreets__vehicle__scheduler_1_1vehicle__scheduler"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classstreets__vehicle__scheduler_1_1vehicle__scheduler')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html">streets_vehicle_scheduler::vehicle_scheduler</a></td></tr>
<tr class="memitem:a26f9acdf3e3fa08c8025bf4daebd1376 inherit pub_methods_classstreets__vehicle__scheduler_1_1vehicle__scheduler"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#a26f9acdf3e3fa08c8025bf4daebd1376">vehicle_scheduler</a> ()=default</td></tr>
<tr class="memdesc:a26f9acdf3e3fa08c8025bf4daebd1376 inherit pub_methods_classstreets__vehicle__scheduler_1_1vehicle__scheduler"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct a new vehicle scheduler object.  <a href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#a26f9acdf3e3fa08c8025bf4daebd1376">More...</a><br /></td></tr>
<tr class="separator:a26f9acdf3e3fa08c8025bf4daebd1376 inherit pub_methods_classstreets__vehicle__scheduler_1_1vehicle__scheduler"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4ebf26e4aae6538e7481220b2df3488 inherit pub_methods_classstreets__vehicle__scheduler_1_1vehicle__scheduler"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#ab4ebf26e4aae6538e7481220b2df3488">~vehicle_scheduler</a> ()=default</td></tr>
<tr class="memdesc:ab4ebf26e4aae6538e7481220b2df3488 inherit pub_methods_classstreets__vehicle__scheduler_1_1vehicle__scheduler"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroy the vehicle scheduler object.  <a href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#ab4ebf26e4aae6538e7481220b2df3488">More...</a><br /></td></tr>
<tr class="separator:ab4ebf26e4aae6538e7481220b2df3488 inherit pub_methods_classstreets__vehicle__scheduler_1_1vehicle__scheduler"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68ae44ddfa8ae16f298b2798ed93b9d2 inherit pub_methods_classstreets__vehicle__scheduler_1_1vehicle__scheduler"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#a68ae44ddfa8ae16f298b2798ed93b9d2">schedule_vehicles</a> (std::unordered_map&lt; std::string, <a class="el" href="structstreets__vehicles_1_1vehicle.html">streets_vehicles::vehicle</a> &gt; &amp;vehicles, std::shared_ptr&lt; <a class="el" href="structstreets__vehicle__scheduler_1_1intersection__schedule.html">intersection_schedule</a> &gt; &amp;schedule)=0</td></tr>
<tr class="memdesc:a68ae44ddfa8ae16f298b2798ed93b9d2 inherit pub_methods_classstreets__vehicle__scheduler_1_1vehicle__scheduler"><td class="mdescLeft">&#160;</td><td class="mdescRight">Virtual method to schedule vehicle. Different implementations of vehicle scheduler can implement custom business logic for scheduling vehicle while taking advantage of polymorphism to dynamically assign class at runtime.  <a href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#a68ae44ddfa8ae16f298b2798ed93b9d2">More...</a><br /></td></tr>
<tr class="separator:a68ae44ddfa8ae16f298b2798ed93b9d2 inherit pub_methods_classstreets__vehicle__scheduler_1_1vehicle__scheduler"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a843b25b73b376d77df5a8d5e77f818d2 inherit pub_methods_classstreets__vehicle__scheduler_1_1vehicle__scheduler"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="classOpenAPI_1_1OAIIntersection__info.html">OpenAPI::OAIIntersection_info</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#a843b25b73b376d77df5a8d5e77f818d2">get_intersection_info</a> () const</td></tr>
<tr class="memdesc:a843b25b73b376d77df5a8d5e77f818d2 inherit pub_methods_classstreets__vehicle__scheduler_1_1vehicle__scheduler"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the intersection info object.  <a href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#a843b25b73b376d77df5a8d5e77f818d2">More...</a><br /></td></tr>
<tr class="separator:a843b25b73b376d77df5a8d5e77f818d2 inherit pub_methods_classstreets__vehicle__scheduler_1_1vehicle__scheduler"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b666aed7fe6d72a268315baeb1f85e1 inherit pub_methods_classstreets__vehicle__scheduler_1_1vehicle__scheduler"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#a8b666aed7fe6d72a268315baeb1f85e1">set_intersection_info</a> (std::shared_ptr&lt; <a class="el" href="classOpenAPI_1_1OAIIntersection__info.html">OpenAPI::OAIIntersection_info</a> &gt; _intersection_info)</td></tr>
<tr class="memdesc:a8b666aed7fe6d72a268315baeb1f85e1 inherit pub_methods_classstreets__vehicle__scheduler_1_1vehicle__scheduler"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the intersection info object.  <a href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#a8b666aed7fe6d72a268315baeb1f85e1">More...</a><br /></td></tr>
<tr class="separator:a8b666aed7fe6d72a268315baeb1f85e1 inherit pub_methods_classstreets__vehicle__scheduler_1_1vehicle__scheduler"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-methods" name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a16230014f5d43ef2546a54496c08a9cd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a16230014f5d43ef2546a54496c08a9cd">schedule_dvs</a> (std::list&lt; <a class="el" href="structstreets__vehicles_1_1vehicle.html">streets_vehicles::vehicle</a> &gt; &amp;dvs, const std::shared_ptr&lt; <a class="el" href="structstreets__vehicle__scheduler_1_1all__stop__intersection__schedule.html">all_stop_intersection_schedule</a> &gt; &amp;schedule) const</td></tr>
<tr class="memdesc:a16230014f5d43ef2546a54496c08a9cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Schedule all currently Departing Vehicle (DVs). Estimate intersection departure times (dt's) for each vehicle based on kinematic vehicle information and intersection geometry. Method assumes empty <a class="el" href="structstreets__vehicle__scheduler_1_1intersection__schedule.html" title="Struct to store vehicle schedules for all vehicle in an intersection. Includes a timestamp in millise...">intersection_schedule</a> is passed in. Method will add vehicle_schedule(s) for each DV in the vector.  <a href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a16230014f5d43ef2546a54496c08a9cd">More...</a><br /></td></tr>
<tr class="separator:a16230014f5d43ef2546a54496c08a9cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0729a968f0b8f0b0ec11453157df101c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a0729a968f0b8f0b0ec11453157df101c">schedule_rdvs</a> (std::list&lt; <a class="el" href="structstreets__vehicles_1_1vehicle.html">streets_vehicles::vehicle</a> &gt; &amp;rdvs, const std::shared_ptr&lt; <a class="el" href="structstreets__vehicle__scheduler_1_1all__stop__intersection__schedule.html">all_stop_intersection_schedule</a> &gt; &amp;schedule)</td></tr>
<tr class="memdesc:a0729a968f0b8f0b0ec11453157df101c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Schedule all currently Ready to Depart Vehicles (RDVs). Consider all possible RDV departure orders. Select the one with the least calculated delay. Delay for a given vehicle is the difference between Entering Time and Stopping Time. Method assumes <a class="el" href="structstreets__vehicle__scheduler_1_1intersection__schedule.html" title="Struct to store vehicle schedules for all vehicle in an intersection. Includes a timestamp in millise...">intersection_schedule</a> only populated with DV(s) vehicle_schedules. Method will add vehicle_schedule(s) for each RDV in vector.  <a href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a0729a968f0b8f0b0ec11453157df101c">More...</a><br /></td></tr>
<tr class="separator:a0729a968f0b8f0b0ec11453157df101c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35eb7b98052f4ef88850471478fcdddb"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a35eb7b98052f4ef88850471478fcdddb">is_rdv_previously_granted_access</a> (const <a class="el" href="structstreets__vehicles_1_1vehicle.html">streets_vehicles::vehicle</a> &amp;veh) const</td></tr>
<tr class="memdesc:a35eb7b98052f4ef88850471478fcdddb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Method to determine whether vehicle was granted access to the intersection in previous schedules. To avoid granting conflicting vehicles intersection access simultaneously, the scheduling service maintains a list of vehicles it has granted access to in the past. Vehicles are removed from this list once their update reflects that they have received and processed this access.  <a href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a35eb7b98052f4ef88850471478fcdddb">More...</a><br /></td></tr>
<tr class="separator:a35eb7b98052f4ef88850471478fcdddb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a223e57041ae7ca6c4810877c8c74a49e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a223e57041ae7ca6c4810877c8c74a49e">remove_rdv_previously_granted_access</a> (const <a class="el" href="structstreets__vehicles_1_1vehicle.html">streets_vehicles::vehicle</a> &amp;veh)</td></tr>
<tr class="memdesc:a223e57041ae7ca6c4810877c8c74a49e"><td class="mdescLeft">&#160;</td><td class="mdescRight">This method will remove a vehicle (DV) once it's updates reflect that is has received access from the list of previously granted access RDVs. This method should be called once a RDV received the schedule update that grants it access to the intersection. This is indicated by the vehicle no longer being a RDV and instead being a DV (.  <a href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a223e57041ae7ca6c4810877c8c74a49e">More...</a><br /></td></tr>
<tr class="separator:a223e57041ae7ca6c4810877c8c74a49e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0cf6941cc406bbd51889c129231e9443"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structstreets__vehicles_1_1vehicle.html">streets_vehicles::vehicle</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a0cf6941cc406bbd51889c129231e9443">get_vehicle_with_id</a> (const std::list&lt; <a class="el" href="structstreets__vehicles_1_1vehicle.html">streets_vehicles::vehicle</a> &gt; &amp;veh_list, const std::string &amp;veh_id) const</td></tr>
<tr class="memdesc:a0cf6941cc406bbd51889c129231e9443"><td class="mdescLeft">&#160;</td><td class="mdescRight">Given a list of vehicles and a vehicle id, this method returns the vehicle with a matching vehicle id if there is one. This method will throw a <a class="el" href="classstreets__vehicle__scheduler_1_1scheduling__exception.html" title="Runtime error related to processing status intent vehicle updates.">scheduling_exception</a> if no vehicle with the given id is found.  <a href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a0cf6941cc406bbd51889c129231e9443">More...</a><br /></td></tr>
<tr class="separator:a0cf6941cc406bbd51889c129231e9443"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd0ec98c5efc93aadb38563e3b98d1bb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#acd0ec98c5efc93aadb38563e3b98d1bb">schedule_evs</a> (std::list&lt; <a class="el" href="structstreets__vehicles_1_1vehicle.html">streets_vehicles::vehicle</a> &gt; &amp;evs, const std::shared_ptr&lt; <a class="el" href="structstreets__vehicle__scheduler_1_1all__stop__intersection__schedule.html">all_stop_intersection_schedule</a> &gt; &amp;schedule) const</td></tr>
<tr class="memdesc:acd0ec98c5efc93aadb38563e3b98d1bb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Schedule all Entering Vehicles (EVs). Method first organizes all EVs into lists based on their entry lane. These list are order in ascending order with the vehicle closest to the intersection in a given lane being the first vehicle in that entry lanes vehicle list. Then stopping time (ST) for the unscheduled front EVs from every approach are calculated and the vehicle with the lowest (earliest) stopping times is scheduled. This is repeated until all evs from all approach lanelets are scheduled.  <a href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#acd0ec98c5efc93aadb38563e3b98d1bb">More...</a><br /></td></tr>
<tr class="separator:acd0ec98c5efc93aadb38563e3b98d1bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b5ee4ffdbd82cbf0c48f7981e7dff9c"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a9b5ee4ffdbd82cbf0c48f7981e7dff9c">estimate_entering_time_for_ev</a> (const std::vector&lt; <a class="el" href="structstreets__vehicle__scheduler_1_1all__stop__vehicle__schedule.html">all_stop_vehicle_schedule</a> &gt; &amp;vehicle_schedules, const <a class="el" href="structstreets__vehicles_1_1vehicle.html">streets_vehicles::vehicle</a> &amp;ev, const uint64_t st) const</td></tr>
<tr class="memdesc:a9b5ee4ffdbd82cbf0c48f7981e7dff9c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Estimates an entering time (ET) for a given Entering Vehicle (EV). This method first searches among the existing scheduled vehicles and find the departure time (DT) of the last scheduled vehicle with conflicting direction. The ET of the vehicle is calculated based on this DT (if exist) and the estimated stopping time (ST) oft the vehicle. <br  />
  <a href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a9b5ee4ffdbd82cbf0c48f7981e7dff9c">More...</a><br /></td></tr>
<tr class="separator:a9b5ee4ffdbd82cbf0c48f7981e7dff9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77c415e3ef29a00acc67c7aac87a270b"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a77c415e3ef29a00acc67c7aac87a270b">consider_departure_position_permutation</a> (const std::list&lt; <a class="el" href="structstreets__vehicles_1_1vehicle.html">streets_vehicles::vehicle</a> &gt; &amp;rdvs, const std::shared_ptr&lt; <a class="el" href="structstreets__vehicle__scheduler_1_1all__stop__intersection__schedule.html">all_stop_intersection_schedule</a> &gt; &amp;option, int starting_departure_position) const</td></tr>
<tr class="memdesc:a77c415e3ef29a00acc67c7aac87a270b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates and intersection schedule for a given RDV departure order. RDV departure order is based on rdvs order. Returns reference to <a class="el" href="structstreets__vehicle__scheduler_1_1intersection__schedule.html" title="Struct to store vehicle schedules for all vehicle in an intersection. Includes a timestamp in millise...">intersection_schedule</a> option/possibility with given departure order. Assumes <a class="el" href="structstreets__vehicle__scheduler_1_1intersection__schedule.html" title="Struct to store vehicle schedules for all vehicle in an intersection. Includes a timestamp in millise...">intersection_schedule</a> option only contains schedules for DVs. Populates <a class="el" href="structstreets__vehicle__scheduler_1_1intersection__schedule.html" title="Struct to store vehicle schedules for all vehicle in an intersection. Includes a timestamp in millise...">intersection_schedule</a> with RDV vehicle_schedules.  <a href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a77c415e3ef29a00acc67c7aac87a270b">More...</a><br /></td></tr>
<tr class="separator:a77c415e3ef29a00acc67c7aac87a270b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15b4da36dba827263da4c844028c6db1"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a15b4da36dba827263da4c844028c6db1">estimate_clearance_time</a> (const <a class="el" href="structstreets__vehicles_1_1vehicle.html">streets_vehicles::vehicle</a> &amp;veh, const <a class="el" href="classOpenAPI_1_1OAILanelet__info.html">OpenAPI::OAILanelet_info</a> &amp;link_lane_info) const</td></tr>
<tr class="memdesc:a15b4da36dba827263da4c844028c6db1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Estimate clearance time any vehicle given it's link lanelet information. <br  />
  <a href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a15b4da36dba827263da4c844028c6db1">More...</a><br /></td></tr>
<tr class="separator:a15b4da36dba827263da4c844028c6db1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa06721804b8a4075b98c2e8ad40c84da"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="structstreets__vehicle__scheduler_1_1all__stop__vehicle__schedule.html">all_stop_vehicle_schedule</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#aa06721804b8a4075b98c2e8ad40c84da">get_latest_conflicting</a> (const <a class="el" href="classOpenAPI_1_1OAILanelet__info.html">OpenAPI::OAILanelet_info</a> &amp;link_lane, const std::vector&lt; <a class="el" href="structstreets__vehicle__scheduler_1_1all__stop__vehicle__schedule.html">all_stop_vehicle_schedule</a> &gt; &amp;schedules) const</td></tr>
<tr class="memdesc:aa06721804b8a4075b98c2e8ad40c84da"><td class="mdescLeft">&#160;</td><td class="mdescRight">Given a link lane and a vector of vehicle schedules, this method returns a pointer to a vehicle schedule with a conflicting direction and the latest departure time. If no vehicle schedules have conflicting directions it returns nullptr. This method is meant to return the limiting conflicting vehicle for scheduling new RDVs in a link lane.  <a href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#aa06721804b8a4075b98c2e8ad40c84da">More...</a><br /></td></tr>
<tr class="separator:aa06721804b8a4075b98c2e8ad40c84da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5f0462b2d82168b7b71dcfd15eaa7f2"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#ad5f0462b2d82168b7b71dcfd15eaa7f2">estimate_earliest_time_to_stop_bar</a> (const <a class="el" href="structstreets__vehicles_1_1vehicle.html">streets_vehicles::vehicle</a> &amp;veh) const</td></tr>
<tr class="memdesc:ad5f0462b2d82168b7b71dcfd15eaa7f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Method to use vehicle kinematic information to estimate earliest possible time stopping time for a vehicle. Does not consider any other vehicles. Limiting factors are the vehicles current kinematic information, lane speed limits and vehicle acceleration and deceleration limits.  <a href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#ad5f0462b2d82168b7b71dcfd15eaa7f2">More...</a><br /></td></tr>
<tr class="separator:ad5f0462b2d82168b7b71dcfd15eaa7f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acab5956159419bef2c5391d59e3fe9ee"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#acab5956159419bef2c5391d59e3fe9ee">estimate_delta_x_prime</a> (const <a class="el" href="structstreets__vehicles_1_1vehicle.html">streets_vehicles::vehicle</a> &amp;veh, const <a class="el" href="classOpenAPI_1_1OAILanelet__info.html">OpenAPI::OAILanelet_info</a> &amp;entry_lane) const</td></tr>
<tr class="memdesc:acab5956159419bef2c5391d59e3fe9ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate minumum distance required to speed up to lane speed limit with maximum acceleration, cruise at lane speed limit for some time, then decelerate with maximum deceleration. This is used to determine the trajectory to provide the vehicle.  <a href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#acab5956159419bef2c5391d59e3fe9ee">More...</a><br /></td></tr>
<tr class="separator:acab5956159419bef2c5391d59e3fe9ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5a42af1af20b06df9ad6af5d3170406"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#ae5a42af1af20b06df9ad6af5d3170406">calculate_v_hat</a> (const <a class="el" href="structstreets__vehicles_1_1vehicle.html">streets_vehicles::vehicle</a> &amp;veh) const</td></tr>
<tr class="memdesc:ae5a42af1af20b06df9ad6af5d3170406"><td class="mdescLeft">&#160;</td><td class="mdescRight">Method to calculate v_hat. This is the maximum speed reached between maximum speed reached between acceleration and deceleration periods for a vehicle trajectory towards stopping at a stop bar.  <a href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#ae5a42af1af20b06df9ad6af5d3170406">More...</a><br /></td></tr>
<tr class="separator:ae5a42af1af20b06df9ad6af5d3170406"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ba56cc964002b21475a475995938b89"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a3ba56cc964002b21475a475995938b89">calculate_acceleration_time</a> (const <a class="el" href="structstreets__vehicles_1_1vehicle.html">streets_vehicles::vehicle</a> &amp;veh, const double v_hat) const</td></tr>
<tr class="memdesc:a3ba56cc964002b21475a475995938b89"><td class="mdescLeft">&#160;</td><td class="mdescRight">Method to calculate time interval necessary for accelerating to speed v_hat for a given vehicle. Will return 0 if v_hat is less than vehicle speed.  <a href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a3ba56cc964002b21475a475995938b89">More...</a><br /></td></tr>
<tr class="separator:a3ba56cc964002b21475a475995938b89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63107a1e136be3a00f3a1445531904aa"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a63107a1e136be3a00f3a1445531904aa">calculate_deceleration_time</a> (const <a class="el" href="structstreets__vehicles_1_1vehicle.html">streets_vehicles::vehicle</a> &amp;veh, const double v_hat) const</td></tr>
<tr class="memdesc:a63107a1e136be3a00f3a1445531904aa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Method to calculate time interval necessary for deceleration from v_hat to 0 to stop at stop bar. Assumes trajectory with constant maximum deceleration.  <a href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a63107a1e136be3a00f3a1445531904aa">More...</a><br /></td></tr>
<tr class="separator:a63107a1e136be3a00f3a1445531904aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afedbbc9205b39ceb8707d950b5c26556"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#afedbbc9205b39ceb8707d950b5c26556">calculate_cruising_time</a> (const <a class="el" href="structstreets__vehicles_1_1vehicle.html">streets_vehicles::vehicle</a> &amp;veh, const double v_hat, const double delta_x_prime) const</td></tr>
<tr class="memdesc:afedbbc9205b39ceb8707d950b5c26556"><td class="mdescLeft">&#160;</td><td class="mdescRight">Method to calculate time interval necessary for cruising at a constant speed v_hat (speed limit) greater than current vehicle speed.If vehicle speed is greater that v_hat, this method will return 0.  <a href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#afedbbc9205b39ceb8707d950b5c26556">More...</a><br /></td></tr>
<tr class="separator:afedbbc9205b39ceb8707d950b5c26556"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a77c53828e29e53a9a7ff752afb65b549"><td class="memItemLeft" align="right" valign="top">std::list&lt; <a class="el" href="structstreets__vehicles_1_1vehicle.html">streets_vehicles::vehicle</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a77c53828e29e53a9a7ff752afb65b549">rdvs_previously_granted_access</a></td></tr>
<tr class="memdesc:a77c53828e29e53a9a7ff752afb65b549"><td class="mdescLeft">&#160;</td><td class="mdescRight">A list of RDV vehicles granted access by the <a class="el" href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html" title="Abstract Class for extend to implement scheduling business logic.">vehicle_scheduler</a>, who's updates do not yet reflect they have received access (still considered RDV by all_stop_status_intent_processor). We maintain this list to ensure we do not grant conflicting vehicles access to the intersection simultaneously in back to back scheduling calculations where the first RDV granted access in the first schedule has not yet provided a vehicle update the reflects this access by the time we calculate the second schedule.  <a href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a77c53828e29e53a9a7ff752afb65b549">More...</a><br /></td></tr>
<tr class="separator:a77c53828e29e53a9a7ff752afb65b549"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13124a205e1c6615f6a137c507b2a4eb"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a13124a205e1c6615f6a137c507b2a4eb">entering_time_buffer</a> = 0</td></tr>
<tr class="memdesc:a13124a205e1c6615f6a137c507b2a4eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configurable time buffer in milliseconds for estimating the time it takes a vehicle to leave its entry lane and enter the intersection box once granted access to the intersection.  <a href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a13124a205e1c6615f6a137c507b2a4eb">More...</a><br /></td></tr>
<tr class="separator:a13124a205e1c6615f6a137c507b2a4eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a004c41012f860faa9634e42c7d5740f7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a004c41012f860faa9634e42c7d5740f7">flexibility_limit</a> = 5</td></tr>
<tr class="memdesc:a004c41012f860faa9634e42c7d5740f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Limits how much departure position for a given vehicle can change from current reported departure position.  <a href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a004c41012f860faa9634e42c7d5740f7">More...</a><br /></td></tr>
<tr class="separator:a004c41012f860faa9634e42c7d5740f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="inherited" name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_methods_classstreets__vehicle__scheduler_1_1vehicle__scheduler"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classstreets__vehicle__scheduler_1_1vehicle__scheduler')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html">streets_vehicle_scheduler::vehicle_scheduler</a></td></tr>
<tr class="memitem:a85947f43b293504a108619374c0c0dae inherit pro_methods_classstreets__vehicle__scheduler_1_1vehicle__scheduler"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#a85947f43b293504a108619374c0c0dae">estimate_vehicles_at_common_time</a> (std::unordered_map&lt; std::string, <a class="el" href="structstreets__vehicles_1_1vehicle.html">streets_vehicles::vehicle</a> &gt; &amp;vehicles, const u_int64_t timestamp) const</td></tr>
<tr class="memdesc:a85947f43b293504a108619374c0c0dae inherit pro_methods_classstreets__vehicle__scheduler_1_1vehicle__scheduler"><td class="mdescLeft">&#160;</td><td class="mdescRight">Method to estimate all vehicle's speed and location at a common future time. The time needs to be time since epoch in milliseconds. To predict vehicle location and speed at future time, current kinematic information is used including speed and current acceleration.  <a href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#a85947f43b293504a108619374c0c0dae">More...</a><br /></td></tr>
<tr class="separator:a85947f43b293504a108619374c0c0dae inherit pro_methods_classstreets__vehicle__scheduler_1_1vehicle__scheduler"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8916add714bef70d8f48efc0ccfca7b inherit pro_methods_classstreets__vehicle__scheduler_1_1vehicle__scheduler"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classOpenAPI_1_1OAILanelet__info.html">OpenAPI::OAILanelet_info</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#af8916add714bef70d8f48efc0ccfca7b">get_entry_lanelet_info</a> (const <a class="el" href="structstreets__vehicles_1_1vehicle.html">streets_vehicles::vehicle</a> &amp;veh) const</td></tr>
<tr class="memdesc:af8916add714bef70d8f48efc0ccfca7b inherit pro_methods_classstreets__vehicle__scheduler_1_1vehicle__scheduler"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper method to get entry lane OAILanelet_info from intersection information given a vehicle.  <a href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#af8916add714bef70d8f48efc0ccfca7b">More...</a><br /></td></tr>
<tr class="separator:af8916add714bef70d8f48efc0ccfca7b inherit pro_methods_classstreets__vehicle__scheduler_1_1vehicle__scheduler"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2c80eb87e5a9cabaad660544003663c inherit pro_methods_classstreets__vehicle__scheduler_1_1vehicle__scheduler"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classOpenAPI_1_1OAILanelet__info.html">OpenAPI::OAILanelet_info</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#af2c80eb87e5a9cabaad660544003663c">get_link_lanelet_info</a> (const <a class="el" href="structstreets__vehicles_1_1vehicle.html">streets_vehicles::vehicle</a> &amp;veh) const</td></tr>
<tr class="memdesc:af2c80eb87e5a9cabaad660544003663c inherit pro_methods_classstreets__vehicle__scheduler_1_1vehicle__scheduler"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper method to get link lane OAILanelet_info from intersection information given a vehicle.  <a href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#af2c80eb87e5a9cabaad660544003663c">More...</a><br /></td></tr>
<tr class="separator:af2c80eb87e5a9cabaad660544003663c inherit pro_methods_classstreets__vehicle__scheduler_1_1vehicle__scheduler"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classstreets__vehicle__scheduler_1_1vehicle__scheduler"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classstreets__vehicle__scheduler_1_1vehicle__scheduler')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html">streets_vehicle_scheduler::vehicle_scheduler</a></td></tr>
<tr class="memitem:a5fa37276e5ccb41e38cbef573e830e8e inherit pro_attribs_classstreets__vehicle__scheduler_1_1vehicle__scheduler"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="classOpenAPI_1_1OAIIntersection__info.html">OpenAPI::OAIIntersection_info</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#a5fa37276e5ccb41e38cbef573e830e8e">intersection_info</a></td></tr>
<tr class="memdesc:a5fa37276e5ccb41e38cbef573e830e8e inherit pro_attribs_classstreets__vehicle__scheduler_1_1vehicle__scheduler"><td class="mdescLeft">&#160;</td><td class="mdescRight">shared pointer to intersection information required for scheduling.  <a href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#a5fa37276e5ccb41e38cbef573e830e8e">More...</a><br /></td></tr>
<tr class="separator:a5fa37276e5ccb41e38cbef573e830e8e inherit pro_attribs_classstreets__vehicle__scheduler_1_1vehicle__scheduler"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="all__stop__vehicle__scheduler_8h_source.html#l00016">16</a> of file <a class="el" href="all__stop__vehicle__scheduler_8h_source.html">all_stop_vehicle_scheduler.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ab4a2d24aef35503f3ff8eeaacc07bb9d" name="ab4a2d24aef35503f3ff8eeaacc07bb9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4a2d24aef35503f3ff8eeaacc07bb9d">&#9670;&nbsp;</a></span>all_stop_vehicle_scheduler()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">streets_vehicle_scheduler::all_stop_vehicle_scheduler::all_stop_vehicle_scheduler </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">default</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Construct a new all stop vehicle scheduler object. </p>

</div>
</div>
<a id="ad40be3e19c0eca5e076b1e5831a7e85f" name="ad40be3e19c0eca5e076b1e5831a7e85f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad40be3e19c0eca5e076b1e5831a7e85f">&#9670;&nbsp;</a></span>~all_stop_vehicle_scheduler()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">streets_vehicle_scheduler::all_stop_vehicle_scheduler::~all_stop_vehicle_scheduler </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">default</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Destroy the all stop vehicle scheduler object. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a3ba56cc964002b21475a475995938b89" name="a3ba56cc964002b21475a475995938b89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ba56cc964002b21475a475995938b89">&#9670;&nbsp;</a></span>calculate_acceleration_time()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double streets_vehicle_scheduler::all_stop_vehicle_scheduler::calculate_acceleration_time </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structstreets__vehicles_1_1vehicle.html">streets_vehicles::vehicle</a> &amp;&#160;</td>
          <td class="paramname"><em>veh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>v_hat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Method to calculate time interval necessary for accelerating to speed v_hat for a given vehicle. Will return 0 if v_hat is less than vehicle speed. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">veh</td><td>vehicle for which to calculate trajectory. </td></tr>
    <tr><td class="paramname">v_hat</td><td>maximum speed to reach during acceleration in m/s. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double time interval necessary for acceleration in seconds. </dd></dl>

<p class="definition">Definition at line <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00093">93</a> of file <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html">all_stop_vehicle_scheduler.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   93</span>                                                                                                                                {</div>
<div class="line"><span class="lineno">   94</span>        <span class="comment">// If v_hat is less than current vehicle speed there is only time for deceleration</span></div>
<div class="line"><span class="lineno">   95</span>        <span class="comment">// Note: This is an error case and means stopping before the stop bar is not possible given current kinematic information</span></div>
<div class="line"><span class="lineno">   96</span>        <span class="comment">// and deceleration limits</span></div>
<div class="line"><span class="lineno">   97</span>        <span class="keywordflow">if</span> ( v_hat &lt; veh.<a class="code hl_variable" href="structstreets__vehicles_1_1vehicle.html#a026375b9e6ffc8f8c8aee72465f352dc">_cur_speed</a> ){</div>
<div class="line"><span class="lineno">   98</span>            <span class="keywordflow">return</span> 0.0;</div>
<div class="line"><span class="lineno">   99</span>        } </div>
<div class="line"><span class="lineno">  100</span>        <span class="keywordflow">return</span> (v_hat-veh.<a class="code hl_variable" href="structstreets__vehicles_1_1vehicle.html#a026375b9e6ffc8f8c8aee72465f352dc">_cur_speed</a>)/veh.<a class="code hl_variable" href="structstreets__vehicles_1_1vehicle.html#a1180998ca4eeb7d695d135a1e4a75424">_accel_max</a>;</div>
<div class="line"><span class="lineno">  101</span>    }</div>
<div class="ttc" id="astructstreets__vehicles_1_1vehicle_html_a026375b9e6ffc8f8c8aee72465f352dc"><div class="ttname"><a href="structstreets__vehicles_1_1vehicle.html#a026375b9e6ffc8f8c8aee72465f352dc">streets_vehicles::vehicle::_cur_speed</a></div><div class="ttdeci">double _cur_speed</div><div class="ttdef"><b>Definition:</b> <a href="vehicle_8h_source.html#l00075">vehicle.h:75</a></div></div>
<div class="ttc" id="astructstreets__vehicles_1_1vehicle_html_a1180998ca4eeb7d695d135a1e4a75424"><div class="ttname"><a href="structstreets__vehicles_1_1vehicle.html#a1180998ca4eeb7d695d135a1e4a75424">streets_vehicles::vehicle::_accel_max</a></div><div class="ttdeci">double _accel_max</div><div class="ttdef"><b>Definition:</b> <a href="vehicle_8h_source.html#l00045">vehicle.h:45</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="vehicle_8h_source.html#l00045">streets_vehicles::vehicle::_accel_max</a>, and <a class="el" href="vehicle_8h_source.html#l00075">streets_vehicles::vehicle::_cur_speed</a>.</p>

<p class="reference">Referenced by <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00390">estimate_earliest_time_to_stop_bar()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a3ba56cc964002b21475a475995938b89_icgraph.png" border="0" usemap="#aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a3ba56cc964002b21475a475995938b89_icgraph" alt=""/></div>
<map name="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a3ba56cc964002b21475a475995938b89_icgraph" id="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a3ba56cc964002b21475a475995938b89_icgraph">
<area shape="rect" title="Method to calculate time interval necessary for accelerating to speed v_hat for a given vehicle...." alt="" coords="701,13,891,69"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#ad5f0462b2d82168b7b71dcfd15eaa7f2" title="Method to use vehicle kinematic information to estimate earliest possible time stopping time for a ve..." alt="" coords="469,5,653,76"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#acd0ec98c5efc93aadb38563e3b98d1bb" title="Schedule all Entering Vehicles (EVs). Method first organizes all EVs into lists based on their entry ..." alt="" coords="237,13,421,69"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a930961b3e285b2a2d08f4276ffa22658" title="Method to schedule vehicles. Given and empty intersection_schedule object and a map of vehicles and v..." alt="" coords="5,13,189,69"/>
</map>
</div>

</div>
</div>
<a id="afedbbc9205b39ceb8707d950b5c26556" name="afedbbc9205b39ceb8707d950b5c26556"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afedbbc9205b39ceb8707d950b5c26556">&#9670;&nbsp;</a></span>calculate_cruising_time()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double streets_vehicle_scheduler::all_stop_vehicle_scheduler::calculate_cruising_time </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structstreets__vehicles_1_1vehicle.html">streets_vehicles::vehicle</a> &amp;&#160;</td>
          <td class="paramname"><em>veh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>v_hat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>delta_x_prime</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Method to calculate time interval necessary for cruising at a constant speed v_hat (speed limit) greater than current vehicle speed.If vehicle speed is greater that v_hat, this method will return 0. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">veh</td><td>vehicle for which to calculate trajectory for. </td></tr>
    <tr><td class="paramname">v_hat</td><td>cruising speed, usually lane speed limit, in m/s. </td></tr>
    <tr><td class="paramname">delta_x_prime</td><td>the distance necessary for vehicle to accelerate to speed limit with maximum acceleration and then decelerate back to a stop in meters.The difference the distance to the stop bar and this distance is the part of the trajectory for which the vehicle can cruise at the speed limit. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double time interval necessary for cruising at speed limit in seconds. </dd></dl>

<p class="definition">Definition at line <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00103">103</a> of file <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html">all_stop_vehicle_scheduler.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  103</span>                                                                                                                                                        {</div>
<div class="line"><span class="lineno">  104</span>        <span class="comment">// If v_hat is less than current speed there is only time for deceleration</span></div>
<div class="line"><span class="lineno">  105</span>        <span class="comment">// Note: This is an error case and means stopping before the stop bar is not possible given current kinematic information</span></div>
<div class="line"><span class="lineno">  106</span>        <span class="comment">// and deceleration limits</span></div>
<div class="line"><span class="lineno">  107</span>        <span class="keywordflow">if</span> ( v_hat &lt; veh.<a class="code hl_variable" href="structstreets__vehicles_1_1vehicle.html#a026375b9e6ffc8f8c8aee72465f352dc">_cur_speed</a> ) {</div>
<div class="line"><span class="lineno">  108</span>            <span class="keywordflow">return</span> 0.0;</div>
<div class="line"><span class="lineno">  109</span>        }</div>
<div class="line"><span class="lineno">  110</span>        <span class="keywordflow">return</span> (veh.<a class="code hl_variable" href="structstreets__vehicles_1_1vehicle.html#a21a6378ca2401ac4bc9ca6f6364833fb">_cur_distance</a> - delta_x_prime)/v_hat; </div>
<div class="line"><span class="lineno">  111</span>    }</div>
<div class="ttc" id="astructstreets__vehicles_1_1vehicle_html_a21a6378ca2401ac4bc9ca6f6364833fb"><div class="ttname"><a href="structstreets__vehicles_1_1vehicle.html#a21a6378ca2401ac4bc9ca6f6364833fb">streets_vehicles::vehicle::_cur_distance</a></div><div class="ttdeci">double _cur_distance</div><div class="ttdef"><b>Definition:</b> <a href="vehicle_8h_source.html#l00073">vehicle.h:73</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="vehicle_8h_source.html#l00073">streets_vehicles::vehicle::_cur_distance</a>, and <a class="el" href="vehicle_8h_source.html#l00075">streets_vehicles::vehicle::_cur_speed</a>.</p>

<p class="reference">Referenced by <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00390">estimate_earliest_time_to_stop_bar()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_afedbbc9205b39ceb8707d950b5c26556_icgraph.png" border="0" usemap="#aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_afedbbc9205b39ceb8707d950b5c26556_icgraph" alt=""/></div>
<map name="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_afedbbc9205b39ceb8707d950b5c26556_icgraph" id="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_afedbbc9205b39ceb8707d950b5c26556_icgraph">
<area shape="rect" title="Method to calculate time interval necessary for cruising at a constant speed v_hat (speed limit) grea..." alt="" coords="701,13,885,69"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#ad5f0462b2d82168b7b71dcfd15eaa7f2" title="Method to use vehicle kinematic information to estimate earliest possible time stopping time for a ve..." alt="" coords="469,5,653,76"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#acd0ec98c5efc93aadb38563e3b98d1bb" title="Schedule all Entering Vehicles (EVs). Method first organizes all EVs into lists based on their entry ..." alt="" coords="237,13,421,69"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a930961b3e285b2a2d08f4276ffa22658" title="Method to schedule vehicles. Given and empty intersection_schedule object and a map of vehicles and v..." alt="" coords="5,13,189,69"/>
</map>
</div>

</div>
</div>
<a id="a63107a1e136be3a00f3a1445531904aa" name="a63107a1e136be3a00f3a1445531904aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63107a1e136be3a00f3a1445531904aa">&#9670;&nbsp;</a></span>calculate_deceleration_time()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double streets_vehicle_scheduler::all_stop_vehicle_scheduler::calculate_deceleration_time </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structstreets__vehicles_1_1vehicle.html">streets_vehicles::vehicle</a> &amp;&#160;</td>
          <td class="paramname"><em>veh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>v_hat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Method to calculate time interval necessary for deceleration from v_hat to 0 to stop at stop bar. Assumes trajectory with constant maximum deceleration. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">veh</td><td>vehicle for which to calculate trajectory. </td></tr>
    <tr><td class="paramname">v_hat</td><td>max speed from which to decelerate from in m/s </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double time interval necessary for acceleration in seconds. </dd></dl>

<p class="definition">Definition at line <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00113">113</a> of file <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html">all_stop_vehicle_scheduler.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  113</span>                                                                                                                                {</div>
<div class="line"><span class="lineno">  114</span>        <span class="keywordflow">return</span> -v_hat/veh.<a class="code hl_variable" href="structstreets__vehicles_1_1vehicle.html#a253341595deb3473620116dcf63d9927">_decel_max</a>;</div>
<div class="line"><span class="lineno">  115</span>    }</div>
<div class="ttc" id="astructstreets__vehicles_1_1vehicle_html_a253341595deb3473620116dcf63d9927"><div class="ttname"><a href="structstreets__vehicles_1_1vehicle.html#a253341595deb3473620116dcf63d9927">streets_vehicles::vehicle::_decel_max</a></div><div class="ttdeci">double _decel_max</div><div class="ttdef"><b>Definition:</b> <a href="vehicle_8h_source.html#l00047">vehicle.h:47</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="vehicle_8h_source.html#l00047">streets_vehicles::vehicle::_decel_max</a>.</p>

<p class="reference">Referenced by <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00390">estimate_earliest_time_to_stop_bar()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a63107a1e136be3a00f3a1445531904aa_icgraph.png" border="0" usemap="#aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a63107a1e136be3a00f3a1445531904aa_icgraph" alt=""/></div>
<map name="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a63107a1e136be3a00f3a1445531904aa_icgraph" id="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a63107a1e136be3a00f3a1445531904aa_icgraph">
<area shape="rect" title="Method to calculate time interval necessary for deceleration from v_hat to 0 to stop at stop bar...." alt="" coords="701,13,891,69"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#ad5f0462b2d82168b7b71dcfd15eaa7f2" title="Method to use vehicle kinematic information to estimate earliest possible time stopping time for a ve..." alt="" coords="469,5,653,76"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#acd0ec98c5efc93aadb38563e3b98d1bb" title="Schedule all Entering Vehicles (EVs). Method first organizes all EVs into lists based on their entry ..." alt="" coords="237,13,421,69"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a930961b3e285b2a2d08f4276ffa22658" title="Method to schedule vehicles. Given and empty intersection_schedule object and a map of vehicles and v..." alt="" coords="5,13,189,69"/>
</map>
</div>

</div>
</div>
<a id="ae5a42af1af20b06df9ad6af5d3170406" name="ae5a42af1af20b06df9ad6af5d3170406"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5a42af1af20b06df9ad6af5d3170406">&#9670;&nbsp;</a></span>calculate_v_hat()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double streets_vehicle_scheduler::all_stop_vehicle_scheduler::calculate_v_hat </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structstreets__vehicles_1_1vehicle.html">streets_vehicles::vehicle</a> &amp;&#160;</td>
          <td class="paramname"><em>veh</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Method to calculate v_hat. This is the maximum speed reached between maximum speed reached between acceleration and deceleration periods for a vehicle trajectory towards stopping at a stop bar. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">veh</td><td>vehicle to calculate trajectory for. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double v_hat in m/s </dd></dl>

<p class="definition">Definition at line <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00082">82</a> of file <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html">all_stop_vehicle_scheduler.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   82</span>                                                                                               {</div>
<div class="line"><span class="lineno">   83</span>        <span class="keywordtype">double</span> numerator = veh.<a class="code hl_variable" href="structstreets__vehicles_1_1vehicle.html#a253341595deb3473620116dcf63d9927">_decel_max</a> *( 2 * veh.<a class="code hl_variable" href="structstreets__vehicles_1_1vehicle.html#a21a6378ca2401ac4bc9ca6f6364833fb">_cur_distance</a>*veh.<a class="code hl_variable" href="structstreets__vehicles_1_1vehicle.html#a1180998ca4eeb7d695d135a1e4a75424">_accel_max</a> + pow(veh.<a class="code hl_variable" href="structstreets__vehicles_1_1vehicle.html#a026375b9e6ffc8f8c8aee72465f352dc">_cur_speed</a>, 2));</div>
<div class="line"><span class="lineno">   84</span>        <span class="keywordtype">double</span> denominator = veh.<a class="code hl_variable" href="structstreets__vehicles_1_1vehicle.html#a253341595deb3473620116dcf63d9927">_decel_max</a>-veh.<a class="code hl_variable" href="structstreets__vehicles_1_1vehicle.html#a1180998ca4eeb7d695d135a1e4a75424">_accel_max</a>;</div>
<div class="line"><span class="lineno">   85</span>        <span class="keywordtype">double</span> v_hat = sqrt(numerator/denominator);</div>
<div class="line"><span class="lineno">   86</span>        <span class="comment">// If v_hat is less that current vehicle speed, const maximum deceleration will not stop before stop bar</span></div>
<div class="line"><span class="lineno">   87</span>        <span class="keywordflow">if</span> ( v_hat &lt; veh.<a class="code hl_variable" href="structstreets__vehicles_1_1vehicle.html#a026375b9e6ffc8f8c8aee72465f352dc">_cur_speed</a>) {</div>
<div class="line"><span class="lineno">   88</span>            SPDLOG_ERROR(<span class="stringliteral">&quot;Stopping trajectory not possible for vehicle {0} with speed {1} m/s and v_hat {2} m/s!&quot;</span>, veh.<a class="code hl_variable" href="structstreets__vehicles_1_1vehicle.html#a470605f661a8f625329ebbb10888e2b8">_id</a>, veh.<a class="code hl_variable" href="structstreets__vehicles_1_1vehicle.html#a026375b9e6ffc8f8c8aee72465f352dc">_cur_speed</a>, v_hat);</div>
<div class="line"><span class="lineno">   89</span>        }</div>
<div class="line"><span class="lineno">   90</span>        <span class="keywordflow">return</span> v_hat;</div>
<div class="line"><span class="lineno">   91</span>    }</div>
<div class="ttc" id="astructstreets__vehicles_1_1vehicle_html_a470605f661a8f625329ebbb10888e2b8"><div class="ttname"><a href="structstreets__vehicles_1_1vehicle.html#a470605f661a8f625329ebbb10888e2b8">streets_vehicles::vehicle::_id</a></div><div class="ttdeci">std::string _id</div><div class="ttdef"><b>Definition:</b> <a href="vehicle_8h_source.html#l00037">vehicle.h:37</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="vehicle_8h_source.html#l00045">streets_vehicles::vehicle::_accel_max</a>, <a class="el" href="vehicle_8h_source.html#l00073">streets_vehicles::vehicle::_cur_distance</a>, <a class="el" href="vehicle_8h_source.html#l00075">streets_vehicles::vehicle::_cur_speed</a>, <a class="el" href="vehicle_8h_source.html#l00047">streets_vehicles::vehicle::_decel_max</a>, and <a class="el" href="vehicle_8h_source.html#l00037">streets_vehicles::vehicle::_id</a>.</p>

<p class="reference">Referenced by <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00390">estimate_earliest_time_to_stop_bar()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_ae5a42af1af20b06df9ad6af5d3170406_icgraph.png" border="0" usemap="#aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_ae5a42af1af20b06df9ad6af5d3170406_icgraph" alt=""/></div>
<map name="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_ae5a42af1af20b06df9ad6af5d3170406_icgraph" id="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_ae5a42af1af20b06df9ad6af5d3170406_icgraph">
<area shape="rect" title="Method to calculate v_hat. This is the maximum speed reached between maximum speed reached between ac..." alt="" coords="701,13,885,69"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#ad5f0462b2d82168b7b71dcfd15eaa7f2" title="Method to use vehicle kinematic information to estimate earliest possible time stopping time for a ve..." alt="" coords="469,5,653,76"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#acd0ec98c5efc93aadb38563e3b98d1bb" title="Schedule all Entering Vehicles (EVs). Method first organizes all EVs into lists based on their entry ..." alt="" coords="237,13,421,69"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a930961b3e285b2a2d08f4276ffa22658" title="Method to schedule vehicles. Given and empty intersection_schedule object and a map of vehicles and v..." alt="" coords="5,13,189,69"/>
</map>
</div>

</div>
</div>
<a id="a77c415e3ef29a00acc67c7aac87a270b" name="a77c415e3ef29a00acc67c7aac87a270b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77c415e3ef29a00acc67c7aac87a270b">&#9670;&nbsp;</a></span>consider_departure_position_permutation()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool streets_vehicle_scheduler::all_stop_vehicle_scheduler::consider_departure_position_permutation </td>
          <td>(</td>
          <td class="paramtype">const std::list&lt; <a class="el" href="structstreets__vehicles_1_1vehicle.html">streets_vehicles::vehicle</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>rdvs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::shared_ptr&lt; <a class="el" href="structstreets__vehicle__scheduler_1_1all__stop__intersection__schedule.html">all_stop_intersection_schedule</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>option</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>starting_departure_position</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Creates and intersection schedule for a given RDV departure order. RDV departure order is based on rdvs order. Returns reference to <a class="el" href="structstreets__vehicle__scheduler_1_1intersection__schedule.html" title="Struct to store vehicle schedules for all vehicle in an intersection. Includes a timestamp in millise...">intersection_schedule</a> option/possibility with given departure order. Assumes <a class="el" href="structstreets__vehicle__scheduler_1_1intersection__schedule.html" title="Struct to store vehicle schedules for all vehicle in an intersection. Includes a timestamp in millise...">intersection_schedule</a> option only contains schedules for DVs. Populates <a class="el" href="structstreets__vehicle__scheduler_1_1intersection__schedule.html" title="Struct to store vehicle schedules for all vehicle in an intersection. Includes a timestamp in millise...">intersection_schedule</a> with RDV vehicle_schedules. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rdvs</td><td>vector of unscheduled RDVs </td></tr>
    <tr><td class="paramname">option</td><td><a class="el" href="structstreets__vehicle__scheduler_1_1all__stop__intersection__schedule.html" title="Struct to store vehicle schedules for all vehicle in an intersection. Includes a timestamp in millise...">all_stop_intersection_schedule</a> possibility. </td></tr>
    <tr><td class="paramname">starting_departure_position</td><td>first available departure position given already scheduled vehicle (e.i. DVs) </td></tr>
    <tr><td class="paramname">scheduled_dvs</td><td>a vector of scheduled dvs, This includes dvs already schedules and any RDVs scheduled in this permutation. This is necessary for calculating the current RDVs entering time based on already scheduled DVs and RDVs conflicts. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if departure order is valid and does not violate flexibility_limit for any vehicle. </dd>
<dd>
false if departure order is invalid and does violate flexibility_limit for any vehicle. </dd></dl>

<p class="definition">Definition at line <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00432">432</a> of file <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html">all_stop_vehicle_scheduler.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  435</span>                                                                                                                        {</div>
<div class="line"><span class="lineno">  436</span>        <span class="keywordflow">for</span> ( <span class="keyword">const</span> <span class="keyword">auto</span> &amp;veh : rdvs ) {</div>
<div class="line"><span class="lineno">  437</span>            <span class="comment">// If scheduling option moves vehicle departure position more than flexibility limit it is not a valid option.</span></div>
<div class="line"><span class="lineno">  438</span>            <span class="keywordflow">if</span> ( abs(starting_departure_position - veh._departure_position) &gt; <a class="code hl_variable" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a004c41012f860faa9634e42c7d5740f7">flexibility_limit</a> ) {</div>
<div class="line"><span class="lineno">  439</span>                SPDLOG_WARN(</div>
<div class="line"><span class="lineno">  440</span>                    <span class="stringliteral">&quot;Not considering scheduling option since change in departure position for vehicle {0} exceeds flexibility limit {1}!&quot;</span>,</div>
<div class="line"><span class="lineno">  441</span>                    veh._id, <a class="code hl_variable" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a004c41012f860faa9634e42c7d5740f7">flexibility_limit</a>);</div>
<div class="line"><span class="lineno">  442</span>                <span class="comment">// Break out of scheduling estimation loop and do not consider this scheduling option</span></div>
<div class="line"><span class="lineno">  443</span>                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  444</span>            }</div>
<div class="line"><span class="lineno">  445</span>            all_stop_vehicle_schedule sched;</div>
<div class="line"><span class="lineno">  446</span>            <span class="comment">// Populate common vehicle schedule information</span></div>
<div class="line"><span class="lineno">  447</span>            sched.v_id = veh._id;</div>
<div class="line"><span class="lineno">  448</span>            <span class="comment">// RDVs should have already stopped</span></div>
<div class="line"><span class="lineno">  449</span>            sched.st = veh._actual_st;</div>
<div class="line"><span class="lineno">  450</span>            sched.est =  veh._actual_st;</div>
<div class="line"><span class="lineno">  451</span>            <span class="comment">// set dp position for current permutation                      </span></div>
<div class="line"><span class="lineno">  452</span>            sched.dp = starting_departure_position;</div>
<div class="line"><span class="lineno">  453</span>            <span class="comment">// Set connection link lanelet id</span></div>
<div class="line"><span class="lineno">  454</span>            sched.link_id = veh._link_id;</div>
<div class="line"><span class="lineno">  455</span>            <span class="comment">// Set entry lanelet id </span></div>
<div class="line"><span class="lineno">  456</span>            sched.entry_lane = veh._entry_lane_id;</div>
<div class="line"><span class="lineno">  457</span>            <span class="comment">// Get vehicle lane info</span></div>
<div class="line"><span class="lineno">  458</span>            <a class="code hl_class" href="classOpenAPI_1_1OAILanelet__info.html">OpenAPI::OAILanelet_info</a> veh_lane = <a class="code hl_function" href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#af2c80eb87e5a9cabaad660544003663c">get_link_lanelet_info</a>(veh);</div>
<div class="line"><span class="lineno">  459</span>            std::shared_ptr&lt;all_stop_vehicle_schedule&gt; latest_conflicting_vehicle = <a class="code hl_function" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#aa06721804b8a4075b98c2e8ad40c84da">get_latest_conflicting</a>( veh_lane, option-&gt;vehicle_schedules);</div>
<div class="line"><span class="lineno">  460</span>            <span class="comment">// If there is no conflicting scheduled vehicle (RDVs and DVs)</span></div>
<div class="line"><span class="lineno">  461</span>            <span class="keywordflow">if</span> ( latest_conflicting_vehicle == <span class="keyword">nullptr</span>) {</div>
<div class="line"><span class="lineno">  462</span>                <span class="comment">// Consider previously scheduled vehicle. Current vehicle cannot be granted access</span></div>
<div class="line"><span class="lineno">  463</span>                <span class="comment">// to intersection regardless of conflict status before previously scheduled vehicle</span></div>
<div class="line"><span class="lineno">  464</span>                <span class="comment">// to preserve departure order</span></div>
<div class="line"><span class="lineno">  465</span>                <span class="keywordflow">if</span> ( option-&gt;vehicle_schedules.empty() || option-&gt;vehicle_schedules.back().access ) {</div>
<div class="line"><span class="lineno">  466</span>                    <span class="comment">// Give vehicle access since there are no proceeding vehicles</span></div>
<div class="line"><span class="lineno">  467</span>                    sched.access = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  468</span>                    <span class="comment">// Set vehicle state. Will not impact clearance time estimation since set on schedule</span></div>
<div class="line"><span class="lineno">  469</span>                    sched.state = <a class="code hl_enumvalue" href="namespacestreets__vehicles.html#a41f5c896d8020c141aa96235cf1405aca58d6a88f13e2db7f5059c41047876f00">streets_vehicles::vehicle_state::DV</a>;</div>
<div class="line"><span class="lineno">  470</span>                    <span class="comment">// Entering time equals schedule time</span></div>
<div class="line"><span class="lineno">  471</span>                    sched.et = option-&gt;timestamp;</div>
<div class="line"><span class="lineno">  472</span>                    <span class="comment">// Departure time equals entering time + clearance time</span></div>
<div class="line"><span class="lineno">  473</span>                    sched.dt =  sched.et + <a class="code hl_function" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a15b4da36dba827263da4c844028c6db1">estimate_clearance_time</a>( veh, veh_lane);</div>
<div class="line"><span class="lineno">  474</span>                }</div>
<div class="line"><span class="lineno">  475</span>                <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  476</span>                    <span class="comment">// Can not grant access to vehicle if previous vehicle does not have access yet.</span></div>
<div class="line"><span class="lineno">  477</span>                    sched.access = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  478</span>                    <span class="comment">// Set vehicle state. Will not impact clearance time estimation since set on schedule</span></div>
<div class="line"><span class="lineno">  479</span>                    sched.state = <a class="code hl_enumvalue" href="namespacestreets__vehicles.html#a41f5c896d8020c141aa96235cf1405acab08ef04fe84cf4f6645fef073717f36f">streets_vehicles::vehicle_state::RDV</a>;</div>
<div class="line"><span class="lineno">  480</span>                    <span class="comment">// Entering time equals schedule time</span></div>
<div class="line"><span class="lineno">  481</span>                    sched.et = option-&gt;vehicle_schedules.back().et;</div>
<div class="line"><span class="lineno">  482</span>                    <span class="comment">// Departure time equals entering time + clearance time</span></div>
<div class="line"><span class="lineno">  483</span>                    sched.dt =  sched.et + <a class="code hl_function" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a15b4da36dba827263da4c844028c6db1">estimate_clearance_time</a>( veh, veh_lane); </div>
<div class="line"><span class="lineno">  484</span>                }</div>
<div class="line"><span class="lineno">  485</span>            }</div>
<div class="line"><span class="lineno">  486</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  487</span>                SPDLOG_TRACE(<span class="stringliteral">&quot;Latest conflicting vehicle is {0} and next vehicle is {1}&quot;</span>, latest_conflicting_vehicle-&gt;v_id, veh._id);</div>
<div class="line"><span class="lineno">  488</span>                sched.access = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  489</span>                sched.state =  <a class="code hl_enumvalue" href="namespacestreets__vehicles.html#a41f5c896d8020c141aa96235cf1405acab08ef04fe84cf4f6645fef073717f36f">streets_vehicles::vehicle_state::RDV</a>;</div>
<div class="line"><span class="lineno">  490</span>                sched.et =  std::max(latest_conflicting_vehicle-&gt;dt, option-&gt;vehicle_schedules.back().et);</div>
<div class="line"><span class="lineno">  491</span>                <span class="comment">// Departure time is estimated clearance time for vehicle and link lane plus entering time</span></div>
<div class="line"><span class="lineno">  492</span>                sched.dt = sched.et + <a class="code hl_function" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a15b4da36dba827263da4c844028c6db1">estimate_clearance_time</a>( veh, veh_lane );</div>
<div class="line"><span class="lineno">  493</span> </div>
<div class="line"><span class="lineno">  494</span>                </div>
<div class="line"><span class="lineno">  495</span>            }</div>
<div class="line"><span class="lineno">  496</span>            <span class="comment">// Add vehicle schedule to option</span></div>
<div class="line"><span class="lineno">  497</span>            option-&gt;vehicle_schedules.push_back(sched);</div>
<div class="line"><span class="lineno">  498</span>            <span class="comment">// Point to new previously scheduled vehicle</span></div>
<div class="line"><span class="lineno">  499</span>            <span class="comment">// Increment departure position</span></div>
<div class="line"><span class="lineno">  500</span>            starting_departure_position++;</div>
<div class="line"><span class="lineno">  501</span> </div>
<div class="line"><span class="lineno">  502</span>            </div>
<div class="line"><span class="lineno">  503</span>        }</div>
<div class="line"><span class="lineno">  504</span>        SPDLOG_TRACE(<span class="stringliteral">&quot;Schedule Option: \n&quot;</span>+option-&gt;toCSV());</div>
<div class="line"><span class="lineno">  505</span>        SPDLOG_TRACE(<span class="stringliteral">&quot;With delay {0}.&quot;</span> ,option-&gt;get_delay() );</div>
<div class="line"><span class="lineno">  506</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  507</span> </div>
<div class="line"><span class="lineno">  508</span>            </div>
<div class="line"><span class="lineno">  509</span>    }</div>
<div class="ttc" id="aclassOpenAPI_1_1OAILanelet__info_html"><div class="ttname"><a href="classOpenAPI_1_1OAILanelet__info.html">OpenAPI::OAILanelet_info</a></div><div class="ttdef"><b>Definition:</b> <a href="intersection__client__api_2OAILanelet__info_8h_source.html#l00031">OAILanelet_info.h:31</a></div></div>
<div class="ttc" id="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_html_a004c41012f860faa9634e42c7d5740f7"><div class="ttname"><a href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a004c41012f860faa9634e42c7d5740f7">streets_vehicle_scheduler::all_stop_vehicle_scheduler::flexibility_limit</a></div><div class="ttdeci">int flexibility_limit</div><div class="ttdoc">Limits how much departure position for a given vehicle can change from current reported departure pos...</div><div class="ttdef"><b>Definition:</b> <a href="all__stop__vehicle__scheduler_8h_source.html#l00036">all_stop_vehicle_scheduler.h:36</a></div></div>
<div class="ttc" id="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_html_a15b4da36dba827263da4c844028c6db1"><div class="ttname"><a href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a15b4da36dba827263da4c844028c6db1">streets_vehicle_scheduler::all_stop_vehicle_scheduler::estimate_clearance_time</a></div><div class="ttdeci">uint64_t estimate_clearance_time(const streets_vehicles::vehicle &amp;veh, const OpenAPI::OAILanelet_info &amp;link_lane_info) const</div><div class="ttdoc">Estimate clearance time any vehicle given it's link lanelet information.</div><div class="ttdef"><b>Definition:</b> <a href="all__stop__vehicle__scheduler_8cpp_source.html#l00511">all_stop_vehicle_scheduler.cpp:511</a></div></div>
<div class="ttc" id="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_html_aa06721804b8a4075b98c2e8ad40c84da"><div class="ttname"><a href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#aa06721804b8a4075b98c2e8ad40c84da">streets_vehicle_scheduler::all_stop_vehicle_scheduler::get_latest_conflicting</a></div><div class="ttdeci">std::shared_ptr&lt; all_stop_vehicle_schedule &gt; get_latest_conflicting(const OpenAPI::OAILanelet_info &amp;link_lane, const std::vector&lt; all_stop_vehicle_schedule &gt; &amp;schedules) const</div><div class="ttdoc">Given a link lane and a vector of vehicle schedules, this method returns a pointer to a vehicle sched...</div><div class="ttdef"><b>Definition:</b> <a href="all__stop__vehicle__scheduler_8cpp_source.html#l00547">all_stop_vehicle_scheduler.cpp:547</a></div></div>
<div class="ttc" id="aclassstreets__vehicle__scheduler_1_1vehicle__scheduler_html_af2c80eb87e5a9cabaad660544003663c"><div class="ttname"><a href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#af2c80eb87e5a9cabaad660544003663c">streets_vehicle_scheduler::vehicle_scheduler::get_link_lanelet_info</a></div><div class="ttdeci">OpenAPI::OAILanelet_info get_link_lanelet_info(const streets_vehicles::vehicle &amp;veh) const</div><div class="ttdoc">Helper method to get link lane OAILanelet_info from intersection information given a vehicle.</div><div class="ttdef"><b>Definition:</b> <a href="vehicle__scheduler_8cpp_source.html#l00031">vehicle_scheduler.cpp:31</a></div></div>
<div class="ttc" id="anamespacestreets__vehicles_html_a41f5c896d8020c141aa96235cf1405aca58d6a88f13e2db7f5059c41047876f00"><div class="ttname"><a href="namespacestreets__vehicles.html#a41f5c896d8020c141aa96235cf1405aca58d6a88f13e2db7f5059c41047876f00">streets_vehicles::vehicle_state::DV</a></div><div class="ttdeci">@ DV</div></div>
<div class="ttc" id="anamespacestreets__vehicles_html_a41f5c896d8020c141aa96235cf1405acab08ef04fe84cf4f6645fef073717f36f"><div class="ttname"><a href="namespacestreets__vehicles.html#a41f5c896d8020c141aa96235cf1405acab08ef04fe84cf4f6645fef073717f36f">streets_vehicles::vehicle_state::RDV</a></div><div class="ttdeci">@ RDV</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="all__stop__intersection__schedule_8h_source.html#l00056">streets_vehicle_scheduler::all_stop_vehicle_schedule::access</a>, <a class="el" href="all__stop__intersection__schedule_8h_source.html#l00052">streets_vehicle_scheduler::all_stop_vehicle_schedule::dp</a>, <a class="el" href="all__stop__intersection__schedule_8h_source.html#l00045">streets_vehicle_scheduler::all_stop_vehicle_schedule::dt</a>, <a class="el" href="namespacestreets__vehicles.html#a41f5c896d8020c141aa96235cf1405aca58d6a88f13e2db7f5059c41047876f00">streets_vehicles::DV</a>, <a class="el" href="intersection__schedule_8h_source.html#l00032">streets_vehicle_scheduler::vehicle_schedule::entry_lane</a>, <a class="el" href="all__stop__intersection__schedule_8h_source.html#l00029">streets_vehicle_scheduler::all_stop_vehicle_schedule::est</a>, <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00511">estimate_clearance_time()</a>, <a class="el" href="all__stop__intersection__schedule_8h_source.html#l00039">streets_vehicle_scheduler::all_stop_vehicle_schedule::et</a>, <a class="el" href="all__stop__vehicle__scheduler_8h_source.html#l00036">flexibility_limit</a>, <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00547">get_latest_conflicting()</a>, <a class="el" href="vehicle__scheduler_8cpp_source.html#l00031">streets_vehicle_scheduler::vehicle_scheduler::get_link_lanelet_info()</a>, <a class="el" href="intersection__schedule_8h_source.html#l00036">streets_vehicle_scheduler::vehicle_schedule::link_id</a>, <a class="el" href="namespacestreets__vehicles.html#a41f5c896d8020c141aa96235cf1405acab08ef04fe84cf4f6645fef073717f36f">streets_vehicles::RDV</a>, <a class="el" href="all__stop__intersection__schedule_8h_source.html#l00034">streets_vehicle_scheduler::all_stop_vehicle_schedule::st</a>, <a class="el" href="all__stop__intersection__schedule_8h_source.html#l00060">streets_vehicle_scheduler::all_stop_vehicle_schedule::state</a>, and <a class="el" href="intersection__schedule_8h_source.html#l00028">streets_vehicle_scheduler::vehicle_schedule::v_id</a>.</p>

<p class="reference">Referenced by <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00171">schedule_rdvs()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a77c415e3ef29a00acc67c7aac87a270b_cgraph.png" border="0" usemap="#aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a77c415e3ef29a00acc67c7aac87a270b_cgraph" alt=""/></div>
<map name="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a77c415e3ef29a00acc67c7aac87a270b_cgraph" id="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a77c415e3ef29a00acc67c7aac87a270b_cgraph">
<area shape="rect" title="Creates and intersection schedule for a given RDV departure order. RDV departure order is based on rd..." alt="" coords="5,129,196,200"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a15b4da36dba827263da4c844028c6db1" title="Estimate clearance time any vehicle given it&#39;s link lanelet information." alt="" coords="244,57,428,113"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#aa06721804b8a4075b98c2e8ad40c84da" title="Given a link lane and a vector of vehicle schedules, this method returns a pointer to a vehicle sched..." alt="" coords="244,137,428,193"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#af2c80eb87e5a9cabaad660544003663c" title="Helper method to get link lane OAILanelet_info from intersection information given a vehicle." alt="" coords="249,217,423,273"/>
<area shape="rect" href="classOpenAPI_1_1OAILanelet__info.html#abc1c4d5d24a2dafb175874ecad09cfad" title=" " alt="" coords="492,5,639,47"/>
<area shape="rect" href="classOpenAPI_1_1OAILanelet__info.html#a9ed2860829d5aeba3062f26e78afcbdc" title=" " alt="" coords="492,71,639,112"/>
<area shape="rect" href="classOpenAPI_1_1OAILanelet__info.html#ae71cdbd0f92de4b223a654f03d2112c6" title=" " alt="" coords="476,144,655,185"/>
<area shape="rect" href="classOpenAPI_1_1OAILanelet__info.html#a489d1a475686159298697bccabd2bd52" title=" " alt="" coords="492,216,639,257"/>
<area shape="rect" href="ntcip__1202__ext_8h.html#a576de7b60eacee3f1a70393a005502cd" title="Returns std::string representation of ntcip_1202_ext message including phase_times array." alt="" coords="529,282,601,309"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a77c415e3ef29a00acc67c7aac87a270b_icgraph.png" border="0" usemap="#aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a77c415e3ef29a00acc67c7aac87a270b_icgraph" alt=""/></div>
<map name="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a77c415e3ef29a00acc67c7aac87a270b_icgraph" id="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a77c415e3ef29a00acc67c7aac87a270b_icgraph">
<area shape="rect" title="Creates and intersection schedule for a given RDV departure order. RDV departure order is based on rd..." alt="" coords="469,5,660,76"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a0729a968f0b8f0b0ec11453157df101c" title="Schedule all currently Ready to Depart Vehicles (RDVs). Consider all possible RDV departure orders...." alt="" coords="237,13,421,69"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a930961b3e285b2a2d08f4276ffa22658" title="Method to schedule vehicles. Given and empty intersection_schedule object and a map of vehicles and v..." alt="" coords="5,13,189,69"/>
</map>
</div>

</div>
</div>
<a id="a15b4da36dba827263da4c844028c6db1" name="a15b4da36dba827263da4c844028c6db1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15b4da36dba827263da4c844028c6db1">&#9670;&nbsp;</a></span>estimate_clearance_time()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t streets_vehicle_scheduler::all_stop_vehicle_scheduler::estimate_clearance_time </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structstreets__vehicles_1_1vehicle.html">streets_vehicles::vehicle</a> &amp;&#160;</td>
          <td class="paramname"><em>veh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classOpenAPI_1_1OAILanelet__info.html">OpenAPI::OAILanelet_info</a> &amp;&#160;</td>
          <td class="paramname"><em>link_lane_info</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Estimate clearance time any vehicle given it's link lanelet information. <br  />
 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">veh</td><td>vehicle to estimate clearance time for. </td></tr>
    <tr><td class="paramname">link_lane_info</td><td>link lanelet vehicle is attempting to clear. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>uint64_t clearance time in milliseconds. </dd></dl>

<p class="definition">Definition at line <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00511">511</a> of file <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html">all_stop_vehicle_scheduler.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  512</span>                                                                                                                       {</div>
<div class="line"><span class="lineno">  513</span>        <span class="comment">// Clearance time in seconds </span></div>
<div class="line"><span class="lineno">  514</span>        <span class="keywordtype">double</span> clearance_time = 0;</div>
<div class="line"><span class="lineno">  515</span>        <span class="comment">// If vehicle is Departing Vehicle consider its location in the link lanelet.</span></div>
<div class="line"><span class="lineno">  516</span>        <span class="keywordflow">if</span> ( veh.<a class="code hl_variable" href="structstreets__vehicles_1_1vehicle.html#a54872859b3a12ee290b98e0eedd2864f">_cur_state</a> == <a class="code hl_enumvalue" href="namespacestreets__vehicles.html#a41f5c896d8020c141aa96235cf1405aca58d6a88f13e2db7f5059c41047876f00">streets_vehicles::vehicle_state::DV</a> ) {</div>
<div class="line"><span class="lineno">  517</span>            <span class="comment">// Distance covered during constant max acceleration to speed limit</span></div>
<div class="line"><span class="lineno">  518</span>            <span class="keywordtype">double</span> constant_acceleration_delta_x = (pow(link_lane_info.<a class="code hl_function" href="classOpenAPI_1_1OAILanelet__info.html#a9ed2860829d5aeba3062f26e78afcbdc">getSpeedLimit</a>(), 2) - pow( veh.<a class="code hl_variable" href="structstreets__vehicles_1_1vehicle.html#a026375b9e6ffc8f8c8aee72465f352dc">_cur_speed</a>, 2))/(2* veh.<a class="code hl_variable" href="structstreets__vehicles_1_1vehicle.html#a1180998ca4eeb7d695d135a1e4a75424">_accel_max</a>);</div>
<div class="line"><span class="lineno">  519</span>            <span class="comment">// If vehicle accelerates to speed limit with max acceleration is it still in link lanelet</span></div>
<div class="line"><span class="lineno">  520</span>            <span class="keywordflow">if</span> ( veh.<a class="code hl_variable" href="structstreets__vehicles_1_1vehicle.html#a21a6378ca2401ac4bc9ca6f6364833fb">_cur_distance</a> &gt; constant_acceleration_delta_x ) {</div>
<div class="line"><span class="lineno">  521</span>                clearance_time = ( 2 * veh.<a class="code hl_variable" href="structstreets__vehicles_1_1vehicle.html#a1180998ca4eeb7d695d135a1e4a75424">_accel_max</a> * veh.<a class="code hl_variable" href="structstreets__vehicles_1_1vehicle.html#a21a6378ca2401ac4bc9ca6f6364833fb">_cur_distance</a> - link_lane_info.<a class="code hl_function" href="classOpenAPI_1_1OAILanelet__info.html#a9ed2860829d5aeba3062f26e78afcbdc">getSpeedLimit</a>()*veh.<a class="code hl_variable" href="structstreets__vehicles_1_1vehicle.html#a026375b9e6ffc8f8c8aee72465f352dc">_cur_speed</a> + pow(veh.<a class="code hl_variable" href="structstreets__vehicles_1_1vehicle.html#a026375b9e6ffc8f8c8aee72465f352dc">_cur_speed</a>, 2))/</div>
<div class="line"><span class="lineno">  522</span>                    (2*veh.<a class="code hl_variable" href="structstreets__vehicles_1_1vehicle.html#a1180998ca4eeb7d695d135a1e4a75424">_accel_max</a>*link_lane_info.<a class="code hl_function" href="classOpenAPI_1_1OAILanelet__info.html#a9ed2860829d5aeba3062f26e78afcbdc">getSpeedLimit</a>());</div>
<div class="line"><span class="lineno">  523</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  524</span>                clearance_time = (sqrt(pow(veh.<a class="code hl_variable" href="structstreets__vehicles_1_1vehicle.html#a026375b9e6ffc8f8c8aee72465f352dc">_cur_speed</a>, 2)+2*veh.<a class="code hl_variable" href="structstreets__vehicles_1_1vehicle.html#a1180998ca4eeb7d695d135a1e4a75424">_accel_max</a>*veh.<a class="code hl_variable" href="structstreets__vehicles_1_1vehicle.html#a21a6378ca2401ac4bc9ca6f6364833fb">_cur_distance</a>) -veh.<a class="code hl_variable" href="structstreets__vehicles_1_1vehicle.html#a026375b9e6ffc8f8c8aee72465f352dc">_cur_speed</a>)/</div>
<div class="line"><span class="lineno">  525</span>                        veh.<a class="code hl_variable" href="structstreets__vehicles_1_1vehicle.html#a1180998ca4eeb7d695d135a1e4a75424">_accel_max</a>;</div>
<div class="line"><span class="lineno">  526</span>            }</div>
<div class="line"><span class="lineno">  527</span> </div>
<div class="line"><span class="lineno">  528</span>        }</div>
<div class="line"><span class="lineno">  529</span>        <span class="comment">// Consider vehicle is stopped at stop bar</span></div>
<div class="line"><span class="lineno">  530</span>        <span class="keywordflow">else</span>  {</div>
<div class="line"><span class="lineno">  531</span>            <span class="comment">// Distance covered during constant max acceleration to speed limit assuming initial 0 speed.</span></div>
<div class="line"><span class="lineno">  532</span>            <span class="keywordtype">double</span> constant_acceleration_delta_x = pow(link_lane_info.<a class="code hl_function" href="classOpenAPI_1_1OAILanelet__info.html#a9ed2860829d5aeba3062f26e78afcbdc">getSpeedLimit</a>(), 2) / (2 * veh.<a class="code hl_variable" href="structstreets__vehicles_1_1vehicle.html#a1180998ca4eeb7d695d135a1e4a75424">_accel_max</a>);</div>
<div class="line"><span class="lineno">  533</span>            <span class="comment">// If vehicle accelerates to speed limit with max acceleration is it still in the link lanelet</span></div>
<div class="line"><span class="lineno">  534</span>            <span class="keywordflow">if</span> ( constant_acceleration_delta_x &lt; link_lane_info.<a class="code hl_function" href="classOpenAPI_1_1OAILanelet__info.html#abc1c4d5d24a2dafb175874ecad09cfad">getLength</a>()){</div>
<div class="line"><span class="lineno">  535</span>                <span class="comment">// If yes assume vehicle cruises at speed limit for the duration of the lanelet</span></div>
<div class="line"><span class="lineno">  536</span>                clearance_time = link_lane_info.<a class="code hl_function" href="classOpenAPI_1_1OAILanelet__info.html#abc1c4d5d24a2dafb175874ecad09cfad">getLength</a>() / link_lane_info.<a class="code hl_function" href="classOpenAPI_1_1OAILanelet__info.html#a9ed2860829d5aeba3062f26e78afcbdc">getSpeedLimit</a>() + </div>
<div class="line"><span class="lineno">  537</span>                            link_lane_info.<a class="code hl_function" href="classOpenAPI_1_1OAILanelet__info.html#a9ed2860829d5aeba3062f26e78afcbdc">getSpeedLimit</a>() / (2 *veh.<a class="code hl_variable" href="structstreets__vehicles_1_1vehicle.html#a1180998ca4eeb7d695d135a1e4a75424">_accel_max</a>);</div>
<div class="line"><span class="lineno">  538</span>            } <span class="keywordflow">else</span>{</div>
<div class="line"><span class="lineno">  539</span>                <span class="comment">// If not assume vehicle trajectory is constant acceleration from initial speed of 0</span></div>
<div class="line"><span class="lineno">  540</span>                clearance_time = sqrt(2 * link_lane_info.<a class="code hl_function" href="classOpenAPI_1_1OAILanelet__info.html#abc1c4d5d24a2dafb175874ecad09cfad">getLength</a>() / veh.<a class="code hl_variable" href="structstreets__vehicles_1_1vehicle.html#a1180998ca4eeb7d695d135a1e4a75424">_accel_max</a>) ;</div>
<div class="line"><span class="lineno">  541</span>            }</div>
<div class="line"><span class="lineno">  542</span>        }</div>
<div class="line"><span class="lineno">  543</span>        <span class="comment">// Convert time to milliseconds and round up.</span></div>
<div class="line"><span class="lineno">  544</span>        <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span>uint64_t<span class="keyword">&gt;</span>(ceil(1000.0* clearance_time));</div>
<div class="line"><span class="lineno">  545</span>    }</div>
<div class="ttc" id="aclassOpenAPI_1_1OAILanelet__info_html_a9ed2860829d5aeba3062f26e78afcbdc"><div class="ttname"><a href="classOpenAPI_1_1OAILanelet__info.html#a9ed2860829d5aeba3062f26e78afcbdc">OpenAPI::OAILanelet_info::getSpeedLimit</a></div><div class="ttdeci">double getSpeedLimit() const</div><div class="ttdef"><b>Definition:</b> <a href="intersection__client__api_2OAILanelet__info_8cpp_source.html#l00137">OAILanelet_info.cpp:137</a></div></div>
<div class="ttc" id="aclassOpenAPI_1_1OAILanelet__info_html_abc1c4d5d24a2dafb175874ecad09cfad"><div class="ttname"><a href="classOpenAPI_1_1OAILanelet__info.html#abc1c4d5d24a2dafb175874ecad09cfad">OpenAPI::OAILanelet_info::getLength</a></div><div class="ttdeci">double getLength() const</div><div class="ttdef"><b>Definition:</b> <a href="intersection__client__api_2OAILanelet__info_8cpp_source.html#l00169">OAILanelet_info.cpp:169</a></div></div>
<div class="ttc" id="astructstreets__vehicles_1_1vehicle_html_a54872859b3a12ee290b98e0eedd2864f"><div class="ttname"><a href="structstreets__vehicles_1_1vehicle.html#a54872859b3a12ee290b98e0eedd2864f">streets_vehicles::vehicle::_cur_state</a></div><div class="ttdeci">vehicle_state _cur_state</div><div class="ttdef"><b>Definition:</b> <a href="vehicle_8h_source.html#l00079">vehicle.h:79</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="vehicle_8h_source.html#l00045">streets_vehicles::vehicle::_accel_max</a>, <a class="el" href="vehicle_8h_source.html#l00073">streets_vehicles::vehicle::_cur_distance</a>, <a class="el" href="vehicle_8h_source.html#l00075">streets_vehicles::vehicle::_cur_speed</a>, <a class="el" href="vehicle_8h_source.html#l00079">streets_vehicles::vehicle::_cur_state</a>, <a class="el" href="namespacestreets__vehicles.html#a41f5c896d8020c141aa96235cf1405aca58d6a88f13e2db7f5059c41047876f00">streets_vehicles::DV</a>, <a class="el" href="intersection__client__api_2OAILanelet__info_8cpp_source.html#l00169">OpenAPI::OAILanelet_info::getLength()</a>, and <a class="el" href="intersection__client__api_2OAILanelet__info_8cpp_source.html#l00137">OpenAPI::OAILanelet_info::getSpeedLimit()</a>.</p>

<p class="reference">Referenced by <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00432">consider_departure_position_permutation()</a>, <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00117">schedule_dvs()</a>, and <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00230">schedule_evs()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a15b4da36dba827263da4c844028c6db1_cgraph.png" border="0" usemap="#aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a15b4da36dba827263da4c844028c6db1_cgraph" alt=""/></div>
<map name="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a15b4da36dba827263da4c844028c6db1_cgraph" id="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a15b4da36dba827263da4c844028c6db1_cgraph">
<area shape="rect" title="Estimate clearance time any vehicle given it&#39;s link lanelet information." alt="" coords="5,31,189,87"/>
<area shape="rect" href="classOpenAPI_1_1OAILanelet__info.html#abc1c4d5d24a2dafb175874ecad09cfad" title=" " alt="" coords="237,5,384,47"/>
<area shape="rect" href="classOpenAPI_1_1OAILanelet__info.html#a9ed2860829d5aeba3062f26e78afcbdc" title=" " alt="" coords="237,71,384,112"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a15b4da36dba827263da4c844028c6db1_icgraph.png" border="0" usemap="#aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a15b4da36dba827263da4c844028c6db1_icgraph" alt=""/></div>
<map name="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a15b4da36dba827263da4c844028c6db1_icgraph" id="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a15b4da36dba827263da4c844028c6db1_icgraph">
<area shape="rect" title="Estimate clearance time any vehicle given it&#39;s link lanelet information." alt="" coords="708,101,892,157"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a77c415e3ef29a00acc67c7aac87a270b" title="Creates and intersection schedule for a given RDV departure order. RDV departure order is based on rd..." alt="" coords="469,5,660,76"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a16230014f5d43ef2546a54496c08a9cd" title="Schedule all currently Departing Vehicle (DVs). Estimate intersection departure times (dt&#39;s) for each..." alt="" coords="473,101,657,157"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#acd0ec98c5efc93aadb38563e3b98d1bb" title="Schedule all Entering Vehicles (EVs). Method first organizes all EVs into lists based on their entry ..." alt="" coords="237,166,421,222"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a0729a968f0b8f0b0ec11453157df101c" title="Schedule all currently Ready to Depart Vehicles (RDVs). Consider all possible RDV departure orders...." alt="" coords="237,25,421,81"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a930961b3e285b2a2d08f4276ffa22658" title="Method to schedule vehicles. Given and empty intersection_schedule object and a map of vehicles and v..." alt="" coords="5,101,189,157"/>
</map>
</div>

</div>
</div>
<a id="acab5956159419bef2c5391d59e3fe9ee" name="acab5956159419bef2c5391d59e3fe9ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acab5956159419bef2c5391d59e3fe9ee">&#9670;&nbsp;</a></span>estimate_delta_x_prime()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double streets_vehicle_scheduler::all_stop_vehicle_scheduler::estimate_delta_x_prime </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structstreets__vehicles_1_1vehicle.html">streets_vehicles::vehicle</a> &amp;&#160;</td>
          <td class="paramname"><em>veh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classOpenAPI_1_1OAILanelet__info.html">OpenAPI::OAILanelet_info</a> &amp;&#160;</td>
          <td class="paramname"><em>entry_lane</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate minumum distance required to speed up to lane speed limit with maximum acceleration, cruise at lane speed limit for some time, then decelerate with maximum deceleration. This is used to determine the trajectory to provide the vehicle. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">veh</td><td>vehicle for which to calculate distance. </td></tr>
    <tr><td class="paramname">entry_lane</td><td>entry lane information. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double distance in meters </dd></dl>

<p class="definition">Definition at line <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00068">68</a> of file <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html">all_stop_vehicle_scheduler.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   69</span>                                                                                                               {</div>
<div class="line"><span class="lineno">   70</span>        <span class="keywordflow">if</span> ( veh.<a class="code hl_variable" href="structstreets__vehicles_1_1vehicle.html#a54872859b3a12ee290b98e0eedd2864f">_cur_state</a> == <a class="code hl_enumvalue" href="namespacestreets__vehicles.html#a41f5c896d8020c141aa96235cf1405aca834d41112f2943c357f660165b6eb6de">streets_vehicles::vehicle_state::EV</a> ) {</div>
<div class="line"><span class="lineno">   71</span>            <span class="comment">// Get Entry Lanelet</span></div>
<div class="line"><span class="lineno">   72</span>            <span class="keywordtype">double</span> delta_x_prime = (pow(entry_lane.<a class="code hl_function" href="classOpenAPI_1_1OAILanelet__info.html#a9ed2860829d5aeba3062f26e78afcbdc">getSpeedLimit</a>(),2)-pow(veh.<a class="code hl_variable" href="structstreets__vehicles_1_1vehicle.html#a026375b9e6ffc8f8c8aee72465f352dc">_cur_speed</a>,2))/(2*veh.<a class="code hl_variable" href="structstreets__vehicles_1_1vehicle.html#a1180998ca4eeb7d695d135a1e4a75424">_accel_max</a>) - </div>
<div class="line"><span class="lineno">   73</span>                pow(entry_lane.<a class="code hl_function" href="classOpenAPI_1_1OAILanelet__info.html#a9ed2860829d5aeba3062f26e78afcbdc">getSpeedLimit</a>(), 2)/(2*veh.<a class="code hl_variable" href="structstreets__vehicles_1_1vehicle.html#a253341595deb3473620116dcf63d9927">_decel_max</a>); </div>
<div class="line"><span class="lineno">   74</span>            <span class="keywordflow">return</span>  delta_x_prime;</div>
<div class="line"><span class="lineno">   75</span>        }</div>
<div class="line"><span class="lineno">   76</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">   77</span>            SPDLOG_WARN(<span class="stringliteral">&quot;Cannot estimate delta x prime for vehicle {0} because it&#39;s state {1} != EV !&quot;</span> );</div>
<div class="line"><span class="lineno">   78</span>        }</div>
<div class="line"><span class="lineno">   79</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">   80</span>    }</div>
<div class="ttc" id="anamespacestreets__vehicles_html_a41f5c896d8020c141aa96235cf1405aca834d41112f2943c357f660165b6eb6de"><div class="ttname"><a href="namespacestreets__vehicles.html#a41f5c896d8020c141aa96235cf1405aca834d41112f2943c357f660165b6eb6de">streets_vehicles::vehicle_state::EV</a></div><div class="ttdeci">@ EV</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="vehicle_8h_source.html#l00045">streets_vehicles::vehicle::_accel_max</a>, <a class="el" href="vehicle_8h_source.html#l00075">streets_vehicles::vehicle::_cur_speed</a>, <a class="el" href="vehicle_8h_source.html#l00079">streets_vehicles::vehicle::_cur_state</a>, <a class="el" href="vehicle_8h_source.html#l00047">streets_vehicles::vehicle::_decel_max</a>, <a class="el" href="namespacestreets__vehicles.html#a41f5c896d8020c141aa96235cf1405aca834d41112f2943c357f660165b6eb6de">streets_vehicles::EV</a>, and <a class="el" href="intersection__client__api_2OAILanelet__info_8cpp_source.html#l00137">OpenAPI::OAILanelet_info::getSpeedLimit()</a>.</p>

<p class="reference">Referenced by <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00390">estimate_earliest_time_to_stop_bar()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_acab5956159419bef2c5391d59e3fe9ee_cgraph.png" border="0" usemap="#aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_acab5956159419bef2c5391d59e3fe9ee_cgraph" alt=""/></div>
<map name="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_acab5956159419bef2c5391d59e3fe9ee_cgraph" id="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_acab5956159419bef2c5391d59e3fe9ee_cgraph">
<area shape="rect" title="Calculate minumum distance required to speed up to lane speed limit with maximum acceleration,..." alt="" coords="5,5,189,61"/>
<area shape="rect" href="classOpenAPI_1_1OAILanelet__info.html#a9ed2860829d5aeba3062f26e78afcbdc" title=" " alt="" coords="237,13,384,54"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_acab5956159419bef2c5391d59e3fe9ee_icgraph.png" border="0" usemap="#aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_acab5956159419bef2c5391d59e3fe9ee_icgraph" alt=""/></div>
<map name="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_acab5956159419bef2c5391d59e3fe9ee_icgraph" id="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_acab5956159419bef2c5391d59e3fe9ee_icgraph">
<area shape="rect" title="Calculate minumum distance required to speed up to lane speed limit with maximum acceleration,..." alt="" coords="701,13,885,69"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#ad5f0462b2d82168b7b71dcfd15eaa7f2" title="Method to use vehicle kinematic information to estimate earliest possible time stopping time for a ve..." alt="" coords="469,5,653,76"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#acd0ec98c5efc93aadb38563e3b98d1bb" title="Schedule all Entering Vehicles (EVs). Method first organizes all EVs into lists based on their entry ..." alt="" coords="237,13,421,69"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a930961b3e285b2a2d08f4276ffa22658" title="Method to schedule vehicles. Given and empty intersection_schedule object and a map of vehicles and v..." alt="" coords="5,13,189,69"/>
</map>
</div>

</div>
</div>
<a id="ad5f0462b2d82168b7b71dcfd15eaa7f2" name="ad5f0462b2d82168b7b71dcfd15eaa7f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5f0462b2d82168b7b71dcfd15eaa7f2">&#9670;&nbsp;</a></span>estimate_earliest_time_to_stop_bar()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t streets_vehicle_scheduler::all_stop_vehicle_scheduler::estimate_earliest_time_to_stop_bar </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structstreets__vehicles_1_1vehicle.html">streets_vehicles::vehicle</a> &amp;&#160;</td>
          <td class="paramname"><em>veh</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Method to use vehicle kinematic information to estimate earliest possible time stopping time for a vehicle. Does not consider any other vehicles. Limiting factors are the vehicles current kinematic information, lane speed limits and vehicle acceleration and deceleration limits. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">veh</td><td>vehicle for which to calculate trajectory </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>uint64_t time in milliseconds. </dd></dl>

<p class="definition">Definition at line <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00390">390</a> of file <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html">all_stop_vehicle_scheduler.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  390</span>                                                                                                                   {</div>
<div class="line"><span class="lineno">  391</span>        <span class="comment">// Distance to stop bar </span></div>
<div class="line"><span class="lineno">  392</span>        <span class="keywordtype">double</span> delta_x = veh.<a class="code hl_variable" href="structstreets__vehicles_1_1vehicle.html#a21a6378ca2401ac4bc9ca6f6364833fb">_cur_distance</a>;</div>
<div class="line"><span class="lineno">  393</span>        <span class="comment">// Get Entry Lane</span></div>
<div class="line"><span class="lineno">  394</span>        <a class="code hl_class" href="classOpenAPI_1_1OAILanelet__info.html">OpenAPI::OAILanelet_info</a> lane_info =  <a class="code hl_function" href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#af8916add714bef70d8f48efc0ccfca7b">get_entry_lanelet_info</a>( veh );</div>
<div class="line"><span class="lineno">  395</span>        <span class="comment">// Distance necessary to get to max speed and decelerate with decel_max</span></div>
<div class="line"><span class="lineno">  396</span>        <span class="keywordtype">double</span> delta_x_prime =  <a class="code hl_function" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#acab5956159419bef2c5391d59e3fe9ee">estimate_delta_x_prime</a>( veh, lane_info );</div>
<div class="line"><span class="lineno">  397</span>        SPDLOG_TRACE(<span class="stringliteral">&quot;Delta X Prime = {0}.&quot;</span>, delta_x_prime);</div>
<div class="line"><span class="lineno">  398</span> </div>
<div class="line"><span class="lineno">  399</span>        <span class="comment">// Calculate v_hat and planned cruising time interval</span></div>
<div class="line"><span class="lineno">  400</span>        <span class="keywordtype">double</span> v_hat;</div>
<div class="line"><span class="lineno">  401</span>        <span class="keywordtype">double</span> t_cruising;</div>
<div class="line"><span class="lineno">  402</span>        <span class="keywordflow">if</span> ( delta_x &gt;= delta_x_prime ) {</div>
<div class="line"><span class="lineno">  403</span>            v_hat = lane_info.<a class="code hl_function" href="classOpenAPI_1_1OAILanelet__info.html#a9ed2860829d5aeba3062f26e78afcbdc">getSpeedLimit</a>();</div>
<div class="line"><span class="lineno">  404</span>            SPDLOG_TRACE(<span class="stringliteral">&quot;V hat = {0}.&quot;</span>, v_hat);</div>
<div class="line"><span class="lineno">  405</span> </div>
<div class="line"><span class="lineno">  406</span>            t_cruising = <a class="code hl_function" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#afedbbc9205b39ceb8707d950b5c26556">calculate_cruising_time</a>(veh, v_hat, delta_x_prime); </div>
<div class="line"><span class="lineno">  407</span>            SPDLOG_TRACE(<span class="stringliteral">&quot;T cruising = {0}.&quot;</span>,t_cruising);</div>
<div class="line"><span class="lineno">  408</span> </div>
<div class="line"><span class="lineno">  409</span>        }</div>
<div class="line"><span class="lineno">  410</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  411</span>            v_hat =  <a class="code hl_function" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#ae5a42af1af20b06df9ad6af5d3170406">calculate_v_hat</a>(veh);</div>
<div class="line"><span class="lineno">  412</span>            SPDLOG_TRACE(<span class="stringliteral">&quot;V hat = {0}.&quot;</span>, v_hat);</div>
<div class="line"><span class="lineno">  413</span> </div>
<div class="line"><span class="lineno">  414</span>            t_cruising = 0.0;</div>
<div class="line"><span class="lineno">  415</span>            SPDLOG_TRACE(<span class="stringliteral">&quot;T cruising = {0}.&quot;</span>,t_cruising);</div>
<div class="line"><span class="lineno">  416</span> </div>
<div class="line"><span class="lineno">  417</span>        }</div>
<div class="line"><span class="lineno">  418</span>        </div>
<div class="line"><span class="lineno">  419</span>        <span class="comment">// calculate planned acceleration time interval</span></div>
<div class="line"><span class="lineno">  420</span>        <span class="keywordtype">double</span> t_accel = <a class="code hl_function" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a3ba56cc964002b21475a475995938b89">calculate_acceleration_time</a>(veh, v_hat);</div>
<div class="line"><span class="lineno">  421</span>        SPDLOG_TRACE(<span class="stringliteral">&quot;T accel = {0}.&quot;</span>,t_accel);</div>
<div class="line"><span class="lineno">  422</span> </div>
<div class="line"><span class="lineno">  423</span>        <span class="comment">// calculate planned deceleration time interval</span></div>
<div class="line"><span class="lineno">  424</span>        <span class="keywordtype">double</span> t_decel = <a class="code hl_function" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a63107a1e136be3a00f3a1445531904aa">calculate_deceleration_time</a>(veh, v_hat);</div>
<div class="line"><span class="lineno">  425</span>        SPDLOG_TRACE(<span class="stringliteral">&quot;T decel = {0}.&quot;</span>,t_decel);</div>
<div class="line"><span class="lineno">  426</span> </div>
<div class="line"><span class="lineno">  427</span>        <span class="comment">// calculate time to stop bar</span></div>
<div class="line"><span class="lineno">  428</span>        <span class="keywordtype">double</span> time_to_stop_bar = t_accel + t_cruising + t_decel;</div>
<div class="line"><span class="lineno">  429</span>        <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span>uint64_t<span class="keyword">&gt;</span>(ceil(time_to_stop_bar * 1000.0)) + veh.<a class="code hl_variable" href="structstreets__vehicles_1_1vehicle.html#a278b51810d25efcfcfb91bb13e43e6f3">_cur_time</a>;</div>
<div class="line"><span class="lineno">  430</span>    }</div>
<div class="ttc" id="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_html_a3ba56cc964002b21475a475995938b89"><div class="ttname"><a href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a3ba56cc964002b21475a475995938b89">streets_vehicle_scheduler::all_stop_vehicle_scheduler::calculate_acceleration_time</a></div><div class="ttdeci">double calculate_acceleration_time(const streets_vehicles::vehicle &amp;veh, const double v_hat) const</div><div class="ttdoc">Method to calculate time interval necessary for accelerating to speed v_hat for a given vehicle....</div><div class="ttdef"><b>Definition:</b> <a href="all__stop__vehicle__scheduler_8cpp_source.html#l00093">all_stop_vehicle_scheduler.cpp:93</a></div></div>
<div class="ttc" id="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_html_a63107a1e136be3a00f3a1445531904aa"><div class="ttname"><a href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a63107a1e136be3a00f3a1445531904aa">streets_vehicle_scheduler::all_stop_vehicle_scheduler::calculate_deceleration_time</a></div><div class="ttdeci">double calculate_deceleration_time(const streets_vehicles::vehicle &amp;veh, const double v_hat) const</div><div class="ttdoc">Method to calculate time interval necessary for deceleration from v_hat to 0 to stop at stop bar....</div><div class="ttdef"><b>Definition:</b> <a href="all__stop__vehicle__scheduler_8cpp_source.html#l00113">all_stop_vehicle_scheduler.cpp:113</a></div></div>
<div class="ttc" id="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_html_acab5956159419bef2c5391d59e3fe9ee"><div class="ttname"><a href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#acab5956159419bef2c5391d59e3fe9ee">streets_vehicle_scheduler::all_stop_vehicle_scheduler::estimate_delta_x_prime</a></div><div class="ttdeci">double estimate_delta_x_prime(const streets_vehicles::vehicle &amp;veh, const OpenAPI::OAILanelet_info &amp;entry_lane) const</div><div class="ttdoc">Calculate minumum distance required to speed up to lane speed limit with maximum acceleration,...</div><div class="ttdef"><b>Definition:</b> <a href="all__stop__vehicle__scheduler_8cpp_source.html#l00068">all_stop_vehicle_scheduler.cpp:68</a></div></div>
<div class="ttc" id="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_html_ae5a42af1af20b06df9ad6af5d3170406"><div class="ttname"><a href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#ae5a42af1af20b06df9ad6af5d3170406">streets_vehicle_scheduler::all_stop_vehicle_scheduler::calculate_v_hat</a></div><div class="ttdeci">double calculate_v_hat(const streets_vehicles::vehicle &amp;veh) const</div><div class="ttdoc">Method to calculate v_hat. This is the maximum speed reached between maximum speed reached between ac...</div><div class="ttdef"><b>Definition:</b> <a href="all__stop__vehicle__scheduler_8cpp_source.html#l00082">all_stop_vehicle_scheduler.cpp:82</a></div></div>
<div class="ttc" id="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_html_afedbbc9205b39ceb8707d950b5c26556"><div class="ttname"><a href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#afedbbc9205b39ceb8707d950b5c26556">streets_vehicle_scheduler::all_stop_vehicle_scheduler::calculate_cruising_time</a></div><div class="ttdeci">double calculate_cruising_time(const streets_vehicles::vehicle &amp;veh, const double v_hat, const double delta_x_prime) const</div><div class="ttdoc">Method to calculate time interval necessary for cruising at a constant speed v_hat (speed limit) grea...</div><div class="ttdef"><b>Definition:</b> <a href="all__stop__vehicle__scheduler_8cpp_source.html#l00103">all_stop_vehicle_scheduler.cpp:103</a></div></div>
<div class="ttc" id="aclassstreets__vehicle__scheduler_1_1vehicle__scheduler_html_af8916add714bef70d8f48efc0ccfca7b"><div class="ttname"><a href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#af8916add714bef70d8f48efc0ccfca7b">streets_vehicle_scheduler::vehicle_scheduler::get_entry_lanelet_info</a></div><div class="ttdeci">OpenAPI::OAILanelet_info get_entry_lanelet_info(const streets_vehicles::vehicle &amp;veh) const</div><div class="ttdoc">Helper method to get entry lane OAILanelet_info from intersection information given a vehicle.</div><div class="ttdef"><b>Definition:</b> <a href="vehicle__scheduler_8cpp_source.html#l00013">vehicle_scheduler.cpp:13</a></div></div>
<div class="ttc" id="astructstreets__vehicles_1_1vehicle_html_a278b51810d25efcfcfb91bb13e43e6f3"><div class="ttname"><a href="structstreets__vehicles_1_1vehicle.html#a278b51810d25efcfcfb91bb13e43e6f3">streets_vehicles::vehicle::_cur_time</a></div><div class="ttdeci">u_int64_t _cur_time</div><div class="ttdef"><b>Definition:</b> <a href="vehicle_8h_source.html#l00071">vehicle.h:71</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="vehicle_8h_source.html#l00073">streets_vehicles::vehicle::_cur_distance</a>, <a class="el" href="vehicle_8h_source.html#l00071">streets_vehicles::vehicle::_cur_time</a>, <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00093">calculate_acceleration_time()</a>, <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00103">calculate_cruising_time()</a>, <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00113">calculate_deceleration_time()</a>, <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00082">calculate_v_hat()</a>, <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00068">estimate_delta_x_prime()</a>, <a class="el" href="vehicle__scheduler_8cpp_source.html#l00013">streets_vehicle_scheduler::vehicle_scheduler::get_entry_lanelet_info()</a>, and <a class="el" href="intersection__client__api_2OAILanelet__info_8cpp_source.html#l00137">OpenAPI::OAILanelet_info::getSpeedLimit()</a>.</p>

<p class="reference">Referenced by <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00230">schedule_evs()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_ad5f0462b2d82168b7b71dcfd15eaa7f2_cgraph.png" border="0" usemap="#aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_ad5f0462b2d82168b7b71dcfd15eaa7f2_cgraph" alt=""/></div>
<map name="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_ad5f0462b2d82168b7b71dcfd15eaa7f2_cgraph" id="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_ad5f0462b2d82168b7b71dcfd15eaa7f2_cgraph">
<area shape="rect" title="Method to use vehicle kinematic information to estimate earliest possible time stopping time for a ve..." alt="" coords="5,238,189,309"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a3ba56cc964002b21475a475995938b89" title="Method to calculate time interval necessary for accelerating to speed v_hat for a given vehicle...." alt="" coords="237,5,427,61"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#afedbbc9205b39ceb8707d950b5c26556" title="Method to calculate time interval necessary for cruising at a constant speed v_hat (speed limit) grea..." alt="" coords="240,85,424,141"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a63107a1e136be3a00f3a1445531904aa" title="Method to calculate time interval necessary for deceleration from v_hat to 0 to stop at stop bar...." alt="" coords="237,165,427,221"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#ae5a42af1af20b06df9ad6af5d3170406" title="Method to calculate v_hat. This is the maximum speed reached between maximum speed reached between ac..." alt="" coords="240,245,424,301"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#acab5956159419bef2c5391d59e3fe9ee" title="Calculate minumum distance required to speed up to lane speed limit with maximum acceleration,..." alt="" coords="240,325,424,381"/>
<area shape="rect" href="classOpenAPI_1_1OAILanelet__info.html#a9ed2860829d5aeba3062f26e78afcbdc" title=" " alt="" coords="475,351,621,393"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#af8916add714bef70d8f48efc0ccfca7b" title="Helper method to get entry lane OAILanelet_info from intersection information given a vehicle." alt="" coords="245,456,419,512"/>
<area shape="rect" href="classOpenAPI_1_1OAILanelet__info.html#a489d1a475686159298697bccabd2bd52" title=" " alt="" coords="475,434,621,475"/>
<area shape="rect" href="ntcip__1202__ext_8h.html#a576de7b60eacee3f1a70393a005502cd" title="Returns std::string representation of ntcip_1202_ext message including phase_times array." alt="" coords="512,500,584,527"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_ad5f0462b2d82168b7b71dcfd15eaa7f2_icgraph.png" border="0" usemap="#aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_ad5f0462b2d82168b7b71dcfd15eaa7f2_icgraph" alt=""/></div>
<map name="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_ad5f0462b2d82168b7b71dcfd15eaa7f2_icgraph" id="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_ad5f0462b2d82168b7b71dcfd15eaa7f2_icgraph">
<area shape="rect" title="Method to use vehicle kinematic information to estimate earliest possible time stopping time for a ve..." alt="" coords="469,5,653,76"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#acd0ec98c5efc93aadb38563e3b98d1bb" title="Schedule all Entering Vehicles (EVs). Method first organizes all EVs into lists based on their entry ..." alt="" coords="237,13,421,69"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a930961b3e285b2a2d08f4276ffa22658" title="Method to schedule vehicles. Given and empty intersection_schedule object and a map of vehicles and v..." alt="" coords="5,13,189,69"/>
</map>
</div>

</div>
</div>
<a id="a9b5ee4ffdbd82cbf0c48f7981e7dff9c" name="a9b5ee4ffdbd82cbf0c48f7981e7dff9c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b5ee4ffdbd82cbf0c48f7981e7dff9c">&#9670;&nbsp;</a></span>estimate_entering_time_for_ev()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t streets_vehicle_scheduler::all_stop_vehicle_scheduler::estimate_entering_time_for_ev </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structstreets__vehicle__scheduler_1_1all__stop__vehicle__schedule.html">all_stop_vehicle_schedule</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>vehicle_schedules</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structstreets__vehicles_1_1vehicle.html">streets_vehicles::vehicle</a> &amp;&#160;</td>
          <td class="paramname"><em>ev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint64_t&#160;</td>
          <td class="paramname"><em>st</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Estimates an entering time (ET) for a given Entering Vehicle (EV). This method first searches among the existing scheduled vehicles and find the departure time (DT) of the last scheduled vehicle with conflicting direction. The ET of the vehicle is calculated based on this DT (if exist) and the estimated stopping time (ST) oft the vehicle. <br  />
 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">schedule</td><td><a class="el" href="structstreets__vehicle__scheduler_1_1all__stop__intersection__schedule.html" title="Struct to store vehicle schedules for all vehicle in an intersection. Includes a timestamp in millise...">all_stop_intersection_schedule</a>. </td></tr>
    <tr><td class="paramname">ev</td><td>vehicle for which to estimate ET. </td></tr>
    <tr><td class="paramname">st</td><td>estimated stopping time. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00368">368</a> of file <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html">all_stop_vehicle_scheduler.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  368</span>                                                                                                                                                                                                 {</div>
<div class="line"><span class="lineno">  369</span>        <span class="comment">// Get link lanelet information for ev</span></div>
<div class="line"><span class="lineno">  370</span>        <a class="code hl_class" href="classOpenAPI_1_1OAILanelet__info.html">OpenAPI::OAILanelet_info</a> link_lane = <a class="code hl_function" href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#af2c80eb87e5a9cabaad660544003663c">get_link_lanelet_info</a>( ev );</div>
<div class="line"><span class="lineno">  371</span>        <span class="comment">// Get schedule of conflicting vehicle with largest dt from already scheduled vehicles</span></div>
<div class="line"><span class="lineno">  372</span>        <span class="keywordflow">if</span> ( !vehicle_schedules.empty() ) {</div>
<div class="line"><span class="lineno">  373</span>            std::shared_ptr&lt;all_stop_vehicle_schedule&gt; conflict_with_largest_dt = <a class="code hl_function" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#aa06721804b8a4075b98c2e8ad40c84da">get_latest_conflicting</a>(link_lane, vehicle_schedules);</div>
<div class="line"><span class="lineno">  374</span>            </div>
<div class="line"><span class="lineno">  375</span>            <span class="keywordflow">if</span> ( conflict_with_largest_dt != <span class="keyword">nullptr</span>) {</div>
<div class="line"><span class="lineno">  376</span>                SPDLOG_TRACE(<span class="stringliteral">&quot;Vehicle with largest conflict to {0} is {1}.&quot;</span>, ev.<a class="code hl_variable" href="structstreets__vehicles_1_1vehicle.html#a470605f661a8f625329ebbb10888e2b8">_id</a>, conflict_with_largest_dt-&gt;v_id);</div>
<div class="line"><span class="lineno">  377</span>                <span class="comment">// Entering time is the maximum between the conflicting vehicles departure time and the current vehicles stopping time</span></div>
<div class="line"><span class="lineno">  378</span>                <span class="keywordflow">return</span> std::max(conflict_with_largest_dt-&gt;dt, st);</div>
<div class="line"><span class="lineno">  379</span>            }<span class="keywordflow">else</span>{</div>
<div class="line"><span class="lineno">  380</span>                <span class="comment">// If there is no conflicting scheduled vehicle, st == et</span></div>
<div class="line"><span class="lineno">  381</span>                <span class="keywordflow">return</span> st;</div>
<div class="line"><span class="lineno">  382</span>            }</div>
<div class="line"><span class="lineno">  383</span>        }</div>
<div class="line"><span class="lineno">  384</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  385</span>            <span class="comment">// If schedule is empty there can be no conflict</span></div>
<div class="line"><span class="lineno">  386</span>            <span class="keywordflow">return</span> st;</div>
<div class="line"><span class="lineno">  387</span>        }</div>
<div class="line"><span class="lineno">  388</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="vehicle_8h_source.html#l00037">streets_vehicles::vehicle::_id</a>, <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00547">get_latest_conflicting()</a>, and <a class="el" href="vehicle__scheduler_8cpp_source.html#l00031">streets_vehicle_scheduler::vehicle_scheduler::get_link_lanelet_info()</a>.</p>

<p class="reference">Referenced by <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00230">schedule_evs()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a9b5ee4ffdbd82cbf0c48f7981e7dff9c_cgraph.png" border="0" usemap="#aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a9b5ee4ffdbd82cbf0c48f7981e7dff9c_cgraph" alt=""/></div>
<map name="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a9b5ee4ffdbd82cbf0c48f7981e7dff9c_cgraph" id="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a9b5ee4ffdbd82cbf0c48f7981e7dff9c_cgraph">
<area shape="rect" title="Estimates an entering time (ET) for a given Entering Vehicle (EV). This method first searches among t..." alt="" coords="5,45,212,101"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#aa06721804b8a4075b98c2e8ad40c84da" title="Given a link lane and a vector of vehicle schedules, this method returns a pointer to a vehicle sched..." alt="" coords="260,5,444,61"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#af2c80eb87e5a9cabaad660544003663c" title="Helper method to get link lane OAILanelet_info from intersection information given a vehicle." alt="" coords="265,85,439,141"/>
<area shape="rect" href="classOpenAPI_1_1OAILanelet__info.html#ae71cdbd0f92de4b223a654f03d2112c6" title=" " alt="" coords="492,13,671,54"/>
<area shape="rect" href="classOpenAPI_1_1OAILanelet__info.html#a489d1a475686159298697bccabd2bd52" title=" " alt="" coords="508,85,655,126"/>
<area shape="rect" href="ntcip__1202__ext_8h.html#a576de7b60eacee3f1a70393a005502cd" title="Returns std::string representation of ntcip_1202_ext message including phase_times array." alt="" coords="545,151,617,177"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a9b5ee4ffdbd82cbf0c48f7981e7dff9c_icgraph.png" border="0" usemap="#aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a9b5ee4ffdbd82cbf0c48f7981e7dff9c_icgraph" alt=""/></div>
<map name="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a9b5ee4ffdbd82cbf0c48f7981e7dff9c_icgraph" id="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a9b5ee4ffdbd82cbf0c48f7981e7dff9c_icgraph">
<area shape="rect" title="Estimates an entering time (ET) for a given Entering Vehicle (EV). This method first searches among t..." alt="" coords="469,5,676,61"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#acd0ec98c5efc93aadb38563e3b98d1bb" title="Schedule all Entering Vehicles (EVs). Method first organizes all EVs into lists based on their entry ..." alt="" coords="237,5,421,61"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a930961b3e285b2a2d08f4276ffa22658" title="Method to schedule vehicles. Given and empty intersection_schedule object and a map of vehicles and v..." alt="" coords="5,5,189,61"/>
</map>
</div>

</div>
</div>
<a id="aa06721804b8a4075b98c2e8ad40c84da" name="aa06721804b8a4075b98c2e8ad40c84da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa06721804b8a4075b98c2e8ad40c84da">&#9670;&nbsp;</a></span>get_latest_conflicting()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_ptr&lt; <a class="el" href="structstreets__vehicle__scheduler_1_1all__stop__vehicle__schedule.html">all_stop_vehicle_schedule</a> &gt; streets_vehicle_scheduler::all_stop_vehicle_scheduler::get_latest_conflicting </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classOpenAPI_1_1OAILanelet__info.html">OpenAPI::OAILanelet_info</a> &amp;&#160;</td>
          <td class="paramname"><em>link_lane</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structstreets__vehicle__scheduler_1_1all__stop__vehicle__schedule.html">all_stop_vehicle_schedule</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>schedules</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Given a link lane and a vector of vehicle schedules, this method returns a pointer to a vehicle schedule with a conflicting direction and the latest departure time. If no vehicle schedules have conflicting directions it returns nullptr. This method is meant to return the limiting conflicting vehicle for scheduling new RDVs in a link lane. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">link_lane</td><td>the linking lane to be traveled </td></tr>
    <tr><td class="paramname">schedules</td><td>Already scheduled vehicles </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>std::shared_ptr&lt;vehicle_schedule&gt; pointer to vehicle schedule with conflicting direction and latest departure time. </dd></dl>

<p class="definition">Definition at line <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00547">547</a> of file <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html">all_stop_vehicle_scheduler.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  548</span>                                                                                                                                             {       </div>
<div class="line"><span class="lineno">  549</span>        std::shared_ptr&lt;all_stop_vehicle_schedule&gt; conflict = <span class="keyword">nullptr</span>; </div>
<div class="line"><span class="lineno">  550</span> </div>
<div class="line"><span class="lineno">  551</span>        <span class="comment">// Loop through all scheduled vehicles and return conflict with largest dt</span></div>
<div class="line"><span class="lineno">  552</span>        <span class="keywordflow">for</span> ( <span class="keyword">const</span> <span class="keyword">auto</span> &amp;sched : schedules ) {</div>
<div class="line"><span class="lineno">  553</span>            <span class="comment">// check if that have conflict with link_lane</span></div>
<div class="line"><span class="lineno">  554</span>            <span class="keywordflow">if</span> ( link_lane.<a class="code hl_function" href="classOpenAPI_1_1OAILanelet__info.html#ae71cdbd0f92de4b223a654f03d2112c6">getConflictLaneletIds</a>().contains(sched.link_id)) {</div>
<div class="line"><span class="lineno">  555</span>                <span class="comment">// If no conflicting schedule has been set yet set conflict to first conflicting </span></div>
<div class="line"><span class="lineno">  556</span>                <span class="keywordflow">if</span> ( conflict == <span class="keyword">nullptr</span> ) {</div>
<div class="line"><span class="lineno">  557</span>                    conflict = std::make_shared&lt;all_stop_vehicle_schedule&gt;( sched);</div>
<div class="line"><span class="lineno">  558</span>                }</div>
<div class="line"><span class="lineno">  559</span>                <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( conflict-&gt;dt &lt; sched.dt ) {</div>
<div class="line"><span class="lineno">  560</span>                    conflict = std::make_shared&lt;all_stop_vehicle_schedule&gt;( sched);</div>
<div class="line"><span class="lineno">  561</span>                }</div>
<div class="line"><span class="lineno">  562</span>            }</div>
<div class="line"><span class="lineno">  563</span>            </div>
<div class="line"><span class="lineno">  564</span>        }</div>
<div class="line"><span class="lineno">  565</span>        <span class="keywordflow">return</span> conflict;                                              </div>
<div class="line"><span class="lineno">  566</span>    }</div>
<div class="ttc" id="aclassOpenAPI_1_1OAILanelet__info_html_ae71cdbd0f92de4b223a654f03d2112c6"><div class="ttname"><a href="classOpenAPI_1_1OAILanelet__info.html#ae71cdbd0f92de4b223a654f03d2112c6">OpenAPI::OAILanelet_info::getConflictLaneletIds</a></div><div class="ttdeci">QList&lt; qint32 &gt; getConflictLaneletIds() const</div><div class="ttdef"><b>Definition:</b> <a href="intersection__client__api_2OAILanelet__info_8cpp_source.html#l00153">OAILanelet_info.cpp:153</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="intersection__client__api_2OAILanelet__info_8cpp_source.html#l00153">OpenAPI::OAILanelet_info::getConflictLaneletIds()</a>.</p>

<p class="reference">Referenced by <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00432">consider_departure_position_permutation()</a>, and <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00368">estimate_entering_time_for_ev()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_aa06721804b8a4075b98c2e8ad40c84da_cgraph.png" border="0" usemap="#aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_aa06721804b8a4075b98c2e8ad40c84da_cgraph" alt=""/></div>
<map name="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_aa06721804b8a4075b98c2e8ad40c84da_cgraph" id="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_aa06721804b8a4075b98c2e8ad40c84da_cgraph">
<area shape="rect" title="Given a link lane and a vector of vehicle schedules, this method returns a pointer to a vehicle sched..." alt="" coords="5,5,189,61"/>
<area shape="rect" href="classOpenAPI_1_1OAILanelet__info.html#ae71cdbd0f92de4b223a654f03d2112c6" title=" " alt="" coords="237,13,416,54"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_aa06721804b8a4075b98c2e8ad40c84da_icgraph.png" border="0" usemap="#aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_aa06721804b8a4075b98c2e8ad40c84da_icgraph" alt=""/></div>
<map name="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_aa06721804b8a4075b98c2e8ad40c84da_icgraph" id="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_aa06721804b8a4075b98c2e8ad40c84da_icgraph">
<area shape="rect" title="Given a link lane and a vector of vehicle schedules, this method returns a pointer to a vehicle sched..." alt="" coords="724,57,908,113"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a77c415e3ef29a00acc67c7aac87a270b" title="Creates and intersection schedule for a given RDV departure order. RDV departure order is based on rd..." alt="" coords="477,5,668,76"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a9b5ee4ffdbd82cbf0c48f7981e7dff9c" title="Estimates an entering time (ET) for a given Entering Vehicle (EV). This method first searches among t..." alt="" coords="469,101,676,157"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a0729a968f0b8f0b0ec11453157df101c" title="Schedule all currently Ready to Depart Vehicles (RDVs). Consider all possible RDV departure orders...." alt="" coords="237,15,421,71"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a930961b3e285b2a2d08f4276ffa22658" title="Method to schedule vehicles. Given and empty intersection_schedule object and a map of vehicles and v..." alt="" coords="5,57,189,113"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#acd0ec98c5efc93aadb38563e3b98d1bb" title="Schedule all Entering Vehicles (EVs). Method first organizes all EVs into lists based on their entry ..." alt="" coords="237,97,421,153"/>
</map>
</div>

</div>
</div>
<a id="a0cf6941cc406bbd51889c129231e9443" name="a0cf6941cc406bbd51889c129231e9443"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0cf6941cc406bbd51889c129231e9443">&#9670;&nbsp;</a></span>get_vehicle_with_id()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structstreets__vehicles_1_1vehicle.html">streets_vehicles::vehicle</a> streets_vehicle_scheduler::all_stop_vehicle_scheduler::get_vehicle_with_id </td>
          <td>(</td>
          <td class="paramtype">const std::list&lt; <a class="el" href="structstreets__vehicles_1_1vehicle.html">streets_vehicles::vehicle</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>veh_list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>veh_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Given a list of vehicles and a vehicle id, this method returns the vehicle with a matching vehicle id if there is one. This method will throw a <a class="el" href="classstreets__vehicle__scheduler_1_1scheduling__exception.html" title="Runtime error related to processing status intent vehicle updates.">scheduling_exception</a> if no vehicle with the given id is found. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">veh_list</td><td>list to search. </td></tr>
    <tr><td class="paramname">veh_id</td><td>vehicle id to search for. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structstreets__vehicles_1_1vehicle.html" title="Data struct for vehicle status and intent information.">streets_vehicles::vehicle</a> vehicle with matching vehicle id </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classstreets__vehicle__scheduler_1_1scheduling__exception.html" title="Runtime error related to processing status intent vehicle updates.">scheduling_exception</a></td><td>if vehicle is not in list. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00595">595</a> of file <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html">all_stop_vehicle_scheduler.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  595</span>                                                                                                                                                             {</div>
<div class="line"><span class="lineno">  596</span>        <a class="code hl_struct" href="structstreets__vehicles_1_1vehicle.html">streets_vehicles::vehicle</a> rtn;</div>
<div class="line"><span class="lineno">  597</span>        <span class="keywordtype">bool</span> found_veh = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  598</span>        <span class="keywordflow">if</span> ( veh_list.empty() ) {</div>
<div class="line"><span class="lineno">  599</span>            <span class="keywordflow">throw</span> scheduling_exception(<span class="stringliteral">&quot;Vehicle List is empty!&quot;</span>);</div>
<div class="line"><span class="lineno">  600</span>            </div>
<div class="line"><span class="lineno">  601</span>        }</div>
<div class="line"><span class="lineno">  602</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  603</span>            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;veh : veh_list ) {</div>
<div class="line"><span class="lineno">  604</span>                <span class="keywordflow">if</span> ( veh._id == veh_id ) {</div>
<div class="line"><span class="lineno">  605</span>                    rtn = veh; </div>
<div class="line"><span class="lineno">  606</span>                    found_veh = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  607</span>                }</div>
<div class="line"><span class="lineno">  608</span>            }</div>
<div class="line"><span class="lineno">  609</span>        }</div>
<div class="line"><span class="lineno">  610</span>        <span class="keywordflow">if</span> (!found_veh) {</div>
<div class="line"><span class="lineno">  611</span>            <span class="keywordflow">throw</span> scheduling_exception(<span class="stringliteral">&quot;Vehicle&quot;</span> +  veh_id + <span class="stringliteral">&quot; not found!&quot;</span>);</div>
<div class="line"><span class="lineno">  612</span> </div>
<div class="line"><span class="lineno">  613</span>        }</div>
<div class="line"><span class="lineno">  614</span>        <span class="keywordflow">return</span> rtn;</div>
<div class="line"><span class="lineno">  615</span>    }</div>
<div class="ttc" id="astructstreets__vehicles_1_1vehicle_html"><div class="ttname"><a href="structstreets__vehicles_1_1vehicle.html">streets_vehicles::vehicle</a></div><div class="ttdoc">Data struct for vehicle status and intent information.</div><div class="ttdef"><b>Definition:</b> <a href="vehicle_8h_source.html#l00034">vehicle.h:34</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00171">schedule_rdvs()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a0cf6941cc406bbd51889c129231e9443_icgraph.png" border="0" usemap="#aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a0cf6941cc406bbd51889c129231e9443_icgraph" alt=""/></div>
<map name="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a0cf6941cc406bbd51889c129231e9443_icgraph" id="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a0cf6941cc406bbd51889c129231e9443_icgraph">
<area shape="rect" title="Given a list of vehicles and a vehicle id, this method returns the vehicle with a matching vehicle id..." alt="" coords="469,5,653,61"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a0729a968f0b8f0b0ec11453157df101c" title="Schedule all currently Ready to Depart Vehicles (RDVs). Consider all possible RDV departure orders...." alt="" coords="237,5,421,61"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a930961b3e285b2a2d08f4276ffa22658" title="Method to schedule vehicles. Given and empty intersection_schedule object and a map of vehicles and v..." alt="" coords="5,5,189,61"/>
</map>
</div>

</div>
</div>
<a id="a35eb7b98052f4ef88850471478fcdddb" name="a35eb7b98052f4ef88850471478fcdddb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35eb7b98052f4ef88850471478fcdddb">&#9670;&nbsp;</a></span>is_rdv_previously_granted_access()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool streets_vehicle_scheduler::all_stop_vehicle_scheduler::is_rdv_previously_granted_access </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structstreets__vehicles_1_1vehicle.html">streets_vehicles::vehicle</a> &amp;&#160;</td>
          <td class="paramname"><em>veh</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Method to determine whether vehicle was granted access to the intersection in previous schedules. To avoid granting conflicting vehicles intersection access simultaneously, the scheduling service maintains a list of vehicles it has granted access to in the past. Vehicles are removed from this list once their update reflects that they have received and processed this access. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">veh</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if vehicle is in list of vehicles previously granted access. </dd>
<dd>
false if vehicle is not in list of vehicles previously granted access. </dd></dl>

<p class="definition">Definition at line <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00580">580</a> of file <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html">all_stop_vehicle_scheduler.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  580</span>                                                                                                               {</div>
<div class="line"><span class="lineno">  581</span>        <span class="keywordflow">if</span> ( <a class="code hl_variable" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a77c53828e29e53a9a7ff752afb65b549">rdvs_previously_granted_access</a>.empty() ) {</div>
<div class="line"><span class="lineno">  582</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  583</span>        }</div>
<div class="line"><span class="lineno">  584</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  585</span>            <span class="keywordflow">for</span> ( <span class="keyword">const</span> <span class="keyword">auto</span> &amp;rdv: <a class="code hl_variable" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a77c53828e29e53a9a7ff752afb65b549">rdvs_previously_granted_access</a> ) {</div>
<div class="line"><span class="lineno">  586</span>                <span class="keywordflow">if</span> ( rdv._id == veh.<a class="code hl_variable" href="structstreets__vehicles_1_1vehicle.html#a470605f661a8f625329ebbb10888e2b8">_id</a> ) {</div>
<div class="line"><span class="lineno">  587</span>                    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  588</span>                }</div>
<div class="line"><span class="lineno">  589</span>            }</div>
<div class="line"><span class="lineno">  590</span>            <span class="comment">// not in list</span></div>
<div class="line"><span class="lineno">  591</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  592</span>        }</div>
<div class="line"><span class="lineno">  593</span>    }</div>
<div class="ttc" id="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_html_a77c53828e29e53a9a7ff752afb65b549"><div class="ttname"><a href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a77c53828e29e53a9a7ff752afb65b549">streets_vehicle_scheduler::all_stop_vehicle_scheduler::rdvs_previously_granted_access</a></div><div class="ttdeci">std::list&lt; streets_vehicles::vehicle &gt; rdvs_previously_granted_access</div><div class="ttdoc">A list of RDV vehicles granted access by the vehicle_scheduler, who's updates do not yet reflect they...</div><div class="ttdef"><b>Definition:</b> <a href="all__stop__vehicle__scheduler_8h_source.html#l00027">all_stop_vehicle_scheduler.h:27</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="vehicle_8h_source.html#l00037">streets_vehicles::vehicle::_id</a>, and <a class="el" href="all__stop__vehicle__scheduler_8h_source.html#l00027">rdvs_previously_granted_access</a>.</p>

<p class="reference">Referenced by <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00117">schedule_dvs()</a>, and <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00009">schedule_vehicles()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a35eb7b98052f4ef88850471478fcdddb_icgraph.png" border="0" usemap="#aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a35eb7b98052f4ef88850471478fcdddb_icgraph" alt=""/></div>
<map name="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a35eb7b98052f4ef88850471478fcdddb_icgraph" id="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a35eb7b98052f4ef88850471478fcdddb_icgraph">
<area shape="rect" title="Method to determine whether vehicle was granted access to the intersection in previous schedules...." alt="" coords="469,39,696,95"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a16230014f5d43ef2546a54496c08a9cd" title="Schedule all currently Departing Vehicle (DVs). Estimate intersection departure times (dt&#39;s) for each..." alt="" coords="237,5,421,61"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a930961b3e285b2a2d08f4276ffa22658" title="Method to schedule vehicles. Given and empty intersection_schedule object and a map of vehicles and v..." alt="" coords="5,39,189,95"/>
</map>
</div>

</div>
</div>
<a id="a223e57041ae7ca6c4810877c8c74a49e" name="a223e57041ae7ca6c4810877c8c74a49e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a223e57041ae7ca6c4810877c8c74a49e">&#9670;&nbsp;</a></span>remove_rdv_previously_granted_access()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void streets_vehicle_scheduler::all_stop_vehicle_scheduler::remove_rdv_previously_granted_access </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structstreets__vehicles_1_1vehicle.html">streets_vehicles::vehicle</a> &amp;&#160;</td>
          <td class="paramname"><em>veh</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This method will remove a vehicle (DV) once it's updates reflect that is has received access from the list of previously granted access RDVs. This method should be called once a RDV received the schedule update that grants it access to the intersection. This is indicated by the vehicle no longer being a RDV and instead being a DV (. </p>
<dl class="section see"><dt>See also</dt><dd>streets_vehicle_list library).</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">veh</td><td>DV to be removed from list </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00567">567</a> of file <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html">all_stop_vehicle_scheduler.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  567</span>                                                                                                             {</div>
<div class="line"><span class="lineno">  568</span>        <span class="keyword">auto</span> previously_granted_itr = <a class="code hl_variable" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a77c53828e29e53a9a7ff752afb65b549">rdvs_previously_granted_access</a>.begin();</div>
<div class="line"><span class="lineno">  569</span>        <span class="keywordflow">while</span> ( previously_granted_itr != <a class="code hl_variable" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a77c53828e29e53a9a7ff752afb65b549">rdvs_previously_granted_access</a>.end() ) {</div>
<div class="line"><span class="lineno">  570</span>            <span class="keywordflow">if</span> ( previously_granted_itr-&gt;_id == veh.<a class="code hl_variable" href="structstreets__vehicles_1_1vehicle.html#a470605f661a8f625329ebbb10888e2b8">_id</a> ) {</div>
<div class="line"><span class="lineno">  571</span>                SPDLOG_INFO(<span class="stringliteral">&quot;Removing DV {0} from list of RDVs previously granted access.&quot;</span>, previously_granted_itr-&gt;_id);</div>
<div class="line"><span class="lineno">  572</span>                <a class="code hl_variable" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a77c53828e29e53a9a7ff752afb65b549">rdvs_previously_granted_access</a>.erase(previously_granted_itr);</div>
<div class="line"><span class="lineno">  573</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  574</span>            }<span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  575</span>                previously_granted_itr++;</div>
<div class="line"><span class="lineno">  576</span>            }</div>
<div class="line"><span class="lineno">  577</span>        }</div>
<div class="line"><span class="lineno">  578</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="vehicle_8h_source.html#l00037">streets_vehicles::vehicle::_id</a>, and <a class="el" href="all__stop__vehicle__scheduler_8h_source.html#l00027">rdvs_previously_granted_access</a>.</p>

<p class="reference">Referenced by <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00009">schedule_vehicles()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a223e57041ae7ca6c4810877c8c74a49e_icgraph.png" border="0" usemap="#aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a223e57041ae7ca6c4810877c8c74a49e_icgraph" alt=""/></div>
<map name="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a223e57041ae7ca6c4810877c8c74a49e_icgraph" id="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a223e57041ae7ca6c4810877c8c74a49e_icgraph">
<area shape="rect" title="This method will remove a vehicle (DV) once it&#39;s updates reflect that is has received access from the..." alt="" coords="237,5,497,61"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a930961b3e285b2a2d08f4276ffa22658" title="Method to schedule vehicles. Given and empty intersection_schedule object and a map of vehicles and v..." alt="" coords="5,5,189,61"/>
</map>
</div>

</div>
</div>
<a id="a16230014f5d43ef2546a54496c08a9cd" name="a16230014f5d43ef2546a54496c08a9cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16230014f5d43ef2546a54496c08a9cd">&#9670;&nbsp;</a></span>schedule_dvs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void streets_vehicle_scheduler::all_stop_vehicle_scheduler::schedule_dvs </td>
          <td>(</td>
          <td class="paramtype">std::list&lt; <a class="el" href="structstreets__vehicles_1_1vehicle.html">streets_vehicles::vehicle</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>dvs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::shared_ptr&lt; <a class="el" href="structstreets__vehicle__scheduler_1_1all__stop__intersection__schedule.html">all_stop_intersection_schedule</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>schedule</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Schedule all currently Departing Vehicle (DVs). Estimate intersection departure times (dt's) for each vehicle based on kinematic vehicle information and intersection geometry. Method assumes empty <a class="el" href="structstreets__vehicle__scheduler_1_1intersection__schedule.html" title="Struct to store vehicle schedules for all vehicle in an intersection. Includes a timestamp in millise...">intersection_schedule</a> is passed in. Method will add vehicle_schedule(s) for each DV in the vector. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dvs</td><td>vector of unscheduled DVs </td></tr>
    <tr><td class="paramname">schedule</td><td><a class="el" href="structstreets__vehicle__scheduler_1_1all__stop__intersection__schedule.html" title="Struct to store vehicle schedules for all vehicle in an intersection. Includes a timestamp in millise...">all_stop_intersection_schedule</a> to add DV scheduling information to. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00117">117</a> of file <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html">all_stop_vehicle_scheduler.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  118</span>                                                                                                                    {       </div>
<div class="line"><span class="lineno">  119</span>        <span class="comment">// Sort based on departure position</span></div>
<div class="line"><span class="lineno">  120</span>        dvs.sort( <a class="code hl_function" href="namespacestreets__vehicle__scheduler.html#aa9f946d7c588b2697fd379fbed72f382">departure_position_comparator</a>);</div>
<div class="line"><span class="lineno">  121</span>        <span class="comment">// Regardless of previously set departure index, set DV with lowest departure position to departure position 1</span></div>
<div class="line"><span class="lineno">  122</span>        <span class="comment">// to account for DVs that have become LVs</span></div>
<div class="line"><span class="lineno">  123</span>        <span class="keywordtype">int</span> departure_position_index = 1;                                                    </div>
<div class="line"><span class="lineno">  124</span>        <span class="keywordflow">for</span> ( <span class="keyword">const</span> <span class="keyword">auto</span> &amp;departing_veh : dvs ) {</div>
<div class="line"><span class="lineno">  125</span>            SPDLOG_TRACE(<span class="stringliteral">&quot;Scheduling DV with ID {0} .&quot;</span>, departing_veh._id);</div>
<div class="line"><span class="lineno">  126</span>            <span class="comment">// get link lane info</span></div>
<div class="line"><span class="lineno">  127</span>            <a class="code hl_class" href="classOpenAPI_1_1OAILanelet__info.html">OpenAPI::OAILanelet_info</a> lane_info =  <a class="code hl_function" href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#af2c80eb87e5a9cabaad660544003663c">get_link_lanelet_info</a>( departing_veh );</div>
<div class="line"><span class="lineno">  128</span>            <span class="comment">// calculate clearance time in milliseconds </span></div>
<div class="line"><span class="lineno">  129</span>            uint64_t clearance_time = <a class="code hl_function" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a15b4da36dba827263da4c844028c6db1">estimate_clearance_time</a>(departing_veh, lane_info);</div>
<div class="line"><span class="lineno">  130</span> </div>
<div class="line"><span class="lineno">  131</span>            all_stop_vehicle_schedule veh_sched;</div>
<div class="line"><span class="lineno">  132</span>            <span class="comment">// set id</span></div>
<div class="line"><span class="lineno">  133</span>            veh_sched.v_id = departing_veh._id;</div>
<div class="line"><span class="lineno">  134</span>            <span class="comment">// set est </span></div>
<div class="line"><span class="lineno">  135</span>            veh_sched.est = departing_veh._actual_st;</div>
<div class="line"><span class="lineno">  136</span>            <span class="comment">// set st</span></div>
<div class="line"><span class="lineno">  137</span>            veh_sched.st = departing_veh._actual_st;</div>
<div class="line"><span class="lineno">  138</span>            <span class="comment">// set et</span></div>
<div class="line"><span class="lineno">  139</span>            <span class="comment">// if the vehicle is a previously granted access rdv but did not confirm it has received access and thus, doesn&#39;t have an actual et</span></div>
<div class="line"><span class="lineno">  140</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a35eb7b98052f4ef88850471478fcdddb">is_rdv_previously_granted_access</a>(departing_veh))</div>
<div class="line"><span class="lineno">  141</span>            {</div>
<div class="line"><span class="lineno">  142</span>                veh_sched.et =  schedule-&gt;timestamp;</div>
<div class="line"><span class="lineno">  143</span>            }</div>
<div class="line"><span class="lineno">  144</span>            <span class="comment">// otherwise</span></div>
<div class="line"><span class="lineno">  145</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  146</span>            {</div>
<div class="line"><span class="lineno">  147</span>                veh_sched.et =  departing_veh._actual_et;</div>
<div class="line"><span class="lineno">  148</span>            }</div>
<div class="line"><span class="lineno">  149</span>            <span class="comment">// departure time is equal to current time plus clearance time for DVs</span></div>
<div class="line"><span class="lineno">  150</span>            veh_sched.dt =  schedule-&gt;timestamp + clearance_time;</div>
<div class="line"><span class="lineno">  151</span>            <span class="comment">// set departure position to departure position index</span></div>
<div class="line"><span class="lineno">  152</span>            veh_sched.dp = departure_position_index;</div>
<div class="line"><span class="lineno">  153</span>            <span class="comment">// Increment index for next DV</span></div>
<div class="line"><span class="lineno">  154</span>            departure_position_index++;</div>
<div class="line"><span class="lineno">  155</span>            <span class="comment">// set state</span></div>
<div class="line"><span class="lineno">  156</span>            veh_sched.state = departing_veh._cur_state;</div>
<div class="line"><span class="lineno">  157</span>            <span class="comment">// set vehicle link id</span></div>
<div class="line"><span class="lineno">  158</span>            veh_sched.link_id =  departing_veh._link_id;</div>
<div class="line"><span class="lineno">  159</span>            <span class="comment">// set vehicle entry lane id</span></div>
<div class="line"><span class="lineno">  160</span>            veh_sched.entry_lane =  departing_veh._entry_lane_id;</div>
<div class="line"><span class="lineno">  161</span>            <span class="comment">// set access</span></div>
<div class="line"><span class="lineno">  162</span>            veh_sched.access =  <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  163</span>            SPDLOG_TRACE(<span class="stringliteral">&quot;Added schedule for {0} with dt {1}.&quot;</span>, veh_sched.v_id, veh_sched.dt);</div>
<div class="line"><span class="lineno">  164</span>            <span class="comment">// add vehicle_schedule</span></div>
<div class="line"><span class="lineno">  165</span>            schedule-&gt;vehicle_schedules.push_back(veh_sched);</div>
<div class="line"><span class="lineno">  166</span> </div>
<div class="line"><span class="lineno">  167</span>        }</div>
<div class="line"><span class="lineno">  168</span> </div>
<div class="line"><span class="lineno">  169</span>    }</div>
<div class="ttc" id="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_html_a35eb7b98052f4ef88850471478fcdddb"><div class="ttname"><a href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a35eb7b98052f4ef88850471478fcdddb">streets_vehicle_scheduler::all_stop_vehicle_scheduler::is_rdv_previously_granted_access</a></div><div class="ttdeci">bool is_rdv_previously_granted_access(const streets_vehicles::vehicle &amp;veh) const</div><div class="ttdoc">Method to determine whether vehicle was granted access to the intersection in previous schedules....</div><div class="ttdef"><b>Definition:</b> <a href="all__stop__vehicle__scheduler_8cpp_source.html#l00580">all_stop_vehicle_scheduler.cpp:580</a></div></div>
<div class="ttc" id="anamespacestreets__vehicle__scheduler_html_aa9f946d7c588b2697fd379fbed72f382"><div class="ttname"><a href="namespacestreets__vehicle__scheduler.html#aa9f946d7c588b2697fd379fbed72f382">streets_vehicle_scheduler::departure_position_comparator</a></div><div class="ttdeci">bool departure_position_comparator(const streets_vehicles::vehicle &amp;prev_veh, const streets_vehicles::vehicle &amp;next_veh)</div><div class="ttdoc">Comparator for vehicle collections. Used for sorting vehicle objects in a collection in ascending ord...</div><div class="ttdef"><b>Definition:</b> <a href="vehicle__sorting_8cpp_source.html#l00004">vehicle_sorting.cpp:4</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="all__stop__intersection__schedule_8h_source.html#l00056">streets_vehicle_scheduler::all_stop_vehicle_schedule::access</a>, <a class="el" href="vehicle__sorting_8cpp_source.html#l00004">streets_vehicle_scheduler::departure_position_comparator()</a>, <a class="el" href="all__stop__intersection__schedule_8h_source.html#l00052">streets_vehicle_scheduler::all_stop_vehicle_schedule::dp</a>, <a class="el" href="all__stop__intersection__schedule_8h_source.html#l00045">streets_vehicle_scheduler::all_stop_vehicle_schedule::dt</a>, <a class="el" href="intersection__schedule_8h_source.html#l00032">streets_vehicle_scheduler::vehicle_schedule::entry_lane</a>, <a class="el" href="all__stop__intersection__schedule_8h_source.html#l00029">streets_vehicle_scheduler::all_stop_vehicle_schedule::est</a>, <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00511">estimate_clearance_time()</a>, <a class="el" href="all__stop__intersection__schedule_8h_source.html#l00039">streets_vehicle_scheduler::all_stop_vehicle_schedule::et</a>, <a class="el" href="vehicle__scheduler_8cpp_source.html#l00031">streets_vehicle_scheduler::vehicle_scheduler::get_link_lanelet_info()</a>, <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00580">is_rdv_previously_granted_access()</a>, <a class="el" href="intersection__schedule_8h_source.html#l00036">streets_vehicle_scheduler::vehicle_schedule::link_id</a>, <a class="el" href="all__stop__intersection__schedule_8h_source.html#l00034">streets_vehicle_scheduler::all_stop_vehicle_schedule::st</a>, <a class="el" href="all__stop__intersection__schedule_8h_source.html#l00060">streets_vehicle_scheduler::all_stop_vehicle_schedule::state</a>, and <a class="el" href="intersection__schedule_8h_source.html#l00028">streets_vehicle_scheduler::vehicle_schedule::v_id</a>.</p>

<p class="reference">Referenced by <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00009">schedule_vehicles()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a16230014f5d43ef2546a54496c08a9cd_cgraph.png" border="0" usemap="#aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a16230014f5d43ef2546a54496c08a9cd_cgraph" alt=""/></div>
<map name="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a16230014f5d43ef2546a54496c08a9cd_cgraph" id="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a16230014f5d43ef2546a54496c08a9cd_cgraph">
<area shape="rect" title="Schedule all currently Departing Vehicle (DVs). Estimate intersection departure times (dt&#39;s) for each..." alt="" coords="5,110,189,166"/>
<area shape="rect" href="namespacestreets__vehicle__scheduler.html#aa9f946d7c588b2697fd379fbed72f382" title="Comparator for vehicle collections. Used for sorting vehicle objects in a collection in ascending ord..." alt="" coords="247,5,454,47"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a15b4da36dba827263da4c844028c6db1" title="Estimate clearance time any vehicle given it&#39;s link lanelet information." alt="" coords="259,70,443,126"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#af2c80eb87e5a9cabaad660544003663c" title="Helper method to get link lane OAILanelet_info from intersection information given a vehicle." alt="" coords="264,150,437,206"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a35eb7b98052f4ef88850471478fcdddb" title="Method to determine whether vehicle was granted access to the intersection in previous schedules...." alt="" coords="237,230,464,286"/>
<area shape="rect" href="classOpenAPI_1_1OAILanelet__info.html#abc1c4d5d24a2dafb175874ecad09cfad" title=" " alt="" coords="512,16,659,57"/>
<area shape="rect" href="classOpenAPI_1_1OAILanelet__info.html#a9ed2860829d5aeba3062f26e78afcbdc" title=" " alt="" coords="512,81,659,123"/>
<area shape="rect" href="classOpenAPI_1_1OAILanelet__info.html#a489d1a475686159298697bccabd2bd52" title=" " alt="" coords="512,153,659,195"/>
<area shape="rect" href="ntcip__1202__ext_8h.html#a576de7b60eacee3f1a70393a005502cd" title="Returns std::string representation of ntcip_1202_ext message including phase_times array." alt="" coords="549,219,621,246"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a16230014f5d43ef2546a54496c08a9cd_icgraph.png" border="0" usemap="#aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a16230014f5d43ef2546a54496c08a9cd_icgraph" alt=""/></div>
<map name="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a16230014f5d43ef2546a54496c08a9cd_icgraph" id="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a16230014f5d43ef2546a54496c08a9cd_icgraph">
<area shape="rect" title="Schedule all currently Departing Vehicle (DVs). Estimate intersection departure times (dt&#39;s) for each..." alt="" coords="237,5,421,61"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a930961b3e285b2a2d08f4276ffa22658" title="Method to schedule vehicles. Given and empty intersection_schedule object and a map of vehicles and v..." alt="" coords="5,5,189,61"/>
</map>
</div>

</div>
</div>
<a id="acd0ec98c5efc93aadb38563e3b98d1bb" name="acd0ec98c5efc93aadb38563e3b98d1bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd0ec98c5efc93aadb38563e3b98d1bb">&#9670;&nbsp;</a></span>schedule_evs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void streets_vehicle_scheduler::all_stop_vehicle_scheduler::schedule_evs </td>
          <td>(</td>
          <td class="paramtype">std::list&lt; <a class="el" href="structstreets__vehicles_1_1vehicle.html">streets_vehicles::vehicle</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>evs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::shared_ptr&lt; <a class="el" href="structstreets__vehicle__scheduler_1_1all__stop__intersection__schedule.html">all_stop_intersection_schedule</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>schedule</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Schedule all Entering Vehicles (EVs). Method first organizes all EVs into lists based on their entry lane. These list are order in ascending order with the vehicle closest to the intersection in a given lane being the first vehicle in that entry lanes vehicle list. Then stopping time (ST) for the unscheduled front EVs from every approach are calculated and the vehicle with the lowest (earliest) stopping times is scheduled. This is repeated until all evs from all approach lanelets are scheduled. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">evs</td><td>vector of unscheduled EVs. </td></tr>
    <tr><td class="paramname">schedule</td><td><a class="el" href="structstreets__vehicle__scheduler_1_1all__stop__intersection__schedule.html" title="Struct to store vehicle schedules for all vehicle in an intersection. Includes a timestamp in millise...">all_stop_intersection_schedule</a> to add EV scheduling information to. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00230">230</a> of file <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html">all_stop_vehicle_scheduler.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  230</span>                                                                                                                                                              {</div>
<div class="line"><span class="lineno">  231</span>        <span class="comment">// Map of entry lane ids to preceding already scheduled vehicle</span></div>
<div class="line"><span class="lineno">  232</span>        std::unordered_map&lt;int , all_stop_vehicle_schedule&gt; preceding_vehicle_entry_lane_map;</div>
<div class="line"><span class="lineno">  233</span>        <span class="keywordflow">for</span> ( <span class="keyword">const</span> <span class="keyword">auto</span> &amp;entry_lane : <a class="code hl_variable" href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#a5fa37276e5ccb41e38cbef573e830e8e">intersection_info</a>-&gt;getEntryLanelets() ) {</div>
<div class="line"><span class="lineno">  234</span>            <span class="keywordtype">int</span> lane_id = entry_lane.getId();</div>
<div class="line"><span class="lineno">  235</span>            all_stop_vehicle_schedule preceding_veh;</div>
<div class="line"><span class="lineno">  236</span>            <span class="comment">// Only one RDV can exist for each approach</span></div>
<div class="line"><span class="lineno">  237</span>            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;veh_sched : schedule-&gt;vehicle_schedules ) {</div>
<div class="line"><span class="lineno">  238</span>                <span class="keywordflow">if</span> ( veh_sched.state == <a class="code hl_enumvalue" href="namespacestreets__vehicles.html#a41f5c896d8020c141aa96235cf1405acab08ef04fe84cf4f6645fef073717f36f">streets_vehicles::vehicle_state::RDV</a>) {</div>
<div class="line"><span class="lineno">  239</span>                    <span class="comment">// All RDVs</span></div>
<div class="line"><span class="lineno">  240</span>                    preceding_veh = veh_sched;</div>
<div class="line"><span class="lineno">  241</span>                    preceding_vehicle_entry_lane_map.try_emplace(lane_id, preceding_veh);  </div>
<div class="line"><span class="lineno">  242</span> </div>
<div class="line"><span class="lineno">  243</span>                }</div>
<div class="line"><span class="lineno">  244</span>                <span class="comment">// Consider vehicles recently granted access</span></div>
<div class="line"><span class="lineno">  245</span>                <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( veh_sched.state == <a class="code hl_enumvalue" href="namespacestreets__vehicles.html#a41f5c896d8020c141aa96235cf1405aca58d6a88f13e2db7f5059c41047876f00">streets_vehicles::vehicle_state::DV</a> &amp;&amp; (veh_sched.et-schedule-&gt;timestamp) &lt;= <a class="code hl_variable" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a13124a205e1c6615f6a137c507b2a4eb">entering_time_buffer</a>) {</div>
<div class="line"><span class="lineno">  246</span>                    SPDLOG_TRACE(<span class="stringliteral">&quot;Considering DV {0} as still in entry since entering time {1} - timestamp {2} does not exceed buffer {3}&quot;</span>,</div>
<div class="line"><span class="lineno">  247</span>                            veh_sched.v_id, veh_sched.et, schedule-&gt;timestamp, <a class="code hl_variable" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a13124a205e1c6615f6a137c507b2a4eb">entering_time_buffer</a>);</div>
<div class="line"><span class="lineno">  248</span>                    preceding_veh = veh_sched;</div>
<div class="line"><span class="lineno">  249</span>                    preceding_vehicle_entry_lane_map.try_emplace(lane_id, preceding_veh);</div>
<div class="line"><span class="lineno">  250</span>                }</div>
<div class="line"><span class="lineno">  251</span>            }</div>
<div class="line"><span class="lineno">  252</span>        }</div>
<div class="line"><span class="lineno">  253</span> </div>
<div class="line"><span class="lineno">  254</span>        <span class="comment">// Sort vehicles based on distance</span></div>
<div class="line"><span class="lineno">  255</span>        evs.sort(<a class="code hl_function" href="namespacestreets__vehicle__scheduler.html#ab550673e6a269f9f374ca3ca7ff6ba82">distance_comparator</a>);</div>
<div class="line"><span class="lineno">  256</span>        </div>
<div class="line"><span class="lineno">  257</span>        <span class="comment">// Create a map of entry lane id keys and list of vehicle to be scheduled next in each lane.</span></div>
<div class="line"><span class="lineno">  258</span>        std::unordered_map&lt;int, std::list&lt;streets_vehicles::vehicle&gt;&gt; vehicle_to_be_scheduled_next;</div>
<div class="line"><span class="lineno">  259</span>        <span class="keywordflow">for</span> ( <span class="keyword">const</span> <span class="keyword">auto</span> &amp;entry_lane : <a class="code hl_variable" href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#a5fa37276e5ccb41e38cbef573e830e8e">intersection_info</a>-&gt;getEntryLanelets() ) {</div>
<div class="line"><span class="lineno">  260</span>            std::list&lt;streets_vehicles::vehicle&gt; vehicles_in_lane;</div>
<div class="line"><span class="lineno">  261</span>            <span class="keywordflow">for</span> ( <span class="keyword">const</span> <span class="keyword">auto</span> &amp;ev : evs ) {</div>
<div class="line"><span class="lineno">  262</span>                <span class="keywordflow">if</span> ( ev._entry_lane_id == entry_lane.getId()) {</div>
<div class="line"><span class="lineno">  263</span>                    SPDLOG_TRACE(<span class="stringliteral">&quot;Adding vehicle {0} to EVs list in entry lane {1}&quot;</span>, ev._id, ev._entry_lane_id);</div>
<div class="line"><span class="lineno">  264</span>                    vehicles_in_lane.push_back(ev);</div>
<div class="line"><span class="lineno">  265</span>                }</div>
<div class="line"><span class="lineno">  266</span>            }</div>
<div class="line"><span class="lineno">  267</span>            <span class="keywordflow">if</span> ( !vehicles_in_lane.empty())</div>
<div class="line"><span class="lineno">  268</span>                vehicle_to_be_scheduled_next.try_emplace( entry_lane.getId(), vehicles_in_lane );</div>
<div class="line"><span class="lineno">  269</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  270</span>                SPDLOG_TRACE(<span class="stringliteral">&quot;No EVs in lane {0}.&quot;</span>,<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(entry_lane.getId()) );</div>
<div class="line"><span class="lineno">  271</span>            }</div>
<div class="line"><span class="lineno">  272</span>        }</div>
<div class="line"><span class="lineno">  273</span>        <span class="keywordflow">if</span> ( !vehicle_to_be_scheduled_next.empty()) {</div>
<div class="line"><span class="lineno">  274</span>            <span class="keywordflow">for</span> ( <span class="keyword">const</span> <span class="keyword">auto</span> &amp;[entry_lane, next_veh] : vehicle_to_be_scheduled_next ) {</div>
<div class="line"><span class="lineno">  275</span>                SPDLOG_TRACE(<span class="stringliteral">&quot;Next Vehicle {0} to be scheduled in lane {1}&quot;</span>,next_veh.front()._id, entry_lane);</div>
<div class="line"><span class="lineno">  276</span>            }</div>
<div class="line"><span class="lineno">  277</span>        }</div>
<div class="line"><span class="lineno">  278</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  279</span>            <span class="keywordflow">throw</span> scheduling_exception(<span class="stringliteral">&quot;Map of vehicles to be scheduled is empty but list of EVs to be scheduled is not!&quot;</span>);</div>
<div class="line"><span class="lineno">  280</span>        }</div>
<div class="line"><span class="lineno">  281</span>        <span class="comment">// Get next available departure index, default to 1 if schedule is empty</span></div>
<div class="line"><span class="lineno">  282</span>        <span class="keywordtype">int</span> last_departure_index = 1;</div>
<div class="line"><span class="lineno">  283</span>        <span class="keywordflow">if</span> ( !schedule-&gt;vehicle_schedules.empty()) {</div>
<div class="line"><span class="lineno">  284</span>            last_departure_index =  schedule-&gt;vehicle_schedules.back().dp + 1;</div>
<div class="line"><span class="lineno">  285</span>        }</div>
<div class="line"><span class="lineno">  286</span>        <span class="keywordflow">do</span> {</div>
<div class="line"><span class="lineno">  287</span>            all_stop_vehicle_schedule sched;</div>
<div class="line"><span class="lineno">  288</span>            <span class="comment">// Calculate ST for each next vehicle in each lane and schedule the vehicle with the lowest ST</span></div>
<div class="line"><span class="lineno">  289</span>            uint64_t lowest_st = 0;</div>
<div class="line"><span class="lineno">  290</span> </div>
<div class="line"><span class="lineno">  291</span>            <span class="comment">// Populate Map</span></div>
<div class="line"><span class="lineno">  292</span>            <span class="comment">// Find next vehicle for each entry lanelet</span></div>
<div class="line"><span class="lineno">  293</span>            <span class="keywordflow">for</span> ( <span class="keyword">const</span> <span class="keyword">auto</span> &amp;[entry_lane, evs_in_lane] : vehicle_to_be_scheduled_next ) {</div>
<div class="line"><span class="lineno">  294</span>                <span class="comment">// Take first vehicle to be scheduled in lane.</span></div>
<div class="line"><span class="lineno">  295</span>                <a class="code hl_struct" href="structstreets__vehicles_1_1vehicle.html">streets_vehicles::vehicle</a> ev = evs_in_lane.front();</div>
<div class="line"><span class="lineno">  296</span>                SPDLOG_TRACE( <span class="stringliteral">&quot;Estimating schedule for {0}.&quot;</span>, ev.<a class="code hl_variable" href="structstreets__vehicles_1_1vehicle.html#a470605f661a8f625329ebbb10888e2b8">_id</a>);</div>
<div class="line"><span class="lineno">  297</span> </div>
<div class="line"><span class="lineno">  298</span>                <span class="comment">// Get link lanelet information for ev</span></div>
<div class="line"><span class="lineno">  299</span>                <a class="code hl_class" href="classOpenAPI_1_1OAILanelet__info.html">OpenAPI::OAILanelet_info</a> link_lane = <a class="code hl_function" href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#af2c80eb87e5a9cabaad660544003663c">get_link_lanelet_info</a>( ev );</div>
<div class="line"><span class="lineno">  300</span>                SPDLOG_TRACE( <span class="stringliteral">&quot;Link lanelet for {0} is {1}.&quot;</span>, ev.<a class="code hl_variable" href="structstreets__vehicles_1_1vehicle.html#a470605f661a8f625329ebbb10888e2b8">_id</a>, link_lane.<a class="code hl_function" href="classOpenAPI_1_1OAILanelet__info.html#a489d1a475686159298697bccabd2bd52">getId</a>());</div>
<div class="line"><span class="lineno">  301</span>                <span class="comment">// Calculate EST for vehicle</span></div>
<div class="line"><span class="lineno">  302</span>                uint64_t est = <a class="code hl_function" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#ad5f0462b2d82168b7b71dcfd15eaa7f2">estimate_earliest_time_to_stop_bar</a>(ev);</div>
<div class="line"><span class="lineno">  303</span>                SPDLOG_TRACE( <span class="stringliteral">&quot;EST for vehicle {0} is {1}.&quot;</span> ,ev.<a class="code hl_variable" href="structstreets__vehicles_1_1vehicle.html#a470605f661a8f625329ebbb10888e2b8">_id</a>, est ) ;</div>
<div class="line"><span class="lineno">  304</span>                <span class="comment">// Store ST value for vehicle</span></div>
<div class="line"><span class="lineno">  305</span>                uint64_t st;</div>
<div class="line"><span class="lineno">  306</span> </div>
<div class="line"><span class="lineno">  307</span> </div>
<div class="line"><span class="lineno">  308</span>                <span class="comment">// If there is a preceding vehicle scheduled in this lane</span></div>
<div class="line"><span class="lineno">  309</span>                <span class="keywordflow">if</span> ( preceding_vehicle_entry_lane_map.find( ev.<a class="code hl_variable" href="structstreets__vehicles_1_1vehicle.html#adc3dab0260f149fc908b9b7d49e1ba99">_cur_lane_id</a> )  != preceding_vehicle_entry_lane_map.end() ) {</div>
<div class="line"><span class="lineno">  310</span>                    <span class="comment">// Get preceding vehicle in lane</span></div>
<div class="line"><span class="lineno">  311</span>                    all_stop_vehicle_schedule preceding_veh = preceding_vehicle_entry_lane_map.find( ev.<a class="code hl_variable" href="structstreets__vehicles_1_1vehicle.html#adc3dab0260f149fc908b9b7d49e1ba99">_cur_lane_id</a> )-&gt;second;</div>
<div class="line"><span class="lineno">  312</span>                    SPDLOG_TRACE(<span class="stringliteral">&quot;Preceding vehicle schedule in lane {0} is {1}.&quot;</span>, preceding_veh.entry_lane, preceding_veh.v_id);</div>
<div class="line"><span class="lineno">  313</span>                    <span class="comment">// If there is a preceding vehicle the st is calculated as max of EST and preceding vehicle ET plus a time</span></div>
<div class="line"><span class="lineno">  314</span>                    <span class="comment">// buffer to account for the time it takes the preceding vehicle to enter the intersection</span></div>
<div class="line"><span class="lineno">  315</span>                    SPDLOG_TRACE(<span class="stringliteral">&quot;Preceding vehicle et {0}&quot;</span>, preceding_veh.et);</div>
<div class="line"><span class="lineno">  316</span>                    st =  std::max( est, preceding_veh.et + <a class="code hl_variable" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a13124a205e1c6615f6a137c507b2a4eb">entering_time_buffer</a> );</div>
<div class="line"><span class="lineno">  317</span>                    SPDLOG_TRACE(<span class="stringliteral">&quot;Setting st for vehicle {0} to max of {1} , {2}.&quot;</span>, ev.<a class="code hl_variable" href="structstreets__vehicles_1_1vehicle.html#a470605f661a8f625329ebbb10888e2b8">_id</a>, est, preceding_veh.et + <a class="code hl_variable" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a13124a205e1c6615f6a137c507b2a4eb">entering_time_buffer</a>);</div>
<div class="line"><span class="lineno">  318</span> </div>
<div class="line"><span class="lineno">  319</span>                }</div>
<div class="line"><span class="lineno">  320</span>                <span class="comment">// IF there is no preceding vehicle ST == EST</span></div>
<div class="line"><span class="lineno">  321</span>                <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  322</span>                    SPDLOG_TRACE(<span class="stringliteral">&quot;No proceeding vehicle for {0}&quot;</span>, ev.<a class="code hl_variable" href="structstreets__vehicles_1_1vehicle.html#a470605f661a8f625329ebbb10888e2b8">_id</a>);</div>
<div class="line"><span class="lineno">  323</span>                    st = est;</div>
<div class="line"><span class="lineno">  324</span>                }</div>
<div class="line"><span class="lineno">  325</span>                <span class="comment">// If lowest st has not been set yet. This is currently the lowest st</span></div>
<div class="line"><span class="lineno">  326</span>                <span class="keywordflow">if</span> ( lowest_st == 0 || lowest_st &gt; st ) {</div>
<div class="line"><span class="lineno">  327</span>                    lowest_st = st;</div>
<div class="line"><span class="lineno">  328</span>                    <span class="comment">// Set schedule properties</span></div>
<div class="line"><span class="lineno">  329</span>                    sched.v_id =  ev.<a class="code hl_variable" href="structstreets__vehicles_1_1vehicle.html#a470605f661a8f625329ebbb10888e2b8">_id</a>;</div>
<div class="line"><span class="lineno">  330</span>                    sched.est = est;</div>
<div class="line"><span class="lineno">  331</span>                    sched.st = st;</div>
<div class="line"><span class="lineno">  332</span>                    sched.entry_lane =  ev.<a class="code hl_variable" href="structstreets__vehicles_1_1vehicle.html#a4ef0e2e811b0f5cb00f14b89a353c3b5">_entry_lane_id</a>;</div>
<div class="line"><span class="lineno">  333</span>                    sched.link_id = ev.<a class="code hl_variable" href="structstreets__vehicles_1_1vehicle.html#aaa9cbe97b2343b3f14841c1ed2bc8e3d">_link_id</a>;</div>
<div class="line"><span class="lineno">  334</span>                    sched.state = <a class="code hl_enumvalue" href="namespacestreets__vehicles.html#a41f5c896d8020c141aa96235cf1405aca834d41112f2943c357f660165b6eb6de">streets_vehicles::vehicle_state::EV</a>;</div>
<div class="line"><span class="lineno">  335</span>                    sched.access = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  336</span>                    sched.dp = last_departure_index;</div>
<div class="line"><span class="lineno">  337</span>                    sched.et = <a class="code hl_function" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a9b5ee4ffdbd82cbf0c48f7981e7dff9c">estimate_entering_time_for_ev</a>(schedule-&gt;vehicle_schedules, ev, st);</div>
<div class="line"><span class="lineno">  338</span>                    <span class="comment">// Departure time is equal to entering time + clearance time</span></div>
<div class="line"><span class="lineno">  339</span>                    sched.dt = sched.et + <a class="code hl_function" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a15b4da36dba827263da4c844028c6db1">estimate_clearance_time</a>( ev, link_lane );</div>
<div class="line"><span class="lineno">  340</span>            </div>
<div class="line"><span class="lineno">  341</span>                }</div>
<div class="line"><span class="lineno">  342</span>               </div>
<div class="line"><span class="lineno">  343</span>            }</div>
<div class="line"><span class="lineno">  344</span>            SPDLOG_TRACE( <span class="stringliteral">&quot;Found vehicle {0} with lowest stopping time {1} in lane {2}&quot;</span>, sched.v_id, sched.st, sched.entry_lane);</div>
<div class="line"><span class="lineno">  345</span>            <span class="comment">// Add lowest ST to schedule</span></div>
<div class="line"><span class="lineno">  346</span>            schedule-&gt;vehicle_schedules.push_back(sched);</div>
<div class="line"><span class="lineno">  347</span>            <span class="comment">// Increment departure index</span></div>
<div class="line"><span class="lineno">  348</span>            last_departure_index++;</div>
<div class="line"><span class="lineno">  349</span>            <span class="comment">// Replace previous preceeding vehicle for lane with scheduled vehicle</span></div>
<div class="line"><span class="lineno">  350</span>            <span class="keywordflow">if</span> ( preceding_vehicle_entry_lane_map.find(sched.entry_lane) != preceding_vehicle_entry_lane_map.end()) {</div>
<div class="line"><span class="lineno">  351</span>                preceding_vehicle_entry_lane_map.find(sched.entry_lane)-&gt;second =  sched;</div>
<div class="line"><span class="lineno">  352</span>            }</div>
<div class="line"><span class="lineno">  353</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  354</span>                preceding_vehicle_entry_lane_map.try_emplace(sched.entry_lane, sched);</div>
<div class="line"><span class="lineno">  355</span>            }</div>
<div class="line"><span class="lineno">  356</span>            <span class="comment">// Pop vehicle off of list of vehicles to be scheduled for each lane</span></div>
<div class="line"><span class="lineno">  357</span>            vehicle_to_be_scheduled_next.find(sched.entry_lane)-&gt;second.pop_front();</div>
<div class="line"><span class="lineno">  358</span>            <span class="comment">// If pop makes list empty remove map entry</span></div>
<div class="line"><span class="lineno">  359</span>            <span class="keywordflow">if</span> ( vehicle_to_be_scheduled_next.find(sched.entry_lane)-&gt;second.empty() ) {</div>
<div class="line"><span class="lineno">  360</span>                SPDLOG_TRACE(<span class="stringliteral">&quot;All vehicles in approach lanelet {0} have been scheduled!&quot;</span>, sched.entry_lane);</div>
<div class="line"><span class="lineno">  361</span>                vehicle_to_be_scheduled_next.erase(sched.entry_lane);</div>
<div class="line"><span class="lineno">  362</span>            }</div>
<div class="line"><span class="lineno">  363</span>            </div>
<div class="line"><span class="lineno">  364</span>        }</div>
<div class="line"><span class="lineno">  365</span>        <span class="keywordflow">while</span> ( !vehicle_to_be_scheduled_next.empty() );</div>
<div class="line"><span class="lineno">  366</span>    }</div>
<div class="ttc" id="aclassOpenAPI_1_1OAILanelet__info_html_a489d1a475686159298697bccabd2bd52"><div class="ttname"><a href="classOpenAPI_1_1OAILanelet__info.html#a489d1a475686159298697bccabd2bd52">OpenAPI::OAILanelet_info::getId</a></div><div class="ttdeci">qint32 getId() const</div><div class="ttdef"><b>Definition:</b> <a href="intersection__client__api_2OAILanelet__info_8cpp_source.html#l00121">OAILanelet_info.cpp:121</a></div></div>
<div class="ttc" id="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_html_a13124a205e1c6615f6a137c507b2a4eb"><div class="ttname"><a href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a13124a205e1c6615f6a137c507b2a4eb">streets_vehicle_scheduler::all_stop_vehicle_scheduler::entering_time_buffer</a></div><div class="ttdeci">uint64_t entering_time_buffer</div><div class="ttdoc">Configurable time buffer in milliseconds for estimating the time it takes a vehicle to leave its entr...</div><div class="ttdef"><b>Definition:</b> <a href="all__stop__vehicle__scheduler_8h_source.html#l00032">all_stop_vehicle_scheduler.h:32</a></div></div>
<div class="ttc" id="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_html_a9b5ee4ffdbd82cbf0c48f7981e7dff9c"><div class="ttname"><a href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a9b5ee4ffdbd82cbf0c48f7981e7dff9c">streets_vehicle_scheduler::all_stop_vehicle_scheduler::estimate_entering_time_for_ev</a></div><div class="ttdeci">uint64_t estimate_entering_time_for_ev(const std::vector&lt; all_stop_vehicle_schedule &gt; &amp;vehicle_schedules, const streets_vehicles::vehicle &amp;ev, const uint64_t st) const</div><div class="ttdoc">Estimates an entering time (ET) for a given Entering Vehicle (EV). This method first searches among t...</div><div class="ttdef"><b>Definition:</b> <a href="all__stop__vehicle__scheduler_8cpp_source.html#l00368">all_stop_vehicle_scheduler.cpp:368</a></div></div>
<div class="ttc" id="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_html_ad5f0462b2d82168b7b71dcfd15eaa7f2"><div class="ttname"><a href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#ad5f0462b2d82168b7b71dcfd15eaa7f2">streets_vehicle_scheduler::all_stop_vehicle_scheduler::estimate_earliest_time_to_stop_bar</a></div><div class="ttdeci">uint64_t estimate_earliest_time_to_stop_bar(const streets_vehicles::vehicle &amp;veh) const</div><div class="ttdoc">Method to use vehicle kinematic information to estimate earliest possible time stopping time for a ve...</div><div class="ttdef"><b>Definition:</b> <a href="all__stop__vehicle__scheduler_8cpp_source.html#l00390">all_stop_vehicle_scheduler.cpp:390</a></div></div>
<div class="ttc" id="aclassstreets__vehicle__scheduler_1_1vehicle__scheduler_html_a5fa37276e5ccb41e38cbef573e830e8e"><div class="ttname"><a href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#a5fa37276e5ccb41e38cbef573e830e8e">streets_vehicle_scheduler::vehicle_scheduler::intersection_info</a></div><div class="ttdeci">std::shared_ptr&lt; OpenAPI::OAIIntersection_info &gt; intersection_info</div><div class="ttdoc">shared pointer to intersection information required for scheduling.</div><div class="ttdef"><b>Definition:</b> <a href="vehicle__scheduler_8h_source.html#l00026">vehicle_scheduler.h:26</a></div></div>
<div class="ttc" id="anamespacestreets__vehicle__scheduler_html_ab550673e6a269f9f374ca3ca7ff6ba82"><div class="ttname"><a href="namespacestreets__vehicle__scheduler.html#ab550673e6a269f9f374ca3ca7ff6ba82">streets_vehicle_scheduler::distance_comparator</a></div><div class="ttdeci">bool distance_comparator(const streets_vehicles::vehicle &amp;prev_veh, const streets_vehicles::vehicle &amp;next_veh)</div><div class="ttdoc">Comparator for vehicle collections. Used for sorting vehicle objects in a collection in ascending ord...</div><div class="ttdef"><b>Definition:</b> <a href="vehicle__sorting_8cpp_source.html#l00029">vehicle_sorting.cpp:29</a></div></div>
<div class="ttc" id="astructstreets__vehicles_1_1vehicle_html_a4ef0e2e811b0f5cb00f14b89a353c3b5"><div class="ttname"><a href="structstreets__vehicles_1_1vehicle.html#a4ef0e2e811b0f5cb00f14b89a353c3b5">streets_vehicles::vehicle::_entry_lane_id</a></div><div class="ttdeci">int _entry_lane_id</div><div class="ttdef"><b>Definition:</b> <a href="vehicle_8h_source.html#l00051">vehicle.h:51</a></div></div>
<div class="ttc" id="astructstreets__vehicles_1_1vehicle_html_aaa9cbe97b2343b3f14841c1ed2bc8e3d"><div class="ttname"><a href="structstreets__vehicles_1_1vehicle.html#aaa9cbe97b2343b3f14841c1ed2bc8e3d">streets_vehicles::vehicle::_link_id</a></div><div class="ttdeci">int _link_id</div><div class="ttdef"><b>Definition:</b> <a href="vehicle_8h_source.html#l00055">vehicle.h:55</a></div></div>
<div class="ttc" id="astructstreets__vehicles_1_1vehicle_html_adc3dab0260f149fc908b9b7d49e1ba99"><div class="ttname"><a href="structstreets__vehicles_1_1vehicle.html#adc3dab0260f149fc908b9b7d49e1ba99">streets_vehicles::vehicle::_cur_lane_id</a></div><div class="ttdeci">int _cur_lane_id</div><div class="ttdef"><b>Definition:</b> <a href="vehicle_8h_source.html#l00049">vehicle.h:49</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="vehicle_8h_source.html#l00049">streets_vehicles::vehicle::_cur_lane_id</a>, <a class="el" href="vehicle_8h_source.html#l00051">streets_vehicles::vehicle::_entry_lane_id</a>, <a class="el" href="vehicle_8h_source.html#l00037">streets_vehicles::vehicle::_id</a>, <a class="el" href="vehicle_8h_source.html#l00055">streets_vehicles::vehicle::_link_id</a>, <a class="el" href="all__stop__intersection__schedule_8h_source.html#l00056">streets_vehicle_scheduler::all_stop_vehicle_schedule::access</a>, <a class="el" href="vehicle__sorting_8cpp_source.html#l00029">streets_vehicle_scheduler::distance_comparator()</a>, <a class="el" href="all__stop__intersection__schedule_8h_source.html#l00052">streets_vehicle_scheduler::all_stop_vehicle_schedule::dp</a>, <a class="el" href="all__stop__intersection__schedule_8h_source.html#l00045">streets_vehicle_scheduler::all_stop_vehicle_schedule::dt</a>, <a class="el" href="namespacestreets__vehicles.html#a41f5c896d8020c141aa96235cf1405aca58d6a88f13e2db7f5059c41047876f00">streets_vehicles::DV</a>, <a class="el" href="all__stop__vehicle__scheduler_8h_source.html#l00032">entering_time_buffer</a>, <a class="el" href="intersection__schedule_8h_source.html#l00032">streets_vehicle_scheduler::vehicle_schedule::entry_lane</a>, <a class="el" href="all__stop__intersection__schedule_8h_source.html#l00029">streets_vehicle_scheduler::all_stop_vehicle_schedule::est</a>, <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00511">estimate_clearance_time()</a>, <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00390">estimate_earliest_time_to_stop_bar()</a>, <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00368">estimate_entering_time_for_ev()</a>, <a class="el" href="all__stop__intersection__schedule_8h_source.html#l00039">streets_vehicle_scheduler::all_stop_vehicle_schedule::et</a>, <a class="el" href="namespacestreets__vehicles.html#a41f5c896d8020c141aa96235cf1405aca834d41112f2943c357f660165b6eb6de">streets_vehicles::EV</a>, <a class="el" href="vehicle__scheduler_8cpp_source.html#l00031">streets_vehicle_scheduler::vehicle_scheduler::get_link_lanelet_info()</a>, <a class="el" href="intersection__client__api_2OAILanelet__info_8cpp_source.html#l00121">OpenAPI::OAILanelet_info::getId()</a>, <a class="el" href="vehicle__scheduler_8h_source.html#l00026">streets_vehicle_scheduler::vehicle_scheduler::intersection_info</a>, <a class="el" href="intersection__schedule_8h_source.html#l00036">streets_vehicle_scheduler::vehicle_schedule::link_id</a>, <a class="el" href="namespacestreets__vehicles.html#a41f5c896d8020c141aa96235cf1405acab08ef04fe84cf4f6645fef073717f36f">streets_vehicles::RDV</a>, <a class="el" href="all__stop__intersection__schedule_8h_source.html#l00034">streets_vehicle_scheduler::all_stop_vehicle_schedule::st</a>, <a class="el" href="all__stop__intersection__schedule_8h_source.html#l00060">streets_vehicle_scheduler::all_stop_vehicle_schedule::state</a>, and <a class="el" href="intersection__schedule_8h_source.html#l00028">streets_vehicle_scheduler::vehicle_schedule::v_id</a>.</p>

<p class="reference">Referenced by <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00009">schedule_vehicles()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_acd0ec98c5efc93aadb38563e3b98d1bb_cgraph.png" border="0" usemap="#aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_acd0ec98c5efc93aadb38563e3b98d1bb_cgraph" alt=""/></div>
<map name="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_acd0ec98c5efc93aadb38563e3b98d1bb_cgraph" id="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_acd0ec98c5efc93aadb38563e3b98d1bb_cgraph">
<area shape="rect" title="Schedule all Entering Vehicles (EVs). Method first organizes all EVs into lists based on their entry ..." alt="" coords="5,453,189,509"/>
<area shape="rect" href="namespacestreets__vehicle__scheduler.html#ab550673e6a269f9f374ca3ca7ff6ba82" title="Comparator for vehicle collections. Used for sorting vehicle objects in a collection in ascending ord..." alt="" coords="254,87,427,128"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a15b4da36dba827263da4c844028c6db1" title="Estimate clearance time any vehicle given it&#39;s link lanelet information." alt="" coords="249,151,433,207"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#ad5f0462b2d82168b7b71dcfd15eaa7f2" title="Method to use vehicle kinematic information to estimate earliest possible time stopping time for a ve..." alt="" coords="249,365,433,436"/>
<area shape="rect" href="classOpenAPI_1_1OAILanelet__info.html#a489d1a475686159298697bccabd2bd52" title=" " alt="" coords="745,660,892,701"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a9b5ee4ffdbd82cbf0c48f7981e7dff9c" title="Estimates an entering time (ET) for a given Entering Vehicle (EV). This method first searches among t..." alt="" coords="237,783,444,839"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#af2c80eb87e5a9cabaad660544003663c" title="Helper method to get link lane OAILanelet_info from intersection information given a vehicle." alt="" coords="500,653,673,709"/>
<area shape="rect" href="classOpenAPI_1_1OAILanelet__info.html#abc1c4d5d24a2dafb175874ecad09cfad" title=" " alt="" coords="513,5,660,47"/>
<area shape="rect" href="classOpenAPI_1_1OAILanelet__info.html#a9ed2860829d5aeba3062f26e78afcbdc" title=" " alt="" coords="745,115,892,156"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a3ba56cc964002b21475a475995938b89" title="Method to calculate time interval necessary for accelerating to speed v_hat for a given vehicle...." alt="" coords="492,333,681,389"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#afedbbc9205b39ceb8707d950b5c26556" title="Method to calculate time interval necessary for cruising at a constant speed v_hat (speed limit) grea..." alt="" coords="495,413,679,469"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a63107a1e136be3a00f3a1445531904aa" title="Method to calculate time interval necessary for deceleration from v_hat to 0 to stop at stop bar...." alt="" coords="492,493,681,549"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#ae5a42af1af20b06df9ad6af5d3170406" title="Method to calculate v_hat. This is the maximum speed reached between maximum speed reached between ac..." alt="" coords="495,573,679,629"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#acab5956159419bef2c5391d59e3fe9ee" title="Calculate minumum distance required to speed up to lane speed limit with maximum acceleration,..." alt="" coords="495,173,679,229"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#af8916add714bef70d8f48efc0ccfca7b" title="Helper method to get entry lane OAILanelet_info from intersection information given a vehicle." alt="" coords="500,253,673,309"/>
<area shape="rect" href="ntcip__1202__ext_8h.html#a576de7b60eacee3f1a70393a005502cd" title="Returns std::string representation of ntcip_1202_ext message including phase_times array." alt="" coords="783,438,855,465"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#aa06721804b8a4075b98c2e8ad40c84da" title="Given a link lane and a vector of vehicle schedules, this method returns a pointer to a vehicle sched..." alt="" coords="495,783,679,839"/>
<area shape="rect" href="classOpenAPI_1_1OAILanelet__info.html#ae71cdbd0f92de4b223a654f03d2112c6" title=" " alt="" coords="729,791,908,832"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_acd0ec98c5efc93aadb38563e3b98d1bb_icgraph.png" border="0" usemap="#aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_acd0ec98c5efc93aadb38563e3b98d1bb_icgraph" alt=""/></div>
<map name="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_acd0ec98c5efc93aadb38563e3b98d1bb_icgraph" id="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_acd0ec98c5efc93aadb38563e3b98d1bb_icgraph">
<area shape="rect" title="Schedule all Entering Vehicles (EVs). Method first organizes all EVs into lists based on their entry ..." alt="" coords="237,5,421,61"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a930961b3e285b2a2d08f4276ffa22658" title="Method to schedule vehicles. Given and empty intersection_schedule object and a map of vehicles and v..." alt="" coords="5,5,189,61"/>
</map>
</div>

</div>
</div>
<a id="a0729a968f0b8f0b0ec11453157df101c" name="a0729a968f0b8f0b0ec11453157df101c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0729a968f0b8f0b0ec11453157df101c">&#9670;&nbsp;</a></span>schedule_rdvs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void streets_vehicle_scheduler::all_stop_vehicle_scheduler::schedule_rdvs </td>
          <td>(</td>
          <td class="paramtype">std::list&lt; <a class="el" href="structstreets__vehicles_1_1vehicle.html">streets_vehicles::vehicle</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>rdvs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::shared_ptr&lt; <a class="el" href="structstreets__vehicle__scheduler_1_1all__stop__intersection__schedule.html">all_stop_intersection_schedule</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>schedule</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Schedule all currently Ready to Depart Vehicles (RDVs). Consider all possible RDV departure orders. Select the one with the least calculated delay. Delay for a given vehicle is the difference between Entering Time and Stopping Time. Method assumes <a class="el" href="structstreets__vehicle__scheduler_1_1intersection__schedule.html" title="Struct to store vehicle schedules for all vehicle in an intersection. Includes a timestamp in millise...">intersection_schedule</a> only populated with DV(s) vehicle_schedules. Method will add vehicle_schedule(s) for each RDV in vector. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rdvs</td><td>vector of unscheduled RDVs </td></tr>
    <tr><td class="paramname">schedule</td><td><a class="el" href="structstreets__vehicle__scheduler_1_1all__stop__intersection__schedule.html" title="Struct to store vehicle schedules for all vehicle in an intersection. Includes a timestamp in millise...">all_stop_intersection_schedule</a> to add RDV scheduling information to. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00171">171</a> of file <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html">all_stop_vehicle_scheduler.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  171</span>                                                                                                                                                          {</div>
<div class="line"><span class="lineno">  172</span>        <span class="comment">// Vector of considered intersection_schedule_options</span></div>
<div class="line"><span class="lineno">  173</span>        std::vector&lt;std::shared_ptr&lt;all_stop_intersection_schedule&gt;&gt; schedule_options;</div>
<div class="line"><span class="lineno">  174</span>        <span class="comment">// Sort rdvs ascending order based on departure position</span></div>
<div class="line"><span class="lineno">  175</span>        rdvs.sort(<a class="code hl_function" href="namespacestreets__vehicle__scheduler.html#aa9f946d7c588b2697fd379fbed72f382">departure_position_comparator</a>);</div>
<div class="line"><span class="lineno">  176</span>        <span class="comment">// Earliest possible departure position for RDVs is last scheduled DV departure position +1 </span></div>
<div class="line"><span class="lineno">  177</span>        <span class="keywordtype">int</span> starting_departure_position;</div>
<div class="line"><span class="lineno">  178</span>        <span class="keywordflow">if</span> ( !schedule-&gt;vehicle_schedules.empty() ) {</div>
<div class="line"><span class="lineno">  179</span>            starting_departure_position = schedule-&gt;vehicle_schedules.back().dp +1;</div>
<div class="line"><span class="lineno">  180</span>        }</div>
<div class="line"><span class="lineno">  181</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  182</span>            <span class="comment">// If no scheduled DVs, first available departure position is 1</span></div>
<div class="line"><span class="lineno">  183</span>            starting_departure_position =  1;</div>
<div class="line"><span class="lineno">  184</span>        }</div>
<div class="line"><span class="lineno">  185</span>        SPDLOG_TRACE(<span class="stringliteral">&quot;Staring the schedule RDVs from departure index {0}!&quot;</span>, starting_departure_position );</div>
<div class="line"><span class="lineno">  186</span>        <span class="comment">// TODO: for 8 possible approaches this may need to be optimized (greedy search)</span></div>
<div class="line"><span class="lineno">  187</span>        <span class="keywordflow">do</span> { </div>
<div class="line"><span class="lineno">  188</span>            SPDLOG_TRACE(<span class="stringliteral">&quot;Considering scheduling options with {0} as first RDV.&quot;</span> ,rdvs.front()._id);</div>
<div class="line"><span class="lineno">  189</span>            <span class="comment">// update schedule option to include already scheduled vehicles</span></div>
<div class="line"><span class="lineno">  190</span>            <span class="keyword">auto</span> option = std::make_shared&lt;all_stop_intersection_schedule&gt; (*schedule);</div>
<div class="line"><span class="lineno">  191</span>            <span class="comment">// consider current permutation of RDV departure order</span></div>
<div class="line"><span class="lineno">  192</span>            <span class="keywordtype">bool</span> valid_option =  <a class="code hl_function" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a77c415e3ef29a00acc67c7aac87a270b">consider_departure_position_permutation</a>(rdvs, option, starting_departure_position);</div>
<div class="line"><span class="lineno">  193</span>            SPDLOG_TRACE(<span class="stringliteral">&quot;Scheduling option is valid : {0}.&quot;</span>, valid_option);</div>
<div class="line"><span class="lineno">  194</span>            <span class="comment">// is permutation valid in terms of flexibility limit? Has any vehicle&#39;s departure index changed by more</span></div>
<div class="line"><span class="lineno">  195</span>            <span class="comment">// than the current flexibility limit.</span></div>
<div class="line"><span class="lineno">  196</span>            <span class="keywordflow">if</span> ( valid_option ) {</div>
<div class="line"><span class="lineno">  197</span>                schedule_options.push_back(option);</div>
<div class="line"><span class="lineno">  198</span>            }</div>
<div class="line"><span class="lineno">  199</span> </div>
<div class="line"><span class="lineno">  200</span>        }</div>
<div class="line"><span class="lineno">  201</span>        <span class="keywordflow">while</span> (std::next_permutation( rdvs.begin(), rdvs.end(), <a class="code hl_function" href="namespacestreets__vehicle__scheduler.html#aa9f946d7c588b2697fd379fbed72f382">departure_position_comparator</a>));</div>
<div class="line"><span class="lineno">  202</span>        <span class="comment">// If no valid options were added.</span></div>
<div class="line"><span class="lineno">  203</span>        <span class="keywordflow">if</span> ( schedule_options.empty()) {</div>
<div class="line"><span class="lineno">  204</span>            <span class="keywordflow">throw</span> scheduling_exception(<span class="stringliteral">&quot;There are no valid schedules for RDVs! Please check flexibility_limit setting.&quot;</span>);</div>
<div class="line"><span class="lineno">  205</span>        }</div>
<div class="line"><span class="lineno">  206</span>        <span class="comment">// Sort in ascending order based on delay.</span></div>
<div class="line"><span class="lineno">  207</span>        std::sort(schedule_options.begin(), schedule_options.end(), <a class="code hl_function" href="namespacestreets__vehicle__scheduler.html#ab6598f6bcdf2edaadecc3f4b68debb66">delay_comparator</a>);</div>
<div class="line"><span class="lineno">  208</span> </div>
<div class="line"><span class="lineno">  209</span>        SPDLOG_TRACE(<span class="stringliteral">&quot;All scheduling options, the option with RDV {0} first has the least delay of {1}.&quot;</span>,</div>
<div class="line"><span class="lineno">  210</span>                                schedule_options.front()-&gt;vehicle_schedules[starting_departure_position-1].v_id,</div>
<div class="line"><span class="lineno">  211</span>                                schedule_options.front()-&gt;get_delay());</div>
<div class="line"><span class="lineno">  212</span>       </div>
<div class="line"><span class="lineno">  213</span>        <span class="comment">// Add scheduled RDVs starting at last scheduled DV position to schedule</span></div>
<div class="line"><span class="lineno">  214</span>        <span class="keywordflow">for</span> ( <span class="keyword">const</span> <span class="keyword">auto</span> &amp;sched : schedule_options.front()-&gt;vehicle_schedules){</div>
<div class="line"><span class="lineno">  215</span>            <span class="comment">// starting at first available departure position for dvs, add rdvs from best option to current schedule</span></div>
<div class="line"><span class="lineno">  216</span>            <span class="keywordflow">if</span> (starting_departure_position &lt;= sched.dp ) {</div>
<div class="line"><span class="lineno">  217</span>                <span class="comment">// if rdv was granted access in this schedule add it to the list of RDVs granted access</span></div>
<div class="line"><span class="lineno">  218</span>                <span class="keywordflow">if</span> ( sched.access ) {</div>
<div class="line"><span class="lineno">  219</span>                        <a class="code hl_struct" href="structstreets__vehicles_1_1vehicle.html">streets_vehicles::vehicle</a> rdv_granted_access = <a class="code hl_function" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a0cf6941cc406bbd51889c129231e9443">get_vehicle_with_id</a>( rdvs, sched.v_id );</div>
<div class="line"><span class="lineno">  220</span>                        SPDLOG_TRACE(<span class="stringliteral">&quot;Added RDV {0} to list of RDVs previously granted access.&quot;</span>, rdv_granted_access.<a class="code hl_variable" href="structstreets__vehicles_1_1vehicle.html#a470605f661a8f625329ebbb10888e2b8">_id</a>);</div>
<div class="line"><span class="lineno">  221</span>                        <a class="code hl_variable" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a77c53828e29e53a9a7ff752afb65b549">rdvs_previously_granted_access</a>.push_back(rdv_granted_access);</div>
<div class="line"><span class="lineno">  222</span>                }</div>
<div class="line"><span class="lineno">  223</span>                schedule-&gt;vehicle_schedules.push_back( sched );</div>
<div class="line"><span class="lineno">  224</span>                starting_departure_position ++;</div>
<div class="line"><span class="lineno">  225</span>            }</div>
<div class="line"><span class="lineno">  226</span>        }</div>
<div class="line"><span class="lineno">  227</span>        SPDLOG_TRACE(<span class="stringliteral">&quot;Schedule for RDVs: \n&quot;</span> + schedule-&gt;toCSV());</div>
<div class="line"><span class="lineno">  228</span>    }</div>
<div class="ttc" id="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_html_a0cf6941cc406bbd51889c129231e9443"><div class="ttname"><a href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a0cf6941cc406bbd51889c129231e9443">streets_vehicle_scheduler::all_stop_vehicle_scheduler::get_vehicle_with_id</a></div><div class="ttdeci">streets_vehicles::vehicle get_vehicle_with_id(const std::list&lt; streets_vehicles::vehicle &gt; &amp;veh_list, const std::string &amp;veh_id) const</div><div class="ttdoc">Given a list of vehicles and a vehicle id, this method returns the vehicle with a matching vehicle id...</div><div class="ttdef"><b>Definition:</b> <a href="all__stop__vehicle__scheduler_8cpp_source.html#l00595">all_stop_vehicle_scheduler.cpp:595</a></div></div>
<div class="ttc" id="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_html_a77c415e3ef29a00acc67c7aac87a270b"><div class="ttname"><a href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a77c415e3ef29a00acc67c7aac87a270b">streets_vehicle_scheduler::all_stop_vehicle_scheduler::consider_departure_position_permutation</a></div><div class="ttdeci">bool consider_departure_position_permutation(const std::list&lt; streets_vehicles::vehicle &gt; &amp;rdvs, const std::shared_ptr&lt; all_stop_intersection_schedule &gt; &amp;option, int starting_departure_position) const</div><div class="ttdoc">Creates and intersection schedule for a given RDV departure order. RDV departure order is based on rd...</div><div class="ttdef"><b>Definition:</b> <a href="all__stop__vehicle__scheduler_8cpp_source.html#l00432">all_stop_vehicle_scheduler.cpp:432</a></div></div>
<div class="ttc" id="anamespacestreets__vehicle__scheduler_html_ab6598f6bcdf2edaadecc3f4b68debb66"><div class="ttname"><a href="namespacestreets__vehicle__scheduler.html#ab6598f6bcdf2edaadecc3f4b68debb66">streets_vehicle_scheduler::delay_comparator</a></div><div class="ttdeci">bool delay_comparator(const std::shared_ptr&lt; all_stop_intersection_schedule &gt; &amp;prev_sched, const std::shared_ptr&lt; all_stop_intersection_schedule &gt; &amp;next_sched)</div><div class="ttdoc">Comparator for intersection_schedule collections. Used for sorting intersection_schedule objects in a...</div><div class="ttdef"><b>Definition:</b> <a href="vehicle__sorting_8cpp_source.html#l00033">vehicle_sorting.cpp:33</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="vehicle_8h_source.html#l00037">streets_vehicles::vehicle::_id</a>, <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00432">consider_departure_position_permutation()</a>, <a class="el" href="vehicle__sorting_8cpp_source.html#l00033">streets_vehicle_scheduler::delay_comparator()</a>, <a class="el" href="vehicle__sorting_8cpp_source.html#l00004">streets_vehicle_scheduler::departure_position_comparator()</a>, <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00595">get_vehicle_with_id()</a>, and <a class="el" href="all__stop__vehicle__scheduler_8h_source.html#l00027">rdvs_previously_granted_access</a>.</p>

<p class="reference">Referenced by <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00009">schedule_vehicles()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a0729a968f0b8f0b0ec11453157df101c_cgraph.png" border="0" usemap="#aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a0729a968f0b8f0b0ec11453157df101c_cgraph" alt=""/></div>
<map name="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a0729a968f0b8f0b0ec11453157df101c_cgraph" id="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a0729a968f0b8f0b0ec11453157df101c_cgraph">
<area shape="rect" title="Schedule all currently Ready to Depart Vehicles (RDVs). Consider all possible RDV departure orders...." alt="" coords="5,250,189,306"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a77c415e3ef29a00acc67c7aac87a270b" title="Creates and intersection schedule for a given RDV departure order. RDV departure order is based on rd..." alt="" coords="245,129,436,200"/>
<area shape="rect" href="namespacestreets__vehicle__scheduler.html#ab6598f6bcdf2edaadecc3f4b68debb66" title="Comparator for intersection_schedule collections. Used for sorting intersection_schedule objects in a..." alt="" coords="254,224,427,265"/>
<area shape="rect" href="namespacestreets__vehicle__scheduler.html#aa9f946d7c588b2697fd379fbed72f382" title="Comparator for vehicle collections. Used for sorting vehicle objects in a collection in ascending ord..." alt="" coords="237,289,444,331"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a0cf6941cc406bbd51889c129231e9443" title="Given a list of vehicles and a vehicle id, this method returns the vehicle with a matching vehicle id..." alt="" coords="249,354,433,410"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a15b4da36dba827263da4c844028c6db1" title="Estimate clearance time any vehicle given it&#39;s link lanelet information." alt="" coords="492,57,676,113"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#aa06721804b8a4075b98c2e8ad40c84da" title="Given a link lane and a vector of vehicle schedules, this method returns a pointer to a vehicle sched..." alt="" coords="492,137,676,193"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#af2c80eb87e5a9cabaad660544003663c" title="Helper method to get link lane OAILanelet_info from intersection information given a vehicle." alt="" coords="497,217,671,273"/>
<area shape="rect" href="classOpenAPI_1_1OAILanelet__info.html#abc1c4d5d24a2dafb175874ecad09cfad" title=" " alt="" coords="740,5,887,47"/>
<area shape="rect" href="classOpenAPI_1_1OAILanelet__info.html#a9ed2860829d5aeba3062f26e78afcbdc" title=" " alt="" coords="740,71,887,112"/>
<area shape="rect" href="classOpenAPI_1_1OAILanelet__info.html#ae71cdbd0f92de4b223a654f03d2112c6" title=" " alt="" coords="724,144,903,185"/>
<area shape="rect" href="classOpenAPI_1_1OAILanelet__info.html#a489d1a475686159298697bccabd2bd52" title=" " alt="" coords="740,216,887,257"/>
<area shape="rect" href="ntcip__1202__ext_8h.html#a576de7b60eacee3f1a70393a005502cd" title="Returns std::string representation of ntcip_1202_ext message including phase_times array." alt="" coords="777,282,849,309"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a0729a968f0b8f0b0ec11453157df101c_icgraph.png" border="0" usemap="#aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a0729a968f0b8f0b0ec11453157df101c_icgraph" alt=""/></div>
<map name="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a0729a968f0b8f0b0ec11453157df101c_icgraph" id="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a0729a968f0b8f0b0ec11453157df101c_icgraph">
<area shape="rect" title="Schedule all currently Ready to Depart Vehicles (RDVs). Consider all possible RDV departure orders...." alt="" coords="237,5,421,61"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a930961b3e285b2a2d08f4276ffa22658" title="Method to schedule vehicles. Given and empty intersection_schedule object and a map of vehicles and v..." alt="" coords="5,5,189,61"/>
</map>
</div>

</div>
</div>
<a id="a930961b3e285b2a2d08f4276ffa22658" name="a930961b3e285b2a2d08f4276ffa22658"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a930961b3e285b2a2d08f4276ffa22658">&#9670;&nbsp;</a></span>schedule_vehicles()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void streets_vehicle_scheduler::all_stop_vehicle_scheduler::schedule_vehicles </td>
          <td>(</td>
          <td class="paramtype">std::unordered_map&lt; std::string, <a class="el" href="structstreets__vehicles_1_1vehicle.html">streets_vehicles::vehicle</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>vehicles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="structstreets__vehicle__scheduler_1_1intersection__schedule.html">intersection_schedule</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>schedule</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Method to schedule vehicles. Given and empty <a class="el" href="structstreets__vehicle__scheduler_1_1intersection__schedule.html" title="Struct to store vehicle schedules for all vehicle in an intersection. Includes a timestamp in millise...">intersection_schedule</a> object and a map of vehicles and vehicle ids. This method will populate the intersection schedule with a schedule for each EV,RDV and DV in the vehicle map based on UC 1 scheduling logic to minimize delay for a all way stop intersection. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">vehicles</td><td>A map of the vehicles to schedule, with vehicle id as keys </td></tr>
    <tr><td class="paramname">schedule</td><td>An all_stop_intersection schedule object populated with a vehicle schedule for each EV,RDV and DV in the map. </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#a68ae44ddfa8ae16f298b2798ed93b9d2">streets_vehicle_scheduler::vehicle_scheduler</a>.</p>

<p class="definition">Definition at line <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00009">9</a> of file <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html">all_stop_vehicle_scheduler.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   10</span>                                                                                                           {</div>
<div class="line"><span class="lineno">   11</span>        </div>
<div class="line"><span class="lineno">   12</span>        <span class="keywordflow">try</span> </div>
<div class="line"><span class="lineno">   13</span>        {</div>
<div class="line"><span class="lineno">   14</span>            <span class="keyword">auto</span> schedule = std::dynamic_pointer_cast&lt;all_stop_intersection_schedule&gt; (i_sched);</div>
<div class="line"><span class="lineno">   15</span> </div>
<div class="line"><span class="lineno">   16</span>            <span class="keywordflow">if</span> ( vehicles.empty() ) {</div>
<div class="line"><span class="lineno">   17</span>                SPDLOG_DEBUG(<span class="stringliteral">&quot;No vehicles to schedule.&quot;</span>);</div>
<div class="line"><span class="lineno">   18</span>                <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">   19</span>            }</div>
<div class="line"><span class="lineno">   20</span>            <span class="comment">// Estimate Vehicles at common time </span></div>
<div class="line"><span class="lineno">   21</span>            <a class="code hl_function" href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#a85947f43b293504a108619374c0c0dae">estimate_vehicles_at_common_time</a>( vehicles, schedule-&gt;timestamp);</div>
<div class="line"><span class="lineno">   22</span>            <span class="comment">// Create vectors of EVs RDVs and DVs</span></div>
<div class="line"><span class="lineno">   23</span>            std::list&lt;streets_vehicles::vehicle&gt; DVs;</div>
<div class="line"><span class="lineno">   24</span>            std::list&lt;streets_vehicles::vehicle&gt; RDVs;</div>
<div class="line"><span class="lineno">   25</span> </div>
<div class="line"><span class="lineno">   26</span>            std::list&lt;streets_vehicles::vehicle&gt; EVs;</div>
<div class="line"><span class="lineno">   27</span>            <span class="keywordflow">for</span> ( <span class="keyword">const</span> <span class="keyword">auto</span> &amp;[v_id, veh] : vehicles) {</div>
<div class="line"><span class="lineno">   28</span>                <span class="keywordflow">if</span> ( veh._cur_state == <a class="code hl_enumvalue" href="namespacestreets__vehicles.html#a41f5c896d8020c141aa96235cf1405aca58d6a88f13e2db7f5059c41047876f00">streets_vehicles::vehicle_state::DV</a> ) {</div>
<div class="line"><span class="lineno">   29</span>                    <span class="comment">// Once vehicle is considered as DV it has confirmed that it has received access.</span></div>
<div class="line"><span class="lineno">   30</span>                    <span class="keywordflow">if</span> ( <a class="code hl_function" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a35eb7b98052f4ef88850471478fcdddb">is_rdv_previously_granted_access</a>(veh) ) {</div>
<div class="line"><span class="lineno">   31</span>                        <a class="code hl_function" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a223e57041ae7ca6c4810877c8c74a49e">remove_rdv_previously_granted_access</a>(veh);</div>
<div class="line"><span class="lineno">   32</span>                    }</div>
<div class="line"><span class="lineno">   33</span>                    DVs.push_back(veh);</div>
<div class="line"><span class="lineno">   34</span>                }</div>
<div class="line"><span class="lineno">   35</span>                <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( veh._cur_state == <a class="code hl_enumvalue" href="namespacestreets__vehicles.html#a41f5c896d8020c141aa96235cf1405acab08ef04fe84cf4f6645fef073717f36f">streets_vehicles::vehicle_state::RDV</a> ) {</div>
<div class="line"><span class="lineno">   36</span>                    <span class="comment">// Consider any RDVs previously granted access as a DV</span></div>
<div class="line"><span class="lineno">   37</span>                    <span class="keywordflow">if</span> ( <a class="code hl_function" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a35eb7b98052f4ef88850471478fcdddb">is_rdv_previously_granted_access</a>(veh) ) {</div>
<div class="line"><span class="lineno">   38</span>                        DVs.push_back(veh);</div>
<div class="line"><span class="lineno">   39</span>                    } </div>
<div class="line"><span class="lineno">   40</span>                    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">   41</span>                        RDVs.push_back(veh);</div>
<div class="line"><span class="lineno">   42</span>                    }</div>
<div class="line"><span class="lineno">   43</span>                }</div>
<div class="line"><span class="lineno">   44</span>                <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( veh._cur_state == <a class="code hl_enumvalue" href="namespacestreets__vehicles.html#a41f5c896d8020c141aa96235cf1405aca834d41112f2943c357f660165b6eb6de">streets_vehicles::vehicle_state::EV</a>) {</div>
<div class="line"><span class="lineno">   45</span>                    EVs.push_back(veh);</div>
<div class="line"><span class="lineno">   46</span>                }</div>
<div class="line"><span class="lineno">   47</span>            }</div>
<div class="line"><span class="lineno">   48</span>            </div>
<div class="line"><span class="lineno">   49</span>            SPDLOG_DEBUG(<span class="stringliteral">&quot;Vehicles to schedule are DVs : {0}, RDVs : {1}, EVs {2} &quot;</span>, DVs.size(), RDVs.size(), EVs.size());</div>
<div class="line"><span class="lineno">   50</span> </div>
<div class="line"><span class="lineno">   51</span>            <span class="comment">// Schedule DVs</span></div>
<div class="line"><span class="lineno">   52</span>            <span class="keywordflow">if</span> ( !DVs.empty() )</div>
<div class="line"><span class="lineno">   53</span>                <a class="code hl_function" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a16230014f5d43ef2546a54496c08a9cd">schedule_dvs</a>( DVs, schedule);</div>
<div class="line"><span class="lineno">   54</span>            <span class="comment">// Schedule RDVs</span></div>
<div class="line"><span class="lineno">   55</span>            <span class="keywordflow">if</span> ( !RDVs.empty() )</div>
<div class="line"><span class="lineno">   56</span>                <a class="code hl_function" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a0729a968f0b8f0b0ec11453157df101c">schedule_rdvs</a>( RDVs, schedule);</div>
<div class="line"><span class="lineno">   57</span>            <span class="comment">// Schedule EVs</span></div>
<div class="line"><span class="lineno">   58</span>            <span class="keywordflow">if</span> ( !EVs.empty() )</div>
<div class="line"><span class="lineno">   59</span>                <a class="code hl_function" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#acd0ec98c5efc93aadb38563e3b98d1bb">schedule_evs</a>( EVs, schedule);</div>
<div class="line"><span class="lineno">   60</span>        </div>
<div class="line"><span class="lineno">   61</span>        }</div>
<div class="line"><span class="lineno">   62</span>        <span class="keywordflow">catch</span> ( <span class="keyword">const</span> <a class="code hl_class" href="classstreets__service_1_1streets__configuration__exception.html">streets_service::streets_configuration_exception</a> &amp;ex ) {</div>
<div class="line"><span class="lineno">   63</span>            SPDLOG_ERROR(<span class="stringliteral">&quot;all stop scheduler failure: {0} &quot;</span>, ex.what());</div>
<div class="line"><span class="lineno">   64</span>        }</div>
<div class="line"><span class="lineno">   65</span> </div>
<div class="line"><span class="lineno">   66</span>    }</div>
<div class="ttc" id="aclassstreets__service_1_1streets__configuration__exception_html"><div class="ttname"><a href="classstreets__service_1_1streets__configuration__exception.html">streets_service::streets_configuration_exception</a></div><div class="ttdoc">Streets Configuration Exception thrown when manifest.json configuration files are incorrectly formatt...</div><div class="ttdef"><b>Definition:</b> <a href="streets__configuration__exception_8h_source.html#l00011">streets_configuration_exception.h:11</a></div></div>
<div class="ttc" id="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_html_a0729a968f0b8f0b0ec11453157df101c"><div class="ttname"><a href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a0729a968f0b8f0b0ec11453157df101c">streets_vehicle_scheduler::all_stop_vehicle_scheduler::schedule_rdvs</a></div><div class="ttdeci">void schedule_rdvs(std::list&lt; streets_vehicles::vehicle &gt; &amp;rdvs, const std::shared_ptr&lt; all_stop_intersection_schedule &gt; &amp;schedule)</div><div class="ttdoc">Schedule all currently Ready to Depart Vehicles (RDVs). Consider all possible RDV departure orders....</div><div class="ttdef"><b>Definition:</b> <a href="all__stop__vehicle__scheduler_8cpp_source.html#l00171">all_stop_vehicle_scheduler.cpp:171</a></div></div>
<div class="ttc" id="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_html_a16230014f5d43ef2546a54496c08a9cd"><div class="ttname"><a href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a16230014f5d43ef2546a54496c08a9cd">streets_vehicle_scheduler::all_stop_vehicle_scheduler::schedule_dvs</a></div><div class="ttdeci">void schedule_dvs(std::list&lt; streets_vehicles::vehicle &gt; &amp;dvs, const std::shared_ptr&lt; all_stop_intersection_schedule &gt; &amp;schedule) const</div><div class="ttdoc">Schedule all currently Departing Vehicle (DVs). Estimate intersection departure times (dt's) for each...</div><div class="ttdef"><b>Definition:</b> <a href="all__stop__vehicle__scheduler_8cpp_source.html#l00117">all_stop_vehicle_scheduler.cpp:117</a></div></div>
<div class="ttc" id="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_html_a223e57041ae7ca6c4810877c8c74a49e"><div class="ttname"><a href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a223e57041ae7ca6c4810877c8c74a49e">streets_vehicle_scheduler::all_stop_vehicle_scheduler::remove_rdv_previously_granted_access</a></div><div class="ttdeci">void remove_rdv_previously_granted_access(const streets_vehicles::vehicle &amp;veh)</div><div class="ttdoc">This method will remove a vehicle (DV) once it's updates reflect that is has received access from the...</div><div class="ttdef"><b>Definition:</b> <a href="all__stop__vehicle__scheduler_8cpp_source.html#l00567">all_stop_vehicle_scheduler.cpp:567</a></div></div>
<div class="ttc" id="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_html_acd0ec98c5efc93aadb38563e3b98d1bb"><div class="ttname"><a href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#acd0ec98c5efc93aadb38563e3b98d1bb">streets_vehicle_scheduler::all_stop_vehicle_scheduler::schedule_evs</a></div><div class="ttdeci">void schedule_evs(std::list&lt; streets_vehicles::vehicle &gt; &amp;evs, const std::shared_ptr&lt; all_stop_intersection_schedule &gt; &amp;schedule) const</div><div class="ttdoc">Schedule all Entering Vehicles (EVs). Method first organizes all EVs into lists based on their entry ...</div><div class="ttdef"><b>Definition:</b> <a href="all__stop__vehicle__scheduler_8cpp_source.html#l00230">all_stop_vehicle_scheduler.cpp:230</a></div></div>
<div class="ttc" id="aclassstreets__vehicle__scheduler_1_1vehicle__scheduler_html_a85947f43b293504a108619374c0c0dae"><div class="ttname"><a href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#a85947f43b293504a108619374c0c0dae">streets_vehicle_scheduler::vehicle_scheduler::estimate_vehicles_at_common_time</a></div><div class="ttdeci">void estimate_vehicles_at_common_time(std::unordered_map&lt; std::string, streets_vehicles::vehicle &gt; &amp;vehicles, const u_int64_t timestamp) const</div><div class="ttdoc">Method to estimate all vehicle's speed and location at a common future time. The time needs to be tim...</div><div class="ttdef"><b>Definition:</b> <a href="vehicle__scheduler_8cpp_source.html#l00049">vehicle_scheduler.cpp:49</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacestreets__vehicles.html#a41f5c896d8020c141aa96235cf1405aca58d6a88f13e2db7f5059c41047876f00">streets_vehicles::DV</a>, <a class="el" href="vehicle__scheduler_8cpp_source.html#l00049">streets_vehicle_scheduler::vehicle_scheduler::estimate_vehicles_at_common_time()</a>, <a class="el" href="namespacestreets__vehicles.html#a41f5c896d8020c141aa96235cf1405aca834d41112f2943c357f660165b6eb6de">streets_vehicles::EV</a>, <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00580">is_rdv_previously_granted_access()</a>, <a class="el" href="namespacestreets__vehicles.html#a41f5c896d8020c141aa96235cf1405acab08ef04fe84cf4f6645fef073717f36f">streets_vehicles::RDV</a>, <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00567">remove_rdv_previously_granted_access()</a>, <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00117">schedule_dvs()</a>, <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00230">schedule_evs()</a>, and <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00171">schedule_rdvs()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a930961b3e285b2a2d08f4276ffa22658_cgraph.png" border="0" usemap="#aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a930961b3e285b2a2d08f4276ffa22658_cgraph" alt=""/></div>
<map name="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a930961b3e285b2a2d08f4276ffa22658_cgraph" id="aclassstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler_a930961b3e285b2a2d08f4276ffa22658_cgraph">
<area shape="rect" title="Method to schedule vehicles. Given and empty intersection_schedule object and a map of vehicles and v..." alt="" coords="5,637,189,693"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#a85947f43b293504a108619374c0c0dae" title="Method to estimate all vehicle&#39;s speed and location at a common future time. The time needs to be tim..." alt="" coords="273,357,461,413"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a35eb7b98052f4ef88850471478fcdddb" title="Method to determine whether vehicle was granted access to the intersection in previous schedules...." alt="" coords="545,603,772,659"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a223e57041ae7ca6c4810877c8c74a49e" title="This method will remove a vehicle (DV) once it&#39;s updates reflect that is has received access from the..." alt="" coords="237,894,497,950"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a16230014f5d43ef2546a54496c08a9cd" title="Schedule all currently Departing Vehicle (DVs). Estimate intersection departure times (dt&#39;s) for each..." alt="" coords="275,669,459,725"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#acd0ec98c5efc93aadb38563e3b98d1bb" title="Schedule all Entering Vehicles (EVs). Method first organizes all EVs into lists based on their entry ..." alt="" coords="275,437,459,493"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a0729a968f0b8f0b0ec11453157df101c" title="Schedule all currently Ready to Depart Vehicles (RDVs). Consider all possible RDV departure orders...." alt="" coords="275,814,459,870"/>
<area shape="rect" href="namespacestreets__vehicle__scheduler.html#aa9f946d7c588b2697fd379fbed72f382" title="Comparator for vehicle collections. Used for sorting vehicle objects in a collection in ascending ord..." alt="" coords="555,785,762,827"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a15b4da36dba827263da4c844028c6db1" title="Estimate clearance time any vehicle given it&#39;s link lanelet information." alt="" coords="823,734,1007,790"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#af2c80eb87e5a9cabaad660544003663c" title="Helper method to get link lane OAILanelet_info from intersection information given a vehicle." alt="" coords="828,574,1001,630"/>
<area shape="rect" href="classOpenAPI_1_1OAILanelet__info.html#abc1c4d5d24a2dafb175874ecad09cfad" title=" " alt="" coords="1073,741,1220,783"/>
<area shape="rect" href="classOpenAPI_1_1OAILanelet__info.html#a9ed2860829d5aeba3062f26e78afcbdc" title=" " alt="" coords="1073,501,1220,543"/>
<area shape="rect" href="classOpenAPI_1_1OAILanelet__info.html#a489d1a475686159298697bccabd2bd52" title=" " alt="" coords="1073,211,1220,252"/>
<area shape="rect" href="ntcip__1202__ext_8h.html#a576de7b60eacee3f1a70393a005502cd" title="Returns std::string representation of ntcip_1202_ext message including phase_times array." alt="" coords="1111,363,1183,390"/>
<area shape="rect" href="namespacestreets__vehicle__scheduler.html#ab550673e6a269f9f374ca3ca7ff6ba82" title="Comparator for vehicle collections. Used for sorting vehicle objects in a collection in ascending ord..." alt="" coords="572,408,745,449"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#ad5f0462b2d82168b7b71dcfd15eaa7f2" title="Method to use vehicle kinematic information to estimate earliest possible time stopping time for a ve..." alt="" coords="567,261,751,332"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a9b5ee4ffdbd82cbf0c48f7981e7dff9c" title="Estimates an entering time (ET) for a given Entering Vehicle (EV). This method first searches among t..." alt="" coords="555,473,762,529"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a3ba56cc964002b21475a475995938b89" title="Method to calculate time interval necessary for accelerating to speed v_hat for a given vehicle...." alt="" coords="820,43,1009,99"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#afedbbc9205b39ceb8707d950b5c26556" title="Method to calculate time interval necessary for cruising at a constant speed v_hat (speed limit) grea..." alt="" coords="823,123,1007,179"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a63107a1e136be3a00f3a1445531904aa" title="Method to calculate time interval necessary for deceleration from v_hat to 0 to stop at stop bar...." alt="" coords="820,334,1009,390"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#ae5a42af1af20b06df9ad6af5d3170406" title="Method to calculate v_hat. This is the maximum speed reached between maximum speed reached between ac..." alt="" coords="823,414,1007,470"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#acab5956159419bef2c5391d59e3fe9ee" title="Calculate minumum distance required to speed up to lane speed limit with maximum acceleration,..." alt="" coords="823,494,1007,550"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html#af8916add714bef70d8f48efc0ccfca7b" title="Helper method to get entry lane OAILanelet_info from intersection information given a vehicle." alt="" coords="828,203,1001,259"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#aa06721804b8a4075b98c2e8ad40c84da" title="Given a link lane and a vector of vehicle schedules, this method returns a pointer to a vehicle sched..." alt="" coords="823,654,1007,710"/>
<area shape="rect" href="classOpenAPI_1_1OAILanelet__info.html#ae71cdbd0f92de4b223a654f03d2112c6" title=" " alt="" coords="1057,661,1236,703"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a77c415e3ef29a00acc67c7aac87a270b" title="Creates and intersection schedule for a given RDV departure order. RDV departure order is based on rd..." alt="" coords="563,931,754,1001"/>
<area shape="rect" href="namespacestreets__vehicle__scheduler.html#ab6598f6bcdf2edaadecc3f4b68debb66" title="Comparator for intersection_schedule collections. Used for sorting intersection_schedule objects in a..." alt="" coords="572,1025,745,1067"/>
<area shape="rect" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a0cf6941cc406bbd51889c129231e9443" title="Given a list of vehicles and a vehicle id, this method returns the vehicle with a matching vehicle id..." alt="" coords="567,850,751,906"/>
</map>
</div>

</div>
</div>
<a id="a37514ae17d938eff80b44304ab81cdda" name="a37514ae17d938eff80b44304ab81cdda"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37514ae17d938eff80b44304ab81cdda">&#9670;&nbsp;</a></span>set_entering_time_buffer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void streets_vehicle_scheduler::all_stop_vehicle_scheduler::set_entering_time_buffer </td>
          <td>(</td>
          <td class="paramtype">const uint64_t&#160;</td>
          <td class="paramname"><em>buffer</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the entering time buffer (ms). This value is used to account for the time it takes a vehicle stopped before the stop bar at an entry lane to exit the entry lane and enter the link lane once given access. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buffer</td><td>entering time buff in milliseconds. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a4b4afb653bc02a75e3c113806c9f4004" name="a4b4afb653bc02a75e3c113806c9f4004"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b4afb653bc02a75e3c113806c9f4004">&#9670;&nbsp;</a></span>set_flexibility_limit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void streets_vehicle_scheduler::all_stop_vehicle_scheduler::set_flexibility_limit </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>limit</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the flexibility limit. This limit controls how much departure position can change for any given vehicle between successive intersection schedule calculations. Each subsequent intersection scheduling calculation may have a slightly different departure order. This value controls how much this departure order can change.A value of 1 represents that vehicles departure position can change by one between two intersection schedules. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">limit</td><td>How much can departure position change between schedules for any vehicle. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00005">5</a> of file <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html">all_stop_vehicle_scheduler.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">    5</span>                                                                            {</div>
<div class="line"><span class="lineno">    6</span>        <a class="code hl_variable" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html#a004c41012f860faa9634e42c7d5740f7">flexibility_limit</a> = limit;</div>
<div class="line"><span class="lineno">    7</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="all__stop__vehicle__scheduler_8h_source.html#l00036">flexibility_limit</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a13124a205e1c6615f6a137c507b2a4eb" name="a13124a205e1c6615f6a137c507b2a4eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13124a205e1c6615f6a137c507b2a4eb">&#9670;&nbsp;</a></span>entering_time_buffer</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t streets_vehicle_scheduler::all_stop_vehicle_scheduler::entering_time_buffer = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Configurable time buffer in milliseconds for estimating the time it takes a vehicle to leave its entry lane and enter the intersection box once granted access to the intersection. </p>

<p class="definition">Definition at line <a class="el" href="all__stop__vehicle__scheduler_8h_source.html#l00032">32</a> of file <a class="el" href="all__stop__vehicle__scheduler_8h_source.html">all_stop_vehicle_scheduler.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00230">schedule_evs()</a>.</p>

</div>
</div>
<a id="a004c41012f860faa9634e42c7d5740f7" name="a004c41012f860faa9634e42c7d5740f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a004c41012f860faa9634e42c7d5740f7">&#9670;&nbsp;</a></span>flexibility_limit</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int streets_vehicle_scheduler::all_stop_vehicle_scheduler::flexibility_limit = 5</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Limits how much departure position for a given vehicle can change from current reported departure position. </p>

<p class="definition">Definition at line <a class="el" href="all__stop__vehicle__scheduler_8h_source.html#l00036">36</a> of file <a class="el" href="all__stop__vehicle__scheduler_8h_source.html">all_stop_vehicle_scheduler.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00432">consider_departure_position_permutation()</a>, and <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00005">set_flexibility_limit()</a>.</p>

</div>
</div>
<a id="a77c53828e29e53a9a7ff752afb65b549" name="a77c53828e29e53a9a7ff752afb65b549"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77c53828e29e53a9a7ff752afb65b549">&#9670;&nbsp;</a></span>rdvs_previously_granted_access</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::list&lt;<a class="el" href="structstreets__vehicles_1_1vehicle.html">streets_vehicles::vehicle</a>&gt; streets_vehicle_scheduler::all_stop_vehicle_scheduler::rdvs_previously_granted_access</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A list of RDV vehicles granted access by the <a class="el" href="classstreets__vehicle__scheduler_1_1vehicle__scheduler.html" title="Abstract Class for extend to implement scheduling business logic.">vehicle_scheduler</a>, who's updates do not yet reflect they have received access (still considered RDV by all_stop_status_intent_processor). We maintain this list to ensure we do not grant conflicting vehicles access to the intersection simultaneously in back to back scheduling calculations where the first RDV granted access in the first schedule has not yet provided a vehicle update the reflects this access by the time we calculate the second schedule. </p>

<p class="definition">Definition at line <a class="el" href="all__stop__vehicle__scheduler_8h_source.html#l00027">27</a> of file <a class="el" href="all__stop__vehicle__scheduler_8h_source.html">all_stop_vehicle_scheduler.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00580">is_rdv_previously_granted_access()</a>, <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00567">remove_rdv_previously_granted_access()</a>, and <a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html#l00171">schedule_rdvs()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>streets_utils/streets_vehicle_scheduler/include/<a class="el" href="all__stop__vehicle__scheduler_8h_source.html">all_stop_vehicle_scheduler.h</a></li>
<li>streets_utils/streets_vehicle_scheduler/src/<a class="el" href="all__stop__vehicle__scheduler_8cpp_source.html">all_stop_vehicle_scheduler.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacestreets__vehicle__scheduler.html">streets_vehicle_scheduler</a></li><li class="navelem"><a class="el" href="classstreets__vehicle__scheduler_1_1all__stop__vehicle__scheduler.html">all_stop_vehicle_scheduler</a></li>
    <li class="footer">Generated on Wed Feb 22 2023 18:23:21 for Carma-streets by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4 </li>
  </ul>
</div>
</body>
</html>
