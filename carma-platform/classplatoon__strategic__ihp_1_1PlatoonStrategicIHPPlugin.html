<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Carma-platform: platoon_strategic_ihp::PlatoonStrategicIHPPlugin Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Carma-platform<span id="projectnumber">&#160;v4.2.0</span>
   </div>
   <div id="projectbrief">CARMA Platform is built on robot operating system (ROS) and utilizes open source software (OSS) that enables Cooperative Driving Automation (CDA) features to allow Automated Driving Systems to interact and cooperate with infrastructure and other vehicles through communication.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">platoon_strategic_ihp::PlatoonStrategicIHPPlugin Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Class containing the logic for Strategic IHP Plugin. This class is responsible for all the negotiations as well as generating a maneuver msg.  
 <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="platoon__strategic__ihp_8h_source.html">platoon_strategic_ihp.h</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for platoon_strategic_ihp::PlatoonStrategicIHPPlugin:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin__coll__graph.png" border="0" usemap="#aplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_coll__map" alt="Collaboration graph"/></div>
<map name="aplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_coll__map" id="aplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_coll__map">
<area shape="rect" title="Class containing the logic for Strategic IHP Plugin. This class is responsible for all the negotiatio..." alt="" coords="1529,1789,1752,3275"/>
<area shape="rect" title=" " alt="" coords="5,1297,111,1375"/>
<area shape="rect" title=" " alt="" coords="135,1283,293,1389"/>
<area shape="rect" title=" " alt="" coords="317,1283,476,1389"/>
<area shape="rect" title=" " alt="" coords="500,1283,659,1389"/>
<area shape="rect" title=" " alt="" coords="683,1283,849,1389"/>
<area shape="rect" title=" " alt="" coords="874,1297,1082,1375"/>
<area shape="rect" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html" title="Stuct containing the algorithm configuration values for the yield_pluginConfig." alt="" coords="1367,292,1552,663"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html" title="Class containing the logic for platoon manager. It is responsible for keeping track of the platoon me..." alt="" coords="1966,960,2209,1712"/>
<area shape="rect" title=" " alt="" coords="972,5,1032,83"/>
<area shape="rect" href="classint.html" title=" " alt="" coords="1156,5,1195,83"/>
<area shape="rect" title=" " alt="" coords="1680,5,1735,83"/>
<area shape="rect" href="structplatoon__strategic__ihp_1_1ActionPlan.html" title="Struct for an action plan, which describes a transient joining activity." alt="" coords="2347,424,2492,531"/>
<area shape="rect" href="classbool.html" title=" " alt="" coords="2425,5,2472,83"/>
<area shape="rect" title=" " alt="" coords="2682,439,2786,516"/>
<area shape="rect" title=" " alt="" coords="3088,1297,3135,1375"/>
<area shape="rect" title=" " alt="" coords="3161,1290,3384,1382"/>
<area shape="rect" title=" " alt="" coords="3407,1297,3466,1375"/>
<area shape="rect" title=" " alt="" coords="2837,5,2911,83"/>
<area shape="rect" title=" " alt="" coords="3543,1297,3642,1375"/>
<area shape="rect" title=" " alt="" coords="2811,431,2999,523"/>
<area shape="rect" title=" " alt="" coords="1628,439,1683,516"/>
<area shape="rect" title=" " alt="" coords="1951,431,2119,523"/>
<area shape="rect" title=" " alt="" coords="2144,439,2241,516"/>
<area shape="rect" title=" " alt="" coords="2266,439,2322,516"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a16e212542f5668833ab6e6e7854143d2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a16e212542f5668833ab6e6e7854143d2">PlatoonStrategicIHPPlugin</a> (<a class="el" href="namespacecarma__wm.html#a3ac653959e0b6198cae274d68b343228">carma_wm::WorldModelConstPtr</a> wm, <a class="el" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html">PlatoonPluginConfig</a> config, <a class="el" href="namespaceplatoon__strategic__ihp.html#a71d95090a6e2bf7ed0b85142e9081f97">MobilityResponseCB</a> mobility_response_publisher, <a class="el" href="namespaceplatoon__strategic__ihp.html#ae866cb8846f2484b40536e455bfecaff">MobilityRequestCB</a> mobility_request_publisher, <a class="el" href="namespaceplatoon__strategic__ihp.html#a3c19ae18fa9f6083007c65b58293776a">MobilityOperationCB</a> mobility_operation_publisher, <a class="el" href="namespaceplatoon__strategic__ihp.html#a5402323f00d5763553277415c786fbca">PlatooningInfoCB</a> platooning_info_publisher, std::shared_ptr&lt; carma_ros2_utils::timers::TimerFactory &gt; timer_factory)</td></tr>
<tr class="memdesc:a16e212542f5668833ab6e6e7854143d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a16e212542f5668833ab6e6e7854143d2">More...</a><br /></td></tr>
<tr class="separator:a16e212542f5668833ab6e6e7854143d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f77f3abf67b6006fd6c9b965cbb1c10"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a9f77f3abf67b6006fd6c9b965cbb1c10">mob_op_cb</a> (const carma_v2x_msgs::msg::MobilityOperation::UniquePtr msg)</td></tr>
<tr class="memdesc:a9f77f3abf67b6006fd6c9b965cbb1c10"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback function for Mobility Operation Message.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a9f77f3abf67b6006fd6c9b965cbb1c10">More...</a><br /></td></tr>
<tr class="separator:a9f77f3abf67b6006fd6c9b965cbb1c10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a588b379b14e20af4e05cf4883c535c5a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a588b379b14e20af4e05cf4883c535c5a">mob_req_cb</a> (const carma_v2x_msgs::msg::MobilityRequest::UniquePtr msg)</td></tr>
<tr class="memdesc:a588b379b14e20af4e05cf4883c535c5a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback function for Mobility Request Message.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a588b379b14e20af4e05cf4883c535c5a">More...</a><br /></td></tr>
<tr class="separator:a588b379b14e20af4e05cf4883c535c5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaca0c4143be4a27041ab5ed90d2c624c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aaca0c4143be4a27041ab5ed90d2c624c">mob_resp_cb</a> (const carma_v2x_msgs::msg::MobilityResponse::UniquePtr msg)</td></tr>
<tr class="memdesc:aaca0c4143be4a27041ab5ed90d2c624c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback function for Mobility Response Message.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aaca0c4143be4a27041ab5ed90d2c624c">More...</a><br /></td></tr>
<tr class="separator:aaca0c4143be4a27041ab5ed90d2c624c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53cc42ead95e9734805f4b52de1e38eb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217">MobilityRequestResponse</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a53cc42ead95e9734805f4b52de1e38eb">handle_mob_req</a> (const carma_v2x_msgs::msg::MobilityRequest &amp;msg)</td></tr>
<tr class="memdesc:a53cc42ead95e9734805f4b52de1e38eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to the process and respond to the mobility request.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a53cc42ead95e9734805f4b52de1e38eb">More...</a><br /></td></tr>
<tr class="separator:a53cc42ead95e9734805f4b52de1e38eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aedb5c1f689806047c82f0c7b3ebe9c66"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aedb5c1f689806047c82f0c7b3ebe9c66">plan_maneuver_cb</a> (carma_planning_msgs::srv::PlanManeuvers::Request &amp;req, carma_planning_msgs::srv::PlanManeuvers::Response &amp;resp)</td></tr>
<tr class="memdesc:aedb5c1f689806047c82f0c7b3ebe9c66"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback function to the maneuver request.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aedb5c1f689806047c82f0c7b3ebe9c66">More...</a><br /></td></tr>
<tr class="separator:aedb5c1f689806047c82f0c7b3ebe9c66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf2d0fc255ea76f5b87a6490f9488df0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classint.html">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#abf2d0fc255ea76f5b87a6490f9488df0">findLaneletIndexFromPath</a> (<a class="el" href="classint.html">int</a> target_id, lanelet::routing::LaneletPath &amp;path)</td></tr>
<tr class="memdesc:abf2d0fc255ea76f5b87a6490f9488df0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find lanelet index from path.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#abf2d0fc255ea76f5b87a6490f9488df0">More...</a><br /></td></tr>
<tr class="separator:abf2d0fc255ea76f5b87a6490f9488df0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3cd4b02451fd0b0a25ed712e3331c36"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ad3cd4b02451fd0b0a25ed712e3331c36">findLaneWidth</a> ()</td></tr>
<tr class="memdesc:ad3cd4b02451fd0b0a25ed712e3331c36"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find lanelet width from local position.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ad3cd4b02451fd0b0a25ed712e3331c36">More...</a><br /></td></tr>
<tr class="separator:ad3cd4b02451fd0b0a25ed712e3331c36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68e48fa7d12584918a6764710d71a606"><td class="memItemLeft" align="right" valign="top">carma_planning_msgs::msg::Maneuver&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a68e48fa7d12584918a6764710d71a606">composeManeuverMessage</a> (double current_dist, double end_dist, double current_speed, double target_speed, <a class="el" href="classint.html">int</a> lane_id, rclcpp::Time &amp;current_time)</td></tr>
<tr class="memdesc:a68e48fa7d12584918a6764710d71a606"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find lanelet index from path.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a68e48fa7d12584918a6764710d71a606">More...</a><br /></td></tr>
<tr class="separator:a68e48fa7d12584918a6764710d71a606"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8378d85e905c51ff883b7fae4bf64367"><td class="memItemLeft" align="right" valign="top">carma_planning_msgs::msg::Maneuver&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a8378d85e905c51ff883b7fae4bf64367">composeLaneChangeManeuverMessage</a> (double current_dist, double end_dist, double current_speed, double target_speed, <a class="el" href="classint.html">int</a> starting_lane_id, <a class="el" href="classint.html">int</a> ending_lane_id, rclcpp::Time &amp;current_time)</td></tr>
<tr class="memdesc:a8378d85e905c51ff883b7fae4bf64367"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find start(current) and target(end) lanelet index from path to generate lane change maneuver message.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a8378d85e905c51ff883b7fae4bf64367">More...</a><br /></td></tr>
<tr class="separator:a8378d85e905c51ff883b7fae4bf64367"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a609dc105613d0c6ff89e1e955c8f6487"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a609dc105613d0c6ff89e1e955c8f6487">updateCurrentStatus</a> (carma_planning_msgs::msg::Maneuver maneuver, double &amp;speed, double &amp;current_progress, <a class="el" href="classint.html">int</a> &amp;lane_id)</td></tr>
<tr class="memdesc:a609dc105613d0c6ff89e1e955c8f6487"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update maneuver status based on prior plan.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a609dc105613d0c6ff89e1e955c8f6487">More...</a><br /></td></tr>
<tr class="separator:a609dc105613d0c6ff89e1e955c8f6487"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa81560488f89d886d731bcdbfebbbf37"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa81560488f89d886d731bcdbfebbbf37">pose_cb</a> (const geometry_msgs::msg::PoseStamped::UniquePtr msg)</td></tr>
<tr class="memdesc:aa81560488f89d886d731bcdbfebbbf37"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback function for current pose.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa81560488f89d886d731bcdbfebbbf37">More...</a><br /></td></tr>
<tr class="separator:aa81560488f89d886d731bcdbfebbbf37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac86657c9cd45018b1f8544e47be1e5dc"><td class="memItemLeft" align="right" valign="top">carma_planning_msgs::msg::PlatooningInfo&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ac86657c9cd45018b1f8544e47be1e5dc">composePlatoonInfoMsg</a> ()</td></tr>
<tr class="memdesc:ac86657c9cd45018b1f8544e47be1e5dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compose Platoon information message.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ac86657c9cd45018b1f8544e47be1e5dc">More...</a><br /></td></tr>
<tr class="separator:ac86657c9cd45018b1f8544e47be1e5dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adccd8434590f9faf212576cc5336e492"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adccd8434590f9faf212576cc5336e492">twist_cb</a> (const geometry_msgs::msg::TwistStamped::UniquePtr msg)</td></tr>
<tr class="memdesc:adccd8434590f9faf212576cc5336e492"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback for the twist subscriber, which will store latest twist locally.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adccd8434590f9faf212576cc5336e492">More...</a><br /></td></tr>
<tr class="separator:adccd8434590f9faf212576cc5336e492"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7c764725642e00ad7f55a683dd56d64"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa7c764725642e00ad7f55a683dd56d64">cmd_cb</a> (const geometry_msgs::msg::TwistStamped::UniquePtr msg)</td></tr>
<tr class="memdesc:aa7c764725642e00ad7f55a683dd56d64"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback for the control command.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa7c764725642e00ad7f55a683dd56d64">More...</a><br /></td></tr>
<tr class="separator:aa7c764725642e00ad7f55a683dd56d64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1aa9ad6ff7517bd8d6e8676d888c930f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a1aa9ad6ff7517bd8d6e8676d888c930f">georeference_cb</a> (const std_msgs::msg::String::UniquePtr msg)</td></tr>
<tr class="memdesc:a1aa9ad6ff7517bd8d6e8676d888c930f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback for the georeference.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a1aa9ad6ff7517bd8d6e8676d888c930f">More...</a><br /></td></tr>
<tr class="separator:a1aa9ad6ff7517bd8d6e8676d888c930f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7e7160659b61a4ac61be14f74fb1caa"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ac7e7160659b61a4ac61be14f74fb1caa">onSpin</a> ()</td></tr>
<tr class="memdesc:ac7e7160659b61a4ac61be14f74fb1caa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Spin callback function.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ac7e7160659b61a4ac61be14f74fb1caa">More...</a><br /></td></tr>
<tr class="separator:ac7e7160659b61a4ac61be14f74fb1caa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf8506705dea8579268655c4fdeb4ddf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#acf8506705dea8579268655c4fdeb4ddf">run_leader</a> ()</td></tr>
<tr class="memdesc:acf8506705dea8579268655c4fdeb4ddf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run Leader State.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#acf8506705dea8579268655c4fdeb4ddf">More...</a><br /></td></tr>
<tr class="separator:acf8506705dea8579268655c4fdeb4ddf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7bcebb0d98ab80013c945a2ec283250e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a7bcebb0d98ab80013c945a2ec283250e">run_leader_waiting</a> ()</td></tr>
<tr class="memdesc:a7bcebb0d98ab80013c945a2ec283250e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run Leader Waiting State.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a7bcebb0d98ab80013c945a2ec283250e">More...</a><br /></td></tr>
<tr class="separator:a7bcebb0d98ab80013c945a2ec283250e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d07b2ec081219ee9fb62418170bb1f8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a7d07b2ec081219ee9fb62418170bb1f8">run_candidate_follower</a> ()</td></tr>
<tr class="memdesc:a7d07b2ec081219ee9fb62418170bb1f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run Candidate Follower State.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a7d07b2ec081219ee9fb62418170bb1f8">More...</a><br /></td></tr>
<tr class="separator:a7d07b2ec081219ee9fb62418170bb1f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e9dbfe57693b6d23d99b61af6375a4f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3e9dbfe57693b6d23d99b61af6375a4f">run_follower</a> ()</td></tr>
<tr class="memdesc:a3e9dbfe57693b6d23d99b61af6375a4f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run Follower State.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3e9dbfe57693b6d23d99b61af6375a4f">More...</a><br /></td></tr>
<tr class="separator:a3e9dbfe57693b6d23d99b61af6375a4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a848aac5dfc1f6a3c4fba8fa0bba0ca66"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a848aac5dfc1f6a3c4fba8fa0bba0ca66">run_leader_aborting</a> ()</td></tr>
<tr class="memdesc:a848aac5dfc1f6a3c4fba8fa0bba0ca66"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run Leader Aborting State.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a848aac5dfc1f6a3c4fba8fa0bba0ca66">More...</a><br /></td></tr>
<tr class="separator:a848aac5dfc1f6a3c4fba8fa0bba0ca66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2c3c1b6030726c8e1931ea0093dd91d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa2c3c1b6030726c8e1931ea0093dd91d">run_candidate_leader</a> ()</td></tr>
<tr class="memdesc:aa2c3c1b6030726c8e1931ea0093dd91d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run Candidate Leader State.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa2c3c1b6030726c8e1931ea0093dd91d">More...</a><br /></td></tr>
<tr class="separator:aa2c3c1b6030726c8e1931ea0093dd91d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac28094ea4b6d85949859226c860d8bd6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ac28094ea4b6d85949859226c860d8bd6">run_lead_with_operation</a> ()</td></tr>
<tr class="memdesc:ac28094ea4b6d85949859226c860d8bd6"><td class="mdescLeft">&#160;</td><td class="mdescRight">UCLA Run lead with operation State.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ac28094ea4b6d85949859226c860d8bd6">More...</a><br /></td></tr>
<tr class="separator:ac28094ea4b6d85949859226c860d8bd6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c989d9220109cab74fb8aff6212f27e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a8c989d9220109cab74fb8aff6212f27e">run_prepare_to_join</a> ()</td></tr>
<tr class="memdesc:a8c989d9220109cab74fb8aff6212f27e"><td class="mdescLeft">&#160;</td><td class="mdescRight">UCLA Run prepare to join State.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a8c989d9220109cab74fb8aff6212f27e">More...</a><br /></td></tr>
<tr class="separator:a8c989d9220109cab74fb8aff6212f27e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abcab6368ab8bffc15e380b099554b314"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#abcab6368ab8bffc15e380b099554b314">setHostECEF</a> (carma_v2x_msgs::msg::LocationECEF pose_ecef_point)</td></tr>
<tr class="memdesc:abcab6368ab8bffc15e380b099554b314"><td class="mdescLeft">&#160;</td><td class="mdescRight">UCLA Update the private variable pose_ecef_point_.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#abcab6368ab8bffc15e380b099554b314">More...</a><br /></td></tr>
<tr class="separator:abcab6368ab8bffc15e380b099554b314"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b1cb323bb9e2ee5349948946198121c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonManager.html">PlatoonManager</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a9b1cb323bb9e2ee5349948946198121c">getHostPM</a> ()</td></tr>
<tr class="memdesc:a9b1cb323bb9e2ee5349948946198121c"><td class="mdescLeft">&#160;</td><td class="mdescRight">UCLA Getter: for <a class="el" href="classplatoon__strategic__ihp_1_1PlatoonManager.html" title="Class containing the logic for platoon manager. It is responsible for keeping track of the platoon me...">PlatoonManager</a> class.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a9b1cb323bb9e2ee5349948946198121c">More...</a><br /></td></tr>
<tr class="separator:a9b1cb323bb9e2ee5349948946198121c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d2a38cf81006009974698b5ad9dc738"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2d2a38cf81006009974698b5ad9dc738">setPMState</a> (<a class="el" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403daf">PlatoonState</a> desiredState)</td></tr>
<tr class="memdesc:a2d2a38cf81006009974698b5ad9dc738"><td class="mdescLeft">&#160;</td><td class="mdescRight">UCLA Setter: function to set pm_.platoon_state.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2d2a38cf81006009974698b5ad9dc738">More...</a><br /></td></tr>
<tr class="separator:a2d2a38cf81006009974698b5ad9dc738"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9f897ed93100210dc6396905c7d6ddc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae9f897ed93100210dc6396905c7d6ddc">updatePlatoonList</a> (std::vector&lt; <a class="el" href="structplatoon__strategic__ihp_1_1PlatoonMember.html">PlatoonMember</a> &gt; platoon_list)</td></tr>
<tr class="memdesc:ae9f897ed93100210dc6396905c7d6ddc"><td class="mdescLeft">&#160;</td><td class="mdescRight">UCLA Setter: Update platoon list (Unit Test).  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae9f897ed93100210dc6396905c7d6ddc">More...</a><br /></td></tr>
<tr class="separator:ae9f897ed93100210dc6396905c7d6ddc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83e278a200d79307eae123526701ac5f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a83e278a200d79307eae123526701ac5f">setConfig</a> (const <a class="el" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html">PlatoonPluginConfig</a> &amp;config)</td></tr>
<tr class="memdesc:a83e278a200d79307eae123526701ac5f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the current config.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a83e278a200d79307eae123526701ac5f">More...</a><br /></td></tr>
<tr class="separator:a83e278a200d79307eae123526701ac5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:ad10e1df213ec7524892b247d28ec9172"><td class="memItemLeft" align="right" valign="top">carma_v2x_msgs::msg::LocationECEF&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ad10e1df213ec7524892b247d28ec9172">pose_ecef_point_</a></td></tr>
<tr class="separator:ad10e1df213ec7524892b247d28ec9172"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-methods" name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a1f96a7552ba7778a703930c546a9816b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a1f96a7552ba7778a703930c546a9816b">isVehicleRightInFront</a> (double downtrack, double crosstrack)</td></tr>
<tr class="memdesc:a1f96a7552ba7778a703930c546a9816b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to determine if a target vehicle is in the front of host vehicle note: This is only applicable for same lane application, so it will check cross track distance.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a1f96a7552ba7778a703930c546a9816b">More...</a><br /></td></tr>
<tr class="separator:a1f96a7552ba7778a703930c546a9816b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6fe836b822225ea28495dd732d2e1d6e"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a6fe836b822225ea28495dd732d2e1d6e">findSpeedLimit</a> (const lanelet::ConstLanelet &amp;llt)</td></tr>
<tr class="memdesc:a6fe836b822225ea28495dd732d2e1d6e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to find speed limit of a lanelet.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a6fe836b822225ea28495dd732d2e1d6e">More...</a><br /></td></tr>
<tr class="separator:a6fe836b822225ea28495dd732d2e1d6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5776b135d1c58b8224763c05d64fa440"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217">MobilityRequestResponse</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a5776b135d1c58b8224763c05d64fa440">mob_req_cb_leader</a> (const carma_v2x_msgs::msg::MobilityRequest &amp;msg)</td></tr>
<tr class="memdesc:a5776b135d1c58b8224763c05d64fa440"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to process mobility request in leader state.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a5776b135d1c58b8224763c05d64fa440">More...</a><br /></td></tr>
<tr class="separator:a5776b135d1c58b8224763c05d64fa440"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76aa3d0140244914e0ffe7f9554751bb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217">MobilityRequestResponse</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a76aa3d0140244914e0ffe7f9554751bb">mob_req_cb_leaderwaiting</a> (const carma_v2x_msgs::msg::MobilityRequest &amp;msg)</td></tr>
<tr class="memdesc:a76aa3d0140244914e0ffe7f9554751bb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to process mobility request in leader waiting state.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a76aa3d0140244914e0ffe7f9554751bb">More...</a><br /></td></tr>
<tr class="separator:a76aa3d0140244914e0ffe7f9554751bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a274f5abfcee68012ec00bfe4f8a7c21e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217">MobilityRequestResponse</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a274f5abfcee68012ec00bfe4f8a7c21e">mob_req_cb_follower</a> (const carma_v2x_msgs::msg::MobilityRequest &amp;msg)</td></tr>
<tr class="memdesc:a274f5abfcee68012ec00bfe4f8a7c21e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to process mobility request in follower state.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a274f5abfcee68012ec00bfe4f8a7c21e">More...</a><br /></td></tr>
<tr class="separator:a274f5abfcee68012ec00bfe4f8a7c21e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f3897bc8d2d12e3161ede942d5f1b51"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217">MobilityRequestResponse</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a6f3897bc8d2d12e3161ede942d5f1b51">mob_req_cb_candidatefollower</a> (const carma_v2x_msgs::msg::MobilityRequest &amp;msg)</td></tr>
<tr class="memdesc:a6f3897bc8d2d12e3161ede942d5f1b51"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to process mobility request in candidate follower state.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a6f3897bc8d2d12e3161ede942d5f1b51">More...</a><br /></td></tr>
<tr class="separator:a6f3897bc8d2d12e3161ede942d5f1b51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83ec14a38d923ba22c00168e8e991a32"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217">MobilityRequestResponse</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a83ec14a38d923ba22c00168e8e991a32">mob_req_cb_standby</a> (const carma_v2x_msgs::msg::MobilityRequest &amp;msg)</td></tr>
<tr class="memdesc:a83ec14a38d923ba22c00168e8e991a32"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to process mobility request in standby state.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a83ec14a38d923ba22c00168e8e991a32">More...</a><br /></td></tr>
<tr class="separator:a83ec14a38d923ba22c00168e8e991a32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7fcd17fc2e2649934215719e473c52bb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a7fcd17fc2e2649934215719e473c52bb">mob_resp_cb_leader</a> (const carma_v2x_msgs::msg::MobilityResponse &amp;msg)</td></tr>
<tr class="memdesc:a7fcd17fc2e2649934215719e473c52bb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to process mobility response in leader state.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a7fcd17fc2e2649934215719e473c52bb">More...</a><br /></td></tr>
<tr class="separator:a7fcd17fc2e2649934215719e473c52bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae41ec043178e306fdd909d671877ef9f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae41ec043178e306fdd909d671877ef9f">mob_resp_cb_leaderwaiting</a> (const carma_v2x_msgs::msg::MobilityResponse &amp;msg)</td></tr>
<tr class="memdesc:ae41ec043178e306fdd909d671877ef9f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to process mobility response in leader waiting state.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae41ec043178e306fdd909d671877ef9f">More...</a><br /></td></tr>
<tr class="separator:ae41ec043178e306fdd909d671877ef9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80d39ab680172d7379e4038d41b50a39"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a80d39ab680172d7379e4038d41b50a39">mob_resp_cb_follower</a> (const carma_v2x_msgs::msg::MobilityResponse &amp;msg)</td></tr>
<tr class="memdesc:a80d39ab680172d7379e4038d41b50a39"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to process mobility response in follower state.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a80d39ab680172d7379e4038d41b50a39">More...</a><br /></td></tr>
<tr class="separator:a80d39ab680172d7379e4038d41b50a39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac969d6086d5fe4b55831015327820688"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ac969d6086d5fe4b55831015327820688">mob_resp_cb_candidatefollower</a> (const carma_v2x_msgs::msg::MobilityResponse &amp;msg)</td></tr>
<tr class="memdesc:ac969d6086d5fe4b55831015327820688"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to process mobility response in candidate follower state.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ac969d6086d5fe4b55831015327820688">More...</a><br /></td></tr>
<tr class="separator:ac969d6086d5fe4b55831015327820688"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0c666183fb0cb94767b87309404a8f6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ab0c666183fb0cb94767b87309404a8f6">mob_resp_cb_standby</a> (const carma_v2x_msgs::msg::MobilityResponse &amp;msg)</td></tr>
<tr class="memdesc:ab0c666183fb0cb94767b87309404a8f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to process mobility response in standby state.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ab0c666183fb0cb94767b87309404a8f6">More...</a><br /></td></tr>
<tr class="separator:ab0c666183fb0cb94767b87309404a8f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd00a90158f773100543b3f56f964d74"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#afd00a90158f773100543b3f56f964d74">mob_op_cb_leader</a> (const carma_v2x_msgs::msg::MobilityOperation &amp;msg)</td></tr>
<tr class="memdesc:afd00a90158f773100543b3f56f964d74"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to process mobility operation in leader state.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#afd00a90158f773100543b3f56f964d74">More...</a><br /></td></tr>
<tr class="separator:afd00a90158f773100543b3f56f964d74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c2e50853fa2e7e7c855271bc669e5dd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a5c2e50853fa2e7e7c855271bc669e5dd">mob_op_cb_leaderwaiting</a> (const carma_v2x_msgs::msg::MobilityOperation &amp;msg)</td></tr>
<tr class="memdesc:a5c2e50853fa2e7e7c855271bc669e5dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to process mobility operation in leader waiting state.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a5c2e50853fa2e7e7c855271bc669e5dd">More...</a><br /></td></tr>
<tr class="separator:a5c2e50853fa2e7e7c855271bc669e5dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae28a41d0b5586da8165051e8ccb044a9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae28a41d0b5586da8165051e8ccb044a9">mob_op_cb_follower</a> (const carma_v2x_msgs::msg::MobilityOperation &amp;msg)</td></tr>
<tr class="memdesc:ae28a41d0b5586da8165051e8ccb044a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to process mobility operation in follower state.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae28a41d0b5586da8165051e8ccb044a9">More...</a><br /></td></tr>
<tr class="separator:ae28a41d0b5586da8165051e8ccb044a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a716601497689610ef44a056a062c32bf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a716601497689610ef44a056a062c32bf">mob_op_cb_candidatefollower</a> (const carma_v2x_msgs::msg::MobilityOperation &amp;msg)</td></tr>
<tr class="memdesc:a716601497689610ef44a056a062c32bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to process mobility operation in candidate follower state.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a716601497689610ef44a056a062c32bf">More...</a><br /></td></tr>
<tr class="separator:a716601497689610ef44a056a062c32bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade1a16b0f87bd693447cdbbeb960fbba"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ade1a16b0f87bd693447cdbbeb960fbba">mob_op_cb_standby</a> (const carma_v2x_msgs::msg::MobilityOperation &amp;msg)</td></tr>
<tr class="memdesc:ade1a16b0f87bd693447cdbbeb960fbba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to process mobility operation in standby state.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ade1a16b0f87bd693447cdbbeb960fbba">More...</a><br /></td></tr>
<tr class="separator:ade1a16b0f87bd693447cdbbeb960fbba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc01cfaa2979666119dff63ee09c05a6"><td class="memItemLeft" align="right" valign="top">carma_v2x_msgs::msg::MobilityOperation&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#afc01cfaa2979666119dff63ee09c05a6">composeMobilityOperationLeader</a> (const std::string &amp;type)</td></tr>
<tr class="memdesc:afc01cfaa2979666119dff63ee09c05a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to compose mobility operation in leader state.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#afc01cfaa2979666119dff63ee09c05a6">More...</a><br /></td></tr>
<tr class="separator:afc01cfaa2979666119dff63ee09c05a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a80cbd904887d9fa98448f76fba7993"><td class="memItemLeft" align="right" valign="top">carma_v2x_msgs::msg::MobilityOperation&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3a80cbd904887d9fa98448f76fba7993">composeMobilityOperationFollower</a> ()</td></tr>
<tr class="memdesc:a3a80cbd904887d9fa98448f76fba7993"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to compose mobility operation in follower state.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3a80cbd904887d9fa98448f76fba7993">More...</a><br /></td></tr>
<tr class="separator:a3a80cbd904887d9fa98448f76fba7993"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95d140cc05909e28936b714f41862fc9"><td class="memItemLeft" align="right" valign="top">carma_v2x_msgs::msg::MobilityOperation&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a95d140cc05909e28936b714f41862fc9">composeMobilityOperationLeaderWaiting</a> ()</td></tr>
<tr class="memdesc:a95d140cc05909e28936b714f41862fc9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to compose mobility operation in leader waiting state.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a95d140cc05909e28936b714f41862fc9">More...</a><br /></td></tr>
<tr class="separator:a95d140cc05909e28936b714f41862fc9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a657b2d890046589b62c473178a134b20"><td class="memItemLeft" align="right" valign="top">carma_v2x_msgs::msg::MobilityOperation&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a657b2d890046589b62c473178a134b20">composeMobilityOperationCandidateFollower</a> ()</td></tr>
<tr class="memdesc:a657b2d890046589b62c473178a134b20"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to compose mobility operation in candidate follower state.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a657b2d890046589b62c473178a134b20">More...</a><br /></td></tr>
<tr class="separator:a657b2d890046589b62c473178a134b20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11ffedaaa90fe358ecfdccab7c5a428c"><td class="memItemLeft" align="right" valign="top">carma_v2x_msgs::msg::LocationECEF&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a11ffedaaa90fe358ecfdccab7c5a428c">pose_to_ecef</a> (geometry_msgs::msg::PoseStamped pose_msg)</td></tr>
<tr class="memdesc:a11ffedaaa90fe358ecfdccab7c5a428c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to convert pose from map frame to ecef location.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a11ffedaaa90fe358ecfdccab7c5a428c">More...</a><br /></td></tr>
<tr class="separator:a11ffedaaa90fe358ecfdccab7c5a428c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a876cee27af19b1f215ffd4a2190be371"><td class="memItemLeft" align="right" valign="top">lanelet::BasicPoint2d&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a876cee27af19b1f215ffd4a2190be371">ecef_to_map_point</a> (carma_v2x_msgs::msg::LocationECEF ecef_point)</td></tr>
<tr class="memdesc:a876cee27af19b1f215ffd4a2190be371"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to convert ecef location to a 2d point in map frame.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a876cee27af19b1f215ffd4a2190be371">More...</a><br /></td></tr>
<tr class="separator:a876cee27af19b1f215ffd4a2190be371"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af86af042a60d31a38a0be515bd4e5f9b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#af86af042a60d31a38a0be515bd4e5f9b">isVehicleRightBehind</a> (double downtrack, double crosstrack)</td></tr>
<tr class="memdesc:af86af042a60d31a38a0be515bd4e5f9b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to determine if the given downtrack distance (m) is behind the host vehicle.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#af86af042a60d31a38a0be515bd4e5f9b">More...</a><br /></td></tr>
<tr class="separator:af86af042a60d31a38a0be515bd4e5f9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12d5bd4a0601fe67e924cc07f0672e85"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a12d5bd4a0601fe67e924cc07f0672e85">isJoiningVehicleNearPlatoon</a> (double joining_downtrack, double joining_crosstrack)</td></tr>
<tr class="memdesc:a12d5bd4a0601fe67e924cc07f0672e85"><td class="mdescLeft">&#160;</td><td class="mdescRight">The method for platoon leader to determine if the joining vehicle is closeby. (Note: Used when host vehicle is the platoon leader)  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a12d5bd4a0601fe67e924cc07f0672e85">More...</a><br /></td></tr>
<tr class="separator:a12d5bd4a0601fe67e924cc07f0672e85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa76f916a1f30e25204262dcd17fcf4ac"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa76f916a1f30e25204262dcd17fcf4ac">isVehicleNearTargetPlatoon</a> (double rearVehicleDtd, double frontVehicleDtd, double frontVehicleCtd)</td></tr>
<tr class="memdesc:aa76f916a1f30e25204262dcd17fcf4ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to determine if the host vehicle is close to the target platoon (used for cut-in join scenarios).  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa76f916a1f30e25204262dcd17fcf4ac">More...</a><br /></td></tr>
<tr class="separator:aa76f916a1f30e25204262dcd17fcf4ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81681b23983edcb5877121b526d33fb1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classint.html">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a81681b23983edcb5877121b526d33fb1">find_target_lanelet_id</a> (double start_downtrack, double end_downtrack)</td></tr>
<tr class="memdesc:a81681b23983edcb5877121b526d33fb1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to find the starting and ending lanelet ID for lane change in a two-lane scenario (used for cut-in join scenarios).  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a81681b23983edcb5877121b526d33fb1">More...</a><br /></td></tr>
<tr class="separator:a81681b23983edcb5877121b526d33fb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aabe87e2046da048da999758ebdd119fe"><td class="memItemLeft" align="right" valign="top">carma_v2x_msgs::msg::MobilityOperation&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aabe87e2046da048da999758ebdd119fe">composeMobilityOperationSTATUS</a> ()</td></tr>
<tr class="memdesc:aabe87e2046da048da999758ebdd119fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to compose mobility operation message with STATUS params.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aabe87e2046da048da999758ebdd119fe">More...</a><br /></td></tr>
<tr class="separator:aabe87e2046da048da999758ebdd119fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf34e8d8c0c18809bf551d3b04db81d4"><td class="memItemLeft" align="right" valign="top">carma_v2x_msgs::msg::MobilityOperation&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#abf34e8d8c0c18809bf551d3b04db81d4">composeMobilityOperationINFO</a> ()</td></tr>
<tr class="memdesc:abf34e8d8c0c18809bf551d3b04db81d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to compose mobility operation message with INFO params.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#abf34e8d8c0c18809bf551d3b04db81d4">More...</a><br /></td></tr>
<tr class="separator:abf34e8d8c0c18809bf551d3b04db81d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20c23f25255a2e259d5ee9a4f68b722c"><td class="memItemLeft" align="right" valign="top">carma_v2x_msgs::msg::MobilityOperation&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a20c23f25255a2e259d5ee9a4f68b722c">composeMobilityOperationLeaderAborting</a> ()</td></tr>
<tr class="memdesc:a20c23f25255a2e259d5ee9a4f68b722c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to compose mobility operation in LeaderAborting state.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a20c23f25255a2e259d5ee9a4f68b722c">More...</a><br /></td></tr>
<tr class="separator:a20c23f25255a2e259d5ee9a4f68b722c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e18795bb16ef8f84cf6e451def325bb"><td class="memItemLeft" align="right" valign="top">carma_v2x_msgs::msg::MobilityOperation&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a5e18795bb16ef8f84cf6e451def325bb">composeMobilityOperationCandidateLeader</a> ()</td></tr>
<tr class="memdesc:a5e18795bb16ef8f84cf6e451def325bb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to compose mobility operation in CandidateLeader.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a5e18795bb16ef8f84cf6e451def325bb">More...</a><br /></td></tr>
<tr class="separator:a5e18795bb16ef8f84cf6e451def325bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b54d8a43eb72f0c439860b5b5793302"><td class="memItemLeft" align="right" valign="top">carma_v2x_msgs::msg::MobilityOperation&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2b54d8a43eb72f0c439860b5b5793302">composeMobilityOperationLeadWithOperation</a> (const std::string &amp;type)</td></tr>
<tr class="memdesc:a2b54d8a43eb72f0c439860b5b5793302"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to compose mobility operation in LeadWithOperation (cut-in join)  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2b54d8a43eb72f0c439860b5b5793302">More...</a><br /></td></tr>
<tr class="separator:a2b54d8a43eb72f0c439860b5b5793302"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e1a6de5a77b7bceab316768df37fc50"><td class="memItemLeft" align="right" valign="top">carma_v2x_msgs::msg::MobilityOperation&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a4e1a6de5a77b7bceab316768df37fc50">composeMobilityOperationPrepareToJoin</a> ()</td></tr>
<tr class="memdesc:a4e1a6de5a77b7bceab316768df37fc50"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to compose mobility operation in PrepareToJoin (cut-in join)  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a4e1a6de5a77b7bceab316768df37fc50">More...</a><br /></td></tr>
<tr class="separator:a4e1a6de5a77b7bceab316768df37fc50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeac839f63dec331ca94a0feee2c949f4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aeac839f63dec331ca94a0feee2c949f4">mob_op_cb_STATUS</a> (const carma_v2x_msgs::msg::MobilityOperation &amp;msg)</td></tr>
<tr class="memdesc:aeac839f63dec331ca94a0feee2c949f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to process mobility operation message with STATUS params, read ecef location and update platoon member info.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aeac839f63dec331ca94a0feee2c949f4">More...</a><br /></td></tr>
<tr class="separator:aeac839f63dec331ca94a0feee2c949f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41bb6d04569023ef9480fa263a804a8c"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a41bb6d04569023ef9480fa263a804a8c">mob_op_find_platoon_length_from_INFO_params</a> (std::string strategyParams)</td></tr>
<tr class="memdesc:a41bb6d04569023ef9480fa263a804a8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to process mobility operation INFO params to find platoon length in m.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a41bb6d04569023ef9480fa263a804a8c">More...</a><br /></td></tr>
<tr class="separator:a41bb6d04569023ef9480fa263a804a8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab475f5a72d52048d8a4a09617634e24f"><td class="memItemLeft" align="right" valign="top">carma_v2x_msgs::msg::LocationECEF&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ab475f5a72d52048d8a4a09617634e24f">mob_op_find_ecef_from_INFO_params</a> (std::string strategyParams)</td></tr>
<tr class="memdesc:ab475f5a72d52048d8a4a09617634e24f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to process mobility operation INFO params to find platoon leader's ecef location.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ab475f5a72d52048d8a4a09617634e24f">More...</a><br /></td></tr>
<tr class="separator:ab475f5a72d52048d8a4a09617634e24f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3049b9bc64b95a37fe66b83ee6a67a88"><td class="memItemLeft" align="right" valign="top">carma_v2x_msgs::msg::LocationECEF&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3049b9bc64b95a37fe66b83ee6a67a88">mob_op_find_ecef_from_STATUS_params</a> (std::string strategyParams)</td></tr>
<tr class="memdesc:a3049b9bc64b95a37fe66b83ee6a67a88"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to process mobility operation for STATUS params.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3049b9bc64b95a37fe66b83ee6a67a88">More...</a><br /></td></tr>
<tr class="separator:a3049b9bc64b95a37fe66b83ee6a67a88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c9c86742dd6bd516c176bd9a3e72093"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a0c9c86742dd6bd516c176bd9a3e72093">mob_op_cb_leaderaborting</a> (const carma_v2x_msgs::msg::MobilityOperation &amp;msg)</td></tr>
<tr class="memdesc:a0c9c86742dd6bd516c176bd9a3e72093"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to process mobility operation in leaderaborting state.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a0c9c86742dd6bd516c176bd9a3e72093">More...</a><br /></td></tr>
<tr class="separator:a0c9c86742dd6bd516c176bd9a3e72093"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2155b77f46b98000b523eddd04e86ad3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2155b77f46b98000b523eddd04e86ad3">mob_op_cb_candidateleader</a> (const carma_v2x_msgs::msg::MobilityOperation &amp;msg)</td></tr>
<tr class="memdesc:a2155b77f46b98000b523eddd04e86ad3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to process mobility operation in candidateleader state.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2155b77f46b98000b523eddd04e86ad3">More...</a><br /></td></tr>
<tr class="separator:a2155b77f46b98000b523eddd04e86ad3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a684d176f0a01b8cdbb8bff7e686367ed"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a684d176f0a01b8cdbb8bff7e686367ed">mob_op_cb_leadwithoperation</a> (const carma_v2x_msgs::msg::MobilityOperation &amp;msg)</td></tr>
<tr class="memdesc:a684d176f0a01b8cdbb8bff7e686367ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to process mobility operation in LeadWithOperation state (cut-in join)  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a684d176f0a01b8cdbb8bff7e686367ed">More...</a><br /></td></tr>
<tr class="separator:a684d176f0a01b8cdbb8bff7e686367ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe00eb7730952e85faccf8032637983f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#afe00eb7730952e85faccf8032637983f">mob_op_cb_preparetojoin</a> (const carma_v2x_msgs::msg::MobilityOperation &amp;msg)</td></tr>
<tr class="memdesc:afe00eb7730952e85faccf8032637983f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to process mobility operation in PrepareToJoin state (cut-in join)  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#afe00eb7730952e85faccf8032637983f">More...</a><br /></td></tr>
<tr class="separator:afe00eb7730952e85faccf8032637983f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade79b5e7117d1ca95418ae5fa7f73d97"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217">MobilityRequestResponse</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ade79b5e7117d1ca95418ae5fa7f73d97">mob_req_cb_leaderaborting</a> (const carma_v2x_msgs::msg::MobilityRequest &amp;msg)</td></tr>
<tr class="memdesc:ade79b5e7117d1ca95418ae5fa7f73d97"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to process mobility request in leaderaborting state.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ade79b5e7117d1ca95418ae5fa7f73d97">More...</a><br /></td></tr>
<tr class="separator:ade79b5e7117d1ca95418ae5fa7f73d97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90514428edda23566362c1a60dc01448"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217">MobilityRequestResponse</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a90514428edda23566362c1a60dc01448">mob_req_cb_candidateleader</a> (const carma_v2x_msgs::msg::MobilityRequest &amp;msg)</td></tr>
<tr class="memdesc:a90514428edda23566362c1a60dc01448"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to process mobility request in candidateleader state.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a90514428edda23566362c1a60dc01448">More...</a><br /></td></tr>
<tr class="separator:a90514428edda23566362c1a60dc01448"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18b8dcd9744c6df8a615a1ce76f42146"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217">MobilityRequestResponse</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a18b8dcd9744c6df8a615a1ce76f42146">mob_req_cb_leadwithoperation</a> (const carma_v2x_msgs::msg::MobilityRequest &amp;msg)</td></tr>
<tr class="memdesc:a18b8dcd9744c6df8a615a1ce76f42146"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to process mobility request in leadwithoperation state (cut-in join)  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a18b8dcd9744c6df8a615a1ce76f42146">More...</a><br /></td></tr>
<tr class="separator:a18b8dcd9744c6df8a615a1ce76f42146"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17e303fdec4af651df3678c0a065ad7e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217">MobilityRequestResponse</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a17e303fdec4af651df3678c0a065ad7e">mob_req_cb_preparetojoin</a> (const carma_v2x_msgs::msg::MobilityRequest &amp;msg)</td></tr>
<tr class="memdesc:a17e303fdec4af651df3678c0a065ad7e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to process mobility request in preparetojoin state (cut-in join)  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a17e303fdec4af651df3678c0a065ad7e">More...</a><br /></td></tr>
<tr class="separator:a17e303fdec4af651df3678c0a065ad7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeba3a1dd3fc9411891a1fe1eac8c3993"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aeba3a1dd3fc9411891a1fe1eac8c3993">mob_resp_cb_leaderaborting</a> (const carma_v2x_msgs::msg::MobilityResponse &amp;msg)</td></tr>
<tr class="memdesc:aeba3a1dd3fc9411891a1fe1eac8c3993"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to process mobility response in leaderaborting state.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aeba3a1dd3fc9411891a1fe1eac8c3993">More...</a><br /></td></tr>
<tr class="separator:aeba3a1dd3fc9411891a1fe1eac8c3993"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e3fa57a6b2cec7e2ecd915863ca590b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a6e3fa57a6b2cec7e2ecd915863ca590b">mob_resp_cb_candidateleader</a> (const carma_v2x_msgs::msg::MobilityResponse &amp;msg)</td></tr>
<tr class="memdesc:a6e3fa57a6b2cec7e2ecd915863ca590b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to process mobility response in candidateleader state.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a6e3fa57a6b2cec7e2ecd915863ca590b">More...</a><br /></td></tr>
<tr class="separator:a6e3fa57a6b2cec7e2ecd915863ca590b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1506aaa516eb3c9abae75820206b5c31"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a1506aaa516eb3c9abae75820206b5c31">mob_resp_cb_leadwithoperation</a> (const carma_v2x_msgs::msg::MobilityResponse &amp;msg)</td></tr>
<tr class="memdesc:a1506aaa516eb3c9abae75820206b5c31"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to process mobility response in leadwithoperation state (cut-in join)  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a1506aaa516eb3c9abae75820206b5c31">More...</a><br /></td></tr>
<tr class="separator:a1506aaa516eb3c9abae75820206b5c31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a900863cced7c330fb24f93bc33649cd8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a900863cced7c330fb24f93bc33649cd8">mob_resp_cb_preparetojoin</a> (const carma_v2x_msgs::msg::MobilityResponse &amp;msg)</td></tr>
<tr class="memdesc:a900863cced7c330fb24f93bc33649cd8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to process mobility response in preparetojoin state.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a900863cced7c330fb24f93bc33649cd8">More...</a><br /></td></tr>
<tr class="separator:a900863cced7c330fb24f93bc33649cd8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bf57cd61a2fde08b32e8411eff64cae"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a8bf57cd61a2fde08b32e8411eff64cae">is_lanechange_possible</a> (lanelet::Id start_lanelet_id, lanelet::Id target_lanelet_id)</td></tr>
<tr class="memdesc:a8bf57cd61a2fde08b32e8411eff64cae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to check if lanechange is possible.  <a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a8bf57cd61a2fde08b32e8411eff64cae">More...</a><br /></td></tr>
<tr class="separator:a8bf57cd61a2fde08b32e8411eff64cae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3bfb6b26b37f150d583993037f8b9217"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3bfb6b26b37f150d583993037f8b9217">FRIEND_TEST</a> (<a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html">PlatoonStrategicIHPPlugin</a>, platoon_info_pub_front)</td></tr>
<tr class="separator:a3bfb6b26b37f150d583993037f8b9217"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3bab0f3480c267b9b1679be800143c30"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3bab0f3480c267b9b1679be800143c30">FRIEND_TEST</a> (<a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html">PlatoonStrategicIHPPlugin</a>, <a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a8bf57cd61a2fde08b32e8411eff64cae">is_lanechange_possible</a>)</td></tr>
<tr class="separator:a3bab0f3480c267b9b1679be800143c30"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:ae4e916260ddb6f7eb25da13ef9cb158e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceplatoon__strategic__ihp.html#ae866cb8846f2484b40536e455bfecaff">MobilityRequestCB</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae4e916260ddb6f7eb25da13ef9cb158e">mobility_request_publisher_</a></td></tr>
<tr class="separator:ae4e916260ddb6f7eb25da13ef9cb158e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08781c935cd2c56a9f93448d7a3a96fa"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceplatoon__strategic__ihp.html#a71d95090a6e2bf7ed0b85142e9081f97">MobilityResponseCB</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a08781c935cd2c56a9f93448d7a3a96fa">mobility_response_publisher_</a></td></tr>
<tr class="separator:a08781c935cd2c56a9f93448d7a3a96fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19ea827fa9a96b9154f33d364d89260e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceplatoon__strategic__ihp.html#a3c19ae18fa9f6083007c65b58293776a">MobilityOperationCB</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a19ea827fa9a96b9154f33d364d89260e">mobility_operation_publisher_</a></td></tr>
<tr class="separator:a19ea827fa9a96b9154f33d364d89260e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4431eacf32294f2c7d2617936e2864c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceplatoon__strategic__ihp.html#a5402323f00d5763553277415c786fbca">PlatooningInfoCB</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ac4431eacf32294f2c7d2617936e2864c">platooning_info_publisher_</a></td></tr>
<tr class="separator:ac4431eacf32294f2c7d2617936e2864c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae65a18d1f14ecdfae3409e47e59a1031"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacecarma__wm.html#a3ac653959e0b6198cae274d68b343228">carma_wm::WorldModelConstPtr</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae65a18d1f14ecdfae3409e47e59a1031">wm_</a></td></tr>
<tr class="separator:ae65a18d1f14ecdfae3409e47e59a1031"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2fa8cc0acf44a963c53a0461ad38fbac"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html">PlatoonPluginConfig</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a></td></tr>
<tr class="separator:a2fa8cc0acf44a963c53a0461ad38fbac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa67d1b97f198e2f088fb24ffb8e0c690"><td class="memItemLeft" align="right" valign="top">geometry_msgs::msg::PoseStamped&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa67d1b97f198e2f088fb24ffb8e0c690">pose_msg_</a></td></tr>
<tr class="separator:aa67d1b97f198e2f088fb24ffb8e0c690"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04e00e8747e98a33b4f708b8e9e58042"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a04e00e8747e98a33b4f708b8e9e58042">cmd_speed_</a> = 0</td></tr>
<tr class="separator:a04e00e8747e98a33b4f708b8e9e58042"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e827c7f2e764c6e7de83f0a81a9593f"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3e827c7f2e764c6e7de83f0a81a9593f">current_speed_</a> = 0</td></tr>
<tr class="separator:a3e827c7f2e764c6e7de83f0a81a9593f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa53003d4c3610dbb5f87762a6683dd9f"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa53003d4c3610dbb5f87762a6683dd9f">current_downtrack_</a> = 0</td></tr>
<tr class="separator:aa53003d4c3610dbb5f87762a6683dd9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79aaef859aaa4b64f6cf79c50c596bc3"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a79aaef859aaa4b64f6cf79c50c596bc3">current_crosstrack_</a> = 0</td></tr>
<tr class="separator:a79aaef859aaa4b64f6cf79c50c596bc3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a935cc1406e4a80f9f44669167e43f815"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a935cc1406e4a80f9f44669167e43f815">waitingStartTime</a> = 0</td></tr>
<tr class="separator:a935cc1406e4a80f9f44669167e43f815"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa30dd7c98fe60faad9ba8af0da2da581"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa30dd7c98fe60faad9ba8af0da2da581">candidatestateStartTime</a> = 0</td></tr>
<tr class="separator:aa30dd7c98fe60faad9ba8af0da2da581"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a986341c08763b68ba3aa958535b61fda"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a986341c08763b68ba3aa958535b61fda">HostMobilityId</a> = &quot;hostid&quot;</td></tr>
<tr class="separator:a986341c08763b68ba3aa958535b61fda"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6aef0343096358d7180a1a301022cd9e"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; lanelet::projection::LocalFrameProjector &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a6aef0343096358d7180a1a301022cd9e">map_projector_</a></td></tr>
<tr class="separator:a6aef0343096358d7180a1a301022cd9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53bebbd547236cb76e067bd5fd10d043"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a53bebbd547236cb76e067bd5fd10d043">map_loaded_</a> = false</td></tr>
<tr class="separator:a53bebbd547236cb76e067bd5fd10d043"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b29a328e494534efda340274fb2bef9"><td class="memItemLeft" align="right" valign="top">carma_planning_msgs::msg::Plugin&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a6b29a328e494534efda340274fb2bef9">plugin_discovery_msg_</a></td></tr>
<tr class="separator:a6b29a328e494534efda340274fb2bef9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50637636926375340be2ba15d016b06a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classint.html">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a50637636926375340be2ba15d016b06a">numLeaderAbortingCalls_</a> = 0</td></tr>
<tr class="separator:a50637636926375340be2ba15d016b06a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05bae259db41743d775c87f37d132d72"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classint.html">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a05bae259db41743d775c87f37d132d72">candidate_follower_delay_count_</a> = 0</td></tr>
<tr class="separator:a05bae259db41743d775c87f37d132d72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad01e269fda65c87ce4ed83151fca107b"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ad01e269fda65c87ce4ed83151fca107b">maxAllowedJoinTimeGap_</a> = 15.0</td></tr>
<tr class="separator:ad01e269fda65c87ce4ed83151fca107b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7377239fa3866dc6a2af27f2ab92e64b"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a7377239fa3866dc6a2af27f2ab92e64b">maxAllowedJoinGap_</a> = 90</td></tr>
<tr class="separator:a7377239fa3866dc6a2af27f2ab92e64b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d715885ecbb69b2bb8ad52347574f80"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classint.html">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a6d715885ecbb69b2bb8ad52347574f80">maxPlatoonSize_</a> = 10</td></tr>
<tr class="separator:a6d715885ecbb69b2bb8ad52347574f80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5129374153987c3ce12f031cd4316119"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a5129374153987c3ce12f031cd4316119">vehicleLength_</a> = 5.0</td></tr>
<tr class="separator:a5129374153987c3ce12f031cd4316119"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af12e6e347833e62db64c99229643d23e"><td class="memItemLeft" align="right" valign="top">unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#af12e6e347833e62db64c99229643d23e">infoMessageInterval_</a> = 200</td></tr>
<tr class="separator:af12e6e347833e62db64c99229643d23e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe7bd4e91b67d8079a51dc180bd8e5eb"><td class="memItemLeft" align="right" valign="top">unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#abe7bd4e91b67d8079a51dc180bd8e5eb">prevHeartBeatTime_</a> = 0.0</td></tr>
<tr class="separator:abe7bd4e91b67d8079a51dc180bd8e5eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae54ec36efc19b9c2edc90148ac10b4e0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classint.html">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae54ec36efc19b9c2edc90148ac10b4e0">statusMessageInterval_</a> = 100</td></tr>
<tr class="separator:ae54ec36efc19b9c2edc90148ac10b4e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef3664c4c7ac360846defce18161e92b"><td class="memItemLeft" align="right" valign="top">unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aef3664c4c7ac360846defce18161e92b">NEGOTIATION_TIMEOUT</a> = 15000</td></tr>
<tr class="separator:aef3664c4c7ac360846defce18161e92b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac658e41124dccaeb3b7fbbc3b8d82de7"><td class="memItemLeft" align="right" valign="top">unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ac658e41124dccaeb3b7fbbc3b8d82de7">LANE_CHANGE_TIMEOUT</a> = 300000</td></tr>
<tr class="separator:ac658e41124dccaeb3b7fbbc3b8d82de7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3055c6de78415d37b56209a66c079e57"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classint.html">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3055c6de78415d37b56209a66c079e57">noLeaderUpdatesCounter</a> = 0</td></tr>
<tr class="separator:a3055c6de78415d37b56209a66c079e57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5873cf01d465c147622626e13bed7df1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classint.html">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a5873cf01d465c147622626e13bed7df1">LEADER_TIMEOUT_COUNTER_LIMIT</a> = 5</td></tr>
<tr class="separator:a5873cf01d465c147622626e13bed7df1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5bb0123eb1a68e83b1a424eeb94f0929"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a5bb0123eb1a68e83b1a424eeb94f0929">waitingStateTimeout</a> = 25.0</td></tr>
<tr class="separator:a5bb0123eb1a68e83b1a424eeb94f0929"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92f6e3771b23b30e6be6201969e1a5d2"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a92f6e3771b23b30e6be6201969e1a5d2">desiredJoinGap</a> = 30.0</td></tr>
<tr class="separator:a92f6e3771b23b30e6be6201969e1a5d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3712cdbc6fc84fa631da3ec72733880"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ab3712cdbc6fc84fa631da3ec72733880">desiredJoinTimeGap</a> = 4.0</td></tr>
<tr class="separator:ab3712cdbc6fc84fa631da3ec72733880"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2fa1a4b839a90fee186cc921a5360ab"><td class="memItemLeft" align="right" valign="top">lanelet::BasicPoint2d&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ab2fa1a4b839a90fee186cc921a5360ab">target_cutin_pose_</a></td></tr>
<tr class="separator:ab2fa1a4b839a90fee186cc921a5360ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae53ddfbfa903ffe85722c9471cdfd3af"><td class="memItemLeft" align="right" valign="top">const double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae53ddfbfa903ffe85722c9471cdfd3af">STOPPED_SPEED</a> = 0.5</td></tr>
<tr class="separator:ae53ddfbfa903ffe85722c9471cdfd3af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94ef4b19b4e5f6befabedd4b14908bdd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classint.html">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a94ef4b19b4e5f6befabedd4b14908bdd">target_join_index_</a> = -2</td></tr>
<tr class="separator:a94ef4b19b4e5f6befabedd4b14908bdd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2bc77445cdb4c025344024395fa94607"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2bc77445cdb4c025344024395fa94607">safeToLaneChange_</a> = false</td></tr>
<tr class="separator:a2bc77445cdb4c025344024395fa94607"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a283186f2bbb98f5f85b5486e365bb4b8"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; carma_ros2_utils::timers::TimerFactory &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a283186f2bbb98f5f85b5486e365bb4b8">timer_factory_</a></td></tr>
<tr class="separator:a283186f2bbb98f5f85b5486e365bb4b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb546b690a5bbb1ad31d02fc6341734f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonManager.html">PlatoonManager</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a></td></tr>
<tr class="separator:adb546b690a5bbb1ad31d02fc6341734f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3be0b52376b568130c1c6a5ec5adeb13"><td class="memItemLeft" align="right" valign="top">const std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3be0b52376b568130c1c6a5ec5adeb13">PLATOONING_STRATEGY</a> = &quot;Carma/Platooning&quot;</td></tr>
<tr class="separator:a3be0b52376b568130c1c6a5ec5adeb13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56907ad89ed257fc81cbb7faf4221005"><td class="memItemLeft" align="right" valign="top">const std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a56907ad89ed257fc81cbb7faf4221005">OPERATION_INFO_TYPE</a> = &quot;INFO&quot;</td></tr>
<tr class="separator:a56907ad89ed257fc81cbb7faf4221005"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a243c9d3b652447765feab04517074520"><td class="memItemLeft" align="right" valign="top">const std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a243c9d3b652447765feab04517074520">OPERATION_STATUS_TYPE</a> = &quot;STATUS&quot;</td></tr>
<tr class="separator:a243c9d3b652447765feab04517074520"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31600df15338eab670b092e3ee34a898"><td class="memItemLeft" align="right" valign="top">const std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a31600df15338eab670b092e3ee34a898">OPERATION_INFO_PARAMS</a> = &quot;INFO|LENGTH:%.2f,SPEED:%.2f,SIZE:%d,ECEFX:%.2f,ECEFY:%.2f,ECEFZ:%.2f&quot;</td></tr>
<tr class="separator:a31600df15338eab670b092e3ee34a898"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac80b2f23cf6b860b8cad5c5b6f7a120b"><td class="memItemLeft" align="right" valign="top">const std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ac80b2f23cf6b860b8cad5c5b6f7a120b">OPERATION_STATUS_PARAMS</a> = &quot;STATUS|CMDSPEED:%1%,SPEED:%2%,ECEFX:%3%,ECEFY:%4%,ECEFZ:%5%&quot;</td></tr>
<tr class="separator:ac80b2f23cf6b860b8cad5c5b6f7a120b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca973fa2125f768cffaf33812403f45c"><td class="memItemLeft" align="right" valign="top">const std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aca973fa2125f768cffaf33812403f45c">JOIN_PARAMS</a> = &quot;SIZE:%1%,SPEED:%2%,ECEFX:%3%,ECEFY:%4%,ECEFZ:%5%,JOINIDX:%6%&quot;</td></tr>
<tr class="separator:aca973fa2125f768cffaf33812403f45c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Class containing the logic for Strategic IHP Plugin. This class is responsible for all the negotiations as well as generating a maneuver msg. </p>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8h_source.html#l00069">69</a> of file <a class="el" href="platoon__strategic__ihp_8h_source.html">platoon_strategic_ihp.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a16e212542f5668833ab6e6e7854143d2" name="a16e212542f5668833ab6e6e7854143d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16e212542f5668833ab6e6e7854143d2">&#9670;&nbsp;</a></span>PlatoonStrategicIHPPlugin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::PlatoonStrategicIHPPlugin </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacecarma__wm.html#a3ac653959e0b6198cae274d68b343228">carma_wm::WorldModelConstPtr</a>&#160;</td>
          <td class="paramname"><em>wm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html">PlatoonPluginConfig</a>&#160;</td>
          <td class="paramname"><em>config</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceplatoon__strategic__ihp.html#a71d95090a6e2bf7ed0b85142e9081f97">MobilityResponseCB</a>&#160;</td>
          <td class="paramname"><em>mobility_response_publisher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceplatoon__strategic__ihp.html#ae866cb8846f2484b40536e455bfecaff">MobilityRequestCB</a>&#160;</td>
          <td class="paramname"><em>mobility_request_publisher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceplatoon__strategic__ihp.html#a3c19ae18fa9f6083007c65b58293776a">MobilityOperationCB</a>&#160;</td>
          <td class="paramname"><em>mobility_operation_publisher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceplatoon__strategic__ihp.html#a5402323f00d5763553277415c786fbca">PlatooningInfoCB</a>&#160;</td>
          <td class="paramname"><em>platooning_info_publisher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::shared_ptr&lt; carma_ros2_utils::timers::TimerFactory &gt;&#160;</td>
          <td class="paramname"><em>timer_factory</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">wm</td><td>Pointer to initalized instance of the carma world model for accessing semantic map data </td></tr>
    <tr><td class="paramname">config</td><td>The configuration to be used for this object </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00036">36</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   40</span>   : <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae4e916260ddb6f7eb25da13ef9cb158e">mobility_request_publisher_</a>(mobility_request_publisher), </div>
<div class="line"><span class="lineno">   41</span>      <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a08781c935cd2c56a9f93448d7a3a96fa">mobility_response_publisher_</a>(mobility_response_publisher), <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a19ea827fa9a96b9154f33d364d89260e">mobility_operation_publisher_</a>(mobility_operation_publisher), </div>
<div class="line"><span class="lineno">   42</span>      <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ac4431eacf32294f2c7d2617936e2864c">platooning_info_publisher_</a>(platooning_info_publisher), <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae65a18d1f14ecdfae3409e47e59a1031">wm_</a>(wm), <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>(config), <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a283186f2bbb98f5f85b5486e365bb4b8">timer_factory_</a>(timer_factory), <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a283186f2bbb98f5f85b5486e365bb4b8">timer_factory_</a>)</div>
<div class="line"><span class="lineno">   43</span>    {</div>
<div class="line"><span class="lineno">   44</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Top of PlatoonStrategicIHP ctor.&quot;</span>);</div>
<div class="line"><span class="lineno">   45</span>        std::string hostStaticId = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a473bcce97d7c50beaab678372a354c0d">vehicleID</a>; <span class="comment">//static ID for this vehicle</span></div>
<div class="line"><span class="lineno">   46</span>        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a54c4103e4b8705ee687effb030fb7040">HostMobilityId</a> = hostStaticId;</div>
<div class="line"><span class="lineno">   47</span>        <span class="comment">// construct platoon member for host vehicle as the first element in the vector, since it starts life as a solo vehicle</span></div>
<div class="line"><span class="lineno">   48</span>        <span class="keywordtype">long</span> cur_t = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a283186f2bbb98f5f85b5486e365bb4b8">timer_factory_</a>-&gt;now().nanoseconds()/1000000; <span class="comment">// time in millisecond</span></div>
<div class="line"><span class="lineno">   49</span>        PlatoonMember hostVehicleMember = PlatoonMember(hostStaticId, 0.0, 0.0, 0.0, 0.0, cur_t); </div>
<div class="line"><span class="lineno">   50</span>        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>.push_back(hostVehicleMember);</div>
<div class="line"><span class="lineno">   51</span>        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a6b29a328e494534efda340274fb2bef9">plugin_discovery_msg_</a>.name = <span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>;</div>
<div class="line"><span class="lineno">   52</span>        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a6b29a328e494534efda340274fb2bef9">plugin_discovery_msg_</a>.version_id = <span class="stringliteral">&quot;v1.0&quot;</span>;</div>
<div class="line"><span class="lineno">   53</span>        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a6b29a328e494534efda340274fb2bef9">plugin_discovery_msg_</a>.available = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">   54</span>        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a6b29a328e494534efda340274fb2bef9">plugin_discovery_msg_</a>.activated = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">   55</span>        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a6b29a328e494534efda340274fb2bef9">plugin_discovery_msg_</a>.type = carma_planning_msgs::msg::Plugin::STRATEGIC;</div>
<div class="line"><span class="lineno">   56</span>        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a6b29a328e494534efda340274fb2bef9">plugin_discovery_msg_</a>.capability = <span class="stringliteral">&quot;strategic_plan/plan_maneuvers&quot;</span>;</div>
<div class="line"><span class="lineno">   57</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;ctor complete. hostStaticId = &quot;</span> &lt;&lt; hostStaticId);</div>
<div class="line"><span class="lineno">   58</span>    }</div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_a54c4103e4b8705ee687effb030fb7040"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a54c4103e4b8705ee687effb030fb7040">platoon_strategic_ihp::PlatoonManager::HostMobilityId</a></div><div class="ttdeci">std::string HostMobilityId</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00404">platoon_manager_ihp.h:404</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_ad408d9fd019a1f61369db874447f4ace"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">platoon_strategic_ihp::PlatoonManager::host_platoon_</a></div><div class="ttdeci">std::vector&lt; PlatoonMember &gt; host_platoon_</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00361">platoon_manager_ihp.h:361</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a08781c935cd2c56a9f93448d7a3a96fa"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a08781c935cd2c56a9f93448d7a3a96fa">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mobility_response_publisher_</a></div><div class="ttdeci">MobilityResponseCB mobility_response_publisher_</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8h_source.html#l00309">platoon_strategic_ihp.h:309</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a19ea827fa9a96b9154f33d364d89260e"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a19ea827fa9a96b9154f33d364d89260e">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mobility_operation_publisher_</a></div><div class="ttdeci">MobilityOperationCB mobility_operation_publisher_</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8h_source.html#l00310">platoon_strategic_ihp.h:310</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a283186f2bbb98f5f85b5486e365bb4b8"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a283186f2bbb98f5f85b5486e365bb4b8">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::timer_factory_</a></div><div class="ttdeci">std::shared_ptr&lt; carma_ros2_utils::timers::TimerFactory &gt; timer_factory_</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8h_source.html#l00814">platoon_strategic_ihp.h:814</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a2fa8cc0acf44a963c53a0461ad38fbac"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::config_</a></div><div class="ttdeci">PlatoonPluginConfig config_</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8h_source.html#l00318">platoon_strategic_ihp.h:318</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a6b29a328e494534efda340274fb2bef9"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a6b29a328e494534efda340274fb2bef9">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::plugin_discovery_msg_</a></div><div class="ttdeci">carma_planning_msgs::msg::Plugin plugin_discovery_msg_</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8h_source.html#l00779">platoon_strategic_ihp.h:779</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_ac4431eacf32294f2c7d2617936e2864c"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ac4431eacf32294f2c7d2617936e2864c">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::platooning_info_publisher_</a></div><div class="ttdeci">PlatooningInfoCB platooning_info_publisher_</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8h_source.html#l00311">platoon_strategic_ihp.h:311</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_adb546b690a5bbb1ad31d02fc6341734f"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::pm_</a></div><div class="ttdeci">PlatoonManager pm_</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8h_source.html#l00817">platoon_strategic_ihp.h:817</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_ae4e916260ddb6f7eb25da13ef9cb158e"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae4e916260ddb6f7eb25da13ef9cb158e">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mobility_request_publisher_</a></div><div class="ttdeci">MobilityRequestCB mobility_request_publisher_</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8h_source.html#l00308">platoon_strategic_ihp.h:308</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_ae65a18d1f14ecdfae3409e47e59a1031"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae65a18d1f14ecdfae3409e47e59a1031">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::wm_</a></div><div class="ttdeci">carma_wm::WorldModelConstPtr wm_</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8h_source.html#l00315">platoon_strategic_ihp.h:315</a></div></div>
<div class="ttc" id="astructplatoon__strategic__ihp_1_1PlatoonPluginConfig_html_a473bcce97d7c50beaab678372a354c0d"><div class="ttname"><a href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a473bcce97d7c50beaab678372a354c0d">platoon_strategic_ihp::PlatoonPluginConfig::vehicleID</a></div><div class="ttdeci">std::string vehicleID</div><div class="ttdef"><b>Definition:</b> <a href="platoon__config__ihp_8h_source.html#l00068">platoon_config_ihp.h:68</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__strategic__ihp_8h_source.html#l00318">config_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00361">platoon_strategic_ihp::PlatoonManager::host_platoon_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00404">platoon_strategic_ihp::PlatoonManager::HostMobilityId</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00779">plugin_discovery_msg_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00817">pm_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00814">timer_factory_</a>, and <a class="el" href="platoon__config__ihp_8h_source.html#l00068">platoon_strategic_ihp::PlatoonPluginConfig::vehicleID</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="aa7c764725642e00ad7f55a683dd56d64" name="aa7c764725642e00ad7f55a683dd56d64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7c764725642e00ad7f55a683dd56d64">&#9670;&nbsp;</a></span>cmd_cb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void platoon_strategic_ihp::PlatoonStrategicIHPPlugin::cmd_cb </td>
          <td>(</td>
          <td class="paramtype">const geometry_msgs::msg::TwistStamped::UniquePtr&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Callback for the control command. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>Latest twist cmd message </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00137">137</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  138</span>    {</div>
<div class="line"><span class="lineno">  139</span>        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a04e00e8747e98a33b4f708b8e9e58042">cmd_speed_</a> = msg-&gt;twist.linear.x;</div>
<div class="line"><span class="lineno">  140</span>    }</div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a04e00e8747e98a33b4f708b8e9e58042"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a04e00e8747e98a33b4f708b8e9e58042">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::cmd_speed_</a></div><div class="ttdeci">double cmd_speed_</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8h_source.html#l00326">platoon_strategic_ihp.h:326</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__strategic__ihp_8h_source.html#l00326">cmd_speed_</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp__node_8cpp_source.html#l00118">platoon_strategic_ihp::Node::on_configure_plugin()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aa7c764725642e00ad7f55a683dd56d64_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aa7c764725642e00ad7f55a683dd56d64_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aa7c764725642e00ad7f55a683dd56d64_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aa7c764725642e00ad7f55a683dd56d64_icgraph">
<area shape="rect" title="Callback for the control command." alt="" coords="199,5,381,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,5,151,61"/>
</map>
</div>

</div>
</div>
<a id="a8378d85e905c51ff883b7fae4bf64367" name="a8378d85e905c51ff883b7fae4bf64367"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8378d85e905c51ff883b7fae4bf64367">&#9670;&nbsp;</a></span>composeLaneChangeManeuverMessage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">carma_planning_msgs::msg::Maneuver platoon_strategic_ihp::PlatoonStrategicIHPPlugin::composeLaneChangeManeuverMessage </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>current_dist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>end_dist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>current_speed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>target_speed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classint.html">int</a>&#160;</td>
          <td class="paramname"><em>starting_lane_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classint.html">int</a>&#160;</td>
          <td class="paramname"><em>ending_lane_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">rclcpp::Time &amp;&#160;</td>
          <td class="paramname"><em>current_time</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find start(current) and target(end) lanelet index from path to generate lane change maneuver message. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">current_dist</td><td>current downtrack distance </td></tr>
    <tr><td class="paramname">end_dist</td><td>ending downtrack distance </td></tr>
    <tr><td class="paramname">current_speed</td><td>current speed </td></tr>
    <tr><td class="paramname">target_speed</td><td>target speed </td></tr>
    <tr><td class="paramname">starting_lane_id</td><td>current lanelet id which serves as the starting lanlet id </td></tr>
    <tr><td class="paramname">ending_lane_id</td><td>target lanelet id which is also the ending lanelet id that is in another lane </td></tr>
    <tr><td class="paramname">current_time</td><td>current time in seconds</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Maneuver message </dd></dl>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l03162">3162</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3163</span>    {</div>
<div class="line"><span class="lineno"> 3164</span>        carma_planning_msgs::msg::Maneuver maneuver_msg;</div>
<div class="line"><span class="lineno"> 3165</span>        <span class="comment">// UCLA: change to lane change maneuvers</span></div>
<div class="line"><span class="lineno"> 3166</span>        maneuver_msg.type = carma_planning_msgs::msg::Maneuver::LANE_CHANGE;</div>
<div class="line"><span class="lineno"> 3167</span>        maneuver_msg.lane_change_maneuver.parameters.negotiation_type = carma_planning_msgs::msg::ManeuverParameters::PLATOONING;</div>
<div class="line"><span class="lineno"> 3168</span>        maneuver_msg.lane_change_maneuver.parameters.presence_vector = carma_planning_msgs::msg::ManeuverParameters::HAS_TACTICAL_PLUGIN;</div>
<div class="line"><span class="lineno"> 3169</span>        maneuver_msg.lane_change_maneuver.parameters.planning_tactical_plugin = <span class="stringliteral">&quot;cooperative_lanechange&quot;</span>;</div>
<div class="line"><span class="lineno"> 3170</span>        maneuver_msg.lane_change_maneuver.parameters.planning_strategic_plugin = <span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>;</div>
<div class="line"><span class="lineno"> 3171</span>        maneuver_msg.lane_change_maneuver.start_dist = current_dist;</div>
<div class="line"><span class="lineno"> 3172</span>        maneuver_msg.lane_change_maneuver.start_speed = current_speed;</div>
<div class="line"><span class="lineno"> 3173</span>        maneuver_msg.lane_change_maneuver.start_time = current_time;</div>
<div class="line"><span class="lineno"> 3174</span>        maneuver_msg.lane_change_maneuver.end_dist = end_dist;</div>
<div class="line"><span class="lineno"> 3175</span>        maneuver_msg.lane_change_maneuver.end_speed = target_speed;        </div>
<div class="line"><span class="lineno"> 3176</span>        <span class="comment">// Generate a new maneuver ID for the lane change maneuver (not needed for lane following maneuver).</span></div>
<div class="line"><span class="lineno"> 3177</span>        maneuver_msg.lane_following_maneuver.parameters.maneuver_id = boost::uuids::to_string(boost::uuids::random_generator()());</div>
<div class="line"><span class="lineno"> 3178</span>        </div>
<div class="line"><span class="lineno"> 3179</span>        <span class="comment">// because it is a rough plan, assume vehicle can always reach to the target speed in a lanelet</span></div>
<div class="line"><span class="lineno"> 3180</span>        <span class="keywordtype">double</span> cur_plus_target = current_speed + target_speed;</div>
<div class="line"><span class="lineno"> 3181</span>        <span class="keywordflow">if</span> (cur_plus_target &lt; 0.00001) </div>
<div class="line"><span class="lineno"> 3182</span>        {</div>
<div class="line"><span class="lineno"> 3183</span>            maneuver_msg.lane_change_maneuver.end_time = current_time + rclcpp::Duration(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#ae64774657934bc9c1e2421b4ded913fa">time_step</a>*1e9);</div>
<div class="line"><span class="lineno"> 3184</span>        } </div>
<div class="line"><span class="lineno"> 3185</span>        <span class="keywordflow">else</span> </div>
<div class="line"><span class="lineno"> 3186</span>        {</div>
<div class="line"><span class="lineno"> 3187</span>            <span class="comment">// maneuver_msg.lane_change_maneuver.end_time = current_time + rclcpp::Duration((end_dist - current_dist) / (0.5 * cur_plus_target));</span></div>
<div class="line"><span class="lineno"> 3188</span>            maneuver_msg.lane_change_maneuver.end_time = current_time + rclcpp::Duration(20.0*1e9);</div>
<div class="line"><span class="lineno"> 3189</span> </div>
<div class="line"><span class="lineno"> 3190</span>        }</div>
<div class="line"><span class="lineno"> 3191</span> </div>
<div class="line"><span class="lineno"> 3192</span>        <span class="comment">// UCLA: need both start laneID and end laneID  for lane change</span></div>
<div class="line"><span class="lineno"> 3193</span>        maneuver_msg.lane_change_maneuver.starting_lane_id = { std::to_string(starting_lane_id) };</div>
<div class="line"><span class="lineno"> 3194</span>        maneuver_msg.lane_change_maneuver.ending_lane_id = { std::to_string(ending_lane_id) };</div>
<div class="line"><span class="lineno"> 3195</span> </div>
<div class="line"><span class="lineno"> 3196</span>        current_time = maneuver_msg.lane_change_maneuver.end_time;</div>
<div class="line"><span class="lineno"> 3197</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Creating lane change start dist:&quot;</span>&lt;&lt;current_dist&lt;&lt;<span class="stringliteral">&quot; end dist:&quot;</span>&lt;&lt;end_dist);</div>
<div class="line"><span class="lineno"> 3198</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Duration:&quot;</span>&lt;&lt; rclcpp::Time(maneuver_msg.lane_change_maneuver.end_time).seconds() - rclcpp::Time(maneuver_msg.lane_change_maneuver.start_time).seconds());</div>
<div class="line"><span class="lineno"> 3199</span>        <span class="keywordflow">return</span> maneuver_msg;</div>
<div class="line"><span class="lineno"> 3200</span>    }</div>
<div class="ttc" id="astructplatoon__strategic__ihp_1_1PlatoonPluginConfig_html_ae64774657934bc9c1e2421b4ded913fa"><div class="ttname"><a href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#ae64774657934bc9c1e2421b4ded913fa">platoon_strategic_ihp::PlatoonPluginConfig::time_step</a></div><div class="ttdeci">double time_step</div><div class="ttdef"><b>Definition:</b> <a href="platoon__config__ihp_8h_source.html#l00037">platoon_config_ihp.h:37</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__strategic__ihp_8h_source.html#l00318">config_</a>, and <a class="el" href="platoon__config__ihp_8h_source.html#l00037">platoon_strategic_ihp::PlatoonPluginConfig::time_step</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l03221">plan_maneuver_cb()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a8378d85e905c51ff883b7fae4bf64367_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a8378d85e905c51ff883b7fae4bf64367_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a8378d85e905c51ff883b7fae4bf64367_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a8378d85e905c51ff883b7fae4bf64367_icgraph">
<area shape="rect" title="Find start(current) and target(end) lanelet index from path to generate lane change maneuver message." alt="" coords="236,5,500,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aedb5c1f689806047c82f0c7b3ebe9c66" title="Callback function to the maneuver request." alt="" coords="5,5,188,61"/>
</map>
</div>

</div>
</div>
<a id="a68e48fa7d12584918a6764710d71a606" name="a68e48fa7d12584918a6764710d71a606"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68e48fa7d12584918a6764710d71a606">&#9670;&nbsp;</a></span>composeManeuverMessage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">carma_planning_msgs::msg::Maneuver platoon_strategic_ihp::PlatoonStrategicIHPPlugin::composeManeuverMessage </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>current_dist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>end_dist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>current_speed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>target_speed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classint.html">int</a>&#160;</td>
          <td class="paramname"><em>lane_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">rclcpp::Time &amp;&#160;</td>
          <td class="paramname"><em>current_time</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find lanelet index from path. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">current_dist</td><td>current downtrack distance (m) </td></tr>
    <tr><td class="paramname">end_dist</td><td>ending downtrack distance (m) </td></tr>
    <tr><td class="paramname">current_speed</td><td>current speed (m/s) </td></tr>
    <tr><td class="paramname">target_speed</td><td>target speed (m/s) </td></tr>
    <tr><td class="paramname">lane_id</td><td>lanelet id </td></tr>
    <tr><td class="paramname">current_time</td><td>current time (s)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Maneuver message </dd></dl>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l03122">3122</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3123</span>    {</div>
<div class="line"><span class="lineno"> 3124</span>        carma_planning_msgs::msg::Maneuver maneuver_msg;</div>
<div class="line"><span class="lineno"> 3125</span>        maneuver_msg.type = carma_planning_msgs::msg::Maneuver::LANE_FOLLOWING;</div>
<div class="line"><span class="lineno"> 3126</span>        maneuver_msg.lane_following_maneuver.parameters.negotiation_type = carma_planning_msgs::msg::ManeuverParameters::PLATOONING;</div>
<div class="line"><span class="lineno"> 3127</span>        maneuver_msg.lane_following_maneuver.parameters.presence_vector = carma_planning_msgs::msg::ManeuverParameters::HAS_TACTICAL_PLUGIN;</div>
<div class="line"><span class="lineno"> 3128</span>        maneuver_msg.lane_following_maneuver.parameters.planning_tactical_plugin = <span class="stringliteral">&quot;platooning_tactical_plugin&quot;</span>;</div>
<div class="line"><span class="lineno"> 3129</span>        maneuver_msg.lane_following_maneuver.parameters.planning_strategic_plugin = <span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>;</div>
<div class="line"><span class="lineno"> 3130</span>        maneuver_msg.lane_following_maneuver.start_dist = current_dist;</div>
<div class="line"><span class="lineno"> 3131</span>        maneuver_msg.lane_following_maneuver.start_speed = current_speed;</div>
<div class="line"><span class="lineno"> 3132</span>        maneuver_msg.lane_following_maneuver.start_time = current_time;</div>
<div class="line"><span class="lineno"> 3133</span>        maneuver_msg.lane_following_maneuver.end_dist = end_dist;</div>
<div class="line"><span class="lineno"> 3134</span>        maneuver_msg.lane_following_maneuver.end_speed = target_speed;</div>
<div class="line"><span class="lineno"> 3135</span>        </div>
<div class="line"><span class="lineno"> 3136</span>        <span class="comment">// because it is a rough plan, assume vehicle can always reach to the target speed in a lanelet</span></div>
<div class="line"><span class="lineno"> 3137</span>        maneuver_msg.lane_following_maneuver.end_time = current_time + rclcpp::Duration(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#ae64774657934bc9c1e2421b4ded913fa">time_step</a>*1e9);</div>
<div class="line"><span class="lineno"> 3138</span>        maneuver_msg.lane_following_maneuver.lane_ids = { std::to_string(lane_id) };</div>
<div class="line"><span class="lineno"> 3139</span> </div>
<div class="line"><span class="lineno"> 3140</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;in compose maneuver lane id:&quot;</span>&lt;&lt; lane_id);</div>
<div class="line"><span class="lineno"> 3141</span> </div>
<div class="line"><span class="lineno"> 3142</span>        lanelet::ConstLanelet current_lanelet = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae65a18d1f14ecdfae3409e47e59a1031">wm_</a>-&gt;getMap()-&gt;laneletLayer.get(lane_id);</div>
<div class="line"><span class="lineno"> 3143</span>        <span class="keywordflow">if</span>(!<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae65a18d1f14ecdfae3409e47e59a1031">wm_</a>-&gt;getMapRoutingGraph()-&gt;following(current_lanelet, <span class="keyword">false</span>).empty())</div>
<div class="line"><span class="lineno"> 3144</span>        {</div>
<div class="line"><span class="lineno"> 3145</span> </div>
<div class="line"><span class="lineno"> 3146</span>            <span class="keyword">auto</span> next_lanelet_id = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae65a18d1f14ecdfae3409e47e59a1031">wm_</a>-&gt;getMapRoutingGraph()-&gt;following(current_lanelet, <span class="keyword">false</span>).front().id();</div>
<div class="line"><span class="lineno"> 3147</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;next_lanelet_id:&quot;</span>&lt;&lt; next_lanelet_id);</div>
<div class="line"><span class="lineno"> 3148</span>            maneuver_msg.lane_following_maneuver.lane_ids.push_back(std::to_string(next_lanelet_id));</div>
<div class="line"><span class="lineno"> 3149</span>        }</div>
<div class="line"><span class="lineno"> 3150</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 3151</span>        {</div>
<div class="line"><span class="lineno"> 3152</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;No following lanelets&quot;</span>);</div>
<div class="line"><span class="lineno"> 3153</span>        }</div>
<div class="line"><span class="lineno"> 3154</span> </div>
<div class="line"><span class="lineno"> 3155</span>        current_time = maneuver_msg.lane_following_maneuver.end_time;</div>
<div class="line"><span class="lineno"> 3156</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Creating lane follow start dist:&quot;</span>&lt;&lt;current_dist&lt;&lt;<span class="stringliteral">&quot; end dist:&quot;</span>&lt;&lt;end_dist);</div>
<div class="line"><span class="lineno"> 3157</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Duration:&quot;</span>&lt;&lt; rclcpp::Time(maneuver_msg.lane_following_maneuver.end_time).seconds() - rclcpp::Time(maneuver_msg.lane_following_maneuver.start_time).seconds());</div>
<div class="line"><span class="lineno"> 3158</span>        <span class="keywordflow">return</span> maneuver_msg;</div>
<div class="line"><span class="lineno"> 3159</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__strategic__ihp_8h_source.html#l00318">config_</a>, <a class="el" href="platoon__config__ihp_8h_source.html#l00037">platoon_strategic_ihp::PlatoonPluginConfig::time_step</a>, and <a class="el" href="platoon__strategic__ihp_8h_source.html#l00315">wm_</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l03221">plan_maneuver_cb()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a68e48fa7d12584918a6764710d71a606_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a68e48fa7d12584918a6764710d71a606_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a68e48fa7d12584918a6764710d71a606_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a68e48fa7d12584918a6764710d71a606_icgraph">
<area shape="rect" title="Find lanelet index from path." alt="" coords="236,5,427,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aedb5c1f689806047c82f0c7b3ebe9c66" title="Callback function to the maneuver request." alt="" coords="5,5,188,61"/>
</map>
</div>

</div>
</div>
<a id="a657b2d890046589b62c473178a134b20" name="a657b2d890046589b62c473178a134b20"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a657b2d890046589b62c473178a134b20">&#9670;&nbsp;</a></span>composeMobilityOperationCandidateFollower()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">carma_v2x_msgs::msg::MobilityOperation platoon_strategic_ihp::PlatoonStrategicIHPPlugin::composeMobilityOperationCandidateFollower </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to compose mobility operation in candidate follower state. </p>
<dl class="section return"><dt>Returns</dt><dd>mobility operation msg </dd></dl>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00601">601</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  602</span>    {</div>
<div class="line"><span class="lineno">  603</span>        carma_v2x_msgs::msg::MobilityOperation msg;</div>
<div class="line"><span class="lineno">  604</span>        msg = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aabe87e2046da048da999758ebdd119fe">composeMobilityOperationSTATUS</a>();</div>
<div class="line"><span class="lineno">  605</span>        <span class="keywordflow">return</span> msg;</div>
<div class="line"><span class="lineno">  606</span>    }</div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_aabe87e2046da048da999758ebdd119fe"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aabe87e2046da048da999758ebdd119fe">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::composeMobilityOperationSTATUS</a></div><div class="ttdeci">carma_v2x_msgs::msg::MobilityOperation composeMobilityOperationSTATUS()</div><div class="ttdoc">Function to compose mobility operation message with STATUS params.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l00277">platoon_strategic_ihp.cpp:277</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00277">composeMobilityOperationSTATUS()</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02722">run_candidate_follower()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a657b2d890046589b62c473178a134b20_cgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a657b2d890046589b62c473178a134b20_cgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a657b2d890046589b62c473178a134b20_cgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a657b2d890046589b62c473178a134b20_cgraph">
<area shape="rect" title="Function to compose mobility operation in candidate follower state." alt="" coords="5,5,244,76"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aabe87e2046da048da999758ebdd119fe" title="Function to compose mobility operation message with STATUS params." alt="" coords="292,13,527,69"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a657b2d890046589b62c473178a134b20_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a657b2d890046589b62c473178a134b20_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a657b2d890046589b62c473178a134b20_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a657b2d890046589b62c473178a134b20_icgraph">
<area shape="rect" title="Function to compose mobility operation in candidate follower state." alt="" coords="660,5,899,76"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a7d07b2ec081219ee9fb62418170bb1f8" title="Run Candidate Follower State." alt="" coords="429,13,612,69"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ac7e7160659b61a4ac61be14f74fb1caa" title="Spin callback function." alt="" coords="199,13,381,69"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,13,151,69"/>
</map>
</div>

</div>
</div>
<a id="a5e18795bb16ef8f84cf6e451def325bb" name="a5e18795bb16ef8f84cf6e451def325bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e18795bb16ef8f84cf6e451def325bb">&#9670;&nbsp;</a></span>composeMobilityOperationCandidateLeader()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">carma_v2x_msgs::msg::MobilityOperation platoon_strategic_ihp::PlatoonStrategicIHPPlugin::composeMobilityOperationCandidateLeader </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to compose mobility operation in CandidateLeader. </p>
<dl class="section return"><dt>Returns</dt><dd>mobility operation msg. </dd></dl>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00621">621</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  622</span>    {   </div>
<div class="line"><span class="lineno">  623</span>        <span class="comment">/*</span></div>
<div class="line"><span class="lineno">  624</span><span class="comment">            UCLA Implementation note: </span></div>
<div class="line"><span class="lineno">  625</span><span class="comment">            This is the joiner which will later become the new leader,</span></div>
<div class="line"><span class="lineno">  626</span><span class="comment">            host vehicle publish status msgs and waiting to lead the rear platoon</span></div>
<div class="line"><span class="lineno">  627</span><span class="comment">        */</span></div>
<div class="line"><span class="lineno">  628</span>        carma_v2x_msgs::msg::MobilityOperation msg;</div>
<div class="line"><span class="lineno">  629</span>        msg = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aabe87e2046da048da999758ebdd119fe">composeMobilityOperationSTATUS</a>();</div>
<div class="line"><span class="lineno">  630</span>        <span class="keywordflow">return</span> msg;</div>
<div class="line"><span class="lineno">  631</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00277">composeMobilityOperationSTATUS()</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02918">run_candidate_leader()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a5e18795bb16ef8f84cf6e451def325bb_cgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a5e18795bb16ef8f84cf6e451def325bb_cgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a5e18795bb16ef8f84cf6e451def325bb_cgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a5e18795bb16ef8f84cf6e451def325bb_cgraph">
<area shape="rect" title="Function to compose mobility operation in CandidateLeader." alt="" coords="5,5,244,76"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aabe87e2046da048da999758ebdd119fe" title="Function to compose mobility operation message with STATUS params." alt="" coords="292,13,527,69"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a5e18795bb16ef8f84cf6e451def325bb_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a5e18795bb16ef8f84cf6e451def325bb_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a5e18795bb16ef8f84cf6e451def325bb_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a5e18795bb16ef8f84cf6e451def325bb_icgraph">
<area shape="rect" title="Function to compose mobility operation in CandidateLeader." alt="" coords="660,5,899,76"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa2c3c1b6030726c8e1931ea0093dd91d" title="Run Candidate Leader State." alt="" coords="429,13,612,69"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ac7e7160659b61a4ac61be14f74fb1caa" title="Spin callback function." alt="" coords="199,13,381,69"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,13,151,69"/>
</map>
</div>

</div>
</div>
<a id="a3a80cbd904887d9fa98448f76fba7993" name="a3a80cbd904887d9fa98448f76fba7993"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a80cbd904887d9fa98448f76fba7993">&#9670;&nbsp;</a></span>composeMobilityOperationFollower()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">carma_v2x_msgs::msg::MobilityOperation platoon_strategic_ihp::PlatoonStrategicIHPPlugin::composeMobilityOperationFollower </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to compose mobility operation in follower state. </p>
<dl class="section return"><dt>Returns</dt><dd>mobility operation msg </dd></dl>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00583">583</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  584</span>    {</div>
<div class="line"><span class="lineno">  585</span>        carma_v2x_msgs::msg::MobilityOperation msg;</div>
<div class="line"><span class="lineno">  586</span>        msg = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aabe87e2046da048da999758ebdd119fe">composeMobilityOperationSTATUS</a>();</div>
<div class="line"><span class="lineno">  587</span>        <span class="keywordflow">return</span> msg;</div>
<div class="line"><span class="lineno">  588</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00277">composeMobilityOperationSTATUS()</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02679">run_follower()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a3a80cbd904887d9fa98448f76fba7993_cgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a3a80cbd904887d9fa98448f76fba7993_cgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a3a80cbd904887d9fa98448f76fba7993_cgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a3a80cbd904887d9fa98448f76fba7993_cgraph">
<area shape="rect" title="Function to compose mobility operation in follower state." alt="" coords="5,5,236,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aabe87e2046da048da999758ebdd119fe" title="Function to compose mobility operation message with STATUS params." alt="" coords="284,5,519,61"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a3a80cbd904887d9fa98448f76fba7993_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a3a80cbd904887d9fa98448f76fba7993_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a3a80cbd904887d9fa98448f76fba7993_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a3a80cbd904887d9fa98448f76fba7993_icgraph">
<area shape="rect" title="Function to compose mobility operation in follower state." alt="" coords="660,5,891,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3e9dbfe57693b6d23d99b61af6375a4f" title="Run Follower State." alt="" coords="429,5,612,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ac7e7160659b61a4ac61be14f74fb1caa" title="Spin callback function." alt="" coords="199,5,381,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,5,151,61"/>
</map>
</div>

</div>
</div>
<a id="abf34e8d8c0c18809bf551d3b04db81d4" name="abf34e8d8c0c18809bf551d3b04db81d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf34e8d8c0c18809bf551d3b04db81d4">&#9670;&nbsp;</a></span>composeMobilityOperationINFO()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">carma_v2x_msgs::msg::MobilityOperation platoon_strategic_ihp::PlatoonStrategicIHPPlugin::composeMobilityOperationINFO </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to compose mobility operation message with INFO params. </p>
<dl class="section return"><dt>Returns</dt><dd>mobility operation msg. </dd></dl>
<p >Note: INFO param format: "INFO| --&gt; LENGTH:%.2f,SPEED:%.2f,SIZE:%d,ECEFX:%.2f,ECEFY:%.2f,ECEFZ:%.2f" |----&mdash;0--------&mdash;1------&mdash;2-----&mdash;3-------&mdash;4-------&mdash;5----&mdash;|</p>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00314">314</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  315</span>    {</div>
<div class="line"><span class="lineno">  321</span>        carma_v2x_msgs::msg::MobilityOperation msg;</div>
<div class="line"><span class="lineno">  322</span>        msg.m_header.plan_id = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a634f99de503cccb2f2d3cb955623dde2">currentPlatoonID</a>; <span class="comment">// msg.m_header.plan_id is the platoon ID of the request sender (rear join and frontal join). </span></div>
<div class="line"><span class="lineno">  323</span>        msg.m_header.recipient_id = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><span class="lineno">  324</span>        std::string hostStaticId = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a473bcce97d7c50beaab678372a354c0d">vehicleID</a>;</div>
<div class="line"><span class="lineno">  325</span>        msg.m_header.sender_id = hostStaticId;</div>
<div class="line"><span class="lineno">  326</span>        msg.m_header.timestamp = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a283186f2bbb98f5f85b5486e365bb4b8">timer_factory_</a>-&gt;now().nanoseconds() / 1000000;;</div>
<div class="line"><span class="lineno">  327</span>        msg.strategy = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3be0b52376b568130c1c6a5ec5adeb13">PLATOONING_STRATEGY</a>;</div>
<div class="line"><span class="lineno">  328</span> </div>
<div class="line"><span class="lineno">  329</span>        <span class="keywordtype">double</span> CurrentPlatoonLength = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#af19d3e4a88f6875cf802442b183694a0">getCurrentPlatoonLength</a>();</div>
<div class="line"><span class="lineno">  330</span>        <span class="keywordtype">int</span> PlatoonSize = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a3ef30eeb7a7cf0caccb948e6a41f92">getHostPlatoonSize</a>();</div>
<div class="line"><span class="lineno">  331</span> </div>
<div class="line"><span class="lineno">  332</span>        boost::format fmter(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a31600df15338eab670b092e3ee34a898">OPERATION_INFO_PARAMS</a>);</div>
<div class="line"><span class="lineno">  333</span>        <span class="comment">//  Note: need to update &quot;OPERATION_INFO_PARAMS&quot; in m_header file --&gt; strategic_platoon_ihp.h  </span></div>
<div class="line"><span class="lineno">  334</span>        fmter% CurrentPlatoonLength;            <span class="comment">// index = 0, physical length of the platoon, in m.</span></div>
<div class="line"><span class="lineno">  335</span>        fmter% <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3e827c7f2e764c6e7de83f0a81a9593f">current_speed_</a>;                  <span class="comment">// index = 1, in m/s.</span></div>
<div class="line"><span class="lineno">  336</span>        fmter% PlatoonSize;                     <span class="comment">// index = 2, number of members </span></div>
<div class="line"><span class="lineno">  337</span>        fmter% <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ad10e1df213ec7524892b247d28ec9172">pose_ecef_point_</a>.ecef_x;         <span class="comment">// index = 3, in cm.</span></div>
<div class="line"><span class="lineno">  338</span>        fmter% <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ad10e1df213ec7524892b247d28ec9172">pose_ecef_point_</a>.ecef_y;         <span class="comment">// index = 4, in cm.</span></div>
<div class="line"><span class="lineno">  339</span>        fmter% <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ad10e1df213ec7524892b247d28ec9172">pose_ecef_point_</a>.ecef_z;         <span class="comment">// index = 5, in cm.</span></div>
<div class="line"><span class="lineno">  340</span> </div>
<div class="line"><span class="lineno">  341</span>        std::string infoParams = fmter.str();</div>
<div class="line"><span class="lineno">  342</span>        msg.strategy_params = infoParams;</div>
<div class="line"><span class="lineno">  343</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Composed a mobility operation message with params &quot;</span> &lt;&lt; msg.strategy_params);</div>
<div class="line"><span class="lineno">  344</span>        <span class="keywordflow">return</span> msg;</div>
<div class="line"><span class="lineno">  345</span>    }</div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_a634f99de503cccb2f2d3cb955623dde2"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a634f99de503cccb2f2d3cb955623dde2">platoon_strategic_ihp::PlatoonManager::currentPlatoonID</a></div><div class="ttdeci">std::string currentPlatoonID</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00364">platoon_manager_ihp.h:364</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_a8a3ef30eeb7a7cf0caccb948e6a41f92"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a3ef30eeb7a7cf0caccb948e6a41f92">platoon_strategic_ihp::PlatoonManager::getHostPlatoonSize</a></div><div class="ttdeci">int getHostPlatoonSize()</div><div class="ttdoc">Returns total size of the platoon , in number of vehicles.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00279">platoon_manager_ihp.cpp:279</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_af19d3e4a88f6875cf802442b183694a0"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#af19d3e4a88f6875cf802442b183694a0">platoon_strategic_ihp::PlatoonManager::getCurrentPlatoonLength</a></div><div class="ttdeci">double getCurrentPlatoonLength()</div><div class="ttdoc">Returns overall length of the platoon. in m.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00762">platoon_manager_ihp.cpp:762</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a31600df15338eab670b092e3ee34a898"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a31600df15338eab670b092e3ee34a898">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::OPERATION_INFO_PARAMS</a></div><div class="ttdeci">const std::string OPERATION_INFO_PARAMS</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8h_source.html#l00833">platoon_strategic_ihp.h:833</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a3be0b52376b568130c1c6a5ec5adeb13"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3be0b52376b568130c1c6a5ec5adeb13">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::PLATOONING_STRATEGY</a></div><div class="ttdeci">const std::string PLATOONING_STRATEGY</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8h_source.html#l00820">platoon_strategic_ihp.h:820</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a3e827c7f2e764c6e7de83f0a81a9593f"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3e827c7f2e764c6e7de83f0a81a9593f">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::current_speed_</a></div><div class="ttdeci">double current_speed_</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8h_source.html#l00328">platoon_strategic_ihp.h:328</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_ad10e1df213ec7524892b247d28ec9172"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ad10e1df213ec7524892b247d28ec9172">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::pose_ecef_point_</a></div><div class="ttdeci">carma_v2x_msgs::msg::LocationECEF pose_ecef_point_</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8h_source.html#l00257">platoon_strategic_ihp.h:257</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__strategic__ihp_8h_source.html#l00318">config_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00328">current_speed_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00364">platoon_strategic_ihp::PlatoonManager::currentPlatoonID</a>, <a class="el" href="platoon__manager__ihp_8cpp_source.html#l00762">platoon_strategic_ihp::PlatoonManager::getCurrentPlatoonLength()</a>, <a class="el" href="platoon__manager__ihp_8cpp_source.html#l00279">platoon_strategic_ihp::PlatoonManager::getHostPlatoonSize()</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00833">OPERATION_INFO_PARAMS</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00820">PLATOONING_STRATEGY</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00817">pm_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00257">pose_ecef_point_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00814">timer_factory_</a>, and <a class="el" href="platoon__config__ihp_8h_source.html#l00068">platoon_strategic_ihp::PlatoonPluginConfig::vehicleID</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00558">composeMobilityOperationLeader()</a>, and <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00646">composeMobilityOperationLeadWithOperation()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_abf34e8d8c0c18809bf551d3b04db81d4_cgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_abf34e8d8c0c18809bf551d3b04db81d4_cgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_abf34e8d8c0c18809bf551d3b04db81d4_cgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_abf34e8d8c0c18809bf551d3b04db81d4_cgraph">
<area shape="rect" title="Function to compose mobility operation message with INFO params." alt="" coords="5,41,219,97"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#af19d3e4a88f6875cf802442b183694a0" title="Returns overall length of the platoon. in m." alt="" coords="294,5,482,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a3ef30eeb7a7cf0caccb948e6a41f92" title="Returns total size of the platoon , in number of vehicles." alt="" coords="267,85,509,126"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_abf34e8d8c0c18809bf551d3b04db81d4_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_abf34e8d8c0c18809bf551d3b04db81d4_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_abf34e8d8c0c18809bf551d3b04db81d4_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_abf34e8d8c0c18809bf551d3b04db81d4_icgraph">
<area shape="rect" title="Function to compose mobility operation message with INFO params." alt="" coords="944,49,1157,105"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#afc01cfaa2979666119dff63ee09c05a6" title="Function to compose mobility operation in leader state." alt="" coords="667,5,889,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2b54d8a43eb72f0c439860b5b5793302" title="Function to compose mobility operation in LeadWithOperation (cut&#45;in join)" alt="" coords="660,86,896,157"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#acf8506705dea8579268655c4fdeb4ddf" title="Run Leader State." alt="" coords="429,8,612,64"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ac7e7160659b61a4ac61be14f74fb1caa" title="Spin callback function." alt="" coords="199,49,381,105"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,49,151,105"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ac28094ea4b6d85949859226c860d8bd6" title="UCLA Run lead with operation State." alt="" coords="429,89,612,145"/>
</map>
</div>

</div>
</div>
<a id="afc01cfaa2979666119dff63ee09c05a6" name="afc01cfaa2979666119dff63ee09c05a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc01cfaa2979666119dff63ee09c05a6">&#9670;&nbsp;</a></span>composeMobilityOperationLeader()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">carma_v2x_msgs::msg::MobilityOperation platoon_strategic_ihp::PlatoonStrategicIHPPlugin::composeMobilityOperationLeader </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>type</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to compose mobility operation in leader state. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">type</td><td>type of mobility operation (info or status)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>mobility operation msg </dd></dl>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00558">558</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  559</span>    {</div>
<div class="line"><span class="lineno">  560</span>        carma_v2x_msgs::msg::MobilityOperation msg;</div>
<div class="line"><span class="lineno">  561</span> </div>
<div class="line"><span class="lineno">  562</span>        <span class="comment">// info params</span></div>
<div class="line"><span class="lineno">  563</span>        <span class="keywordflow">if</span> (type == <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a56907ad89ed257fc81cbb7faf4221005">OPERATION_INFO_TYPE</a>) </div>
<div class="line"><span class="lineno">  564</span>        {</div>
<div class="line"><span class="lineno">  565</span>            msg = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#abf34e8d8c0c18809bf551d3b04db81d4">composeMobilityOperationINFO</a>();</div>
<div class="line"><span class="lineno">  566</span>        }</div>
<div class="line"><span class="lineno">  567</span> </div>
<div class="line"><span class="lineno">  568</span>        <span class="comment">// status params</span></div>
<div class="line"><span class="lineno">  569</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a243c9d3b652447765feab04517074520">OPERATION_STATUS_TYPE</a>) </div>
<div class="line"><span class="lineno">  570</span>        {</div>
<div class="line"><span class="lineno">  571</span>            msg = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aabe87e2046da048da999758ebdd119fe">composeMobilityOperationSTATUS</a>();</div>
<div class="line"><span class="lineno">  572</span>        }</div>
<div class="line"><span class="lineno">  573</span>        <span class="comment">// Unknown strategy param.</span></div>
<div class="line"><span class="lineno">  574</span>        <span class="keywordflow">else</span> </div>
<div class="line"><span class="lineno">  575</span>        {</div>
<div class="line"><span class="lineno">  576</span>            RCLCPP_ERROR(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>),<span class="stringliteral">&quot;UNKNOWN strategy param string!!!&quot;</span>);</div>
<div class="line"><span class="lineno">  577</span>            msg.strategy_params = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><span class="lineno">  578</span>        }</div>
<div class="line"><span class="lineno">  579</span>        <span class="keywordflow">return</span> msg;</div>
<div class="line"><span class="lineno">  580</span>    }</div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a243c9d3b652447765feab04517074520"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a243c9d3b652447765feab04517074520">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::OPERATION_STATUS_TYPE</a></div><div class="ttdeci">const std::string OPERATION_STATUS_TYPE</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8h_source.html#l00822">platoon_strategic_ihp.h:822</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a56907ad89ed257fc81cbb7faf4221005"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a56907ad89ed257fc81cbb7faf4221005">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::OPERATION_INFO_TYPE</a></div><div class="ttdeci">const std::string OPERATION_INFO_TYPE</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8h_source.html#l00821">platoon_strategic_ihp.h:821</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_abf34e8d8c0c18809bf551d3b04db81d4"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#abf34e8d8c0c18809bf551d3b04db81d4">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::composeMobilityOperationINFO</a></div><div class="ttdeci">carma_v2x_msgs::msg::MobilityOperation composeMobilityOperationINFO()</div><div class="ttdoc">Function to compose mobility operation message with INFO params.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l00314">platoon_strategic_ihp.cpp:314</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00314">composeMobilityOperationINFO()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00277">composeMobilityOperationSTATUS()</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00821">OPERATION_INFO_TYPE</a>, and <a class="el" href="platoon__strategic__ihp_8h_source.html#l00822">OPERATION_STATUS_TYPE</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02622">run_leader()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_afc01cfaa2979666119dff63ee09c05a6_cgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_afc01cfaa2979666119dff63ee09c05a6_cgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_afc01cfaa2979666119dff63ee09c05a6_cgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_afc01cfaa2979666119dff63ee09c05a6_cgraph">
<area shape="rect" title="Function to compose mobility operation in leader state." alt="" coords="5,81,227,137"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#abf34e8d8c0c18809bf551d3b04db81d4" title="Function to compose mobility operation message with INFO params." alt="" coords="285,41,499,97"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aabe87e2046da048da999758ebdd119fe" title="Function to compose mobility operation message with STATUS params." alt="" coords="275,121,509,177"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#af19d3e4a88f6875cf802442b183694a0" title="Returns overall length of the platoon. in m." alt="" coords="585,5,773,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a3ef30eeb7a7cf0caccb948e6a41f92" title="Returns total size of the platoon , in number of vehicles." alt="" coords="557,85,800,126"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_afc01cfaa2979666119dff63ee09c05a6_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_afc01cfaa2979666119dff63ee09c05a6_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_afc01cfaa2979666119dff63ee09c05a6_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_afc01cfaa2979666119dff63ee09c05a6_icgraph">
<area shape="rect" title="Function to compose mobility operation in leader state." alt="" coords="660,5,881,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#acf8506705dea8579268655c4fdeb4ddf" title="Run Leader State." alt="" coords="429,5,612,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ac7e7160659b61a4ac61be14f74fb1caa" title="Spin callback function." alt="" coords="199,5,381,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,5,151,61"/>
</map>
</div>

</div>
</div>
<a id="a20c23f25255a2e259d5ee9a4f68b722c" name="a20c23f25255a2e259d5ee9a4f68b722c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20c23f25255a2e259d5ee9a4f68b722c">&#9670;&nbsp;</a></span>composeMobilityOperationLeaderAborting()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">carma_v2x_msgs::msg::MobilityOperation platoon_strategic_ihp::PlatoonStrategicIHPPlugin::composeMobilityOperationLeaderAborting </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to compose mobility operation in LeaderAborting state. </p>
<dl class="section return"><dt>Returns</dt><dd>mobility operation msg. </dd></dl>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00609">609</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  610</span>    {   </div>
<div class="line"><span class="lineno">  611</span>        <span class="comment">/*</span></div>
<div class="line"><span class="lineno">  612</span><span class="comment">            UCLA Implementation note: </span></div>
<div class="line"><span class="lineno">  613</span><span class="comment">            Sending STATUS info for member updates and platoon trajectory regulation.</span></div>
<div class="line"><span class="lineno">  614</span><span class="comment">        */</span></div>
<div class="line"><span class="lineno">  615</span>        carma_v2x_msgs::msg::MobilityOperation msg;</div>
<div class="line"><span class="lineno">  616</span>        msg = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aabe87e2046da048da999758ebdd119fe">composeMobilityOperationSTATUS</a>();</div>
<div class="line"><span class="lineno">  617</span>        <span class="keywordflow">return</span> msg;</div>
<div class="line"><span class="lineno">  618</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00277">composeMobilityOperationSTATUS()</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02822">run_leader_aborting()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a20c23f25255a2e259d5ee9a4f68b722c_cgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a20c23f25255a2e259d5ee9a4f68b722c_cgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a20c23f25255a2e259d5ee9a4f68b722c_cgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a20c23f25255a2e259d5ee9a4f68b722c_cgraph">
<area shape="rect" title="Function to compose mobility operation in LeaderAborting state." alt="" coords="5,5,227,76"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aabe87e2046da048da999758ebdd119fe" title="Function to compose mobility operation message with STATUS params." alt="" coords="275,13,509,69"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a20c23f25255a2e259d5ee9a4f68b722c_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a20c23f25255a2e259d5ee9a4f68b722c_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a20c23f25255a2e259d5ee9a4f68b722c_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a20c23f25255a2e259d5ee9a4f68b722c_icgraph">
<area shape="rect" title="Function to compose mobility operation in LeaderAborting state." alt="" coords="660,5,881,76"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a848aac5dfc1f6a3c4fba8fa0bba0ca66" title="Run Leader Aborting State." alt="" coords="429,13,612,69"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ac7e7160659b61a4ac61be14f74fb1caa" title="Spin callback function." alt="" coords="199,13,381,69"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,13,151,69"/>
</map>
</div>

</div>
</div>
<a id="a95d140cc05909e28936b714f41862fc9" name="a95d140cc05909e28936b714f41862fc9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95d140cc05909e28936b714f41862fc9">&#9670;&nbsp;</a></span>composeMobilityOperationLeaderWaiting()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">carma_v2x_msgs::msg::MobilityOperation platoon_strategic_ihp::PlatoonStrategicIHPPlugin::composeMobilityOperationLeaderWaiting </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to compose mobility operation in leader waiting state. </p>
<dl class="section return"><dt>Returns</dt><dd>mobility operation msg </dd></dl>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00591">591</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  592</span>    {</div>
<div class="line"><span class="lineno">  593</span>        <span class="comment">//TODO: shouldn&#39;t a leaderwaiting also be sending INFO messages since it is still leading?</span></div>
<div class="line"><span class="lineno">  594</span> </div>
<div class="line"><span class="lineno">  595</span>        carma_v2x_msgs::msg::MobilityOperation msg;</div>
<div class="line"><span class="lineno">  596</span>        msg = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aabe87e2046da048da999758ebdd119fe">composeMobilityOperationSTATUS</a>();</div>
<div class="line"><span class="lineno">  597</span>        <span class="keywordflow">return</span> msg;</div>
<div class="line"><span class="lineno">  598</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00277">composeMobilityOperationSTATUS()</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02597">run_leader_waiting()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a95d140cc05909e28936b714f41862fc9_cgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a95d140cc05909e28936b714f41862fc9_cgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a95d140cc05909e28936b714f41862fc9_cgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a95d140cc05909e28936b714f41862fc9_cgraph">
<area shape="rect" title="Function to compose mobility operation in leader waiting state." alt="" coords="5,5,227,76"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aabe87e2046da048da999758ebdd119fe" title="Function to compose mobility operation message with STATUS params." alt="" coords="275,13,509,69"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a95d140cc05909e28936b714f41862fc9_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a95d140cc05909e28936b714f41862fc9_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a95d140cc05909e28936b714f41862fc9_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a95d140cc05909e28936b714f41862fc9_icgraph">
<area shape="rect" title="Function to compose mobility operation in leader waiting state." alt="" coords="660,5,881,76"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a7bcebb0d98ab80013c945a2ec283250e" title="Run Leader Waiting State." alt="" coords="429,13,612,69"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ac7e7160659b61a4ac61be14f74fb1caa" title="Spin callback function." alt="" coords="199,13,381,69"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,13,151,69"/>
</map>
</div>

</div>
</div>
<a id="a2b54d8a43eb72f0c439860b5b5793302" name="a2b54d8a43eb72f0c439860b5b5793302"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b54d8a43eb72f0c439860b5b5793302">&#9670;&nbsp;</a></span>composeMobilityOperationLeadWithOperation()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">carma_v2x_msgs::msg::MobilityOperation platoon_strategic_ihp::PlatoonStrategicIHPPlugin::composeMobilityOperationLeadWithOperation </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>type</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to compose mobility operation in LeadWithOperation (cut-in join) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">type</td><td>type of mobility operation (info or status)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>msg: mobility operation msg Return null ("") if the incoming message is trashed/unrecognized. </dd></dl>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00646">646</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  647</span>    {</div>
<div class="line"><span class="lineno">  648</span>        carma_v2x_msgs::msg::MobilityOperation msg;</div>
<div class="line"><span class="lineno">  649</span>        </div>
<div class="line"><span class="lineno">  650</span>        <span class="comment">// info params</span></div>
<div class="line"><span class="lineno">  651</span>        <span class="keywordflow">if</span> (type == <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a56907ad89ed257fc81cbb7faf4221005">OPERATION_INFO_TYPE</a>) </div>
<div class="line"><span class="lineno">  652</span>        {</div>
<div class="line"><span class="lineno">  653</span>            msg = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#abf34e8d8c0c18809bf551d3b04db81d4">composeMobilityOperationINFO</a>();</div>
<div class="line"><span class="lineno">  654</span>        }</div>
<div class="line"><span class="lineno">  655</span> </div>
<div class="line"><span class="lineno">  656</span>        <span class="comment">// status params</span></div>
<div class="line"><span class="lineno">  657</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a243c9d3b652447765feab04517074520">OPERATION_STATUS_TYPE</a>) </div>
<div class="line"><span class="lineno">  658</span>        {</div>
<div class="line"><span class="lineno">  659</span>            msg = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aabe87e2046da048da999758ebdd119fe">composeMobilityOperationSTATUS</a>();</div>
<div class="line"><span class="lineno">  660</span>        }</div>
<div class="line"><span class="lineno">  661</span>        <span class="comment">// Unknown strategy param.</span></div>
<div class="line"><span class="lineno">  662</span>        <span class="keywordflow">else</span> </div>
<div class="line"><span class="lineno">  663</span>        {</div>
<div class="line"><span class="lineno">  664</span>            RCLCPP_ERROR(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>),<span class="stringliteral">&quot;UNKNOWN strategy param string!!!&quot;</span>);</div>
<div class="line"><span class="lineno">  665</span>            msg.strategy_params = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><span class="lineno">  666</span>        }</div>
<div class="line"><span class="lineno">  667</span>        <span class="keywordflow">return</span> msg;</div>
<div class="line"><span class="lineno">  668</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00314">composeMobilityOperationINFO()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00277">composeMobilityOperationSTATUS()</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00821">OPERATION_INFO_TYPE</a>, and <a class="el" href="platoon__strategic__ihp_8h_source.html#l00822">OPERATION_STATUS_TYPE</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02945">run_lead_with_operation()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a2b54d8a43eb72f0c439860b5b5793302_cgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a2b54d8a43eb72f0c439860b5b5793302_cgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a2b54d8a43eb72f0c439860b5b5793302_cgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a2b54d8a43eb72f0c439860b5b5793302_cgraph">
<area shape="rect" title="Function to compose mobility operation in LeadWithOperation (cut&#45;in join)" alt="" coords="5,74,241,145"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#abf34e8d8c0c18809bf551d3b04db81d4" title="Function to compose mobility operation message with INFO params." alt="" coords="300,41,513,97"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aabe87e2046da048da999758ebdd119fe" title="Function to compose mobility operation message with STATUS params." alt="" coords="289,121,524,177"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#af19d3e4a88f6875cf802442b183694a0" title="Returns overall length of the platoon. in m." alt="" coords="599,5,787,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a3ef30eeb7a7cf0caccb948e6a41f92" title="Returns total size of the platoon , in number of vehicles." alt="" coords="572,85,815,126"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a2b54d8a43eb72f0c439860b5b5793302_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a2b54d8a43eb72f0c439860b5b5793302_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a2b54d8a43eb72f0c439860b5b5793302_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a2b54d8a43eb72f0c439860b5b5793302_icgraph">
<area shape="rect" title="Function to compose mobility operation in LeadWithOperation (cut&#45;in join)" alt="" coords="660,5,896,76"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ac28094ea4b6d85949859226c860d8bd6" title="UCLA Run lead with operation State." alt="" coords="429,13,612,69"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ac7e7160659b61a4ac61be14f74fb1caa" title="Spin callback function." alt="" coords="199,13,381,69"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,13,151,69"/>
</map>
</div>

</div>
</div>
<a id="a4e1a6de5a77b7bceab316768df37fc50" name="a4e1a6de5a77b7bceab316768df37fc50"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e1a6de5a77b7bceab316768df37fc50">&#9670;&nbsp;</a></span>composeMobilityOperationPrepareToJoin()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">carma_v2x_msgs::msg::MobilityOperation platoon_strategic_ihp::PlatoonStrategicIHPPlugin::composeMobilityOperationPrepareToJoin </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to compose mobility operation in PrepareToJoin (cut-in join) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">type</td><td>type of mobility operation (info or status)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>msg: mobility operation msg Return null ("") if the incoming message is trashed/unrecognized. </dd></dl>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00634">634</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  635</span>    {</div>
<div class="line"><span class="lineno">  636</span>        <span class="comment">/*</span></div>
<div class="line"><span class="lineno">  637</span><span class="comment">            UCLA Implementation note: </span></div>
<div class="line"><span class="lineno">  638</span><span class="comment">            This is the joiner that is preapring for cut-in join.</span></div>
<div class="line"><span class="lineno">  639</span><span class="comment">            host vehicle publish status msgs and waiting to lead the rear platoon.</span></div>
<div class="line"><span class="lineno">  640</span><span class="comment">        */</span></div>
<div class="line"><span class="lineno">  641</span>        carma_v2x_msgs::msg::MobilityOperation msg;</div>
<div class="line"><span class="lineno">  642</span>        msg = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aabe87e2046da048da999758ebdd119fe">composeMobilityOperationSTATUS</a>();</div>
<div class="line"><span class="lineno">  643</span>        <span class="keywordflow">return</span> msg;</div>
<div class="line"><span class="lineno">  644</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00277">composeMobilityOperationSTATUS()</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02977">run_prepare_to_join()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a4e1a6de5a77b7bceab316768df37fc50_cgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a4e1a6de5a77b7bceab316768df37fc50_cgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a4e1a6de5a77b7bceab316768df37fc50_cgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a4e1a6de5a77b7bceab316768df37fc50_cgraph">
<area shape="rect" title="Function to compose mobility operation in PrepareToJoin (cut&#45;in join)" alt="" coords="5,5,232,76"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aabe87e2046da048da999758ebdd119fe" title="Function to compose mobility operation message with STATUS params." alt="" coords="280,13,515,69"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a4e1a6de5a77b7bceab316768df37fc50_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a4e1a6de5a77b7bceab316768df37fc50_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a4e1a6de5a77b7bceab316768df37fc50_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a4e1a6de5a77b7bceab316768df37fc50_icgraph">
<area shape="rect" title="Function to compose mobility operation in PrepareToJoin (cut&#45;in join)" alt="" coords="660,5,887,76"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a8c989d9220109cab74fb8aff6212f27e" title="UCLA Run prepare to join State." alt="" coords="429,13,612,69"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ac7e7160659b61a4ac61be14f74fb1caa" title="Spin callback function." alt="" coords="199,13,381,69"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,13,151,69"/>
</map>
</div>

</div>
</div>
<a id="aabe87e2046da048da999758ebdd119fe" name="aabe87e2046da048da999758ebdd119fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aabe87e2046da048da999758ebdd119fe">&#9670;&nbsp;</a></span>composeMobilityOperationSTATUS()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">carma_v2x_msgs::msg::MobilityOperation platoon_strategic_ihp::PlatoonStrategicIHPPlugin::composeMobilityOperationSTATUS </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to compose mobility operation message with STATUS params. </p>
<dl class="section return"><dt>Returns</dt><dd>mobility operation msg. </dd></dl>
<p >Note: STATUS params format: STATUS | --&gt; "CMDSPEED:%1%,SPEED:%2%,ECEFX:%3%,ECEFY:%4%,ECEFZ:%5%" |-------&mdash;0-------&mdash;1------&mdash;2------&mdash;3------&mdash;4---&mdash;|</p>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00277">277</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  278</span>    {    </div>
<div class="line"><span class="lineno">  285</span>        <span class="comment">//TODO future: consider setting recipient_id to the platoon ID to make it obvious that anyone in that group is intended reader.</span></div>
<div class="line"><span class="lineno">  286</span>        <span class="comment">//             This requires an architectural agreement on use of group messaging protocol.</span></div>
<div class="line"><span class="lineno">  287</span> </div>
<div class="line"><span class="lineno">  288</span>        <span class="comment">// Extract data</span></div>
<div class="line"><span class="lineno">  289</span>        carma_v2x_msgs::msg::MobilityOperation msg;</div>
<div class="line"><span class="lineno">  290</span>        msg.m_header.plan_id = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a634f99de503cccb2f2d3cb955623dde2">currentPlatoonID</a>;</div>
<div class="line"><span class="lineno">  291</span>        msg.m_header.recipient_id = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><span class="lineno">  292</span>        std::string hostStaticId = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a473bcce97d7c50beaab678372a354c0d">vehicleID</a>;</div>
<div class="line"><span class="lineno">  293</span>        msg.m_header.sender_id = hostStaticId;</div>
<div class="line"><span class="lineno">  294</span>        msg.m_header.timestamp = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a283186f2bbb98f5f85b5486e365bb4b8">timer_factory_</a>-&gt;now().nanoseconds() / 1000000;</div>
<div class="line"><span class="lineno">  295</span>        msg.strategy = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3be0b52376b568130c1c6a5ec5adeb13">PLATOONING_STRATEGY</a>;</div>
<div class="line"><span class="lineno">  296</span> </div>
<div class="line"><span class="lineno">  297</span>        <span class="comment">// form message </span></div>
<div class="line"><span class="lineno">  298</span>        <span class="keywordtype">double</span> cmdSpeed = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a04e00e8747e98a33b4f708b8e9e58042">cmd_speed_</a>;</div>
<div class="line"><span class="lineno">  299</span>        boost::format fmter(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ac80b2f23cf6b860b8cad5c5b6f7a120b">OPERATION_STATUS_PARAMS</a>);</div>
<div class="line"><span class="lineno">  300</span>        fmter% cmdSpeed;                <span class="comment">// index = 0, in m/s.</span></div>
<div class="line"><span class="lineno">  301</span>        fmter% <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3e827c7f2e764c6e7de83f0a81a9593f">current_speed_</a>;          <span class="comment">// index = 1, in m/s.</span></div>
<div class="line"><span class="lineno">  302</span>        fmter% <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ad10e1df213ec7524892b247d28ec9172">pose_ecef_point_</a>.ecef_x; <span class="comment">// index = 2, in cm.</span></div>
<div class="line"><span class="lineno">  303</span>        fmter% <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ad10e1df213ec7524892b247d28ec9172">pose_ecef_point_</a>.ecef_y; <span class="comment">// index = 3, in cm.</span></div>
<div class="line"><span class="lineno">  304</span>        fmter% <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ad10e1df213ec7524892b247d28ec9172">pose_ecef_point_</a>.ecef_z; <span class="comment">// index = 4, in cm.</span></div>
<div class="line"><span class="lineno">  305</span> </div>
<div class="line"><span class="lineno">  306</span>        <span class="comment">// compose message</span></div>
<div class="line"><span class="lineno">  307</span>        std::string statusParams = fmter.str();</div>
<div class="line"><span class="lineno">  308</span>        msg.strategy_params = statusParams;</div>
<div class="line"><span class="lineno">  309</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Composed a mobility operation message with params &quot;</span> &lt;&lt; msg.strategy_params);</div>
<div class="line"><span class="lineno">  310</span>        <span class="keywordflow">return</span> msg;</div>
<div class="line"><span class="lineno">  311</span>    }</div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_ac80b2f23cf6b860b8cad5c5b6f7a120b"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ac80b2f23cf6b860b8cad5c5b6f7a120b">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::OPERATION_STATUS_PARAMS</a></div><div class="ttdeci">const std::string OPERATION_STATUS_PARAMS</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8h_source.html#l00842">platoon_strategic_ihp.h:842</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__strategic__ihp_8h_source.html#l00326">cmd_speed_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00318">config_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00328">current_speed_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00364">platoon_strategic_ihp::PlatoonManager::currentPlatoonID</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00842">OPERATION_STATUS_PARAMS</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00820">PLATOONING_STRATEGY</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00817">pm_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00257">pose_ecef_point_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00814">timer_factory_</a>, and <a class="el" href="platoon__config__ihp_8h_source.html#l00068">platoon_strategic_ihp::PlatoonPluginConfig::vehicleID</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00601">composeMobilityOperationCandidateFollower()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00621">composeMobilityOperationCandidateLeader()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00583">composeMobilityOperationFollower()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00558">composeMobilityOperationLeader()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00609">composeMobilityOperationLeaderAborting()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00591">composeMobilityOperationLeaderWaiting()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00646">composeMobilityOperationLeadWithOperation()</a>, and <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00634">composeMobilityOperationPrepareToJoin()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aabe87e2046da048da999758ebdd119fe_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aabe87e2046da048da999758ebdd119fe_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aabe87e2046da048da999758ebdd119fe_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aabe87e2046da048da999758ebdd119fe_icgraph">
<area shape="rect" title="Function to compose mobility operation message with STATUS params." alt="" coords="947,319,1181,375"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a657b2d890046589b62c473178a134b20" title="Function to compose mobility operation in candidate follower state." alt="" coords="660,5,899,76"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a5e18795bb16ef8f84cf6e451def325bb" title="Function to compose mobility operation in CandidateLeader." alt="" coords="660,100,899,171"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3a80cbd904887d9fa98448f76fba7993" title="Function to compose mobility operation in follower state." alt="" coords="664,195,895,251"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#afc01cfaa2979666119dff63ee09c05a6" title="Function to compose mobility operation in leader state." alt="" coords="669,275,890,331"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a20c23f25255a2e259d5ee9a4f68b722c" title="Function to compose mobility operation in LeaderAborting state." alt="" coords="669,356,890,427"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a95d140cc05909e28936b714f41862fc9" title="Function to compose mobility operation in leader waiting state." alt="" coords="669,451,890,521"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2b54d8a43eb72f0c439860b5b5793302" title="Function to compose mobility operation in LeadWithOperation (cut&#45;in join)" alt="" coords="661,545,897,616"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a4e1a6de5a77b7bceab316768df37fc50" title="Function to compose mobility operation in PrepareToJoin (cut&#45;in join)" alt="" coords="666,640,893,711"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a7d07b2ec081219ee9fb62418170bb1f8" title="Run Candidate Follower State." alt="" coords="429,22,612,78"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ac7e7160659b61a4ac61be14f74fb1caa" title="Spin callback function." alt="" coords="199,322,381,378"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,322,151,378"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa2c3c1b6030726c8e1931ea0093dd91d" title="Run Candidate Leader State." alt="" coords="429,111,612,167"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3e9dbfe57693b6d23d99b61af6375a4f" title="Run Follower State." alt="" coords="429,197,612,253"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#acf8506705dea8579268655c4fdeb4ddf" title="Run Leader State." alt="" coords="429,278,612,334"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a848aac5dfc1f6a3c4fba8fa0bba0ca66" title="Run Leader Aborting State." alt="" coords="429,362,612,418"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a7bcebb0d98ab80013c945a2ec283250e" title="Run Leader Waiting State." alt="" coords="429,450,612,506"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ac28094ea4b6d85949859226c860d8bd6" title="UCLA Run lead with operation State." alt="" coords="429,546,612,602"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a8c989d9220109cab74fb8aff6212f27e" title="UCLA Run prepare to join State." alt="" coords="429,633,612,689"/>
</map>
</div>

</div>
</div>
<a id="ac86657c9cd45018b1f8544e47be1e5dc" name="ac86657c9cd45018b1f8544e47be1e5dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac86657c9cd45018b1f8544e47be1e5dc">&#9670;&nbsp;</a></span>composePlatoonInfoMsg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">carma_planning_msgs::msg::PlatooningInfo platoon_strategic_ihp::PlatoonStrategicIHPPlugin::composePlatoonInfoMsg </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compose Platoon information message. </p>
<dl class="section return"><dt>Returns</dt><dd>PlatooningInfo msg</dd></dl>
<p>Note: There is a difference between the "platoon info status" versus the the "platoon strategic plugin states". </p><pre class="fragment">  [platooning info status]
  The "platooning info status" reflect the overall operating status. The status can 
  include vehicles in different "platoon strategic plugin states" as long as the current state is relavent 
  to the genral status.

  [platoon strategic plugin states]
  The "platoon strategic plugin states" manage the negotiation strategies and 
  vehicle communication in a more refined manner that can achieve the "platooning info status'" objective. Hence, 
  vehicles in different states will behave differently based on the corresponding roles and predefined rules. 
  However, they can belong to the same "platooning info statu" for the same operation purpose. 

  [Example]  
  Multiple strategic states, such as "leader aborting" and "candidate follower", can both be mapped to 
  "connecting to new leader" platooning info status, as both states are serving the same purpose of connecting 
  to the leader. 
</pre> <p >Note: There is a difference between the "platoon info status" versus the the "platoon strategic plugin states". The "platooning info status" reflect the overall operating status. The "platoon strategic plugin states" manage the negotiation strategies and vehicle communication in a more refined manner. A more detailed note can be found in the corresponding function declaration in "platoon_strategic_ihp.h" file.</p>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00419">419</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  420</span>    {</div>
<div class="line"><span class="lineno">  428</span>        carma_planning_msgs::msg::PlatooningInfo status_msg;</div>
<div class="line"><span class="lineno">  429</span> </div>
<div class="line"><span class="lineno">  430</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> == <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa839ccd0c7e2e3441b3cd9ca0546be97b">PlatoonState::STANDBY</a>)</div>
<div class="line"><span class="lineno">  431</span>        {</div>
<div class="line"><span class="lineno">  432</span>            status_msg.state = carma_planning_msgs::msg::PlatooningInfo::DISABLED;</div>
<div class="line"><span class="lineno">  433</span>        }</div>
<div class="line"><span class="lineno">  434</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> == <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa57f78e815f4fc2ac271a9fd85cd80ebc">PlatoonState::LEADER</a>)</div>
<div class="line"><span class="lineno">  435</span>        {</div>
<div class="line"><span class="lineno">  436</span>            status_msg.state = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a3ef30eeb7a7cf0caccb948e6a41f92">getHostPlatoonSize</a>() == 1 ? carma_planning_msgs::msg::PlatooningInfo::SEARCHING : carma_planning_msgs::msg::PlatooningInfo::LEADING;</div>
<div class="line"><span class="lineno">  437</span>        }</div>
<div class="line"><span class="lineno">  438</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> == <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa70d610aa504abb163caf9a5ee931d090">PlatoonState::LEADERWAITING</a>)</div>
<div class="line"><span class="lineno">  439</span>        {</div>
<div class="line"><span class="lineno">  440</span>            status_msg.state = carma_planning_msgs::msg::PlatooningInfo::CONNECTING_TO_NEW_FOLLOWER;</div>
<div class="line"><span class="lineno">  441</span>        }</div>
<div class="line"><span class="lineno">  442</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> == <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafab7680aa6ec3a24dc42cb374192eb39a3">PlatoonState::CANDIDATEFOLLOWER</a>)</div>
<div class="line"><span class="lineno">  443</span>        {</div>
<div class="line"><span class="lineno">  444</span>            status_msg.state = carma_planning_msgs::msg::PlatooningInfo::CONNECTING_TO_NEW_LEADER;</div>
<div class="line"><span class="lineno">  445</span>        }</div>
<div class="line"><span class="lineno">  446</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> == <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa0d2c16ab07ed24865f7ba27ad8a83dc0">PlatoonState::FOLLOWER</a>)</div>
<div class="line"><span class="lineno">  447</span>        {</div>
<div class="line"><span class="lineno">  448</span>            status_msg.state = carma_planning_msgs::msg::PlatooningInfo::FOLLOWING;</div>
<div class="line"><span class="lineno">  449</span>        }</div>
<div class="line"><span class="lineno">  450</span>        <span class="comment">// UCLA: add leader aborting for frontal join (inherited from candidate follower).</span></div>
<div class="line"><span class="lineno">  451</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> == <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafae176dd79ff2c2bc4b2f7901fbfc53014">PlatoonState::LEADERABORTING</a>)</div>
<div class="line"><span class="lineno">  452</span>        {</div>
<div class="line"><span class="lineno">  453</span>            status_msg.state = carma_planning_msgs::msg::PlatooningInfo::CONNECTING_TO_NEW_LEADER;</div>
<div class="line"><span class="lineno">  454</span>        }</div>
<div class="line"><span class="lineno">  455</span>        <span class="comment">// UCLA: add candidate leader for frontal join (inherited from leader waiting).</span></div>
<div class="line"><span class="lineno">  456</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> == <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa52c17c95a5cd81220db3fdd9181d43bd">PlatoonState::CANDIDATELEADER</a>)</div>
<div class="line"><span class="lineno">  457</span>        {</div>
<div class="line"><span class="lineno">  458</span>            status_msg.state = carma_planning_msgs::msg::PlatooningInfo::CONNECTING_TO_NEW_FOLLOWER;</div>
<div class="line"><span class="lineno">  459</span>        }</div>
<div class="line"><span class="lineno">  460</span>        <span class="comment">// UCLA: add &quot;lead with operation&quot; for frontal join (inherited from leader waiting).</span></div>
<div class="line"><span class="lineno">  461</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> == <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa7d32254f1798e4564e467d332c383112">PlatoonState::LEADWITHOPERATION</a>)</div>
<div class="line"><span class="lineno">  462</span>        {</div>
<div class="line"><span class="lineno">  463</span>            status_msg.state = carma_planning_msgs::msg::PlatooningInfo::CONNECTING_TO_NEW_FOLLOWER;</div>
<div class="line"><span class="lineno">  464</span>        }</div>
<div class="line"><span class="lineno">  465</span>        <span class="comment">// UCLA: add &quot;prepare to join&quot; for frontal join (inherited from leader waiting).</span></div>
<div class="line"><span class="lineno">  466</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> == <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafafe45c20d03a8d502486cff766672bdf9">PlatoonState::PREPARETOJOIN</a>)</div>
<div class="line"><span class="lineno">  467</span>        {</div>
<div class="line"><span class="lineno">  468</span>            status_msg.state = carma_planning_msgs::msg::PlatooningInfo::CONNECTING_TO_NEW_LEADER;</div>
<div class="line"><span class="lineno">  469</span>        }</div>
<div class="line"><span class="lineno">  470</span>        <span class="comment">//TODO: Place holder for departure (PREPARE TO DEPART)</span></div>
<div class="line"><span class="lineno">  471</span>        </div>
<div class="line"><span class="lineno">  472</span>        <span class="comment">// compose msgs for anything other than standby</span></div>
<div class="line"><span class="lineno">  473</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> != <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa839ccd0c7e2e3441b3cd9ca0546be97b">PlatoonState::STANDBY</a>)</div>
<div class="line"><span class="lineno">  474</span>        {</div>
<div class="line"><span class="lineno">  475</span>            status_msg.platoon_id = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a634f99de503cccb2f2d3cb955623dde2">currentPlatoonID</a>;</div>
<div class="line"><span class="lineno">  476</span>            status_msg.size = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a3ef30eeb7a7cf0caccb948e6a41f92">getHostPlatoonSize</a>();</div>
<div class="line"><span class="lineno">  477</span>            status_msg.size_limit = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a3e37e742ba6eab41498ab7da49abef91">maxPlatoonSize</a>;</div>
<div class="line"><span class="lineno">  478</span> </div>
<div class="line"><span class="lineno">  479</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> == <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa0d2c16ab07ed24865f7ba27ad8a83dc0">PlatoonState::FOLLOWER</a>)</div>
<div class="line"><span class="lineno">  480</span>            {</div>
<div class="line"><span class="lineno">  481</span>                PlatoonMember platoon_leader = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a26b94722e82060dda554ef168626727c">getDynamicLeader</a>();</div>
<div class="line"><span class="lineno">  482</span>                status_msg.leader_id = platoon_leader.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonMember.html#af1c48353e45a30b01a1d59fdd1a19c9f">staticId</a>;</div>
<div class="line"><span class="lineno">  483</span>                status_msg.leader_downtrack_distance = platoon_leader.vehiclePosition;</div>
<div class="line"><span class="lineno">  484</span>                status_msg.leader_cmd_speed = platoon_leader.commandSpeed;</div>
<div class="line"><span class="lineno">  485</span>                status_msg.host_platoon_position = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a1de160740f47d9b0198e42dcbe67a6fe">getNumberOfVehicleInFront</a>();</div>
<div class="line"><span class="lineno">  486</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;pm platoonsize: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a3ef30eeb7a7cf0caccb948e6a41f92">getHostPlatoonSize</a>() &lt;&lt; <span class="stringliteral">&quot;, platoon_leader &quot;</span> &lt;&lt; platoon_leader.staticId);</div>
<div class="line"><span class="lineno">  487</span> </div>
<div class="line"><span class="lineno">  488</span>                <span class="keywordtype">int</span> numOfVehiclesGaps = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a1de160740f47d9b0198e42dcbe67a6fe">getNumberOfVehicleInFront</a>() - <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a5f0e8506da98a7cb29aca9750e310319">dynamic_leader_index_</a>;</div>
<div class="line"><span class="lineno">  489</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;The host vehicle have &quot;</span> &lt;&lt; numOfVehiclesGaps &lt;&lt; <span class="stringliteral">&quot; vehicles between itself and its leader (includes the leader)&quot;</span>);</div>
<div class="line"><span class="lineno">  490</span>                </div>
<div class="line"><span class="lineno">  491</span>                <span class="comment">// use current position to find lanelet ID</span></div>
<div class="line"><span class="lineno">  492</span>                lanelet::BasicPoint2d current_loc(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa67d1b97f198e2f088fb24ffb8e0c690">pose_msg_</a>.pose.position.x, <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa67d1b97f198e2f088fb24ffb8e0c690">pose_msg_</a>.pose.position.y);</div>
<div class="line"><span class="lineno">  493</span> </div>
<div class="line"><span class="lineno">  494</span>                <span class="keyword">auto</span> llts = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae65a18d1f14ecdfae3409e47e59a1031">wm_</a>-&gt;getLaneletsFromPoint(current_loc, 1);</div>
<div class="line"><span class="lineno">  495</span> </div>
<div class="line"><span class="lineno">  496</span>                <span class="keywordtype">double</span> lanelet_digitalgap = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#ac8d626f63900bae289b590bde67b35a6">standStillHeadway</a>;</div>
<div class="line"><span class="lineno">  497</span> </div>
<div class="line"><span class="lineno">  498</span>                <span class="keywordflow">if</span> (!llts.empty())</div>
<div class="line"><span class="lineno">  499</span>                {</div>
<div class="line"><span class="lineno">  500</span>                    <span class="keyword">auto</span> geofence_gaps = llts[0].regulatoryElementsAs&lt;lanelet::DigitalMinimumGap&gt;();</div>
<div class="line"><span class="lineno">  501</span>                    </div>
<div class="line"><span class="lineno">  502</span>                    <span class="keywordflow">if</span> (!geofence_gaps.empty())</div>
<div class="line"><span class="lineno">  503</span>                    {</div>
<div class="line"><span class="lineno">  504</span>                        lanelet_digitalgap = geofence_gaps[0]-&gt;getMinimumGap();</div>
<div class="line"><span class="lineno">  505</span>                    }</div>
<div class="line"><span class="lineno">  506</span>                }</div>
<div class="line"><span class="lineno">  507</span> </div>
<div class="line"><span class="lineno">  508</span>                <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  509</span>                {</div>
<div class="line"><span class="lineno">  510</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;No lanelets in this location!!!: &quot;</span>);</div>
<div class="line"><span class="lineno">  511</span>                }</div>
<div class="line"><span class="lineno">  512</span>                </div>
<div class="line"><span class="lineno">  513</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;lanelet_digitalgap: &quot;</span> &lt;&lt; lanelet_digitalgap);</div>
<div class="line"><span class="lineno">  514</span>                <span class="keywordtype">double</span> desired_headway = std::max(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3e827c7f2e764c6e7de83f0a81a9593f">current_speed_</a> * <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a5d5fe22035fdba42dae4e023263499ca">timeHeadway</a>, lanelet_digitalgap);</div>
<div class="line"><span class="lineno">  515</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;speed based gap: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3e827c7f2e764c6e7de83f0a81a9593f">current_speed_</a> * <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a5d5fe22035fdba42dae4e023263499ca">timeHeadway</a>);</div>
<div class="line"><span class="lineno">  516</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;max desired_headway &quot;</span> &lt;&lt; desired_headway);</div>
<div class="line"><span class="lineno">  517</span>                <span class="comment">// TODO: currently the average length of the vehicle is obtained from a config parameter. In future, plugin needs to be updated to receive each vehicle&#39;s actual length through status or BSM messages for more accuracy.</span></div>
<div class="line"><span class="lineno">  518</span>                status_msg.desired_gap = std::max(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#ac8d626f63900bae289b590bde67b35a6">standStillHeadway</a> * numOfVehiclesGaps, desired_headway * numOfVehiclesGaps) + (numOfVehiclesGaps - 1) * 5.0;<span class="comment">//config_.averageVehicleLength;</span></div>
<div class="line"><span class="lineno">  519</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;The desired gap with the leader is &quot;</span> &lt;&lt; status_msg.desired_gap);</div>
<div class="line"><span class="lineno">  520</span> </div>
<div class="line"><span class="lineno">  521</span> </div>
<div class="line"><span class="lineno">  522</span>                <span class="comment">// TODO: To uncomment the following lines, platooninfo msg must be updated</span></div>
<div class="line"><span class="lineno">  523</span>                <span class="comment">// UCLA: Add the value of the summation of &quot;veh_len/veh_speed&quot; for all predecessors</span></div>
<div class="line"><span class="lineno">  524</span>                status_msg.current_predecessor_time_headway_sum = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acde63c37282d68d2a407359d735d3446">getPredecessorTimeHeadwaySum</a>();</div>
<div class="line"><span class="lineno">  525</span>                <span class="comment">// UCLA: preceding vehicle info </span></div>
<div class="line"><span class="lineno">  526</span>                status_msg.predecessor_speed = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#abee9a2b28eac60e3a326656ada2d7630">getPredecessorSpeed</a>();</div>
<div class="line"><span class="lineno">  527</span>                status_msg.predecessor_position = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8dcec182e6480989f16493cdae76e445">getPredecessorPosition</a>();</div>
<div class="line"><span class="lineno">  528</span> </div>
<div class="line"><span class="lineno">  529</span>                <span class="comment">// Note: use isCreateGap to adjust the desired gap send to control plugin </span></div>
<div class="line"><span class="lineno">  530</span>                <span class="keywordtype">double</span> regular_gap = status_msg.desired_gap;</div>
<div class="line"><span class="lineno">  531</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;regular_gap: &quot;</span> &lt;&lt; regular_gap);</div>
<div class="line"><span class="lineno">  532</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;current_speed_: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3e827c7f2e764c6e7de83f0a81a9593f">current_speed_</a>);</div>
<div class="line"><span class="lineno">  533</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;speed based gap: &quot;</span> &lt;&lt; desired_headway);</div>
<div class="line"><span class="lineno">  534</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0dfb4a15be2cf69ca770fcde1bdf65f5">isCreateGap</a>){</div>
<div class="line"><span class="lineno">  535</span>                    <span class="comment">// enlarged desired gap for gap creation</span></div>
<div class="line"><span class="lineno">  536</span>                    status_msg.desired_gap = regular_gap*(1 + <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a52907b228ff49305bd3c1e6977a1dac4">createGapAdjuster</a>);</div>
<div class="line"><span class="lineno">  537</span>                }</div>
<div class="line"><span class="lineno">  538</span>                status_msg.actual_gap = platoon_leader.vehiclePosition - <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa53003d4c3610dbb5f87762a6683dd9f">current_downtrack_</a>;</div>
<div class="line"><span class="lineno">  539</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;status_msg.actual_gap: &quot;</span> &lt;&lt; status_msg.actual_gap);</div>
<div class="line"><span class="lineno">  540</span>            }</div>
<div class="line"><span class="lineno">  541</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  542</span>            {</div>
<div class="line"><span class="lineno">  543</span>                status_msg.leader_id = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a473bcce97d7c50beaab678372a354c0d">vehicleID</a>;</div>
<div class="line"><span class="lineno">  544</span>                status_msg.leader_downtrack_distance = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa53003d4c3610dbb5f87762a6683dd9f">current_downtrack_</a>;</div>
<div class="line"><span class="lineno">  545</span>                status_msg.leader_cmd_speed = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a04e00e8747e98a33b4f708b8e9e58042">cmd_speed_</a>;</div>
<div class="line"><span class="lineno">  546</span>                status_msg.host_platoon_position = 0;</div>
<div class="line"><span class="lineno">  547</span> </div>
<div class="line"><span class="lineno">  548</span>            }</div>
<div class="line"><span class="lineno">  549</span> </div>
<div class="line"><span class="lineno">  550</span>            <span class="comment">// This info is updated at platoon control plugin</span></div>
<div class="line"><span class="lineno">  551</span>            status_msg.host_cmd_speed = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a04e00e8747e98a33b4f708b8e9e58042">cmd_speed_</a>;</div>
<div class="line"><span class="lineno">  552</span> </div>
<div class="line"><span class="lineno">  553</span>        }</div>
<div class="line"><span class="lineno">  554</span>        <span class="keywordflow">return</span> status_msg;</div>
<div class="line"><span class="lineno">  555</span>    }</div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_a0dfb4a15be2cf69ca770fcde1bdf65f5"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0dfb4a15be2cf69ca770fcde1bdf65f5">platoon_strategic_ihp::PlatoonManager::isCreateGap</a></div><div class="ttdeci">bool isCreateGap</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00407">platoon_manager_ihp.h:407</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_a1de160740f47d9b0198e42dcbe67a6fe"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a1de160740f47d9b0198e42dcbe67a6fe">platoon_strategic_ihp::PlatoonManager::getNumberOfVehicleInFront</a></div><div class="ttdeci">int getNumberOfVehicleInFront()</div><div class="ttdoc">Get number of vehicles in front of host vehicle inside platoon.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00723">platoon_manager_ihp.cpp:723</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_a26b94722e82060dda554ef168626727c"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a26b94722e82060dda554ef168626727c">platoon_strategic_ihp::PlatoonManager::getDynamicLeader</a></div><div class="ttdeci">PlatoonMember getDynamicLeader()</div><div class="ttdoc">Returns dynamic leader of the host vehicle.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00388">platoon_manager_ihp.cpp:388</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_a5f0e8506da98a7cb29aca9750e310319"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a5f0e8506da98a7cb29aca9750e310319">platoon_strategic_ihp::PlatoonManager::dynamic_leader_index_</a></div><div class="ttdeci">size_t dynamic_leader_index_</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00409">platoon_manager_ihp.h:409</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_a8dcec182e6480989f16493cdae76e445"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8dcec182e6480989f16493cdae76e445">platoon_strategic_ihp::PlatoonManager::getPredecessorPosition</a></div><div class="ttdeci">double getPredecessorPosition()</div><div class="ttdoc">UCLA: Return the position of the preceding vehicle, in m.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00809">platoon_manager_ihp.cpp:809</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_abee9a2b28eac60e3a326656ada2d7630"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#abee9a2b28eac60e3a326656ada2d7630">platoon_strategic_ihp::PlatoonManager::getPredecessorSpeed</a></div><div class="ttdeci">double getPredecessorSpeed()</div><div class="ttdoc">UCLA: Return the speed of the preceding vehicle, in m/s.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00803">platoon_manager_ihp.cpp:803</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_acb517eeb3ddfa40b377d80582e58e741"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">platoon_strategic_ihp::PlatoonManager::current_platoon_state</a></div><div class="ttdeci">PlatoonState current_platoon_state</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00370">platoon_manager_ihp.h:370</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_acde63c37282d68d2a407359d735d3446"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acde63c37282d68d2a407359d735d3446">platoon_strategic_ihp::PlatoonManager::getPredecessorTimeHeadwaySum</a></div><div class="ttdeci">double getPredecessorTimeHeadwaySum()</div><div class="ttdoc">UCLA: Return the time headway summation of all predecessors, in s.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00769">platoon_manager_ihp.cpp:769</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_aa53003d4c3610dbb5f87762a6683dd9f"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa53003d4c3610dbb5f87762a6683dd9f">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::current_downtrack_</a></div><div class="ttdeci">double current_downtrack_</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8h_source.html#l00330">platoon_strategic_ihp.h:330</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_aa67d1b97f198e2f088fb24ffb8e0c690"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa67d1b97f198e2f088fb24ffb8e0c690">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::pose_msg_</a></div><div class="ttdeci">geometry_msgs::msg::PoseStamped pose_msg_</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8h_source.html#l00322">platoon_strategic_ihp.h:322</a></div></div>
<div class="ttc" id="anamespaceplatoon__strategic__ihp_html_a20539b6c81ea3b1868c7ca5d7c403dafa0d2c16ab07ed24865f7ba27ad8a83dc0"><div class="ttname"><a href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa0d2c16ab07ed24865f7ba27ad8a83dc0">platoon_strategic_ihp::FOLLOWER</a></div><div class="ttdeci">@ FOLLOWER</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00082">platoon_manager_ihp.h:82</a></div></div>
<div class="ttc" id="anamespaceplatoon__strategic__ihp_html_a20539b6c81ea3b1868c7ca5d7c403dafa52c17c95a5cd81220db3fdd9181d43bd"><div class="ttname"><a href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa52c17c95a5cd81220db3fdd9181d43bd">platoon_strategic_ihp::CANDIDATELEADER</a></div><div class="ttdeci">@ CANDIDATELEADER</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00086">platoon_manager_ihp.h:86</a></div></div>
<div class="ttc" id="anamespaceplatoon__strategic__ihp_html_a20539b6c81ea3b1868c7ca5d7c403dafa57f78e815f4fc2ac271a9fd85cd80ebc"><div class="ttname"><a href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa57f78e815f4fc2ac271a9fd85cd80ebc">platoon_strategic_ihp::LEADER</a></div><div class="ttdeci">@ LEADER</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00080">platoon_manager_ihp.h:80</a></div></div>
<div class="ttc" id="anamespaceplatoon__strategic__ihp_html_a20539b6c81ea3b1868c7ca5d7c403dafa70d610aa504abb163caf9a5ee931d090"><div class="ttname"><a href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa70d610aa504abb163caf9a5ee931d090">platoon_strategic_ihp::LEADERWAITING</a></div><div class="ttdeci">@ LEADERWAITING</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00079">platoon_manager_ihp.h:79</a></div></div>
<div class="ttc" id="anamespaceplatoon__strategic__ihp_html_a20539b6c81ea3b1868c7ca5d7c403dafa7d32254f1798e4564e467d332c383112"><div class="ttname"><a href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa7d32254f1798e4564e467d332c383112">platoon_strategic_ihp::LEADWITHOPERATION</a></div><div class="ttdeci">@ LEADWITHOPERATION</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00088">platoon_manager_ihp.h:88</a></div></div>
<div class="ttc" id="anamespaceplatoon__strategic__ihp_html_a20539b6c81ea3b1868c7ca5d7c403dafa839ccd0c7e2e3441b3cd9ca0546be97b"><div class="ttname"><a href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa839ccd0c7e2e3441b3cd9ca0546be97b">platoon_strategic_ihp::STANDBY</a></div><div class="ttdeci">@ STANDBY</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00078">platoon_manager_ihp.h:78</a></div></div>
<div class="ttc" id="anamespaceplatoon__strategic__ihp_html_a20539b6c81ea3b1868c7ca5d7c403dafab7680aa6ec3a24dc42cb374192eb39a3"><div class="ttname"><a href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafab7680aa6ec3a24dc42cb374192eb39a3">platoon_strategic_ihp::CANDIDATEFOLLOWER</a></div><div class="ttdeci">@ CANDIDATEFOLLOWER</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00081">platoon_manager_ihp.h:81</a></div></div>
<div class="ttc" id="anamespaceplatoon__strategic__ihp_html_a20539b6c81ea3b1868c7ca5d7c403dafae176dd79ff2c2bc4b2f7901fbfc53014"><div class="ttname"><a href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafae176dd79ff2c2bc4b2f7901fbfc53014">platoon_strategic_ihp::LEADERABORTING</a></div><div class="ttdeci">@ LEADERABORTING</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00084">platoon_manager_ihp.h:84</a></div></div>
<div class="ttc" id="anamespaceplatoon__strategic__ihp_html_a20539b6c81ea3b1868c7ca5d7c403dafafe45c20d03a8d502486cff766672bdf9"><div class="ttname"><a href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafafe45c20d03a8d502486cff766672bdf9">platoon_strategic_ihp::PREPARETOJOIN</a></div><div class="ttdeci">@ PREPARETOJOIN</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00091">platoon_manager_ihp.h:90</a></div></div>
<div class="ttc" id="astructplatoon__strategic__ihp_1_1PlatoonMember_html_af1c48353e45a30b01a1d59fdd1a19c9f"><div class="ttname"><a href="structplatoon__strategic__ihp_1_1PlatoonMember.html#af1c48353e45a30b01a1d59fdd1a19c9f">platoon_strategic_ihp::PlatoonMember::staticId</a></div><div class="ttdeci">std::string staticId</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00099">platoon_manager_ihp.h:99</a></div></div>
<div class="ttc" id="astructplatoon__strategic__ihp_1_1PlatoonPluginConfig_html_a3e37e742ba6eab41498ab7da49abef91"><div class="ttname"><a href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a3e37e742ba6eab41498ab7da49abef91">platoon_strategic_ihp::PlatoonPluginConfig::maxPlatoonSize</a></div><div class="ttdeci">int maxPlatoonSize</div><div class="ttdef"><b>Definition:</b> <a href="platoon__config__ihp_8h_source.html#l00031">platoon_config_ihp.h:31</a></div></div>
<div class="ttc" id="astructplatoon__strategic__ihp_1_1PlatoonPluginConfig_html_a52907b228ff49305bd3c1e6977a1dac4"><div class="ttname"><a href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a52907b228ff49305bd3c1e6977a1dac4">platoon_strategic_ihp::PlatoonPluginConfig::createGapAdjuster</a></div><div class="ttdeci">double createGapAdjuster</div><div class="ttdef"><b>Definition:</b> <a href="platoon__config__ihp_8h_source.html#l00066">platoon_config_ihp.h:66</a></div></div>
<div class="ttc" id="astructplatoon__strategic__ihp_1_1PlatoonPluginConfig_html_a5d5fe22035fdba42dae4e023263499ca"><div class="ttname"><a href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a5d5fe22035fdba42dae4e023263499ca">platoon_strategic_ihp::PlatoonPluginConfig::timeHeadway</a></div><div class="ttdeci">double timeHeadway</div><div class="ttdef"><b>Definition:</b> <a href="platoon__config__ihp_8h_source.html#l00041">platoon_config_ihp.h:41</a></div></div>
<div class="ttc" id="astructplatoon__strategic__ihp_1_1PlatoonPluginConfig_html_ac8d626f63900bae289b590bde67b35a6"><div class="ttname"><a href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#ac8d626f63900bae289b590bde67b35a6">platoon_strategic_ihp::PlatoonPluginConfig::standStillHeadway</a></div><div class="ttdeci">double standStillHeadway</div><div class="ttdef"><b>Definition:</b> <a href="platoon__config__ihp_8h_source.html#l00042">platoon_config_ihp.h:42</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__manager__ihp_8h_source.html#l00081">platoon_strategic_ihp::CANDIDATEFOLLOWER</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00086">platoon_strategic_ihp::CANDIDATELEADER</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00326">cmd_speed_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00101">platoon_strategic_ihp::PlatoonMember::commandSpeed</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00318">config_</a>, <a class="el" href="platoon__config__ihp_8h_source.html#l00066">platoon_strategic_ihp::PlatoonPluginConfig::createGapAdjuster</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00330">current_downtrack_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00370">platoon_strategic_ihp::PlatoonManager::current_platoon_state</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00328">current_speed_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00364">platoon_strategic_ihp::PlatoonManager::currentPlatoonID</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00409">platoon_strategic_ihp::PlatoonManager::dynamic_leader_index_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00082">platoon_strategic_ihp::FOLLOWER</a>, <a class="el" href="platoon__manager__ihp_8cpp_source.html#l00388">platoon_strategic_ihp::PlatoonManager::getDynamicLeader()</a>, <a class="el" href="platoon__manager__ihp_8cpp_source.html#l00279">platoon_strategic_ihp::PlatoonManager::getHostPlatoonSize()</a>, <a class="el" href="platoon__manager__ihp_8cpp_source.html#l00723">platoon_strategic_ihp::PlatoonManager::getNumberOfVehicleInFront()</a>, <a class="el" href="platoon__manager__ihp_8cpp_source.html#l00809">platoon_strategic_ihp::PlatoonManager::getPredecessorPosition()</a>, <a class="el" href="platoon__manager__ihp_8cpp_source.html#l00803">platoon_strategic_ihp::PlatoonManager::getPredecessorSpeed()</a>, <a class="el" href="platoon__manager__ihp_8cpp_source.html#l00769">platoon_strategic_ihp::PlatoonManager::getPredecessorTimeHeadwaySum()</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00407">platoon_strategic_ihp::PlatoonManager::isCreateGap</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00080">platoon_strategic_ihp::LEADER</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00084">platoon_strategic_ihp::LEADERABORTING</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00079">platoon_strategic_ihp::LEADERWAITING</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00088">platoon_strategic_ihp::LEADWITHOPERATION</a>, <a class="el" href="platoon__config__ihp_8h_source.html#l00031">platoon_strategic_ihp::PlatoonPluginConfig::maxPlatoonSize</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00817">pm_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00322">pose_msg_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00090">platoon_strategic_ihp::PREPARETOJOIN</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00078">platoon_strategic_ihp::STANDBY</a>, <a class="el" href="platoon__config__ihp_8h_source.html#l00042">platoon_strategic_ihp::PlatoonPluginConfig::standStillHeadway</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00099">platoon_strategic_ihp::PlatoonMember::staticId</a>, <a class="el" href="platoon__config__ihp_8h_source.html#l00041">platoon_strategic_ihp::PlatoonPluginConfig::timeHeadway</a>, <a class="el" href="platoon__config__ihp_8h_source.html#l00068">platoon_strategic_ihp::PlatoonPluginConfig::vehicleID</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00105">platoon_strategic_ihp::PlatoonMember::vehiclePosition</a>, and <a class="el" href="platoon__strategic__ihp_8h_source.html#l00315">wm_</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l03060">onSpin()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ac86657c9cd45018b1f8544e47be1e5dc_cgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ac86657c9cd45018b1f8544e47be1e5dc_cgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ac86657c9cd45018b1f8544e47be1e5dc_cgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ac86657c9cd45018b1f8544e47be1e5dc_cgraph">
<area shape="rect" title="Compose Platoon information message." alt="" coords="5,488,188,544"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a26b94722e82060dda554ef168626727c" title="Returns dynamic leader of the host vehicle." alt="" coords="259,335,455,391"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a1de160740f47d9b0198e42dcbe67a6fe" title="Get number of vehicles in front of host vehicle inside platoon." alt="" coords="812,427,1004,483"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a3ef30eeb7a7cf0caccb948e6a41f92" title="Returns total size of the platoon , in number of vehicles." alt="" coords="236,466,479,507"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8dcec182e6480989f16493cdae76e445" title="UCLA: Return the position of the preceding vehicle, in m." alt="" coords="527,492,745,548"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#abee9a2b28eac60e3a326656ada2d7630" title="UCLA: Return the speed of the preceding vehicle, in m/s." alt="" coords="248,583,467,639"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acde63c37282d68d2a407359d735d3446" title="UCLA: Return the time headway summation of all predecessors, in s." alt="" coords="248,663,467,719"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a5fa3ab8c7c127c9d76f0dce1be59fe80" title="This is the implementation of all predecessor following (APF) algorithm for leader selection in a pla..." alt="" coords="529,227,743,283"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#aea48de69a49b77ff87145342a0790363" title="Calculate the time headaway of each platoon member and save as a vector." alt="" coords="818,5,998,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a24583fcb6596efbb2772001a58c36588" title="Determine the proper vehicle to follow based the time headway of each member. Note that the host will..." alt="" coords="800,136,1016,192"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ae747d7f17a417d2fa30227d71925489d" title="Find the closest vehicle to the host vehicle that violates the (time headaway) lower boundary conditi..." alt="" coords="1089,74,1323,145"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a10ff5ed73a7a5f72b96fc5b1a928bfe3" title="Find the closest vehicle to the host vehicle that violates the (time headaway) maximum spacing condit..." alt="" coords="1071,180,1341,236"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#addb3708590b81f46b27e612b6e945cea" title="Return a sub&#45;vector of the platoon&#45;wise time headaways vector that start with a given index." alt="" coords="793,267,1023,323"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ab6bac9590984959b2a6988c329090235" title="Check the gap with the predecessor vehicle." alt="" coords="813,347,1003,403"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8f79bf82a5c6ba800fd48f9ed819f606" title="Returns current downtrack distance, in m." alt="" coords="542,663,730,719"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ac86657c9cd45018b1f8544e47be1e5dc_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ac86657c9cd45018b1f8544e47be1e5dc_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ac86657c9cd45018b1f8544e47be1e5dc_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ac86657c9cd45018b1f8544e47be1e5dc_icgraph">
<area shape="rect" title="Compose Platoon information message." alt="" coords="429,5,612,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ac7e7160659b61a4ac61be14f74fb1caa" title="Spin callback function." alt="" coords="199,5,381,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,5,151,61"/>
</map>
</div>

</div>
</div>
<a id="a876cee27af19b1f215ffd4a2190be371" name="a876cee27af19b1f215ffd4a2190be371"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a876cee27af19b1f215ffd4a2190be371">&#9670;&nbsp;</a></span>ecef_to_map_point()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">lanelet::BasicPoint2d platoon_strategic_ihp::PlatoonStrategicIHPPlugin::ecef_to_map_point </td>
          <td>(</td>
          <td class="paramtype">carma_v2x_msgs::msg::LocationECEF&#160;</td>
          <td class="paramname"><em>ecef_point</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to convert ecef location to a 2d point in map frame. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ecef_point</td><td>ecef location point</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>2d point in map frame </dd></dl>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00252">252</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  253</span>    {</div>
<div class="line"><span class="lineno">  254</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a6aef0343096358d7180a1a301022cd9e">map_projector_</a>) </div>
<div class="line"><span class="lineno">  255</span>        {</div>
<div class="line"><span class="lineno">  256</span>            <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;No map projector available for ecef conversion&quot;</span>);</div>
<div class="line"><span class="lineno">  257</span>        }</div>
<div class="line"><span class="lineno">  258</span> </div>
<div class="line"><span class="lineno">  259</span>        lanelet::BasicPoint3d map_point = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a6aef0343096358d7180a1a301022cd9e">map_projector_</a>-&gt;projectECEF( { (double)ecef_point.ecef_x/100.0, (<span class="keywordtype">double</span>)ecef_point.ecef_y/100.0, (double)ecef_point.ecef_z/100.0 } , -1);</div>
<div class="line"><span class="lineno">  260</span> </div>
<div class="line"><span class="lineno">  261</span>        lanelet::BasicPoint2d output {map_point.x(), map_point.y()};</div>
<div class="line"><span class="lineno">  262</span>        <span class="keywordflow">return</span> output;</div>
<div class="line"><span class="lineno">  263</span>    } </div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a6aef0343096358d7180a1a301022cd9e"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a6aef0343096358d7180a1a301022cd9e">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::map_projector_</a></div><div class="ttdeci">std::shared_ptr&lt; lanelet::projection::LocalFrameProjector &gt; map_projector_</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8h_source.html#l00773">platoon_strategic_ihp.h:773</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__strategic__ihp_8h_source.html#l00773">map_projector_</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00954">mob_op_cb_leader()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01244">mob_op_cb_preparetojoin()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00708">mob_op_cb_STATUS()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01827">mob_req_cb_candidateleader()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01571">mob_req_cb_leader()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01510">mob_req_cb_leaderwaiting()</a>, and <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01870">mob_req_cb_leadwithoperation()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a876cee27af19b1f215ffd4a2190be371_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a876cee27af19b1f215ffd4a2190be371_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a876cee27af19b1f215ffd4a2190be371_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a876cee27af19b1f215ffd4a2190be371_icgraph">
<area shape="rect" title="Function to convert ecef location to a 2d point in map frame." alt="" coords="915,245,1097,301"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#afd00a90158f773100543b3f56f964d74" title="Function to process mobility operation in leader state." alt="" coords="672,5,855,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#afe00eb7730952e85faccf8032637983f" title="Function to process mobility operation in PrepareToJoin state (cut&#45;in join)" alt="" coords="672,85,855,141"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aeac839f63dec331ca94a0feee2c949f4" title="Function to process mobility operation message with STATUS params, read ecef location and update plat..." alt="" coords="672,165,855,221"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a90514428edda23566362c1a60dc01448" title="Function to process mobility request in candidateleader state." alt="" coords="665,245,862,301"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a5776b135d1c58b8224763c05d64fa440" title="Function to process mobility request in leader state." alt="" coords="672,325,855,381"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a76aa3d0140244914e0ffe7f9554751bb" title="Function to process mobility request in leader waiting state." alt="" coords="672,405,855,461"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a18b8dcd9744c6df8a615a1ce76f42146" title="Function to process mobility request in leadwithoperation state (cut&#45;in join)" alt="" coords="660,485,867,541"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a9f77f3abf67b6006fd6c9b965cbb1c10" title="Callback function for Mobility Operation Message." alt="" coords="429,125,612,181"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,247,151,303"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a53cc42ead95e9734805f4b52de1e38eb" title="Function to the process and respond to the mobility request." alt="" coords="429,325,612,381"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a588b379b14e20af4e05cf4883c535c5a" title="Callback function for Mobility Request Message." alt="" coords="199,279,381,335"/>
</map>
</div>

</div>
</div>
<a id="a81681b23983edcb5877121b526d33fb1" name="a81681b23983edcb5877121b526d33fb1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81681b23983edcb5877121b526d33fb1">&#9670;&nbsp;</a></span>find_target_lanelet_id()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classint.html">int</a> platoon_strategic_ihp::PlatoonStrategicIHPPlugin::find_target_lanelet_id </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>start_downtrack</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>end_downtrack</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to find the starting and ending lanelet ID for lane change in a two-lane scenario (used for cut-in join scenarios). </p>
<p >Note: This is a temporary function for internal test only. The scenario is not generalized. Can only find adjacent lanletID based on predefined direction (left, right).</p>
<p >\TODO: This function should be replaced by the complete arbitrary lane change module.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">start_downtrack</td><td>The downtrack distance (m) of the starting point. end_downtrack: The downtrack distance (m) of the target (end) point.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>(int): The adjacent laneletID based on the provided downtrack distance range. </dd></dl>

</div>
</div>
<a id="abf2d0fc255ea76f5b87a6490f9488df0" name="abf2d0fc255ea76f5b87a6490f9488df0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf2d0fc255ea76f5b87a6490f9488df0">&#9670;&nbsp;</a></span>findLaneletIndexFromPath()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classint.html">int</a> platoon_strategic_ihp::PlatoonStrategicIHPPlugin::findLaneletIndexFromPath </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classint.html">int</a>&#160;</td>
          <td class="paramname"><em>target_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">lanelet::routing::LaneletPath &amp;&#160;</td>
          <td class="paramname"><em>path</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find lanelet index from path. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">path</td><td>path </td></tr>
    <tr><td class="paramname">target_id</td><td>target lanelet id</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>lanelet index </dd></dl>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00153">153</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  154</span>    {</div>
<div class="line"><span class="lineno">  155</span>        <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> = 0; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> &lt; path.size(); ++<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>)</div>
<div class="line"><span class="lineno">  156</span>        {</div>
<div class="line"><span class="lineno">  157</span>            <span class="keywordflow">if</span>(path[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>].<span class="keywordtype">id</span>() == target_id)</div>
<div class="line"><span class="lineno">  158</span>            {</div>
<div class="line"><span class="lineno">  159</span>                <span class="keywordflow">return</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>;</div>
<div class="line"><span class="lineno">  160</span>            }</div>
<div class="line"><span class="lineno">  161</span>        }</div>
<div class="line"><span class="lineno">  162</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  163</span>    }</div>
<div class="ttc" id="anamespaceprocess__bag_html_af102a02c97622dd30b0dbf7bafb0d199"><div class="ttname"><a href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">process_bag.i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="process__bag_8py_source.html#l00059">process_bag.py:59</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="process__bag_8py_source.html#l00059">process_bag::i</a>.</p>

</div>
</div>
<a id="ad3cd4b02451fd0b0a25ed712e3331c36" name="ad3cd4b02451fd0b0a25ed712e3331c36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3cd4b02451fd0b0a25ed712e3331c36">&#9670;&nbsp;</a></span>findLaneWidth()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double platoon_strategic_ihp::PlatoonStrategicIHPPlugin::findLaneWidth </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find lanelet width from local position. </p>
<dl class="section return"><dt>Returns</dt><dd>lanelet index </dd></dl>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00186">186</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  187</span>    {</div>
<div class="line"><span class="lineno">  188</span>        lanelet::BasicPoint2d current_loc(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa67d1b97f198e2f088fb24ffb8e0c690">pose_msg_</a>.pose.position.x, <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa67d1b97f198e2f088fb24ffb8e0c690">pose_msg_</a>.pose.position.y);</div>
<div class="line"><span class="lineno">  189</span> </div>
<div class="line"><span class="lineno">  190</span>        <span class="keyword">auto</span> current_lanelets = lanelet::geometry::findNearest(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae65a18d1f14ecdfae3409e47e59a1031">wm_</a>-&gt;getMap()-&gt;laneletLayer, current_loc, 10);</div>
<div class="line"><span class="lineno">  191</span>        lanelet::ConstLanelet current_lanelet = current_lanelets[0].second;</div>
<div class="line"><span class="lineno">  192</span> </div>
<div class="line"><span class="lineno">  193</span>        <span class="comment">// find left and right bound </span></div>
<div class="line"><span class="lineno">  194</span>        lanelet::ConstLineString3d left_bound = current_lanelet.leftBound();</div>
<div class="line"><span class="lineno">  195</span>        lanelet::ConstLineString3d right_bound = current_lanelet.leftBound();</div>
<div class="line"><span class="lineno">  196</span> </div>
<div class="line"><span class="lineno">  197</span>        <span class="comment">// find lane width </span></div>
<div class="line"><span class="lineno">  198</span>        <span class="keywordtype">double</span> dx = abs (left_bound[0].<a class="code hl_variable" href="namespaceprocess__traj__logs.html#af3ba6144a2d35a4990f1a8d04632a052">x</a>() - right_bound[0].<a class="code hl_variable" href="namespaceprocess__traj__logs.html#af3ba6144a2d35a4990f1a8d04632a052">x</a>());</div>
<div class="line"><span class="lineno">  199</span>        <span class="keywordtype">double</span> dy = abs (left_bound[0].<a class="code hl_variable" href="namespaceprocess__traj__logs.html#a05bdb238bfbf3836fb0aa69c5aa1bb48">y</a>() - right_bound[0].<a class="code hl_variable" href="namespaceprocess__traj__logs.html#a05bdb238bfbf3836fb0aa69c5aa1bb48">y</a>());</div>
<div class="line"><span class="lineno">  200</span>        <span class="keywordtype">double</span> laneWidth = sqrt(dx*dx + dy*dy);</div>
<div class="line"><span class="lineno">  201</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;calculated lane width: &quot;</span> &lt;&lt; laneWidth);</div>
<div class="line"><span class="lineno">  202</span> </div>
<div class="line"><span class="lineno">  203</span>        <span class="comment">// TODO temporary disable this function and return constant value</span></div>
<div class="line"><span class="lineno">  204</span>        laneWidth = 3.5;</div>
<div class="line"><span class="lineno">  205</span>        </div>
<div class="line"><span class="lineno">  206</span> </div>
<div class="line"><span class="lineno">  207</span>        <span class="keywordflow">return</span> laneWidth;</div>
<div class="line"><span class="lineno">  208</span>    }</div>
<div class="ttc" id="anamespaceprocess__traj__logs_html_a05bdb238bfbf3836fb0aa69c5aa1bb48"><div class="ttname"><a href="namespaceprocess__traj__logs.html#a05bdb238bfbf3836fb0aa69c5aa1bb48">process_traj_logs.y</a></div><div class="ttdeci">y</div><div class="ttdef"><b>Definition:</b> <a href="process__traj__logs_8py_source.html#l00129">process_traj_logs.py:129</a></div></div>
<div class="ttc" id="anamespaceprocess__traj__logs_html_af3ba6144a2d35a4990f1a8d04632a052"><div class="ttname"><a href="namespaceprocess__traj__logs.html#af3ba6144a2d35a4990f1a8d04632a052">process_traj_logs.x</a></div><div class="ttdeci">x</div><div class="ttdef"><b>Definition:</b> <a href="process__traj__logs_8py_source.html#l00128">process_traj_logs.py:128</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__strategic__ihp_8h_source.html#l00322">pose_msg_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00315">wm_</a>, <a class="el" href="process__traj__logs_8py_source.html#l00128">process_traj_logs::x</a>, and <a class="el" href="process__traj__logs_8py_source.html#l00129">process_traj_logs::y</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00353">isJoiningVehicleNearPlatoon()</a>, and <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00388">isVehicleNearTargetPlatoon()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ad3cd4b02451fd0b0a25ed712e3331c36_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ad3cd4b02451fd0b0a25ed712e3331c36_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ad3cd4b02451fd0b0a25ed712e3331c36_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ad3cd4b02451fd0b0a25ed712e3331c36_icgraph">
<area shape="rect" title="Find lanelet width from local position." alt="" coords="1133,45,1316,101"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a12d5bd4a0601fe67e924cc07f0672e85" title="The method for platoon leader to determine if the joining vehicle is closeby. (Note: Used when host v..." alt="" coords="891,5,1085,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa76f916a1f30e25204262dcd17fcf4ac" title="Function to determine if the host vehicle is close to the target platoon (used for cut&#45;in join scenar..." alt="" coords="893,85,1083,141"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a5776b135d1c58b8224763c05d64fa440" title="Function to process mobility request in leader state." alt="" coords="660,5,843,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a53cc42ead95e9734805f4b52de1e38eb" title="Function to the process and respond to the mobility request." alt="" coords="429,5,612,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a588b379b14e20af4e05cf4883c535c5a" title="Callback function for Mobility Request Message." alt="" coords="199,5,381,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,45,151,101"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#afd00a90158f773100543b3f56f964d74" title="Function to process mobility operation in leader state." alt="" coords="660,85,843,141"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a9f77f3abf67b6006fd6c9b965cbb1c10" title="Callback function for Mobility Operation Message." alt="" coords="199,85,381,141"/>
</map>
</div>

</div>
</div>
<a id="a6fe836b822225ea28495dd732d2e1d6e" name="a6fe836b822225ea28495dd732d2e1d6e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6fe836b822225ea28495dd732d2e1d6e">&#9670;&nbsp;</a></span>findSpeedLimit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double platoon_strategic_ihp::PlatoonStrategicIHPPlugin::findSpeedLimit </td>
          <td>(</td>
          <td class="paramtype">const lanelet::ConstLanelet &amp;&#160;</td>
          <td class="paramname"><em>llt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to find speed limit of a lanelet. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">llt</td><td>inout lanelet</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>speed limit value (m/s) </dd></dl>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00166">166</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  167</span>    {</div>
<div class="line"><span class="lineno">  168</span>        <span class="keywordtype">double</span> target_speed = 0.0;</div>
<div class="line"><span class="lineno">  169</span> </div>
<div class="line"><span class="lineno">  170</span>        lanelet::Optional&lt;carma_wm::TrafficRulesConstPtr&gt; traffic_rules = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae65a18d1f14ecdfae3409e47e59a1031">wm_</a>-&gt;getTrafficRules();</div>
<div class="line"><span class="lineno">  171</span>        <span class="keywordflow">if</span> (traffic_rules)</div>
<div class="line"><span class="lineno">  172</span>        {</div>
<div class="line"><span class="lineno">  173</span>            target_speed =(*traffic_rules)-&gt;speedLimit(llt).speedLimit.value();</div>
<div class="line"><span class="lineno">  174</span>        }</div>
<div class="line"><span class="lineno">  175</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  176</span>        {</div>
<div class="line"><span class="lineno">  177</span>            <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;Valid traffic rules object could not be built&quot;</span>);</div>
<div class="line"><span class="lineno">  178</span>        }</div>
<div class="line"><span class="lineno">  179</span> </div>
<div class="line"><span class="lineno">  180</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;target speed (limit) &quot;</span> &lt;&lt; target_speed);</div>
<div class="line"><span class="lineno">  181</span>        </div>
<div class="line"><span class="lineno">  182</span>        <span class="keywordflow">return</span> target_speed;</div>
<div class="line"><span class="lineno">  183</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__strategic__ihp_8h_source.html#l00315">wm_</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l03221">plan_maneuver_cb()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a6fe836b822225ea28495dd732d2e1d6e_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a6fe836b822225ea28495dd732d2e1d6e_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a6fe836b822225ea28495dd732d2e1d6e_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a6fe836b822225ea28495dd732d2e1d6e_icgraph">
<area shape="rect" title="Function to find speed limit of a lanelet." alt="" coords="236,5,419,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aedb5c1f689806047c82f0c7b3ebe9c66" title="Callback function to the maneuver request." alt="" coords="5,5,188,61"/>
</map>
</div>

</div>
</div>
<a id="a3bab0f3480c267b9b1679be800143c30" name="a3bab0f3480c267b9b1679be800143c30"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3bab0f3480c267b9b1679be800143c30">&#9670;&nbsp;</a></span>FRIEND_TEST() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::FRIEND_TEST </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html">PlatoonStrategicIHPPlugin</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a8bf57cd61a2fde08b32e8411eff64cae">is_lanechange_possible</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a3bfb6b26b37f150d583993037f8b9217" name="a3bfb6b26b37f150d583993037f8b9217"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3bfb6b26b37f150d583993037f8b9217">&#9670;&nbsp;</a></span>FRIEND_TEST() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::FRIEND_TEST </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html">PlatoonStrategicIHPPlugin</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">platoon_info_pub_front&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a1aa9ad6ff7517bd8d6e8676d888c930f" name="a1aa9ad6ff7517bd8d6e8676d888c930f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1aa9ad6ff7517bd8d6e8676d888c930f">&#9670;&nbsp;</a></span>georeference_cb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void platoon_strategic_ihp::PlatoonStrategicIHPPlugin::georeference_cb </td>
          <td>(</td>
          <td class="paramtype">const std_msgs::msg::String::UniquePtr&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Callback for the georeference. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>Latest georeference </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00266">266</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  267</span>    {</div>
<div class="line"><span class="lineno">  268</span>        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a6aef0343096358d7180a1a301022cd9e">map_projector_</a> = std::make_shared&lt;lanelet::projection::LocalFrameProjector&gt;(msg-&gt;data.c_str()); </div>
<div class="line"><span class="lineno">  269</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__strategic__ihp_8h_source.html#l00773">map_projector_</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp__node_8cpp_source.html#l00118">platoon_strategic_ihp::Node::on_configure_plugin()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a1aa9ad6ff7517bd8d6e8676d888c930f_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a1aa9ad6ff7517bd8d6e8676d888c930f_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a1aa9ad6ff7517bd8d6e8676d888c930f_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a1aa9ad6ff7517bd8d6e8676d888c930f_icgraph">
<area shape="rect" title="Callback for the georeference." alt="" coords="199,5,381,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,5,151,61"/>
</map>
</div>

</div>
</div>
<a id="a9b1cb323bb9e2ee5349948946198121c" name="a9b1cb323bb9e2ee5349948946198121c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b1cb323bb9e2ee5349948946198121c">&#9670;&nbsp;</a></span>getHostPM()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonManager.html">PlatoonManager</a> platoon_strategic_ihp::PlatoonStrategicIHPPlugin::getHostPM </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>UCLA Getter: for <a class="el" href="classplatoon__strategic__ihp_1_1PlatoonManager.html" title="Class containing the logic for platoon manager. It is responsible for keeping track of the platoon me...">PlatoonManager</a> class. </p>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00097">97</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   98</span>    {</div>
<div class="line"><span class="lineno">   99</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>;</div>
<div class="line"><span class="lineno">  100</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__strategic__ihp_8h_source.html#l00817">pm_</a>.</p>

</div>
</div>
<a id="a53cc42ead95e9734805f4b52de1e38eb" name="a53cc42ead95e9734805f4b52de1e38eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53cc42ead95e9734805f4b52de1e38eb">&#9670;&nbsp;</a></span>handle_mob_req()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217">MobilityRequestResponse</a> platoon_strategic_ihp::PlatoonStrategicIHPPlugin::handle_mob_req </td>
          <td>(</td>
          <td class="paramtype">const carma_v2x_msgs::msg::MobilityRequest &amp;&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to the process and respond to the mobility request. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>Mobility Request Message</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Mobility response message </dd></dl>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01354">1354</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1355</span>    {</div>
<div class="line"><span class="lineno"> 1356</span>        <a class="code hl_enumeration" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217">MobilityRequestResponse</a> mobility_response = <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217a1aabdeebf3169c8d6a5a56d627286f48">MobilityRequestResponse::NO_RESPONSE</a>;</div>
<div class="line"><span class="lineno"> 1357</span> </div>
<div class="line"><span class="lineno"> 1358</span>        <span class="comment">// Check that this is a message about platooning (could be from some other Carma activity nearby)</span></div>
<div class="line"><span class="lineno"> 1359</span>        std::string strategy = msg.strategy;</div>
<div class="line"><span class="lineno"> 1360</span>        <span class="keywordflow">if</span> (strategy.rfind(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3be0b52376b568130c1c6a5ec5adeb13">PLATOONING_STRATEGY</a>, 0) != 0)</div>
<div class="line"><span class="lineno"> 1361</span>        {</div>
<div class="line"><span class="lineno"> 1362</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Ignoring mobility operation message for &quot;</span> &lt;&lt; strategy &lt;&lt; <span class="stringliteral">&quot; strategy.&quot;</span>);</div>
<div class="line"><span class="lineno"> 1363</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217a1aabdeebf3169c8d6a5a56d627286f48">MobilityRequestResponse::NO_RESPONSE</a>;</div>
<div class="line"><span class="lineno"> 1364</span>        }</div>
<div class="line"><span class="lineno"> 1365</span> </div>
<div class="line"><span class="lineno"> 1366</span>        <span class="comment">// Handle the message based on host&#39;s current state</span></div>
<div class="line"><span class="lineno"> 1367</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> == <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa57f78e815f4fc2ac271a9fd85cd80ebc">PlatoonState::LEADER</a>)</div>
<div class="line"><span class="lineno"> 1368</span>        {</div>
<div class="line"><span class="lineno"> 1369</span>            mobility_response = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a5776b135d1c58b8224763c05d64fa440">mob_req_cb_leader</a>(msg);</div>
<div class="line"><span class="lineno"> 1370</span>        }</div>
<div class="line"><span class="lineno"> 1371</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> == <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa0d2c16ab07ed24865f7ba27ad8a83dc0">PlatoonState::FOLLOWER</a>)</div>
<div class="line"><span class="lineno"> 1372</span>        {</div>
<div class="line"><span class="lineno"> 1373</span>            mobility_response = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a274f5abfcee68012ec00bfe4f8a7c21e">mob_req_cb_follower</a>(msg);</div>
<div class="line"><span class="lineno"> 1374</span>        }</div>
<div class="line"><span class="lineno"> 1375</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> == <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafab7680aa6ec3a24dc42cb374192eb39a3">PlatoonState::CANDIDATEFOLLOWER</a>)</div>
<div class="line"><span class="lineno"> 1376</span>        {</div>
<div class="line"><span class="lineno"> 1377</span>            mobility_response = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a6f3897bc8d2d12e3161ede942d5f1b51">mob_req_cb_candidatefollower</a>(msg);</div>
<div class="line"><span class="lineno"> 1378</span>        }</div>
<div class="line"><span class="lineno"> 1379</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> == <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa70d610aa504abb163caf9a5ee931d090">PlatoonState::LEADERWAITING</a>)</div>
<div class="line"><span class="lineno"> 1380</span>        {</div>
<div class="line"><span class="lineno"> 1381</span>            mobility_response = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a76aa3d0140244914e0ffe7f9554751bb">mob_req_cb_leaderwaiting</a>(msg);</div>
<div class="line"><span class="lineno"> 1382</span>        }</div>
<div class="line"><span class="lineno"> 1383</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> == <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa839ccd0c7e2e3441b3cd9ca0546be97b">PlatoonState::STANDBY</a>)</div>
<div class="line"><span class="lineno"> 1384</span>        {</div>
<div class="line"><span class="lineno"> 1385</span>            mobility_response = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a83ec14a38d923ba22c00168e8e991a32">mob_req_cb_standby</a>(msg);</div>
<div class="line"><span class="lineno"> 1386</span>        }</div>
<div class="line"><span class="lineno"> 1387</span>        <span class="comment">// UCLA: leader aborting</span></div>
<div class="line"><span class="lineno"> 1388</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> == <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafae176dd79ff2c2bc4b2f7901fbfc53014">PlatoonState::LEADERABORTING</a>)</div>
<div class="line"><span class="lineno"> 1389</span>        {</div>
<div class="line"><span class="lineno"> 1390</span>            mobility_response = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ade79b5e7117d1ca95418ae5fa7f73d97">mob_req_cb_leaderaborting</a>(msg);</div>
<div class="line"><span class="lineno"> 1391</span>        }</div>
<div class="line"><span class="lineno"> 1392</span>        <span class="comment">// UCLA: candidate leader </span></div>
<div class="line"><span class="lineno"> 1393</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> == <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa52c17c95a5cd81220db3fdd9181d43bd">PlatoonState::CANDIDATELEADER</a>)</div>
<div class="line"><span class="lineno"> 1394</span>        {</div>
<div class="line"><span class="lineno"> 1395</span>            mobility_response = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a90514428edda23566362c1a60dc01448">mob_req_cb_candidateleader</a>(msg);</div>
<div class="line"><span class="lineno"> 1396</span>        }</div>
<div class="line"><span class="lineno"> 1397</span> </div>
<div class="line"><span class="lineno"> 1398</span>        <span class="comment">// UCLA: lead with operation (for cut-in join)</span></div>
<div class="line"><span class="lineno"> 1399</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> == <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa7d32254f1798e4564e467d332c383112">PlatoonState::LEADWITHOPERATION</a>)</div>
<div class="line"><span class="lineno"> 1400</span>        {</div>
<div class="line"><span class="lineno"> 1401</span>            mobility_response = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a18b8dcd9744c6df8a615a1ce76f42146">mob_req_cb_leadwithoperation</a>(msg);</div>
<div class="line"><span class="lineno"> 1402</span>        }</div>
<div class="line"><span class="lineno"> 1403</span>        <span class="comment">// UCLA: prepare to join (for cut-in join)</span></div>
<div class="line"><span class="lineno"> 1404</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> == <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafafe45c20d03a8d502486cff766672bdf9">PlatoonState::PREPARETOJOIN</a>)</div>
<div class="line"><span class="lineno"> 1405</span>        {</div>
<div class="line"><span class="lineno"> 1406</span>            mobility_response = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a17e303fdec4af651df3678c0a065ad7e">mob_req_cb_preparetojoin</a>(msg);</div>
<div class="line"><span class="lineno"> 1407</span>        }</div>
<div class="line"><span class="lineno"> 1408</span>        <span class="comment">// TODO: Place holder for prepare to depart</span></div>
<div class="line"><span class="lineno"> 1409</span> </div>
<div class="line"><span class="lineno"> 1410</span>        <span class="keywordflow">return</span> mobility_response;</div>
<div class="line"><span class="lineno"> 1411</span>    }</div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a17e303fdec4af651df3678c0a065ad7e"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a17e303fdec4af651df3678c0a065ad7e">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_req_cb_preparetojoin</a></div><div class="ttdeci">MobilityRequestResponse mob_req_cb_preparetojoin(const carma_v2x_msgs::msg::MobilityRequest &amp;msg)</div><div class="ttdoc">Function to process mobility request in preparetojoin state (cut-in join)</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l02064">platoon_strategic_ihp.cpp:2064</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a18b8dcd9744c6df8a615a1ce76f42146"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a18b8dcd9744c6df8a615a1ce76f42146">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_req_cb_leadwithoperation</a></div><div class="ttdeci">MobilityRequestResponse mob_req_cb_leadwithoperation(const carma_v2x_msgs::msg::MobilityRequest &amp;msg)</div><div class="ttdoc">Function to process mobility request in leadwithoperation state (cut-in join)</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l01870">platoon_strategic_ihp.cpp:1870</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a274f5abfcee68012ec00bfe4f8a7c21e"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a274f5abfcee68012ec00bfe4f8a7c21e">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_req_cb_follower</a></div><div class="ttdeci">MobilityRequestResponse mob_req_cb_follower(const carma_v2x_msgs::msg::MobilityRequest &amp;msg)</div><div class="ttdoc">Function to process mobility request in follower state.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l01428">platoon_strategic_ihp.cpp:1428</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a5776b135d1c58b8224763c05d64fa440"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a5776b135d1c58b8224763c05d64fa440">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_req_cb_leader</a></div><div class="ttdeci">MobilityRequestResponse mob_req_cb_leader(const carma_v2x_msgs::msg::MobilityRequest &amp;msg)</div><div class="ttdoc">Function to process mobility request in leader state.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l01571">platoon_strategic_ihp.cpp:1571</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a6f3897bc8d2d12e3161ede942d5f1b51"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a6f3897bc8d2d12e3161ede942d5f1b51">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_req_cb_candidatefollower</a></div><div class="ttdeci">MobilityRequestResponse mob_req_cb_candidatefollower(const carma_v2x_msgs::msg::MobilityRequest &amp;msg)</div><div class="ttdoc">Function to process mobility request in candidate follower state.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l01420">platoon_strategic_ihp.cpp:1420</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a76aa3d0140244914e0ffe7f9554751bb"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a76aa3d0140244914e0ffe7f9554751bb">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_req_cb_leaderwaiting</a></div><div class="ttdeci">MobilityRequestResponse mob_req_cb_leaderwaiting(const carma_v2x_msgs::msg::MobilityRequest &amp;msg)</div><div class="ttdoc">Function to process mobility request in leader waiting state.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l01510">platoon_strategic_ihp.cpp:1510</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a83ec14a38d923ba22c00168e8e991a32"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a83ec14a38d923ba22c00168e8e991a32">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_req_cb_standby</a></div><div class="ttdeci">MobilityRequestResponse mob_req_cb_standby(const carma_v2x_msgs::msg::MobilityRequest &amp;msg)</div><div class="ttdoc">Function to process mobility request in standby state.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l01413">platoon_strategic_ihp.cpp:1413</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a90514428edda23566362c1a60dc01448"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a90514428edda23566362c1a60dc01448">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_req_cb_candidateleader</a></div><div class="ttdeci">MobilityRequestResponse mob_req_cb_candidateleader(const carma_v2x_msgs::msg::MobilityRequest &amp;msg)</div><div class="ttdoc">Function to process mobility request in candidateleader state.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l01827">platoon_strategic_ihp.cpp:1827</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_ade79b5e7117d1ca95418ae5fa7f73d97"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ade79b5e7117d1ca95418ae5fa7f73d97">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_req_cb_leaderaborting</a></div><div class="ttdeci">MobilityRequestResponse mob_req_cb_leaderaborting(const carma_v2x_msgs::msg::MobilityRequest &amp;msg)</div><div class="ttdoc">Function to process mobility request in leaderaborting state.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l01818">platoon_strategic_ihp.cpp:1818</a></div></div>
<div class="ttc" id="anamespaceplatoon__strategic__ihp_html_afdeaa181289e9678d31f8928ec036217"><div class="ttname"><a href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217">platoon_strategic_ihp::MobilityRequestResponse</a></div><div class="ttdeci">MobilityRequestResponse</div><div class="ttdoc">A response to an MobilityRequest message. ACK - indicates that the plugin accepts the MobilityRequest...</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00064">platoon_manager_ihp.h:65</a></div></div>
<div class="ttc" id="anamespaceplatoon__strategic__ihp_html_afdeaa181289e9678d31f8928ec036217a1aabdeebf3169c8d6a5a56d627286f48"><div class="ttname"><a href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217a1aabdeebf3169c8d6a5a56d627286f48">platoon_strategic_ihp::NO_RESPONSE</a></div><div class="ttdeci">@ NO_RESPONSE</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00069">platoon_manager_ihp.h:68</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__manager__ihp_8h_source.html#l00081">platoon_strategic_ihp::CANDIDATEFOLLOWER</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00086">platoon_strategic_ihp::CANDIDATELEADER</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00370">platoon_strategic_ihp::PlatoonManager::current_platoon_state</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00082">platoon_strategic_ihp::FOLLOWER</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00080">platoon_strategic_ihp::LEADER</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00084">platoon_strategic_ihp::LEADERABORTING</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00079">platoon_strategic_ihp::LEADERWAITING</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00088">platoon_strategic_ihp::LEADWITHOPERATION</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01420">mob_req_cb_candidatefollower()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01827">mob_req_cb_candidateleader()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01428">mob_req_cb_follower()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01571">mob_req_cb_leader()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01818">mob_req_cb_leaderaborting()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01510">mob_req_cb_leaderwaiting()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01870">mob_req_cb_leadwithoperation()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02064">mob_req_cb_preparetojoin()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01413">mob_req_cb_standby()</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00068">platoon_strategic_ihp::NO_RESPONSE</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00820">PLATOONING_STRATEGY</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00817">pm_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00090">platoon_strategic_ihp::PREPARETOJOIN</a>, and <a class="el" href="platoon__manager__ihp_8h_source.html#l00078">platoon_strategic_ihp::STANDBY</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02551">mob_req_cb()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a53cc42ead95e9734805f4b52de1e38eb_cgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a53cc42ead95e9734805f4b52de1e38eb_cgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a53cc42ead95e9734805f4b52de1e38eb_cgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a53cc42ead95e9734805f4b52de1e38eb_cgraph">
<area shape="rect" title="Function to the process and respond to the mobility request." alt="" coords="5,393,188,449"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a6f3897bc8d2d12e3161ede942d5f1b51" title="Function to process mobility request in candidate follower state." alt="" coords="236,73,443,129"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a90514428edda23566362c1a60dc01448" title="Function to process mobility request in candidateleader state." alt="" coords="241,153,438,209"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a274f5abfcee68012ec00bfe4f8a7c21e" title="Function to process mobility request in follower state." alt="" coords="248,473,431,529"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a5776b135d1c58b8224763c05d64fa440" title="Function to process mobility request in leader state." alt="" coords="248,393,431,449"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ade79b5e7117d1ca95418ae5fa7f73d97" title="Function to process mobility request in leaderaborting state." alt="" coords="246,553,433,609"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a76aa3d0140244914e0ffe7f9554751bb" title="Function to process mobility request in leader waiting state." alt="" coords="248,233,431,289"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a18b8dcd9744c6df8a615a1ce76f42146" title="Function to process mobility request in leadwithoperation state (cut&#45;in join)" alt="" coords="236,313,443,369"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a17e303fdec4af651df3678c0a065ad7e" title="Function to process mobility request in preparetojoin state (cut&#45;in join)" alt="" coords="248,633,431,689"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a83ec14a38d923ba22c00168e8e991a32" title="Function to process mobility request in standby state." alt="" coords="248,713,431,769"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#af2f0d9818d07db4a4df484f988635201" title="Resets necessary variables to indicate that the current ActionPlan is dead." alt="" coords="503,165,721,206"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a876cee27af19b1f215ffd4a2190be371" title="Function to convert ecef location to a 2d point in map frame." alt="" coords="521,229,703,285"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ab1c204db4a5056621de299a9dd663c6f" title="Resets all variables that might indicate other members of the host&#39;s platoon; sets the host back to s..." alt="" coords="519,5,705,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#abca93088e8980c97a1a24c4fff31c758" title="Resets all variables that describe a neighbor platoon, so that no neighbor is known." alt="" coords="507,85,717,141"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ae696d79ca33f496082ef462fdc9ba53b" title="Returns current host static ID as a string." alt="" coords="501,693,723,734"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a3ef30eeb7a7cf0caccb948e6a41f92" title="Returns total size of the platoon , in number of vehicles." alt="" coords="491,309,733,350"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#aac57cfc07168101835015859c9c7e48e" title="UCLA: Return the platoon leader downtrack distance, in m." alt="" coords="517,453,707,509"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a83ecd30ec7e2f7eb15c93075c8eca436" title="Returns downtrack distance of the rear vehicle in platoon, in m." alt="" coords="517,533,707,589"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a12d5bd4a0601fe67e924cc07f0672e85" title="The method for platoon leader to determine if the joining vehicle is closeby. (Note: Used when host v..." alt="" coords="515,613,709,669"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ad3cd4b02451fd0b0a25ed712e3331c36" title="Find lanelet width from local position." alt="" coords="781,613,964,669"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a11ffedaaa90fe358ecfdccab7c5a428c" title="Function to convert pose from map frame to ecef location." alt="" coords="521,373,703,429"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a53cc42ead95e9734805f4b52de1e38eb_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a53cc42ead95e9734805f4b52de1e38eb_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a53cc42ead95e9734805f4b52de1e38eb_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a53cc42ead95e9734805f4b52de1e38eb_icgraph">
<area shape="rect" title="Function to the process and respond to the mobility request." alt="" coords="429,5,612,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a588b379b14e20af4e05cf4883c535c5a" title="Callback function for Mobility Request Message." alt="" coords="199,5,381,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,5,151,61"/>
</map>
</div>

</div>
</div>
<a id="a8bf57cd61a2fde08b32e8411eff64cae" name="a8bf57cd61a2fde08b32e8411eff64cae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8bf57cd61a2fde08b32e8411eff64cae">&#9670;&nbsp;</a></span>is_lanechange_possible()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> platoon_strategic_ihp::PlatoonStrategicIHPPlugin::is_lanechange_possible </td>
          <td>(</td>
          <td class="paramtype">lanelet::Id&#160;</td>
          <td class="paramname"><em>start_lanelet_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">lanelet::Id&#160;</td>
          <td class="paramname"><em>target_lanelet_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to check if lanechange is possible. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">start_lanelet_id</td><td>start lanelet id </td></tr>
    <tr><td class="paramname">target_lanelet_id</td><td>start lanelet id</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true or false </dd></dl>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l03472">3472</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3473</span>    {</div>
<div class="line"><span class="lineno"> 3474</span>        lanelet::ConstLanelet starting_lanelet = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae65a18d1f14ecdfae3409e47e59a1031">wm_</a>-&gt;getMap()-&gt;laneletLayer.get(start_lanelet_id);</div>
<div class="line"><span class="lineno"> 3475</span>        lanelet::ConstLanelet ending_lanelet = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae65a18d1f14ecdfae3409e47e59a1031">wm_</a>-&gt;getMap()-&gt;laneletLayer.get(target_lanelet_id);</div>
<div class="line"><span class="lineno"> 3476</span>        lanelet::ConstLanelet current_lanelet = starting_lanelet;</div>
<div class="line"><span class="lineno"> 3477</span>        <span class="keywordtype">bool</span> shared_boundary_found = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3478</span>        </div>
<div class="line"><span class="lineno"> 3479</span>        <span class="keywordflow">while</span>(!shared_boundary_found)</div>
<div class="line"><span class="lineno"> 3480</span>        {</div>
<div class="line"><span class="lineno"> 3481</span>            <span class="comment">//Assumption- Adjacent lanelets share lane boundary</span></div>
<div class="line"><span class="lineno"> 3482</span>            <span class="keywordflow">if</span>(current_lanelet.leftBound() == ending_lanelet.rightBound())</div>
<div class="line"><span class="lineno"> 3483</span>            {   </div>
<div class="line"><span class="lineno"> 3484</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Lanelet &quot;</span> &lt;&lt; std::to_string(current_lanelet.id()) &lt;&lt; <span class="stringliteral">&quot; shares left boundary with &quot;</span> &lt;&lt; std::to_string(ending_lanelet.id()));</div>
<div class="line"><span class="lineno"> 3485</span>                shared_boundary_found = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 3486</span>            }</div>
<div class="line"><span class="lineno"> 3487</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(current_lanelet.rightBound() == ending_lanelet.leftBound())</div>
<div class="line"><span class="lineno"> 3488</span>            {</div>
<div class="line"><span class="lineno"> 3489</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Lanelet &quot;</span> &lt;&lt; std::to_string(current_lanelet.id()) &lt;&lt; <span class="stringliteral">&quot; shares right boundary with &quot;</span> &lt;&lt; std::to_string(ending_lanelet.id()));</div>
<div class="line"><span class="lineno"> 3490</span>                shared_boundary_found = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 3491</span>            }</div>
<div class="line"><span class="lineno"> 3492</span> </div>
<div class="line"><span class="lineno"> 3493</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 3494</span>            {</div>
<div class="line"><span class="lineno"> 3495</span>                <span class="comment">//If there are no following lanelets on route, lanechange should be completing before reaching it</span></div>
<div class="line"><span class="lineno"> 3496</span>                <span class="keywordflow">if</span>(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae65a18d1f14ecdfae3409e47e59a1031">wm_</a>-&gt;getMapRoutingGraph()-&gt;following(current_lanelet, <span class="keyword">false</span>).empty())</div>
<div class="line"><span class="lineno"> 3497</span>                {</div>
<div class="line"><span class="lineno"> 3498</span>                    <span class="comment">//In this case we have reached a lanelet which does not have a routable lanelet ahead + isn&#39;t adjacent to the lanelet where lane change ends</span></div>
<div class="line"><span class="lineno"> 3499</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3500</span>                }</div>
<div class="line"><span class="lineno"> 3501</span> </div>
<div class="line"><span class="lineno"> 3502</span>                current_lanelet = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae65a18d1f14ecdfae3409e47e59a1031">wm_</a>-&gt;getMapRoutingGraph()-&gt;following(current_lanelet, <span class="keyword">false</span>).front(); </div>
<div class="line"><span class="lineno"> 3503</span>                <span class="keywordflow">if</span>(current_lanelet.id() == starting_lanelet.id())</div>
<div class="line"><span class="lineno"> 3504</span>                {</div>
<div class="line"><span class="lineno"> 3505</span>                    <span class="comment">//Looped back to starting lanelet</span></div>
<div class="line"><span class="lineno"> 3506</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3507</span>                }</div>
<div class="line"><span class="lineno"> 3508</span>            }</div>
<div class="line"><span class="lineno"> 3509</span>        }</div>
<div class="line"><span class="lineno"> 3510</span> </div>
<div class="line"><span class="lineno"> 3511</span> </div>
<div class="line"><span class="lineno"> 3512</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 3513</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__strategic__ihp_8h_source.html#l00315">wm_</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l03221">plan_maneuver_cb()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a8bf57cd61a2fde08b32e8411eff64cae_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a8bf57cd61a2fde08b32e8411eff64cae_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a8bf57cd61a2fde08b32e8411eff64cae_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a8bf57cd61a2fde08b32e8411eff64cae_icgraph">
<area shape="rect" title="Function to check if lanechange is possible." alt="" coords="236,5,419,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aedb5c1f689806047c82f0c7b3ebe9c66" title="Callback function to the maneuver request." alt="" coords="5,5,188,61"/>
</map>
</div>

</div>
</div>
<a id="a12d5bd4a0601fe67e924cc07f0672e85" name="a12d5bd4a0601fe67e924cc07f0672e85"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a12d5bd4a0601fe67e924cc07f0672e85">&#9670;&nbsp;</a></span>isJoiningVehicleNearPlatoon()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> platoon_strategic_ihp::PlatoonStrategicIHPPlugin::isJoiningVehicleNearPlatoon </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>joining_downtrack</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>joining_crosstrack</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The method for platoon leader to determine if the joining vehicle is closeby. (Note: Used when host vehicle is the platoon leader) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">joining_downtrack</td><td>The downtrack distance of the joining vehicle. joining_crosstrack: The crosstrack distance of the joining vehicle.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>(boolean): if the host vehicle is close to the target platoon. </dd></dl>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00353">353</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  354</span>    {</div>
<div class="line"><span class="lineno">  355</span>        <span class="comment">// Position info of the host vehicle</span></div>
<div class="line"><span class="lineno">  356</span>        <span class="keywordtype">double</span> frontVehicleDtd = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa53003d4c3610dbb5f87762a6683dd9f">current_downtrack_</a>;</div>
<div class="line"><span class="lineno">  357</span>        <span class="keywordtype">double</span> frontVehicleCtd = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a79aaef859aaa4b64f6cf79c50c596bc3">current_crosstrack_</a>;</div>
<div class="line"><span class="lineno">  358</span>        <span class="comment">// platoon rear positions</span></div>
<div class="line"><span class="lineno">  359</span>        <span class="keywordtype">int</span> lastVehicleIndex = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>.size()-1;</div>
<div class="line"><span class="lineno">  360</span>        <span class="keywordtype">double</span> rearVehicleDtd = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>[lastVehicleIndex].vehiclePosition;</div>
<div class="line"><span class="lineno">  361</span>        </div>
<div class="line"><span class="lineno">  362</span>        <span class="comment">// lateral error for two lanes (lane width was calculated based on current lanelet)</span></div>
<div class="line"><span class="lineno">  363</span>        <span class="keywordtype">double</span> two_lane_cross_error = 2*<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a3c2aa8b4742ba50d80bc9c23ed183ebf">maxCrosstrackError</a> + <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ad3cd4b02451fd0b0a25ed712e3331c36">findLaneWidth</a>(); </div>
<div class="line"><span class="lineno">  364</span>        <span class="comment">// add longitudinal check threshold in config file </span></div>
<div class="line"><span class="lineno">  365</span>        <span class="keywordtype">bool</span> longitudinalCheck = joining_downtrack &gt;= rearVehicleDtd - <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a7ebcbd6d830ed897edc245524b9625f9">longitudinalCheckThresold</a>  || </div>
<div class="line"><span class="lineno">  366</span>                                 joining_downtrack &lt;= frontVehicleDtd + <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a2c210ff37063f1c702ddec0d454238b2">maxCutinGap</a>;</div>
<div class="line"><span class="lineno">  367</span>        <span class="keywordtype">bool</span> lateralCheck = joining_crosstrack &gt;= frontVehicleCtd - two_lane_cross_error  || </div>
<div class="line"><span class="lineno">  368</span>                            joining_crosstrack &lt;= frontVehicleCtd + two_lane_cross_error;</div>
<div class="line"><span class="lineno">  369</span>        <span class="comment">// logs for longitudinal and lateral check </span></div>
<div class="line"><span class="lineno">  370</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;The longitudinalCheck result is: &quot;</span> &lt;&lt; longitudinalCheck );</div>
<div class="line"><span class="lineno">  371</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;The lateralCheck result is: &quot;</span> &lt;&lt; lateralCheck );</div>
<div class="line"><span class="lineno">  372</span> </div>
<div class="line"><span class="lineno">  373</span>        <span class="keywordflow">if</span> (longitudinalCheck &amp;&amp; lateralCheck) </div>
<div class="line"><span class="lineno">  374</span>        {</div>
<div class="line"><span class="lineno">  375</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Joining vehicle is nearby. It is able to join.&quot;</span>);</div>
<div class="line"><span class="lineno">  376</span>            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  377</span>        }</div>
<div class="line"><span class="lineno">  378</span>        <span class="keywordflow">else</span> </div>
<div class="line"><span class="lineno">  379</span>        {</div>
<div class="line"><span class="lineno">  380</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;The joining vehicle is not close by, the join request will not be approved.&quot;</span>);</div>
<div class="line"><span class="lineno">  381</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;The joining vehicle downtrack is &quot;</span> &lt;&lt; joining_downtrack &lt;&lt; <span class="stringliteral">&quot; and the host (platoon leader) downtrack is &quot;</span> &lt;&lt; frontVehicleDtd);</div>
<div class="line"><span class="lineno">  382</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;The joining vehicle crosstrack is &quot;</span> &lt;&lt; joining_crosstrack &lt;&lt; <span class="stringliteral">&quot; and the host (platoon leader) crosstrack is &quot;</span> &lt;&lt; frontVehicleCtd);</div>
<div class="line"><span class="lineno">  383</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  384</span>        }</div>
<div class="line"><span class="lineno">  385</span>    }</div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a79aaef859aaa4b64f6cf79c50c596bc3"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a79aaef859aaa4b64f6cf79c50c596bc3">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::current_crosstrack_</a></div><div class="ttdeci">double current_crosstrack_</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8h_source.html#l00332">platoon_strategic_ihp.h:332</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_ad3cd4b02451fd0b0a25ed712e3331c36"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ad3cd4b02451fd0b0a25ed712e3331c36">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::findLaneWidth</a></div><div class="ttdeci">double findLaneWidth()</div><div class="ttdoc">Find lanelet width from local position.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l00186">platoon_strategic_ihp.cpp:186</a></div></div>
<div class="ttc" id="astructplatoon__strategic__ihp_1_1PlatoonPluginConfig_html_a2c210ff37063f1c702ddec0d454238b2"><div class="ttname"><a href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a2c210ff37063f1c702ddec0d454238b2">platoon_strategic_ihp::PlatoonPluginConfig::maxCutinGap</a></div><div class="ttdeci">double maxCutinGap</div><div class="ttdef"><b>Definition:</b> <a href="platoon__config__ihp_8h_source.html#l00061">platoon_config_ihp.h:61</a></div></div>
<div class="ttc" id="astructplatoon__strategic__ihp_1_1PlatoonPluginConfig_html_a3c2aa8b4742ba50d80bc9c23ed183ebf"><div class="ttname"><a href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a3c2aa8b4742ba50d80bc9c23ed183ebf">platoon_strategic_ihp::PlatoonPluginConfig::maxCrosstrackError</a></div><div class="ttdeci">double maxCrosstrackError</div><div class="ttdef"><b>Definition:</b> <a href="platoon__config__ihp_8h_source.html#l00062">platoon_config_ihp.h:62</a></div></div>
<div class="ttc" id="astructplatoon__strategic__ihp_1_1PlatoonPluginConfig_html_a7ebcbd6d830ed897edc245524b9625f9"><div class="ttname"><a href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a7ebcbd6d830ed897edc245524b9625f9">platoon_strategic_ihp::PlatoonPluginConfig::longitudinalCheckThresold</a></div><div class="ttdeci">double longitudinalCheckThresold</div><div class="ttdef"><b>Definition:</b> <a href="platoon__config__ihp_8h_source.html#l00046">platoon_config_ihp.h:46</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__strategic__ihp_8h_source.html#l00318">config_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00332">current_crosstrack_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00330">current_downtrack_</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00186">findLaneWidth()</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00361">platoon_strategic_ihp::PlatoonManager::host_platoon_</a>, <a class="el" href="platoon__config__ihp_8h_source.html#l00046">platoon_strategic_ihp::PlatoonPluginConfig::longitudinalCheckThresold</a>, <a class="el" href="platoon__config__ihp_8h_source.html#l00062">platoon_strategic_ihp::PlatoonPluginConfig::maxCrosstrackError</a>, <a class="el" href="platoon__config__ihp_8h_source.html#l00061">platoon_strategic_ihp::PlatoonPluginConfig::maxCutinGap</a>, and <a class="el" href="platoon__strategic__ihp_8h_source.html#l00817">pm_</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01571">mob_req_cb_leader()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a12d5bd4a0601fe67e924cc07f0672e85_cgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a12d5bd4a0601fe67e924cc07f0672e85_cgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a12d5bd4a0601fe67e924cc07f0672e85_cgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a12d5bd4a0601fe67e924cc07f0672e85_cgraph">
<area shape="rect" title="The method for platoon leader to determine if the joining vehicle is closeby. (Note: Used when host v..." alt="" coords="5,5,200,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ad3cd4b02451fd0b0a25ed712e3331c36" title="Find lanelet width from local position." alt="" coords="248,5,431,61"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a12d5bd4a0601fe67e924cc07f0672e85_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a12d5bd4a0601fe67e924cc07f0672e85_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a12d5bd4a0601fe67e924cc07f0672e85_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a12d5bd4a0601fe67e924cc07f0672e85_icgraph">
<area shape="rect" title="The method for platoon leader to determine if the joining vehicle is closeby. (Note: Used when host v..." alt="" coords="891,5,1085,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a5776b135d1c58b8224763c05d64fa440" title="Function to process mobility request in leader state." alt="" coords="660,5,843,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a53cc42ead95e9734805f4b52de1e38eb" title="Function to the process and respond to the mobility request." alt="" coords="429,5,612,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a588b379b14e20af4e05cf4883c535c5a" title="Callback function for Mobility Request Message." alt="" coords="199,5,381,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,5,151,61"/>
</map>
</div>

</div>
</div>
<a id="aa76f916a1f30e25204262dcd17fcf4ac" name="aa76f916a1f30e25204262dcd17fcf4ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa76f916a1f30e25204262dcd17fcf4ac">&#9670;&nbsp;</a></span>isVehicleNearTargetPlatoon()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> platoon_strategic_ihp::PlatoonStrategicIHPPlugin::isVehicleNearTargetPlatoon </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rearVehicleDtd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>frontVehicleDtd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>frontVehicleCtd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to determine if the host vehicle is close to the target platoon (used for cut-in join scenarios). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rearVehicleDtd</td><td>The downtrack of the neighbor platoon rear vehicle. </td></tr>
    <tr><td class="paramname">frontVehicleDtd</td><td>The downtrack of the neighbor platoon leader. </td></tr>
    <tr><td class="paramname">frontVehicleCtd</td><td>The crosstrack of the neighbor platoon leader.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>(boolean): if the host vehicle is close to the target platoon. </dd></dl>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00388">388</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  389</span>    {</div>
<div class="line"><span class="lineno">  390</span> </div>
<div class="line"><span class="lineno">  391</span>        <span class="comment">// lateral error for two lanes (lane width was calculated based on current lanelet)</span></div>
<div class="line"><span class="lineno">  392</span>        <span class="keywordtype">double</span> two_lane_cross_error = 2*<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a3c2aa8b4742ba50d80bc9c23ed183ebf">maxCrosstrackError</a> + <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ad3cd4b02451fd0b0a25ed712e3331c36">findLaneWidth</a>(); </div>
<div class="line"><span class="lineno">  393</span>        <span class="comment">// add longitudinal check threshold in config file </span></div>
<div class="line"><span class="lineno">  394</span>        <span class="keywordtype">bool</span> longitudinalCheck = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa53003d4c3610dbb5f87762a6683dd9f">current_downtrack_</a> &gt;= rearVehicleDtd - <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a7ebcbd6d830ed897edc245524b9625f9">longitudinalCheckThresold</a> || </div>
<div class="line"><span class="lineno">  395</span>                                 <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa53003d4c3610dbb5f87762a6683dd9f">current_downtrack_</a> &lt;= frontVehicleDtd + <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a7ebcbd6d830ed897edc245524b9625f9">longitudinalCheckThresold</a>;</div>
<div class="line"><span class="lineno">  396</span>        <span class="keywordtype">bool</span> lateralCheck = abs(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a79aaef859aaa4b64f6cf79c50c596bc3">current_crosstrack_</a> - frontVehicleCtd) &lt;= two_lane_cross_error;</div>
<div class="line"><span class="lineno">  397</span>        <span class="comment">// current_crosstrack_ &gt;= frontVehicleCtd - two_lane_cross_error || </span></div>
<div class="line"><span class="lineno">  398</span>        <span class="comment">//                     current_crosstrack_ &lt;= frontVehicleCtd + two_lane_cross_error;</span></div>
<div class="line"><span class="lineno">  399</span>        <span class="comment">// logs for longitudinal and lateral check </span></div>
<div class="line"><span class="lineno">  400</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;The longitudinalCheck result is: &quot;</span> &lt;&lt; longitudinalCheck );</div>
<div class="line"><span class="lineno">  401</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;The lateralCheck result is: &quot;</span> &lt;&lt; lateralCheck );</div>
<div class="line"><span class="lineno">  402</span> </div>
<div class="line"><span class="lineno">  403</span>        <span class="keywordflow">if</span> (longitudinalCheck &amp;&amp; lateralCheck) </div>
<div class="line"><span class="lineno">  404</span>        {</div>
<div class="line"><span class="lineno">  405</span>            <span class="comment">// host vehicle is close to target platoon longitudinally (within 10m) and laterally (within 5m)</span></div>
<div class="line"><span class="lineno">  406</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Found a platoon nearby. We are able to join.&quot;</span>);</div>
<div class="line"><span class="lineno">  407</span>            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  408</span>        }</div>
<div class="line"><span class="lineno">  409</span>        <span class="keywordflow">else</span> </div>
<div class="line"><span class="lineno">  410</span>        {</div>
<div class="line"><span class="lineno">  411</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Ignoring platoon.&quot;</span>);</div>
<div class="line"><span class="lineno">  412</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;The platoon leader dtd is &quot;</span> &lt;&lt; frontVehicleDtd &lt;&lt; <span class="stringliteral">&quot; and we are current at &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa53003d4c3610dbb5f87762a6683dd9f">current_downtrack_</a>);</div>
<div class="line"><span class="lineno">  413</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;The platoon leader ctd is &quot;</span> &lt;&lt; frontVehicleCtd &lt;&lt; <span class="stringliteral">&quot; and we are current at &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a79aaef859aaa4b64f6cf79c50c596bc3">current_crosstrack_</a>);</div>
<div class="line"><span class="lineno">  414</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  415</span>        }</div>
<div class="line"><span class="lineno">  416</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__strategic__ihp_8h_source.html#l00318">config_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00332">current_crosstrack_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00330">current_downtrack_</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00186">findLaneWidth()</a>, <a class="el" href="platoon__config__ihp_8h_source.html#l00046">platoon_strategic_ihp::PlatoonPluginConfig::longitudinalCheckThresold</a>, and <a class="el" href="platoon__config__ihp_8h_source.html#l00062">platoon_strategic_ihp::PlatoonPluginConfig::maxCrosstrackError</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00954">mob_op_cb_leader()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aa76f916a1f30e25204262dcd17fcf4ac_cgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aa76f916a1f30e25204262dcd17fcf4ac_cgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aa76f916a1f30e25204262dcd17fcf4ac_cgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aa76f916a1f30e25204262dcd17fcf4ac_cgraph">
<area shape="rect" title="Function to determine if the host vehicle is close to the target platoon (used for cut&#45;in join scenar..." alt="" coords="5,5,196,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ad3cd4b02451fd0b0a25ed712e3331c36" title="Find lanelet width from local position." alt="" coords="244,5,427,61"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aa76f916a1f30e25204262dcd17fcf4ac_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aa76f916a1f30e25204262dcd17fcf4ac_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aa76f916a1f30e25204262dcd17fcf4ac_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aa76f916a1f30e25204262dcd17fcf4ac_icgraph">
<area shape="rect" title="Function to determine if the host vehicle is close to the target platoon (used for cut&#45;in join scenar..." alt="" coords="660,5,851,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#afd00a90158f773100543b3f56f964d74" title="Function to process mobility operation in leader state." alt="" coords="429,5,612,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a9f77f3abf67b6006fd6c9b965cbb1c10" title="Callback function for Mobility Operation Message." alt="" coords="199,5,381,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,5,151,61"/>
</map>
</div>

</div>
</div>
<a id="af86af042a60d31a38a0be515bd4e5f9b" name="af86af042a60d31a38a0be515bd4e5f9b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af86af042a60d31a38a0be515bd4e5f9b">&#9670;&nbsp;</a></span>isVehicleRightBehind()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> platoon_strategic_ihp::PlatoonStrategicIHPPlugin::isVehicleRightBehind </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>downtrack</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>crosstrack</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to determine if the given downtrack distance (m) is behind the host vehicle. </p>
<p >note: This is only applicable for same lane application, so it will check cross track distance.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">downtrack</td><td>The downtrack distance (m) of the target vehicle to compare with the host. crosstrack: The crosstrack distance (m) of the target vehicle to compart with the host.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>(boolean): if target vehicle is behind the host vehicle. </dd></dl>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00232">232</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  233</span>    {   </div>
<div class="line"><span class="lineno">  234</span>        <span class="keywordtype">double</span> currentDtd = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa53003d4c3610dbb5f87762a6683dd9f">current_downtrack_</a>;</div>
<div class="line"><span class="lineno">  235</span>        <span class="keywordtype">double</span> currentCtd = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a79aaef859aaa4b64f6cf79c50c596bc3">current_crosstrack_</a>;</div>
<div class="line"><span class="lineno">  236</span>        <span class="keywordtype">bool</span> samelane = abs(currentCtd-crosstrack) &lt;= <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a3c2aa8b4742ba50d80bc9c23ed183ebf">maxCrosstrackError</a>;</div>
<div class="line"><span class="lineno">  237</span> </div>
<div class="line"><span class="lineno">  238</span>        <span class="keywordflow">if</span> (downtrack &lt; currentDtd &amp;&amp; samelane) </div>
<div class="line"><span class="lineno">  239</span>        {</div>
<div class="line"><span class="lineno">  240</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Found a platoon at behind. We are able to join&quot;</span>);</div>
<div class="line"><span class="lineno">  241</span>            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  242</span>        }</div>
<div class="line"><span class="lineno">  243</span>        <span class="keywordflow">else</span> </div>
<div class="line"><span class="lineno">  244</span>        {</div>
<div class="line"><span class="lineno">  245</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Ignoring platoon that is either ahead of us or in another lane.&quot;</span>);</div>
<div class="line"><span class="lineno">  246</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;The front platoon dtd is &quot;</span> &lt;&lt; downtrack &lt;&lt; <span class="stringliteral">&quot; and we are current at &quot;</span> &lt;&lt; currentDtd);</div>
<div class="line"><span class="lineno">  247</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  248</span>        }</div>
<div class="line"><span class="lineno">  249</span>    } </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__strategic__ihp_8h_source.html#l00318">config_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00332">current_crosstrack_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00330">current_downtrack_</a>, and <a class="el" href="platoon__config__ihp_8h_source.html#l00062">platoon_strategic_ihp::PlatoonPluginConfig::maxCrosstrackError</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00954">mob_op_cb_leader()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_af86af042a60d31a38a0be515bd4e5f9b_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_af86af042a60d31a38a0be515bd4e5f9b_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_af86af042a60d31a38a0be515bd4e5f9b_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_af86af042a60d31a38a0be515bd4e5f9b_icgraph">
<area shape="rect" title="Function to determine if the given downtrack distance (m) is behind the host vehicle." alt="" coords="660,5,843,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#afd00a90158f773100543b3f56f964d74" title="Function to process mobility operation in leader state." alt="" coords="429,5,612,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a9f77f3abf67b6006fd6c9b965cbb1c10" title="Callback function for Mobility Operation Message." alt="" coords="199,5,381,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,5,151,61"/>
</map>
</div>

</div>
</div>
<a id="a1f96a7552ba7778a703930c546a9816b" name="a1f96a7552ba7778a703930c546a9816b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f96a7552ba7778a703930c546a9816b">&#9670;&nbsp;</a></span>isVehicleRightInFront()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> platoon_strategic_ihp::PlatoonStrategicIHPPlugin::isVehicleRightInFront </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>downtrack</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>crosstrack</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to determine if a target vehicle is in the front of host vehicle note: This is only applicable for same lane application, so it will check cross track distance. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">downtrack</td><td>target vehicle downtrack distance relative to host's route (m) crosstrack: target vehicle crosstrack (m)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true or false </dd></dl>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00211">211</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  212</span>    {</div>
<div class="line"><span class="lineno">  213</span>        <span class="comment">// Position info of the host vehcile</span></div>
<div class="line"><span class="lineno">  214</span>        <span class="keywordtype">double</span> currentDtd = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa53003d4c3610dbb5f87762a6683dd9f">current_downtrack_</a>;</div>
<div class="line"><span class="lineno">  215</span>        <span class="keywordtype">double</span> currentCtd = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a79aaef859aaa4b64f6cf79c50c596bc3">current_crosstrack_</a>;</div>
<div class="line"><span class="lineno">  216</span>        <span class="keywordtype">bool</span> samelane = abs(currentCtd-crosstrack) &lt;= <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a3c2aa8b4742ba50d80bc9c23ed183ebf">maxCrosstrackError</a>;</div>
<div class="line"><span class="lineno">  217</span> </div>
<div class="line"><span class="lineno">  218</span>        <span class="keywordflow">if</span> (downtrack &gt; currentDtd &amp;&amp; samelane)</div>
<div class="line"><span class="lineno">  219</span>        {</div>
<div class="line"><span class="lineno">  220</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Found a platoon in front. We are able to join&quot;</span>);</div>
<div class="line"><span class="lineno">  221</span>            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  222</span>        }</div>
<div class="line"><span class="lineno">  223</span>        <span class="keywordflow">else</span> </div>
<div class="line"><span class="lineno">  224</span>        {</div>
<div class="line"><span class="lineno">  225</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Ignoring platoon that is either behind host or in another lane.&quot;</span>);</div>
<div class="line"><span class="lineno">  226</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;The front platoon dtd is &quot;</span> &lt;&lt; downtrack &lt;&lt; <span class="stringliteral">&quot; and we are current at &quot;</span> &lt;&lt; currentDtd);</div>
<div class="line"><span class="lineno">  227</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  228</span>        }</div>
<div class="line"><span class="lineno">  229</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__strategic__ihp_8h_source.html#l00318">config_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00332">current_crosstrack_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00330">current_downtrack_</a>, and <a class="el" href="platoon__config__ihp_8h_source.html#l00062">platoon_strategic_ihp::PlatoonPluginConfig::maxCrosstrackError</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00954">mob_op_cb_leader()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a1f96a7552ba7778a703930c546a9816b_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a1f96a7552ba7778a703930c546a9816b_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a1f96a7552ba7778a703930c546a9816b_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a1f96a7552ba7778a703930c546a9816b_icgraph">
<area shape="rect" title="Function to determine if a target vehicle is in the front of host vehicle note: This is only applicab..." alt="" coords="660,5,843,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#afd00a90158f773100543b3f56f964d74" title="Function to process mobility operation in leader state." alt="" coords="429,5,612,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a9f77f3abf67b6006fd6c9b965cbb1c10" title="Callback function for Mobility Operation Message." alt="" coords="199,5,381,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,5,151,61"/>
</map>
</div>

</div>
</div>
<a id="a9f77f3abf67b6006fd6c9b965cbb1c10" name="a9f77f3abf67b6006fd6c9b965cbb1c10"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f77f3abf67b6006fd6c9b965cbb1c10">&#9670;&nbsp;</a></span>mob_op_cb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_op_cb </td>
          <td>(</td>
          <td class="paramtype">const carma_v2x_msgs::msg::MobilityOperation::UniquePtr&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Callback function for Mobility Operation Message. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>Mobility Operation Message </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00809">809</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  810</span>    {</div>
<div class="line"><span class="lineno">  811</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> == <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa839ccd0c7e2e3441b3cd9ca0546be97b">PlatoonState::STANDBY</a>)</div>
<div class="line"><span class="lineno">  812</span>        {</div>
<div class="line"><span class="lineno">  813</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  814</span>        }</div>
<div class="line"><span class="lineno">  815</span> </div>
<div class="line"><span class="lineno">  816</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;mob_op_cb received msg with sender ID &quot;</span> &lt;&lt; msg-&gt;m_header.sender_id</div>
<div class="line"><span class="lineno">  817</span>                        &lt;&lt; <span class="stringliteral">&quot;, plan ID &quot;</span> &lt;&lt; msg-&gt;m_header.plan_id);</div>
<div class="line"><span class="lineno">  818</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;...strategy &quot;</span> &lt;&lt; msg-&gt;strategy &lt;&lt; <span class="stringliteral">&quot;, strategy params &quot;</span> &lt;&lt; msg-&gt;strategy_params);</div>
<div class="line"><span class="lineno">  819</span> </div>
<div class="line"><span class="lineno">  820</span>        <span class="comment">// Check that this is a message about platooning (could be from some other Carma activity nearby)</span></div>
<div class="line"><span class="lineno">  821</span>        std::string strategy = msg-&gt;strategy;</div>
<div class="line"><span class="lineno">  822</span>        <span class="keywordflow">if</span> (strategy.rfind(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3be0b52376b568130c1c6a5ec5adeb13">PLATOONING_STRATEGY</a>, 0) != 0)</div>
<div class="line"><span class="lineno">  823</span>        {</div>
<div class="line"><span class="lineno">  824</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Ignoring mobility operation message for &quot;</span> &lt;&lt; strategy &lt;&lt; <span class="stringliteral">&quot; strategy.&quot;</span>);</div>
<div class="line"><span class="lineno">  825</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  826</span>        }</div>
<div class="line"><span class="lineno">  827</span> </div>
<div class="line"><span class="lineno">  828</span>        <span class="comment">// Ignore messages as long as host vehicle is stopped</span></div>
<div class="line"><span class="lineno">  829</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3e827c7f2e764c6e7de83f0a81a9593f">current_speed_</a> &lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae53ddfbfa903ffe85722c9471cdfd3af">STOPPED_SPEED</a>)</div>
<div class="line"><span class="lineno">  830</span>        {</div>
<div class="line"><span class="lineno">  831</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Ignoring message since host is stopped.&quot;</span>);</div>
<div class="line"><span class="lineno">  832</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  833</span>        }</div>
<div class="line"><span class="lineno">  834</span> </div>
<div class="line"><span class="lineno">  835</span>        <span class="comment">// Perform common operations that apply to all states</span></div>
<div class="line"><span class="lineno">  836</span>        std::string strategyParams = msg-&gt;strategy_params;</div>
<div class="line"><span class="lineno">  837</span>        <span class="keywordtype">bool</span> isPlatoonStatusMsg = strategyParams.rfind(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a243c9d3b652447765feab04517074520">OPERATION_STATUS_TYPE</a>, 0) == 0;</div>
<div class="line"><span class="lineno">  838</span>        <span class="keywordtype">bool</span> isPlatoonInfoMsg = strategyParams.rfind(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a56907ad89ed257fc81cbb7faf4221005">OPERATION_INFO_TYPE</a>, 0) == 0;</div>
<div class="line"><span class="lineno">  839</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;strategyParams: &quot;</span> &lt;&lt; strategyParams &lt;&lt; <span class="stringliteral">&quot;isPlatoonStatusMsg: &quot;</span> &lt;&lt; isPlatoonStatusMsg &lt;&lt; <span class="stringliteral">&quot;isPlatoonInfoMsg: &quot;</span> &lt;&lt; isPlatoonInfoMsg);</div>
<div class="line"><span class="lineno">  840</span>        <span class="keywordflow">if</span> (isPlatoonStatusMsg) </div>
<div class="line"><span class="lineno">  841</span>        {</div>
<div class="line"><span class="lineno">  842</span>            <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aeac839f63dec331ca94a0feee2c949f4">mob_op_cb_STATUS</a>(*msg);</div>
<div class="line"><span class="lineno">  843</span>        }</div>
<div class="line"><span class="lineno">  844</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isPlatoonInfoMsg)</div>
<div class="line"><span class="lineno">  845</span>        {</div>
<div class="line"><span class="lineno">  846</span>            <span class="comment">// Note: this is where confusion will reign if multiple neighbor platoons are discovered; need more sophisticated</span></div>
<div class="line"><span class="lineno">  847</span>            <span class="comment">//       logic to handle that situation</span></div>
<div class="line"><span class="lineno">  848</span> </div>
<div class="line"><span class="lineno">  849</span>            <span class="comment">// If it is a legitimate platoon (2 or more members) other than our own then</span></div>
<div class="line"><span class="lineno">  850</span>            std::vector&lt;std::string&gt; inputsParams;</div>
<div class="line"><span class="lineno">  851</span>            <a class="code hl_variable" href="namespaceprocess__traj__logs.html#a3682477a3431f2a4aa182fb9a6439125">boost::algorithm::split</a>(inputsParams, strategyParams, boost::is_any_of(<span class="stringliteral">&quot;,&quot;</span>));</div>
<div class="line"><span class="lineno">  852</span>            std::vector&lt;std::string&gt; p_size;</div>
<div class="line"><span class="lineno">  853</span>            <a class="code hl_variable" href="namespaceprocess__traj__logs.html#a3682477a3431f2a4aa182fb9a6439125">boost::algorithm::split</a>(p_size, inputsParams[2], boost::is_any_of(<span class="stringliteral">&quot;:&quot;</span>));</div>
<div class="line"><span class="lineno">  854</span>            <span class="keywordtype">int</span> platoon_size = std::stoi(p_size[1]);</div>
<div class="line"><span class="lineno">  855</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;neighbor platoon_size from INFO: &quot;</span> &lt;&lt; platoon_size);</div>
<div class="line"><span class="lineno">  856</span>            <span class="keywordflow">if</span> (platoon_size &gt; 1  &amp;&amp;  msg-&gt;m_header.plan_id.compare(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a634f99de503cccb2f2d3cb955623dde2">currentPlatoonID</a>) != 0)</div>
<div class="line"><span class="lineno">  857</span>            {</div>
<div class="line"><span class="lineno">  858</span>                <span class="comment">// If platoon ID doesn&#39;t match our known target platoon then clear any old neighbor platoon info and record</span></div>
<div class="line"><span class="lineno">  859</span>                <span class="comment">// the platoon ID and the sender as the leader (only leaders send INFO)</span></div>
<div class="line"><span class="lineno">  860</span>                <span class="keywordflow">if</span> (msg-&gt;m_header.plan_id.compare(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0fadcff41a35df3fe821f05cc1452c45">neighborPlatoonID</a>) != 0)</div>
<div class="line"><span class="lineno">  861</span>                {</div>
<div class="line"><span class="lineno">  862</span>                    <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#abca93088e8980c97a1a24c4fff31c758">resetNeighborPlatoon</a>();</div>
<div class="line"><span class="lineno">  863</span>                    <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0fadcff41a35df3fe821f05cc1452c45">neighborPlatoonID</a> = msg-&gt;m_header.plan_id;</div>
<div class="line"><span class="lineno">  864</span>                }</div>
<div class="line"><span class="lineno">  865</span>                <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8fa6576577e52bb8e1a31fef457defa9">neighbor_platoon_leader_id_</a> = msg-&gt;m_header.sender_id;</div>
<div class="line"><span class="lineno">  866</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;pm_.neighbor_platoon_leader_id_: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8fa6576577e52bb8e1a31fef457defa9">neighbor_platoon_leader_id_</a>);</div>
<div class="line"><span class="lineno">  867</span>                <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a36f41aa23d9cc311f1d2b017a008d0ed">neighbor_platoon_info_size_</a> = platoon_size;</div>
<div class="line"><span class="lineno">  868</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;pm_.neighbor_platoon_info_size_: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a36f41aa23d9cc311f1d2b017a008d0ed">neighbor_platoon_info_size_</a>);</div>
<div class="line"><span class="lineno">  869</span>            }</div>
<div class="line"><span class="lineno">  870</span>        }</div>
<div class="line"><span class="lineno">  871</span> </div>
<div class="line"><span class="lineno">  872</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  873</span>        {</div>
<div class="line"><span class="lineno">  874</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Invalid Mob Op received&quot;</span>);</div>
<div class="line"><span class="lineno">  875</span>        }</div>
<div class="line"><span class="lineno">  876</span> </div>
<div class="line"><span class="lineno">  877</span>        <span class="comment">// Perform state-specific additional actions</span></div>
<div class="line"><span class="lineno">  878</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> == <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa57f78e815f4fc2ac271a9fd85cd80ebc">PlatoonState::LEADER</a>)</div>
<div class="line"><span class="lineno">  879</span>        {</div>
<div class="line"><span class="lineno">  880</span>            <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#afd00a90158f773100543b3f56f964d74">mob_op_cb_leader</a>(*msg);</div>
<div class="line"><span class="lineno">  881</span>        }</div>
<div class="line"><span class="lineno">  882</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> == <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa0d2c16ab07ed24865f7ba27ad8a83dc0">PlatoonState::FOLLOWER</a>)</div>
<div class="line"><span class="lineno">  883</span>        {</div>
<div class="line"><span class="lineno">  884</span>            <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae28a41d0b5586da8165051e8ccb044a9">mob_op_cb_follower</a>(*msg);</div>
<div class="line"><span class="lineno">  885</span>        }</div>
<div class="line"><span class="lineno">  886</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> == <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafab7680aa6ec3a24dc42cb374192eb39a3">PlatoonState::CANDIDATEFOLLOWER</a>)</div>
<div class="line"><span class="lineno">  887</span>        {</div>
<div class="line"><span class="lineno">  888</span>            <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a716601497689610ef44a056a062c32bf">mob_op_cb_candidatefollower</a>(*msg);</div>
<div class="line"><span class="lineno">  889</span>        }</div>
<div class="line"><span class="lineno">  890</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> == <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa70d610aa504abb163caf9a5ee931d090">PlatoonState::LEADERWAITING</a>)</div>
<div class="line"><span class="lineno">  891</span>        {</div>
<div class="line"><span class="lineno">  892</span>            <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a5c2e50853fa2e7e7c855271bc669e5dd">mob_op_cb_leaderwaiting</a>(*msg);</div>
<div class="line"><span class="lineno">  893</span>        }</div>
<div class="line"><span class="lineno">  894</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> == <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa839ccd0c7e2e3441b3cd9ca0546be97b">PlatoonState::STANDBY</a>)</div>
<div class="line"><span class="lineno">  895</span>        {</div>
<div class="line"><span class="lineno">  896</span>            <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ade1a16b0f87bd693447cdbbeb960fbba">mob_op_cb_standby</a>(*msg);</div>
<div class="line"><span class="lineno">  897</span>        }</div>
<div class="line"><span class="lineno">  898</span>        <span class="comment">// UCLA: add leader aborting </span></div>
<div class="line"><span class="lineno">  899</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> == <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafae176dd79ff2c2bc4b2f7901fbfc53014">PlatoonState::LEADERABORTING</a>)</div>
<div class="line"><span class="lineno">  900</span>        {</div>
<div class="line"><span class="lineno">  901</span>            <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a0c9c86742dd6bd516c176bd9a3e72093">mob_op_cb_leaderaborting</a>(*msg);</div>
<div class="line"><span class="lineno">  902</span>        }</div>
<div class="line"><span class="lineno">  903</span>        <span class="comment">// UCLA: add candidate leader </span></div>
<div class="line"><span class="lineno">  904</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> == <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa52c17c95a5cd81220db3fdd9181d43bd">PlatoonState::CANDIDATELEADER</a>)</div>
<div class="line"><span class="lineno">  905</span>        {   </div>
<div class="line"><span class="lineno">  906</span>            <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2155b77f46b98000b523eddd04e86ad3">mob_op_cb_candidateleader</a>(*msg);</div>
<div class="line"><span class="lineno">  907</span>        }    </div>
<div class="line"><span class="lineno">  908</span>        <span class="comment">// UCLA: add lead with operation for cut-in join</span></div>
<div class="line"><span class="lineno">  909</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> == <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa7d32254f1798e4564e467d332c383112">PlatoonState::LEADWITHOPERATION</a>)</div>
<div class="line"><span class="lineno">  910</span>        {</div>
<div class="line"><span class="lineno">  911</span>            <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a684d176f0a01b8cdbb8bff7e686367ed">mob_op_cb_leadwithoperation</a>(*msg);</div>
<div class="line"><span class="lineno">  912</span>        }</div>
<div class="line"><span class="lineno">  913</span>        <span class="comment">// UCLA: add prepare to join for cut-in join</span></div>
<div class="line"><span class="lineno">  914</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> == <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafafe45c20d03a8d502486cff766672bdf9">PlatoonState::PREPARETOJOIN</a>)</div>
<div class="line"><span class="lineno">  915</span>        {</div>
<div class="line"><span class="lineno">  916</span>            <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#afe00eb7730952e85faccf8032637983f">mob_op_cb_preparetojoin</a>(*msg);</div>
<div class="line"><span class="lineno">  917</span>        }</div>
<div class="line"><span class="lineno">  918</span>        <span class="comment">// TODO: Place holder for prepare to depart</span></div>
<div class="line"><span class="lineno">  919</span> </div>
<div class="line"><span class="lineno">  920</span>        <span class="comment">// TODO: If needed (with large size platoons), add a queue for status messages</span></div>
<div class="line"><span class="lineno">  921</span>        <span class="comment">//       INFO messages always processed, STATUS messages if saved in que</span></div>
<div class="line"><span class="lineno">  922</span>    }</div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_a0fadcff41a35df3fe821f05cc1452c45"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0fadcff41a35df3fe821f05cc1452c45">platoon_strategic_ihp::PlatoonManager::neighborPlatoonID</a></div><div class="ttdeci">std::string neighborPlatoonID</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00392">platoon_manager_ihp.h:392</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_a36f41aa23d9cc311f1d2b017a008d0ed"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a36f41aa23d9cc311f1d2b017a008d0ed">platoon_strategic_ihp::PlatoonManager::neighbor_platoon_info_size_</a></div><div class="ttdeci">size_t neighbor_platoon_info_size_</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00387">platoon_manager_ihp.h:387</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_a8fa6576577e52bb8e1a31fef457defa9"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8fa6576577e52bb8e1a31fef457defa9">platoon_strategic_ihp::PlatoonManager::neighbor_platoon_leader_id_</a></div><div class="ttdeci">std::string neighbor_platoon_leader_id_</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00395">platoon_manager_ihp.h:395</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_abca93088e8980c97a1a24c4fff31c758"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#abca93088e8980c97a1a24c4fff31c758">platoon_strategic_ihp::PlatoonManager::resetNeighborPlatoon</a></div><div class="ttdeci">void resetNeighborPlatoon()</div><div class="ttdoc">Resets all variables that describe a neighbor platoon, so that no neighbor is known.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00313">platoon_manager_ihp.cpp:313</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a0c9c86742dd6bd516c176bd9a3e72093"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a0c9c86742dd6bd516c176bd9a3e72093">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_op_cb_leaderaborting</a></div><div class="ttdeci">void mob_op_cb_leaderaborting(const carma_v2x_msgs::msg::MobilityOperation &amp;msg)</div><div class="ttdoc">Function to process mobility operation in leaderaborting state.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l01226">platoon_strategic_ihp.cpp:1226</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a2155b77f46b98000b523eddd04e86ad3"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2155b77f46b98000b523eddd04e86ad3">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_op_cb_candidateleader</a></div><div class="ttdeci">void mob_op_cb_candidateleader(const carma_v2x_msgs::msg::MobilityOperation &amp;msg)</div><div class="ttdoc">Function to process mobility operation in candidateleader state.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l01232">platoon_strategic_ihp.cpp:1232</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a5c2e50853fa2e7e7c855271bc669e5dd"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a5c2e50853fa2e7e7c855271bc669e5dd">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_op_cb_leaderwaiting</a></div><div class="ttdeci">void mob_op_cb_leaderwaiting(const carma_v2x_msgs::msg::MobilityOperation &amp;msg)</div><div class="ttdoc">Function to process mobility operation in leader waiting state.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l00948">platoon_strategic_ihp.cpp:948</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a684d176f0a01b8cdbb8bff7e686367ed"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a684d176f0a01b8cdbb8bff7e686367ed">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_op_cb_leadwithoperation</a></div><div class="ttdeci">void mob_op_cb_leadwithoperation(const carma_v2x_msgs::msg::MobilityOperation &amp;msg)</div><div class="ttdoc">Function to process mobility operation in LeadWithOperation state (cut-in join)</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l01238">platoon_strategic_ihp.cpp:1238</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a716601497689610ef44a056a062c32bf"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a716601497689610ef44a056a062c32bf">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_op_cb_candidatefollower</a></div><div class="ttdeci">void mob_op_cb_candidatefollower(const carma_v2x_msgs::msg::MobilityOperation &amp;msg)</div><div class="ttdoc">Function to process mobility operation in candidate follower state.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l00931">platoon_strategic_ihp.cpp:931</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_ade1a16b0f87bd693447cdbbeb960fbba"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ade1a16b0f87bd693447cdbbeb960fbba">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_op_cb_standby</a></div><div class="ttdeci">void mob_op_cb_standby(const carma_v2x_msgs::msg::MobilityOperation &amp;msg)</div><div class="ttdoc">Function to process mobility operation in standby state.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l00924">platoon_strategic_ihp.cpp:924</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_ae28a41d0b5586da8165051e8ccb044a9"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae28a41d0b5586da8165051e8ccb044a9">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_op_cb_follower</a></div><div class="ttdeci">void mob_op_cb_follower(const carma_v2x_msgs::msg::MobilityOperation &amp;msg)</div><div class="ttdoc">Function to process mobility operation in follower state.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l00937">platoon_strategic_ihp.cpp:937</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_ae53ddfbfa903ffe85722c9471cdfd3af"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae53ddfbfa903ffe85722c9471cdfd3af">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::STOPPED_SPEED</a></div><div class="ttdeci">const double STOPPED_SPEED</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8h_source.html#l00805">platoon_strategic_ihp.h:805</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_aeac839f63dec331ca94a0feee2c949f4"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aeac839f63dec331ca94a0feee2c949f4">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_op_cb_STATUS</a></div><div class="ttdeci">void mob_op_cb_STATUS(const carma_v2x_msgs::msg::MobilityOperation &amp;msg)</div><div class="ttdoc">Function to process mobility operation message with STATUS params, read ecef location and update plat...</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l00708">platoon_strategic_ihp.cpp:708</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_afd00a90158f773100543b3f56f964d74"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#afd00a90158f773100543b3f56f964d74">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_op_cb_leader</a></div><div class="ttdeci">void mob_op_cb_leader(const carma_v2x_msgs::msg::MobilityOperation &amp;msg)</div><div class="ttdoc">Function to process mobility operation in leader state.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l00954">platoon_strategic_ihp.cpp:954</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_afe00eb7730952e85faccf8032637983f"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#afe00eb7730952e85faccf8032637983f">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_op_cb_preparetojoin</a></div><div class="ttdeci">void mob_op_cb_preparetojoin(const carma_v2x_msgs::msg::MobilityOperation &amp;msg)</div><div class="ttdoc">Function to process mobility operation in PrepareToJoin state (cut-in join)</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l01244">platoon_strategic_ihp.cpp:1244</a></div></div>
<div class="ttc" id="anamespaceprocess__traj__logs_html_a3682477a3431f2a4aa182fb9a6439125"><div class="ttname"><a href="namespaceprocess__traj__logs.html#a3682477a3431f2a4aa182fb9a6439125">process_traj_logs.split</a></div><div class="ttdeci">split</div><div class="ttdef"><b>Definition:</b> <a href="process__traj__logs_8py_source.html#l00165">process_traj_logs.py:165</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__manager__ihp_8h_source.html#l00081">platoon_strategic_ihp::CANDIDATEFOLLOWER</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00086">platoon_strategic_ihp::CANDIDATELEADER</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00370">platoon_strategic_ihp::PlatoonManager::current_platoon_state</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00328">current_speed_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00364">platoon_strategic_ihp::PlatoonManager::currentPlatoonID</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00082">platoon_strategic_ihp::FOLLOWER</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00080">platoon_strategic_ihp::LEADER</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00084">platoon_strategic_ihp::LEADERABORTING</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00079">platoon_strategic_ihp::LEADERWAITING</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00088">platoon_strategic_ihp::LEADWITHOPERATION</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00931">mob_op_cb_candidatefollower()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01232">mob_op_cb_candidateleader()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00937">mob_op_cb_follower()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00954">mob_op_cb_leader()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01226">mob_op_cb_leaderaborting()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00948">mob_op_cb_leaderwaiting()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01238">mob_op_cb_leadwithoperation()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01244">mob_op_cb_preparetojoin()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00924">mob_op_cb_standby()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00708">mob_op_cb_STATUS()</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00387">platoon_strategic_ihp::PlatoonManager::neighbor_platoon_info_size_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00395">platoon_strategic_ihp::PlatoonManager::neighbor_platoon_leader_id_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00392">platoon_strategic_ihp::PlatoonManager::neighborPlatoonID</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00821">OPERATION_INFO_TYPE</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00822">OPERATION_STATUS_TYPE</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00820">PLATOONING_STRATEGY</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00817">pm_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00090">platoon_strategic_ihp::PREPARETOJOIN</a>, <a class="el" href="platoon__manager__ihp_8cpp_source.html#l00313">platoon_strategic_ihp::PlatoonManager::resetNeighborPlatoon()</a>, <a class="el" href="process__traj__logs_8py_source.html#l00165">process_traj_logs::split</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00078">platoon_strategic_ihp::STANDBY</a>, and <a class="el" href="platoon__strategic__ihp_8h_source.html#l00805">STOPPED_SPEED</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp__node_8cpp_source.html#l00118">platoon_strategic_ihp::Node::on_configure_plugin()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a9f77f3abf67b6006fd6c9b965cbb1c10_cgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a9f77f3abf67b6006fd6c9b965cbb1c10_cgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a9f77f3abf67b6006fd6c9b965cbb1c10_cgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a9f77f3abf67b6006fd6c9b965cbb1c10_cgraph">
<area shape="rect" title="Callback function for Mobility Operation Message." alt="" coords="5,405,188,461"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a716601497689610ef44a056a062c32bf" title="Function to process mobility operation in candidate follower state." alt="" coords="239,5,442,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2155b77f46b98000b523eddd04e86ad3" title="Function to process mobility operation in candidateleader state." alt="" coords="244,85,437,141"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae28a41d0b5586da8165051e8ccb044a9" title="Function to process mobility operation in follower state." alt="" coords="249,165,432,221"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#afd00a90158f773100543b3f56f964d74" title="Function to process mobility operation in leader state." alt="" coords="249,405,432,461"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a0c9c86742dd6bd516c176bd9a3e72093" title="Function to process mobility operation in leaderaborting state." alt="" coords="249,485,432,541"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a5c2e50853fa2e7e7c855271bc669e5dd" title="Function to process mobility operation in leader waiting state." alt="" coords="249,565,432,621"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a684d176f0a01b8cdbb8bff7e686367ed" title="Function to process mobility operation in LeadWithOperation state (cut&#45;in join)" alt="" coords="239,645,442,701"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#afe00eb7730952e85faccf8032637983f" title="Function to process mobility operation in PrepareToJoin state (cut&#45;in join)" alt="" coords="249,325,432,381"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ade1a16b0f87bd693447cdbbeb960fbba" title="Function to process mobility operation in standby state." alt="" coords="249,725,432,781"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aeac839f63dec331ca94a0feee2c949f4" title="Function to process mobility operation message with STATUS params, read ecef location and update plat..." alt="" coords="249,245,432,301"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#abca93088e8980c97a1a24c4fff31c758" title="Resets all variables that describe a neighbor platoon, so that no neighbor is known." alt="" coords="236,805,445,861"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a876cee27af19b1f215ffd4a2190be371" title="Function to convert ecef location to a 2d point in map frame." alt="" coords="540,245,723,301"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a3ef30eeb7a7cf0caccb948e6a41f92" title="Returns total size of the platoon , in number of vehicles." alt="" coords="510,485,753,526"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa76f916a1f30e25204262dcd17fcf4ac" title="Function to determine if the host vehicle is close to the target platoon (used for cut&#45;in join scenar..." alt="" coords="536,645,727,701"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#af86af042a60d31a38a0be515bd4e5f9b" title="Function to determine if the given downtrack distance (m) is behind the host vehicle." alt="" coords="540,725,723,781"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a1f96a7552ba7778a703930c546a9816b" title="Function to determine if a target vehicle is in the front of host vehicle note: This is only applicab..." alt="" coords="540,805,723,861"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ab475f5a72d52048d8a4a09617634e24f" title="Function to process mobility operation INFO params to find platoon leader&#39;s ecef location." alt="" coords="504,325,759,381"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a41bb6d04569023ef9480fa263a804a8c" title="Function to process mobility operation INFO params to find platoon length in m." alt="" coords="535,550,727,621"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a11ffedaaa90fe358ecfdccab7c5a428c" title="Function to convert pose from map frame to ecef location." alt="" coords="540,405,723,461"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ad3cd4b02451fd0b0a25ed712e3331c36" title="Find lanelet width from local position." alt="" coords="829,645,1011,701"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#aa09eb8121e30d6ee3517823766dbeea4" title="Update information for members of the host&#39;s platoon based on a mobility operation STATUS message." alt="" coords="531,165,731,221"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3049b9bc64b95a37fe66b83ee6a67a88" title="Function to process mobility operation for STATUS params." alt="" coords="493,5,769,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#aef18115269a340fb9e89452acd05658f" title="Update information for members of a neighboring platoon based on a mobility operation STATUS message." alt="" coords="519,85,743,141"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a10f95b2573ee211d8f9b07f8d7551809" title="Returns command speed. in m/s." alt="" coords="817,325,1023,381"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ac7017e74336d2270a0d66249a46c7dbb" title="Returns current crosstrack distance, in m." alt="" coords="826,85,1014,141"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8f79bf82a5c6ba800fd48f9ed819f606" title="Returns current downtrack distance, in m." alt="" coords="826,165,1014,221"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ac123534207dc3ea247cfb1281426cd84" title="Returns current speed, in m/s." alt="" coords="826,245,1014,301"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ae696d79ca33f496082ef462fdc9ba53b" title="Returns current host static ID as a string." alt="" coords="1071,206,1292,247"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a6b4eae07dfc95c25104f95fef1f0f344" title="Updates the list of vehicles in the specified platoon, based on info available from a mobility operat..." alt="" coords="826,5,1014,61"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a9f77f3abf67b6006fd6c9b965cbb1c10_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a9f77f3abf67b6006fd6c9b965cbb1c10_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a9f77f3abf67b6006fd6c9b965cbb1c10_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a9f77f3abf67b6006fd6c9b965cbb1c10_icgraph">
<area shape="rect" title="Callback function for Mobility Operation Message." alt="" coords="199,5,381,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,5,151,61"/>
</map>
</div>

</div>
</div>
<a id="a716601497689610ef44a056a062c32bf" name="a716601497689610ef44a056a062c32bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a716601497689610ef44a056a062c32bf">&#9670;&nbsp;</a></span>mob_op_cb_candidatefollower()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_op_cb_candidatefollower </td>
          <td>(</td>
          <td class="paramtype">const carma_v2x_msgs::msg::MobilityOperation &amp;&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to process mobility operation in candidate follower state. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>incoming mobility operation </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00931">931</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  932</span>    {</div>
<div class="line"><span class="lineno">  933</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;CANDIDATEFOLLOWER state no further action on message from &quot;</span> &lt;&lt; msg.m_header.sender_id);</div>
<div class="line"><span class="lineno">  934</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00809">mob_op_cb()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a716601497689610ef44a056a062c32bf_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a716601497689610ef44a056a062c32bf_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a716601497689610ef44a056a062c32bf_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a716601497689610ef44a056a062c32bf_icgraph">
<area shape="rect" title="Function to process mobility operation in candidate follower state." alt="" coords="429,5,632,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a9f77f3abf67b6006fd6c9b965cbb1c10" title="Callback function for Mobility Operation Message." alt="" coords="199,5,381,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,5,151,61"/>
</map>
</div>

</div>
</div>
<a id="a2155b77f46b98000b523eddd04e86ad3" name="a2155b77f46b98000b523eddd04e86ad3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2155b77f46b98000b523eddd04e86ad3">&#9670;&nbsp;</a></span>mob_op_cb_candidateleader()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_op_cb_candidateleader </td>
          <td>(</td>
          <td class="paramtype">const carma_v2x_msgs::msg::MobilityOperation &amp;&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to process mobility operation in candidateleader state. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>incoming mobility operation message. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01232">1232</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1233</span>    {   </div>
<div class="line"><span class="lineno"> 1234</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;CANDIDATELEADER state no further action on message from &quot;</span> &lt;&lt; msg.m_header.sender_id);</div>
<div class="line"><span class="lineno"> 1235</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00809">mob_op_cb()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a2155b77f46b98000b523eddd04e86ad3_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a2155b77f46b98000b523eddd04e86ad3_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a2155b77f46b98000b523eddd04e86ad3_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a2155b77f46b98000b523eddd04e86ad3_icgraph">
<area shape="rect" title="Function to process mobility operation in candidateleader state." alt="" coords="429,5,623,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a9f77f3abf67b6006fd6c9b965cbb1c10" title="Callback function for Mobility Operation Message." alt="" coords="199,5,381,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,5,151,61"/>
</map>
</div>

</div>
</div>
<a id="ae28a41d0b5586da8165051e8ccb044a9" name="ae28a41d0b5586da8165051e8ccb044a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae28a41d0b5586da8165051e8ccb044a9">&#9670;&nbsp;</a></span>mob_op_cb_follower()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_op_cb_follower </td>
          <td>(</td>
          <td class="paramtype">const carma_v2x_msgs::msg::MobilityOperation &amp;&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to process mobility operation in follower state. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>incoming mobility operation </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00937">937</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  938</span>    {</div>
<div class="line"><span class="lineno">  939</span>        <span class="comment">//std::string strategyParams = msg.strategy_params;</span></div>
<div class="line"><span class="lineno">  940</span>        <span class="comment">//bool isPlatoonStatusMsg = (strategyParams.rfind(OPERATION_STATUS_TYPE, 0) == 0);</span></div>
<div class="line"><span class="lineno">  941</span> </div>
<div class="line"><span class="lineno">  942</span>        <span class="comment">// TODO: Place holder for prepare to depart</span></div>
<div class="line"><span class="lineno">  943</span> </div>
<div class="line"><span class="lineno">  944</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;FOLLOWER state no further action on message from &quot;</span> &lt;&lt; msg.m_header.sender_id);</div>
<div class="line"><span class="lineno">  945</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00809">mob_op_cb()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ae28a41d0b5586da8165051e8ccb044a9_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ae28a41d0b5586da8165051e8ccb044a9_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ae28a41d0b5586da8165051e8ccb044a9_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ae28a41d0b5586da8165051e8ccb044a9_icgraph">
<area shape="rect" title="Function to process mobility operation in follower state." alt="" coords="429,5,612,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a9f77f3abf67b6006fd6c9b965cbb1c10" title="Callback function for Mobility Operation Message." alt="" coords="199,5,381,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,5,151,61"/>
</map>
</div>

</div>
</div>
<a id="afd00a90158f773100543b3f56f964d74" name="afd00a90158f773100543b3f56f964d74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd00a90158f773100543b3f56f964d74">&#9670;&nbsp;</a></span>mob_op_cb_leader()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_op_cb_leader </td>
          <td>(</td>
          <td class="paramtype">const carma_v2x_msgs::msg::MobilityOperation &amp;&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to process mobility operation in leader state. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>incoming mobility operation </td></tr>
  </table>
  </dd>
</dl>
<p >Note: This is the function to handle the mobility operation message. Vehicle in leader state is either a single ADS vehicle or a platoon leader.</p>
<p >Single ADS will send out INFO messages. Platoon leaders will send out both INFO and STATUS messages.</p>
<p >If the host is single vehicle, it should have "isPlatoonInfoMsg = true" and "isInNegotiation = false". In such condition, single leader will start joining and send request to the platoon leader. mob_op_cb_leader(</p>
<p >If the host vehicle is platoon leader, then it should have "isPlatoonInfoMsg = true" and "isInNegotiation = true". But existing platoon leader do not need to send out joining request.</p>
<p >Both the platoon leader and single vehicle need to subscribe to the STATUS message to populate the platoon manager with existing platoon members, so the PM can calculate dtd and ctd corresponds to host vehicle's origin position, hence to be used for later calculation. <br  />
</p>
<p >note: [<b>veh3*] -------&mdash; [<em>veh2</em>] --------------&mdash; [<em>veh1</em>] -------&mdash; [*veh0</b>] |&lt;---------------&mdash; front-rear DTD difference -----------------&mdash;&gt;| |&lt;--------------------------&mdash; platoon length -------------------------&mdash;&gt;|</p>
<p >front-rear DTD difference = platoon_length + one_vehicle_length Vehicle length is already accounted for in the message's LENGTH value</p>
<p >Note: "isVehicleRightInFront" tests for same lane</p>
<p >Note: "isVehicleRightBehind" tests for same lane</p>
<p >JOIN_PARAMS format: JOIN_PARAMS| --&gt; "SIZE:%1%,SPEED:%2%,ECEFX:%3%,ECEFY:%4%,ECEFZ:%5%,JOINIDX:%6%" |----&mdash;0---&mdash; &ndash;1------&mdash;2------&mdash;3------&mdash;4-------&mdash;5----&mdash;| <br  />
</p>
<p >UCLA Implementation note:</p><ol type="1">
<li>isVehicleNearTargetPlatoon --&gt; determine if the platoon is next to host vehicle</li>
<li>sender_id == requesting veh ID --&gt; joiner ID</li>
</ol>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00954">954</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  955</span>    {   </div>
<div class="line"><span class="lineno">  971</span>        <span class="comment">// Read incoming message info</span></div>
<div class="line"><span class="lineno">  972</span>        std::string strategyParams = msg.strategy_params;</div>
<div class="line"><span class="lineno">  973</span>        std::string senderId = msg.m_header.sender_id; </div>
<div class="line"><span class="lineno">  974</span>        std::string platoonId = msg.m_header.plan_id; </div>
<div class="line"><span class="lineno">  975</span> </div>
<div class="line"><span class="lineno">  976</span>        <span class="comment">// In the current state, host vehicle care about the INFO heart-beat operation message if we are not currently in</span></div>
<div class="line"><span class="lineno">  977</span>        <span class="comment">// a negotiation, and host also need to care about operation from members in our current platoon.</span></div>
<div class="line"><span class="lineno">  978</span>        <span class="keywordtype">bool</span> isPlatoonInfoMsg = strategyParams.rfind(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a56907ad89ed257fc81cbb7faf4221005">OPERATION_INFO_TYPE</a>, 0) == 0;            <span class="comment">// INFO message only broadcast by leader and single CAV.</span></div>
<div class="line"><span class="lineno">  979</span>        <span class="keywordtype">bool</span> isInNegotiation = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a9474313cd68557978e8dbd481d0408bc">valid</a>  ||  <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a634f99de503cccb2f2d3cb955623dde2">currentPlatoonID</a>.compare(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ae067830e0351c8ba271b00cb4a6f15c1">dummyID</a>) != 0; <span class="comment">// In negotiation indicates host is not available to become a joiner</span></div>
<div class="line"><span class="lineno">  980</span>                                                                                              <span class="comment">// (i.e., not currently in a platoon or trying to join a platoon).</span></div>
<div class="line"><span class="lineno">  981</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Top of mob_op_cb_leader, isInNegotiation = &quot;</span> &lt;&lt; isInNegotiation);</div>
<div class="line"><span class="lineno">  982</span> </div>
<div class="line"><span class="lineno">  983</span>        <span class="comment">// Condition 1. Host vehicle is the single CAV joining the platoon.</span></div>
<div class="line"><span class="lineno">  984</span>        <span class="keywordflow">if</span> (isPlatoonInfoMsg &amp;&amp; !isInNegotiation)</div>
<div class="line"><span class="lineno">  985</span>        {</div>
<div class="line"><span class="lineno">  986</span>            <span class="comment">//TODO future enhancement: add logic here for if/how to join two existing platoons</span></div>
<div class="line"><span class="lineno">  987</span>            <span class="comment">//     (e.g. the shorter platoon should join the longer one, or rear joins front if same length)</span></div>
<div class="line"><span class="lineno">  988</span> </div>
<div class="line"><span class="lineno">  989</span>            <span class="comment">// step 1. read INFO message from the target platoon leader</span></div>
<div class="line"><span class="lineno">  990</span> </div>
<div class="line"><span class="lineno">  991</span>            <span class="comment">// read ecef location from strategy params.</span></div>
<div class="line"><span class="lineno">  992</span>            carma_v2x_msgs::msg::LocationECEF ecef_loc;</div>
<div class="line"><span class="lineno">  993</span>            ecef_loc = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ab475f5a72d52048d8a4a09617634e24f">mob_op_find_ecef_from_INFO_params</a>(strategyParams);</div>
<div class="line"><span class="lineno">  994</span>            </div>
<div class="line"><span class="lineno">  995</span>            <span class="comment">// use ecef_loc to calculate front Dtd in m.</span></div>
<div class="line"><span class="lineno">  996</span>            lanelet::BasicPoint2d incoming_pose = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a876cee27af19b1f215ffd4a2190be371">ecef_to_map_point</a>(ecef_loc);</div>
<div class="line"><span class="lineno">  997</span>            <span class="keywordtype">double</span> frontVehicleDtd = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae65a18d1f14ecdfae3409e47e59a1031">wm_</a>-&gt;routeTrackPos(incoming_pose).downtrack;</div>
<div class="line"><span class="lineno">  998</span> </div>
<div class="line"><span class="lineno">  999</span>            <span class="comment">// use ecef_loc to calculate front Ctd in m.</span></div>
<div class="line"><span class="lineno"> 1000</span>            <span class="keywordtype">double</span> frontVehicleCtd = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae65a18d1f14ecdfae3409e47e59a1031">wm_</a>-&gt;routeTrackPos(incoming_pose).crosstrack;</div>
<div class="line"><span class="lineno"> 1001</span>            <span class="comment">// downtrack and crosstrack of the platoon leader --&gt; used for frontal join</span></div>
<div class="line"><span class="lineno"> 1002</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Neighbor platoon frontVehicleDtd from ecef: &quot;</span> &lt;&lt; frontVehicleDtd &lt;&lt; <span class="stringliteral">&quot;, frontVehicleCtd from ecef: &quot;</span> &lt;&lt; frontVehicleCtd);</div>
<div class="line"><span class="lineno"> 1003</span> </div>
<div class="line"><span class="lineno"> 1004</span>            <span class="comment">// use INFO param to find platoon rear vehicle DTD and CTD.</span></div>
<div class="line"><span class="lineno"> 1005</span>            <span class="keywordtype">double</span> platoon_length = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a41bb6d04569023ef9480fa263a804a8c">mob_op_find_platoon_length_from_INFO_params</a>(strategyParams); <span class="comment">// length of the entire platoon in meters.</span></div>
<div class="line"><span class="lineno"> 1016</span><span class="comment"></span>            <span class="keywordtype">double</span> rearVehicleDtd = frontVehicleDtd - platoon_length; </div>
<div class="line"><span class="lineno"> 1017</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;rear veh dtd from platoon length: &quot;</span> &lt;&lt; rearVehicleDtd);</div>
<div class="line"><span class="lineno"> 1018</span>            <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a5810c2ddb1b317d7cd7a038615844185">neighbor_platoon_</a>.empty())</div>
<div class="line"><span class="lineno"> 1019</span>            {</div>
<div class="line"><span class="lineno"> 1020</span>                rearVehicleDtd = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a5810c2ddb1b317d7cd7a038615844185">neighbor_platoon_</a>.back().vehiclePosition;</div>
<div class="line"><span class="lineno"> 1021</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;rear veh dtd from neighbor platoon: &quot;</span> &lt;&lt; rearVehicleDtd);</div>
<div class="line"><span class="lineno"> 1022</span>            }</div>
<div class="line"><span class="lineno"> 1023</span>            </div>
<div class="line"><span class="lineno"> 1024</span>            <span class="comment">// Note: For one platoon, we assume all members are in the same lane.</span></div>
<div class="line"><span class="lineno"> 1025</span>            <span class="keywordtype">double</span> rearVehicleCtd = frontVehicleCtd;</div>
<div class="line"><span class="lineno"> 1026</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Neighbor platoon rearVehicleDtd: &quot;</span> &lt;&lt; rearVehicleDtd &lt;&lt; <span class="stringliteral">&quot;, rearVehicleCtd: &quot;</span> &lt;&lt; rearVehicleCtd);</div>
<div class="line"><span class="lineno"> 1027</span> </div>
<div class="line"><span class="lineno"> 1028</span>            <span class="comment">// Parse the strategy params</span></div>
<div class="line"><span class="lineno"> 1029</span>            std::vector&lt;std::string&gt; inputsParams;</div>
<div class="line"><span class="lineno"> 1030</span>            <a class="code hl_variable" href="namespaceprocess__traj__logs.html#a3682477a3431f2a4aa182fb9a6439125">boost::algorithm::split</a>(inputsParams, strategyParams, boost::is_any_of(<span class="stringliteral">&quot;,&quot;</span>));</div>
<div class="line"><span class="lineno"> 1031</span> </div>
<div class="line"><span class="lineno"> 1032</span>            <span class="comment">// Get the target platoon&#39;s size (number of members) from strategy params</span></div>
<div class="line"><span class="lineno"> 1033</span>            std::vector&lt;std::string&gt; targetPlatoonSize_parsed;</div>
<div class="line"><span class="lineno"> 1034</span>            <a class="code hl_variable" href="namespaceprocess__traj__logs.html#a3682477a3431f2a4aa182fb9a6439125">boost::algorithm::split</a>(targetPlatoonSize_parsed, inputsParams[2], boost::is_any_of(<span class="stringliteral">&quot;:&quot;</span>));</div>
<div class="line"><span class="lineno"> 1035</span>            <span class="keywordtype">int</span> targetPlatoonSize = std::stoi(targetPlatoonSize_parsed[1]);</div>
<div class="line"><span class="lineno"> 1036</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;target Platoon Size: &quot;</span> &lt;&lt; targetPlatoonSize);</div>
<div class="line"><span class="lineno"> 1037</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Found a vehicle/platoon with id = &quot;</span> &lt;&lt; platoonId &lt;&lt; <span class="stringliteral">&quot; within range.&quot;</span>);</div>
<div class="line"><span class="lineno"> 1038</span> </div>
<div class="line"><span class="lineno"> 1039</span>            <span class="comment">//TODO future: add logic here to assess closeness of the neighbor platoon, as well as its speed, destination</span></div>
<div class="line"><span class="lineno"> 1040</span>            <span class="comment">//             &amp; other attributes to decide if we want to join before assembling a join request</span></div>
<div class="line"><span class="lineno"> 1041</span> </div>
<div class="line"><span class="lineno"> 1042</span>            <span class="comment">// step 2. Generate default info for join request</span></div>
<div class="line"><span class="lineno"> 1043</span>            carma_v2x_msgs::msg::MobilityRequest request;</div>
<div class="line"><span class="lineno"> 1044</span>            request.m_header.plan_id = boost::uuids::to_string(boost::uuids::random_generator()());</div>
<div class="line"><span class="lineno"> 1045</span>            request.m_header.recipient_id = senderId;</div>
<div class="line"><span class="lineno"> 1046</span>            request.m_header.sender_id = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a473bcce97d7c50beaab678372a354c0d">vehicleID</a>;</div>
<div class="line"><span class="lineno"> 1047</span>            request.m_header.timestamp = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a283186f2bbb98f5f85b5486e365bb4b8">timer_factory_</a>-&gt;now().nanoseconds()/1000000;</div>
<div class="line"><span class="lineno"> 1048</span>            request.location = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a11ffedaaa90fe358ecfdccab7c5a428c">pose_to_ecef</a>(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa67d1b97f198e2f088fb24ffb8e0c690">pose_msg_</a>);</div>
<div class="line"><span class="lineno"> 1049</span>            request.strategy = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3be0b52376b568130c1c6a5ec5adeb13">PLATOONING_STRATEGY</a>;</div>
<div class="line"><span class="lineno"> 1050</span>            request.urgency = 50;</div>
<div class="line"><span class="lineno"> 1051</span> </div>
<div class="line"><span class="lineno"> 1052</span>            <span class="keywordtype">int</span> platoon_size = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a3ef30eeb7a7cf0caccb948e6a41f92">getHostPlatoonSize</a>();</div>
<div class="line"><span class="lineno"> 1053</span>            </div>
<div class="line"><span class="lineno"> 1054</span>            <span class="comment">// step 3. Request Rear Join </span></div>
<div class="line"><span class="lineno"> 1055</span>            <span class="keywordflow">if</span>(<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a1f96a7552ba7778a703930c546a9816b">isVehicleRightInFront</a>(rearVehicleDtd, rearVehicleCtd)  &amp;&amp;  !<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#ab266d02c1852c6a1a2bff65a5e0d78b0">test_front_join</a>)</div>
<div class="line"><span class="lineno"> 1056</span>            {   </div>
<div class="line"><span class="lineno"> 1060</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Neighbor platoon is right in front of us&quot;</span>);</div>
<div class="line"><span class="lineno"> 1061</span> </div>
<div class="line"><span class="lineno"> 1062</span>                request.plan_type.type = carma_v2x_msgs::msg::PlanType::JOIN_PLATOON_AT_REAR;</div>
<div class="line"><span class="lineno"> 1063</span> </div>
<div class="line"><span class="lineno"> 1064</span>                <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 1065</span><span class="comment">                 * JOIN_PARAMS format: </span></div>
<div class="line"><span class="lineno"> 1066</span><span class="comment">                 *        JOIN_PARAMS| --&gt; &quot;SIZE:%1%,SPEED:%2%,ECEFX:%3%,ECEFY:%4%,ECEFZ:%5%,JOINIDX:%6%&quot;</span></div>
<div class="line"><span class="lineno"> 1067</span><span class="comment">                 *                   |-------0------ --1---------2---------3---------4----------5-------|  </span></div>
<div class="line"><span class="lineno"> 1068</span><span class="comment">                 */</span></div>
<div class="line"><span class="lineno"> 1069</span> </div>
<div class="line"><span class="lineno"> 1070</span>                boost::format fmter(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aca973fa2125f768cffaf33812403f45c">JOIN_PARAMS</a>);</div>
<div class="line"><span class="lineno"> 1071</span>                <span class="keywordtype">int</span> dummy_join_index = -2; <span class="comment">//not used for this message, but message spec requires it</span></div>
<div class="line"><span class="lineno"> 1072</span>                fmter %platoon_size;                <span class="comment">//  index = 0</span></div>
<div class="line"><span class="lineno"> 1073</span>                fmter %<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3e827c7f2e764c6e7de83f0a81a9593f">current_speed_</a>;              <span class="comment">//  index = 1, in m/s</span></div>
<div class="line"><span class="lineno"> 1074</span>                fmter %<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ad10e1df213ec7524892b247d28ec9172">pose_ecef_point_</a>.ecef_x;     <span class="comment">//  index = 2, in cm.</span></div>
<div class="line"><span class="lineno"> 1075</span>                fmter %<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ad10e1df213ec7524892b247d28ec9172">pose_ecef_point_</a>.ecef_y;     <span class="comment">//  index = 3, in cm.</span></div>
<div class="line"><span class="lineno"> 1076</span>                fmter %<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ad10e1df213ec7524892b247d28ec9172">pose_ecef_point_</a>.ecef_z;     <span class="comment">//  index = 4, in cm.</span></div>
<div class="line"><span class="lineno"> 1077</span>                fmter %dummy_join_index;            <span class="comment">//  index = 5</span></div>
<div class="line"><span class="lineno"> 1078</span>                request.strategy_params = fmter.str();</div>
<div class="line"><span class="lineno"> 1079</span>                <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae4e916260ddb6f7eb25da13ef9cb158e">mobility_request_publisher_</a>(request);</div>
<div class="line"><span class="lineno"> 1080</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Publishing request to leader &quot;</span> &lt;&lt; senderId &lt;&lt; <span class="stringliteral">&quot; with params &quot;</span> &lt;&lt; request.strategy_params &lt;&lt; <span class="stringliteral">&quot; and plan id = &quot;</span> &lt;&lt; request.m_header.plan_id);</div>
<div class="line"><span class="lineno"> 1081</span> </div>
<div class="line"><span class="lineno"> 1082</span>                <span class="comment">// Create a new join plan</span></div>
<div class="line"><span class="lineno"> 1083</span>                <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a> = ActionPlan(<span class="keyword">true</span>, request.m_header.timestamp, request.m_header.plan_id, senderId);</div>
<div class="line"><span class="lineno"> 1084</span> </div>
<div class="line"><span class="lineno"> 1085</span>                <span class="comment">// If we are asking to join an actual platoon (not a solo vehicle), then save its ID for later use</span></div>
<div class="line"><span class="lineno"> 1086</span>                <span class="keywordflow">if</span> (platoonId.compare(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ae067830e0351c8ba271b00cb4a6f15c1">dummyID</a>) != 0)</div>
<div class="line"><span class="lineno"> 1087</span>                {</div>
<div class="line"><span class="lineno"> 1088</span>                    <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#abc319b76af0eecaba8e0fe0718457618">targetPlatoonID</a> = platoonId;</div>
<div class="line"><span class="lineno"> 1089</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Detected neighbor as a real platoon &amp; storing its ID: &quot;</span> &lt;&lt; platoonId);</div>
<div class="line"><span class="lineno"> 1090</span>                }</div>
<div class="line"><span class="lineno"> 1091</span>            }</div>
<div class="line"><span class="lineno"> 1092</span> </div>
<div class="line"><span class="lineno"> 1093</span>            <span class="comment">// step 4. Request frontal join, if the neighbor is a real platoon</span></div>
<div class="line"><span class="lineno"> 1094</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((targetPlatoonSize &gt; 1  ||  <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#ab266d02c1852c6a1a2bff65a5e0d78b0">test_front_join</a>)  &amp;&amp;  <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#af86af042a60d31a38a0be515bd4e5f9b">isVehicleRightBehind</a>(frontVehicleDtd, frontVehicleCtd))</div>
<div class="line"><span class="lineno"> 1095</span>            {   </div>
<div class="line"><span class="lineno"> 1099</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Neighbor platoon leader is right behind us&quot;</span>);</div>
<div class="line"><span class="lineno"> 1100</span>                </div>
<div class="line"><span class="lineno"> 1101</span>                <span class="comment">// UCLA: assign a new plan type</span></div>
<div class="line"><span class="lineno"> 1102</span>                request.plan_type.type = carma_v2x_msgs::msg::PlanType::JOIN_PLATOON_FROM_FRONT;</div>
<div class="line"><span class="lineno"> 1103</span> </div>
<div class="line"><span class="lineno"> 1109</span>                boost::format fmter(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aca973fa2125f768cffaf33812403f45c">JOIN_PARAMS</a>); <span class="comment">// Note: Front and rear join uses same params, hence merge to one param for both condition.</span></div>
<div class="line"><span class="lineno"> 1110</span>                <span class="keywordtype">int</span> dummy_join_index = -2; <span class="comment">//not used for this message, but message spec requires it</span></div>
<div class="line"><span class="lineno"> 1111</span>                fmter %platoon_size;                <span class="comment">//  index = 0</span></div>
<div class="line"><span class="lineno"> 1112</span>                fmter %<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3e827c7f2e764c6e7de83f0a81a9593f">current_speed_</a>;              <span class="comment">//  index = 1, in m/s</span></div>
<div class="line"><span class="lineno"> 1113</span>                fmter %<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ad10e1df213ec7524892b247d28ec9172">pose_ecef_point_</a>.ecef_x;     <span class="comment">//  index = 2, in cm.</span></div>
<div class="line"><span class="lineno"> 1114</span>                fmter %<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ad10e1df213ec7524892b247d28ec9172">pose_ecef_point_</a>.ecef_y;     <span class="comment">//  index = 3, in cm.</span></div>
<div class="line"><span class="lineno"> 1115</span>                fmter %<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ad10e1df213ec7524892b247d28ec9172">pose_ecef_point_</a>.ecef_z;     <span class="comment">//  index = 4, in cm.</span></div>
<div class="line"><span class="lineno"> 1116</span>                fmter %dummy_join_index;            <span class="comment">//  index = 5</span></div>
<div class="line"><span class="lineno"> 1117</span>                request.strategy_params = fmter.str();</div>
<div class="line"><span class="lineno"> 1118</span>                <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae4e916260ddb6f7eb25da13ef9cb158e">mobility_request_publisher_</a>(request);</div>
<div class="line"><span class="lineno"> 1119</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Publishing front join request to the leader &quot;</span> &lt;&lt; senderId &lt;&lt; <span class="stringliteral">&quot; with params &quot;</span> &lt;&lt; request.strategy_params &lt;&lt; <span class="stringliteral">&quot; and plan id = &quot;</span> &lt;&lt; request.m_header.plan_id);</div>
<div class="line"><span class="lineno"> 1120</span> </div>
<div class="line"><span class="lineno"> 1121</span>                <span class="comment">// Create a new join plan</span></div>
<div class="line"><span class="lineno"> 1122</span>                <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a> = ActionPlan(<span class="keyword">true</span>, request.m_header.timestamp, request.m_header.plan_id, senderId);</div>
<div class="line"><span class="lineno"> 1123</span> </div>
<div class="line"><span class="lineno"> 1124</span>                <span class="comment">// If testing with a solo vehicle to represent the target platoon, then use the current join plan ID for that platoon;</span></div>
<div class="line"><span class="lineno"> 1125</span>                <span class="comment">// otherwise, it will already have and ID so store it for future use</span></div>
<div class="line"><span class="lineno"> 1126</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#ab266d02c1852c6a1a2bff65a5e0d78b0">test_front_join</a>)</div>
<div class="line"><span class="lineno"> 1127</span>                {</div>
<div class="line"><span class="lineno"> 1128</span>                    <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#abc319b76af0eecaba8e0fe0718457618">targetPlatoonID</a> = request.m_header.plan_id;</div>
<div class="line"><span class="lineno"> 1129</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Since neighbor is a fake platoon, storing &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#abc319b76af0eecaba8e0fe0718457618">targetPlatoonID</a> &lt;&lt; <span class="stringliteral">&quot; as its platoon ID&quot;</span>);</div>
<div class="line"><span class="lineno"> 1130</span>                }</div>
<div class="line"><span class="lineno"> 1131</span>                <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1132</span>                {</div>
<div class="line"><span class="lineno"> 1133</span>                    <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#abc319b76af0eecaba8e0fe0718457618">targetPlatoonID</a> = platoonId;</div>
<div class="line"><span class="lineno"> 1134</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Storing real neighbor platoon&#39;s ID as target: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#abc319b76af0eecaba8e0fe0718457618">targetPlatoonID</a>);</div>
<div class="line"><span class="lineno"> 1135</span>                }</div>
<div class="line"><span class="lineno"> 1136</span>            }</div>
<div class="line"><span class="lineno"> 1137</span> </div>
<div class="line"><span class="lineno"> 1138</span>            <span class="comment">// step 5. Request cut-in join (front, middle or rear, from adjacent lane)</span></div>
<div class="line"><span class="lineno"> 1139</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((targetPlatoonSize &gt; 1  ||  <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a0d4c58751beb06ca6bcdd80c3532be18">test_cutin_join</a>)  &amp;&amp;  !<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#ab266d02c1852c6a1a2bff65a5e0d78b0">test_front_join</a>  </div>
<div class="line"><span class="lineno"> 1140</span>                        &amp;&amp;  <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa76f916a1f30e25204262dcd17fcf4ac">isVehicleNearTargetPlatoon</a>(rearVehicleDtd, frontVehicleDtd, frontVehicleCtd))</div>
<div class="line"><span class="lineno"> 1141</span>            {</div>
<div class="line"><span class="lineno"> 1142</span> </div>
<div class="line"><span class="lineno"> 1143</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;starting cut-in join process&quot;</span>);</div>
<div class="line"><span class="lineno"> 1144</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;rearVehicleDtd &quot;</span> &lt;&lt; rearVehicleDtd);</div>
<div class="line"><span class="lineno"> 1145</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;rearVehicleCtd &quot;</span> &lt;&lt; rearVehicleCtd);</div>
<div class="line"><span class="lineno"> 1146</span> </div>
<div class="line"><span class="lineno"> 1147</span>                <span class="comment">// If we are asking to join an actual platoon (not a solo vehicle), then save its ID for later use</span></div>
<div class="line"><span class="lineno"> 1148</span>                <span class="keywordflow">if</span> (platoonId.compare(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ae067830e0351c8ba271b00cb4a6f15c1">dummyID</a>) != 0)</div>
<div class="line"><span class="lineno"> 1149</span>                {</div>
<div class="line"><span class="lineno"> 1150</span>                    <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#abc319b76af0eecaba8e0fe0718457618">targetPlatoonID</a> = platoonId;</div>
<div class="line"><span class="lineno"> 1151</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Detected neighbor as a real platoon &amp; storing its ID: &quot;</span> &lt;&lt; platoonId);</div>
<div class="line"><span class="lineno"> 1152</span>                }</div>
<div class="line"><span class="lineno"> 1153</span> </div>
<div class="line"><span class="lineno"> 1154</span>                </div>
<div class="line"><span class="lineno"> 1155</span>                <a class="code hl_class" href="classcarma__wm_1_1TrackPos.html">carma_wm::TrackPos</a> target_trackpose(rearVehicleDtd, rearVehicleCtd);</div>
<div class="line"><span class="lineno"> 1156</span>                <span class="keyword">auto</span> target_rear_pose = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae65a18d1f14ecdfae3409e47e59a1031">wm_</a>-&gt;pointFromRouteTrackPos(target_trackpose);</div>
<div class="line"><span class="lineno"> 1157</span>                <span class="keywordflow">if</span> (target_rear_pose)</div>
<div class="line"><span class="lineno"> 1158</span>                {</div>
<div class="line"><span class="lineno"> 1159</span>                    <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ab2fa1a4b839a90fee186cc921a5360ab">target_cutin_pose_</a> = incoming_pose;</div>
<div class="line"><span class="lineno"> 1160</span> </div>
<div class="line"><span class="lineno"> 1161</span>                    <span class="keyword">auto</span> target_lanelets = lanelet::geometry::findNearest(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae65a18d1f14ecdfae3409e47e59a1031">wm_</a>-&gt;getMap()-&gt;laneletLayer, target_rear_pose.get(), 1);  </div>
<div class="line"><span class="lineno"> 1162</span>                    <span class="keywordflow">if</span> (!target_lanelets.empty())</div>
<div class="line"><span class="lineno"> 1163</span>                    {</div>
<div class="line"><span class="lineno"> 1164</span>                        <span class="keywordtype">long</span> target_rear_pose_lanelet_id = target_lanelets[0].second.id();</div>
<div class="line"><span class="lineno"> 1165</span>                        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;target_rear_pose_lanelet_id: &quot;</span> &lt;&lt; target_rear_pose_lanelet_id);</div>
<div class="line"><span class="lineno"> 1166</span>                    }</div>
<div class="line"><span class="lineno"> 1167</span>                    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1168</span>                    {</div>
<div class="line"><span class="lineno"> 1169</span>                        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;target_rear_pose_lanelet not found!!&quot;</span>);</div>
<div class="line"><span class="lineno"> 1170</span>                    }</div>
<div class="line"><span class="lineno"> 1171</span>                }</div>
<div class="line"><span class="lineno"> 1172</span>                    </div>
<div class="line"><span class="lineno"> 1173</span>                <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1174</span>                {</div>
<div class="line"><span class="lineno"> 1175</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;No target pose is found, so we cannot prodeed with a cutin join request.&quot;</span>);</div>
<div class="line"><span class="lineno"> 1176</span>                    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1177</span>                }</div>
<div class="line"><span class="lineno"> 1178</span> </div>
<div class="line"><span class="lineno"> 1185</span>                <span class="comment">//TODO: verify purpose of this logic then its correctness accordingly:</span></div>
<div class="line"><span class="lineno"> 1186</span>                <span class="comment">//  -is step 5 (this block) really for all 3 types of joining?</span></div>
<div class="line"><span class="lineno"> 1187</span>                <span class="comment">//  -ensure join_index gets an appropriate value for the type of join</span></div>
<div class="line"><span class="lineno"> 1188</span>                <span class="comment">//  -ensure plan type corresponds to join_index</span></div>
<div class="line"><span class="lineno"> 1189</span> </div>
<div class="line"><span class="lineno"> 1190</span>                <span class="comment">// complete the request</span></div>
<div class="line"><span class="lineno"> 1191</span>                <span class="comment">// UCLA: this is a newly added plan type </span></div>
<div class="line"><span class="lineno"> 1192</span>                <span class="comment">// Note: Request conposed outside of if conditions</span></div>
<div class="line"><span class="lineno"> 1193</span>                <span class="comment">// UCLA: Desired joining index for cut-in join, indicate the index of gap-leading vehicle. -1 indicate cut-in from front.</span></div>
<div class="line"><span class="lineno"> 1194</span>                <span class="comment">// Note: remove join_index to info param.</span></div>
<div class="line"><span class="lineno"> 1195</span>                request.plan_type.type = carma_v2x_msgs::msg::PlanType::PLATOON_CUT_IN_JOIN; </div>
<div class="line"><span class="lineno"> 1196</span> </div>
<div class="line"><span class="lineno"> 1197</span>                <span class="comment">// At this step all cut-in types start with this request, so the join_index at this point is set to default, -2.</span></div>
<div class="line"><span class="lineno"> 1198</span>                <span class="keywordtype">int</span> join_index = -2;</div>
<div class="line"><span class="lineno"> 1199</span>                boost::format fmter(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aca973fa2125f768cffaf33812403f45c">JOIN_PARAMS</a>); <span class="comment">// Note: Front and rear join uses same params, hence merge to one param for both condition.</span></div>
<div class="line"><span class="lineno"> 1200</span>                fmter %platoon_size;                <span class="comment">//  index = 0</span></div>
<div class="line"><span class="lineno"> 1201</span>                fmter %<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3e827c7f2e764c6e7de83f0a81a9593f">current_speed_</a>;              <span class="comment">//  index = 1, in m/s</span></div>
<div class="line"><span class="lineno"> 1202</span>                fmter %<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ad10e1df213ec7524892b247d28ec9172">pose_ecef_point_</a>.ecef_x;     <span class="comment">//  index = 2</span></div>
<div class="line"><span class="lineno"> 1203</span>                fmter %<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ad10e1df213ec7524892b247d28ec9172">pose_ecef_point_</a>.ecef_y;     <span class="comment">//  index = 3</span></div>
<div class="line"><span class="lineno"> 1204</span>                fmter %<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ad10e1df213ec7524892b247d28ec9172">pose_ecef_point_</a>.ecef_z;     <span class="comment">//  index = 4</span></div>
<div class="line"><span class="lineno"> 1205</span>                fmter %join_index;                  <span class="comment">//  index = 5</span></div>
<div class="line"><span class="lineno"> 1206</span>                request.strategy_params = fmter.str();</div>
<div class="line"><span class="lineno"> 1207</span>                <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae4e916260ddb6f7eb25da13ef9cb158e">mobility_request_publisher_</a>(request);</div>
<div class="line"><span class="lineno"> 1208</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Publishing request to the leader &quot;</span> &lt;&lt; senderId &lt;&lt; <span class="stringliteral">&quot; with params &quot;</span> &lt;&lt; request.strategy_params &lt;&lt; <span class="stringliteral">&quot; and plan id = &quot;</span> &lt;&lt; request.m_header.plan_id);</div>
<div class="line"><span class="lineno"> 1209</span> </div>
<div class="line"><span class="lineno"> 1210</span>                <span class="comment">// Create a new join plan</span></div>
<div class="line"><span class="lineno"> 1211</span>                <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a> = ActionPlan(<span class="keyword">true</span>, request.m_header.timestamp, request.m_header.plan_id, senderId);</div>
<div class="line"><span class="lineno"> 1212</span>            }</div>
<div class="line"><span class="lineno"> 1213</span> </div>
<div class="line"><span class="lineno"> 1214</span>            <span class="comment">// step 6. Return none if no platoon nearby</span></div>
<div class="line"><span class="lineno"> 1215</span>            <span class="keywordflow">else</span> </div>
<div class="line"><span class="lineno"> 1216</span>            {</div>
<div class="line"><span class="lineno"> 1217</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Ignore platoon with platoon id: &quot;</span> &lt;&lt; platoonId &lt;&lt; <span class="stringliteral">&quot; because it is too far away to join.&quot;</span>);</div>
<div class="line"><span class="lineno"> 1218</span>            }</div>
<div class="line"><span class="lineno"> 1219</span>        }</div>
<div class="line"><span class="lineno"> 1220</span>        </div>
<div class="line"><span class="lineno"> 1221</span>        <span class="comment">// TODO: Place holder for prepare to depart (else if isdepart)</span></div>
<div class="line"><span class="lineno"> 1222</span> </div>
<div class="line"><span class="lineno"> 1223</span>    }</div>
<div class="ttc" id="aclasscarma__wm_1_1TrackPos_html"><div class="ttname"><a href="classcarma__wm_1_1TrackPos.html">carma_wm::TrackPos</a></div><div class="ttdoc">Position in a track based coordinate system where the axis are downtrack and crosstrack....</div><div class="ttdef"><b>Definition:</b> <a href="TrackPos_8hpp_source.html#l00034">TrackPos.hpp:35</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_a0d0a209aaf6bc5c61a30b091a78cb39d"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">platoon_strategic_ihp::PlatoonManager::current_plan</a></div><div class="ttdeci">ActionPlan current_plan</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00376">platoon_manager_ihp.h:376</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_a5810c2ddb1b317d7cd7a038615844185"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a5810c2ddb1b317d7cd7a038615844185">platoon_strategic_ihp::PlatoonManager::neighbor_platoon_</a></div><div class="ttdeci">std::vector&lt; PlatoonMember &gt; neighbor_platoon_</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00384">platoon_manager_ihp.h:384</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_abc319b76af0eecaba8e0fe0718457618"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#abc319b76af0eecaba8e0fe0718457618">platoon_strategic_ihp::PlatoonManager::targetPlatoonID</a></div><div class="ttdeci">std::string targetPlatoonID</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00390">platoon_manager_ihp.h:390</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_ae067830e0351c8ba271b00cb4a6f15c1"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ae067830e0351c8ba271b00cb4a6f15c1">platoon_strategic_ihp::PlatoonManager::dummyID</a></div><div class="ttdeci">const std::string dummyID</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00358">platoon_manager_ihp.h:358</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a11ffedaaa90fe358ecfdccab7c5a428c"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a11ffedaaa90fe358ecfdccab7c5a428c">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::pose_to_ecef</a></div><div class="ttdeci">carma_v2x_msgs::msg::LocationECEF pose_to_ecef(geometry_msgs::msg::PoseStamped pose_msg)</div><div class="ttdoc">Function to convert pose from map frame to ecef location.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l00064">platoon_strategic_ihp.cpp:64</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a1f96a7552ba7778a703930c546a9816b"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a1f96a7552ba7778a703930c546a9816b">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::isVehicleRightInFront</a></div><div class="ttdeci">bool isVehicleRightInFront(double downtrack, double crosstrack)</div><div class="ttdoc">Function to determine if a target vehicle is in the front of host vehicle note: This is only applicab...</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l00211">platoon_strategic_ihp.cpp:211</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a41bb6d04569023ef9480fa263a804a8c"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a41bb6d04569023ef9480fa263a804a8c">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_op_find_platoon_length_from_INFO_params</a></div><div class="ttdeci">double mob_op_find_platoon_length_from_INFO_params(std::string strategyParams)</div><div class="ttdoc">Function to process mobility operation INFO params to find platoon length in m.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l00757">platoon_strategic_ihp.cpp:757</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a876cee27af19b1f215ffd4a2190be371"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a876cee27af19b1f215ffd4a2190be371">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::ecef_to_map_point</a></div><div class="ttdeci">lanelet::BasicPoint2d ecef_to_map_point(carma_v2x_msgs::msg::LocationECEF ecef_point)</div><div class="ttdoc">Function to convert ecef location to a 2d point in map frame.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l00252">platoon_strategic_ihp.cpp:252</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_aa76f916a1f30e25204262dcd17fcf4ac"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa76f916a1f30e25204262dcd17fcf4ac">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::isVehicleNearTargetPlatoon</a></div><div class="ttdeci">bool isVehicleNearTargetPlatoon(double rearVehicleDtd, double frontVehicleDtd, double frontVehicleCtd)</div><div class="ttdoc">Function to determine if the host vehicle is close to the target platoon (used for cut-in join scenar...</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l00388">platoon_strategic_ihp.cpp:388</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_ab2fa1a4b839a90fee186cc921a5360ab"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ab2fa1a4b839a90fee186cc921a5360ab">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::target_cutin_pose_</a></div><div class="ttdeci">lanelet::BasicPoint2d target_cutin_pose_</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8h_source.html#l00802">platoon_strategic_ihp.h:802</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_ab475f5a72d52048d8a4a09617634e24f"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ab475f5a72d52048d8a4a09617634e24f">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_op_find_ecef_from_INFO_params</a></div><div class="ttdeci">carma_v2x_msgs::msg::LocationECEF mob_op_find_ecef_from_INFO_params(std::string strategyParams)</div><div class="ttdoc">Function to process mobility operation INFO params to find platoon leader's ecef location.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l00777">platoon_strategic_ihp.cpp:777</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_aca973fa2125f768cffaf33812403f45c"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aca973fa2125f768cffaf33812403f45c">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::JOIN_PARAMS</a></div><div class="ttdeci">const std::string JOIN_PARAMS</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8h_source.html#l00858">platoon_strategic_ihp.h:858</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_af86af042a60d31a38a0be515bd4e5f9b"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#af86af042a60d31a38a0be515bd4e5f9b">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::isVehicleRightBehind</a></div><div class="ttdeci">bool isVehicleRightBehind(double downtrack, double crosstrack)</div><div class="ttdoc">Function to determine if the given downtrack distance (m) is behind the host vehicle.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l00232">platoon_strategic_ihp.cpp:232</a></div></div>
<div class="ttc" id="astructplatoon__strategic__ihp_1_1ActionPlan_html_a9474313cd68557978e8dbd481d0408bc"><div class="ttname"><a href="structplatoon__strategic__ihp_1_1ActionPlan.html#a9474313cd68557978e8dbd481d0408bc">platoon_strategic_ihp::ActionPlan::valid</a></div><div class="ttdeci">bool valid</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00047">platoon_manager_ihp.h:47</a></div></div>
<div class="ttc" id="astructplatoon__strategic__ihp_1_1PlatoonPluginConfig_html_a0d4c58751beb06ca6bcdd80c3532be18"><div class="ttname"><a href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a0d4c58751beb06ca6bcdd80c3532be18">platoon_strategic_ihp::PlatoonPluginConfig::test_cutin_join</a></div><div class="ttdeci">bool test_cutin_join</div><div class="ttdef"><b>Definition:</b> <a href="platoon__config__ihp_8h_source.html#l00086">platoon_config_ihp.h:86</a></div></div>
<div class="ttc" id="astructplatoon__strategic__ihp_1_1PlatoonPluginConfig_html_ab266d02c1852c6a1a2bff65a5e0d78b0"><div class="ttname"><a href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#ab266d02c1852c6a1a2bff65a5e0d78b0">platoon_strategic_ihp::PlatoonPluginConfig::test_front_join</a></div><div class="ttdeci">bool test_front_join</div><div class="ttdef"><b>Definition:</b> <a href="platoon__config__ihp_8h_source.html#l00083">platoon_config_ihp.h:83</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__strategic__ihp_8h_source.html#l00318">config_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00376">platoon_strategic_ihp::PlatoonManager::current_plan</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00328">current_speed_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00364">platoon_strategic_ihp::PlatoonManager::currentPlatoonID</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00358">platoon_strategic_ihp::PlatoonManager::dummyID</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00252">ecef_to_map_point()</a>, <a class="el" href="platoon__manager__ihp_8cpp_source.html#l00279">platoon_strategic_ihp::PlatoonManager::getHostPlatoonSize()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00388">isVehicleNearTargetPlatoon()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00232">isVehicleRightBehind()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00211">isVehicleRightInFront()</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00858">JOIN_PARAMS</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00777">mob_op_find_ecef_from_INFO_params()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00757">mob_op_find_platoon_length_from_INFO_params()</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00308">mobility_request_publisher_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00384">platoon_strategic_ihp::PlatoonManager::neighbor_platoon_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00821">OPERATION_INFO_TYPE</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00820">PLATOONING_STRATEGY</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00817">pm_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00257">pose_ecef_point_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00322">pose_msg_</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00064">pose_to_ecef()</a>, <a class="el" href="process__traj__logs_8py_source.html#l00165">process_traj_logs::split</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00802">target_cutin_pose_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00390">platoon_strategic_ihp::PlatoonManager::targetPlatoonID</a>, <a class="el" href="platoon__config__ihp_8h_source.html#l00086">platoon_strategic_ihp::PlatoonPluginConfig::test_cutin_join</a>, <a class="el" href="platoon__config__ihp_8h_source.html#l00083">platoon_strategic_ihp::PlatoonPluginConfig::test_front_join</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00814">timer_factory_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00047">platoon_strategic_ihp::ActionPlan::valid</a>, <a class="el" href="platoon__config__ihp_8h_source.html#l00068">platoon_strategic_ihp::PlatoonPluginConfig::vehicleID</a>, and <a class="el" href="platoon__strategic__ihp_8h_source.html#l00315">wm_</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00809">mob_op_cb()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_afd00a90158f773100543b3f56f964d74_cgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_afd00a90158f773100543b3f56f964d74_cgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_afd00a90158f773100543b3f56f964d74_cgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_afd00a90158f773100543b3f56f964d74_cgraph">
<area shape="rect" title="Function to process mobility operation in leader state." alt="" coords="5,269,188,325"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a876cee27af19b1f215ffd4a2190be371" title="Function to convert ecef location to a 2d point in map frame." alt="" coords="272,5,455,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a3ef30eeb7a7cf0caccb948e6a41f92" title="Returns total size of the platoon , in number of vehicles." alt="" coords="242,85,485,126"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa76f916a1f30e25204262dcd17fcf4ac" title="Function to determine if the host vehicle is close to the target platoon (used for cut&#45;in join scenar..." alt="" coords="268,149,459,205"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#af86af042a60d31a38a0be515bd4e5f9b" title="Function to determine if the given downtrack distance (m) is behind the host vehicle." alt="" coords="272,229,455,285"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a1f96a7552ba7778a703930c546a9816b" title="Function to determine if a target vehicle is in the front of host vehicle note: This is only applicab..." alt="" coords="272,309,455,365"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ab475f5a72d52048d8a4a09617634e24f" title="Function to process mobility operation INFO params to find platoon leader&#39;s ecef location." alt="" coords="236,389,491,445"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a41bb6d04569023ef9480fa263a804a8c" title="Function to process mobility operation INFO params to find platoon length in m." alt="" coords="267,470,459,541"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a11ffedaaa90fe358ecfdccab7c5a428c" title="Function to convert pose from map frame to ecef location." alt="" coords="272,565,455,621"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ad3cd4b02451fd0b0a25ed712e3331c36" title="Find lanelet width from local position." alt="" coords="539,149,721,205"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_afd00a90158f773100543b3f56f964d74_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_afd00a90158f773100543b3f56f964d74_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_afd00a90158f773100543b3f56f964d74_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_afd00a90158f773100543b3f56f964d74_icgraph">
<area shape="rect" title="Function to process mobility operation in leader state." alt="" coords="429,5,612,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a9f77f3abf67b6006fd6c9b965cbb1c10" title="Callback function for Mobility Operation Message." alt="" coords="199,5,381,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,5,151,61"/>
</map>
</div>

</div>
</div>
<a id="a0c9c86742dd6bd516c176bd9a3e72093" name="a0c9c86742dd6bd516c176bd9a3e72093"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c9c86742dd6bd516c176bd9a3e72093">&#9670;&nbsp;</a></span>mob_op_cb_leaderaborting()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_op_cb_leaderaborting </td>
          <td>(</td>
          <td class="paramtype">const carma_v2x_msgs::msg::MobilityOperation &amp;&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to process mobility operation in leaderaborting state. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>incoming mobility operation message. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01226">1226</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1227</span>    {   </div>
<div class="line"><span class="lineno"> 1228</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;LEADERABORTING state no further action on message from &quot;</span> &lt;&lt; msg.m_header.sender_id);</div>
<div class="line"><span class="lineno"> 1229</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00809">mob_op_cb()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a0c9c86742dd6bd516c176bd9a3e72093_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a0c9c86742dd6bd516c176bd9a3e72093_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a0c9c86742dd6bd516c176bd9a3e72093_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a0c9c86742dd6bd516c176bd9a3e72093_icgraph">
<area shape="rect" title="Function to process mobility operation in leaderaborting state." alt="" coords="429,5,612,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a9f77f3abf67b6006fd6c9b965cbb1c10" title="Callback function for Mobility Operation Message." alt="" coords="199,5,381,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,5,151,61"/>
</map>
</div>

</div>
</div>
<a id="a5c2e50853fa2e7e7c855271bc669e5dd" name="a5c2e50853fa2e7e7c855271bc669e5dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c2e50853fa2e7e7c855271bc669e5dd">&#9670;&nbsp;</a></span>mob_op_cb_leaderwaiting()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_op_cb_leaderwaiting </td>
          <td>(</td>
          <td class="paramtype">const carma_v2x_msgs::msg::MobilityOperation &amp;&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to process mobility operation in leader waiting state. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>incoming mobility operation </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00948">948</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  949</span>    {</div>
<div class="line"><span class="lineno">  950</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;LEADERWAITING state no further action on message from &quot;</span> &lt;&lt; msg.m_header.sender_id);</div>
<div class="line"><span class="lineno">  951</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00809">mob_op_cb()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a5c2e50853fa2e7e7c855271bc669e5dd_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a5c2e50853fa2e7e7c855271bc669e5dd_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a5c2e50853fa2e7e7c855271bc669e5dd_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a5c2e50853fa2e7e7c855271bc669e5dd_icgraph">
<area shape="rect" title="Function to process mobility operation in leader waiting state." alt="" coords="429,5,612,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a9f77f3abf67b6006fd6c9b965cbb1c10" title="Callback function for Mobility Operation Message." alt="" coords="199,5,381,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,5,151,61"/>
</map>
</div>

</div>
</div>
<a id="a684d176f0a01b8cdbb8bff7e686367ed" name="a684d176f0a01b8cdbb8bff7e686367ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a684d176f0a01b8cdbb8bff7e686367ed">&#9670;&nbsp;</a></span>mob_op_cb_leadwithoperation()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_op_cb_leadwithoperation </td>
          <td>(</td>
          <td class="paramtype">const carma_v2x_msgs::msg::MobilityOperation &amp;&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to process mobility operation in LeadWithOperation state (cut-in join) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>incoming mobility operation </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01238">1238</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1239</span>    {</div>
<div class="line"><span class="lineno"> 1240</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;LEADWITHOPERATION state no further action on message from &quot;</span> &lt;&lt; msg.m_header.sender_id);</div>
<div class="line"><span class="lineno"> 1241</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00809">mob_op_cb()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a684d176f0a01b8cdbb8bff7e686367ed_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a684d176f0a01b8cdbb8bff7e686367ed_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a684d176f0a01b8cdbb8bff7e686367ed_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a684d176f0a01b8cdbb8bff7e686367ed_icgraph">
<area shape="rect" title="Function to process mobility operation in LeadWithOperation state (cut&#45;in join)" alt="" coords="429,5,632,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a9f77f3abf67b6006fd6c9b965cbb1c10" title="Callback function for Mobility Operation Message." alt="" coords="199,5,381,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,5,151,61"/>
</map>
</div>

</div>
</div>
<a id="afe00eb7730952e85faccf8032637983f" name="afe00eb7730952e85faccf8032637983f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe00eb7730952e85faccf8032637983f">&#9670;&nbsp;</a></span>mob_op_cb_preparetojoin()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_op_cb_preparetojoin </td>
          <td>(</td>
          <td class="paramtype">const carma_v2x_msgs::msg::MobilityOperation &amp;&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to process mobility operation in PrepareToJoin state (cut-in join) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>incoming mobility operation </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01244">1244</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1245</span>    {</div>
<div class="line"><span class="lineno"> 1246</span>        <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 1247</span><span class="comment">         * If same lane with leader, then send request to do same lane join. </span></div>
<div class="line"><span class="lineno"> 1248</span><span class="comment">         * Otherwise, just send status params.</span></div>
<div class="line"><span class="lineno"> 1249</span><span class="comment">         * Note: leader in state &#39;leading with operation&#39; also send out INFO msg</span></div>
<div class="line"><span class="lineno"> 1250</span><span class="comment">         */</span></div>
<div class="line"><span class="lineno"> 1251</span> </div>
<div class="line"><span class="lineno"> 1252</span>        <span class="comment">// read parameters</span></div>
<div class="line"><span class="lineno"> 1253</span>        std::string strategyParams = msg.strategy_params;</div>
<div class="line"><span class="lineno"> 1254</span>        std::string senderId = msg.m_header.sender_id; </div>
<div class="line"><span class="lineno"> 1255</span>        </div>
<div class="line"><span class="lineno"> 1256</span>        <span class="comment">// locate INFO type</span></div>
<div class="line"><span class="lineno"> 1257</span>        <span class="keywordtype">bool</span> isPlatoonInfoMsg = strategyParams.rfind(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a56907ad89ed257fc81cbb7faf4221005">OPERATION_INFO_TYPE</a>, 0) == 0;</div>
<div class="line"><span class="lineno"> 1258</span> </div>
<div class="line"><span class="lineno"> 1259</span>        <span class="comment">// If this is an INFO message and our record of the neighbor platoon is complete then</span></div>
<div class="line"><span class="lineno"> 1260</span>        <span class="comment">// pm_.is_neighbor_record_complete_ = true; //TODO temporary</span></div>
<div class="line"><span class="lineno"> 1261</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;pm_.is_neighbor_record_complete_&quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a8f2badbbe25d2b4d26e1556fa0aa63">is_neighbor_record_complete_</a>);</div>
<div class="line"><span class="lineno"> 1262</span> </div>
<div class="line"><span class="lineno"> 1263</span>        <span class="keywordflow">if</span> (isPlatoonInfoMsg  &amp;&amp;  <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a8f2badbbe25d2b4d26e1556fa0aa63">is_neighbor_record_complete_</a>)</div>
<div class="line"><span class="lineno"> 1264</span>        {</div>
<div class="line"><span class="lineno"> 1265</span> </div>
<div class="line"><span class="lineno"> 1266</span>            <span class="comment">//TODO: would be good to have a timeout here; if a neighbor platoon has been identified, and no INFO messages</span></div>
<div class="line"><span class="lineno"> 1267</span>            <span class="comment">//      from it are received in a while, then its record should be erased, and any in-work joining should be</span></div>
<div class="line"><span class="lineno"> 1268</span>            <span class="comment">//      aborted.</span></div>
<div class="line"><span class="lineno"> 1269</span> </div>
<div class="line"><span class="lineno"> 1270</span>            <span class="comment">// read ecef location from strategy params.</span></div>
<div class="line"><span class="lineno"> 1271</span>            carma_v2x_msgs::msg::LocationECEF ecef_loc;</div>
<div class="line"><span class="lineno"> 1272</span>            ecef_loc = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ab475f5a72d52048d8a4a09617634e24f">mob_op_find_ecef_from_INFO_params</a>(strategyParams);</div>
<div class="line"><span class="lineno"> 1273</span>            <span class="comment">// use ecef_loc to calculate front Dtd in m.</span></div>
<div class="line"><span class="lineno"> 1274</span>            lanelet::BasicPoint2d incoming_pose = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a876cee27af19b1f215ffd4a2190be371">ecef_to_map_point</a>(ecef_loc);</div>
<div class="line"><span class="lineno"> 1275</span> </div>
<div class="line"><span class="lineno"> 1276</span>            <span class="keywordtype">double</span> frontVehicleDtd = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae65a18d1f14ecdfae3409e47e59a1031">wm_</a>-&gt;routeTrackPos(incoming_pose).downtrack;</div>
<div class="line"><span class="lineno"> 1277</span> </div>
<div class="line"><span class="lineno"> 1278</span>            <span class="comment">// use ecef_loc to calculate front Ctd in m.</span></div>
<div class="line"><span class="lineno"> 1279</span>            <span class="keywordtype">double</span> frontVehicleCtd = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae65a18d1f14ecdfae3409e47e59a1031">wm_</a>-&gt;routeTrackPos(incoming_pose).crosstrack;</div>
<div class="line"><span class="lineno"> 1280</span> </div>
<div class="line"><span class="lineno"> 1281</span>            <span class="comment">// // Find neighbor platoon end vehicle and its downtrack in m</span></div>
<div class="line"><span class="lineno"> 1282</span>            <span class="keywordtype">int</span> rearVehicleIndex = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a5810c2ddb1b317d7cd7a038615844185">neighbor_platoon_</a>.size() - 1;</div>
<div class="line"><span class="lineno"> 1283</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;rearVehicleIndex: &quot;</span> &lt;&lt; rearVehicleIndex);</div>
<div class="line"><span class="lineno"> 1284</span>            <span class="keywordtype">double</span> rearVehicleDtd = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a5810c2ddb1b317d7cd7a038615844185">neighbor_platoon_</a>[rearVehicleIndex].vehiclePosition; </div>
<div class="line"><span class="lineno"> 1285</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Neighbor rearVehicleDtd from ecef: &quot;</span> &lt;&lt; rearVehicleDtd);</div>
<div class="line"><span class="lineno"> 1286</span> </div>
<div class="line"><span class="lineno"> 1287</span>            <span class="comment">// If lane change has not yet been authorized, stop here (this method will be running before the negotiations</span></div>
<div class="line"><span class="lineno"> 1288</span>            <span class="comment">// with the platoon leader are complete)</span></div>
<div class="line"><span class="lineno"> 1289</span>            <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2bc77445cdb4c025344024395fa94607">safeToLaneChange_</a>)</div>
<div class="line"><span class="lineno"> 1290</span>            {</div>
<div class="line"><span class="lineno"> 1291</span>                <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1292</span>            }</div>
<div class="line"><span class="lineno"> 1293</span> </div>
<div class="line"><span class="lineno"> 1294</span>            <span class="comment">// determine if the lane change is finished</span></div>
<div class="line"><span class="lineno"> 1295</span>            <span class="keywordtype">bool</span> isSameLaneWithPlatoon = abs(frontVehicleCtd - <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a79aaef859aaa4b64f6cf79c50c596bc3">current_crosstrack_</a>) &lt;= <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a3c2aa8b4742ba50d80bc9c23ed183ebf">maxCrosstrackError</a>;</div>
<div class="line"><span class="lineno"> 1296</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Lane change has been authorized. isSameLaneWithPlatoon = &quot;</span> &lt;&lt; isSameLaneWithPlatoon);</div>
<div class="line"><span class="lineno"> 1297</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;crosstrack diff&quot;</span> &lt;&lt; abs(frontVehicleCtd - <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a79aaef859aaa4b64f6cf79c50c596bc3">current_crosstrack_</a>));</div>
<div class="line"><span class="lineno"> 1298</span>            <span class="keywordflow">if</span> (isSameLaneWithPlatoon)</div>
<div class="line"><span class="lineno"> 1299</span>            {</div>
<div class="line"><span class="lineno"> 1300</span>                <span class="comment">// request 1. reset the safeToChangLane indicators if lane change is finished</span></div>
<div class="line"><span class="lineno"> 1301</span>                <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2bc77445cdb4c025344024395fa94607">safeToLaneChange_</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1302</span>                </div>
<div class="line"><span class="lineno"> 1303</span>                <span class="comment">// request 2. change to same lane operation states (determine based on DTD differences)</span></div>
<div class="line"><span class="lineno"> 1304</span>                carma_v2x_msgs::msg::MobilityRequest request;</div>
<div class="line"><span class="lineno"> 1305</span>                request.m_header.plan_id = boost::uuids::to_string(boost::uuids::random_generator()());</div>
<div class="line"><span class="lineno"> 1306</span>                request.m_header.recipient_id = senderId;</div>
<div class="line"><span class="lineno"> 1307</span>                request.m_header.sender_id = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a473bcce97d7c50beaab678372a354c0d">vehicleID</a>;</div>
<div class="line"><span class="lineno"> 1308</span>                request.m_header.timestamp = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a283186f2bbb98f5f85b5486e365bb4b8">timer_factory_</a>-&gt;now().nanoseconds()/1000000;</div>
<div class="line"><span class="lineno"> 1309</span>                request.location = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a11ffedaaa90fe358ecfdccab7c5a428c">pose_to_ecef</a>(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa67d1b97f198e2f088fb24ffb8e0c690">pose_msg_</a>);</div>
<div class="line"><span class="lineno"> 1310</span> </div>
<div class="line"><span class="lineno"> 1311</span>                <span class="comment">// UCLA: send request based on cut-in type</span></div>
<div class="line"><span class="lineno"> 1312</span>                <span class="keywordflow">if</span> (frontVehicleDtd &lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa53003d4c3610dbb5f87762a6683dd9f">current_downtrack_</a>) </div>
<div class="line"><span class="lineno"> 1313</span>                {</div>
<div class="line"><span class="lineno"> 1314</span>                    request.plan_type.type = carma_v2x_msgs::msg::PlanType::CUT_IN_FRONT_DONE;</div>
<div class="line"><span class="lineno"> 1315</span>                }</div>
<div class="line"><span class="lineno"> 1316</span>                <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1317</span>                {</div>
<div class="line"><span class="lineno"> 1318</span>                    request.plan_type.type = carma_v2x_msgs::msg::PlanType::CUT_IN_MID_OR_REAR_DONE;</div>
<div class="line"><span class="lineno"> 1319</span>                }</div>
<div class="line"><span class="lineno"> 1320</span>                request.strategy = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3be0b52376b568130c1c6a5ec5adeb13">PLATOONING_STRATEGY</a>;</div>
<div class="line"><span class="lineno"> 1321</span>                <span class="keywordtype">double</span> host_platoon_size = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a3ef30eeb7a7cf0caccb948e6a41f92">getHostPlatoonSize</a>();</div>
<div class="line"><span class="lineno"> 1322</span> </div>
<div class="line"><span class="lineno"> 1323</span>                boost::format fmter(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aca973fa2125f768cffaf33812403f45c">JOIN_PARAMS</a>);</div>
<div class="line"><span class="lineno"> 1324</span>                fmter %host_platoon_size;           <span class="comment">//  index = 0</span></div>
<div class="line"><span class="lineno"> 1325</span>                fmter %<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3e827c7f2e764c6e7de83f0a81a9593f">current_speed_</a>;              <span class="comment">//  index = 1, in m/s</span></div>
<div class="line"><span class="lineno"> 1326</span>                fmter %<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ad10e1df213ec7524892b247d28ec9172">pose_ecef_point_</a>.ecef_x;     <span class="comment">//  index = 2</span></div>
<div class="line"><span class="lineno"> 1327</span>                fmter %<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ad10e1df213ec7524892b247d28ec9172">pose_ecef_point_</a>.ecef_y;     <span class="comment">//  index = 3</span></div>
<div class="line"><span class="lineno"> 1328</span>                fmter %<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ad10e1df213ec7524892b247d28ec9172">pose_ecef_point_</a>.ecef_z;     <span class="comment">//  index = 4     </span></div>
<div class="line"><span class="lineno"> 1329</span>                fmter %<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a94ef4b19b4e5f6befabedd4b14908bdd">target_join_index_</a>;          <span class="comment">//  index = 5</span></div>
<div class="line"><span class="lineno"> 1330</span>                request.strategy_params = fmter.str();</div>
<div class="line"><span class="lineno"> 1331</span>                request.urgency = 50;</div>
<div class="line"><span class="lineno"> 1332</span> </div>
<div class="line"><span class="lineno"> 1333</span>                <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae4e916260ddb6f7eb25da13ef9cb158e">mobility_request_publisher_</a>(request); </div>
<div class="line"><span class="lineno"> 1334</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a634f99de503cccb2f2d3cb955623dde2">currentPlatoonID</a>.compare(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ae067830e0351c8ba271b00cb4a6f15c1">dummyID</a>) == 0)</div>
<div class="line"><span class="lineno"> 1335</span>                {</div>
<div class="line"><span class="lineno"> 1336</span>                    <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a634f99de503cccb2f2d3cb955623dde2">currentPlatoonID</a> = request.m_header.plan_id;</div>
<div class="line"><span class="lineno"> 1337</span>                }</div>
<div class="line"><span class="lineno"> 1338</span>                </div>
<div class="line"><span class="lineno"> 1339</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;new platoon id: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a634f99de503cccb2f2d3cb955623dde2">currentPlatoonID</a>);</div>
<div class="line"><span class="lineno"> 1340</span>                <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a> = ActionPlan(<span class="keyword">true</span>, request.m_header.timestamp, request.m_header.plan_id, senderId);</div>
<div class="line"><span class="lineno"> 1341</span>                </div>
<div class="line"><span class="lineno"> 1342</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Published Mobility request to revert to same-lane operation&quot;</span>); </div>
<div class="line"><span class="lineno"> 1343</span>            }</div>
<div class="line"><span class="lineno"> 1344</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1345</span>            {</div>
<div class="line"><span class="lineno"> 1346</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Lane Change not completed&quot;</span>);</div>
<div class="line"><span class="lineno"> 1347</span>            }</div>
<div class="line"><span class="lineno"> 1348</span>        }</div>
<div class="line"><span class="lineno"> 1349</span>    }</div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_a8a8f2badbbe25d2b4d26e1556fa0aa63"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a8f2badbbe25d2b4d26e1556fa0aa63">platoon_strategic_ihp::PlatoonManager::is_neighbor_record_complete_</a></div><div class="ttdeci">bool is_neighbor_record_complete_</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00398">platoon_manager_ihp.h:398</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a2bc77445cdb4c025344024395fa94607"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2bc77445cdb4c025344024395fa94607">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::safeToLaneChange_</a></div><div class="ttdeci">bool safeToLaneChange_</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8h_source.html#l00811">platoon_strategic_ihp.h:811</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a94ef4b19b4e5f6befabedd4b14908bdd"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a94ef4b19b4e5f6befabedd4b14908bdd">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::target_join_index_</a></div><div class="ttdeci">int target_join_index_</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8h_source.html#l00808">platoon_strategic_ihp.h:808</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__strategic__ihp_8h_source.html#l00318">config_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00332">current_crosstrack_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00330">current_downtrack_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00376">platoon_strategic_ihp::PlatoonManager::current_plan</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00328">current_speed_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00364">platoon_strategic_ihp::PlatoonManager::currentPlatoonID</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00358">platoon_strategic_ihp::PlatoonManager::dummyID</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00252">ecef_to_map_point()</a>, <a class="el" href="platoon__manager__ihp_8cpp_source.html#l00279">platoon_strategic_ihp::PlatoonManager::getHostPlatoonSize()</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00398">platoon_strategic_ihp::PlatoonManager::is_neighbor_record_complete_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00858">JOIN_PARAMS</a>, <a class="el" href="platoon__config__ihp_8h_source.html#l00062">platoon_strategic_ihp::PlatoonPluginConfig::maxCrosstrackError</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00777">mob_op_find_ecef_from_INFO_params()</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00308">mobility_request_publisher_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00384">platoon_strategic_ihp::PlatoonManager::neighbor_platoon_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00821">OPERATION_INFO_TYPE</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00820">PLATOONING_STRATEGY</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00817">pm_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00257">pose_ecef_point_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00322">pose_msg_</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00064">pose_to_ecef()</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00811">safeToLaneChange_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00808">target_join_index_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00814">timer_factory_</a>, <a class="el" href="platoon__config__ihp_8h_source.html#l00068">platoon_strategic_ihp::PlatoonPluginConfig::vehicleID</a>, and <a class="el" href="platoon__strategic__ihp_8h_source.html#l00315">wm_</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00809">mob_op_cb()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_afe00eb7730952e85faccf8032637983f_cgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_afe00eb7730952e85faccf8032637983f_cgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_afe00eb7730952e85faccf8032637983f_cgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_afe00eb7730952e85faccf8032637983f_cgraph">
<area shape="rect" title="Function to process mobility operation in PrepareToJoin state (cut&#45;in join)" alt="" coords="5,113,188,169"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a876cee27af19b1f215ffd4a2190be371" title="Function to convert ecef location to a 2d point in map frame." alt="" coords="272,5,455,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a3ef30eeb7a7cf0caccb948e6a41f92" title="Returns total size of the platoon , in number of vehicles." alt="" coords="242,85,485,126"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ab475f5a72d52048d8a4a09617634e24f" title="Function to process mobility operation INFO params to find platoon leader&#39;s ecef location." alt="" coords="236,149,491,205"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a11ffedaaa90fe358ecfdccab7c5a428c" title="Function to convert pose from map frame to ecef location." alt="" coords="272,229,455,285"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_afe00eb7730952e85faccf8032637983f_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_afe00eb7730952e85faccf8032637983f_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_afe00eb7730952e85faccf8032637983f_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_afe00eb7730952e85faccf8032637983f_icgraph">
<area shape="rect" title="Function to process mobility operation in PrepareToJoin state (cut&#45;in join)" alt="" coords="429,5,612,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a9f77f3abf67b6006fd6c9b965cbb1c10" title="Callback function for Mobility Operation Message." alt="" coords="199,5,381,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,5,151,61"/>
</map>
</div>

</div>
</div>
<a id="ade1a16b0f87bd693447cdbbeb960fbba" name="ade1a16b0f87bd693447cdbbeb960fbba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade1a16b0f87bd693447cdbbeb960fbba">&#9670;&nbsp;</a></span>mob_op_cb_standby()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_op_cb_standby </td>
          <td>(</td>
          <td class="paramtype">const carma_v2x_msgs::msg::MobilityOperation &amp;&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to process mobility operation in standby state. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>incoming mobility operation </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00924">924</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  925</span>    {</div>
<div class="line"><span class="lineno">  926</span>        <span class="comment">// In standby state, it will ignore operation message since it is not actively operating</span></div>
<div class="line"><span class="lineno">  927</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;STANDBY state no further action on message from &quot;</span> &lt;&lt; msg.m_header.sender_id);</div>
<div class="line"><span class="lineno">  928</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00809">mob_op_cb()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ade1a16b0f87bd693447cdbbeb960fbba_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ade1a16b0f87bd693447cdbbeb960fbba_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ade1a16b0f87bd693447cdbbeb960fbba_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ade1a16b0f87bd693447cdbbeb960fbba_icgraph">
<area shape="rect" title="Function to process mobility operation in standby state." alt="" coords="429,5,612,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a9f77f3abf67b6006fd6c9b965cbb1c10" title="Callback function for Mobility Operation Message." alt="" coords="199,5,381,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,5,151,61"/>
</map>
</div>

</div>
</div>
<a id="aeac839f63dec331ca94a0feee2c949f4" name="aeac839f63dec331ca94a0feee2c949f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeac839f63dec331ca94a0feee2c949f4">&#9670;&nbsp;</a></span>mob_op_cb_STATUS()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_op_cb_STATUS </td>
          <td>(</td>
          <td class="paramtype">const carma_v2x_msgs::msg::MobilityOperation &amp;&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to process mobility operation message with STATUS params, read ecef location and update platoon member info. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>incoming mobility operation message. </td></tr>
  </table>
  </dd>
</dl>
<p >Note: STATUS params format: STATUS | --&gt; "CMDSPEED:%1%,SPEED:%2%,ECEFX:%3%,ECEFY:%4%,ECEFZ:%5%" |-------&mdash;0-------&mdash;1------&mdash;2------&mdash;3------&mdash;4---&mdash;|</p>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00708">708</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  709</span>    {   </div>
<div class="line"><span class="lineno">  716</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Entered mob_op_cb_STATUS&quot;</span>);</div>
<div class="line"><span class="lineno">  717</span>        std::string strategyParams = msg.strategy_params;</div>
<div class="line"><span class="lineno">  718</span>        std::string vehicleID = msg.m_header.sender_id;</div>
<div class="line"><span class="lineno">  719</span>        std::string platoonId = msg.m_header.plan_id;</div>
<div class="line"><span class="lineno">  720</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;strategyParams = &quot;</span> &lt;&lt; strategyParams);</div>
<div class="line"><span class="lineno">  721</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;platoonId = &quot;</span> &lt;&lt; platoonId &lt;&lt; <span class="stringliteral">&quot;, sender ID = &quot;</span> &lt;&lt; vehicleID);</div>
<div class="line"><span class="lineno">  722</span>        std::string statusParams = strategyParams.substr(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a243c9d3b652447765feab04517074520">OPERATION_STATUS_TYPE</a>.size() + 1);</div>
<div class="line"><span class="lineno">  723</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;pm_.currentPlatoonID = &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a634f99de503cccb2f2d3cb955623dde2">currentPlatoonID</a> &lt;&lt; <span class="stringliteral">&quot;, targetPlatoonID = &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#abc319b76af0eecaba8e0fe0718457618">targetPlatoonID</a>);</div>
<div class="line"><span class="lineno">  724</span> </div>
<div class="line"><span class="lineno">  725</span>        <span class="comment">// read Downtrack </span></div>
<div class="line"><span class="lineno">  726</span>        carma_v2x_msgs::msg::LocationECEF ecef_loc = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3049b9bc64b95a37fe66b83ee6a67a88">mob_op_find_ecef_from_STATUS_params</a>(strategyParams);</div>
<div class="line"><span class="lineno">  727</span>        lanelet::BasicPoint2d incoming_pose = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a876cee27af19b1f215ffd4a2190be371">ecef_to_map_point</a>(ecef_loc);</div>
<div class="line"><span class="lineno">  728</span>        <span class="keywordtype">double</span> dtd = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae65a18d1f14ecdfae3409e47e59a1031">wm_</a>-&gt;routeTrackPos(incoming_pose).downtrack;</div>
<div class="line"><span class="lineno">  729</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;DTD calculated from ecef is: &quot;</span> &lt;&lt; dtd);</div>
<div class="line"><span class="lineno">  730</span>        <span class="comment">// read Crosstrack</span></div>
<div class="line"><span class="lineno">  731</span>        <span class="keywordtype">double</span> ctd = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae65a18d1f14ecdfae3409e47e59a1031">wm_</a>-&gt;routeTrackPos(incoming_pose).crosstrack;</div>
<div class="line"><span class="lineno">  732</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;CTD calculated from ecef is: &quot;</span> &lt;&lt; ctd);</div>
<div class="line"><span class="lineno">  733</span> </div>
<div class="line"><span class="lineno">  734</span>        <span class="comment">// If it comes from a member of an identified neighbor platoon, then</span></div>
<div class="line"><span class="lineno">  735</span>        <span class="keywordflow">if</span> (platoonId.compare(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0fadcff41a35df3fe821f05cc1452c45">neighborPlatoonID</a>) == 0 &amp;&amp; platoonId.compare(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ae067830e0351c8ba271b00cb4a6f15c1">dummyID</a>) != 0)</div>
<div class="line"><span class="lineno">  736</span>        {</div>
<div class="line"><span class="lineno">  737</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Incoming platoonID matches target platoon id&quot;</span>);</div>
<div class="line"><span class="lineno">  738</span>            <span class="comment">// // Update this member&#39;s status (or add if it&#39;s unknown to us)</span></div>
<div class="line"><span class="lineno">  739</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#aef18115269a340fb9e89452acd05658f">neighborMemberUpdates</a>(vehicleID, platoonId, statusParams, dtd, ctd);</div>
<div class="line"><span class="lineno">  740</span>        }</div>
<div class="line"><span class="lineno">  741</span> </div>
<div class="line"><span class="lineno">  742</span>        <span class="comment">// else if this message is for our platoon then store its info</span></div>
<div class="line"><span class="lineno">  743</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (platoonId.compare(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a634f99de503cccb2f2d3cb955623dde2">currentPlatoonID</a>) == 0 &amp;&amp; platoonId.compare(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ae067830e0351c8ba271b00cb4a6f15c1">dummyID</a>) != 0)</div>
<div class="line"><span class="lineno">  744</span>        {</div>
<div class="line"><span class="lineno">  745</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#aa09eb8121e30d6ee3517823766dbeea4">hostMemberUpdates</a>(vehicleID, platoonId, statusParams, dtd, ctd);</div>
<div class="line"><span class="lineno">  746</span>        }</div>
<div class="line"><span class="lineno">  747</span> </div>
<div class="line"><span class="lineno">  748</span>        <span class="comment">// else it represents an uninteresting platoon</span></div>
<div class="line"><span class="lineno">  749</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  750</span>        {</div>
<div class="line"><span class="lineno">  751</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Received mob op for platoon &quot;</span> &lt;&lt; platoonId &lt;&lt; <span class="stringliteral">&quot; that doesn&#39;t match our platoon: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a634f99de503cccb2f2d3cb955623dde2">currentPlatoonID</a></div>
<div class="line"><span class="lineno">  752</span>                             &lt;&lt; <span class="stringliteral">&quot; or known neighbor platoon: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#abc319b76af0eecaba8e0fe0718457618">targetPlatoonID</a>);</div>
<div class="line"><span class="lineno">  753</span>        }</div>
<div class="line"><span class="lineno">  754</span>    }    </div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_aa09eb8121e30d6ee3517823766dbeea4"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#aa09eb8121e30d6ee3517823766dbeea4">platoon_strategic_ihp::PlatoonManager::hostMemberUpdates</a></div><div class="ttdeci">void hostMemberUpdates(const std::string &amp;senderId, const std::string &amp;platoonId, const std::string &amp;params, const double &amp;DtD, const double &amp;CtD)</div><div class="ttdoc">Update information for members of the host's platoon based on a mobility operation STATUS message.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00073">platoon_manager_ihp.cpp:73</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_aef18115269a340fb9e89452acd05658f"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#aef18115269a340fb9e89452acd05658f">platoon_strategic_ihp::PlatoonManager::neighborMemberUpdates</a></div><div class="ttdeci">void neighborMemberUpdates(const std::string &amp;senderId, const std::string &amp;platoonId, const std::string &amp;params, const double &amp;DtD, const double &amp;CtD)</div><div class="ttdoc">Update information for members of a neighboring platoon based on a mobility operation STATUS message.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00157">platoon_manager_ihp.cpp:157</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a3049b9bc64b95a37fe66b83ee6a67a88"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3049b9bc64b95a37fe66b83ee6a67a88">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_op_find_ecef_from_STATUS_params</a></div><div class="ttdeci">carma_v2x_msgs::msg::LocationECEF mob_op_find_ecef_from_STATUS_params(std::string strategyParams)</div><div class="ttdoc">Function to process mobility operation for STATUS params.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l00675">platoon_strategic_ihp.cpp:675</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__manager__ihp_8h_source.html#l00364">platoon_strategic_ihp::PlatoonManager::currentPlatoonID</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00358">platoon_strategic_ihp::PlatoonManager::dummyID</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00252">ecef_to_map_point()</a>, <a class="el" href="platoon__manager__ihp_8cpp_source.html#l00073">platoon_strategic_ihp::PlatoonManager::hostMemberUpdates()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00675">mob_op_find_ecef_from_STATUS_params()</a>, <a class="el" href="platoon__manager__ihp_8cpp_source.html#l00157">platoon_strategic_ihp::PlatoonManager::neighborMemberUpdates()</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00392">platoon_strategic_ihp::PlatoonManager::neighborPlatoonID</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00822">OPERATION_STATUS_TYPE</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00817">pm_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00390">platoon_strategic_ihp::PlatoonManager::targetPlatoonID</a>, and <a class="el" href="platoon__strategic__ihp_8h_source.html#l00315">wm_</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00809">mob_op_cb()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aeac839f63dec331ca94a0feee2c949f4_cgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aeac839f63dec331ca94a0feee2c949f4_cgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aeac839f63dec331ca94a0feee2c949f4_cgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aeac839f63dec331ca94a0feee2c949f4_cgraph">
<area shape="rect" title="Function to process mobility operation message with STATUS params, read ecef location and update plat..." alt="" coords="5,256,188,312"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a876cee27af19b1f215ffd4a2190be371" title="Function to convert ecef location to a 2d point in map frame." alt="" coords="283,136,465,192"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#aa09eb8121e30d6ee3517823766dbeea4" title="Update information for members of the host&#39;s platoon based on a mobility operation STATUS message." alt="" coords="274,216,474,272"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3049b9bc64b95a37fe66b83ee6a67a88" title="Function to process mobility operation for STATUS params." alt="" coords="236,296,512,352"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#aef18115269a340fb9e89452acd05658f" title="Update information for members of a neighboring platoon based on a mobility operation STATUS message." alt="" coords="262,376,486,432"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a10f95b2573ee211d8f9b07f8d7551809" title="Returns command speed. in m/s." alt="" coords="560,5,765,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ac7017e74336d2270a0d66249a46c7dbb" title="Returns current crosstrack distance, in m." alt="" coords="569,85,757,141"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8f79bf82a5c6ba800fd48f9ed819f606" title="Returns current downtrack distance, in m." alt="" coords="569,165,757,221"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ac123534207dc3ea247cfb1281426cd84" title="Returns current speed, in m/s." alt="" coords="569,245,757,301"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ae696d79ca33f496082ef462fdc9ba53b" title="Returns current host static ID as a string." alt="" coords="813,351,1035,393"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a6b4eae07dfc95c25104f95fef1f0f344" title="Updates the list of vehicles in the specified platoon, based on info available from a mobility operat..." alt="" coords="569,376,757,432"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aeac839f63dec331ca94a0feee2c949f4_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aeac839f63dec331ca94a0feee2c949f4_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aeac839f63dec331ca94a0feee2c949f4_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aeac839f63dec331ca94a0feee2c949f4_icgraph">
<area shape="rect" title="Function to process mobility operation message with STATUS params, read ecef location and update plat..." alt="" coords="429,5,612,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a9f77f3abf67b6006fd6c9b965cbb1c10" title="Callback function for Mobility Operation Message." alt="" coords="199,5,381,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,5,151,61"/>
</map>
</div>

</div>
</div>
<a id="ab475f5a72d52048d8a4a09617634e24f" name="ab475f5a72d52048d8a4a09617634e24f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab475f5a72d52048d8a4a09617634e24f">&#9670;&nbsp;</a></span>mob_op_find_ecef_from_INFO_params()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">carma_v2x_msgs::msg::LocationECEF platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_op_find_ecef_from_INFO_params </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>strategyParams</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to process mobility operation INFO params to find platoon leader's ecef location. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">strategyParams</td><td>The parsed strategy params, used to find ecef locaton.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ecef location of the sender. </dd></dl>
<p >Note: INFO param format: "INFO| --&gt; LENGTH:%.2f,SPEED:%.2f,SIZE:%d,ECEFX:%.2f,ECEFY:%.2f,ECEFZ:%.2f" |----&mdash;0--------&mdash;1------&mdash;2-----&mdash;3-------&mdash;4-------&mdash;5----&mdash;|</p>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00777">777</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  778</span>    {</div>
<div class="line"><span class="lineno">  784</span>        <span class="comment">// For INFO params, the string format is INFO|REAR:%s,LENGTH:%.2f,SPEED:%.2f,SIZE:%d,DTD:%.2f</span></div>
<div class="line"><span class="lineno">  785</span>        std::vector&lt;std::string&gt; inputsParams;</div>
<div class="line"><span class="lineno">  786</span>        <a class="code hl_variable" href="namespaceprocess__traj__logs.html#a3682477a3431f2a4aa182fb9a6439125">boost::algorithm::split</a>(inputsParams, strategyParams, boost::is_any_of(<span class="stringliteral">&quot;,&quot;</span>));</div>
<div class="line"><span class="lineno">  787</span> </div>
<div class="line"><span class="lineno">  788</span>        std::vector&lt;std::string&gt; ecef_x_parsed;</div>
<div class="line"><span class="lineno">  789</span>        <a class="code hl_variable" href="namespaceprocess__traj__logs.html#a3682477a3431f2a4aa182fb9a6439125">boost::algorithm::split</a>(ecef_x_parsed, inputsParams[3], boost::is_any_of(<span class="stringliteral">&quot;:&quot;</span>));</div>
<div class="line"><span class="lineno">  790</span>        <span class="keywordtype">double</span> ecef_x = std::stod(ecef_x_parsed[1]);</div>
<div class="line"><span class="lineno">  791</span> </div>
<div class="line"><span class="lineno">  792</span>        std::vector&lt;std::string&gt; ecef_y_parsed;</div>
<div class="line"><span class="lineno">  793</span>        <a class="code hl_variable" href="namespaceprocess__traj__logs.html#a3682477a3431f2a4aa182fb9a6439125">boost::algorithm::split</a>(ecef_y_parsed, inputsParams[4], boost::is_any_of(<span class="stringliteral">&quot;:&quot;</span>));</div>
<div class="line"><span class="lineno">  794</span>        <span class="keywordtype">double</span> ecef_y = std::stod(ecef_y_parsed[1]);</div>
<div class="line"><span class="lineno">  795</span> </div>
<div class="line"><span class="lineno">  796</span>        std::vector&lt;std::string&gt; ecef_z_parsed;</div>
<div class="line"><span class="lineno">  797</span>        <a class="code hl_variable" href="namespaceprocess__traj__logs.html#a3682477a3431f2a4aa182fb9a6439125">boost::algorithm::split</a>(ecef_z_parsed, inputsParams[5], boost::is_any_of(<span class="stringliteral">&quot;:&quot;</span>));</div>
<div class="line"><span class="lineno">  798</span>        <span class="keywordtype">double</span> ecef_z = std::stod(ecef_z_parsed[1]);</div>
<div class="line"><span class="lineno">  799</span>        </div>
<div class="line"><span class="lineno">  800</span>        carma_v2x_msgs::msg::LocationECEF ecef_loc;</div>
<div class="line"><span class="lineno">  801</span>        ecef_loc.ecef_x = ecef_x;</div>
<div class="line"><span class="lineno">  802</span>        ecef_loc.ecef_y = ecef_y;</div>
<div class="line"><span class="lineno">  803</span>        ecef_loc.ecef_z = ecef_z;</div>
<div class="line"><span class="lineno">  804</span> </div>
<div class="line"><span class="lineno">  805</span>        <span class="keywordflow">return</span> ecef_loc;</div>
<div class="line"><span class="lineno">  806</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="process__traj__logs_8py_source.html#l00165">process_traj_logs::split</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00954">mob_op_cb_leader()</a>, and <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01244">mob_op_cb_preparetojoin()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ab475f5a72d52048d8a4a09617634e24f_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ab475f5a72d52048d8a4a09617634e24f_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ab475f5a72d52048d8a4a09617634e24f_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ab475f5a72d52048d8a4a09617634e24f_icgraph">
<area shape="rect" title="Function to process mobility operation INFO params to find platoon leader&#39;s ecef location." alt="" coords="660,45,915,101"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#afd00a90158f773100543b3f56f964d74" title="Function to process mobility operation in leader state." alt="" coords="429,5,612,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#afe00eb7730952e85faccf8032637983f" title="Function to process mobility operation in PrepareToJoin state (cut&#45;in join)" alt="" coords="429,85,612,141"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a9f77f3abf67b6006fd6c9b965cbb1c10" title="Callback function for Mobility Operation Message." alt="" coords="199,45,381,101"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,45,151,101"/>
</map>
</div>

</div>
</div>
<a id="a3049b9bc64b95a37fe66b83ee6a67a88" name="a3049b9bc64b95a37fe66b83ee6a67a88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3049b9bc64b95a37fe66b83ee6a67a88">&#9670;&nbsp;</a></span>mob_op_find_ecef_from_STATUS_params()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">carma_v2x_msgs::msg::LocationECEF platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_op_find_ecef_from_STATUS_params </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>strategyParams</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to process mobility operation for STATUS params. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">strategyParams</td><td>The parsed strategy params, used to find ecef locaton.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ecef location of the sender. </dd></dl>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00675">675</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  676</span>    {</div>
<div class="line"><span class="lineno">  677</span>        <span class="comment">/*</span></div>
<div class="line"><span class="lineno">  678</span><span class="comment">         * Helper function that extract ecef location from STATUS msg.</span></div>
<div class="line"><span class="lineno">  679</span><span class="comment">         * Note: STATUS params format:</span></div>
<div class="line"><span class="lineno">  680</span><span class="comment">         *       STATUS | --&gt; &quot;CMDSPEED:%1%,SPEED:%2%,ECEFX:%3%,ECEFY:%4%,ECEFZ:%5%&quot;</span></div>
<div class="line"><span class="lineno">  681</span><span class="comment">         *              |----------0----------1---------2---------3---------4------|</span></div>
<div class="line"><span class="lineno">  682</span><span class="comment">         */</span></div>
<div class="line"><span class="lineno">  683</span> </div>
<div class="line"><span class="lineno">  684</span>        std::vector&lt;std::string&gt; inputsParams;</div>
<div class="line"><span class="lineno">  685</span>        <a class="code hl_variable" href="namespaceprocess__traj__logs.html#a3682477a3431f2a4aa182fb9a6439125">boost::algorithm::split</a>(inputsParams, strategyParams, boost::is_any_of(<span class="stringliteral">&quot;,&quot;</span>));</div>
<div class="line"><span class="lineno">  686</span> </div>
<div class="line"><span class="lineno">  687</span>        std::vector&lt;std::string&gt; ecef_x_parsed;</div>
<div class="line"><span class="lineno">  688</span>        <a class="code hl_variable" href="namespaceprocess__traj__logs.html#a3682477a3431f2a4aa182fb9a6439125">boost::algorithm::split</a>(ecef_x_parsed, inputsParams[2], boost::is_any_of(<span class="stringliteral">&quot;:&quot;</span>));</div>
<div class="line"><span class="lineno">  689</span>        <span class="keywordtype">double</span> ecef_x = std::stod(ecef_x_parsed[1]);</div>
<div class="line"><span class="lineno">  690</span> </div>
<div class="line"><span class="lineno">  691</span>        std::vector&lt;std::string&gt; ecef_y_parsed;</div>
<div class="line"><span class="lineno">  692</span>        <a class="code hl_variable" href="namespaceprocess__traj__logs.html#a3682477a3431f2a4aa182fb9a6439125">boost::algorithm::split</a>(ecef_y_parsed, inputsParams[3], boost::is_any_of(<span class="stringliteral">&quot;:&quot;</span>));</div>
<div class="line"><span class="lineno">  693</span>        <span class="keywordtype">double</span> ecef_y = std::stod(ecef_y_parsed[1]);</div>
<div class="line"><span class="lineno">  694</span> </div>
<div class="line"><span class="lineno">  695</span>        std::vector&lt;std::string&gt; ecef_z_parsed;</div>
<div class="line"><span class="lineno">  696</span>        <a class="code hl_variable" href="namespaceprocess__traj__logs.html#a3682477a3431f2a4aa182fb9a6439125">boost::algorithm::split</a>(ecef_z_parsed, inputsParams[4], boost::is_any_of(<span class="stringliteral">&quot;:&quot;</span>));</div>
<div class="line"><span class="lineno">  697</span>        <span class="keywordtype">double</span> ecef_z = std::stod(ecef_z_parsed[1]);</div>
<div class="line"><span class="lineno">  698</span>        </div>
<div class="line"><span class="lineno">  699</span>        carma_v2x_msgs::msg::LocationECEF ecef_loc;</div>
<div class="line"><span class="lineno">  700</span>        ecef_loc.ecef_x = ecef_x;</div>
<div class="line"><span class="lineno">  701</span>        ecef_loc.ecef_y = ecef_y;</div>
<div class="line"><span class="lineno">  702</span>        ecef_loc.ecef_z = ecef_z;</div>
<div class="line"><span class="lineno">  703</span> </div>
<div class="line"><span class="lineno">  704</span>        <span class="keywordflow">return</span> ecef_loc;</div>
<div class="line"><span class="lineno">  705</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="process__traj__logs_8py_source.html#l00165">process_traj_logs::split</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00708">mob_op_cb_STATUS()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a3049b9bc64b95a37fe66b83ee6a67a88_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a3049b9bc64b95a37fe66b83ee6a67a88_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a3049b9bc64b95a37fe66b83ee6a67a88_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a3049b9bc64b95a37fe66b83ee6a67a88_icgraph">
<area shape="rect" title="Function to process mobility operation for STATUS params." alt="" coords="660,5,936,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aeac839f63dec331ca94a0feee2c949f4" title="Function to process mobility operation message with STATUS params, read ecef location and update plat..." alt="" coords="429,5,612,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a9f77f3abf67b6006fd6c9b965cbb1c10" title="Callback function for Mobility Operation Message." alt="" coords="199,5,381,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,5,151,61"/>
</map>
</div>

</div>
</div>
<a id="a41bb6d04569023ef9480fa263a804a8c" name="a41bb6d04569023ef9480fa263a804a8c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41bb6d04569023ef9480fa263a804a8c">&#9670;&nbsp;</a></span>mob_op_find_platoon_length_from_INFO_params()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_op_find_platoon_length_from_INFO_params </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>strategyParams</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to process mobility operation INFO params to find platoon length in m. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">strategyParams</td><td>The parsed strategy params, used to find ecef locaton.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The length of the platoon in m. </dd></dl>
<p >Note: INFO param format: "INFO| --&gt; LENGTH:%.2f,SPEED:%.2f,SIZE:%d,ECEFX:%.2f,ECEFY:%.2f,ECEFZ:%.2f" |----&mdash;0--------&mdash;1------&mdash;2-----&mdash;3-------&mdash;4-------&mdash;5----&mdash;|</p>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00757">757</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  758</span>    {</div>
<div class="line"><span class="lineno">  764</span>        <span class="comment">// For INFO params, the string format is INFO|REAR:%s,LENGTH:%.2f,SPEED:%.2f,SIZE:%d,DTD:%.2f</span></div>
<div class="line"><span class="lineno">  765</span>        std::vector&lt;std::string&gt; inputsParams;</div>
<div class="line"><span class="lineno">  766</span>        <a class="code hl_variable" href="namespaceprocess__traj__logs.html#a3682477a3431f2a4aa182fb9a6439125">boost::algorithm::split</a>(inputsParams, strategyParams, boost::is_any_of(<span class="stringliteral">&quot;,&quot;</span>));</div>
<div class="line"><span class="lineno">  767</span> </div>
<div class="line"><span class="lineno">  768</span>        <span class="comment">// Use the strategy params&#39; length value and leader location to determine DTD of its rear</span></div>
<div class="line"><span class="lineno">  769</span>        std::vector&lt;std::string&gt; target_platoon_length;</div>
<div class="line"><span class="lineno">  770</span>        <a class="code hl_variable" href="namespaceprocess__traj__logs.html#a3682477a3431f2a4aa182fb9a6439125">boost::algorithm::split</a>(target_platoon_length, inputsParams[0], boost::is_any_of(<span class="stringliteral">&quot;:&quot;</span>));</div>
<div class="line"><span class="lineno">  771</span>        <span class="keywordtype">double</span> platoon_length = std::stod(target_platoon_length[1]);</div>
<div class="line"><span class="lineno">  772</span> </div>
<div class="line"><span class="lineno">  773</span>        <span class="keywordflow">return</span> platoon_length;</div>
<div class="line"><span class="lineno">  774</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="process__traj__logs_8py_source.html#l00165">process_traj_logs::split</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00954">mob_op_cb_leader()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a41bb6d04569023ef9480fa263a804a8c_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a41bb6d04569023ef9480fa263a804a8c_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a41bb6d04569023ef9480fa263a804a8c_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a41bb6d04569023ef9480fa263a804a8c_icgraph">
<area shape="rect" title="Function to process mobility operation INFO params to find platoon length in m." alt="" coords="660,5,852,76"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#afd00a90158f773100543b3f56f964d74" title="Function to process mobility operation in leader state." alt="" coords="429,13,612,69"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a9f77f3abf67b6006fd6c9b965cbb1c10" title="Callback function for Mobility Operation Message." alt="" coords="199,13,381,69"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,13,151,69"/>
</map>
</div>

</div>
</div>
<a id="a588b379b14e20af4e05cf4883c535c5a" name="a588b379b14e20af4e05cf4883c535c5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a588b379b14e20af4e05cf4883c535c5a">&#9670;&nbsp;</a></span>mob_req_cb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_req_cb </td>
          <td>(</td>
          <td class="paramtype">const carma_v2x_msgs::msg::MobilityRequest::UniquePtr&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Callback function for Mobility Request Message. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>Mobility Request Message </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02551">2551</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2552</span>    {</div>
<div class="line"><span class="lineno"> 2553</span>        <span class="comment">// Ignore messages as long as host vehicle is stopped</span></div>
<div class="line"><span class="lineno"> 2554</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3e827c7f2e764c6e7de83f0a81a9593f">current_speed_</a> &lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a318e60626d39552f90e4d72fd55bc76e">minPlatooningSpeed</a>)</div>
<div class="line"><span class="lineno"> 2555</span>        {</div>
<div class="line"><span class="lineno"> 2556</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Ignoring message since host speed is below platooning speed.&quot;</span>);</div>
<div class="line"><span class="lineno"> 2557</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 2558</span>        }</div>
<div class="line"><span class="lineno"> 2559</span>        </div>
<div class="line"><span class="lineno"> 2560</span>        <span class="comment">// Check that this is a message about platooning (could be from some other Carma activity nearby)</span></div>
<div class="line"><span class="lineno"> 2561</span>        std::string strategy = msg-&gt;strategy;</div>
<div class="line"><span class="lineno"> 2562</span>        <span class="keywordflow">if</span> (strategy.rfind(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3be0b52376b568130c1c6a5ec5adeb13">PLATOONING_STRATEGY</a>, 0) != 0)</div>
<div class="line"><span class="lineno"> 2563</span>        {</div>
<div class="line"><span class="lineno"> 2564</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Ignoring mobility operation message for &quot;</span> &lt;&lt; strategy &lt;&lt; <span class="stringliteral">&quot; strategy.&quot;</span>);</div>
<div class="line"><span class="lineno"> 2565</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 2566</span>        }</div>
<div class="line"><span class="lineno"> 2567</span> </div>
<div class="line"><span class="lineno"> 2568</span>        carma_v2x_msgs::msg::MobilityResponse response;</div>
<div class="line"><span class="lineno"> 2569</span>        response.m_header.sender_id = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a473bcce97d7c50beaab678372a354c0d">vehicleID</a>;</div>
<div class="line"><span class="lineno"> 2570</span>        response.m_header.recipient_id = msg-&gt;m_header.sender_id;</div>
<div class="line"><span class="lineno"> 2571</span>        response.m_header.plan_id = msg-&gt;m_header.plan_id;</div>
<div class="line"><span class="lineno"> 2572</span>        response.m_header.timestamp = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a283186f2bbb98f5f85b5486e365bb4b8">timer_factory_</a>-&gt;now().nanoseconds() / 1000000;</div>
<div class="line"><span class="lineno"> 2573</span> </div>
<div class="line"><span class="lineno"> 2574</span>       <span class="comment">// UCLA: add plantype in response </span></div>
<div class="line"><span class="lineno"> 2575</span>        response.plan_type.type = msg-&gt;plan_type.type;</div>
<div class="line"><span class="lineno"> 2576</span>        </div>
<div class="line"><span class="lineno"> 2577</span>        <a class="code hl_enumeration" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217">MobilityRequestResponse</a> req_response = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a53cc42ead95e9734805f4b52de1e38eb">handle_mob_req</a>(*msg);</div>
<div class="line"><span class="lineno"> 2578</span>        <span class="keywordflow">if</span> (req_response == <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217a62e4d1cf02b4cfa5752c7c3dfd75cd03">MobilityRequestResponse::ACK</a>)</div>
<div class="line"><span class="lineno"> 2579</span>        {</div>
<div class="line"><span class="lineno"> 2580</span>            response.is_accepted = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2581</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a08781c935cd2c56a9f93448d7a3a96fa">mobility_response_publisher_</a>(response);</div>
<div class="line"><span class="lineno"> 2582</span>        }</div>
<div class="line"><span class="lineno"> 2583</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (req_response == <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217a5d88dd49037ae721095d111b8ee630d5">MobilityRequestResponse::NACK</a>)</div>
<div class="line"><span class="lineno"> 2584</span>        {</div>
<div class="line"><span class="lineno"> 2585</span>            response.is_accepted = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2586</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a08781c935cd2c56a9f93448d7a3a96fa">mobility_response_publisher_</a>(response);</div>
<div class="line"><span class="lineno"> 2587</span>        }</div>
<div class="line"><span class="lineno"> 2588</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2589</span>        {</div>
<div class="line"><span class="lineno"> 2590</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot; NO response to mobility request. &quot;</span>);</div>
<div class="line"><span class="lineno"> 2591</span>        }</div>
<div class="line"><span class="lineno"> 2592</span>    }</div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a53cc42ead95e9734805f4b52de1e38eb"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a53cc42ead95e9734805f4b52de1e38eb">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::handle_mob_req</a></div><div class="ttdeci">MobilityRequestResponse handle_mob_req(const carma_v2x_msgs::msg::MobilityRequest &amp;msg)</div><div class="ttdoc">Function to the process and respond to the mobility request.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l01354">platoon_strategic_ihp.cpp:1354</a></div></div>
<div class="ttc" id="anamespaceplatoon__strategic__ihp_html_afdeaa181289e9678d31f8928ec036217a5d88dd49037ae721095d111b8ee630d5"><div class="ttname"><a href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217a5d88dd49037ae721095d111b8ee630d5">platoon_strategic_ihp::NACK</a></div><div class="ttdeci">@ NACK</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00067">platoon_manager_ihp.h:67</a></div></div>
<div class="ttc" id="anamespaceplatoon__strategic__ihp_html_afdeaa181289e9678d31f8928ec036217a62e4d1cf02b4cfa5752c7c3dfd75cd03"><div class="ttname"><a href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217a62e4d1cf02b4cfa5752c7c3dfd75cd03">platoon_strategic_ihp::ACK</a></div><div class="ttdeci">@ ACK</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00066">platoon_manager_ihp.h:66</a></div></div>
<div class="ttc" id="astructplatoon__strategic__ihp_1_1PlatoonPluginConfig_html_a318e60626d39552f90e4d72fd55bc76e"><div class="ttname"><a href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a318e60626d39552f90e4d72fd55bc76e">platoon_strategic_ihp::PlatoonPluginConfig::minPlatooningSpeed</a></div><div class="ttdeci">double minPlatooningSpeed</div><div class="ttdef"><b>Definition:</b> <a href="platoon__config__ihp_8h_source.html#l00071">platoon_config_ihp.h:71</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__manager__ihp_8h_source.html#l00066">platoon_strategic_ihp::ACK</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00318">config_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00328">current_speed_</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01354">handle_mob_req()</a>, <a class="el" href="platoon__config__ihp_8h_source.html#l00071">platoon_strategic_ihp::PlatoonPluginConfig::minPlatooningSpeed</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00309">mobility_response_publisher_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00067">platoon_strategic_ihp::NACK</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00820">PLATOONING_STRATEGY</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00814">timer_factory_</a>, and <a class="el" href="platoon__config__ihp_8h_source.html#l00068">platoon_strategic_ihp::PlatoonPluginConfig::vehicleID</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp__node_8cpp_source.html#l00118">platoon_strategic_ihp::Node::on_configure_plugin()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a588b379b14e20af4e05cf4883c535c5a_cgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a588b379b14e20af4e05cf4883c535c5a_cgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a588b379b14e20af4e05cf4883c535c5a_cgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a588b379b14e20af4e05cf4883c535c5a_cgraph">
<area shape="rect" title="Callback function for Mobility Request Message." alt="" coords="5,393,188,449"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a53cc42ead95e9734805f4b52de1e38eb" title="Function to the process and respond to the mobility request." alt="" coords="236,393,419,449"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a6f3897bc8d2d12e3161ede942d5f1b51" title="Function to process mobility request in candidate follower state." alt="" coords="467,73,673,129"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a90514428edda23566362c1a60dc01448" title="Function to process mobility request in candidateleader state." alt="" coords="471,153,669,209"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a274f5abfcee68012ec00bfe4f8a7c21e" title="Function to process mobility request in follower state." alt="" coords="479,473,661,529"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a5776b135d1c58b8224763c05d64fa440" title="Function to process mobility request in leader state." alt="" coords="479,393,661,449"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ade79b5e7117d1ca95418ae5fa7f73d97" title="Function to process mobility request in leaderaborting state." alt="" coords="477,553,663,609"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a76aa3d0140244914e0ffe7f9554751bb" title="Function to process mobility request in leader waiting state." alt="" coords="479,233,661,289"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a18b8dcd9744c6df8a615a1ce76f42146" title="Function to process mobility request in leadwithoperation state (cut&#45;in join)" alt="" coords="467,313,673,369"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a17e303fdec4af651df3678c0a065ad7e" title="Function to process mobility request in preparetojoin state (cut&#45;in join)" alt="" coords="479,633,661,689"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a83ec14a38d923ba22c00168e8e991a32" title="Function to process mobility request in standby state." alt="" coords="479,713,661,769"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#af2f0d9818d07db4a4df484f988635201" title="Resets necessary variables to indicate that the current ActionPlan is dead." alt="" coords="733,165,952,206"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a876cee27af19b1f215ffd4a2190be371" title="Function to convert ecef location to a 2d point in map frame." alt="" coords="751,229,934,285"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ab1c204db4a5056621de299a9dd663c6f" title="Resets all variables that might indicate other members of the host&#39;s platoon; sets the host back to s..." alt="" coords="750,5,935,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#abca93088e8980c97a1a24c4fff31c758" title="Resets all variables that describe a neighbor platoon, so that no neighbor is known." alt="" coords="738,85,947,141"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ae696d79ca33f496082ef462fdc9ba53b" title="Returns current host static ID as a string." alt="" coords="732,693,953,734"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a3ef30eeb7a7cf0caccb948e6a41f92" title="Returns total size of the platoon , in number of vehicles." alt="" coords="721,309,964,350"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#aac57cfc07168101835015859c9c7e48e" title="UCLA: Return the platoon leader downtrack distance, in m." alt="" coords="747,453,938,509"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a83ecd30ec7e2f7eb15c93075c8eca436" title="Returns downtrack distance of the rear vehicle in platoon, in m." alt="" coords="747,533,938,589"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a12d5bd4a0601fe67e924cc07f0672e85" title="The method for platoon leader to determine if the joining vehicle is closeby. (Note: Used when host v..." alt="" coords="745,613,940,669"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ad3cd4b02451fd0b0a25ed712e3331c36" title="Find lanelet width from local position." alt="" coords="1012,613,1195,669"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a11ffedaaa90fe358ecfdccab7c5a428c" title="Function to convert pose from map frame to ecef location." alt="" coords="751,373,934,429"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a588b379b14e20af4e05cf4883c535c5a_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a588b379b14e20af4e05cf4883c535c5a_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a588b379b14e20af4e05cf4883c535c5a_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a588b379b14e20af4e05cf4883c535c5a_icgraph">
<area shape="rect" title="Callback function for Mobility Request Message." alt="" coords="199,5,381,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,5,151,61"/>
</map>
</div>

</div>
</div>
<a id="a6f3897bc8d2d12e3161ede942d5f1b51" name="a6f3897bc8d2d12e3161ede942d5f1b51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f3897bc8d2d12e3161ede942d5f1b51">&#9670;&nbsp;</a></span>mob_req_cb_candidatefollower()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217">MobilityRequestResponse</a> platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_req_cb_candidatefollower </td>
          <td>(</td>
          <td class="paramtype">const carma_v2x_msgs::msg::MobilityRequest &amp;&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to process mobility request in candidate follower state. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>incoming mobility request</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ACK, NACK, or No response </dd></dl>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01420">1420</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1421</span>    {</div>
<div class="line"><span class="lineno"> 1422</span>        <span class="comment">// This state does not handle any mobility request for now</span></div>
<div class="line"><span class="lineno"> 1423</span>        <span class="comment">// TODO Maybe it should handle some ABORT request from a waiting leader</span></div>
<div class="line"><span class="lineno"> 1424</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Received mobility request with type &quot;</span> &lt;&lt; msg.plan_type.type &lt;&lt; <span class="stringliteral">&quot; but ignored.&quot;</span>);</div>
<div class="line"><span class="lineno"> 1425</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217a1aabdeebf3169c8d6a5a56d627286f48">MobilityRequestResponse::NO_RESPONSE</a>;</div>
<div class="line"><span class="lineno"> 1426</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__manager__ihp_8h_source.html#l00068">platoon_strategic_ihp::NO_RESPONSE</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01354">handle_mob_req()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a6f3897bc8d2d12e3161ede942d5f1b51_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a6f3897bc8d2d12e3161ede942d5f1b51_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a6f3897bc8d2d12e3161ede942d5f1b51_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a6f3897bc8d2d12e3161ede942d5f1b51_icgraph">
<area shape="rect" title="Function to process mobility request in candidate follower state." alt="" coords="660,5,867,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a53cc42ead95e9734805f4b52de1e38eb" title="Function to the process and respond to the mobility request." alt="" coords="429,5,612,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a588b379b14e20af4e05cf4883c535c5a" title="Callback function for Mobility Request Message." alt="" coords="199,5,381,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,5,151,61"/>
</map>
</div>

</div>
</div>
<a id="a90514428edda23566362c1a60dc01448" name="a90514428edda23566362c1a60dc01448"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90514428edda23566362c1a60dc01448">&#9670;&nbsp;</a></span>mob_req_cb_candidateleader()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217">MobilityRequestResponse</a> platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_req_cb_candidateleader </td>
          <td>(</td>
          <td class="paramtype">const carma_v2x_msgs::msg::MobilityRequest &amp;&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to process mobility request in candidateleader state. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>incoming mobility request.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ACK, NACK, or No response. </dd></dl>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01827">1827</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1828</span>    {   </div>
<div class="line"><span class="lineno"> 1829</span>        <span class="keywordtype">bool</span> isTargetVehicle = msg.m_header.sender_id == <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a38851b8c1a54cc039c86fa3576c940e4">peerId</a>; <span class="comment">// need to check: senderID (old leader)</span></div>
<div class="line"><span class="lineno"> 1830</span>        <span class="keywordtype">bool</span> isCandidateJoin = msg.plan_type.type == carma_v2x_msgs::msg::PlanType::PLATOON_FRONT_JOIN;</div>
<div class="line"><span class="lineno"> 1831</span> </div>
<div class="line"><span class="lineno"> 1832</span>        lanelet::BasicPoint2d incoming_pose = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a876cee27af19b1f215ffd4a2190be371">ecef_to_map_point</a>(msg.location);</div>
<div class="line"><span class="lineno"> 1833</span>        <span class="keywordtype">double</span> obj_cross_track = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae65a18d1f14ecdfae3409e47e59a1031">wm_</a>-&gt;routeTrackPos(incoming_pose).crosstrack;</div>
<div class="line"><span class="lineno"> 1834</span>        <span class="keywordtype">bool</span> inTheSameLane = abs(obj_cross_track - <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a79aaef859aaa4b64f6cf79c50c596bc3">current_crosstrack_</a>) &lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a3c2aa8b4742ba50d80bc9c23ed183ebf">maxCrosstrackError</a>;</div>
<div class="line"><span class="lineno"> 1835</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;current_cross_track error = &quot;</span> &lt;&lt; abs(obj_cross_track - <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a79aaef859aaa4b64f6cf79c50c596bc3">current_crosstrack_</a>));</div>
<div class="line"><span class="lineno"> 1836</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;obj_cross_track = &quot;</span> &lt;&lt; obj_cross_track);</div>
<div class="line"><span class="lineno"> 1837</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;current_crosstrack_ = &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a79aaef859aaa4b64f6cf79c50c596bc3">current_crosstrack_</a>);</div>
<div class="line"><span class="lineno"> 1838</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;inTheSameLane = &quot;</span> &lt;&lt; inTheSameLane);</div>
<div class="line"><span class="lineno"> 1839</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;isTargetVehicle = &quot;</span> &lt;&lt; isTargetVehicle);</div>
<div class="line"><span class="lineno"> 1840</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;isCandidateJoin = &quot;</span> &lt;&lt; isCandidateJoin);</div>
<div class="line"><span class="lineno"> 1841</span>        <span class="keywordflow">if</span> (isCandidateJoin &amp;&amp; inTheSameLane  &amp;&amp;  isTargetVehicle)</div>
<div class="line"><span class="lineno"> 1842</span>        {</div>
<div class="line"><span class="lineno"> 1843</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Old platoon leader &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a38851b8c1a54cc039c86fa3576c940e4">peerId</a> &lt;&lt; <span class="stringliteral">&quot; has agreed to joining.&quot;</span>);</div>
<div class="line"><span class="lineno"> 1844</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Changing to PlatoonLeaderState and send ACK to the previous leader vehicle&quot;</span>);</div>
<div class="line"><span class="lineno"> 1845</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> = <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa57f78e815f4fc2ac271a9fd85cd80ebc">PlatoonState::LEADER</a>;</div>
<div class="line"><span class="lineno"> 1846</span>            </div>
<div class="line"><span class="lineno"> 1847</span>            <span class="comment">// Clean up planning info</span></div>
<div class="line"><span class="lineno"> 1848</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#af2f0d9818d07db4a4df484f988635201">clearActionPlan</a>();</div>
<div class="line"><span class="lineno"> 1849</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a05732c5f9b2d8f5d2c66d1cdcf793854">platoonLeaderID</a> = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a473bcce97d7c50beaab678372a354c0d">vehicleID</a>;</div>
<div class="line"><span class="lineno"> 1850</span> </div>
<div class="line"><span class="lineno"> 1851</span>            <span class="comment">// Clean up neighbor platoon info since we just joined it</span></div>
<div class="line"><span class="lineno"> 1852</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#abca93088e8980c97a1a24c4fff31c758">resetNeighborPlatoon</a>();</div>
<div class="line"><span class="lineno"> 1853</span> </div>
<div class="line"><span class="lineno"> 1854</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217a62e4d1cf02b4cfa5752c7c3dfd75cd03">MobilityRequestResponse::ACK</a>;</div>
<div class="line"><span class="lineno"> 1855</span>        }</div>
<div class="line"><span class="lineno"> 1856</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1857</span>        {</div>
<div class="line"><span class="lineno"> 1858</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Received platoon request with vehicle id = &quot;</span> &lt;&lt; msg.m_header.sender_id);</div>
<div class="line"><span class="lineno"> 1859</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;The request type is &quot;</span> &lt;&lt; msg.plan_type.type &lt;&lt; <span class="stringliteral">&quot; and we choose to ignore&quot;</span>);</div>
<div class="line"><span class="lineno"> 1860</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#af2f0d9818d07db4a4df484f988635201">clearActionPlan</a>();</div>
<div class="line"><span class="lineno"> 1861</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ab1c204db4a5056621de299a9dd663c6f">resetHostPlatoon</a>(); <span class="comment">//ASSUMES host is a solo joiner</span></div>
<div class="line"><span class="lineno"> 1862</span> </div>
<div class="line"><span class="lineno"> 1863</span>            <span class="comment">// return to leader state as a solo vehicle</span></div>
<div class="line"><span class="lineno"> 1864</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> = <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa57f78e815f4fc2ac271a9fd85cd80ebc">PlatoonState::LEADER</a>;</div>
<div class="line"><span class="lineno"> 1865</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217a5d88dd49037ae721095d111b8ee630d5">MobilityRequestResponse::NACK</a>;</div>
<div class="line"><span class="lineno"> 1866</span>        }</div>
<div class="line"><span class="lineno"> 1867</span>    }</div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_a05732c5f9b2d8f5d2c66d1cdcf793854"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a05732c5f9b2d8f5d2c66d1cdcf793854">platoon_strategic_ihp::PlatoonManager::platoonLeaderID</a></div><div class="ttdeci">std::string platoonLeaderID</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00367">platoon_manager_ihp.h:367</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_ab1c204db4a5056621de299a9dd663c6f"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ab1c204db4a5056621de299a9dd663c6f">platoon_strategic_ihp::PlatoonManager::resetHostPlatoon</a></div><div class="ttdeci">void resetHostPlatoon()</div><div class="ttdoc">Resets all variables that might indicate other members of the host's platoon; sets the host back to s...</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00295">platoon_manager_ihp.cpp:295</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_af2f0d9818d07db4a4df484f988635201"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#af2f0d9818d07db4a4df484f988635201">platoon_strategic_ihp::PlatoonManager::clearActionPlan</a></div><div class="ttdeci">void clearActionPlan()</div><div class="ttdoc">Resets necessary variables to indicate that the current ActionPlan is dead.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00285">platoon_manager_ihp.cpp:285</a></div></div>
<div class="ttc" id="astructplatoon__strategic__ihp_1_1ActionPlan_html_a38851b8c1a54cc039c86fa3576c940e4"><div class="ttname"><a href="structplatoon__strategic__ihp_1_1ActionPlan.html#a38851b8c1a54cc039c86fa3576c940e4">platoon_strategic_ihp::ActionPlan::peerId</a></div><div class="ttdeci">std::string peerId</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00050">platoon_manager_ihp.h:50</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__manager__ihp_8h_source.html#l00066">platoon_strategic_ihp::ACK</a>, <a class="el" href="platoon__manager__ihp_8cpp_source.html#l00285">platoon_strategic_ihp::PlatoonManager::clearActionPlan()</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00318">config_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00332">current_crosstrack_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00376">platoon_strategic_ihp::PlatoonManager::current_plan</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00370">platoon_strategic_ihp::PlatoonManager::current_platoon_state</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00252">ecef_to_map_point()</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00080">platoon_strategic_ihp::LEADER</a>, <a class="el" href="platoon__config__ihp_8h_source.html#l00062">platoon_strategic_ihp::PlatoonPluginConfig::maxCrosstrackError</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00067">platoon_strategic_ihp::NACK</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00050">platoon_strategic_ihp::ActionPlan::peerId</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00367">platoon_strategic_ihp::PlatoonManager::platoonLeaderID</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00817">pm_</a>, <a class="el" href="platoon__manager__ihp_8cpp_source.html#l00295">platoon_strategic_ihp::PlatoonManager::resetHostPlatoon()</a>, <a class="el" href="platoon__manager__ihp_8cpp_source.html#l00313">platoon_strategic_ihp::PlatoonManager::resetNeighborPlatoon()</a>, <a class="el" href="platoon__config__ihp_8h_source.html#l00068">platoon_strategic_ihp::PlatoonPluginConfig::vehicleID</a>, and <a class="el" href="platoon__strategic__ihp_8h_source.html#l00315">wm_</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01354">handle_mob_req()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a90514428edda23566362c1a60dc01448_cgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a90514428edda23566362c1a60dc01448_cgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a90514428edda23566362c1a60dc01448_cgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a90514428edda23566362c1a60dc01448_cgraph">
<area shape="rect" title="Function to process mobility request in candidateleader state." alt="" coords="5,110,203,166"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#af2f0d9818d07db4a4df484f988635201" title="Resets necessary variables to indicate that the current ActionPlan is dead." alt="" coords="251,5,469,47"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a876cee27af19b1f215ffd4a2190be371" title="Function to convert ecef location to a 2d point in map frame." alt="" coords="269,70,451,126"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ab1c204db4a5056621de299a9dd663c6f" title="Resets all variables that might indicate other members of the host&#39;s platoon; sets the host back to s..." alt="" coords="267,150,453,206"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#abca93088e8980c97a1a24c4fff31c758" title="Resets all variables that describe a neighbor platoon, so that no neighbor is known." alt="" coords="255,230,465,286"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a90514428edda23566362c1a60dc01448_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a90514428edda23566362c1a60dc01448_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a90514428edda23566362c1a60dc01448_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a90514428edda23566362c1a60dc01448_icgraph">
<area shape="rect" title="Function to process mobility request in candidateleader state." alt="" coords="660,5,857,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a53cc42ead95e9734805f4b52de1e38eb" title="Function to the process and respond to the mobility request." alt="" coords="429,5,612,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a588b379b14e20af4e05cf4883c535c5a" title="Callback function for Mobility Request Message." alt="" coords="199,5,381,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,5,151,61"/>
</map>
</div>

</div>
</div>
<a id="a274f5abfcee68012ec00bfe4f8a7c21e" name="a274f5abfcee68012ec00bfe4f8a7c21e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a274f5abfcee68012ec00bfe4f8a7c21e">&#9670;&nbsp;</a></span>mob_req_cb_follower()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217">MobilityRequestResponse</a> platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_req_cb_follower </td>
          <td>(</td>
          <td class="paramtype">const carma_v2x_msgs::msg::MobilityRequest &amp;&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to process mobility request in follower state. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>incoming mobility request</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ACK, NACK, or No response </dd></dl>
<p >For cut-in join, the gap rear vehicle need to slow down once they received the request from platoon leader. Note:1. (cut-in) When joiner is in position, the leader will send the request to relevent platoon member. So no need to check for "in-position" one more time.</p><ol type="1">
<li>(cut-in) If a new member is added in middle, "mob_op_cb_STATUS" will update and resort all vehicle information. So the ordering of the platoon can be updated.</li>
<li>(depart) If the current leader is departing, the closest follower (i.e., 2nd in platoon) will become the new leader, and switch to candidate follower state. While the previous leader depart and operating in single leader state.</li>
</ol>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01428">1428</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1429</span>    {</div>
<div class="line"><span class="lineno"> 1440</span>        carma_v2x_msgs::msg::PlanType plan_type = msg.plan_type;</div>
<div class="line"><span class="lineno"> 1441</span>        std::string reccipientID = msg.m_header.recipient_id;</div>
<div class="line"><span class="lineno"> 1442</span>        std::string reqSenderID = msg.m_header.sender_id;</div>
<div class="line"><span class="lineno"> 1443</span> </div>
<div class="line"><span class="lineno"> 1444</span>        <span class="comment">// Check joining plan type.</span></div>
<div class="line"><span class="lineno"> 1445</span>        <span class="keywordtype">bool</span> isCutInJoin = plan_type.type == carma_v2x_msgs::msg::PlanType::PLATOON_CUT_IN_JOIN;</div>
<div class="line"><span class="lineno"> 1446</span>        <span class="keywordtype">bool</span> isGapCreated = plan_type.type == carma_v2x_msgs::msg::PlanType::STOP_CREATE_GAP;</div>
<div class="line"><span class="lineno"> 1447</span>        <span class="comment">// TODO: Place holder for departure</span></div>
<div class="line"><span class="lineno"> 1448</span> </div>
<div class="line"><span class="lineno"> 1449</span>        <span class="comment">// Check if host is intended recipient </span></div>
<div class="line"><span class="lineno"> 1450</span>        <span class="keywordtype">bool</span> isHostRecipent = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ae696d79ca33f496082ef462fdc9ba53b">getHostStaticID</a>() == reccipientID;</div>
<div class="line"><span class="lineno"> 1451</span> </div>
<div class="line"><span class="lineno"> 1452</span>        <span class="keywordflow">if</span> (isCutInJoin &amp;&amp; isHostRecipent)</div>
<div class="line"><span class="lineno"> 1453</span>        {</div>
<div class="line"><span class="lineno"> 1454</span>            <span class="comment">// Read requesting vehicle&#39;s joining index</span></div>
<div class="line"><span class="lineno"> 1455</span>            std::string strategyParams = msg.strategy_params;</div>
<div class="line"><span class="lineno"> 1456</span>            std::vector&lt;std::string&gt; inputsParams;</div>
<div class="line"><span class="lineno"> 1457</span>            <a class="code hl_variable" href="namespaceprocess__traj__logs.html#a3682477a3431f2a4aa182fb9a6439125">boost::algorithm::split</a>(inputsParams, strategyParams, boost::is_any_of(<span class="stringliteral">&quot;,&quot;</span>));</div>
<div class="line"><span class="lineno"> 1458</span>            std::vector&lt;std::string&gt; join_index_parsed;</div>
<div class="line"><span class="lineno"> 1459</span>            <a class="code hl_variable" href="namespaceprocess__traj__logs.html#a3682477a3431f2a4aa182fb9a6439125">boost::algorithm::split</a>(join_index_parsed, inputsParams[5], boost::is_any_of(<span class="stringliteral">&quot;:&quot;</span>));</div>
<div class="line"><span class="lineno"> 1460</span>            <span class="keywordtype">int</span> req_sender_join_index = std::stoi(join_index_parsed[1]);</div>
<div class="line"><span class="lineno"> 1461</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Requesting join_index parsed: &quot;</span> &lt;&lt; req_sender_join_index);</div>
<div class="line"><span class="lineno"> 1462</span>        </div>
<div class="line"><span class="lineno"> 1463</span>            <span class="comment">// Control vehicle speed based on cut-in type</span></div>
<div class="line"><span class="lineno"> 1464</span>            <span class="comment">// 1. cut-in from rear</span></div>
<div class="line"><span class="lineno"> 1465</span>            <span class="keywordflow">if</span> (<span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(req_sender_join_index) == <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>.size()-1)</div>
<div class="line"><span class="lineno"> 1466</span>            {</div>
<div class="line"><span class="lineno"> 1467</span>                <span class="comment">// Accept plan and idle (becasue rear join, gap leading vehicle do not need to slow down).</span></div>
<div class="line"><span class="lineno"> 1468</span>                RCLCPP_WARN(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>),<span class="stringliteral">&quot;Requested cut-in from rear, start approve cut-in and wait for lane change.&quot;</span>);</div>
<div class="line"><span class="lineno"> 1469</span>                RCLCPP_WARN(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>),<span class="stringliteral">&quot;Due to the rear join nature, there is no need to slow down or create gap.&quot;</span>);</div>
<div class="line"><span class="lineno"> 1470</span>                <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217a62e4d1cf02b4cfa5752c7c3dfd75cd03">MobilityRequestResponse::ACK</a>;</div>
<div class="line"><span class="lineno"> 1471</span> </div>
<div class="line"><span class="lineno"> 1472</span>            }</div>
<div class="line"><span class="lineno"> 1473</span>            <span class="comment">// 2. cut-in from middle </span></div>
<div class="line"><span class="lineno"> 1474</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (req_sender_join_index &gt;= 0  &amp;&amp;  <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(req_sender_join_index) &lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>.size()-1)</div>
<div class="line"><span class="lineno"> 1475</span>            {   </div>
<div class="line"><span class="lineno"> 1476</span>                <span class="comment">// Accept plan and slow down to create gap.</span></div>
<div class="line"><span class="lineno"> 1477</span>                <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0dfb4a15be2cf69ca770fcde1bdf65f5">isCreateGap</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1478</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Requested cut-in index is: &quot;</span> &lt;&lt; req_sender_join_index &lt;&lt; <span class="stringliteral">&quot;, approve cut-in and start create gap.&quot;</span>);</div>
<div class="line"><span class="lineno"> 1479</span>                <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217a62e4d1cf02b4cfa5752c7c3dfd75cd03">MobilityRequestResponse::ACK</a>;</div>
<div class="line"><span class="lineno"> 1480</span>            }</div>
<div class="line"><span class="lineno"> 1481</span>            <span class="comment">// 3. Abnormal join index</span></div>
<div class="line"><span class="lineno"> 1482</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1483</span>            {</div>
<div class="line"><span class="lineno"> 1484</span>                <span class="comment">// Note: Leader will abort plan if reponse is not ACK for plantype &quot;PLATOON_CUT_IN_JOIN&quot;.</span></div>
<div class="line"><span class="lineno"> 1485</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Abnormal cut-in index, abort operation.&quot;</span>);</div>
<div class="line"><span class="lineno"> 1486</span>                <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217a5d88dd49037ae721095d111b8ee630d5">MobilityRequestResponse::NACK</a>;</div>
<div class="line"><span class="lineno"> 1487</span>            }</div>
<div class="line"><span class="lineno"> 1488</span>        }</div>
<div class="line"><span class="lineno"> 1489</span>        </div>
<div class="line"><span class="lineno"> 1490</span> </div>
<div class="line"><span class="lineno"> 1491</span>        <span class="comment">// 4. Reset to normal speed once the gap is created.</span></div>
<div class="line"><span class="lineno"> 1492</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isGapCreated)</div>
<div class="line"><span class="lineno"> 1493</span>        {</div>
<div class="line"><span class="lineno"> 1494</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Gap is created, revert to normal operating speed.&quot;</span>);</div>
<div class="line"><span class="lineno"> 1495</span>            <span class="comment">// Only reset create gap indicator, no need to send response. </span></div>
<div class="line"><span class="lineno"> 1496</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0dfb4a15be2cf69ca770fcde1bdf65f5">isCreateGap</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1497</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217a1aabdeebf3169c8d6a5a56d627286f48">MobilityRequestResponse::NO_RESPONSE</a>;</div>
<div class="line"><span class="lineno"> 1498</span>        }</div>
<div class="line"><span class="lineno"> 1499</span> </div>
<div class="line"><span class="lineno"> 1500</span>        <span class="comment">// 5. Place holder for departure (host is follower)</span></div>
<div class="line"><span class="lineno"> 1501</span> </div>
<div class="line"><span class="lineno"> 1502</span>        <span class="comment">// 6. Same-lane join, no need to respond.</span></div>
<div class="line"><span class="lineno"> 1503</span>        <span class="keywordflow">else</span> </div>
<div class="line"><span class="lineno"> 1504</span>        {</div>
<div class="line"><span class="lineno"> 1505</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217a1aabdeebf3169c8d6a5a56d627286f48">MobilityRequestResponse::NO_RESPONSE</a>;</div>
<div class="line"><span class="lineno"> 1506</span>        }</div>
<div class="line"><span class="lineno"> 1507</span>    }</div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_ae696d79ca33f496082ef462fdc9ba53b"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ae696d79ca33f496082ef462fdc9ba53b">platoon_strategic_ihp::PlatoonManager::getHostStaticID</a></div><div class="ttdeci">std::string getHostStaticID() const</div><div class="ttdoc">Returns current host static ID as a string.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00756">platoon_manager_ihp.cpp:756</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__manager__ihp_8h_source.html#l00066">platoon_strategic_ihp::ACK</a>, <a class="el" href="platoon__manager__ihp_8cpp_source.html#l00756">platoon_strategic_ihp::PlatoonManager::getHostStaticID()</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00361">platoon_strategic_ihp::PlatoonManager::host_platoon_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00407">platoon_strategic_ihp::PlatoonManager::isCreateGap</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00067">platoon_strategic_ihp::NACK</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00068">platoon_strategic_ihp::NO_RESPONSE</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00817">pm_</a>, and <a class="el" href="process__traj__logs_8py_source.html#l00165">process_traj_logs::split</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01354">handle_mob_req()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a274f5abfcee68012ec00bfe4f8a7c21e_cgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a274f5abfcee68012ec00bfe4f8a7c21e_cgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a274f5abfcee68012ec00bfe4f8a7c21e_cgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a274f5abfcee68012ec00bfe4f8a7c21e_cgraph">
<area shape="rect" title="Function to process mobility request in follower state." alt="" coords="5,5,188,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ae696d79ca33f496082ef462fdc9ba53b" title="Returns current host static ID as a string." alt="" coords="236,13,457,54"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a274f5abfcee68012ec00bfe4f8a7c21e_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a274f5abfcee68012ec00bfe4f8a7c21e_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a274f5abfcee68012ec00bfe4f8a7c21e_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a274f5abfcee68012ec00bfe4f8a7c21e_icgraph">
<area shape="rect" title="Function to process mobility request in follower state." alt="" coords="660,5,843,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a53cc42ead95e9734805f4b52de1e38eb" title="Function to the process and respond to the mobility request." alt="" coords="429,5,612,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a588b379b14e20af4e05cf4883c535c5a" title="Callback function for Mobility Request Message." alt="" coords="199,5,381,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,5,151,61"/>
</map>
</div>

</div>
</div>
<a id="a5776b135d1c58b8224763c05d64fa440" name="a5776b135d1c58b8224763c05d64fa440"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5776b135d1c58b8224763c05d64fa440">&#9670;&nbsp;</a></span>mob_req_cb_leader()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217">MobilityRequestResponse</a> platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_req_cb_leader </td>
          <td>(</td>
          <td class="paramtype">const carma_v2x_msgs::msg::MobilityRequest &amp;&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to process mobility request in leader state. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>incoming mobility request</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ACK, NACK, or No response </dd></dl>
<p >UCLA implementation note:</p><ol type="1">
<li>Here the mobility requests of joining platoon (front and rear) get processed and responded.<ol type="a">
<li>The host is the leader of the existing platoon or single vehicle in default leader state.</li>
<li>Request sender is the joiner.</li>
<li>when two single vehicle meet, only allow backjoin.</li>
</ol>
</li>
</ol>
<p >Note: For front and rear jon, the JOIN_PARAMS format: JOIN_PARAMS| --&gt; "SIZE:%1%,SPEED:%2%,ECEFX:%3%,ECEFY:%4%,ECEFZ:%5%,JOINIDX:%6%" |----&mdash;0---&mdash; &ndash;1------&mdash;2------&mdash;3------&mdash;4-------&mdash;5----&mdash;| <br  />
</p>
<p >Note: JOIN_FROM_FRONT indicate a same-lane front join. JOIN_PLATOON_AT_REAR indicate a same-lane rear join. PLATOON_CUT_IN_JOIN indicate a cut-in join, which include three cut-in methods: cut-in front, cut-in middle, and cut-in rear.</p>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01571">1571</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1572</span>    {   </div>
<div class="line"><span class="lineno"> 1585</span>        <span class="comment">// Check joining plan type.</span></div>
<div class="line"><span class="lineno"> 1586</span>        carma_v2x_msgs::msg::PlanType plan_type = msg.plan_type;</div>
<div class="line"><span class="lineno"> 1593</span>        <span class="keywordtype">bool</span> isFrontJoin = plan_type.type == carma_v2x_msgs::msg::PlanType::JOIN_PLATOON_FROM_FRONT;</div>
<div class="line"><span class="lineno"> 1594</span>        <span class="keywordtype">bool</span> isRearJoin = plan_type.type == carma_v2x_msgs::msg::PlanType::JOIN_PLATOON_AT_REAR;</div>
<div class="line"><span class="lineno"> 1595</span>        <span class="keywordtype">bool</span> isCutInJoin = plan_type.type == carma_v2x_msgs::msg::PlanType::PLATOON_CUT_IN_JOIN;</div>
<div class="line"><span class="lineno"> 1596</span>        <span class="keywordtype">bool</span> isDepart = (plan_type.type == carma_v2x_msgs::msg::PlanType::PLATOON_DEPARTURE);</div>
<div class="line"><span class="lineno"> 1597</span> </div>
<div class="line"><span class="lineno"> 1598</span>        <span class="comment">// Ignore the request if we are already working with a join/departure process or if no join type was requested (prevents multiple applicants)</span></div>
<div class="line"><span class="lineno"> 1599</span>        <span class="keywordflow">if</span> (isFrontJoin  ||  isRearJoin  ||  isCutInJoin  ||  isDepart)</div>
<div class="line"><span class="lineno"> 1600</span>        {</div>
<div class="line"><span class="lineno"> 1601</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a9474313cd68557978e8dbd481d0408bc">valid</a>){</div>
<div class="line"><span class="lineno"> 1602</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Ignoring incoming request since we are already negotiating a join.&quot;</span>);</div>
<div class="line"><span class="lineno"> 1603</span>                <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217a1aabdeebf3169c8d6a5a56d627286f48">MobilityRequestResponse::NO_RESPONSE</a>; <span class="comment">//TODO: replace with NACK that indicates to ask me later</span></div>
<div class="line"><span class="lineno"> 1604</span>            }</div>
<div class="line"><span class="lineno"> 1605</span>        }</div>
<div class="line"><span class="lineno"> 1606</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1607</span>        {</div>
<div class="line"><span class="lineno"> 1608</span>            RCLCPP_WARN_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Received request with bogus message type &quot;</span> &lt;&lt; plan_type.type &lt;&lt; <span class="stringliteral">&quot;; ignoring&quot;</span>);</div>
<div class="line"><span class="lineno"> 1609</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217a1aabdeebf3169c8d6a5a56d627286f48">MobilityRequestResponse::NO_RESPONSE</a>;</div>
<div class="line"><span class="lineno"> 1610</span>        }</div>
<div class="line"><span class="lineno"> 1611</span> </div>
<div class="line"><span class="lineno"> 1612</span>        <span class="comment">// TODO: Generalize - We currently ignore the lane information for now and assume the applicant is in the same lane with us.</span></div>
<div class="line"><span class="lineno"> 1613</span>        <span class="comment">// Determine intra-platoon conditions</span></div>
<div class="line"><span class="lineno"> 1614</span>        <span class="comment">// We are currently checking two basic JOIN conditions:</span></div>
<div class="line"><span class="lineno"> 1615</span>        <span class="comment">//     1. The size limitation on current platoon based on the plugin&#39;s parameters.</span></div>
<div class="line"><span class="lineno"> 1616</span>        <span class="comment">//     2. Calculate how long that vehicle can be in a reasonable distance to actually join us.</span></div>
<div class="line"><span class="lineno"> 1617</span>        carma_v2x_msgs::msg::MobilityHeader msgHeader = msg.m_header;</div>
<div class="line"><span class="lineno"> 1618</span>        std::string params = msg.strategy_params;</div>
<div class="line"><span class="lineno"> 1619</span>        std::string applicantId = msgHeader.sender_id;</div>
<div class="line"><span class="lineno"> 1620</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Received mobility JOIN request from &quot;</span> &lt;&lt; applicantId &lt;&lt; <span class="stringliteral">&quot; and PlanId = &quot;</span> &lt;&lt; msgHeader.plan_id);</div>
<div class="line"><span class="lineno"> 1621</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;The strategy parameters are &quot;</span> &lt;&lt; params);</div>
<div class="line"><span class="lineno"> 1622</span>        <span class="keywordflow">if</span> (params.length() == 0)</div>
<div class="line"><span class="lineno"> 1623</span>        {</div>
<div class="line"><span class="lineno"> 1624</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;The strategy parameters are empty, return no response&quot;</span>);</div>
<div class="line"><span class="lineno"> 1625</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217a1aabdeebf3169c8d6a5a56d627286f48">MobilityRequestResponse::NO_RESPONSE</a>;</div>
<div class="line"><span class="lineno"> 1626</span>        }</div>
<div class="line"><span class="lineno"> 1627</span> </div>
<div class="line"><span class="lineno"> 1628</span>        <span class="comment">// The incoming message is &quot;mobility Request&quot;, which has a location category.</span></div>
<div class="line"><span class="lineno"> 1629</span>        std::vector&lt;std::string&gt; inputsParams;</div>
<div class="line"><span class="lineno"> 1630</span>        <a class="code hl_variable" href="namespaceprocess__traj__logs.html#a3682477a3431f2a4aa182fb9a6439125">boost::algorithm::split</a>(inputsParams, params, boost::is_any_of(<span class="stringliteral">&quot;,&quot;</span>));</div>
<div class="line"><span class="lineno"> 1631</span> </div>
<div class="line"><span class="lineno"> 1632</span>        <span class="comment">// Parse applicantSize</span></div>
<div class="line"><span class="lineno"> 1633</span>        std::vector&lt;std::string&gt; applicantSize_parsed;</div>
<div class="line"><span class="lineno"> 1634</span>        <a class="code hl_variable" href="namespaceprocess__traj__logs.html#a3682477a3431f2a4aa182fb9a6439125">boost::algorithm::split</a>(applicantSize_parsed, inputsParams[0], boost::is_any_of(<span class="stringliteral">&quot;:&quot;</span>));</div>
<div class="line"><span class="lineno"> 1635</span>        <span class="keywordtype">int</span> applicantSize = std::stoi(applicantSize_parsed[1]);</div>
<div class="line"><span class="lineno"> 1636</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;applicantSize: &quot;</span> &lt;&lt; applicantSize);</div>
<div class="line"><span class="lineno"> 1637</span> </div>
<div class="line"><span class="lineno"> 1638</span>        <span class="comment">// Parse applicant Current Speed in m/s</span></div>
<div class="line"><span class="lineno"> 1639</span>        std::vector&lt;std::string&gt; applicantCurrentSpeed_parsed;</div>
<div class="line"><span class="lineno"> 1640</span>        <a class="code hl_variable" href="namespaceprocess__traj__logs.html#a3682477a3431f2a4aa182fb9a6439125">boost::algorithm::split</a>(applicantCurrentSpeed_parsed, inputsParams[1], boost::is_any_of(<span class="stringliteral">&quot;:&quot;</span>));</div>
<div class="line"><span class="lineno"> 1641</span>        <span class="keywordtype">double</span> applicantCurrentSpeed = std::stod(applicantCurrentSpeed_parsed[1]);</div>
<div class="line"><span class="lineno"> 1642</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;applicantCurrentSpeed: &quot;</span> &lt;&lt; applicantCurrentSpeed);</div>
<div class="line"><span class="lineno"> 1643</span> </div>
<div class="line"><span class="lineno"> 1644</span>        <span class="comment">// Calculate downtrack (m) based on incoming pose. </span></div>
<div class="line"><span class="lineno"> 1645</span>        lanelet::BasicPoint2d incoming_pose = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a876cee27af19b1f215ffd4a2190be371">ecef_to_map_point</a>(msg.location);</div>
<div class="line"><span class="lineno"> 1646</span>        <span class="keywordtype">double</span> applicantCurrentDtd = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae65a18d1f14ecdfae3409e47e59a1031">wm_</a>-&gt;routeTrackPos(incoming_pose).downtrack;</div>
<div class="line"><span class="lineno"> 1647</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;applicantCurrentmemberUpdates from ecef pose: &quot;</span> &lt;&lt; applicantCurrentDtd);</div>
<div class="line"><span class="lineno"> 1648</span> </div>
<div class="line"><span class="lineno"> 1649</span>        <span class="comment">// Calculate crosstrack (m) based on incoming pose. </span></div>
<div class="line"><span class="lineno"> 1650</span>        <span class="keywordtype">double</span> applicantCurrentCtd = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae65a18d1f14ecdfae3409e47e59a1031">wm_</a>-&gt;routeTrackPos(incoming_pose).crosstrack;</div>
<div class="line"><span class="lineno"> 1651</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;applicantCurrentCtd from ecef pose: &quot;</span> &lt;&lt; applicantCurrentCtd);</div>
<div class="line"><span class="lineno"> 1652</span>        <span class="keywordtype">bool</span> isInLane = abs(applicantCurrentCtd - <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a79aaef859aaa4b64f6cf79c50c596bc3">current_crosstrack_</a>) &lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a3c2aa8b4742ba50d80bc9c23ed183ebf">maxCrosstrackError</a>;</div>
<div class="line"><span class="lineno"> 1653</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;isInLane = &quot;</span> &lt;&lt; isInLane);</div>
<div class="line"><span class="lineno"> 1654</span>        </div>
<div class="line"><span class="lineno"> 1655</span>        <span class="comment">// Check if we have enough room for that applicant</span></div>
<div class="line"><span class="lineno"> 1656</span>        <span class="keywordtype">int</span> currentPlatoonSize = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a3ef30eeb7a7cf0caccb948e6a41f92">getHostPlatoonSize</a>();</div>
<div class="line"><span class="lineno"> 1657</span>        <span class="keywordtype">bool</span> hasEnoughRoomInPlatoon = applicantSize + currentPlatoonSize &lt;= <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a3e37e742ba6eab41498ab7da49abef91">maxPlatoonSize</a>;</div>
<div class="line"><span class="lineno"> 1658</span> </div>
<div class="line"><span class="lineno"> 1659</span>        <span class="comment">// rear join; platoon leader --&gt; leader waiting</span></div>
<div class="line"><span class="lineno"> 1660</span>        <span class="keywordflow">if</span> (isRearJoin)</div>
<div class="line"><span class="lineno"> 1661</span>        {</div>
<div class="line"><span class="lineno"> 1662</span>            <span class="comment">// Log the request  type</span></div>
<div class="line"><span class="lineno"> 1663</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;The received mobility JOIN request from &quot;</span> &lt;&lt; applicantId &lt;&lt; <span class="stringliteral">&quot; and PlanId = &quot;</span> &lt;&lt; msgHeader.plan_id &lt;&lt; <span class="stringliteral">&quot; is a same-lane REAR-JOIN request !&quot;</span>);</div>
<div class="line"><span class="lineno"> 1664</span> </div>
<div class="line"><span class="lineno"> 1665</span>            <span class="comment">// -- core condition to decided accept joiner or not</span></div>
<div class="line"><span class="lineno"> 1666</span>            <span class="keywordflow">if</span> (hasEnoughRoomInPlatoon &amp;&amp; isInLane) </div>
<div class="line"><span class="lineno"> 1667</span>            {</div>
<div class="line"><span class="lineno"> 1668</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;The current platoon has enough room for the applicant with size &quot;</span> &lt;&lt; applicantSize);</div>
<div class="line"><span class="lineno"> 1669</span>                <span class="keywordtype">double</span> currentRearDtd = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a83ecd30ec7e2f7eb15c93075c8eca436">getPlatoonRearDowntrackDistance</a>();</div>
<div class="line"><span class="lineno"> 1670</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;The current platoon rear dtd is &quot;</span> &lt;&lt; currentRearDtd);</div>
<div class="line"><span class="lineno"> 1671</span>                <span class="keywordtype">double</span> currentGap = currentRearDtd - applicantCurrentDtd - <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#ae1ec2bca75a9c7f5c9f2855007f48fba">vehicleLength</a>;</div>
<div class="line"><span class="lineno"> 1672</span>                <span class="keywordtype">double</span> currentTimeGap = currentGap / applicantCurrentSpeed;</div>
<div class="line"><span class="lineno"> 1673</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;The gap between current platoon rear and applicant is &quot;</span> &lt;&lt; currentGap &lt;&lt; <span class="stringliteral">&quot;m or &quot;</span> &lt;&lt; currentTimeGap &lt;&lt; <span class="stringliteral">&quot;s&quot;</span>);</div>
<div class="line"><span class="lineno"> 1674</span>                <span class="keywordflow">if</span> (currentGap &lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#ad3c1054a6d0028028bddb5019cd4738f">minAllowedJoinGap</a>) </div>
<div class="line"><span class="lineno"> 1675</span>                {</div>
<div class="line"><span class="lineno"> 1676</span>                    RCLCPP_WARN(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>),<span class="stringliteral">&quot;We should not receive any request from the vehicle in front of us. NACK it.&quot;</span>);</div>
<div class="line"><span class="lineno"> 1677</span>                    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217a5d88dd49037ae721095d111b8ee630d5">MobilityRequestResponse::NACK</a>;</div>
<div class="line"><span class="lineno"> 1678</span>                }</div>
<div class="line"><span class="lineno"> 1679</span>                </div>
<div class="line"><span class="lineno"> 1680</span>                <span class="comment">// Check if the applicant can join based on max timeGap/gap</span></div>
<div class="line"><span class="lineno"> 1681</span>                <span class="keywordtype">bool</span> isDistanceCloseEnough = currentGap &lt;= <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#adfa90129270c151fd23cf1db61ef0cf8">maxAllowedJoinGap</a>  ||  currentTimeGap &lt;= <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a4286c4fbb2a6d0f34ff38ae89d78a53d">maxAllowedJoinTimeGap</a>;</div>
<div class="line"><span class="lineno"> 1682</span>                <span class="keywordflow">if</span> (isDistanceCloseEnough) </div>
<div class="line"><span class="lineno"> 1683</span>                {</div>
<div class="line"><span class="lineno"> 1684</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;The applicant is close enough and we will allow it to try to join&quot;</span>);</div>
<div class="line"><span class="lineno"> 1685</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Change to LeaderWaitingState and waiting for &quot;</span> &lt;&lt; msg.m_header.sender_id &lt;&lt; <span class="stringliteral">&quot; to join&quot;</span>);</div>
<div class="line"><span class="lineno"> 1686</span> </div>
<div class="line"><span class="lineno"> 1687</span>                    <span class="comment">// change state to leaderwaiting !</span></div>
<div class="line"><span class="lineno"> 1688</span>                    <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> = <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa70d610aa504abb163caf9a5ee931d090">PlatoonState::LEADERWAITING</a>;</div>
<div class="line"><span class="lineno"> 1689</span>                    <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a935cc1406e4a80f9f44669167e43f815">waitingStartTime</a> = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a283186f2bbb98f5f85b5486e365bb4b8">timer_factory_</a>-&gt;now().nanoseconds() / 1000000;</div>
<div class="line"><span class="lineno"> 1690</span>                    <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a> = ActionPlan(<span class="keyword">true</span>, <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a935cc1406e4a80f9f44669167e43f815">waitingStartTime</a>, msgHeader.plan_id, applicantId);</div>
<div class="line"><span class="lineno"> 1691</span>                    <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a05732c5f9b2d8f5d2c66d1cdcf793854">platoonLeaderID</a> = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a54c4103e4b8705ee687effb030fb7040">HostMobilityId</a>;</div>
<div class="line"><span class="lineno"> 1692</span>                    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217a62e4d1cf02b4cfa5752c7c3dfd75cd03">MobilityRequestResponse::ACK</a>;</div>
<div class="line"><span class="lineno"> 1693</span>                }</div>
<div class="line"><span class="lineno"> 1694</span>                <span class="keywordflow">else</span> </div>
<div class="line"><span class="lineno"> 1695</span>                {</div>
<div class="line"><span class="lineno"> 1696</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;The applicant is too far away from us. NACK.&quot;</span>);</div>
<div class="line"><span class="lineno"> 1697</span>                    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217a5d88dd49037ae721095d111b8ee630d5">MobilityRequestResponse::NACK</a>; <span class="comment">//TODO: add reason &amp; request to try again</span></div>
<div class="line"><span class="lineno"> 1698</span>                }</div>
<div class="line"><span class="lineno"> 1699</span>            }</div>
<div class="line"><span class="lineno"> 1700</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1701</span>            {</div>
<div class="line"><span class="lineno"> 1702</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;The current platoon does not have enough room for applicant of size &quot;</span> &lt;&lt; applicantSize &lt;&lt; <span class="stringliteral">&quot;. NACK&quot;</span>);</div>
<div class="line"><span class="lineno"> 1703</span>                <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217a5d88dd49037ae721095d111b8ee630d5">MobilityRequestResponse::NACK</a>;</div>
<div class="line"><span class="lineno"> 1704</span>            }</div>
<div class="line"><span class="lineno"> 1705</span>        }</div>
<div class="line"><span class="lineno"> 1706</span>        </div>
<div class="line"><span class="lineno"> 1707</span>        <span class="comment">// front join; platoon leader --&gt; leader aborting</span></div>
<div class="line"><span class="lineno"> 1708</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isFrontJoin)</div>
<div class="line"><span class="lineno"> 1709</span>        {</div>
<div class="line"><span class="lineno"> 1710</span>            <span class="comment">// Log the request  type</span></div>
<div class="line"><span class="lineno"> 1711</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;The received mobility JOIN request from &quot;</span> &lt;&lt; applicantId &lt;&lt; <span class="stringliteral">&quot; and PlanId = &quot;</span> &lt;&lt; msgHeader.plan_id &lt;&lt; <span class="stringliteral">&quot; is a same-lane FRONT-JOIN request !&quot;</span>);</div>
<div class="line"><span class="lineno"> 1712</span> </div>
<div class="line"><span class="lineno"> 1713</span>            <span class="comment">// -- core condition to decided accept joiner or not</span></div>
<div class="line"><span class="lineno"> 1714</span>            <span class="keywordflow">if</span> (hasEnoughRoomInPlatoon &amp;&amp; isInLane) </div>
<div class="line"><span class="lineno"> 1715</span>            {</div>
<div class="line"><span class="lineno"> 1716</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;The current platoon has enough room for the applicant with size &quot;</span> &lt;&lt; applicantSize);</div>
<div class="line"><span class="lineno"> 1717</span>                </div>
<div class="line"><span class="lineno"> 1718</span>                <span class="comment">// UCLA: change to read platoon front info</span></div>
<div class="line"><span class="lineno"> 1719</span>                <span class="keywordtype">double</span> currentFrontDtd = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#aac57cfc07168101835015859c9c7e48e">getPlatoonFrontDowntrackDistance</a>();</div>
<div class="line"><span class="lineno"> 1720</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;The current platoon front dtd is &quot;</span> &lt;&lt; currentFrontDtd);</div>
<div class="line"><span class="lineno"> 1721</span>                <span class="comment">// UCLA: adjust for calculating gap between new leader and old leader</span></div>
<div class="line"><span class="lineno"> 1722</span>                <span class="keywordtype">double</span> currentGap =  applicantCurrentDtd - currentFrontDtd - <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#ae1ec2bca75a9c7f5c9f2855007f48fba">vehicleLength</a>;</div>
<div class="line"><span class="lineno"> 1723</span>                <span class="keywordtype">double</span> currentTimeGap = currentGap / applicantCurrentSpeed;</div>
<div class="line"><span class="lineno"> 1724</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;The gap between current platoon front and applicant is &quot;</span> &lt;&lt; currentGap &lt;&lt; <span class="stringliteral">&quot;m or &quot;</span> &lt;&lt; currentTimeGap &lt;&lt; <span class="stringliteral">&quot;s&quot;</span>);</div>
<div class="line"><span class="lineno"> 1725</span>                </div>
<div class="line"><span class="lineno"> 1726</span>                <span class="keywordflow">if</span> (currentGap &lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#ad3c1054a6d0028028bddb5019cd4738f">minAllowedJoinGap</a>) </div>
<div class="line"><span class="lineno"> 1727</span>                {</div>
<div class="line"><span class="lineno"> 1728</span>                    RCLCPP_WARN(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>),<span class="stringliteral">&quot;The current time gap is not suitable for frontal join. NACK it.&quot;</span>);</div>
<div class="line"><span class="lineno"> 1729</span>                    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217a5d88dd49037ae721095d111b8ee630d5">MobilityRequestResponse::NACK</a>;</div>
<div class="line"><span class="lineno"> 1730</span>                }</div>
<div class="line"><span class="lineno"> 1731</span> </div>
<div class="line"><span class="lineno"> 1732</span>                <span class="comment">// Check if the applicant can join based on max timeGap/gap</span></div>
<div class="line"><span class="lineno"> 1733</span>                <span class="keywordtype">bool</span> isDistanceCloseEnough = currentGap &lt;= <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#adfa90129270c151fd23cf1db61ef0cf8">maxAllowedJoinGap</a>  ||  currentTimeGap &lt;= <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a4286c4fbb2a6d0f34ff38ae89d78a53d">maxAllowedJoinTimeGap</a>;</div>
<div class="line"><span class="lineno"> 1734</span> </div>
<div class="line"><span class="lineno"> 1735</span>                <span class="comment">// UCLA: add condition: only allow front join when host platoon size &gt;= 2 (make sure when two single vehicle join, only use back join)</span></div>
<div class="line"><span class="lineno"> 1736</span>                <span class="keywordtype">bool</span> isPlatoonNotSingle = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a3ef30eeb7a7cf0caccb948e6a41f92">getHostPlatoonSize</a>() &gt;= 2 || <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#ab266d02c1852c6a1a2bff65a5e0d78b0">test_front_join</a>;</div>
<div class="line"><span class="lineno"> 1737</span> </div>
<div class="line"><span class="lineno"> 1738</span>                <span class="keywordflow">if</span> (isDistanceCloseEnough &amp;&amp; isPlatoonNotSingle) </div>
<div class="line"><span class="lineno"> 1739</span>                {</div>
<div class="line"><span class="lineno"> 1740</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;The applicant is close enough for frontal join, send acceptance response&quot;</span>);</div>
<div class="line"><span class="lineno"> 1741</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Change to LeaderAborting state and waiting for &quot;</span> &lt;&lt; msg.m_header.sender_id &lt;&lt; <span class="stringliteral">&quot; to join as the new platoon leader&quot;</span>);</div>
<div class="line"><span class="lineno"> 1742</span> </div>
<div class="line"><span class="lineno"> 1743</span>                    <span class="comment">// ----------------- give up leader position and look for new leader --------------------------</span></div>
<div class="line"><span class="lineno"> 1744</span> </div>
<div class="line"><span class="lineno"> 1745</span>                    <span class="comment">// adjust for frontal join. Platoon info is related to the platoon at back of the candidate leader vehicle.</span></div>
<div class="line"><span class="lineno"> 1746</span>                    <span class="comment">// Don&#39;t want an action plan here</span></div>
<div class="line"><span class="lineno"> 1747</span>                    <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> = <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafae176dd79ff2c2bc4b2f7901fbfc53014">PlatoonState::LEADERABORTING</a>;</div>
<div class="line"><span class="lineno"> 1748</span>                    <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa30dd7c98fe60faad9ba8af0da2da581">candidatestateStartTime</a> = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a283186f2bbb98f5f85b5486e365bb4b8">timer_factory_</a>-&gt;now().nanoseconds() / 1000000;</div>
<div class="line"><span class="lineno"> 1749</span> </div>
<div class="line"><span class="lineno"> 1750</span>                    <span class="comment">// If we are testing with a single vehicle representing this platoon, then we don&#39;t yet have a platoon ID,</span></div>
<div class="line"><span class="lineno"> 1751</span>                    <span class="comment">// so use the ID for the proposed joining action plan</span></div>
<div class="line"><span class="lineno"> 1752</span>                    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#ab266d02c1852c6a1a2bff65a5e0d78b0">test_front_join</a>)</div>
<div class="line"><span class="lineno"> 1753</span>                    {</div>
<div class="line"><span class="lineno"> 1754</span>                        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a634f99de503cccb2f2d3cb955623dde2">currentPlatoonID</a> = msgHeader.plan_id;</div>
<div class="line"><span class="lineno"> 1755</span>                    }</div>
<div class="line"><span class="lineno"> 1756</span> </div>
<div class="line"><span class="lineno"> 1757</span>                    <span class="comment">// Store the leader ID as that of the joiner to allow run_leader_aborting to work correctly</span></div>
<div class="line"><span class="lineno"> 1758</span>                    <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a05732c5f9b2d8f5d2c66d1cdcf793854">platoonLeaderID</a> = applicantId;</div>
<div class="line"><span class="lineno"> 1759</span> </div>
<div class="line"><span class="lineno"> 1760</span>                    <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a935cc1406e4a80f9f44669167e43f815">waitingStartTime</a> = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a283186f2bbb98f5f85b5486e365bb4b8">timer_factory_</a>-&gt;now().nanoseconds() / 1000000;</div>
<div class="line"><span class="lineno"> 1761</span>                    <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a9474313cd68557978e8dbd481d0408bc">valid</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1762</span>                    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217a62e4d1cf02b4cfa5752c7c3dfd75cd03">MobilityRequestResponse::ACK</a>;</div>
<div class="line"><span class="lineno"> 1763</span>                }</div>
<div class="line"><span class="lineno"> 1764</span>                <span class="keywordflow">else</span> </div>
<div class="line"><span class="lineno"> 1765</span>                {</div>
<div class="line"><span class="lineno"> 1766</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;The joining gap (&quot;</span> &lt;&lt; currentGap &lt;&lt; <span class="stringliteral">&quot; m) is too far away from us or the target platoon size (&quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a3ef30eeb7a7cf0caccb948e6a41f92">getHostPlatoonSize</a>() &lt;&lt; <span class="stringliteral">&quot;) is one. NACK.&quot;</span>);</div>
<div class="line"><span class="lineno"> 1767</span>                    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217a5d88dd49037ae721095d111b8ee630d5">MobilityRequestResponse::NACK</a>;  <span class="comment">//TODO: add reason &amp; request to try again</span></div>
<div class="line"><span class="lineno"> 1768</span>                }</div>
<div class="line"><span class="lineno"> 1769</span>            }</div>
<div class="line"><span class="lineno"> 1770</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1771</span>            {</div>
<div class="line"><span class="lineno"> 1772</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;The current platoon does not have enough room for applicant of size &quot;</span> &lt;&lt; applicantSize &lt;&lt; <span class="stringliteral">&quot;. NACK&quot;</span>);</div>
<div class="line"><span class="lineno"> 1773</span>                <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217a5d88dd49037ae721095d111b8ee630d5">MobilityRequestResponse::NACK</a>;</div>
<div class="line"><span class="lineno"> 1774</span>            }</div>
<div class="line"><span class="lineno"> 1775</span>        }</div>
<div class="line"><span class="lineno"> 1776</span>        </div>
<div class="line"><span class="lineno"> 1777</span>        <span class="comment">// UCLA: conditions for cut-in join; platoon leader --&gt; leading with operation</span></div>
<div class="line"><span class="lineno"> 1778</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isCutInJoin)</div>
<div class="line"><span class="lineno"> 1779</span>        {</div>
<div class="line"><span class="lineno"> 1780</span>            <span class="comment">// Log the request  type</span></div>
<div class="line"><span class="lineno"> 1781</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;The received mobility JOIN request from &quot;</span> &lt;&lt; applicantId &lt;&lt; <span class="stringliteral">&quot; and PlanId = &quot;</span> &lt;&lt; msgHeader.plan_id &lt;&lt; <span class="stringliteral">&quot; is a CUT-IN-JOIN request !&quot;</span>);</div>
<div class="line"><span class="lineno"> 1782</span> </div>
<div class="line"><span class="lineno"> 1783</span>            <span class="comment">// -- core condition to decided accept joiner or not. It is necessary leader only process the first cut-in joining request.</span></div>
<div class="line"><span class="lineno"> 1784</span>            <span class="comment">// Note: The host is the platoon leader, need to use a different method to determine if joining vehicle is nearby.</span></div>
<div class="line"><span class="lineno"> 1785</span>            <span class="keywordflow">if</span> (hasEnoughRoomInPlatoon &amp;&amp; <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a12d5bd4a0601fe67e924cc07f0672e85">isJoiningVehicleNearPlatoon</a>(applicantCurrentDtd, applicantCurrentCtd))</div>
<div class="line"><span class="lineno"> 1786</span>            {</div>
<div class="line"><span class="lineno"> 1787</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;The current platoon has enough room for the applicant with size &quot;</span> &lt;&lt; applicantSize);</div>
<div class="line"><span class="lineno"> 1788</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;The applicant is close enough for cut-in join, send acceptance response&quot;</span>);</div>
<div class="line"><span class="lineno"> 1789</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Change to Leading with operation state and waiting for &quot;</span> &lt;&lt; msg.m_header.sender_id &lt;&lt; <span class="stringliteral">&quot; to change lane&quot;</span>);</div>
<div class="line"><span class="lineno"> 1790</span>                <span class="comment">// change state to lead with operation</span></div>
<div class="line"><span class="lineno"> 1791</span>                <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> = <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa7d32254f1798e4564e467d332c383112">PlatoonState::LEADWITHOPERATION</a>;</div>
<div class="line"><span class="lineno"> 1792</span>                <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a935cc1406e4a80f9f44669167e43f815">waitingStartTime</a> = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a283186f2bbb98f5f85b5486e365bb4b8">timer_factory_</a>-&gt;now().nanoseconds() / 1000000;</div>
<div class="line"><span class="lineno"> 1793</span>                <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a> = ActionPlan(<span class="keyword">true</span>, <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a935cc1406e4a80f9f44669167e43f815">waitingStartTime</a>, msgHeader.plan_id, applicantId);</div>
<div class="line"><span class="lineno"> 1794</span>                <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a05732c5f9b2d8f5d2c66d1cdcf793854">platoonLeaderID</a> = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a54c4103e4b8705ee687effb030fb7040">HostMobilityId</a>;</div>
<div class="line"><span class="lineno"> 1795</span>                <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217a62e4d1cf02b4cfa5752c7c3dfd75cd03">MobilityRequestResponse::ACK</a>;</div>
<div class="line"><span class="lineno"> 1796</span>            }</div>
<div class="line"><span class="lineno"> 1797</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1798</span>            {   </div>
<div class="line"><span class="lineno"> 1799</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;The current platoon does not have enough room or the applicant is too far away from us. NACK the request.&quot;</span>);</div>
<div class="line"><span class="lineno"> 1800</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;The current applicant size: &quot;</span> &lt;&lt; applicantSize &lt;&lt; <span class="stringliteral">&quot;.&quot;</span>);</div>
<div class="line"><span class="lineno"> 1801</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;The applicant downtrack is: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa53003d4c3610dbb5f87762a6683dd9f">current_downtrack_</a> &lt;&lt; <span class="stringliteral">&quot;.&quot;</span>);</div>
<div class="line"><span class="lineno"> 1802</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;The applicant crosstrack is: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a79aaef859aaa4b64f6cf79c50c596bc3">current_crosstrack_</a> &lt;&lt; <span class="stringliteral">&quot;.&quot;</span>);</div>
<div class="line"><span class="lineno"> 1803</span>                <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217a5d88dd49037ae721095d111b8ee630d5">MobilityRequestResponse::NACK</a>;</div>
<div class="line"><span class="lineno"> 1804</span>            }</div>
<div class="line"><span class="lineno"> 1805</span>        }</div>
<div class="line"><span class="lineno"> 1806</span>        </div>
<div class="line"><span class="lineno"> 1807</span>        <span class="comment">// TODO: Place holder for deaprture.</span></div>
<div class="line"><span class="lineno"> 1808</span> </div>
<div class="line"><span class="lineno"> 1809</span>        <span class="comment">// no response </span></div>
<div class="line"><span class="lineno"> 1810</span>        <span class="keywordflow">else</span> </div>
<div class="line"><span class="lineno"> 1811</span>        {</div>
<div class="line"><span class="lineno"> 1812</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Received mobility request with type &quot;</span> &lt;&lt; msg.plan_type.type &lt;&lt; <span class="stringliteral">&quot; and ignored.&quot;</span>);</div>
<div class="line"><span class="lineno"> 1813</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217a1aabdeebf3169c8d6a5a56d627286f48">MobilityRequestResponse::NO_RESPONSE</a>;</div>
<div class="line"><span class="lineno"> 1814</span>        }</div>
<div class="line"><span class="lineno"> 1815</span>    }</div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_a83ecd30ec7e2f7eb15c93075c8eca436"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a83ecd30ec7e2f7eb15c93075c8eca436">platoon_strategic_ihp::PlatoonManager::getPlatoonRearDowntrackDistance</a></div><div class="ttdeci">double getPlatoonRearDowntrackDistance()</div><div class="ttdoc">Returns downtrack distance of the rear vehicle in platoon, in m.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00375">platoon_manager_ihp.cpp:375</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_aac57cfc07168101835015859c9c7e48e"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#aac57cfc07168101835015859c9c7e48e">platoon_strategic_ihp::PlatoonManager::getPlatoonFrontDowntrackDistance</a></div><div class="ttdeci">double getPlatoonFrontDowntrackDistance()</div><div class="ttdoc">UCLA: Return the platoon leader downtrack distance, in m.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00382">platoon_manager_ihp.cpp:382</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a12d5bd4a0601fe67e924cc07f0672e85"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a12d5bd4a0601fe67e924cc07f0672e85">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::isJoiningVehicleNearPlatoon</a></div><div class="ttdeci">bool isJoiningVehicleNearPlatoon(double joining_downtrack, double joining_crosstrack)</div><div class="ttdoc">The method for platoon leader to determine if the joining vehicle is closeby. (Note: Used when host v...</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l00353">platoon_strategic_ihp.cpp:353</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a935cc1406e4a80f9f44669167e43f815"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a935cc1406e4a80f9f44669167e43f815">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::waitingStartTime</a></div><div class="ttdeci">long waitingStartTime</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8h_source.html#l00334">platoon_strategic_ihp.h:334</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_aa30dd7c98fe60faad9ba8af0da2da581"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa30dd7c98fe60faad9ba8af0da2da581">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::candidatestateStartTime</a></div><div class="ttdeci">long candidatestateStartTime</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8h_source.html#l00336">platoon_strategic_ihp.h:336</a></div></div>
<div class="ttc" id="astructplatoon__strategic__ihp_1_1PlatoonPluginConfig_html_a4286c4fbb2a6d0f34ff38ae89d78a53d"><div class="ttname"><a href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a4286c4fbb2a6d0f34ff38ae89d78a53d">platoon_strategic_ihp::PlatoonPluginConfig::maxAllowedJoinTimeGap</a></div><div class="ttdeci">double maxAllowedJoinTimeGap</div><div class="ttdef"><b>Definition:</b> <a href="platoon__config__ihp_8h_source.html#l00043">platoon_config_ihp.h:43</a></div></div>
<div class="ttc" id="astructplatoon__strategic__ihp_1_1PlatoonPluginConfig_html_ad3c1054a6d0028028bddb5019cd4738f"><div class="ttname"><a href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#ad3c1054a6d0028028bddb5019cd4738f">platoon_strategic_ihp::PlatoonPluginConfig::minAllowedJoinGap</a></div><div class="ttdeci">double minAllowedJoinGap</div><div class="ttdef"><b>Definition:</b> <a href="platoon__config__ihp_8h_source.html#l00045">platoon_config_ihp.h:45</a></div></div>
<div class="ttc" id="astructplatoon__strategic__ihp_1_1PlatoonPluginConfig_html_adfa90129270c151fd23cf1db61ef0cf8"><div class="ttname"><a href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#adfa90129270c151fd23cf1db61ef0cf8">platoon_strategic_ihp::PlatoonPluginConfig::maxAllowedJoinGap</a></div><div class="ttdeci">double maxAllowedJoinGap</div><div class="ttdef"><b>Definition:</b> <a href="platoon__config__ihp_8h_source.html#l00044">platoon_config_ihp.h:44</a></div></div>
<div class="ttc" id="astructplatoon__strategic__ihp_1_1PlatoonPluginConfig_html_ae1ec2bca75a9c7f5c9f2855007f48fba"><div class="ttname"><a href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#ae1ec2bca75a9c7f5c9f2855007f48fba">platoon_strategic_ihp::PlatoonPluginConfig::vehicleLength</a></div><div class="ttdeci">double vehicleLength</div><div class="ttdef"><b>Definition:</b> <a href="platoon__config__ihp_8h_source.html#l00030">platoon_config_ihp.h:30</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__manager__ihp_8h_source.html#l00066">platoon_strategic_ihp::ACK</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00336">candidatestateStartTime</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00318">config_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00332">current_crosstrack_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00330">current_downtrack_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00376">platoon_strategic_ihp::PlatoonManager::current_plan</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00370">platoon_strategic_ihp::PlatoonManager::current_platoon_state</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00364">platoon_strategic_ihp::PlatoonManager::currentPlatoonID</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00252">ecef_to_map_point()</a>, <a class="el" href="platoon__manager__ihp_8cpp_source.html#l00279">platoon_strategic_ihp::PlatoonManager::getHostPlatoonSize()</a>, <a class="el" href="platoon__manager__ihp_8cpp_source.html#l00382">platoon_strategic_ihp::PlatoonManager::getPlatoonFrontDowntrackDistance()</a>, <a class="el" href="platoon__manager__ihp_8cpp_source.html#l00375">platoon_strategic_ihp::PlatoonManager::getPlatoonRearDowntrackDistance()</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00404">platoon_strategic_ihp::PlatoonManager::HostMobilityId</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00353">isJoiningVehicleNearPlatoon()</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00084">platoon_strategic_ihp::LEADERABORTING</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00079">platoon_strategic_ihp::LEADERWAITING</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00088">platoon_strategic_ihp::LEADWITHOPERATION</a>, <a class="el" href="platoon__config__ihp_8h_source.html#l00044">platoon_strategic_ihp::PlatoonPluginConfig::maxAllowedJoinGap</a>, <a class="el" href="platoon__config__ihp_8h_source.html#l00043">platoon_strategic_ihp::PlatoonPluginConfig::maxAllowedJoinTimeGap</a>, <a class="el" href="platoon__config__ihp_8h_source.html#l00062">platoon_strategic_ihp::PlatoonPluginConfig::maxCrosstrackError</a>, <a class="el" href="platoon__config__ihp_8h_source.html#l00031">platoon_strategic_ihp::PlatoonPluginConfig::maxPlatoonSize</a>, <a class="el" href="platoon__config__ihp_8h_source.html#l00045">platoon_strategic_ihp::PlatoonPluginConfig::minAllowedJoinGap</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00067">platoon_strategic_ihp::NACK</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00068">platoon_strategic_ihp::NO_RESPONSE</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00367">platoon_strategic_ihp::PlatoonManager::platoonLeaderID</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00817">pm_</a>, <a class="el" href="process__traj__logs_8py_source.html#l00165">process_traj_logs::split</a>, <a class="el" href="platoon__config__ihp_8h_source.html#l00083">platoon_strategic_ihp::PlatoonPluginConfig::test_front_join</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00814">timer_factory_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00047">platoon_strategic_ihp::ActionPlan::valid</a>, <a class="el" href="platoon__config__ihp_8h_source.html#l00030">platoon_strategic_ihp::PlatoonPluginConfig::vehicleLength</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00334">waitingStartTime</a>, and <a class="el" href="platoon__strategic__ihp_8h_source.html#l00315">wm_</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01354">handle_mob_req()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a5776b135d1c58b8224763c05d64fa440_cgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a5776b135d1c58b8224763c05d64fa440_cgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a5776b135d1c58b8224763c05d64fa440_cgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a5776b135d1c58b8224763c05d64fa440_cgraph">
<area shape="rect" title="Function to process mobility request in leader state." alt="" coords="5,149,188,205"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a876cee27af19b1f215ffd4a2190be371" title="Function to convert ecef location to a 2d point in map frame." alt="" coords="266,5,449,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a3ef30eeb7a7cf0caccb948e6a41f92" title="Returns total size of the platoon , in number of vehicles." alt="" coords="236,85,479,126"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#aac57cfc07168101835015859c9c7e48e" title="UCLA: Return the platoon leader downtrack distance, in m." alt="" coords="262,149,453,205"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a83ecd30ec7e2f7eb15c93075c8eca436" title="Returns downtrack distance of the rear vehicle in platoon, in m." alt="" coords="262,229,453,285"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a12d5bd4a0601fe67e924cc07f0672e85" title="The method for platoon leader to determine if the joining vehicle is closeby. (Note: Used when host v..." alt="" coords="260,309,455,365"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ad3cd4b02451fd0b0a25ed712e3331c36" title="Find lanelet width from local position." alt="" coords="527,309,709,365"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a5776b135d1c58b8224763c05d64fa440_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a5776b135d1c58b8224763c05d64fa440_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a5776b135d1c58b8224763c05d64fa440_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a5776b135d1c58b8224763c05d64fa440_icgraph">
<area shape="rect" title="Function to process mobility request in leader state." alt="" coords="660,5,843,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a53cc42ead95e9734805f4b52de1e38eb" title="Function to the process and respond to the mobility request." alt="" coords="429,5,612,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a588b379b14e20af4e05cf4883c535c5a" title="Callback function for Mobility Request Message." alt="" coords="199,5,381,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,5,151,61"/>
</map>
</div>

</div>
</div>
<a id="ade79b5e7117d1ca95418ae5fa7f73d97" name="ade79b5e7117d1ca95418ae5fa7f73d97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade79b5e7117d1ca95418ae5fa7f73d97">&#9670;&nbsp;</a></span>mob_req_cb_leaderaborting()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217">MobilityRequestResponse</a> platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_req_cb_leaderaborting </td>
          <td>(</td>
          <td class="paramtype">const carma_v2x_msgs::msg::MobilityRequest &amp;&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to process mobility request in leaderaborting state. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>incoming mobility request.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ACK, NACK, or No response. </dd></dl>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01818">1818</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1819</span>    {</div>
<div class="line"><span class="lineno"> 1820</span>        <span class="comment">// This state does not handle any mobility request for now</span></div>
<div class="line"><span class="lineno"> 1821</span>        <span class="comment">// TODO Maybe it should handle some ABORT request from a candidate leader</span></div>
<div class="line"><span class="lineno"> 1822</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Received mobility request with type &quot;</span> &lt;&lt; msg.plan_type.type &lt;&lt; <span class="stringliteral">&quot; but ignored.&quot;</span>);</div>
<div class="line"><span class="lineno"> 1823</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217a1aabdeebf3169c8d6a5a56d627286f48">MobilityRequestResponse::NO_RESPONSE</a>;</div>
<div class="line"><span class="lineno"> 1824</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__manager__ihp_8h_source.html#l00068">platoon_strategic_ihp::NO_RESPONSE</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01354">handle_mob_req()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ade79b5e7117d1ca95418ae5fa7f73d97_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ade79b5e7117d1ca95418ae5fa7f73d97_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ade79b5e7117d1ca95418ae5fa7f73d97_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ade79b5e7117d1ca95418ae5fa7f73d97_icgraph">
<area shape="rect" title="Function to process mobility request in leaderaborting state." alt="" coords="660,5,847,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a53cc42ead95e9734805f4b52de1e38eb" title="Function to the process and respond to the mobility request." alt="" coords="429,5,612,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a588b379b14e20af4e05cf4883c535c5a" title="Callback function for Mobility Request Message." alt="" coords="199,5,381,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,5,151,61"/>
</map>
</div>

</div>
</div>
<a id="a76aa3d0140244914e0ffe7f9554751bb" name="a76aa3d0140244914e0ffe7f9554751bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76aa3d0140244914e0ffe7f9554751bb">&#9670;&nbsp;</a></span>mob_req_cb_leaderwaiting()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217">MobilityRequestResponse</a> platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_req_cb_leaderwaiting </td>
          <td>(</td>
          <td class="paramtype">const carma_v2x_msgs::msg::MobilityRequest &amp;&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to process mobility request in leader waiting state. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>incoming mobility request</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ACK, NACK, or No response </dd></dl>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01510">1510</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1511</span>    {</div>
<div class="line"><span class="lineno"> 1512</span>        <span class="keywordtype">bool</span> isTargetVehicle = msg.m_header.sender_id == <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a38851b8c1a54cc039c86fa3576c940e4">peerId</a>;</div>
<div class="line"><span class="lineno"> 1513</span>        <span class="keywordtype">bool</span> isCandidateJoin = msg.plan_type.type == carma_v2x_msgs::msg::PlanType::PLATOON_FOLLOWER_JOIN;</div>
<div class="line"><span class="lineno"> 1514</span> </div>
<div class="line"><span class="lineno"> 1515</span>        lanelet::BasicPoint2d incoming_pose = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a876cee27af19b1f215ffd4a2190be371">ecef_to_map_point</a>(msg.location);</div>
<div class="line"><span class="lineno"> 1516</span>        <span class="keywordtype">double</span> obj_cross_track = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae65a18d1f14ecdfae3409e47e59a1031">wm_</a>-&gt;routeTrackPos(incoming_pose).crosstrack;</div>
<div class="line"><span class="lineno"> 1517</span>        <span class="keywordtype">bool</span> inTheSameLane = abs(obj_cross_track - <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a79aaef859aaa4b64f6cf79c50c596bc3">current_crosstrack_</a>) &lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a3c2aa8b4742ba50d80bc9c23ed183ebf">maxCrosstrackError</a>;</div>
<div class="line"><span class="lineno"> 1518</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;current_cross_track error = &quot;</span> &lt;&lt; abs(obj_cross_track - <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a79aaef859aaa4b64f6cf79c50c596bc3">current_crosstrack_</a>));</div>
<div class="line"><span class="lineno"> 1519</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;inTheSameLane = &quot;</span> &lt;&lt; inTheSameLane);</div>
<div class="line"><span class="lineno"> 1520</span> </div>
<div class="line"><span class="lineno"> 1521</span>        <span class="comment">// If everything is agreeable then approve the request; if it is from an unexpected vehicle or</span></div>
<div class="line"><span class="lineno"> 1522</span>        <span class="comment">// is not a candidate join request, then we can just ignore it with no action</span></div>
<div class="line"><span class="lineno"> 1523</span>        <a class="code hl_enumeration" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217">MobilityRequestResponse</a> response = <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217a1aabdeebf3169c8d6a5a56d627286f48">MobilityRequestResponse::NO_RESPONSE</a>;</div>
<div class="line"><span class="lineno"> 1524</span>        <span class="keywordflow">if</span> (isTargetVehicle &amp;&amp; isCandidateJoin)</div>
<div class="line"><span class="lineno"> 1525</span>        {</div>
<div class="line"><span class="lineno"> 1526</span>            <span class="keywordflow">if</span> (inTheSameLane)</div>
<div class="line"><span class="lineno"> 1527</span>            {</div>
<div class="line"><span class="lineno"> 1528</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Target vehicle &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a38851b8c1a54cc039c86fa3576c940e4">peerId</a> &lt;&lt; <span class="stringliteral">&quot; is actually joining.&quot;</span>);</div>
<div class="line"><span class="lineno"> 1529</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Changing to PlatoonLeaderState and send ACK to target vehicle&quot;</span>);</div>
<div class="line"><span class="lineno"> 1530</span> </div>
<div class="line"><span class="lineno"> 1531</span>                <span class="comment">// Change state to LEADER</span></div>
<div class="line"><span class="lineno"> 1532</span>                <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> = <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa57f78e815f4fc2ac271a9fd85cd80ebc">PlatoonState::LEADER</a>;</div>
<div class="line"><span class="lineno"> 1533</span> </div>
<div class="line"><span class="lineno"> 1534</span>                <span class="comment">// If we are not already in a platoon, then use this activity plan ID for the newly formed platoon</span></div>
<div class="line"><span class="lineno"> 1535</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a634f99de503cccb2f2d3cb955623dde2">currentPlatoonID</a>.compare(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ae067830e0351c8ba271b00cb4a6f15c1">dummyID</a>) == 0)</div>
<div class="line"><span class="lineno"> 1536</span>                {</div>
<div class="line"><span class="lineno"> 1537</span>                    <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a634f99de503cccb2f2d3cb955623dde2">currentPlatoonID</a> = msg.m_header.plan_id;</div>
<div class="line"><span class="lineno"> 1538</span>                }</div>
<div class="line"><span class="lineno"> 1539</span> </div>
<div class="line"><span class="lineno"> 1540</span>                <span class="comment">// Add the joiner to our platoon record (ASSUMES that we have not yet received a mob_op STATUS msg from joiner!)</span></div>
<div class="line"><span class="lineno"> 1541</span>                PlatoonMember newMember = PlatoonMember();</div>
<div class="line"><span class="lineno"> 1542</span>                newMember.staticId = msg.m_header.sender_id;</div>
<div class="line"><span class="lineno"> 1543</span>                newMember.vehiclePosition = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae65a18d1f14ecdfae3409e47e59a1031">wm_</a>-&gt;routeTrackPos(incoming_pose).downtrack;</div>
<div class="line"><span class="lineno"> 1544</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;New member being added to platoon vector whose size is currently &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>.size());</div>
<div class="line"><span class="lineno"> 1545</span>                <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>.push_back(newMember);</div>
<div class="line"><span class="lineno"> 1546</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;pm_ now thinks platoon size is &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a3ef30eeb7a7cf0caccb948e6a41f92">getHostPlatoonSize</a>());</div>
<div class="line"><span class="lineno"> 1547</span> </div>
<div class="line"><span class="lineno"> 1548</span>                <span class="comment">// Send approval of the request</span></div>
<div class="line"><span class="lineno"> 1549</span>                response = <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217a62e4d1cf02b4cfa5752c7c3dfd75cd03">MobilityRequestResponse::ACK</a>;</div>
<div class="line"><span class="lineno"> 1550</span>                <span class="comment">// Indicate the current join activity is complete</span></div>
<div class="line"><span class="lineno"> 1551</span>                <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#af2f0d9818d07db4a4df484f988635201">clearActionPlan</a>();</div>
<div class="line"><span class="lineno"> 1552</span>            }</div>
<div class="line"><span class="lineno"> 1553</span>            <span class="keywordflow">else</span> <span class="comment">//correct vehicle and intent, but it&#39;s in the wrong lane</span></div>
<div class="line"><span class="lineno"> 1554</span>            {</div>
<div class="line"><span class="lineno"> 1555</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Received platoon request with vehicle id = &quot;</span> &lt;&lt; msg.m_header.sender_id &lt;&lt; <span class="stringliteral">&quot; but in wrong lane. NACK&quot;</span>);</div>
<div class="line"><span class="lineno"> 1556</span>                response = <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217a5d88dd49037ae721095d111b8ee630d5">MobilityRequestResponse::NACK</a>;</div>
<div class="line"><span class="lineno"> 1557</span> </div>
<div class="line"><span class="lineno"> 1558</span>                <span class="comment">// // Remove the candidate joiner from the platoon structure</span></div>
<div class="line"><span class="lineno"> 1559</span>                <span class="comment">// if (!pm_.removeMemberById(msg.m_header.sender_id))</span></div>
<div class="line"><span class="lineno"> 1560</span>                <span class="comment">// {</span></div>
<div class="line"><span class="lineno"> 1561</span>                <span class="comment">//     RCLCPP_DEBUG_STREAM(rclcpp::get_logger(&quot;platoon_strategic_ihp&quot;), &quot;Failed to remove candidate joiner from platoon record: &quot; &lt;&lt; msg.m_header.sender_id);</span></div>
<div class="line"><span class="lineno"> 1562</span>                <span class="comment">// }</span></div>
<div class="line"><span class="lineno"> 1563</span>            }</div>
<div class="line"><span class="lineno"> 1564</span>        }</div>
<div class="line"><span class="lineno"> 1565</span> </div>
<div class="line"><span class="lineno"> 1566</span>        </div>
<div class="line"><span class="lineno"> 1567</span>        <span class="keywordflow">return</span> response;</div>
<div class="line"><span class="lineno"> 1568</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__manager__ihp_8h_source.html#l00066">platoon_strategic_ihp::ACK</a>, <a class="el" href="platoon__manager__ihp_8cpp_source.html#l00285">platoon_strategic_ihp::PlatoonManager::clearActionPlan()</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00318">config_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00332">current_crosstrack_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00376">platoon_strategic_ihp::PlatoonManager::current_plan</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00370">platoon_strategic_ihp::PlatoonManager::current_platoon_state</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00364">platoon_strategic_ihp::PlatoonManager::currentPlatoonID</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00358">platoon_strategic_ihp::PlatoonManager::dummyID</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00252">ecef_to_map_point()</a>, <a class="el" href="platoon__manager__ihp_8cpp_source.html#l00279">platoon_strategic_ihp::PlatoonManager::getHostPlatoonSize()</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00361">platoon_strategic_ihp::PlatoonManager::host_platoon_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00080">platoon_strategic_ihp::LEADER</a>, <a class="el" href="platoon__config__ihp_8h_source.html#l00062">platoon_strategic_ihp::PlatoonPluginConfig::maxCrosstrackError</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00067">platoon_strategic_ihp::NACK</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00068">platoon_strategic_ihp::NO_RESPONSE</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00050">platoon_strategic_ihp::ActionPlan::peerId</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00817">pm_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00099">platoon_strategic_ihp::PlatoonMember::staticId</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00105">platoon_strategic_ihp::PlatoonMember::vehiclePosition</a>, and <a class="el" href="platoon__strategic__ihp_8h_source.html#l00315">wm_</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01354">handle_mob_req()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a76aa3d0140244914e0ffe7f9554751bb_cgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a76aa3d0140244914e0ffe7f9554751bb_cgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a76aa3d0140244914e0ffe7f9554751bb_cgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a76aa3d0140244914e0ffe7f9554751bb_cgraph">
<area shape="rect" title="Function to process mobility request in leader waiting state." alt="" coords="5,70,188,126"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#af2f0d9818d07db4a4df484f988635201" title="Resets necessary variables to indicate that the current ActionPlan is dead." alt="" coords="248,5,467,47"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a876cee27af19b1f215ffd4a2190be371" title="Function to convert ecef location to a 2d point in map frame." alt="" coords="266,70,449,126"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a3ef30eeb7a7cf0caccb948e6a41f92" title="Returns total size of the platoon , in number of vehicles." alt="" coords="236,149,479,191"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a76aa3d0140244914e0ffe7f9554751bb_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a76aa3d0140244914e0ffe7f9554751bb_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a76aa3d0140244914e0ffe7f9554751bb_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a76aa3d0140244914e0ffe7f9554751bb_icgraph">
<area shape="rect" title="Function to process mobility request in leader waiting state." alt="" coords="660,5,843,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a53cc42ead95e9734805f4b52de1e38eb" title="Function to the process and respond to the mobility request." alt="" coords="429,5,612,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a588b379b14e20af4e05cf4883c535c5a" title="Callback function for Mobility Request Message." alt="" coords="199,5,381,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,5,151,61"/>
</map>
</div>

</div>
</div>
<a id="a18b8dcd9744c6df8a615a1ce76f42146" name="a18b8dcd9744c6df8a615a1ce76f42146"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18b8dcd9744c6df8a615a1ce76f42146">&#9670;&nbsp;</a></span>mob_req_cb_leadwithoperation()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217">MobilityRequestResponse</a> platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_req_cb_leadwithoperation </td>
          <td>(</td>
          <td class="paramtype">const carma_v2x_msgs::msg::MobilityRequest &amp;&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to process mobility request in leadwithoperation state (cut-in join) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>incoming mobility request</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ACK, NACK, or No response </dd></dl>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01870">1870</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1871</span>    {</div>
<div class="line"><span class="lineno"> 1872</span>        <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 1873</span><span class="comment">        *   Current leader change state to lead with opertaion once the cut-in join request is accepeted. </span></div>
<div class="line"><span class="lineno"> 1874</span><span class="comment">            For cut-in front, the leading vehicle will open gap for the joining vehicle.</span></div>
<div class="line"><span class="lineno"> 1875</span><span class="comment">            For cut-in middle, the leading vechile will request gap following vehcile to create gap.</span></div>
<div class="line"><span class="lineno"> 1876</span><span class="comment">            The host leading vheicle will also send lane cut-in approval response to the joining vehicle.</span></div>
<div class="line"><span class="lineno"> 1877</span><span class="comment">            The host leading vehicle will change to same-lane state once the lanechange completion plan was recieved. </span></div>
<div class="line"><span class="lineno"> 1878</span><span class="comment">            </span></div>
<div class="line"><span class="lineno"> 1879</span><span class="comment">        */</span></div>
<div class="line"><span class="lineno"> 1880</span> </div>
<div class="line"><span class="lineno"> 1881</span>        <span class="comment">// Check request plan type  </span></div>
<div class="line"><span class="lineno"> 1882</span>        carma_v2x_msgs::msg::PlanType plan_type = msg.plan_type;</div>
<div class="line"><span class="lineno"> 1883</span>        std::string strategyParams = msg.strategy_params;</div>
<div class="line"><span class="lineno"> 1884</span>        std::string reqSenderID = msg.m_header.sender_id;</div>
<div class="line"><span class="lineno"> 1885</span> </div>
<div class="line"><span class="lineno"> 1886</span>        <span class="comment">// Calculate downtrack (m) based on ecef. </span></div>
<div class="line"><span class="lineno"> 1887</span>        lanelet::BasicPoint2d incoming_pose = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a876cee27af19b1f215ffd4a2190be371">ecef_to_map_point</a>(msg.location);</div>
<div class="line"><span class="lineno"> 1888</span>        <span class="comment">// read downtrack</span></div>
<div class="line"><span class="lineno"> 1889</span>        <span class="keywordtype">double</span> applicantCurrentDtd = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae65a18d1f14ecdfae3409e47e59a1031">wm_</a>-&gt;routeTrackPos(incoming_pose).downtrack;</div>
<div class="line"><span class="lineno"> 1890</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Applicant downtrack from ecef pose: &quot;</span> &lt;&lt; applicantCurrentDtd);</div>
<div class="line"><span class="lineno"> 1891</span> </div>
<div class="line"><span class="lineno"> 1892</span>        <span class="comment">// Read requesting join index</span></div>
<div class="line"><span class="lineno"> 1893</span>        std::vector&lt;std::string&gt; inputsParams;</div>
<div class="line"><span class="lineno"> 1894</span>        <a class="code hl_variable" href="namespaceprocess__traj__logs.html#a3682477a3431f2a4aa182fb9a6439125">boost::algorithm::split</a>(inputsParams, strategyParams, boost::is_any_of(<span class="stringliteral">&quot;,&quot;</span>));</div>
<div class="line"><span class="lineno"> 1895</span> </div>
<div class="line"><span class="lineno"> 1896</span>        std::vector&lt;std::string&gt; join_index_parsed;</div>
<div class="line"><span class="lineno"> 1897</span>        <a class="code hl_variable" href="namespaceprocess__traj__logs.html#a3682477a3431f2a4aa182fb9a6439125">boost::algorithm::split</a>(join_index_parsed, inputsParams[5], boost::is_any_of(<span class="stringliteral">&quot;:&quot;</span>));</div>
<div class="line"><span class="lineno"> 1898</span>        <span class="keywordtype">int</span> req_sender_join_index = std::stoi(join_index_parsed[1]);</div>
<div class="line"><span class="lineno"> 1899</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Requesting join_index parsed: &quot;</span> &lt;&lt; req_sender_join_index);</div>
<div class="line"><span class="lineno"> 1900</span> </div>
<div class="line"><span class="lineno"> 1901</span>        <span class="keywordflow">if</span> (plan_type.type == carma_v2x_msgs::msg::PlanType::PLATOON_CUT_IN_JOIN) </div>
<div class="line"><span class="lineno"> 1902</span>        {</div>
<div class="line"><span class="lineno"> 1903</span>            <span class="comment">// Send response </span></div>
<div class="line"><span class="lineno"> 1904</span>            <span class="comment">// ----- CUT-IN front -----</span></div>
<div class="line"><span class="lineno"> 1905</span>            <span class="keywordflow">if</span> (req_sender_join_index == -1)</div>
<div class="line"><span class="lineno"> 1906</span>            {</div>
<div class="line"><span class="lineno"> 1907</span>                <span class="comment">// determine if joining vehicle in position for cut-in front - this value must be &gt; 0</span></div>
<div class="line"><span class="lineno"> 1908</span>                <span class="keywordtype">double</span> cutinDtdDifference = applicantCurrentDtd - <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa53003d4c3610dbb5f87762a6683dd9f">current_downtrack_</a> - <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#ae1ec2bca75a9c7f5c9f2855007f48fba">vehicleLength</a>;</div>
<div class="line"><span class="lineno"> 1909</span>                <span class="comment">// check dtd between current leader (host) and joining vehicle is far enough away to avoid a collision</span></div>
<div class="line"><span class="lineno"> 1910</span>                <span class="keywordtype">bool</span> isFrontJoinerInPosition = cutinDtdDifference &gt;= 1.5*<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#ae1ec2bca75a9c7f5c9f2855007f48fba">vehicleLength</a>;</div>
<div class="line"><span class="lineno"> 1911</span>            </div>
<div class="line"><span class="lineno"> 1912</span>                <span class="keywordflow">if</span> (isFrontJoinerInPosition)</div>
<div class="line"><span class="lineno"> 1913</span>                {</div>
<div class="line"><span class="lineno"> 1914</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;The joining vehicle is cutting in from front.  Gap is already sufficient.&quot;</span>);</div>
<div class="line"><span class="lineno"> 1915</span>                    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217a62e4d1cf02b4cfa5752c7c3dfd75cd03">MobilityRequestResponse::ACK</a>;</div>
<div class="line"><span class="lineno"> 1916</span>                }</div>
<div class="line"><span class="lineno"> 1917</span>                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cutinDtdDifference &gt; 0.0  &amp;&amp;  cutinDtdDifference &lt; 1.5*<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#ae1ec2bca75a9c7f5c9f2855007f48fba">vehicleLength</a>)</div>
<div class="line"><span class="lineno"> 1918</span>                {</div>
<div class="line"><span class="lineno"> 1919</span>                    <span class="comment">// slow down leader to allow joiner cut-in</span></div>
<div class="line"><span class="lineno"> 1920</span>                    <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0dfb4a15be2cf69ca770fcde1bdf65f5">isCreateGap</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1921</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;The joining vehicle is cutting in from front.&quot;</span>);</div>
<div class="line"><span class="lineno"> 1922</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Host (leader) slow down notified, joining vehicle can prepare to join&quot;</span>);</div>
<div class="line"><span class="lineno"> 1923</span>                    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217a62e4d1cf02b4cfa5752c7c3dfd75cd03">MobilityRequestResponse::ACK</a>;</div>
<div class="line"><span class="lineno"> 1924</span>                }</div>
<div class="line"><span class="lineno"> 1925</span>                    </div>
<div class="line"><span class="lineno"> 1926</span>                <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1927</span>                {</div>
<div class="line"><span class="lineno"> 1928</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Front join geometry violation. NACK.  cutinDtdDifference = &quot;</span> &lt;&lt; cutinDtdDifference);</div>
<div class="line"><span class="lineno"> 1929</span>                    <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> = <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa57f78e815f4fc2ac271a9fd85cd80ebc">PlatoonState::LEADER</a>;</div>
<div class="line"><span class="lineno"> 1930</span>                    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217a5d88dd49037ae721095d111b8ee630d5">MobilityRequestResponse::NACK</a>;</div>
<div class="line"><span class="lineno"> 1931</span>                }</div>
<div class="line"><span class="lineno"> 1932</span>            }</div>
<div class="line"><span class="lineno"> 1933</span> </div>
<div class="line"><span class="lineno"> 1934</span>            <span class="comment">// ----- CUT-IN rear -----</span></div>
<div class="line"><span class="lineno"> 1935</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(req_sender_join_index) == <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>.size()-1)</div>
<div class="line"><span class="lineno"> 1936</span>            {</div>
<div class="line"><span class="lineno"> 1937</span>                <span class="comment">// determine if joining vehicle in position for cut-in rear</span></div>
<div class="line"><span class="lineno"> 1938</span>                <span class="comment">// To pass, the joining vehicle need to be behind the last member, within three vehicle length.</span></div>
<div class="line"><span class="lineno"> 1939</span>                <span class="comment">//TODO: should it also test CTE to ensure vehicle is in same lane?</span></div>
<div class="line"><span class="lineno"> 1940</span>                <span class="keywordtype">double</span> platoonEndVehicleDtd = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>[<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>.size()-1].vehiclePosition - <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#ae1ec2bca75a9c7f5c9f2855007f48fba">vehicleLength</a>;</div>
<div class="line"><span class="lineno"> 1941</span>                <span class="keywordtype">double</span> rearGap = platoonEndVehicleDtd - applicantCurrentDtd;</div>
<div class="line"><span class="lineno"> 1942</span>                <span class="keywordtype">bool</span> isRearJoinerInPosition = rearGap &gt;= 0  &amp;&amp;  rearGap &lt;= <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a2c210ff37063f1c702ddec0d454238b2">maxCutinGap</a>;<span class="comment">//3*config_.vehicleLength; TODO: temporary increase</span></div>
<div class="line"><span class="lineno"> 1943</span>                        </div>
<div class="line"><span class="lineno"> 1944</span>                <span class="keywordflow">if</span> (isRearJoinerInPosition)</div>
<div class="line"><span class="lineno"> 1945</span>                {</div>
<div class="line"><span class="lineno"> 1946</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Published Mobility cut-in-rear-Join request to relavent platoon member, host is leader.&quot;</span>);</div>
<div class="line"><span class="lineno"> 1947</span>                    RCLCPP_WARN(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>),<span class="stringliteral">&quot;Published Mobility cut-in-rear-Join request to relavent platoon members to signal gap creation.&quot;</span>);</div>
<div class="line"><span class="lineno"> 1948</span>                    <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0dfb4a15be2cf69ca770fcde1bdf65f5">isCreateGap</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1949</span>                    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217a62e4d1cf02b4cfa5752c7c3dfd75cd03">MobilityRequestResponse::ACK</a>;</div>
<div class="line"><span class="lineno"> 1950</span>                }</div>
<div class="line"><span class="lineno"> 1951</span>                <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1952</span>                {</div>
<div class="line"><span class="lineno"> 1953</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Rear join geometry violation. NACK. rearGap = &quot;</span> &lt;&lt; rearGap);</div>
<div class="line"><span class="lineno"> 1954</span>                    <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> = <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa57f78e815f4fc2ac271a9fd85cd80ebc">PlatoonState::LEADER</a>;</div>
<div class="line"><span class="lineno"> 1955</span>                    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217a5d88dd49037ae721095d111b8ee630d5">MobilityRequestResponse::NACK</a>;</div>
<div class="line"><span class="lineno"> 1956</span>                }</div>
<div class="line"><span class="lineno"> 1957</span>            }</div>
<div class="line"><span class="lineno"> 1958</span>            <span class="comment">// ----- CUT-IN middle -----</span></div>
<div class="line"><span class="lineno"> 1959</span>            <span class="keywordflow">else</span> <span class="comment">//any other join_index value</span></div>
<div class="line"><span class="lineno"> 1960</span>            {</div>
<div class="line"><span class="lineno"> 1961</span>                <span class="comment">// determine if joining vehicle in position for cut-in mid</span></div>
<div class="line"><span class="lineno"> 1962</span>                <span class="comment">// To pass, the joining vehicle should be in front of the gap following vehicle, within three vehicle length.  </span></div>
<div class="line"><span class="lineno"> 1963</span>                <span class="keywordtype">double</span> gapFollowingVehicleDtd = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>[req_sender_join_index].vehiclePosition;</div>
<div class="line"><span class="lineno"> 1964</span>                <span class="keywordtype">double</span> gapFollowerDiff = applicantCurrentDtd - gapFollowingVehicleDtd;</div>
<div class="line"><span class="lineno"> 1965</span>                <span class="keywordtype">bool</span> isMidJoinerInPosition = gapFollowerDiff &gt;=0  &amp;&amp;  gapFollowerDiff &lt;= 3*<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#ae1ec2bca75a9c7f5c9f2855007f48fba">vehicleLength</a>; </div>
<div class="line"><span class="lineno"> 1966</span>            </div>
<div class="line"><span class="lineno"> 1967</span>                <span class="comment">// Task 4: send request to index member to slow down (i.e., set isCreateGap to true) </span></div>
<div class="line"><span class="lineno"> 1968</span>                <span class="comment">// Note: Request recieving vehicle set pm_.isCreateGap </span></div>
<div class="line"><span class="lineno"> 1969</span>                <span class="keywordflow">if</span> (isMidJoinerInPosition)</div>
<div class="line"><span class="lineno"> 1970</span>                {</div>
<div class="line"><span class="lineno"> 1971</span>                    <span class="comment">// compose request (Note: The recipient should be the gap following vehicle.)</span></div>
<div class="line"><span class="lineno"> 1972</span>                    carma_v2x_msgs::msg::MobilityRequest request;</div>
<div class="line"><span class="lineno"> 1973</span>                    request.m_header.plan_id = boost::uuids::to_string(boost::uuids::random_generator()());</div>
<div class="line"><span class="lineno"> 1974</span>                    <span class="comment">// Note: For cut-in mid, notify gap rear member to create/increase gap.</span></div>
<div class="line"><span class="lineno"> 1975</span>                    std::string recipient_ID = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a>[req_sender_join_index+1].staticId;</div>
<div class="line"><span class="lineno"> 1976</span>                    request.m_header.sender_id = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a473bcce97d7c50beaab678372a354c0d">vehicleID</a>;</div>
<div class="line"><span class="lineno"> 1977</span>                    request.m_header.timestamp = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a283186f2bbb98f5f85b5486e365bb4b8">timer_factory_</a>-&gt;now().nanoseconds() / 1000000;;</div>
<div class="line"><span class="lineno"> 1978</span>                    <span class="comment">// UCLA: add plan type, add this in cav_mwgs/plan_type</span></div>
<div class="line"><span class="lineno"> 1979</span>                    request.plan_type.type = carma_v2x_msgs::msg::PlanType::PLATOON_CUT_IN_JOIN;</div>
<div class="line"><span class="lineno"> 1980</span>                    request.strategy = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3be0b52376b568130c1c6a5ec5adeb13">PLATOONING_STRATEGY</a>;</div>
<div class="line"><span class="lineno"> 1981</span> </div>
<div class="line"><span class="lineno"> 1982</span>                    <span class="keywordtype">double</span> platoon_size = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a3ef30eeb7a7cf0caccb948e6a41f92">getHostPlatoonSize</a>();</div>
<div class="line"><span class="lineno"> 1983</span> </div>
<div class="line"><span class="lineno"> 1984</span>                    boost::format fmter(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aca973fa2125f768cffaf33812403f45c">JOIN_PARAMS</a>);   <span class="comment">// Note: Front and rear join uses same params, hence merge to one param for both condition.</span></div>
<div class="line"><span class="lineno"> 1985</span>                    fmter %platoon_size;                <span class="comment">//  index = 0</span></div>
<div class="line"><span class="lineno"> 1986</span>                    fmter %<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3e827c7f2e764c6e7de83f0a81a9593f">current_speed_</a>;              <span class="comment">//  index = 1, in m/s</span></div>
<div class="line"><span class="lineno"> 1987</span>                    fmter %<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ad10e1df213ec7524892b247d28ec9172">pose_ecef_point_</a>.ecef_x;     <span class="comment">//  index = 2</span></div>
<div class="line"><span class="lineno"> 1988</span>                    fmter %<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ad10e1df213ec7524892b247d28ec9172">pose_ecef_point_</a>.ecef_y;     <span class="comment">//  index = 3</span></div>
<div class="line"><span class="lineno"> 1989</span>                    fmter %<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ad10e1df213ec7524892b247d28ec9172">pose_ecef_point_</a>.ecef_z;     <span class="comment">//  index = 4     </span></div>
<div class="line"><span class="lineno"> 1990</span>                    fmter %req_sender_join_index;       <span class="comment">//  index = 5</span></div>
<div class="line"><span class="lineno"> 1991</span> </div>
<div class="line"><span class="lineno"> 1992</span>                    request.strategy_params = fmter.str();</div>
<div class="line"><span class="lineno"> 1993</span>                    request.urgency = 50;</div>
<div class="line"><span class="lineno"> 1994</span>                    request.location = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a11ffedaaa90fe358ecfdccab7c5a428c">pose_to_ecef</a>(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa67d1b97f198e2f088fb24ffb8e0c690">pose_msg_</a>);</div>
<div class="line"><span class="lineno"> 1995</span>                    <span class="comment">// note: for rear join, cut-in index == host_platoon_.size()-1; for join from front, index == -1</span></div>
<div class="line"><span class="lineno"> 1996</span>                    <span class="comment">//       for cut-in in middle, index indicate the gap leading vehicle&#39;s index</span></div>
<div class="line"><span class="lineno"> 1997</span>                    <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae4e916260ddb6f7eb25da13ef9cb158e">mobility_request_publisher_</a>(request); </div>
<div class="line"><span class="lineno"> 1998</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Published Mobility cut-in-mid-Join request to relavent platoon members to signal gap creation, host is leader.&quot;</span>);</div>
<div class="line"><span class="lineno"> 1999</span>                    RCLCPP_WARN(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>),<span class="stringliteral">&quot;Published Mobility cut-in-mid-Join request to relavent platoon members to signal gap creation.&quot;</span>);</div>
<div class="line"><span class="lineno"> 2000</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;The joining vehicle is cutting in at index: &quot;</span>&lt;&lt; req_sender_join_index &lt;&lt;<span class="stringliteral">&quot;. Notify gap rear vehicle with ID: &quot;</span> &lt;&lt; recipient_ID &lt;&lt; <span class="stringliteral">&quot; to slow down&quot;</span>);</div>
<div class="line"><span class="lineno"> 2001</span>                    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217a62e4d1cf02b4cfa5752c7c3dfd75cd03">MobilityRequestResponse::ACK</a>;</div>
<div class="line"><span class="lineno"> 2002</span>                }</div>
<div class="line"><span class="lineno"> 2003</span>                <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2004</span>                {</div>
<div class="line"><span class="lineno"> 2005</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Mid join geometry violation. NACK. gapFollwerDiff = &quot;</span> &lt;&lt; gapFollowerDiff);</div>
<div class="line"><span class="lineno"> 2006</span>                    <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> = <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa57f78e815f4fc2ac271a9fd85cd80ebc">PlatoonState::LEADER</a>;</div>
<div class="line"><span class="lineno"> 2007</span>                    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217a5d88dd49037ae721095d111b8ee630d5">MobilityRequestResponse::NACK</a>;</div>
<div class="line"><span class="lineno"> 2008</span>                }</div>
<div class="line"><span class="lineno"> 2009</span>            }</div>
<div class="line"><span class="lineno"> 2010</span>        }</div>
<div class="line"><span class="lineno"> 2011</span> </div>
<div class="line"><span class="lineno"> 2012</span>        <span class="comment">// task 2: For cut-in from front, the leader need to stop creating gap</span></div>
<div class="line"><span class="lineno"> 2013</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (plan_type.type == carma_v2x_msgs::msg::PlanType::STOP_CREATE_GAP) </div>
<div class="line"><span class="lineno"> 2014</span>        {</div>
<div class="line"><span class="lineno"> 2015</span>            <span class="comment">// reset create gap indicator</span></div>
<div class="line"><span class="lineno"> 2016</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0dfb4a15be2cf69ca770fcde1bdf65f5">isCreateGap</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2017</span>            <span class="comment">// no need to response, simple reset the indicator</span></div>
<div class="line"><span class="lineno"> 2018</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217a1aabdeebf3169c8d6a5a56d627286f48">MobilityRequestResponse::NO_RESPONSE</a>;</div>
<div class="line"><span class="lineno"> 2019</span>        }</div>
<div class="line"><span class="lineno"> 2020</span> </div>
<div class="line"><span class="lineno"> 2021</span>        <span class="comment">// task 3 cut-in front: After creating gap, revert back to same-lane operation </span></div>
<div class="line"><span class="lineno"> 2022</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (plan_type.type == carma_v2x_msgs::msg::PlanType::CUT_IN_FRONT_DONE)</div>
<div class="line"><span class="lineno"> 2023</span>        {</div>
<div class="line"><span class="lineno"> 2024</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Cut-in from front lane change finished, leader revert to same-lane maneuver.&quot;</span>);</div>
<div class="line"><span class="lineno"> 2025</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> = <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafae176dd79ff2c2bc4b2f7901fbfc53014">PlatoonState::LEADERABORTING</a>;</div>
<div class="line"><span class="lineno"> 2026</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa30dd7c98fe60faad9ba8af0da2da581">candidatestateStartTime</a> = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a283186f2bbb98f5f85b5486e365bb4b8">timer_factory_</a>-&gt;now().nanoseconds() / 1000000;</div>
<div class="line"><span class="lineno"> 2027</span>            <span class="comment">// if testing with two vehicles, use plan id as platoon id</span></div>
<div class="line"><span class="lineno"> 2028</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a634f99de503cccb2f2d3cb955623dde2">currentPlatoonID</a>.compare(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ae067830e0351c8ba271b00cb4a6f15c1">dummyID</a>) == 0)</div>
<div class="line"><span class="lineno"> 2029</span>            <span class="comment">// if (config_.allowCutinJoin)</span></div>
<div class="line"><span class="lineno"> 2030</span>            {</div>
<div class="line"><span class="lineno"> 2031</span>                <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a634f99de503cccb2f2d3cb955623dde2">currentPlatoonID</a> = msg.m_header.plan_id;</div>
<div class="line"><span class="lineno"> 2032</span>            }</div>
<div class="line"><span class="lineno"> 2033</span>            <span class="comment">// Store the leader ID as that of the joiner to allow run_leader_aborting to work correctly</span></div>
<div class="line"><span class="lineno"> 2034</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a05732c5f9b2d8f5d2c66d1cdcf793854">platoonLeaderID</a> = msg.m_header.sender_id;</div>
<div class="line"><span class="lineno"> 2035</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a9474313cd68557978e8dbd481d0408bc">valid</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2036</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217a62e4d1cf02b4cfa5752c7c3dfd75cd03">MobilityRequestResponse::ACK</a>;</div>
<div class="line"><span class="lineno"> 2037</span>        }</div>
<div class="line"><span class="lineno"> 2038</span> </div>
<div class="line"><span class="lineno"> 2039</span>        <span class="comment">// task 4 cut-in from middle/rear</span></div>
<div class="line"><span class="lineno"> 2040</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (plan_type.type == carma_v2x_msgs::msg::PlanType::CUT_IN_MID_OR_REAR_DONE)</div>
<div class="line"><span class="lineno"> 2041</span>        {</div>
<div class="line"><span class="lineno"> 2042</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Cut-in from mid/rear lane change finished, leader revert to same-lane maneuver.&quot;</span>);</div>
<div class="line"><span class="lineno"> 2043</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> = <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa70d610aa504abb163caf9a5ee931d090">PlatoonState::LEADERWAITING</a>;</div>
<div class="line"><span class="lineno"> 2044</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a935cc1406e4a80f9f44669167e43f815">waitingStartTime</a> = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a283186f2bbb98f5f85b5486e365bb4b8">timer_factory_</a>-&gt;now().nanoseconds() / 1000000;</div>
<div class="line"><span class="lineno"> 2045</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217a62e4d1cf02b4cfa5752c7c3dfd75cd03">MobilityRequestResponse::ACK</a>;</div>
<div class="line"><span class="lineno"> 2046</span>        }</div>
<div class="line"><span class="lineno"> 2047</span> </div>
<div class="line"><span class="lineno"> 2048</span> </div>
<div class="line"><span class="lineno"> 2049</span>        <span class="comment">// task 5: if other joining vehicle send joning request, NACK it since there is already a cut-in join going on.</span></div>
<div class="line"><span class="lineno"> 2050</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2051</span>        {</div>
<div class="line"><span class="lineno"> 2052</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;CUT-IN join maneuver is already in operation, NACK incoming join requests from other candidates.&quot;</span>);</div>
<div class="line"><span class="lineno"> 2053</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Plan Type: &quot;</span> &lt;&lt; plan_type.type );</div>
<div class="line"><span class="lineno"> 2054</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217a5d88dd49037ae721095d111b8ee630d5">MobilityRequestResponse::NACK</a>;</div>
<div class="line"><span class="lineno"> 2055</span>        }</div>
<div class="line"><span class="lineno"> 2056</span> </div>
<div class="line"><span class="lineno"> 2057</span>        <span class="comment">// this statement should never be reached, but will ensure reasonable behavior in case of coding error above</span></div>
<div class="line"><span class="lineno"> 2058</span>        RCLCPP_WARN_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;End of method reached! Apparent logic fault above.&quot;</span>);</div>
<div class="line"><span class="lineno"> 2059</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;End of method reached! Apparent logic fault above.&quot;</span>); <span class="comment">//since WARN doesn&#39;t always print</span></div>
<div class="line"><span class="lineno"> 2060</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217a1aabdeebf3169c8d6a5a56d627286f48">MobilityRequestResponse::NO_RESPONSE</a>;</div>
<div class="line"><span class="lineno"> 2061</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__manager__ihp_8h_source.html#l00066">platoon_strategic_ihp::ACK</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00336">candidatestateStartTime</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00318">config_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00330">current_downtrack_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00376">platoon_strategic_ihp::PlatoonManager::current_plan</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00370">platoon_strategic_ihp::PlatoonManager::current_platoon_state</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00328">current_speed_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00364">platoon_strategic_ihp::PlatoonManager::currentPlatoonID</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00358">platoon_strategic_ihp::PlatoonManager::dummyID</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00252">ecef_to_map_point()</a>, <a class="el" href="platoon__manager__ihp_8cpp_source.html#l00279">platoon_strategic_ihp::PlatoonManager::getHostPlatoonSize()</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00361">platoon_strategic_ihp::PlatoonManager::host_platoon_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00407">platoon_strategic_ihp::PlatoonManager::isCreateGap</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00858">JOIN_PARAMS</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00080">platoon_strategic_ihp::LEADER</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00084">platoon_strategic_ihp::LEADERABORTING</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00079">platoon_strategic_ihp::LEADERWAITING</a>, <a class="el" href="platoon__config__ihp_8h_source.html#l00061">platoon_strategic_ihp::PlatoonPluginConfig::maxCutinGap</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00308">mobility_request_publisher_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00067">platoon_strategic_ihp::NACK</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00068">platoon_strategic_ihp::NO_RESPONSE</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00820">PLATOONING_STRATEGY</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00367">platoon_strategic_ihp::PlatoonManager::platoonLeaderID</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00817">pm_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00257">pose_ecef_point_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00322">pose_msg_</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00064">pose_to_ecef()</a>, <a class="el" href="process__traj__logs_8py_source.html#l00165">process_traj_logs::split</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00814">timer_factory_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00047">platoon_strategic_ihp::ActionPlan::valid</a>, <a class="el" href="platoon__config__ihp_8h_source.html#l00068">platoon_strategic_ihp::PlatoonPluginConfig::vehicleID</a>, <a class="el" href="platoon__config__ihp_8h_source.html#l00030">platoon_strategic_ihp::PlatoonPluginConfig::vehicleLength</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00334">waitingStartTime</a>, and <a class="el" href="platoon__strategic__ihp_8h_source.html#l00315">wm_</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01354">handle_mob_req()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a18b8dcd9744c6df8a615a1ce76f42146_cgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a18b8dcd9744c6df8a615a1ce76f42146_cgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a18b8dcd9744c6df8a615a1ce76f42146_cgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a18b8dcd9744c6df8a615a1ce76f42146_cgraph">
<area shape="rect" title="Function to process mobility request in leadwithoperation state (cut&#45;in join)" alt="" coords="5,77,212,133"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a876cee27af19b1f215ffd4a2190be371" title="Function to convert ecef location to a 2d point in map frame." alt="" coords="290,5,473,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a3ef30eeb7a7cf0caccb948e6a41f92" title="Returns total size of the platoon , in number of vehicles." alt="" coords="260,85,503,126"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a11ffedaaa90fe358ecfdccab7c5a428c" title="Function to convert pose from map frame to ecef location." alt="" coords="290,149,473,205"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a18b8dcd9744c6df8a615a1ce76f42146_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a18b8dcd9744c6df8a615a1ce76f42146_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a18b8dcd9744c6df8a615a1ce76f42146_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a18b8dcd9744c6df8a615a1ce76f42146_icgraph">
<area shape="rect" title="Function to process mobility request in leadwithoperation state (cut&#45;in join)" alt="" coords="660,5,867,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a53cc42ead95e9734805f4b52de1e38eb" title="Function to the process and respond to the mobility request." alt="" coords="429,5,612,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a588b379b14e20af4e05cf4883c535c5a" title="Callback function for Mobility Request Message." alt="" coords="199,5,381,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,5,151,61"/>
</map>
</div>

</div>
</div>
<a id="a17e303fdec4af651df3678c0a065ad7e" name="a17e303fdec4af651df3678c0a065ad7e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17e303fdec4af651df3678c0a065ad7e">&#9670;&nbsp;</a></span>mob_req_cb_preparetojoin()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217">MobilityRequestResponse</a> platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_req_cb_preparetojoin </td>
          <td>(</td>
          <td class="paramtype">const carma_v2x_msgs::msg::MobilityRequest &amp;&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to process mobility request in preparetojoin state (cut-in join) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>incoming mobility request</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ACK, NACK, or No response </dd></dl>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02064">2064</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2065</span>    {</div>
<div class="line"><span class="lineno"> 2066</span>        <span class="comment">// This state does not handle any mobility request for now</span></div>
<div class="line"><span class="lineno"> 2067</span>        <span class="comment">// TODO: if joining vehicle need to adjust speed, the leader should request it and the request should be handled here. </span></div>
<div class="line"><span class="lineno"> 2068</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Received mobility request with type &quot;</span> &lt;&lt; msg.plan_type.type &lt;&lt; <span class="stringliteral">&quot; but ignored.&quot;</span>);</div>
<div class="line"><span class="lineno"> 2069</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217a1aabdeebf3169c8d6a5a56d627286f48">MobilityRequestResponse::NO_RESPONSE</a>;</div>
<div class="line"><span class="lineno"> 2070</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__manager__ihp_8h_source.html#l00068">platoon_strategic_ihp::NO_RESPONSE</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01354">handle_mob_req()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a17e303fdec4af651df3678c0a065ad7e_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a17e303fdec4af651df3678c0a065ad7e_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a17e303fdec4af651df3678c0a065ad7e_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a17e303fdec4af651df3678c0a065ad7e_icgraph">
<area shape="rect" title="Function to process mobility request in preparetojoin state (cut&#45;in join)" alt="" coords="660,5,843,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a53cc42ead95e9734805f4b52de1e38eb" title="Function to the process and respond to the mobility request." alt="" coords="429,5,612,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a588b379b14e20af4e05cf4883c535c5a" title="Callback function for Mobility Request Message." alt="" coords="199,5,381,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,5,151,61"/>
</map>
</div>

</div>
</div>
<a id="a83ec14a38d923ba22c00168e8e991a32" name="a83ec14a38d923ba22c00168e8e991a32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83ec14a38d923ba22c00168e8e991a32">&#9670;&nbsp;</a></span>mob_req_cb_standby()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217">MobilityRequestResponse</a> platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_req_cb_standby </td>
          <td>(</td>
          <td class="paramtype">const carma_v2x_msgs::msg::MobilityRequest &amp;&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to process mobility request in standby state. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>incoming mobility request</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ACK, NACK, or No response </dd></dl>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01413">1413</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1414</span>    {</div>
<div class="line"><span class="lineno"> 1415</span>        <span class="comment">// In standby state, the plugin is not responsible for replying to any request messages</span></div>
<div class="line"><span class="lineno"> 1416</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;STANDBY state does nothing with msg from &quot;</span> &lt;&lt; msg.m_header.sender_id);</div>
<div class="line"><span class="lineno"> 1417</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#afdeaa181289e9678d31f8928ec036217a1aabdeebf3169c8d6a5a56d627286f48">MobilityRequestResponse::NO_RESPONSE</a>;</div>
<div class="line"><span class="lineno"> 1418</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__manager__ihp_8h_source.html#l00068">platoon_strategic_ihp::NO_RESPONSE</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01354">handle_mob_req()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a83ec14a38d923ba22c00168e8e991a32_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a83ec14a38d923ba22c00168e8e991a32_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a83ec14a38d923ba22c00168e8e991a32_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a83ec14a38d923ba22c00168e8e991a32_icgraph">
<area shape="rect" title="Function to process mobility request in standby state." alt="" coords="660,5,843,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a53cc42ead95e9734805f4b52de1e38eb" title="Function to the process and respond to the mobility request." alt="" coords="429,5,612,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a588b379b14e20af4e05cf4883c535c5a" title="Callback function for Mobility Request Message." alt="" coords="199,5,381,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,5,151,61"/>
</map>
</div>

</div>
</div>
<a id="aaca0c4143be4a27041ab5ed90d2c624c" name="aaca0c4143be4a27041ab5ed90d2c624c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaca0c4143be4a27041ab5ed90d2c624c">&#9670;&nbsp;</a></span>mob_resp_cb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_resp_cb </td>
          <td>(</td>
          <td class="paramtype">const carma_v2x_msgs::msg::MobilityResponse::UniquePtr&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Callback function for Mobility Response Message. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>Mobility Response Message </td></tr>
  </table>
  </dd>
</dl>
<p >If any of the three condition (i.e., isCurrPlanValid, isForCurrentPlan and isFromTargetVehicle) was not satisfied, return ignore as this message was not intended for the host.</p>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02077">2077</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2078</span>    {</div>
<div class="line"><span class="lineno"> 2079</span>        <span class="comment">// Firstly, check eligibility of the received message. </span></div>
<div class="line"><span class="lineno"> 2080</span>        <span class="keywordtype">bool</span> isCurrPlanValid = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a9474313cd68557978e8dbd481d0408bc">valid</a>;                          <span class="comment">// Check if current plan is still valid (i.e., not timed out).</span></div>
<div class="line"><span class="lineno"> 2081</span>        <span class="keywordtype">bool</span> isForCurrentPlan = msg-&gt;m_header.plan_id == <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a34c7e7384914852c5549e8d2a14dc6e9">planId</a>;  <span class="comment">// Check if plan Id matches.</span></div>
<div class="line"><span class="lineno"> 2082</span>        <span class="keywordtype">bool</span> isFromTargetVehicle = msg-&gt;m_header.sender_id == <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a38851b8c1a54cc039c86fa3576c940e4">peerId</a>;  <span class="comment">// Check if expected peer ID and sender ID matches.</span></div>
<div class="line"><span class="lineno"> 2083</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;mob_resp_cb: isCurrPlanValid = &quot;</span> &lt;&lt; isCurrPlanValid &lt;&lt; <span class="stringliteral">&quot;, isForCurrentPlan = &quot;</span> &lt;&lt; </div>
<div class="line"><span class="lineno"> 2084</span>                        isForCurrentPlan &lt;&lt; <span class="stringliteral">&quot;, isFromTargetVehicle = &quot;</span> &lt;&lt; isFromTargetVehicle);</div>
<div class="line"><span class="lineno"> 2085</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;sender ID = &quot;</span> &lt;&lt; msg-&gt;m_header.sender_id &lt;&lt; <span class="stringliteral">&quot;, current peer ID = &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a38851b8c1a54cc039c86fa3576c940e4">peerId</a>);</div>
<div class="line"><span class="lineno"> 2086</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;incoming plan ID = &quot;</span> &lt;&lt; msg-&gt;m_header.plan_id &lt;&lt; <span class="stringliteral">&quot;current plan ID = &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a34c7e7384914852c5549e8d2a14dc6e9">planId</a>);</div>
<div class="line"><span class="lineno"> 2087</span> </div>
<div class="line"><span class="lineno"> 2088</span>        <span class="keywordflow">if</span> (!(isCurrPlanValid &amp;&amp; isForCurrentPlan &amp;&amp; isFromTargetVehicle)) </div>
<div class="line"><span class="lineno"> 2089</span>        {</div>
<div class="line"><span class="lineno"> 2094</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot; Ignore the received response message as it was not intended for the host vehicle.&quot;</span>);</div>
<div class="line"><span class="lineno"> 2095</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 2096</span>        }</div>
<div class="line"><span class="lineno"> 2097</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> == <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa57f78e815f4fc2ac271a9fd85cd80ebc">PlatoonState::LEADER</a>)</div>
<div class="line"><span class="lineno"> 2098</span>        {</div>
<div class="line"><span class="lineno"> 2099</span>            <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a7fcd17fc2e2649934215719e473c52bb">mob_resp_cb_leader</a>(*msg);</div>
<div class="line"><span class="lineno"> 2100</span>        }</div>
<div class="line"><span class="lineno"> 2101</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> == <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa0d2c16ab07ed24865f7ba27ad8a83dc0">PlatoonState::FOLLOWER</a>)</div>
<div class="line"><span class="lineno"> 2102</span>        {</div>
<div class="line"><span class="lineno"> 2103</span>            <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a80d39ab680172d7379e4038d41b50a39">mob_resp_cb_follower</a>(*msg);</div>
<div class="line"><span class="lineno"> 2104</span>        }</div>
<div class="line"><span class="lineno"> 2105</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> == <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafab7680aa6ec3a24dc42cb374192eb39a3">PlatoonState::CANDIDATEFOLLOWER</a>)</div>
<div class="line"><span class="lineno"> 2106</span>        {</div>
<div class="line"><span class="lineno"> 2107</span>            <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ac969d6086d5fe4b55831015327820688">mob_resp_cb_candidatefollower</a>(*msg);</div>
<div class="line"><span class="lineno"> 2108</span>        }</div>
<div class="line"><span class="lineno"> 2109</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> == <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa70d610aa504abb163caf9a5ee931d090">PlatoonState::LEADERWAITING</a>)</div>
<div class="line"><span class="lineno"> 2110</span>        {</div>
<div class="line"><span class="lineno"> 2111</span>            <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae41ec043178e306fdd909d671877ef9f">mob_resp_cb_leaderwaiting</a>(*msg);</div>
<div class="line"><span class="lineno"> 2112</span>        }</div>
<div class="line"><span class="lineno"> 2113</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> == <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa839ccd0c7e2e3441b3cd9ca0546be97b">PlatoonState::STANDBY</a>)</div>
<div class="line"><span class="lineno"> 2114</span>        {</div>
<div class="line"><span class="lineno"> 2115</span>            <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ab0c666183fb0cb94767b87309404a8f6">mob_resp_cb_standby</a>(*msg);</div>
<div class="line"><span class="lineno"> 2116</span>        }</div>
<div class="line"><span class="lineno"> 2117</span>        <span class="comment">// UCLA: add leader aboorting </span></div>
<div class="line"><span class="lineno"> 2118</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> == <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafae176dd79ff2c2bc4b2f7901fbfc53014">PlatoonState::LEADERABORTING</a>)</div>
<div class="line"><span class="lineno"> 2119</span>        {</div>
<div class="line"><span class="lineno"> 2120</span>            <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aeba3a1dd3fc9411891a1fe1eac8c3993">mob_resp_cb_leaderaborting</a>(*msg);</div>
<div class="line"><span class="lineno"> 2121</span>        }</div>
<div class="line"><span class="lineno"> 2122</span>        <span class="comment">//UCLA: add candidate leader </span></div>
<div class="line"><span class="lineno"> 2123</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> == <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa52c17c95a5cd81220db3fdd9181d43bd">PlatoonState::CANDIDATELEADER</a>)</div>
<div class="line"><span class="lineno"> 2124</span>        {</div>
<div class="line"><span class="lineno"> 2125</span>            <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a6e3fa57a6b2cec7e2ecd915863ca590b">mob_resp_cb_candidateleader</a>(*msg);</div>
<div class="line"><span class="lineno"> 2126</span>        }</div>
<div class="line"><span class="lineno"> 2127</span>        <span class="comment">// UCLA: add lead with operation for cut-in join</span></div>
<div class="line"><span class="lineno"> 2128</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> == <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa7d32254f1798e4564e467d332c383112">PlatoonState::LEADWITHOPERATION</a>)</div>
<div class="line"><span class="lineno"> 2129</span>        {</div>
<div class="line"><span class="lineno"> 2130</span>            <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a1506aaa516eb3c9abae75820206b5c31">mob_resp_cb_leadwithoperation</a>(*msg);</div>
<div class="line"><span class="lineno"> 2131</span>        }</div>
<div class="line"><span class="lineno"> 2132</span>        <span class="comment">// UCLA: add prepare to join for cut-in join</span></div>
<div class="line"><span class="lineno"> 2133</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> == <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafafe45c20d03a8d502486cff766672bdf9">PlatoonState::PREPARETOJOIN</a>)</div>
<div class="line"><span class="lineno"> 2134</span>        {</div>
<div class="line"><span class="lineno"> 2135</span>            <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a900863cced7c330fb24f93bc33649cd8">mob_resp_cb_preparetojoin</a>(*msg);</div>
<div class="line"><span class="lineno"> 2136</span>        }</div>
<div class="line"><span class="lineno"> 2137</span>        <span class="comment">// TODO: Place holder for departure.</span></div>
<div class="line"><span class="lineno"> 2138</span>    }</div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a1506aaa516eb3c9abae75820206b5c31"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a1506aaa516eb3c9abae75820206b5c31">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_resp_cb_leadwithoperation</a></div><div class="ttdeci">void mob_resp_cb_leadwithoperation(const carma_v2x_msgs::msg::MobilityResponse &amp;msg)</div><div class="ttdoc">Function to process mobility response in leadwithoperation state (cut-in join)</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l02449">platoon_strategic_ihp.cpp:2449</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a6e3fa57a6b2cec7e2ecd915863ca590b"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a6e3fa57a6b2cec7e2ecd915863ca590b">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_resp_cb_candidateleader</a></div><div class="ttdeci">void mob_resp_cb_candidateleader(const carma_v2x_msgs::msg::MobilityResponse &amp;msg)</div><div class="ttdoc">Function to process mobility response in candidateleader state.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l02443">platoon_strategic_ihp.cpp:2443</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a7fcd17fc2e2649934215719e473c52bb"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a7fcd17fc2e2649934215719e473c52bb">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_resp_cb_leader</a></div><div class="ttdeci">void mob_resp_cb_leader(const carma_v2x_msgs::msg::MobilityResponse &amp;msg)</div><div class="ttdoc">Function to process mobility response in leader state.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l02256">platoon_strategic_ihp.cpp:2256</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a80d39ab680172d7379e4038d41b50a39"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a80d39ab680172d7379e4038d41b50a39">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_resp_cb_follower</a></div><div class="ttdeci">void mob_resp_cb_follower(const carma_v2x_msgs::msg::MobilityResponse &amp;msg)</div><div class="ttdoc">Function to process mobility response in follower state.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l02220">platoon_strategic_ihp.cpp:2220</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a900863cced7c330fb24f93bc33649cd8"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a900863cced7c330fb24f93bc33649cd8">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_resp_cb_preparetojoin</a></div><div class="ttdeci">void mob_resp_cb_preparetojoin(const carma_v2x_msgs::msg::MobilityResponse &amp;msg)</div><div class="ttdoc">Function to process mobility response in preparetojoin state.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l02455">platoon_strategic_ihp.cpp:2455</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_ab0c666183fb0cb94767b87309404a8f6"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ab0c666183fb0cb94767b87309404a8f6">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_resp_cb_standby</a></div><div class="ttdeci">void mob_resp_cb_standby(const carma_v2x_msgs::msg::MobilityResponse &amp;msg)</div><div class="ttdoc">Function to process mobility response in standby state.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l02140">platoon_strategic_ihp.cpp:2140</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_ac969d6086d5fe4b55831015327820688"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ac969d6086d5fe4b55831015327820688">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_resp_cb_candidatefollower</a></div><div class="ttdeci">void mob_resp_cb_candidatefollower(const carma_v2x_msgs::msg::MobilityResponse &amp;msg)</div><div class="ttdoc">Function to process mobility response in candidate follower state.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l02146">platoon_strategic_ihp.cpp:2146</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_ae41ec043178e306fdd909d671877ef9f"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae41ec043178e306fdd909d671877ef9f">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_resp_cb_leaderwaiting</a></div><div class="ttdeci">void mob_resp_cb_leaderwaiting(const carma_v2x_msgs::msg::MobilityResponse &amp;msg)</div><div class="ttdoc">Function to process mobility response in leader waiting state.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l02210">platoon_strategic_ihp.cpp:2210</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_aeba3a1dd3fc9411891a1fe1eac8c3993"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aeba3a1dd3fc9411891a1fe1eac8c3993">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_resp_cb_leaderaborting</a></div><div class="ttdeci">void mob_resp_cb_leaderaborting(const carma_v2x_msgs::msg::MobilityResponse &amp;msg)</div><div class="ttdoc">Function to process mobility response in leaderaborting state.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l02362">platoon_strategic_ihp.cpp:2362</a></div></div>
<div class="ttc" id="astructplatoon__strategic__ihp_1_1ActionPlan_html_a34c7e7384914852c5549e8d2a14dc6e9"><div class="ttname"><a href="structplatoon__strategic__ihp_1_1ActionPlan.html#a34c7e7384914852c5549e8d2a14dc6e9">platoon_strategic_ihp::ActionPlan::planId</a></div><div class="ttdeci">std::string planId</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00049">platoon_manager_ihp.h:49</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__manager__ihp_8h_source.html#l00081">platoon_strategic_ihp::CANDIDATEFOLLOWER</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00086">platoon_strategic_ihp::CANDIDATELEADER</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00376">platoon_strategic_ihp::PlatoonManager::current_plan</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00370">platoon_strategic_ihp::PlatoonManager::current_platoon_state</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00082">platoon_strategic_ihp::FOLLOWER</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00080">platoon_strategic_ihp::LEADER</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00084">platoon_strategic_ihp::LEADERABORTING</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00079">platoon_strategic_ihp::LEADERWAITING</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00088">platoon_strategic_ihp::LEADWITHOPERATION</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02146">mob_resp_cb_candidatefollower()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02443">mob_resp_cb_candidateleader()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02220">mob_resp_cb_follower()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02256">mob_resp_cb_leader()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02362">mob_resp_cb_leaderaborting()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02210">mob_resp_cb_leaderwaiting()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02449">mob_resp_cb_leadwithoperation()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02455">mob_resp_cb_preparetojoin()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02140">mob_resp_cb_standby()</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00050">platoon_strategic_ihp::ActionPlan::peerId</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00049">platoon_strategic_ihp::ActionPlan::planId</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00817">pm_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00090">platoon_strategic_ihp::PREPARETOJOIN</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00078">platoon_strategic_ihp::STANDBY</a>, and <a class="el" href="platoon__manager__ihp_8h_source.html#l00047">platoon_strategic_ihp::ActionPlan::valid</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp__node_8cpp_source.html#l00118">platoon_strategic_ihp::Node::on_configure_plugin()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aaca0c4143be4a27041ab5ed90d2c624c_cgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aaca0c4143be4a27041ab5ed90d2c624c_cgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aaca0c4143be4a27041ab5ed90d2c624c_cgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aaca0c4143be4a27041ab5ed90d2c624c_cgraph">
<area shape="rect" title="Callback function for Mobility Response Message." alt="" coords="5,426,188,482"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ac969d6086d5fe4b55831015327820688" title="Function to process mobility response in candidate follower state." alt="" coords="236,186,451,242"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a6e3fa57a6b2cec7e2ecd915863ca590b" title="Function to process mobility response in candidateleader state." alt="" coords="241,426,445,482"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a80d39ab680172d7379e4038d41b50a39" title="Function to process mobility response in follower state." alt="" coords="252,506,435,562"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a7fcd17fc2e2649934215719e473c52bb" title="Function to process mobility response in leader state." alt="" coords="252,266,435,322"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aeba3a1dd3fc9411891a1fe1eac8c3993" title="Function to process mobility response in leaderaborting state." alt="" coords="246,89,441,145"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae41ec043178e306fdd909d671877ef9f" title="Function to process mobility response in leader waiting state." alt="" coords="249,586,438,642"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a1506aaa516eb3c9abae75820206b5c31" title="Function to process mobility response in leadwithoperation state (cut&#45;in join)" alt="" coords="236,666,451,722"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a900863cced7c330fb24f93bc33649cd8" title="Function to process mobility response in preparetojoin state." alt="" coords="250,346,437,402"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ab0c666183fb0cb94767b87309404a8f6" title="Function to process mobility response in standby state." alt="" coords="252,746,435,802"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#aa589c920c9684b42bf8f675c072ddb6b" title="Update status when state change from Leader to Follower." alt="" coords="520,70,720,126"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#abca93088e8980c97a1a24c4fff31c758" title="Resets all variables that describe a neighbor platoon, so that no neighbor is known." alt="" coords="789,103,999,159"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#af2f0d9818d07db4a4df484f988635201" title="Resets necessary variables to indicate that the current ActionPlan is dead." alt="" coords="511,201,729,243"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a3ef30eeb7a7cf0caccb948e6a41f92" title="Returns total size of the platoon , in number of vehicles." alt="" coords="499,345,741,387"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ab1c204db4a5056621de299a9dd663c6f" title="Resets all variables that might indicate other members of the host&#39;s platoon; sets the host back to s..." alt="" coords="527,266,713,322"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a26f10c9b0d02a6c0a37228583a0385a1" title="Removes a single member from the internal record of platoon members." alt="" coords="511,5,729,47"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a11ffedaaa90fe358ecfdccab7c5a428c" title="Function to convert pose from map frame to ecef location." alt="" coords="529,410,711,466"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aaca0c4143be4a27041ab5ed90d2c624c_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aaca0c4143be4a27041ab5ed90d2c624c_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aaca0c4143be4a27041ab5ed90d2c624c_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aaca0c4143be4a27041ab5ed90d2c624c_icgraph">
<area shape="rect" title="Callback function for Mobility Response Message." alt="" coords="199,5,381,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,5,151,61"/>
</map>
</div>

</div>
</div>
<a id="ac969d6086d5fe4b55831015327820688" name="ac969d6086d5fe4b55831015327820688"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac969d6086d5fe4b55831015327820688">&#9670;&nbsp;</a></span>mob_resp_cb_candidatefollower()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_resp_cb_candidatefollower </td>
          <td>(</td>
          <td class="paramtype">const carma_v2x_msgs::msg::MobilityResponse &amp;&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to process mobility response in candidate follower state. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>incoming mobility response </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02146">2146</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2147</span>    {</div>
<div class="line"><span class="lineno"> 2148</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Callback for candidate follower &quot;</span>);</div>
<div class="line"><span class="lineno"> 2149</span>        </div>
<div class="line"><span class="lineno"> 2150</span>        <span class="comment">// Check if current plan is still valid (i.e., not timed out)</span></div>
<div class="line"><span class="lineno"> 2151</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a9474313cd68557978e8dbd481d0408bc">valid</a>)</div>
<div class="line"><span class="lineno"> 2152</span>        {</div>
<div class="line"><span class="lineno"> 2153</span>            <span class="keywordtype">bool</span> isForCurrentPlan = msg.m_header.plan_id == <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a34c7e7384914852c5549e8d2a14dc6e9">planId</a>;</div>
<div class="line"><span class="lineno"> 2154</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;isForCurrentPlan &quot;</span> &lt;&lt; isForCurrentPlan);</div>
<div class="line"><span class="lineno"> 2155</span> </div>
<div class="line"><span class="lineno"> 2156</span>            <span class="comment">// Check the response is received correctly (i.e., host vehicle is the desired receiver).</span></div>
<div class="line"><span class="lineno"> 2157</span>            <span class="keywordflow">if</span> (isForCurrentPlan)</div>
<div class="line"><span class="lineno"> 2158</span>            {</div>
<div class="line"><span class="lineno"> 2159</span>                <span class="keywordflow">if</span> (msg.is_accepted)</div>
<div class="line"><span class="lineno"> 2160</span>                {</div>
<div class="line"><span class="lineno"> 2161</span>                    <span class="comment">// We change to follower state and start to actually follow that leader</span></div>
<div class="line"><span class="lineno"> 2162</span>                    <span class="comment">// The platoon manager also need to change the platoon Id to the one that the target leader is using </span></div>
<div class="line"><span class="lineno"> 2163</span>                    <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> = <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa0d2c16ab07ed24865f7ba27ad8a83dc0">PlatoonState::FOLLOWER</a>;</div>
<div class="line"><span class="lineno"> 2164</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;pm_.currentPlatoonID: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a634f99de503cccb2f2d3cb955623dde2">currentPlatoonID</a>);</div>
<div class="line"><span class="lineno"> 2165</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;pm_.targetPlatoonID: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a634f99de503cccb2f2d3cb955623dde2">currentPlatoonID</a>);</div>
<div class="line"><span class="lineno"> 2166</span> </div>
<div class="line"><span class="lineno"> 2167</span>                    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#abc319b76af0eecaba8e0fe0718457618">targetPlatoonID</a>.compare(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ae067830e0351c8ba271b00cb4a6f15c1">dummyID</a>) != 0)</div>
<div class="line"><span class="lineno"> 2168</span>                    {</div>
<div class="line"><span class="lineno"> 2169</span>                        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a634f99de503cccb2f2d3cb955623dde2">currentPlatoonID</a> = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#abc319b76af0eecaba8e0fe0718457618">targetPlatoonID</a>;</div>
<div class="line"><span class="lineno"> 2170</span>                        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;pm_.currentPlatoonID now: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a634f99de503cccb2f2d3cb955623dde2">currentPlatoonID</a>);</div>
<div class="line"><span class="lineno"> 2171</span>                        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#abca93088e8980c97a1a24c4fff31c758">resetNeighborPlatoon</a>();</div>
<div class="line"><span class="lineno"> 2172</span>                    }</div>
<div class="line"><span class="lineno"> 2173</span>                    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2174</span>                    {</div>
<div class="line"><span class="lineno"> 2175</span>                        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a634f99de503cccb2f2d3cb955623dde2">currentPlatoonID</a> = msg.m_header.plan_id;</div>
<div class="line"><span class="lineno"> 2176</span>                    }</div>
<div class="line"><span class="lineno"> 2177</span> </div>
<div class="line"><span class="lineno"> 2178</span>                    <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#aa589c920c9684b42bf8f675c072ddb6b">changeFromLeaderToFollower</a>(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a634f99de503cccb2f2d3cb955623dde2">currentPlatoonID</a>, msg.m_header.sender_id);</div>
<div class="line"><span class="lineno"> 2179</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;The leader &quot;</span> &lt;&lt; msg.m_header.sender_id &lt;&lt; <span class="stringliteral">&quot; agreed on our join. Change to follower state.&quot;</span>);</div>
<div class="line"><span class="lineno"> 2180</span>                    RCLCPP_WARN(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>),<span class="stringliteral">&quot;changed to follower&quot;</span>);</div>
<div class="line"><span class="lineno"> 2181</span>                    <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#af2f0d9818d07db4a4df484f988635201">clearActionPlan</a>();</div>
<div class="line"><span class="lineno"> 2182</span>                }</div>
<div class="line"><span class="lineno"> 2183</span>                <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2184</span>                {</div>
<div class="line"><span class="lineno"> 2185</span>                    <span class="comment">// We change back to normal leader state and try to join other platoons</span></div>
<div class="line"><span class="lineno"> 2186</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;The leader &quot;</span> &lt;&lt; msg.m_header.sender_id &lt;&lt; <span class="stringliteral">&quot; does not agree on our join. Change back to leader state.&quot;</span>);</div>
<div class="line"><span class="lineno"> 2187</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Trying again..&quot;</span>);</div>
<div class="line"><span class="lineno"> 2188</span>                    <span class="comment">// join plan failed, but we still need the peerid</span></div>
<div class="line"><span class="lineno"> 2189</span>                    <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a9474313cd68557978e8dbd481d0408bc">valid</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2190</span> </div>
<div class="line"><span class="lineno"> 2191</span>                    <span class="comment">// Clear out any platooning plan we don&#39;t need</span></div>
<div class="line"><span class="lineno"> 2192</span>                    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a3ef30eeb7a7cf0caccb948e6a41f92">getHostPlatoonSize</a>() == 1)</div>
<div class="line"><span class="lineno"> 2193</span>                    {</div>
<div class="line"><span class="lineno"> 2194</span>                        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ab1c204db4a5056621de299a9dd663c6f">resetHostPlatoon</a>();</div>
<div class="line"><span class="lineno"> 2195</span>                    }</div>
<div class="line"><span class="lineno"> 2196</span>                }</div>
<div class="line"><span class="lineno"> 2197</span> </div>
<div class="line"><span class="lineno"> 2198</span>            }</div>
<div class="line"><span class="lineno"> 2199</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2200</span>            {</div>
<div class="line"><span class="lineno"> 2201</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Ignore received response message because it is not for the current plan.&quot;</span>);</div>
<div class="line"><span class="lineno"> 2202</span>            }</div>
<div class="line"><span class="lineno"> 2203</span>        }</div>
<div class="line"><span class="lineno"> 2204</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2205</span>        {</div>
<div class="line"><span class="lineno"> 2206</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Ignore received response message because we are not in any negotiation process.&quot;</span>);</div>
<div class="line"><span class="lineno"> 2207</span>        }</div>
<div class="line"><span class="lineno"> 2208</span>    }</div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_aa589c920c9684b42bf8f675c072ddb6b"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#aa589c920c9684b42bf8f675c072ddb6b">platoon_strategic_ihp::PlatoonManager::changeFromLeaderToFollower</a></div><div class="ttdeci">void changeFromLeaderToFollower(std::string newPlatoonId, std::string newLeaderId)</div><div class="ttdoc">Update status when state change from Leader to Follower.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00699">platoon_manager_ihp.cpp:699</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__manager__ihp_8cpp_source.html#l00699">platoon_strategic_ihp::PlatoonManager::changeFromLeaderToFollower()</a>, <a class="el" href="platoon__manager__ihp_8cpp_source.html#l00285">platoon_strategic_ihp::PlatoonManager::clearActionPlan()</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00376">platoon_strategic_ihp::PlatoonManager::current_plan</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00370">platoon_strategic_ihp::PlatoonManager::current_platoon_state</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00364">platoon_strategic_ihp::PlatoonManager::currentPlatoonID</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00358">platoon_strategic_ihp::PlatoonManager::dummyID</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00082">platoon_strategic_ihp::FOLLOWER</a>, <a class="el" href="platoon__manager__ihp_8cpp_source.html#l00279">platoon_strategic_ihp::PlatoonManager::getHostPlatoonSize()</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00049">platoon_strategic_ihp::ActionPlan::planId</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00817">pm_</a>, <a class="el" href="platoon__manager__ihp_8cpp_source.html#l00295">platoon_strategic_ihp::PlatoonManager::resetHostPlatoon()</a>, <a class="el" href="platoon__manager__ihp_8cpp_source.html#l00313">platoon_strategic_ihp::PlatoonManager::resetNeighborPlatoon()</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00390">platoon_strategic_ihp::PlatoonManager::targetPlatoonID</a>, and <a class="el" href="platoon__manager__ihp_8h_source.html#l00047">platoon_strategic_ihp::ActionPlan::valid</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02077">mob_resp_cb()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ac969d6086d5fe4b55831015327820688_cgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ac969d6086d5fe4b55831015327820688_cgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ac969d6086d5fe4b55831015327820688_cgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ac969d6086d5fe4b55831015327820688_cgraph">
<area shape="rect" title="Function to process mobility response in candidate follower state." alt="" coords="5,129,220,185"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#aa589c920c9684b42bf8f675c072ddb6b" title="Update status when state change from Leader to Follower." alt="" coords="289,5,489,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#abca93088e8980c97a1a24c4fff31c758" title="Resets all variables that describe a neighbor platoon, so that no neighbor is known." alt="" coords="559,39,768,95"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#af2f0d9818d07db4a4df484f988635201" title="Resets necessary variables to indicate that the current ActionPlan is dead." alt="" coords="280,137,499,178"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a3ef30eeb7a7cf0caccb948e6a41f92" title="Returns total size of the platoon , in number of vehicles." alt="" coords="268,202,511,243"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ab1c204db4a5056621de299a9dd663c6f" title="Resets all variables that might indicate other members of the host&#39;s platoon; sets the host back to s..." alt="" coords="297,267,482,323"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ac969d6086d5fe4b55831015327820688_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ac969d6086d5fe4b55831015327820688_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ac969d6086d5fe4b55831015327820688_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ac969d6086d5fe4b55831015327820688_icgraph">
<area shape="rect" title="Function to process mobility response in candidate follower state." alt="" coords="429,5,644,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aaca0c4143be4a27041ab5ed90d2c624c" title="Callback function for Mobility Response Message." alt="" coords="199,5,381,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,5,151,61"/>
</map>
</div>

</div>
</div>
<a id="a6e3fa57a6b2cec7e2ecd915863ca590b" name="a6e3fa57a6b2cec7e2ecd915863ca590b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e3fa57a6b2cec7e2ecd915863ca590b">&#9670;&nbsp;</a></span>mob_resp_cb_candidateleader()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_resp_cb_candidateleader </td>
          <td>(</td>
          <td class="paramtype">const carma_v2x_msgs::msg::MobilityResponse &amp;&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to process mobility response in candidateleader state. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>incoming mobility response. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02443">2443</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2444</span>    {</div>
<div class="line"><span class="lineno"> 2445</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;CANDIDATELEADER state does nothing with msg from &quot;</span> &lt;&lt; msg.m_header.sender_id);</div>
<div class="line"><span class="lineno"> 2446</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02077">mob_resp_cb()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a6e3fa57a6b2cec7e2ecd915863ca590b_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a6e3fa57a6b2cec7e2ecd915863ca590b_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a6e3fa57a6b2cec7e2ecd915863ca590b_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a6e3fa57a6b2cec7e2ecd915863ca590b_icgraph">
<area shape="rect" title="Function to process mobility response in candidateleader state." alt="" coords="429,5,633,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aaca0c4143be4a27041ab5ed90d2c624c" title="Callback function for Mobility Response Message." alt="" coords="199,5,381,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,5,151,61"/>
</map>
</div>

</div>
</div>
<a id="a80d39ab680172d7379e4038d41b50a39" name="a80d39ab680172d7379e4038d41b50a39"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80d39ab680172d7379e4038d41b50a39">&#9670;&nbsp;</a></span>mob_resp_cb_follower()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_resp_cb_follower </td>
          <td>(</td>
          <td class="paramtype">const carma_v2x_msgs::msg::MobilityResponse &amp;&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to process mobility response in follower state. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>incoming mobility response </td></tr>
  </table>
  </dd>
</dl>
<p >UCLA Note:</p>
<p >This method was implemented with the purpose of updating the platoon related references (i.e., platoon leader, platoon Id) to the new leader that joined from front. Changing the existing follower to candidate follower state will initiate a member update and therefore point all refernce to the new leader.</p>
<p >For rear join, since the existing follower already following the platoon leader. There is no need to establish communication hence no response will be handled for rear-join.</p>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02220">2220</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2221</span>    {   </div>
<div class="line"><span class="lineno"> 2234</span>        <span class="comment">// UCLA: read plan type </span></div>
<div class="line"><span class="lineno"> 2235</span>        carma_v2x_msgs::msg::PlanType plan_type = msg.plan_type;</div>
<div class="line"><span class="lineno"> 2236</span>        </div>
<div class="line"><span class="lineno"> 2237</span>        <span class="comment">// UCLA: determine joining type </span></div>
<div class="line"><span class="lineno"> 2238</span>        <span class="keywordtype">bool</span> isFrontJoin = (plan_type.type == carma_v2x_msgs::msg::PlanType::JOIN_PLATOON_FROM_FRONT);</div>
<div class="line"><span class="lineno"> 2239</span> </div>
<div class="line"><span class="lineno"> 2240</span>        <span class="comment">//TODO: when would this code block ever be used? A normal follower would have to talk to a front joiner.</span></div>
<div class="line"><span class="lineno"> 2241</span>        <span class="comment">// UCLA: add response so follower can change to candidate follower, then change leader</span></div>
<div class="line"><span class="lineno"> 2242</span>        <span class="keywordflow">if</span> (isFrontJoin &amp;&amp; msg.is_accepted)</div>
<div class="line"><span class="lineno"> 2243</span>        {   </div>
<div class="line"><span class="lineno"> 2244</span>            <span class="comment">// if frontal join is accepted, change followers to candidate follower to update leader</span></div>
<div class="line"><span class="lineno"> 2245</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Received positive response for front-join plan id = &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a34c7e7384914852c5549e8d2a14dc6e9">planId</a>);</div>
<div class="line"><span class="lineno"> 2246</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Change to CandidateFollower state and prepare to update platoon information&quot;</span>);</div>
<div class="line"><span class="lineno"> 2247</span>            <span class="comment">// Change to candidate follower state and request a new plan to catch up with the front platoon</span></div>
<div class="line"><span class="lineno"> 2248</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> = <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafab7680aa6ec3a24dc42cb374192eb39a3">PlatoonState::CANDIDATEFOLLOWER</a>;</div>
<div class="line"><span class="lineno"> 2249</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa30dd7c98fe60faad9ba8af0da2da581">candidatestateStartTime</a> = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a283186f2bbb98f5f85b5486e365bb4b8">timer_factory_</a>-&gt;now().nanoseconds() / 1000000;</div>
<div class="line"><span class="lineno"> 2250</span>        }</div>
<div class="line"><span class="lineno"> 2251</span>        </div>
<div class="line"><span class="lineno"> 2252</span>        <span class="comment">// TODO: Place holder for follower departure.</span></div>
<div class="line"><span class="lineno"> 2253</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__manager__ihp_8h_source.html#l00081">platoon_strategic_ihp::CANDIDATEFOLLOWER</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00336">candidatestateStartTime</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00376">platoon_strategic_ihp::PlatoonManager::current_plan</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00370">platoon_strategic_ihp::PlatoonManager::current_platoon_state</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00049">platoon_strategic_ihp::ActionPlan::planId</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00817">pm_</a>, and <a class="el" href="platoon__strategic__ihp_8h_source.html#l00814">timer_factory_</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02077">mob_resp_cb()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a80d39ab680172d7379e4038d41b50a39_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a80d39ab680172d7379e4038d41b50a39_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a80d39ab680172d7379e4038d41b50a39_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a80d39ab680172d7379e4038d41b50a39_icgraph">
<area shape="rect" title="Function to process mobility response in follower state." alt="" coords="429,5,612,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aaca0c4143be4a27041ab5ed90d2c624c" title="Callback function for Mobility Response Message." alt="" coords="199,5,381,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,5,151,61"/>
</map>
</div>

</div>
</div>
<a id="a7fcd17fc2e2649934215719e473c52bb" name="a7fcd17fc2e2649934215719e473c52bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7fcd17fc2e2649934215719e473c52bb">&#9670;&nbsp;</a></span>mob_resp_cb_leader()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_resp_cb_leader </td>
          <td>(</td>
          <td class="paramtype">const carma_v2x_msgs::msg::MobilityResponse &amp;&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to process mobility response in leader state. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>incoming mobility response </td></tr>
  </table>
  </dd>
</dl>
<p >UCLA implementation note: This is where the Mobility response gets processed for leader state.</p>
<p >If the host is a single vehicle in the leader state, then the host vehicle is the joiner vehicle (frontal join: candidate leader; back join: candidate follower), and the response sender is the existing platoon leader (front join: aborting leader, back join: waiting leader).</p>
<p >If the host is the current platoon leader, all three case will be false and no further action is needed.</p>
<p >Disclaimer: Currently, if the host vehicle is platoon leader, there is no further action needed when receiving the mobility response. However, future development may add functions in this mehtod.</p>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02256">2256</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2257</span>    {   </div>
<div class="line"><span class="lineno"> 2272</span>        <span class="comment">// UCLA: read plan type </span></div>
<div class="line"><span class="lineno"> 2273</span>        carma_v2x_msgs::msg::PlanType plan_type = msg.plan_type;</div>
<div class="line"><span class="lineno"> 2274</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;plan_type.type = &quot;</span> &lt;&lt; plan_type.type);</div>
<div class="line"><span class="lineno"> 2275</span>        </div>
<div class="line"><span class="lineno"> 2276</span>        <span class="comment">// UCLA: determine joining type </span></div>
<div class="line"><span class="lineno"> 2277</span>        <span class="keywordtype">bool</span> isCutInJoin = plan_type.type == carma_v2x_msgs::msg::PlanType::PLATOON_CUT_IN_JOIN      &amp;&amp;  !<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#ab266d02c1852c6a1a2bff65a5e0d78b0">test_front_join</a>;</div>
<div class="line"><span class="lineno"> 2278</span>        <span class="keywordtype">bool</span> isRearJoin = plan_type.type == carma_v2x_msgs::msg::PlanType::JOIN_PLATOON_AT_REAR      &amp;&amp;  !<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#ab266d02c1852c6a1a2bff65a5e0d78b0">test_front_join</a>;</div>
<div class="line"><span class="lineno"> 2279</span>        <span class="keywordtype">bool</span> isFrontJoin = plan_type.type == carma_v2x_msgs::msg::PlanType::JOIN_PLATOON_FROM_FRONT  ||  <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#ab266d02c1852c6a1a2bff65a5e0d78b0">test_front_join</a>;</div>
<div class="line"><span class="lineno"> 2280</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Joining type: isRearJoin = &quot;</span> &lt;&lt; isRearJoin);</div>
<div class="line"><span class="lineno"> 2281</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Joining type: isFrontJoin = &quot;</span> &lt;&lt; isFrontJoin);</div>
<div class="line"><span class="lineno"> 2282</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Joining type: isCutInJoin = &quot;</span> &lt;&lt; isCutInJoin);</div>
<div class="line"><span class="lineno"> 2283</span>        </div>
<div class="line"><span class="lineno"> 2284</span>        <span class="comment">// Check if current plan is still valid (i.e., not timed out).</span></div>
<div class="line"><span class="lineno"> 2285</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a9474313cd68557978e8dbd481d0408bc">valid</a>)</div>
<div class="line"><span class="lineno"> 2286</span>        {</div>
<div class="line"><span class="lineno"> 2287</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;My plan id = &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a34c7e7384914852c5549e8d2a14dc6e9">planId</a> &lt;&lt; <span class="stringliteral">&quot; and response plan Id = &quot;</span> &lt;&lt; msg.m_header.plan_id);</div>
<div class="line"><span class="lineno"> 2288</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Expected peer id = &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a38851b8c1a54cc039c86fa3576c940e4">peerId</a> &lt;&lt; <span class="stringliteral">&quot; and response sender Id = &quot;</span> &lt;&lt; msg.m_header.sender_id);</div>
<div class="line"><span class="lineno"> 2289</span> </div>
<div class="line"><span class="lineno"> 2290</span>            <span class="comment">// Check the response is received correctly (i.e., host vehicle is the desired receiver).</span></div>
<div class="line"><span class="lineno"> 2291</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a34c7e7384914852c5549e8d2a14dc6e9">planId</a> == msg.m_header.plan_id &amp;&amp; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a38851b8c1a54cc039c86fa3576c940e4">peerId</a> == msg.m_header.sender_id) </div>
<div class="line"><span class="lineno"> 2292</span>            {   </div>
<div class="line"><span class="lineno"> 2293</span>                <span class="comment">// rear join</span></div>
<div class="line"><span class="lineno"> 2294</span>                <span class="keywordflow">if</span> (isRearJoin &amp;&amp; msg.is_accepted)</div>
<div class="line"><span class="lineno"> 2295</span>                {</div>
<div class="line"><span class="lineno"> 2296</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Received positive response for plan id = &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a34c7e7384914852c5549e8d2a14dc6e9">planId</a>);</div>
<div class="line"><span class="lineno"> 2297</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Change to CandidateFollower state and notify trajectory failure in order to replan&quot;</span>);</div>
<div class="line"><span class="lineno"> 2298</span> </div>
<div class="line"><span class="lineno"> 2299</span>                    <span class="comment">// Change to candidate follower state and wait to catch up with the front platoon</span></div>
<div class="line"><span class="lineno"> 2300</span>                    <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> = <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafab7680aa6ec3a24dc42cb374192eb39a3">PlatoonState::CANDIDATEFOLLOWER</a>;</div>
<div class="line"><span class="lineno"> 2301</span>                    <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa30dd7c98fe60faad9ba8af0da2da581">candidatestateStartTime</a> = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a283186f2bbb98f5f85b5486e365bb4b8">timer_factory_</a>-&gt;now().nanoseconds() / 1000000;</div>
<div class="line"><span class="lineno"> 2302</span>                    <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a9474313cd68557978e8dbd481d0408bc">valid</a> = <span class="keyword">false</span>; <span class="comment">//but leave peerId intact for use in second request</span></div>
<div class="line"><span class="lineno"> 2303</span>                }</div>
<div class="line"><span class="lineno"> 2304</span> </div>
<div class="line"><span class="lineno"> 2305</span>                <span class="comment">// UCLA: frontal join (candidate leader, inherited from leaderwaiting)</span></div>
<div class="line"><span class="lineno"> 2306</span>                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isFrontJoin &amp;&amp; msg.is_accepted)</div>
<div class="line"><span class="lineno"> 2307</span>                {   </div>
<div class="line"><span class="lineno"> 2308</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Received positive response for plan id = &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a34c7e7384914852c5549e8d2a14dc6e9">planId</a>);</div>
<div class="line"><span class="lineno"> 2309</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Change to CandidateLeader state and prepare to become new leader. &quot;</span>);</div>
<div class="line"><span class="lineno"> 2310</span> </div>
<div class="line"><span class="lineno"> 2311</span>                    <span class="comment">// Change to candidate leader and idle</span></div>
<div class="line"><span class="lineno"> 2312</span>                    <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> = <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa52c17c95a5cd81220db3fdd9181d43bd">PlatoonState::CANDIDATELEADER</a>;</div>
<div class="line"><span class="lineno"> 2313</span>                    <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa30dd7c98fe60faad9ba8af0da2da581">candidatestateStartTime</a> = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a283186f2bbb98f5f85b5486e365bb4b8">timer_factory_</a>-&gt;now().nanoseconds() / 1000000;</div>
<div class="line"><span class="lineno"> 2314</span>                    <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a9474313cd68557978e8dbd481d0408bc">valid</a> = <span class="keyword">false</span>; <span class="comment">//but leave peerId intact for use in second request</span></div>
<div class="line"><span class="lineno"> 2315</span> </div>
<div class="line"><span class="lineno"> 2316</span>                    <span class="comment">// Set the platoon ID to that of the target platoon even though we haven&#39;t yet joined;</span></div>
<div class="line"><span class="lineno"> 2317</span>                    <span class="comment">// for front join this is necessary for the aborting leader to recognize us as an incoming</span></div>
<div class="line"><span class="lineno"> 2318</span>                    <span class="comment">// member (via our published op STATUS messages)</span></div>
<div class="line"><span class="lineno"> 2319</span>                    <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a634f99de503cccb2f2d3cb955623dde2">currentPlatoonID</a> = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#abc319b76af0eecaba8e0fe0718457618">targetPlatoonID</a>;</div>
<div class="line"><span class="lineno"> 2320</span>                }</div>
<div class="line"><span class="lineno"> 2321</span> </div>
<div class="line"><span class="lineno"> 2322</span>                <span class="comment">// UCLA: CutIn join </span></div>
<div class="line"><span class="lineno"> 2323</span>                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isCutInJoin &amp;&amp; msg.is_accepted)</div>
<div class="line"><span class="lineno"> 2324</span>                {</div>
<div class="line"><span class="lineno"> 2325</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Received positive response for plan id = &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a34c7e7384914852c5549e8d2a14dc6e9">planId</a>);</div>
<div class="line"><span class="lineno"> 2326</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Change to Prepare to join state and prepare to change lane. &quot;</span>);</div>
<div class="line"><span class="lineno"> 2327</span> </div>
<div class="line"><span class="lineno"> 2328</span>                    <span class="comment">// Change to candidate leader and idle</span></div>
<div class="line"><span class="lineno"> 2329</span>                    <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> = <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafafe45c20d03a8d502486cff766672bdf9">PlatoonState::PREPARETOJOIN</a>;</div>
<div class="line"><span class="lineno"> 2330</span>                    <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8fa6576577e52bb8e1a31fef457defa9">neighbor_platoon_leader_id_</a> = msg.m_header.sender_id;</div>
<div class="line"><span class="lineno"> 2331</span>                    <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa30dd7c98fe60faad9ba8af0da2da581">candidatestateStartTime</a> = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a283186f2bbb98f5f85b5486e365bb4b8">timer_factory_</a>-&gt;now().nanoseconds() / 1000000;</div>
<div class="line"><span class="lineno"> 2332</span>                    <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a9474313cd68557978e8dbd481d0408bc">valid</a> = <span class="keyword">false</span>; <span class="comment">//but leave peerId intact for use in second request</span></div>
<div class="line"><span class="lineno"> 2333</span>                }</div>
<div class="line"><span class="lineno"> 2334</span> </div>
<div class="line"><span class="lineno"> 2335</span>                <span class="comment">// Current leader of an actual platoon (to be in this method host is in leader state)</span></div>
<div class="line"><span class="lineno"> 2336</span>                <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a3ef30eeb7a7cf0caccb948e6a41f92">getHostPlatoonSize</a>() &gt;= 2)</div>
<div class="line"><span class="lineno"> 2337</span>                {</div>
<div class="line"><span class="lineno"> 2338</span>                    <span class="comment">//TODO future: add logic here to allow two platoons to join together</span></div>
<div class="line"><span class="lineno"> 2339</span> </div>
<div class="line"><span class="lineno"> 2340</span>                    <span class="comment">// Keep the leader idling, since this must be a bogus response</span></div>
<div class="line"><span class="lineno"> 2341</span>                    RCLCPP_WARN_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Host received response for joining vehicles, remain idling as the host is a current platoon leader.&quot;</span>);</div>
<div class="line"><span class="lineno"> 2342</span>                }</div>
<div class="line"><span class="lineno"> 2343</span>                <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2344</span>                {</div>
<div class="line"><span class="lineno"> 2345</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Received negative response for plan id = &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a34c7e7384914852c5549e8d2a14dc6e9">planId</a> &lt;&lt; <span class="stringliteral">&quot;. Resetting plan &amp; platoon info.&quot;</span>);</div>
<div class="line"><span class="lineno"> 2346</span>                    <span class="comment">// Forget about the previous plan totally</span></div>
<div class="line"><span class="lineno"> 2347</span>                    <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#af2f0d9818d07db4a4df484f988635201">clearActionPlan</a>();</div>
<div class="line"><span class="lineno"> 2348</span>                    <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ab1c204db4a5056621de299a9dd663c6f">resetHostPlatoon</a>();</div>
<div class="line"><span class="lineno"> 2349</span>                }</div>
<div class="line"><span class="lineno"> 2350</span>            }</div>
<div class="line"><span class="lineno"> 2351</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2352</span>            {</div>
<div class="line"><span class="lineno"> 2353</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Ignore the response message because planID match: &quot;</span> &lt;&lt; (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a34c7e7384914852c5549e8d2a14dc6e9">planId</a> == msg.m_header.plan_id));</div>
<div class="line"><span class="lineno"> 2354</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;My plan id = &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a34c7e7384914852c5549e8d2a14dc6e9">planId</a> &lt;&lt; <span class="stringliteral">&quot; and response plan Id = &quot;</span> &lt;&lt; msg.m_header.plan_id);</div>
<div class="line"><span class="lineno"> 2355</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;And peer id match &quot;</span> &lt;&lt; (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a38851b8c1a54cc039c86fa3576c940e4">peerId</a> == msg.m_header.sender_id));</div>
<div class="line"><span class="lineno"> 2356</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Expected peer id = &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a38851b8c1a54cc039c86fa3576c940e4">peerId</a> &lt;&lt; <span class="stringliteral">&quot; and response sender Id = &quot;</span> &lt;&lt; msg.m_header.sender_id);</div>
<div class="line"><span class="lineno"> 2357</span>            }</div>
<div class="line"><span class="lineno"> 2358</span>        }</div>
<div class="line"><span class="lineno"> 2359</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__manager__ihp_8h_source.html#l00081">platoon_strategic_ihp::CANDIDATEFOLLOWER</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00086">platoon_strategic_ihp::CANDIDATELEADER</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00336">candidatestateStartTime</a>, <a class="el" href="platoon__manager__ihp_8cpp_source.html#l00285">platoon_strategic_ihp::PlatoonManager::clearActionPlan()</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00318">config_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00376">platoon_strategic_ihp::PlatoonManager::current_plan</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00370">platoon_strategic_ihp::PlatoonManager::current_platoon_state</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00364">platoon_strategic_ihp::PlatoonManager::currentPlatoonID</a>, <a class="el" href="platoon__manager__ihp_8cpp_source.html#l00279">platoon_strategic_ihp::PlatoonManager::getHostPlatoonSize()</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00395">platoon_strategic_ihp::PlatoonManager::neighbor_platoon_leader_id_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00050">platoon_strategic_ihp::ActionPlan::peerId</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00049">platoon_strategic_ihp::ActionPlan::planId</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00817">pm_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00090">platoon_strategic_ihp::PREPARETOJOIN</a>, <a class="el" href="platoon__manager__ihp_8cpp_source.html#l00295">platoon_strategic_ihp::PlatoonManager::resetHostPlatoon()</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00390">platoon_strategic_ihp::PlatoonManager::targetPlatoonID</a>, <a class="el" href="platoon__config__ihp_8h_source.html#l00083">platoon_strategic_ihp::PlatoonPluginConfig::test_front_join</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00814">timer_factory_</a>, and <a class="el" href="platoon__manager__ihp_8h_source.html#l00047">platoon_strategic_ihp::ActionPlan::valid</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02077">mob_resp_cb()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a7fcd17fc2e2649934215719e473c52bb_cgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a7fcd17fc2e2649934215719e473c52bb_cgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a7fcd17fc2e2649934215719e473c52bb_cgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a7fcd17fc2e2649934215719e473c52bb_cgraph">
<area shape="rect" title="Function to process mobility response in leader state." alt="" coords="5,63,188,119"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#af2f0d9818d07db4a4df484f988635201" title="Resets necessary variables to indicate that the current ActionPlan is dead." alt="" coords="248,5,467,47"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a3ef30eeb7a7cf0caccb948e6a41f92" title="Returns total size of the platoon , in number of vehicles." alt="" coords="236,71,479,112"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ab1c204db4a5056621de299a9dd663c6f" title="Resets all variables that might indicate other members of the host&#39;s platoon; sets the host back to s..." alt="" coords="265,135,450,191"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a7fcd17fc2e2649934215719e473c52bb_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a7fcd17fc2e2649934215719e473c52bb_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a7fcd17fc2e2649934215719e473c52bb_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a7fcd17fc2e2649934215719e473c52bb_icgraph">
<area shape="rect" title="Function to process mobility response in leader state." alt="" coords="429,5,612,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aaca0c4143be4a27041ab5ed90d2c624c" title="Callback function for Mobility Response Message." alt="" coords="199,5,381,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,5,151,61"/>
</map>
</div>

</div>
</div>
<a id="aeba3a1dd3fc9411891a1fe1eac8c3993" name="aeba3a1dd3fc9411891a1fe1eac8c3993"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeba3a1dd3fc9411891a1fe1eac8c3993">&#9670;&nbsp;</a></span>mob_resp_cb_leaderaborting()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_resp_cb_leaderaborting </td>
          <td>(</td>
          <td class="paramtype">const carma_v2x_msgs::msg::MobilityResponse &amp;&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to process mobility response in leaderaborting state. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>incoming mobility response. </td></tr>
  </table>
  </dd>
</dl>
<p >UCLA implementation note: This state is the middle state to handle the leader aborting process of the previous platoon leader in a front join scenario. Within this state, the previous leader will check for front joining vehicle's position and will not handle any further mobility requests.</p>
<p >Note: As the previous leader will join the new leader (joined from front), the corresponding join request will be send out by the previos leader.</p>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02362">2362</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2363</span>    {   </div>
<div class="line"><span class="lineno"> 2375</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Callback for leader aborting !&quot;</span>);</div>
<div class="line"><span class="lineno"> 2376</span> </div>
<div class="line"><span class="lineno"> 2377</span>        <span class="comment">// Check if current plan is still valid (i.e., not timed out).</span></div>
<div class="line"><span class="lineno"> 2378</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a9474313cd68557978e8dbd481d0408bc">valid</a>)</div>
<div class="line"><span class="lineno"> 2379</span>        {</div>
<div class="line"><span class="lineno"> 2380</span>            <span class="keywordtype">bool</span> isForCurrentPlan = msg.m_header.plan_id == <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a34c7e7384914852c5549e8d2a14dc6e9">planId</a>;</div>
<div class="line"><span class="lineno"> 2381</span>            <span class="keywordtype">bool</span> isForFrontJoin = msg.plan_type.type == carma_v2x_msgs::msg::PlanType::PLATOON_FRONT_JOIN;</div>
<div class="line"><span class="lineno"> 2382</span> </div>
<div class="line"><span class="lineno"> 2383</span>            <span class="keywordflow">if</span> (msg.plan_type.type == carma_v2x_msgs::msg::PlanType::UNKNOWN){</div>
<div class="line"><span class="lineno"> 2384</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;*** plan type UNKNOWN&quot;</span>);</div>
<div class="line"><span class="lineno"> 2385</span>            }<span class="keywordflow">else</span> <span class="keywordflow">if</span> (msg.plan_type.type == carma_v2x_msgs::msg::PlanType::JOIN_PLATOON_FROM_FRONT){</div>
<div class="line"><span class="lineno"> 2386</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;*** plan type JOIN_PLATOON_FROM_FRONT&quot;</span>);</div>
<div class="line"><span class="lineno"> 2387</span>            }<span class="keywordflow">else</span> <span class="keywordflow">if</span> (msg.plan_type.type == carma_v2x_msgs::msg::PlanType::PLATOON_CUT_IN_JOIN){</div>
<div class="line"><span class="lineno"> 2388</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;*** plan type PLATOON_CUT_IN_JOIN&quot;</span>);</div>
<div class="line"><span class="lineno"> 2389</span>            }<span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2390</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;*** plan type not captured.&quot;</span>);</div>
<div class="line"><span class="lineno"> 2391</span>            }</div>
<div class="line"><span class="lineno"> 2392</span> </div>
<div class="line"><span class="lineno"> 2393</span>            <span class="keywordtype">bool</span> isFromTargetVehicle = msg.m_header.sender_id == <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a38851b8c1a54cc039c86fa3576c940e4">peerId</a>;</div>
<div class="line"><span class="lineno"> 2394</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;msg.m_header.sender_id &quot;</span> &lt;&lt; msg.m_header.sender_id);</div>
<div class="line"><span class="lineno"> 2395</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Plan Type &quot;</span> &lt;&lt; msg.plan_type.type);</div>
<div class="line"><span class="lineno"> 2396</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;isForFrontJoin &quot;</span> &lt;&lt; isForFrontJoin);</div>
<div class="line"><span class="lineno"> 2397</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;isForCurrentPlan &quot;</span> &lt;&lt; isForCurrentPlan);</div>
<div class="line"><span class="lineno"> 2398</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;isFromTargetVehicle &quot;</span> &lt;&lt; isFromTargetVehicle);</div>
<div class="line"><span class="lineno"> 2399</span> </div>
<div class="line"><span class="lineno"> 2400</span>            <span class="comment">// Check the response is received correctly (i.e., host vehicle is the desired receiver).</span></div>
<div class="line"><span class="lineno"> 2401</span>            <span class="keywordflow">if</span> (isForCurrentPlan &amp;&amp; isFromTargetVehicle &amp;&amp; isForFrontJoin)</div>
<div class="line"><span class="lineno"> 2402</span>            {</div>
<div class="line"><span class="lineno"> 2403</span>                <span class="keywordflow">if</span> (msg.is_accepted)</div>
<div class="line"><span class="lineno"> 2404</span>                {</div>
<div class="line"><span class="lineno"> 2405</span>                    <span class="comment">// We change to follower state and start to actually follow the new leader</span></div>
<div class="line"><span class="lineno"> 2406</span>                    <span class="comment">// The platoon manager also need to change the platoon Id to the one that the target leader is using                </span></div>
<div class="line"><span class="lineno"> 2407</span>                    <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> = <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa0d2c16ab07ed24865f7ba27ad8a83dc0">PlatoonState::FOLLOWER</a>;</div>
<div class="line"><span class="lineno"> 2408</span>                    <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#aa589c920c9684b42bf8f675c072ddb6b">changeFromLeaderToFollower</a>(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a634f99de503cccb2f2d3cb955623dde2">currentPlatoonID</a>, msg.m_header.sender_id);</div>
<div class="line"><span class="lineno"> 2409</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;The new leader &quot;</span> &lt;&lt; msg.m_header.sender_id &lt;&lt; <span class="stringliteral">&quot; agreed on the frontal join. Change to follower state.&quot;</span>);</div>
<div class="line"><span class="lineno"> 2410</span>                    RCLCPP_WARN(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>),<span class="stringliteral">&quot;changed to follower&quot;</span>);</div>
<div class="line"><span class="lineno"> 2411</span> </div>
<div class="line"><span class="lineno"> 2412</span>                    <span class="comment">// reset leader aborting request marker</span></div>
<div class="line"><span class="lineno"> 2413</span>                    <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a50637636926375340be2ba15d016b06a">numLeaderAbortingCalls_</a> = 0;</div>
<div class="line"><span class="lineno"> 2414</span>                }</div>
<div class="line"><span class="lineno"> 2415</span>                <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2416</span>                {</div>
<div class="line"><span class="lineno"> 2417</span>                    <span class="comment">// We change back to normal leader state</span></div>
<div class="line"><span class="lineno"> 2418</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;The new leader &quot;</span> &lt;&lt; msg.m_header.sender_id &lt;&lt; <span class="stringliteral">&quot; does not agree on the frontal join. Change back to leader state.&quot;</span>);</div>
<div class="line"><span class="lineno"> 2419</span>                    <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> = <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa57f78e815f4fc2ac271a9fd85cd80ebc">PlatoonState::LEADER</a>;</div>
<div class="line"><span class="lineno"> 2420</span>                    <span class="comment">// We were already leading a platoon, so don&#39;t erase any of that info. But we need to remove the erstwhile candidate</span></div>
<div class="line"><span class="lineno"> 2421</span>                    <span class="comment">// leader from our platoon roster; we know it is in position 0, so just remove that element</span></div>
<div class="line"><span class="lineno"> 2422</span>                    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a26f10c9b0d02a6c0a37228583a0385a1">removeMember</a>(0))</div>
<div class="line"><span class="lineno"> 2423</span>                    {</div>
<div class="line"><span class="lineno"> 2424</span>                        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Failed to remove candidate leader from the platoon!&quot;</span>);</div>
<div class="line"><span class="lineno"> 2425</span>                    }</div>
<div class="line"><span class="lineno"> 2426</span>                }</div>
<div class="line"><span class="lineno"> 2427</span> </div>
<div class="line"><span class="lineno"> 2428</span>                <span class="comment">// Clean up the joining plan</span></div>
<div class="line"><span class="lineno"> 2429</span>                <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#af2f0d9818d07db4a4df484f988635201">clearActionPlan</a>();</div>
<div class="line"><span class="lineno"> 2430</span>            }</div>
<div class="line"><span class="lineno"> 2431</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2432</span>            {</div>
<div class="line"><span class="lineno"> 2433</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Ignore received response message because it is not for the current plan.&quot;</span>);</div>
<div class="line"><span class="lineno"> 2434</span>            }</div>
<div class="line"><span class="lineno"> 2435</span>        }</div>
<div class="line"><span class="lineno"> 2436</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2437</span>        {</div>
<div class="line"><span class="lineno"> 2438</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Ignore received response message because we are not in any negotiation process.&quot;</span>);</div>
<div class="line"><span class="lineno"> 2439</span>        }</div>
<div class="line"><span class="lineno"> 2440</span>    }</div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_a26f10c9b0d02a6c0a37228583a0385a1"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a26f10c9b0d02a6c0a37228583a0385a1">platoon_strategic_ihp::PlatoonManager::removeMember</a></div><div class="ttdeci">bool removeMember(const size_t mem)</div><div class="ttdoc">Removes a single member from the internal record of platoon members.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00322">platoon_manager_ihp.cpp:322</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a50637636926375340be2ba15d016b06a"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a50637636926375340be2ba15d016b06a">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::numLeaderAbortingCalls_</a></div><div class="ttdeci">int numLeaderAbortingCalls_</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8h_source.html#l00782">platoon_strategic_ihp.h:782</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__manager__ihp_8cpp_source.html#l00699">platoon_strategic_ihp::PlatoonManager::changeFromLeaderToFollower()</a>, <a class="el" href="platoon__manager__ihp_8cpp_source.html#l00285">platoon_strategic_ihp::PlatoonManager::clearActionPlan()</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00376">platoon_strategic_ihp::PlatoonManager::current_plan</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00370">platoon_strategic_ihp::PlatoonManager::current_platoon_state</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00364">platoon_strategic_ihp::PlatoonManager::currentPlatoonID</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00082">platoon_strategic_ihp::FOLLOWER</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00080">platoon_strategic_ihp::LEADER</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00782">numLeaderAbortingCalls_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00050">platoon_strategic_ihp::ActionPlan::peerId</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00049">platoon_strategic_ihp::ActionPlan::planId</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00817">pm_</a>, <a class="el" href="platoon__manager__ihp_8cpp_source.html#l00322">platoon_strategic_ihp::PlatoonManager::removeMember()</a>, and <a class="el" href="platoon__manager__ihp_8h_source.html#l00047">platoon_strategic_ihp::ActionPlan::valid</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02077">mob_resp_cb()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aeba3a1dd3fc9411891a1fe1eac8c3993_cgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aeba3a1dd3fc9411891a1fe1eac8c3993_cgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aeba3a1dd3fc9411891a1fe1eac8c3993_cgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aeba3a1dd3fc9411891a1fe1eac8c3993_cgraph">
<area shape="rect" title="Function to process mobility response in leaderaborting state." alt="" coords="5,77,200,133"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#aa589c920c9684b42bf8f675c072ddb6b" title="Update status when state change from Leader to Follower." alt="" coords="257,5,457,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#af2f0d9818d07db4a4df484f988635201" title="Resets necessary variables to indicate that the current ActionPlan is dead." alt="" coords="248,85,467,126"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a26f10c9b0d02a6c0a37228583a0385a1" title="Removes a single member from the internal record of platoon members." alt="" coords="248,150,467,191"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#abca93088e8980c97a1a24c4fff31c758" title="Resets all variables that describe a neighbor platoon, so that no neighbor is known." alt="" coords="515,5,724,61"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aeba3a1dd3fc9411891a1fe1eac8c3993_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aeba3a1dd3fc9411891a1fe1eac8c3993_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aeba3a1dd3fc9411891a1fe1eac8c3993_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aeba3a1dd3fc9411891a1fe1eac8c3993_icgraph">
<area shape="rect" title="Function to process mobility response in leaderaborting state." alt="" coords="429,5,624,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aaca0c4143be4a27041ab5ed90d2c624c" title="Callback function for Mobility Response Message." alt="" coords="199,5,381,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,5,151,61"/>
</map>
</div>

</div>
</div>
<a id="ae41ec043178e306fdd909d671877ef9f" name="ae41ec043178e306fdd909d671877ef9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae41ec043178e306fdd909d671877ef9f">&#9670;&nbsp;</a></span>mob_resp_cb_leaderwaiting()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_resp_cb_leaderwaiting </td>
          <td>(</td>
          <td class="paramtype">const carma_v2x_msgs::msg::MobilityResponse &amp;&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to process mobility response in leader waiting state. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>incoming mobility response </td></tr>
  </table>
  </dd>
</dl>
<p >Leader waiting is the state to check joining vehicle is in proper position and to prevent platoon leader from receiving messages from other CAVs in leader state. There was no response involved in this state, hence no action needed in this section. <br  />
</p>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02210">2210</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2211</span>    {</div>
<div class="line"><span class="lineno"> 2217</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;LEADERWAITING state does nothing with msg from &quot;</span> &lt;&lt; msg.m_header.sender_id);</div>
<div class="line"><span class="lineno"> 2218</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02077">mob_resp_cb()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ae41ec043178e306fdd909d671877ef9f_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ae41ec043178e306fdd909d671877ef9f_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ae41ec043178e306fdd909d671877ef9f_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ae41ec043178e306fdd909d671877ef9f_icgraph">
<area shape="rect" title="Function to process mobility response in leader waiting state." alt="" coords="429,5,619,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aaca0c4143be4a27041ab5ed90d2c624c" title="Callback function for Mobility Response Message." alt="" coords="199,5,381,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,5,151,61"/>
</map>
</div>

</div>
</div>
<a id="a1506aaa516eb3c9abae75820206b5c31" name="a1506aaa516eb3c9abae75820206b5c31"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1506aaa516eb3c9abae75820206b5c31">&#9670;&nbsp;</a></span>mob_resp_cb_leadwithoperation()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_resp_cb_leadwithoperation </td>
          <td>(</td>
          <td class="paramtype">const carma_v2x_msgs::msg::MobilityResponse &amp;&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to process mobility response in leadwithoperation state (cut-in join) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>incoming mobility response </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02449">2449</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2450</span>    { </div>
<div class="line"><span class="lineno"> 2451</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;LEADWITHOPERATION state does nothing with msg from &quot;</span> &lt;&lt; msg.m_header.sender_id);</div>
<div class="line"><span class="lineno"> 2452</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02077">mob_resp_cb()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a1506aaa516eb3c9abae75820206b5c31_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a1506aaa516eb3c9abae75820206b5c31_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a1506aaa516eb3c9abae75820206b5c31_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a1506aaa516eb3c9abae75820206b5c31_icgraph">
<area shape="rect" title="Function to process mobility response in leadwithoperation state (cut&#45;in join)" alt="" coords="429,5,644,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aaca0c4143be4a27041ab5ed90d2c624c" title="Callback function for Mobility Response Message." alt="" coords="199,5,381,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,5,151,61"/>
</map>
</div>

</div>
</div>
<a id="a900863cced7c330fb24f93bc33649cd8" name="a900863cced7c330fb24f93bc33649cd8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a900863cced7c330fb24f93bc33649cd8">&#9670;&nbsp;</a></span>mob_resp_cb_preparetojoin()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_resp_cb_preparetojoin </td>
          <td>(</td>
          <td class="paramtype">const carma_v2x_msgs::msg::MobilityResponse &amp;&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to process mobility response in preparetojoin state. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>incoming mobility response </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02455">2455</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2456</span>    {</div>
<div class="line"><span class="lineno"> 2457</span>        <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 2458</span><span class="comment">            If leader notify the member to slow down and ACK the request,</span></div>
<div class="line"><span class="lineno"> 2459</span><span class="comment">            start to check the gap and change lane when gap is large enough </span></div>
<div class="line"><span class="lineno"> 2460</span><span class="comment">        */</span></div>
<div class="line"><span class="lineno"> 2461</span> </div>
<div class="line"><span class="lineno"> 2462</span>        carma_v2x_msgs::msg::PlanType plan_type = msg.plan_type;</div>
<div class="line"><span class="lineno"> 2463</span>        <span class="keywordtype">bool</span> isCreatingGap = plan_type.type == carma_v2x_msgs::msg::PlanType::PLATOON_CUT_IN_JOIN;</div>
<div class="line"><span class="lineno"> 2464</span>        <span class="keywordtype">bool</span> isFinishLaneChangeFront = plan_type.type == carma_v2x_msgs::msg::PlanType::CUT_IN_FRONT_DONE; </div>
<div class="line"><span class="lineno"> 2465</span>        <span class="keywordtype">bool</span> isFinishLaneChangeMidorRear = plan_type.type == carma_v2x_msgs::msg::PlanType::CUT_IN_MID_OR_REAR_DONE;</div>
<div class="line"><span class="lineno"> 2466</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;isCreatingGap = &quot;</span> &lt;&lt; isCreatingGap &lt;&lt; <span class="stringliteral">&quot;, is_neighbor_record_complete = &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a8f2badbbe25d2b4d26e1556fa0aa63">is_neighbor_record_complete_</a>);</div>
<div class="line"><span class="lineno"> 2467</span> </div>
<div class="line"><span class="lineno"> 2468</span>        <span class="keywordflow">if</span> (!msg.is_accepted)</div>
<div class="line"><span class="lineno"> 2469</span>        {</div>
<div class="line"><span class="lineno"> 2470</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Request &quot;</span> &lt;&lt; msg.m_header.plan_id &lt;&lt; <span class="stringliteral">&quot; was rejected by leader.&quot;</span>);</div>
<div class="line"><span class="lineno"> 2471</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Action Plan reset.&quot;</span>);</div>
<div class="line"><span class="lineno"> 2472</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Trying again....&quot;</span>);</div>
<div class="line"><span class="lineno"> 2473</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a9474313cd68557978e8dbd481d0408bc">valid</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2474</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> = <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa57f78e815f4fc2ac271a9fd85cd80ebc">PlatoonState::LEADER</a>;</div>
<div class="line"><span class="lineno"> 2475</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 2476</span>        }</div>
<div class="line"><span class="lineno"> 2477</span>        <span class="comment">// UCLA: Create Gap or perform a rear join (no gap creation necessary)</span></div>
<div class="line"><span class="lineno"> 2478</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;pm_.is_neighbor_record_complete_ &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a8f2badbbe25d2b4d26e1556fa0aa63">is_neighbor_record_complete_</a>);</div>
<div class="line"><span class="lineno"> 2479</span>        <span class="keywordflow">if</span> (isCreatingGap  &amp;&amp;  <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a8f2badbbe25d2b4d26e1556fa0aa63">is_neighbor_record_complete_</a>)</div>
<div class="line"><span class="lineno"> 2480</span>        {</div>
<div class="line"><span class="lineno"> 2481</span>                   </div>
<div class="line"><span class="lineno"> 2482</span>            <span class="comment">// task 2: set indicator if gap is safe</span></div>
<div class="line"><span class="lineno"> 2483</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2bc77445cdb4c025344024395fa94607">safeToLaneChange_</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2484</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Gap is now sufficiently large.&quot;</span>);</div>
<div class="line"><span class="lineno"> 2485</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;in mob_resp_cb safeToLaneChange_: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2bc77445cdb4c025344024395fa94607">safeToLaneChange_</a>);</div>
<div class="line"><span class="lineno"> 2486</span> </div>
<div class="line"><span class="lineno"> 2487</span>            <span class="comment">// task 3: notify gap-rear vehicle to stop slowing down</span></div>
<div class="line"><span class="lineno"> 2488</span>            carma_v2x_msgs::msg::MobilityRequest request;</div>
<div class="line"><span class="lineno"> 2489</span>            request.m_header.plan_id = boost::uuids::to_string(boost::uuids::random_generator()());</div>
<div class="line"><span class="lineno"> 2490</span>            request.m_header.recipient_id = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a38851b8c1a54cc039c86fa3576c940e4">peerId</a>;</div>
<div class="line"><span class="lineno"> 2491</span>            request.m_header.sender_id = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a473bcce97d7c50beaab678372a354c0d">vehicleID</a>;</div>
<div class="line"><span class="lineno"> 2492</span>            request.m_header.timestamp = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a283186f2bbb98f5f85b5486e365bb4b8">timer_factory_</a>-&gt;now().nanoseconds() / 1000000;;</div>
<div class="line"><span class="lineno"> 2493</span>            <span class="comment">// UCLA: A new plan type to stop creat gap.</span></div>
<div class="line"><span class="lineno"> 2494</span>            request.plan_type.type = carma_v2x_msgs::msg::PlanType::STOP_CREATE_GAP;</div>
<div class="line"><span class="lineno"> 2495</span>            request.strategy = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3be0b52376b568130c1c6a5ec5adeb13">PLATOONING_STRATEGY</a>;</div>
<div class="line"><span class="lineno"> 2496</span>            request.urgency = 50;</div>
<div class="line"><span class="lineno"> 2497</span>            request.location = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a11ffedaaa90fe358ecfdccab7c5a428c">pose_to_ecef</a>(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa67d1b97f198e2f088fb24ffb8e0c690">pose_msg_</a>);</div>
<div class="line"><span class="lineno"> 2498</span>            <span class="keywordtype">double</span> platoon_size = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a3ef30eeb7a7cf0caccb948e6a41f92">getHostPlatoonSize</a>(); </div>
<div class="line"><span class="lineno"> 2499</span> </div>
<div class="line"><span class="lineno"> 2500</span>            boost::format fmter(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aca973fa2125f768cffaf33812403f45c">JOIN_PARAMS</a>);</div>
<div class="line"><span class="lineno"> 2501</span>            fmter %platoon_size;                    <span class="comment">//  index = 0</span></div>
<div class="line"><span class="lineno"> 2502</span>            fmter %<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3e827c7f2e764c6e7de83f0a81a9593f">current_speed_</a>;                  <span class="comment">//  index = 1, in m/s</span></div>
<div class="line"><span class="lineno"> 2503</span>            fmter %<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ad10e1df213ec7524892b247d28ec9172">pose_ecef_point_</a>.ecef_x;         <span class="comment">//  index = 2</span></div>
<div class="line"><span class="lineno"> 2504</span>            fmter %<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ad10e1df213ec7524892b247d28ec9172">pose_ecef_point_</a>.ecef_y;         <span class="comment">//  index = 3</span></div>
<div class="line"><span class="lineno"> 2505</span>            fmter %<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ad10e1df213ec7524892b247d28ec9172">pose_ecef_point_</a>.ecef_z;         <span class="comment">//  index = 4   </span></div>
<div class="line"><span class="lineno"> 2506</span>            fmter %<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a94ef4b19b4e5f6befabedd4b14908bdd">target_join_index_</a>;              <span class="comment">//  index = 5</span></div>
<div class="line"><span class="lineno"> 2507</span> </div>
<div class="line"><span class="lineno"> 2508</span>            request.strategy_params = fmter.str();</div>
<div class="line"><span class="lineno"> 2509</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae4e916260ddb6f7eb25da13ef9cb158e">mobility_request_publisher_</a>(request); </div>
<div class="line"><span class="lineno"> 2510</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Published Mobility Candidate-Join request to the leader to stop creating gap&quot;</span>);</div>
<div class="line"><span class="lineno"> 2511</span>        }</div>
<div class="line"><span class="lineno"> 2512</span> </div>
<div class="line"><span class="lineno"> 2513</span>        <span class="comment">// UCLA: Revert to same-lane for cut-in front </span></div>
<div class="line"><span class="lineno"> 2514</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isFinishLaneChangeFront)</div>
<div class="line"><span class="lineno"> 2515</span>        {</div>
<div class="line"><span class="lineno"> 2516</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Cut-in from front lane change finished, the joining vehicle revert to same-lane maneuver.&quot;</span>);</div>
<div class="line"><span class="lineno"> 2517</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> = <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa52c17c95a5cd81220db3fdd9181d43bd">PlatoonState::CANDIDATELEADER</a>;</div>
<div class="line"><span class="lineno"> 2518</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa30dd7c98fe60faad9ba8af0da2da581">candidatestateStartTime</a> = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a283186f2bbb98f5f85b5486e365bb4b8">timer_factory_</a>-&gt;now().nanoseconds() / 1000000;</div>
<div class="line"><span class="lineno"> 2519</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;pm_.currentPlatoonID: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a634f99de503cccb2f2d3cb955623dde2">currentPlatoonID</a>);</div>
<div class="line"><span class="lineno"> 2520</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;pm_.targetPlatoonID: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#abc319b76af0eecaba8e0fe0718457618">targetPlatoonID</a>);</div>
<div class="line"><span class="lineno"> 2521</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#abc319b76af0eecaba8e0fe0718457618">targetPlatoonID</a>.compare(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ae067830e0351c8ba271b00cb4a6f15c1">dummyID</a>) != 0)</div>
<div class="line"><span class="lineno"> 2522</span>            {</div>
<div class="line"><span class="lineno"> 2523</span>                <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a634f99de503cccb2f2d3cb955623dde2">currentPlatoonID</a> = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#abc319b76af0eecaba8e0fe0718457618">targetPlatoonID</a>;</div>
<div class="line"><span class="lineno"> 2524</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;pm_.currentPlatoonID now: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a634f99de503cccb2f2d3cb955623dde2">currentPlatoonID</a>);</div>
<div class="line"><span class="lineno"> 2525</span>            }</div>
<div class="line"><span class="lineno"> 2526</span>            </div>
<div class="line"><span class="lineno"> 2527</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a9474313cd68557978e8dbd481d0408bc">valid</a> = <span class="keyword">false</span>; <span class="comment">//but leave peerId intact for use in second request</span></div>
<div class="line"><span class="lineno"> 2528</span>        }</div>
<div class="line"><span class="lineno"> 2529</span> </div>
<div class="line"><span class="lineno"> 2530</span>        <span class="comment">// UCLA: Revert to same-lane operation for cut-in from middle/rear </span></div>
<div class="line"><span class="lineno"> 2531</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isFinishLaneChangeMidorRear)</div>
<div class="line"><span class="lineno"> 2532</span>        {</div>
<div class="line"><span class="lineno"> 2533</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Cut-in from mid or rear, the lane change finished, the joining vehicle revert to same-lane maneuver.&quot;</span>);</div>
<div class="line"><span class="lineno"> 2534</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> = <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafab7680aa6ec3a24dc42cb374192eb39a3">PlatoonState::CANDIDATEFOLLOWER</a>;</div>
<div class="line"><span class="lineno"> 2535</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa30dd7c98fe60faad9ba8af0da2da581">candidatestateStartTime</a> = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a283186f2bbb98f5f85b5486e365bb4b8">timer_factory_</a>-&gt;now().nanoseconds() / 1000000;</div>
<div class="line"><span class="lineno"> 2536</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a9474313cd68557978e8dbd481d0408bc">valid</a> = <span class="keyword">false</span>; <span class="comment">//but leave peerId intact for use in second request</span></div>
<div class="line"><span class="lineno"> 2537</span> </div>
<div class="line"><span class="lineno"> 2538</span>        } </div>
<div class="line"><span class="lineno"> 2539</span> </div>
<div class="line"><span class="lineno"> 2540</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2541</span>        {</div>
<div class="line"><span class="lineno"> 2542</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;End of mob_resp_cb_preparetojoin&quot;</span>);</div>
<div class="line"><span class="lineno"> 2543</span>        }</div>
<div class="line"><span class="lineno"> 2544</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__manager__ihp_8h_source.html#l00081">platoon_strategic_ihp::CANDIDATEFOLLOWER</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00086">platoon_strategic_ihp::CANDIDATELEADER</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00336">candidatestateStartTime</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00318">config_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00376">platoon_strategic_ihp::PlatoonManager::current_plan</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00370">platoon_strategic_ihp::PlatoonManager::current_platoon_state</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00328">current_speed_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00364">platoon_strategic_ihp::PlatoonManager::currentPlatoonID</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00358">platoon_strategic_ihp::PlatoonManager::dummyID</a>, <a class="el" href="platoon__manager__ihp_8cpp_source.html#l00279">platoon_strategic_ihp::PlatoonManager::getHostPlatoonSize()</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00398">platoon_strategic_ihp::PlatoonManager::is_neighbor_record_complete_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00858">JOIN_PARAMS</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00080">platoon_strategic_ihp::LEADER</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00308">mobility_request_publisher_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00050">platoon_strategic_ihp::ActionPlan::peerId</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00820">PLATOONING_STRATEGY</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00817">pm_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00257">pose_ecef_point_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00322">pose_msg_</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00064">pose_to_ecef()</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00811">safeToLaneChange_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00808">target_join_index_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00390">platoon_strategic_ihp::PlatoonManager::targetPlatoonID</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00814">timer_factory_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00047">platoon_strategic_ihp::ActionPlan::valid</a>, and <a class="el" href="platoon__config__ihp_8h_source.html#l00068">platoon_strategic_ihp::PlatoonPluginConfig::vehicleID</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02077">mob_resp_cb()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a900863cced7c330fb24f93bc33649cd8_cgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a900863cced7c330fb24f93bc33649cd8_cgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a900863cced7c330fb24f93bc33649cd8_cgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a900863cced7c330fb24f93bc33649cd8_cgraph">
<area shape="rect" title="Function to process mobility response in preparetojoin state." alt="" coords="5,34,192,90"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a3ef30eeb7a7cf0caccb948e6a41f92" title="Returns total size of the platoon , in number of vehicles." alt="" coords="240,5,483,47"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a11ffedaaa90fe358ecfdccab7c5a428c" title="Function to convert pose from map frame to ecef location." alt="" coords="270,70,453,126"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a900863cced7c330fb24f93bc33649cd8_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a900863cced7c330fb24f93bc33649cd8_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a900863cced7c330fb24f93bc33649cd8_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a900863cced7c330fb24f93bc33649cd8_icgraph">
<area shape="rect" title="Function to process mobility response in preparetojoin state." alt="" coords="429,5,616,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aaca0c4143be4a27041ab5ed90d2c624c" title="Callback function for Mobility Response Message." alt="" coords="199,5,381,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,5,151,61"/>
</map>
</div>

</div>
</div>
<a id="ab0c666183fb0cb94767b87309404a8f6" name="ab0c666183fb0cb94767b87309404a8f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0c666183fb0cb94767b87309404a8f6">&#9670;&nbsp;</a></span>mob_resp_cb_standby()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mob_resp_cb_standby </td>
          <td>(</td>
          <td class="paramtype">const carma_v2x_msgs::msg::MobilityResponse &amp;&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to process mobility response in standby state. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>incoming mobility response </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02140">2140</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2141</span>    {</div>
<div class="line"><span class="lineno"> 2142</span>        <span class="comment">// In standby state, it will not send out any requests so it will also ignore all responses</span></div>
<div class="line"><span class="lineno"> 2143</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;STANDBY state does nothing with msg from &quot;</span> &lt;&lt; msg.m_header.sender_id);</div>
<div class="line"><span class="lineno"> 2144</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02077">mob_resp_cb()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ab0c666183fb0cb94767b87309404a8f6_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ab0c666183fb0cb94767b87309404a8f6_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ab0c666183fb0cb94767b87309404a8f6_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ab0c666183fb0cb94767b87309404a8f6_icgraph">
<area shape="rect" title="Function to process mobility response in standby state." alt="" coords="429,5,612,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aaca0c4143be4a27041ab5ed90d2c624c" title="Callback function for Mobility Response Message." alt="" coords="199,5,381,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,5,151,61"/>
</map>
</div>

</div>
</div>
<a id="ac7e7160659b61a4ac61be14f74fb1caa" name="ac7e7160659b61a4ac61be14f74fb1caa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7e7160659b61a4ac61be14f74fb1caa">&#9670;&nbsp;</a></span>onSpin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> platoon_strategic_ihp::PlatoonStrategicIHPPlugin::onSpin </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Spin callback function. </p>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l03060">3060</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3061</span>    {        </div>
<div class="line"><span class="lineno"> 3062</span>        <span class="comment">// Update the platoon manager for host&#39;s current location &amp; speeds</span></div>
<div class="line"><span class="lineno"> 3063</span>        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ab1710b942f6893b756b67dd6505ee90b">updateHostPose</a>(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa53003d4c3610dbb5f87762a6683dd9f">current_downtrack_</a>, <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a79aaef859aaa4b64f6cf79c50c596bc3">current_crosstrack_</a>);</div>
<div class="line"><span class="lineno"> 3064</span>        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a686ffb96fbf0c728db7d12d03f1932c9">updateHostSpeeds</a>(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3e827c7f2e764c6e7de83f0a81a9593f">current_speed_</a>, <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a04e00e8747e98a33b4f708b8e9e58042">cmd_speed_</a>);</div>
<div class="line"><span class="lineno"> 3065</span> </div>
<div class="line"><span class="lineno"> 3066</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> == <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa57f78e815f4fc2ac271a9fd85cd80ebc">PlatoonState::LEADER</a>)</div>
<div class="line"><span class="lineno"> 3067</span>        {</div>
<div class="line"><span class="lineno"> 3068</span>            <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#acf8506705dea8579268655c4fdeb4ddf">run_leader</a>();</div>
<div class="line"><span class="lineno"> 3069</span>        }</div>
<div class="line"><span class="lineno"> 3070</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> == <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa0d2c16ab07ed24865f7ba27ad8a83dc0">PlatoonState::FOLLOWER</a>)</div>
<div class="line"><span class="lineno"> 3071</span>        {</div>
<div class="line"><span class="lineno"> 3072</span>            <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3e9dbfe57693b6d23d99b61af6375a4f">run_follower</a>();</div>
<div class="line"><span class="lineno"> 3073</span>        }</div>
<div class="line"><span class="lineno"> 3074</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> == <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafab7680aa6ec3a24dc42cb374192eb39a3">PlatoonState::CANDIDATEFOLLOWER</a>)</div>
<div class="line"><span class="lineno"> 3075</span>        {</div>
<div class="line"><span class="lineno"> 3076</span>            <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a7d07b2ec081219ee9fb62418170bb1f8">run_candidate_follower</a>();</div>
<div class="line"><span class="lineno"> 3077</span>        }</div>
<div class="line"><span class="lineno"> 3078</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> == <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa70d610aa504abb163caf9a5ee931d090">PlatoonState::LEADERWAITING</a>)</div>
<div class="line"><span class="lineno"> 3079</span>        {</div>
<div class="line"><span class="lineno"> 3080</span>            <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a7bcebb0d98ab80013c945a2ec283250e">run_leader_waiting</a>();</div>
<div class="line"><span class="lineno"> 3081</span>        }</div>
<div class="line"><span class="lineno"> 3082</span>        <span class="comment">// UCLA: added for frontal join</span></div>
<div class="line"><span class="lineno"> 3083</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> == <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafae176dd79ff2c2bc4b2f7901fbfc53014">PlatoonState::LEADERABORTING</a>)</div>
<div class="line"><span class="lineno"> 3084</span>        {</div>
<div class="line"><span class="lineno"> 3085</span>            <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a848aac5dfc1f6a3c4fba8fa0bba0ca66">run_leader_aborting</a>();</div>
<div class="line"><span class="lineno"> 3086</span>        }</div>
<div class="line"><span class="lineno"> 3087</span>        <span class="comment">// UCLA: added for frontal join</span></div>
<div class="line"><span class="lineno"> 3088</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> == <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa52c17c95a5cd81220db3fdd9181d43bd">PlatoonState::CANDIDATELEADER</a>)</div>
<div class="line"><span class="lineno"> 3089</span>        {</div>
<div class="line"><span class="lineno"> 3090</span>            <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa2c3c1b6030726c8e1931ea0093dd91d">run_candidate_leader</a>();</div>
<div class="line"><span class="lineno"> 3091</span>        }</div>
<div class="line"><span class="lineno"> 3092</span>        <span class="comment">// UCLA: added lead with operationfor CUT-IN join</span></div>
<div class="line"><span class="lineno"> 3093</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> == <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa7d32254f1798e4564e467d332c383112">PlatoonState::LEADWITHOPERATION</a>)</div>
<div class="line"><span class="lineno"> 3094</span>        {</div>
<div class="line"><span class="lineno"> 3095</span>            <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ac28094ea4b6d85949859226c860d8bd6">run_lead_with_operation</a>();</div>
<div class="line"><span class="lineno"> 3096</span>        }</div>
<div class="line"><span class="lineno"> 3097</span>        <span class="comment">// UCLA: added prepare to join for CUT-IN join</span></div>
<div class="line"><span class="lineno"> 3098</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> == <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafafe45c20d03a8d502486cff766672bdf9">PlatoonState::PREPARETOJOIN</a>)</div>
<div class="line"><span class="lineno"> 3099</span>        {</div>
<div class="line"><span class="lineno"> 3100</span>            <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a8c989d9220109cab74fb8aff6212f27e">run_prepare_to_join</a>();</div>
<div class="line"><span class="lineno"> 3101</span>        }</div>
<div class="line"><span class="lineno"> 3102</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> == <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa839ccd0c7e2e3441b3cd9ca0546be97b">PlatoonState::STANDBY</a>)</div>
<div class="line"><span class="lineno"> 3103</span>        {</div>
<div class="line"><span class="lineno"> 3104</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;standby state, nothing to do&quot;</span>);</div>
<div class="line"><span class="lineno"> 3105</span>        }</div>
<div class="line"><span class="lineno"> 3106</span>        <span class="comment">// coding oversight</span></div>
<div class="line"><span class="lineno"> 3107</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 3108</span>        {</div>
<div class="line"><span class="lineno"> 3109</span>            RCLCPP_ERROR_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;///// unhandled state &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a>);</div>
<div class="line"><span class="lineno"> 3110</span>        }</div>
<div class="line"><span class="lineno"> 3111</span>        <span class="comment">// TODO: Place holder for departure</span></div>
<div class="line"><span class="lineno"> 3112</span> </div>
<div class="line"><span class="lineno"> 3113</span>        carma_planning_msgs::msg::PlatooningInfo platoon_status = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ac86657c9cd45018b1f8544e47be1e5dc">composePlatoonInfoMsg</a>();</div>
<div class="line"><span class="lineno"> 3114</span>        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ac4431eacf32294f2c7d2617936e2864c">platooning_info_publisher_</a>(platoon_status);</div>
<div class="line"><span class="lineno"> 3115</span> </div>
<div class="line"><span class="lineno"> 3116</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 3117</span>    }</div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_a686ffb96fbf0c728db7d12d03f1932c9"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a686ffb96fbf0c728db7d12d03f1932c9">platoon_strategic_ihp::PlatoonManager::updateHostSpeeds</a></div><div class="ttdeci">void updateHostSpeeds(const double cmdSpeed, const double actualSpeed)</div><div class="ttdoc">Stores the latest info on host vehicle's command &amp; actual speeds.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00066">platoon_manager_ihp.cpp:66</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_ab1710b942f6893b756b67dd6505ee90b"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ab1710b942f6893b756b67dd6505ee90b">platoon_strategic_ihp::PlatoonManager::updateHostPose</a></div><div class="ttdeci">void updateHostPose(const double downtrack, const double crosstrack)</div><div class="ttdoc">Stores the latest info on location of the host vehicle.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00058">platoon_manager_ihp.cpp:58</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a3e9dbfe57693b6d23d99b61af6375a4f"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3e9dbfe57693b6d23d99b61af6375a4f">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::run_follower</a></div><div class="ttdeci">void run_follower()</div><div class="ttdoc">Run Follower State.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l02679">platoon_strategic_ihp.cpp:2679</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a7bcebb0d98ab80013c945a2ec283250e"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a7bcebb0d98ab80013c945a2ec283250e">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::run_leader_waiting</a></div><div class="ttdeci">void run_leader_waiting()</div><div class="ttdoc">Run Leader Waiting State.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l02597">platoon_strategic_ihp.cpp:2597</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a7d07b2ec081219ee9fb62418170bb1f8"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a7d07b2ec081219ee9fb62418170bb1f8">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::run_candidate_follower</a></div><div class="ttdeci">void run_candidate_follower()</div><div class="ttdoc">Run Candidate Follower State.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l02722">platoon_strategic_ihp.cpp:2722</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a848aac5dfc1f6a3c4fba8fa0bba0ca66"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a848aac5dfc1f6a3c4fba8fa0bba0ca66">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::run_leader_aborting</a></div><div class="ttdeci">void run_leader_aborting()</div><div class="ttdoc">Run Leader Aborting State.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l02822">platoon_strategic_ihp.cpp:2822</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a8c989d9220109cab74fb8aff6212f27e"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a8c989d9220109cab74fb8aff6212f27e">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::run_prepare_to_join</a></div><div class="ttdeci">void run_prepare_to_join()</div><div class="ttdoc">UCLA Run prepare to join State.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l02977">platoon_strategic_ihp.cpp:2977</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_aa2c3c1b6030726c8e1931ea0093dd91d"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa2c3c1b6030726c8e1931ea0093dd91d">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::run_candidate_leader</a></div><div class="ttdeci">void run_candidate_leader()</div><div class="ttdoc">Run Candidate Leader State.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l02918">platoon_strategic_ihp.cpp:2918</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_ac28094ea4b6d85949859226c860d8bd6"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ac28094ea4b6d85949859226c860d8bd6">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::run_lead_with_operation</a></div><div class="ttdeci">void run_lead_with_operation()</div><div class="ttdoc">UCLA Run lead with operation State.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l02945">platoon_strategic_ihp.cpp:2945</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_ac86657c9cd45018b1f8544e47be1e5dc"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ac86657c9cd45018b1f8544e47be1e5dc">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::composePlatoonInfoMsg</a></div><div class="ttdeci">carma_planning_msgs::msg::PlatooningInfo composePlatoonInfoMsg()</div><div class="ttdoc">Compose Platoon information message.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l00419">platoon_strategic_ihp.cpp:419</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_acf8506705dea8579268655c4fdeb4ddf"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#acf8506705dea8579268655c4fdeb4ddf">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::run_leader</a></div><div class="ttdeci">void run_leader()</div><div class="ttdoc">Run Leader State.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l02622">platoon_strategic_ihp.cpp:2622</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__manager__ihp_8h_source.html#l00081">platoon_strategic_ihp::CANDIDATEFOLLOWER</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00086">platoon_strategic_ihp::CANDIDATELEADER</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00326">cmd_speed_</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00419">composePlatoonInfoMsg()</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00332">current_crosstrack_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00330">current_downtrack_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00370">platoon_strategic_ihp::PlatoonManager::current_platoon_state</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00328">current_speed_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00082">platoon_strategic_ihp::FOLLOWER</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00080">platoon_strategic_ihp::LEADER</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00084">platoon_strategic_ihp::LEADERABORTING</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00079">platoon_strategic_ihp::LEADERWAITING</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00088">platoon_strategic_ihp::LEADWITHOPERATION</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00311">platooning_info_publisher_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00817">pm_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00090">platoon_strategic_ihp::PREPARETOJOIN</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02722">run_candidate_follower()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02918">run_candidate_leader()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02679">run_follower()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02945">run_lead_with_operation()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02622">run_leader()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02822">run_leader_aborting()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02597">run_leader_waiting()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02977">run_prepare_to_join()</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00078">platoon_strategic_ihp::STANDBY</a>, <a class="el" href="platoon__manager__ihp_8cpp_source.html#l00058">platoon_strategic_ihp::PlatoonManager::updateHostPose()</a>, and <a class="el" href="platoon__manager__ihp_8cpp_source.html#l00066">platoon_strategic_ihp::PlatoonManager::updateHostSpeeds()</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp__node_8cpp_source.html#l00118">platoon_strategic_ihp::Node::on_configure_plugin()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ac7e7160659b61a4ac61be14f74fb1caa_cgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ac7e7160659b61a4ac61be14f74fb1caa_cgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ac7e7160659b61a4ac61be14f74fb1caa_cgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ac7e7160659b61a4ac61be14f74fb1caa_cgraph">
<area shape="rect" title="Spin callback function." alt="" coords="5,1337,188,1393"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ac86657c9cd45018b1f8544e47be1e5dc" title="Compose Platoon information message." alt="" coords="257,412,440,468"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a7d07b2ec081219ee9fb62418170bb1f8" title="Run Candidate Follower State." alt="" coords="257,1417,440,1473"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa2c3c1b6030726c8e1931ea0093dd91d" title="Run Candidate Leader State." alt="" coords="257,1497,440,1553"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3e9dbfe57693b6d23d99b61af6375a4f" title="Run Follower State." alt="" coords="257,699,440,755"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ac28094ea4b6d85949859226c860d8bd6" title="UCLA Run lead with operation State." alt="" coords="257,979,440,1035"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#acf8506705dea8579268655c4fdeb4ddf" title="Run Leader State." alt="" coords="257,1121,440,1177"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a848aac5dfc1f6a3c4fba8fa0bba0ca66" title="Run Leader Aborting State." alt="" coords="257,1337,440,1393"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a7bcebb0d98ab80013c945a2ec283250e" title="Run Leader Waiting State." alt="" coords="257,1257,440,1313"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a8c989d9220109cab74fb8aff6212f27e" title="UCLA Run prepare to join State." alt="" coords="257,1577,440,1633"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ab1710b942f6893b756b67dd6505ee90b" title="Stores the latest info on location of the host vehicle." alt="" coords="236,1657,461,1698"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a686ffb96fbf0c728db7d12d03f1932c9" title="Stores the latest info on host vehicle&#39;s command &amp; actual speeds." alt="" coords="251,1721,446,1777"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a26b94722e82060dda554ef168626727c" title="Returns dynamic leader of the host vehicle." alt="" coords="531,296,727,352"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a1de160740f47d9b0198e42dcbe67a6fe" title="Get number of vehicles in front of host vehicle inside platoon." alt="" coords="1104,427,1296,483"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a3ef30eeb7a7cf0caccb948e6a41f92" title="Returns total size of the platoon , in number of vehicles." alt="" coords="1079,887,1321,929"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8dcec182e6480989f16493cdae76e445" title="UCLA: Return the position of the preceding vehicle, in m." alt="" coords="804,427,1023,483"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#abee9a2b28eac60e3a326656ada2d7630" title="UCLA: Return the speed of the preceding vehicle, in m/s." alt="" coords="519,477,738,533"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acde63c37282d68d2a407359d735d3446" title="UCLA: Return the time headway summation of all predecessors, in s." alt="" coords="519,191,738,247"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a5fa3ab8c7c127c9d76f0dce1be59fe80" title="This is the implementation of all predecessor following (APF) algorithm for leader selection in a pla..." alt="" coords="806,245,1021,301"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#aea48de69a49b77ff87145342a0790363" title="Calculate the time headaway of each platoon member and save as a vector." alt="" coords="1110,5,1290,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a24583fcb6596efbb2772001a58c36588" title="Determine the proper vehicle to follow based the time headway of each member. Note that the host will..." alt="" coords="1092,136,1308,192"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ae747d7f17a417d2fa30227d71925489d" title="Find the closest vehicle to the host vehicle that violates the (time headaway) lower boundary conditi..." alt="" coords="1387,74,1622,145"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a10ff5ed73a7a5f72b96fc5b1a928bfe3" title="Find the closest vehicle to the host vehicle that violates the (time headaway) maximum spacing condit..." alt="" coords="1369,180,1640,236"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#addb3708590b81f46b27e612b6e945cea" title="Return a sub&#45;vector of the platoon&#45;wise time headaways vector that start with a given index." alt="" coords="1085,267,1315,323"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ab6bac9590984959b2a6988c329090235" title="Check the gap with the predecessor vehicle." alt="" coords="1105,347,1295,403"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8f79bf82a5c6ba800fd48f9ed819f606" title="Returns current downtrack distance, in m." alt="" coords="819,165,1007,221"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#af2f0d9818d07db4a4df484f988635201" title="Resets necessary variables to indicate that the current ActionPlan is dead." alt="" coords="519,1417,738,1458"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a657b2d890046589b62c473178a134b20" title="Function to compose mobility operation in candidate follower state." alt="" coords="509,1482,748,1553"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a472f726662a0702881c52b4da95bd457" title="Returns distance to the predessecor vehicle, in m." alt="" coords="530,1337,727,1393"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a11ffedaaa90fe358ecfdccab7c5a428c" title="Function to convert pose from map frame to ecef location." alt="" coords="537,1577,720,1633"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aabe87e2046da048da999758ebdd119fe" title="Function to compose mobility operation message with STATUS params." alt="" coords="796,1203,1031,1259"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a5e18795bb16ef8f84cf6e451def325bb" title="Function to compose mobility operation in CandidateLeader." alt="" coords="509,1658,748,1729"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ab1c204db4a5056621de299a9dd663c6f" title="Resets all variables that might indicate other members of the host&#39;s platoon; sets the host back to s..." alt="" coords="536,1753,721,1809"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#af80fc61208f8a6e2efefdcfcc37ce980" title="Update status when state change from Follower to Leader." alt="" coords="529,659,729,715"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3a80cbd904887d9fa98448f76fba7993" title="Function to compose mobility operation in follower state." alt="" coords="513,739,744,795"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2b54d8a43eb72f0c439860b5b5793302" title="Function to compose mobility operation in LeadWithOperation (cut&#45;in join)" alt="" coords="511,971,747,1042"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#abf34e8d8c0c18809bf551d3b04db81d4" title="Function to compose mobility operation message with INFO params." alt="" coords="807,979,1020,1035"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#af19d3e4a88f6875cf802442b183694a0" title="Returns overall length of the platoon. in m." alt="" coords="1106,979,1294,1035"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#afc01cfaa2979666119dff63ee09c05a6" title="Function to compose mobility operation in leader state." alt="" coords="518,1067,739,1123"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a20c23f25255a2e259d5ee9a4f68b722c" title="Function to compose mobility operation in LeaderAborting state." alt="" coords="518,1242,739,1313"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a95d140cc05909e28936b714f41862fc9" title="Function to compose mobility operation in leader waiting state." alt="" coords="518,1147,739,1218"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a4e1a6de5a77b7bceab316768df37fc50" title="Function to compose mobility operation in PrepareToJoin (cut&#45;in join)" alt="" coords="515,1834,742,1905"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a891585489dfbd709f71347784744ed58" title="UCLA: Return joiner&#39;s desired position in terms of target platoon index to cut into the platoon...." alt="" coords="533,1980,724,2036"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ac7e7160659b61a4ac61be14f74fb1caa_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ac7e7160659b61a4ac61be14f74fb1caa_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ac7e7160659b61a4ac61be14f74fb1caa_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ac7e7160659b61a4ac61be14f74fb1caa_icgraph">
<area shape="rect" title="Spin callback function." alt="" coords="199,5,381,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,5,151,61"/>
</map>
</div>

</div>
</div>
<a id="aedb5c1f689806047c82f0c7b3ebe9c66" name="aedb5c1f689806047c82f0c7b3ebe9c66"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aedb5c1f689806047c82f0c7b3ebe9c66">&#9670;&nbsp;</a></span>plan_maneuver_cb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> platoon_strategic_ihp::PlatoonStrategicIHPPlugin::plan_maneuver_cb </td>
          <td>(</td>
          <td class="paramtype">carma_planning_msgs::srv::PlanManeuvers::Request &amp;&#160;</td>
          <td class="paramname"><em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">carma_planning_msgs::srv::PlanManeuvers::Response &amp;&#160;</td>
          <td class="paramname"><em>resp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Callback function to the maneuver request. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">req</td><td>Maneuver service request </td></tr>
    <tr><td class="paramname">resp</td><td>Maneuver service response</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Mobility response message </dd></dl>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l03221">3221</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3222</span>    {</div>
<div class="line"><span class="lineno"> 3223</span>        <span class="comment">// use current position to find lanelet ID</span></div>
<div class="line"><span class="lineno"> 3224</span>        lanelet::BasicPoint2d current_loc(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa67d1b97f198e2f088fb24ffb8e0c690">pose_msg_</a>.pose.position.x, <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa67d1b97f198e2f088fb24ffb8e0c690">pose_msg_</a>.pose.position.y);</div>
<div class="line"><span class="lineno"> 3225</span> </div>
<div class="line"><span class="lineno"> 3226</span>        <span class="comment">// *** get the actually closest lanelets that relate to current location (n=10) ***//</span></div>
<div class="line"><span class="lineno"> 3227</span>        <span class="keyword">auto</span> current_lanelets = lanelet::geometry::findNearest(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae65a18d1f14ecdfae3409e47e59a1031">wm_</a>-&gt;getMap()-&gt;laneletLayer, current_loc, 10); </div>
<div class="line"><span class="lineno"> 3228</span> </div>
<div class="line"><span class="lineno"> 3229</span>        lanelet::ConstLanelet current_lanelet; </div>
<div class="line"><span class="lineno"> 3230</span> </div>
<div class="line"><span class="lineno"> 3231</span>        <span class="comment">// To avoid overlapping lanelets, compare the nearest lanelets with the route</span></div>
<div class="line"><span class="lineno"> 3232</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> llt: current_lanelets)</div>
<div class="line"><span class="lineno"> 3233</span>        {</div>
<div class="line"><span class="lineno"> 3234</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae65a18d1f14ecdfae3409e47e59a1031">wm_</a>-&gt;getRoute()-&gt;contains(llt.second))</div>
<div class="line"><span class="lineno"> 3235</span>            {</div>
<div class="line"><span class="lineno"> 3236</span>                current_lanelet = llt.second;</div>
<div class="line"><span class="lineno"> 3237</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3238</span>            }</div>
<div class="line"><span class="lineno"> 3239</span>        }</div>
<div class="line"><span class="lineno"> 3240</span> </div>
<div class="line"><span class="lineno"> 3241</span>        <span class="comment">// raise warn if no path was found</span></div>
<div class="line"><span class="lineno"> 3242</span>        <span class="keywordflow">if</span>(current_lanelets.size() == 0)</div>
<div class="line"><span class="lineno"> 3243</span>        {</div>
<div class="line"><span class="lineno"> 3244</span>            RCLCPP_WARN_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Cannot find any lanelet in map!&quot;</span>);</div>
<div class="line"><span class="lineno"> 3245</span>            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 3246</span>        }</div>
<div class="line"><span class="lineno"> 3247</span> </div>
<div class="line"><span class="lineno"> 3248</span>        <span class="comment">// locate lanelet on shortest path</span></div>
<div class="line"><span class="lineno"> 3249</span>        <span class="keyword">auto</span> shortest_path = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae65a18d1f14ecdfae3409e47e59a1031">wm_</a>-&gt;getRoute()-&gt;shortestPath(); <span class="comment">// find path amoung route</span></div>
<div class="line"><span class="lineno"> 3250</span> </div>
<div class="line"><span class="lineno"> 3251</span>        <span class="comment">// read status data</span></div>
<div class="line"><span class="lineno"> 3252</span>        <span class="keywordtype">double</span> current_progress = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae65a18d1f14ecdfae3409e47e59a1031">wm_</a>-&gt;routeTrackPos(current_loc).downtrack;</div>
<div class="line"><span class="lineno"> 3253</span>        <span class="keywordtype">double</span> speed_progress = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3e827c7f2e764c6e7de83f0a81a9593f">current_speed_</a>;</div>
<div class="line"><span class="lineno"> 3254</span>        rclcpp::Time time_progress = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a283186f2bbb98f5f85b5486e365bb4b8">timer_factory_</a>-&gt;now();</div>
<div class="line"><span class="lineno"> 3255</span> </div>
<div class="line"><span class="lineno"> 3256</span>        <span class="comment">// ---------------- use IHP platoon trajectory regulation here --------------------</span></div>
<div class="line"><span class="lineno"> 3257</span>        <span class="comment">// Note: The desired gap will be adjusted and send to control plugin (via platoon_info_msg) where gap creation will be handled.</span></div>
<div class="line"><span class="lineno"> 3258</span>        <span class="keywordtype">double</span> target_speed;   </div>
<div class="line"><span class="lineno"> 3259</span>        </div>
<div class="line"><span class="lineno"> 3260</span>        <span class="comment">// Note: gap regulation has moved to control plug-in, no need to adjust speed here.</span></div>
<div class="line"><span class="lineno"> 3261</span>        target_speed = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a6fe836b822225ea28495dd732d2e1d6e">findSpeedLimit</a>(current_lanelet);   <span class="comment">//get Speed Limit</span></div>
<div class="line"><span class="lineno"> 3262</span>        <span class="keywordtype">double</span> total_maneuver_length = current_progress + <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#ae64774657934bc9c1e2421b4ded913fa">time_step</a> * target_speed;</div>
<div class="line"><span class="lineno"> 3263</span>        <span class="comment">// ----------------------------------------------------------------</span></div>
<div class="line"><span class="lineno"> 3264</span> </div>
<div class="line"><span class="lineno"> 3265</span>        <span class="comment">// pick smaller length, accomendate when host is close to the route end</span></div>
<div class="line"><span class="lineno"> 3266</span>        <span class="keywordtype">double</span> route_length =  <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae65a18d1f14ecdfae3409e47e59a1031">wm_</a>-&gt;getRouteEndTrackPos().downtrack; </div>
<div class="line"><span class="lineno"> 3267</span>        total_maneuver_length = std::min(total_maneuver_length, route_length);</div>
<div class="line"><span class="lineno"> 3268</span> </div>
<div class="line"><span class="lineno"> 3269</span>        <span class="comment">// Update current status based on prior plan</span></div>
<div class="line"><span class="lineno"> 3270</span>        <span class="keywordflow">if</span>(req.prior_plan.maneuvers.size()!= 0)</div>
<div class="line"><span class="lineno"> 3271</span>        {</div>
<div class="line"><span class="lineno"> 3272</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Provided with initial plan...&quot;</span>);</div>
<div class="line"><span class="lineno"> 3273</span>            time_progress = req.prior_plan.planning_completion_time;</div>
<div class="line"><span class="lineno"> 3274</span>            <span class="keywordtype">int</span> end_lanelet = 0;</div>
<div class="line"><span class="lineno"> 3275</span>            <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a609dc105613d0c6ff89e1e955c8f6487">updateCurrentStatus</a>(req.prior_plan.maneuvers.back(), speed_progress, current_progress, end_lanelet);</div>
<div class="line"><span class="lineno"> 3276</span>        }</div>
<div class="line"><span class="lineno"> 3277</span>        </div>
<div class="line"><span class="lineno"> 3278</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Starting Loop&quot;</span>);</div>
<div class="line"><span class="lineno"> 3279</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;total_maneuver_length: &quot;</span> &lt;&lt; total_maneuver_length &lt;&lt; <span class="stringliteral">&quot; route_length: &quot;</span> &lt;&lt; route_length);</div>
<div class="line"><span class="lineno"> 3280</span>        </div>
<div class="line"><span class="lineno"> 3281</span> </div>
<div class="line"><span class="lineno"> 3282</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;in mvr  callback safeToLaneChange: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2bc77445cdb4c025344024395fa94607">safeToLaneChange_</a>);</div>
<div class="line"><span class="lineno"> 3283</span> </div>
<div class="line"><span class="lineno"> 3284</span>        <span class="comment">// Note: Use current_lanlet list (which was determined based on vehicle pose) to find current lanelet ID. </span></div>
<div class="line"><span class="lineno"> 3285</span>        lanelet::Id current_lanelet_id = current_lanelet.id();</div>
<div class="line"><span class="lineno"> 3286</span>    </div>
<div class="line"><span class="lineno"> 3287</span> </div>
<div class="line"><span class="lineno"> 3288</span> </div>
<div class="line"><span class="lineno"> 3289</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;current_lanelet_id: &quot;</span> &lt;&lt; current_lanelet_id);</div>
<div class="line"><span class="lineno"> 3290</span>        <span class="comment">// lane change maneuver </span></div>
<div class="line"><span class="lineno"> 3291</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2bc77445cdb4c025344024395fa94607">safeToLaneChange_</a>)</div>
<div class="line"><span class="lineno"> 3292</span>        {   </div>
<div class="line"><span class="lineno"> 3293</span>            <span class="comment">// for testing purpose only, check lane change status</span></div>
<div class="line"><span class="lineno"> 3294</span>            <span class="keywordtype">double</span> target_crosstrack = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae65a18d1f14ecdfae3409e47e59a1031">wm_</a>-&gt;routeTrackPos(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ab2fa1a4b839a90fee186cc921a5360ab">target_cutin_pose_</a>).crosstrack;</div>
<div class="line"><span class="lineno"> 3295</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;target_crosstrack: &quot;</span> &lt;&lt; target_crosstrack);</div>
<div class="line"><span class="lineno"> 3296</span>            <span class="keywordtype">double</span> crosstrackDiff = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a79aaef859aaa4b64f6cf79c50c596bc3">current_crosstrack_</a> - target_crosstrack; </div>
<div class="line"><span class="lineno"> 3297</span>            <span class="keywordtype">bool</span> isLaneChangeFinished = abs(crosstrackDiff) &lt;= <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a3c2aa8b4742ba50d80bc9c23ed183ebf">maxCrosstrackError</a>; </div>
<div class="line"><span class="lineno"> 3298</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;crosstrackDiff: &quot;</span> &lt;&lt; crosstrackDiff);</div>
<div class="line"><span class="lineno"> 3299</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;isLaneChangeFinished: &quot;</span> &lt;&lt; isLaneChangeFinished);</div>
<div class="line"><span class="lineno"> 3300</span> </div>
<div class="line"><span class="lineno"> 3301</span>            <span class="comment">// lane change not finished, use lane change plan</span></div>
<div class="line"><span class="lineno"> 3302</span>            <span class="keywordflow">if</span>(!isLaneChangeFinished)  </div>
<div class="line"><span class="lineno"> 3303</span>            {</div>
<div class="line"><span class="lineno"> 3304</span>                <span class="comment">// send out lane change plan</span></div>
<div class="line"><span class="lineno"> 3305</span>                <span class="keywordflow">while</span> (current_progress &lt; total_maneuver_length)</div>
<div class="line"><span class="lineno"> 3306</span>                {   </div>
<div class="line"><span class="lineno"> 3307</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Lane Change Maneuver for Cut-in join ! &quot;</span>);</div>
<div class="line"><span class="lineno"> 3308</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;current_progress: &quot;</span>&lt;&lt; current_progress);</div>
<div class="line"><span class="lineno"> 3309</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;speed_progress: &quot;</span> &lt;&lt; speed_progress);</div>
<div class="line"><span class="lineno"> 3310</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;target_speed: &quot;</span> &lt;&lt; target_speed);</div>
<div class="line"><span class="lineno"> 3311</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;time_progress: &quot;</span> &lt;&lt; rclcpp::Time(time_progress).seconds());</div>
<div class="line"><span class="lineno"> 3312</span> </div>
<div class="line"><span class="lineno"> 3313</span>                    <span class="comment">// set to next lane destination, consider sending ecef instead of dtd </span></div>
<div class="line"><span class="lineno"> 3314</span>                    <span class="keywordtype">double</span> end_dist = total_maneuver_length;</div>
<div class="line"><span class="lineno"> 3315</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;end_dist: &quot;</span> &lt;&lt; end_dist);</div>
<div class="line"><span class="lineno"> 3316</span>                    <span class="comment">// consider calculate dtd_diff and ctd_diff</span></div>
<div class="line"><span class="lineno"> 3317</span>                    <span class="keywordtype">double</span> dist_diff = end_dist - current_progress;</div>
<div class="line"><span class="lineno"> 3318</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;dist_diff: &quot;</span> &lt;&lt; dist_diff);</div>
<div class="line"><span class="lineno"> 3319</span>    </div>
<div class="line"><span class="lineno"> 3320</span>                    </div>
<div class="line"><span class="lineno"> 3321</span>                    <span class="comment">//TODO: target_cutin_pose_ represents the platoon leader. It seems this may be the wrong answer for mid- or rear-cutins?</span></div>
<div class="line"><span class="lineno"> 3322</span>                    <span class="comment">//SAINA: currently, the functions do not provide the correct point of rear vehicle of the platoon</span></div>
<div class="line"><span class="lineno"> 3323</span>                    <span class="keywordtype">double</span> lc_end_dist = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae65a18d1f14ecdfae3409e47e59a1031">wm_</a>-&gt;routeTrackPos(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ab2fa1a4b839a90fee186cc921a5360ab">target_cutin_pose_</a>).downtrack;</div>
<div class="line"><span class="lineno"> 3324</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;lc_end_dist before buffer: &quot;</span> &lt;&lt; lc_end_dist);</div>
<div class="line"><span class="lineno"> 3325</span>                    lc_end_dist = std::max(lc_end_dist, current_progress + <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a2c210ff37063f1c702ddec0d454238b2">maxCutinGap</a>);</div>
<div class="line"><span class="lineno"> 3326</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;lc_end_dist after buffer: &quot;</span> &lt;&lt; lc_end_dist);</div>
<div class="line"><span class="lineno"> 3327</span>                    </div>
<div class="line"><span class="lineno"> 3328</span>                    <span class="comment">//TODO: target_cutin_pose_ represents the platoon leader. Is this the best pose to use here?</span></div>
<div class="line"><span class="lineno"> 3329</span>                    <span class="comment">// get the actually closest lanelets, </span></div>
<div class="line"><span class="lineno"> 3330</span>                    <span class="keyword">auto</span> target_lanelets = lanelet::geometry::findNearest(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae65a18d1f14ecdfae3409e47e59a1031">wm_</a>-&gt;getMap()-&gt;laneletLayer, <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ab2fa1a4b839a90fee186cc921a5360ab">target_cutin_pose_</a>, 1); </div>
<div class="line"><span class="lineno"> 3331</span>                    <span class="keywordflow">if</span> (target_lanelets.empty())</div>
<div class="line"><span class="lineno"> 3332</span>                    {</div>
<div class="line"><span class="lineno"> 3333</span>                        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;The target cutin pose is not on a valid lanelet. So no lane change!&quot;</span>);</div>
<div class="line"><span class="lineno"> 3334</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3335</span>                    } </div>
<div class="line"><span class="lineno"> 3336</span>                    lanelet::Id target_lanelet_id = target_lanelets[0].second.id();</div>
<div class="line"><span class="lineno"> 3337</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;target_lanelet_id: &quot;</span> &lt;&lt; target_lanelet_id);</div>
<div class="line"><span class="lineno"> 3338</span> </div>
<div class="line"><span class="lineno"> 3339</span>                    lanelet::ConstLanelet starting_lanelet = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae65a18d1f14ecdfae3409e47e59a1031">wm_</a>-&gt;getMap()-&gt;laneletLayer.get(current_lanelet_id);</div>
<div class="line"><span class="lineno"> 3340</span>                    lanelet::ConstLanelet ending_lanelet = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae65a18d1f14ecdfae3409e47e59a1031">wm_</a>-&gt;getMap()-&gt;laneletLayer.get(target_lanelet_id);</div>
<div class="line"><span class="lineno"> 3341</span> </div>
<div class="line"><span class="lineno"> 3342</span>                    <span class="keywordtype">bool</span> lanechangePossible = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a8bf57cd61a2fde08b32e8411eff64cae">is_lanechange_possible</a>(current_lanelet_id, target_lanelet_id);</div>
<div class="line"><span class="lineno"> 3343</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;lanechangePossible: &quot;</span> &lt;&lt; lanechangePossible);</div>
<div class="line"><span class="lineno"> 3344</span> </div>
<div class="line"><span class="lineno"> 3345</span>                    <span class="keywordflow">if</span> (lanechangePossible)</div>
<div class="line"><span class="lineno"> 3346</span>                    {</div>
<div class="line"><span class="lineno"> 3347</span>                        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Lane change possible, planning it.. &quot;</span> );</div>
<div class="line"><span class="lineno"> 3348</span>                        resp.new_plan.maneuvers.push_back(<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a8378d85e905c51ff883b7fae4bf64367">composeLaneChangeManeuverMessage</a>(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa53003d4c3610dbb5f87762a6683dd9f">current_downtrack_</a>, lc_end_dist,  </div>
<div class="line"><span class="lineno"> 3349</span>                                            speed_progress, target_speed, current_lanelet_id, target_lanelet_id , time_progress));</div>
<div class="line"><span class="lineno"> 3350</span>                        </div>
<div class="line"><span class="lineno"> 3351</span>                    }</div>
<div class="line"><span class="lineno"> 3352</span>                    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 3353</span>                    {</div>
<div class="line"><span class="lineno"> 3354</span>                        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Lane change impossible, planning lanefollow instead ... &quot;</span> );</div>
<div class="line"><span class="lineno"> 3355</span>                        resp.new_plan.maneuvers.push_back(<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a68e48fa7d12584918a6764710d71a606">composeManeuverMessage</a>(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa53003d4c3610dbb5f87762a6683dd9f">current_downtrack_</a>, end_dist,  </div>
<div class="line"><span class="lineno"> 3356</span>                                            speed_progress, target_speed, current_lanelet_id, time_progress));</div>
<div class="line"><span class="lineno"> 3357</span>                    }</div>
<div class="line"><span class="lineno"> 3358</span> </div>
<div class="line"><span class="lineno"> 3359</span>                    </div>
<div class="line"><span class="lineno"> 3360</span> </div>
<div class="line"><span class="lineno"> 3361</span>                    current_progress += dist_diff;</div>
<div class="line"><span class="lineno"> 3362</span>                    <span class="comment">// read lane change maneuver end time as time progress</span></div>
<div class="line"><span class="lineno"> 3363</span>                    time_progress = resp.new_plan.maneuvers.back().lane_change_maneuver.end_time;</div>
<div class="line"><span class="lineno"> 3364</span>                    speed_progress = target_speed;</div>
<div class="line"><span class="lineno"> 3365</span>                    <span class="keywordflow">if</span>(current_progress &gt;= total_maneuver_length)</div>
<div class="line"><span class="lineno"> 3366</span>                    {</div>
<div class="line"><span class="lineno"> 3367</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3368</span>                    }</div>
<div class="line"><span class="lineno"> 3369</span> </div>
<div class="line"><span class="lineno"> 3370</span>                }</div>
<div class="line"><span class="lineno"> 3371</span>            }</div>
<div class="line"><span class="lineno"> 3372</span> </div>
<div class="line"><span class="lineno"> 3373</span>            <span class="comment">// lane change finished, use lane following plan</span></div>
<div class="line"><span class="lineno"> 3374</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 3375</span>            {</div>
<div class="line"><span class="lineno"> 3376</span>                <span class="comment">// send out lane following plan</span></div>
<div class="line"><span class="lineno"> 3377</span>                <span class="keywordflow">while</span> (current_progress &lt; total_maneuver_length)</div>
<div class="line"><span class="lineno"> 3378</span>                {   </div>
<div class="line"><span class="lineno"> 3379</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Same Lane Maneuver for platoon join ! &quot;</span>);</div>
<div class="line"><span class="lineno"> 3380</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;current_progress: &quot;</span>&lt;&lt; current_progress);</div>
<div class="line"><span class="lineno"> 3381</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;speed_progress: &quot;</span> &lt;&lt; speed_progress);</div>
<div class="line"><span class="lineno"> 3382</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;target_speed: &quot;</span> &lt;&lt; target_speed);</div>
<div class="line"><span class="lineno"> 3383</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;time_progress: &quot;</span> &lt;&lt; rclcpp::Time(time_progress).seconds());</div>
<div class="line"><span class="lineno"> 3384</span>                    <span class="keywordtype">double</span> end_dist = total_maneuver_length;</div>
<div class="line"><span class="lineno"> 3385</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;end_dist: &quot;</span> &lt;&lt; end_dist);</div>
<div class="line"><span class="lineno"> 3386</span>                    <span class="keywordtype">double</span> dist_diff = end_dist - current_progress;</div>
<div class="line"><span class="lineno"> 3387</span>                    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;dist_diff: &quot;</span> &lt;&lt; dist_diff);</div>
<div class="line"><span class="lineno"> 3388</span>                    <span class="keywordflow">if</span>(end_dist &lt; current_progress)</div>
<div class="line"><span class="lineno"> 3389</span>                    {</div>
<div class="line"><span class="lineno"> 3390</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3391</span>                    }</div>
<div class="line"><span class="lineno"> 3392</span>                    <span class="comment">// Note: The previous plan was generated at the beginning of the trip. It is necessary to update </span></div>
<div class="line"><span class="lineno"> 3393</span>                    <span class="comment">//       it as the lane ID and lanelet Index are different.</span></div>
<div class="line"><span class="lineno"> 3394</span>                    resp.new_plan.maneuvers.push_back(<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a68e48fa7d12584918a6764710d71a606">composeManeuverMessage</a>(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa53003d4c3610dbb5f87762a6683dd9f">current_downtrack_</a>, end_dist,  </div>
<div class="line"><span class="lineno"> 3395</span>                                            speed_progress, target_speed, current_lanelet_id, time_progress));</div>
<div class="line"><span class="lineno"> 3396</span>                    </div>
<div class="line"><span class="lineno"> 3397</span>                    current_progress += dist_diff;</div>
<div class="line"><span class="lineno"> 3398</span>                    time_progress = resp.new_plan.maneuvers.back().lane_following_maneuver.end_time;</div>
<div class="line"><span class="lineno"> 3399</span>                    speed_progress = target_speed;</div>
<div class="line"><span class="lineno"> 3400</span>                    <span class="keywordflow">if</span>(current_progress &gt;= total_maneuver_length)</div>
<div class="line"><span class="lineno"> 3401</span>                    {</div>
<div class="line"><span class="lineno"> 3402</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3403</span>                    }</div>
<div class="line"><span class="lineno"> 3404</span>                }</div>
<div class="line"><span class="lineno"> 3405</span>            }</div>
<div class="line"><span class="lineno"> 3406</span>        }</div>
<div class="line"><span class="lineno"> 3407</span>        </div>
<div class="line"><span class="lineno"> 3408</span>        <span class="comment">// same-lane maneuver  </span></div>
<div class="line"><span class="lineno"> 3409</span>        <span class="keywordflow">else</span> </div>
<div class="line"><span class="lineno"> 3410</span>        {</div>
<div class="line"><span class="lineno"> 3411</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Planning Same Lane Maneuver! &quot;</span>);</div>
<div class="line"><span class="lineno"> 3412</span>            <span class="keywordflow">while</span> (current_progress &lt; total_maneuver_length)</div>
<div class="line"><span class="lineno"> 3413</span>            {   </div>
<div class="line"><span class="lineno"> 3414</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Same Lane Maneuver for platoon join ! &quot;</span>);</div>
<div class="line"><span class="lineno"> 3415</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;current_progress: &quot;</span>&lt;&lt; current_progress);</div>
<div class="line"><span class="lineno"> 3416</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;speed_progress: &quot;</span> &lt;&lt; speed_progress);</div>
<div class="line"><span class="lineno"> 3417</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;target_speed: &quot;</span> &lt;&lt; target_speed);</div>
<div class="line"><span class="lineno"> 3418</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;time_progress: &quot;</span> &lt;&lt; rclcpp::Time(time_progress).seconds());</div>
<div class="line"><span class="lineno"> 3419</span>                <span class="keywordtype">double</span> end_dist = total_maneuver_length;</div>
<div class="line"><span class="lineno"> 3420</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;end_dist: &quot;</span> &lt;&lt; end_dist);</div>
<div class="line"><span class="lineno"> 3421</span>                <span class="keywordtype">double</span> dist_diff = end_dist - current_progress;</div>
<div class="line"><span class="lineno"> 3422</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;dist_diff: &quot;</span> &lt;&lt; dist_diff);</div>
<div class="line"><span class="lineno"> 3423</span>                <span class="keywordflow">if</span> (end_dist &lt; current_progress)</div>
<div class="line"><span class="lineno"> 3424</span>                {</div>
<div class="line"><span class="lineno"> 3425</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3426</span>                }</div>
<div class="line"><span class="lineno"> 3427</span> </div>
<div class="line"><span class="lineno"> 3428</span>                resp.new_plan.maneuvers.push_back(<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a68e48fa7d12584918a6764710d71a606">composeManeuverMessage</a>(current_progress, end_dist,  </div>
<div class="line"><span class="lineno"> 3429</span>                                        speed_progress, target_speed,current_lanelet_id, time_progress));</div>
<div class="line"><span class="lineno"> 3430</span>                                    </div>
<div class="line"><span class="lineno"> 3431</span> </div>
<div class="line"><span class="lineno"> 3432</span>                current_progress += dist_diff;</div>
<div class="line"><span class="lineno"> 3433</span>                time_progress = resp.new_plan.maneuvers.back().lane_following_maneuver.end_time;</div>
<div class="line"><span class="lineno"> 3434</span>                speed_progress = target_speed;</div>
<div class="line"><span class="lineno"> 3435</span>                <span class="keywordflow">if</span>(current_progress &gt;= total_maneuver_length)</div>
<div class="line"><span class="lineno"> 3436</span>                {</div>
<div class="line"><span class="lineno"> 3437</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3438</span>                }</div>
<div class="line"><span class="lineno"> 3439</span>            }</div>
<div class="line"><span class="lineno"> 3440</span>        }</div>
<div class="line"><span class="lineno"> 3441</span> </div>
<div class="line"><span class="lineno"> 3442</span> </div>
<div class="line"><span class="lineno"> 3443</span>        <span class="keywordflow">if</span>(resp.new_plan.maneuvers.size() == 0)</div>
<div class="line"><span class="lineno"> 3444</span>        {</div>
<div class="line"><span class="lineno"> 3445</span>            RCLCPP_WARN_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Cannot plan maneuver because no route is found&quot;</span>);</div>
<div class="line"><span class="lineno"> 3446</span>        }  </div>
<div class="line"><span class="lineno"> 3447</span> </div>
<div class="line"><span class="lineno"> 3448</span> </div>
<div class="line"><span class="lineno"> 3449</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a3ef30eeb7a7cf0caccb948e6a41f92">getHostPlatoonSize</a>() &lt; 2 &amp;&amp; !<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2bc77445cdb4c025344024395fa94607">safeToLaneChange_</a>)</div>
<div class="line"><span class="lineno"> 3450</span>        {</div>
<div class="line"><span class="lineno"> 3451</span>            resp.new_plan.maneuvers = {};</div>
<div class="line"><span class="lineno"> 3452</span>            RCLCPP_WARN_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Platoon size 1 so Empty maneuver sent&quot;</span>);</div>
<div class="line"><span class="lineno"> 3453</span>        }</div>
<div class="line"><span class="lineno"> 3454</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 3455</span>        {</div>
<div class="line"><span class="lineno"> 3456</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Planning maneuvers: &quot;</span>);</div>
<div class="line"><span class="lineno"> 3457</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;safeToLaneChange_: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2bc77445cdb4c025344024395fa94607">safeToLaneChange_</a>);</div>
<div class="line"><span class="lineno"> 3458</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;pm_.getHostPlatoonSize(): &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a3ef30eeb7a7cf0caccb948e6a41f92">getHostPlatoonSize</a>());</div>
<div class="line"><span class="lineno"> 3459</span>        }</div>
<div class="line"><span class="lineno"> 3460</span> </div>
<div class="line"><span class="lineno"> 3461</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> == <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa839ccd0c7e2e3441b3cd9ca0546be97b">PlatoonState::STANDBY</a>)</div>
<div class="line"><span class="lineno"> 3462</span>        {</div>
<div class="line"><span class="lineno"> 3463</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> = <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa57f78e815f4fc2ac271a9fd85cd80ebc">PlatoonState::LEADER</a>;</div>
<div class="line"><span class="lineno"> 3464</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;change the state from standby to leader at start-up&quot;</span>);</div>
<div class="line"><span class="lineno"> 3465</span>        }</div>
<div class="line"><span class="lineno"> 3466</span> </div>
<div class="line"><span class="lineno"> 3467</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;current_downtrack: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa53003d4c3610dbb5f87762a6683dd9f">current_downtrack_</a>);</div>
<div class="line"><span class="lineno"> 3468</span>        </div>
<div class="line"><span class="lineno"> 3469</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 3470</span>    }</div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a609dc105613d0c6ff89e1e955c8f6487"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a609dc105613d0c6ff89e1e955c8f6487">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::updateCurrentStatus</a></div><div class="ttdeci">void updateCurrentStatus(carma_planning_msgs::msg::Maneuver maneuver, double &amp;speed, double &amp;current_progress, int &amp;lane_id)</div><div class="ttdoc">Update maneuver status based on prior plan.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l03203">platoon_strategic_ihp.cpp:3203</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a68e48fa7d12584918a6764710d71a606"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a68e48fa7d12584918a6764710d71a606">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::composeManeuverMessage</a></div><div class="ttdeci">carma_planning_msgs::msg::Maneuver composeManeuverMessage(double current_dist, double end_dist, double current_speed, double target_speed, int lane_id, rclcpp::Time &amp;current_time)</div><div class="ttdoc">Find lanelet index from path.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l03122">platoon_strategic_ihp.cpp:3122</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a6fe836b822225ea28495dd732d2e1d6e"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a6fe836b822225ea28495dd732d2e1d6e">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::findSpeedLimit</a></div><div class="ttdeci">double findSpeedLimit(const lanelet::ConstLanelet &amp;llt)</div><div class="ttdoc">Function to find speed limit of a lanelet.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l00166">platoon_strategic_ihp.cpp:166</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a8378d85e905c51ff883b7fae4bf64367"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a8378d85e905c51ff883b7fae4bf64367">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::composeLaneChangeManeuverMessage</a></div><div class="ttdeci">carma_planning_msgs::msg::Maneuver composeLaneChangeManeuverMessage(double current_dist, double end_dist, double current_speed, double target_speed, int starting_lane_id, int ending_lane_id, rclcpp::Time &amp;current_time)</div><div class="ttdoc">Find start(current) and target(end) lanelet index from path to generate lane change maneuver message.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l03162">platoon_strategic_ihp.cpp:3162</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a8bf57cd61a2fde08b32e8411eff64cae"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a8bf57cd61a2fde08b32e8411eff64cae">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::is_lanechange_possible</a></div><div class="ttdeci">bool is_lanechange_possible(lanelet::Id start_lanelet_id, lanelet::Id target_lanelet_id)</div><div class="ttdoc">Function to check if lanechange is possible.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l03472">platoon_strategic_ihp.cpp:3472</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l03162">composeLaneChangeManeuverMessage()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l03122">composeManeuverMessage()</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00318">config_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00332">current_crosstrack_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00330">current_downtrack_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00370">platoon_strategic_ihp::PlatoonManager::current_platoon_state</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00328">current_speed_</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00166">findSpeedLimit()</a>, <a class="el" href="platoon__manager__ihp_8cpp_source.html#l00279">platoon_strategic_ihp::PlatoonManager::getHostPlatoonSize()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l03472">is_lanechange_possible()</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00080">platoon_strategic_ihp::LEADER</a>, <a class="el" href="platoon__config__ihp_8h_source.html#l00062">platoon_strategic_ihp::PlatoonPluginConfig::maxCrosstrackError</a>, <a class="el" href="platoon__config__ihp_8h_source.html#l00061">platoon_strategic_ihp::PlatoonPluginConfig::maxCutinGap</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00817">pm_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00322">pose_msg_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00811">safeToLaneChange_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00078">platoon_strategic_ihp::STANDBY</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00802">target_cutin_pose_</a>, <a class="el" href="platoon__config__ihp_8h_source.html#l00037">platoon_strategic_ihp::PlatoonPluginConfig::time_step</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00814">timer_factory_</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l03203">updateCurrentStatus()</a>, and <a class="el" href="platoon__strategic__ihp_8h_source.html#l00315">wm_</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aedb5c1f689806047c82f0c7b3ebe9c66_cgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aedb5c1f689806047c82f0c7b3ebe9c66_cgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aedb5c1f689806047c82f0c7b3ebe9c66_cgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aedb5c1f689806047c82f0c7b3ebe9c66_cgraph">
<area shape="rect" title="Callback function to the maneuver request." alt="" coords="5,201,188,257"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a8378d85e905c51ff883b7fae4bf64367" title="Find start(current) and target(end) lanelet index from path to generate lane change maneuver message." alt="" coords="236,5,500,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a68e48fa7d12584918a6764710d71a606" title="Find lanelet index from path." alt="" coords="273,85,463,141"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a6fe836b822225ea28495dd732d2e1d6e" title="Function to find speed limit of a lanelet." alt="" coords="277,165,459,221"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a3ef30eeb7a7cf0caccb948e6a41f92" title="Returns total size of the platoon , in number of vehicles." alt="" coords="247,245,489,286"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a8bf57cd61a2fde08b32e8411eff64cae" title="Function to check if lanechange is possible." alt="" coords="277,309,459,365"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a609dc105613d0c6ff89e1e955c8f6487" title="Update maneuver status based on prior plan." alt="" coords="277,389,459,445"/>
</map>
</div>

</div>
</div>
<a id="aa81560488f89d886d731bcdbfebbbf37" name="aa81560488f89d886d731bcdbfebbbf37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa81560488f89d886d731bcdbfebbbf37">&#9670;&nbsp;</a></span>pose_cb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void platoon_strategic_ihp::PlatoonStrategicIHPPlugin::pose_cb </td>
          <td>(</td>
          <td class="paramtype">const geometry_msgs::msg::PoseStamped::UniquePtr&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Callback function for current pose. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>PoseStamped msg </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00115">115</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  116</span>    {</div>
<div class="line"><span class="lineno">  117</span>        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa67d1b97f198e2f088fb24ffb8e0c690">pose_msg_</a> = geometry_msgs::msg::PoseStamped(*msg);</div>
<div class="line"><span class="lineno">  118</span> </div>
<div class="line"><span class="lineno">  119</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> != <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa839ccd0c7e2e3441b3cd9ca0546be97b">PlatoonState::STANDBY</a>)</div>
<div class="line"><span class="lineno">  120</span>        {</div>
<div class="line"><span class="lineno">  121</span>            lanelet::BasicPoint2d current_loc(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa67d1b97f198e2f088fb24ffb8e0c690">pose_msg_</a>.pose.position.x, <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa67d1b97f198e2f088fb24ffb8e0c690">pose_msg_</a>.pose.position.y);</div>
<div class="line"><span class="lineno">  122</span>            <a class="code hl_class" href="classcarma__wm_1_1TrackPos.html">carma_wm::TrackPos</a> tc = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae65a18d1f14ecdfae3409e47e59a1031">wm_</a>-&gt;routeTrackPos(current_loc);</div>
<div class="line"><span class="lineno">  123</span> </div>
<div class="line"><span class="lineno">  124</span>            <span class="comment">// update host&#39;s DtD and CtD</span></div>
<div class="line"><span class="lineno">  125</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa53003d4c3610dbb5f87762a6683dd9f">current_downtrack_</a> = tc.<a class="code hl_variable" href="classcarma__wm_1_1TrackPos.html#a6ea99bbb9c6a75685ceaaf370d58ea24">downtrack</a>;</div>
<div class="line"><span class="lineno">  126</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a79aaef859aaa4b64f6cf79c50c596bc3">current_crosstrack_</a> = tc.<a class="code hl_variable" href="classcarma__wm_1_1TrackPos.html#a60c766fa11f68e1d8832d79cd2d292c2">crosstrack</a>;</div>
<div class="line"><span class="lineno">  127</span>            <span class="comment">// RCLCPP_DEBUG_STREAM(rclcpp::get_logger(&quot;platoon_strategic_ihp&quot;), &quot;current_downtrack_ = &quot; &lt;&lt; current_downtrack_ &lt;&lt; &quot;, current_crosstrack_ = &quot; &lt;&lt; current_crosstrack_);</span></div>
<div class="line"><span class="lineno">  128</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ab1710b942f6893b756b67dd6505ee90b">updateHostPose</a>(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa53003d4c3610dbb5f87762a6683dd9f">current_downtrack_</a>, <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a79aaef859aaa4b64f6cf79c50c596bc3">current_crosstrack_</a>);</div>
<div class="line"><span class="lineno">  129</span> </div>
<div class="line"><span class="lineno">  130</span>            <span class="comment">// note: the ecef read from &quot;pose_ecef_point&quot; is in cm.</span></div>
<div class="line"><span class="lineno">  131</span>            carma_v2x_msgs::msg::LocationECEF pose_ecef_point = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a11ffedaaa90fe358ecfdccab7c5a428c">pose_to_ecef</a>(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa67d1b97f198e2f088fb24ffb8e0c690">pose_msg_</a>);</div>
<div class="line"><span class="lineno">  132</span>            <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#abcab6368ab8bffc15e380b099554b314">setHostECEF</a>(pose_ecef_point);</div>
<div class="line"><span class="lineno">  133</span>        } </div>
<div class="line"><span class="lineno">  134</span>    }</div>
<div class="ttc" id="aclasscarma__wm_1_1TrackPos_html_a60c766fa11f68e1d8832d79cd2d292c2"><div class="ttname"><a href="classcarma__wm_1_1TrackPos.html#a60c766fa11f68e1d8832d79cd2d292c2">carma_wm::TrackPos::crosstrack</a></div><div class="ttdeci">double crosstrack</div><div class="ttdef"><b>Definition:</b> <a href="TrackPos_8hpp_source.html#l00038">TrackPos.hpp:38</a></div></div>
<div class="ttc" id="aclasscarma__wm_1_1TrackPos_html_a6ea99bbb9c6a75685ceaaf370d58ea24"><div class="ttname"><a href="classcarma__wm_1_1TrackPos.html#a6ea99bbb9c6a75685ceaaf370d58ea24">carma_wm::TrackPos::downtrack</a></div><div class="ttdeci">double downtrack</div><div class="ttdef"><b>Definition:</b> <a href="TrackPos_8hpp_source.html#l00037">TrackPos.hpp:37</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_abcab6368ab8bffc15e380b099554b314"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#abcab6368ab8bffc15e380b099554b314">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::setHostECEF</a></div><div class="ttdeci">void setHostECEF(carma_v2x_msgs::msg::LocationECEF pose_ecef_point)</div><div class="ttdoc">UCLA Update the private variable pose_ecef_point_.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l00090">platoon_strategic_ihp.cpp:90</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="TrackPos_8hpp_source.html#l00038">carma_wm::TrackPos::crosstrack</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00332">current_crosstrack_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00330">current_downtrack_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00370">platoon_strategic_ihp::PlatoonManager::current_platoon_state</a>, <a class="el" href="TrackPos_8hpp_source.html#l00037">carma_wm::TrackPos::downtrack</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00817">pm_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00322">pose_msg_</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00064">pose_to_ecef()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00090">setHostECEF()</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00078">platoon_strategic_ihp::STANDBY</a>, <a class="el" href="platoon__manager__ihp_8cpp_source.html#l00058">platoon_strategic_ihp::PlatoonManager::updateHostPose()</a>, and <a class="el" href="platoon__strategic__ihp_8h_source.html#l00315">wm_</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp__node_8cpp_source.html#l00118">platoon_strategic_ihp::Node::on_configure_plugin()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aa81560488f89d886d731bcdbfebbbf37_cgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aa81560488f89d886d731bcdbfebbbf37_cgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aa81560488f89d886d731bcdbfebbbf37_cgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aa81560488f89d886d731bcdbfebbbf37_cgraph">
<area shape="rect" title="Callback function for current pose." alt="" coords="5,85,188,141"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a11ffedaaa90fe358ecfdccab7c5a428c" title="Function to convert pose from map frame to ecef location." alt="" coords="257,5,440,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#abcab6368ab8bffc15e380b099554b314" title="UCLA Update the private variable pose_ecef_point_." alt="" coords="257,85,440,141"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ab1710b942f6893b756b67dd6505ee90b" title="Stores the latest info on location of the host vehicle." alt="" coords="236,165,461,206"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aa81560488f89d886d731bcdbfebbbf37_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aa81560488f89d886d731bcdbfebbbf37_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aa81560488f89d886d731bcdbfebbbf37_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aa81560488f89d886d731bcdbfebbbf37_icgraph">
<area shape="rect" title="Callback function for current pose." alt="" coords="199,5,381,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,5,151,61"/>
</map>
</div>

</div>
</div>
<a id="a11ffedaaa90fe358ecfdccab7c5a428c" name="a11ffedaaa90fe358ecfdccab7c5a428c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11ffedaaa90fe358ecfdccab7c5a428c">&#9670;&nbsp;</a></span>pose_to_ecef()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">carma_v2x_msgs::msg::LocationECEF platoon_strategic_ihp::PlatoonStrategicIHPPlugin::pose_to_ecef </td>
          <td>(</td>
          <td class="paramtype">geometry_msgs::msg::PoseStamped&#160;</td>
          <td class="paramname"><em>pose_msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to convert pose from map frame to ecef location. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pose_msg</td><td>pose message</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>mobility operation msg </dd></dl>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00064">64</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   65</span>    {</div>
<div class="line"><span class="lineno">   66</span> </div>
<div class="line"><span class="lineno">   67</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a6aef0343096358d7180a1a301022cd9e">map_projector_</a>) </div>
<div class="line"><span class="lineno">   68</span>        {</div>
<div class="line"><span class="lineno">   69</span>            <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;No map projector available for ecef conversion&quot;</span>);</div>
<div class="line"><span class="lineno">   70</span>        }</div>
<div class="line"><span class="lineno">   71</span>        </div>
<div class="line"><span class="lineno">   72</span>        carma_v2x_msgs::msg::LocationECEF location;</div>
<div class="line"><span class="lineno">   73</span> </div>
<div class="line"><span class="lineno">   74</span>        <span class="comment">// note: ecef point read from map projector is in m.</span></div>
<div class="line"><span class="lineno">   75</span>        lanelet::BasicPoint3d ecef_point = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a6aef0343096358d7180a1a301022cd9e">map_projector_</a>-&gt;projectECEF({pose_msg.pose.position.x, pose_msg.pose.position.y, 0.0}, 1);</div>
<div class="line"><span class="lineno">   76</span>        location.ecef_x = ecef_point.x() * 100.0;</div>
<div class="line"><span class="lineno">   77</span>        location.ecef_y = ecef_point.y() * 100.0;</div>
<div class="line"><span class="lineno">   78</span>        location.ecef_z = ecef_point.z() * 100.0;    </div>
<div class="line"><span class="lineno">   79</span>        </div>
<div class="line"><span class="lineno">   80</span> </div>
<div class="line"><span class="lineno">   81</span>        <span class="comment">// RCLCPP_DEBUG_STREAM(rclcpp::get_logger(&quot;platoon_strategic_ihp&quot;), &quot;location.ecef_x: &quot; &lt;&lt; location.ecef_x);</span></div>
<div class="line"><span class="lineno">   82</span>        <span class="comment">// RCLCPP_DEBUG_STREAM(rclcpp::get_logger(&quot;platoon_strategic_ihp&quot;), &quot;location.ecef_y: &quot; &lt;&lt; location.ecef_y);</span></div>
<div class="line"><span class="lineno">   83</span>        <span class="comment">// RCLCPP_DEBUG_STREAM(rclcpp::get_logger(&quot;platoon_strategic_ihp&quot;), &quot;location.ecef_z: &quot; &lt;&lt; location.ecef_z);</span></div>
<div class="line"><span class="lineno">   84</span> </div>
<div class="line"><span class="lineno">   85</span>        <span class="comment">// note: the returned ecef is in cm.</span></div>
<div class="line"><span class="lineno">   86</span>        <span class="keywordflow">return</span> location;</div>
<div class="line"><span class="lineno">   87</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__strategic__ihp_8h_source.html#l00773">map_projector_</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00954">mob_op_cb_leader()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01244">mob_op_cb_preparetojoin()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01870">mob_req_cb_leadwithoperation()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02455">mob_resp_cb_preparetojoin()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00115">pose_cb()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02722">run_candidate_follower()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02822">run_leader_aborting()</a>, and <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02977">run_prepare_to_join()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a11ffedaaa90fe358ecfdccab7c5a428c_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a11ffedaaa90fe358ecfdccab7c5a428c_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a11ffedaaa90fe358ecfdccab7c5a428c_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a11ffedaaa90fe358ecfdccab7c5a428c_icgraph">
<area shape="rect" title="Function to convert pose from map frame to ecef location." alt="" coords="915,279,1097,335"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#afd00a90158f773100543b3f56f964d74" title="Function to process mobility operation in leader state." alt="" coords="672,5,855,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#afe00eb7730952e85faccf8032637983f" title="Function to process mobility operation in PrepareToJoin state (cut&#45;in join)" alt="" coords="672,85,855,141"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a18b8dcd9744c6df8a615a1ce76f42146" title="Function to process mobility request in leadwithoperation state (cut&#45;in join)" alt="" coords="660,165,867,221"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a900863cced7c330fb24f93bc33649cd8" title="Function to process mobility response in preparetojoin state." alt="" coords="670,245,857,301"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa81560488f89d886d731bcdbfebbbf37" title="Callback function for current pose." alt="" coords="199,325,381,381"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a7d07b2ec081219ee9fb62418170bb1f8" title="Run Candidate Follower State." alt="" coords="672,376,855,432"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a848aac5dfc1f6a3c4fba8fa0bba0ca66" title="Run Leader Aborting State." alt="" coords="672,456,855,512"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a8c989d9220109cab74fb8aff6212f27e" title="UCLA Run prepare to join State." alt="" coords="672,536,855,592"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a9f77f3abf67b6006fd6c9b965cbb1c10" title="Callback function for Mobility Operation Message." alt="" coords="429,85,612,141"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,245,151,301"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a53cc42ead95e9734805f4b52de1e38eb" title="Function to the process and respond to the mobility request." alt="" coords="429,165,612,221"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a588b379b14e20af4e05cf4883c535c5a" title="Callback function for Mobility Request Message." alt="" coords="199,165,381,221"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aaca0c4143be4a27041ab5ed90d2c624c" title="Callback function for Mobility Response Message." alt="" coords="199,245,381,301"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ac7e7160659b61a4ac61be14f74fb1caa" title="Spin callback function." alt="" coords="429,440,612,496"/>
</map>
</div>

</div>
</div>
<a id="a7d07b2ec081219ee9fb62418170bb1f8" name="a7d07b2ec081219ee9fb62418170bb1f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d07b2ec081219ee9fb62418170bb1f8">&#9670;&nbsp;</a></span>run_candidate_follower()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void platoon_strategic_ihp::PlatoonStrategicIHPPlugin::run_candidate_follower </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Run Candidate Follower State. </p>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02722">2722</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2723</span>    {</div>
<div class="line"><span class="lineno"> 2724</span>        <span class="keywordtype">long</span> tsStart = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a283186f2bbb98f5f85b5486e365bb4b8">timer_factory_</a>-&gt;now().nanoseconds() / 1000000;</div>
<div class="line"><span class="lineno"> 2725</span> </div>
<div class="line"><span class="lineno"> 2726</span>        <span class="comment">// Task 1: state timeout</span></div>
<div class="line"><span class="lineno"> 2727</span>        <span class="keywordtype">bool</span> isCurrentStateTimeout = (tsStart - <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa30dd7c98fe60faad9ba8af0da2da581">candidatestateStartTime</a>) &gt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a5bb0123eb1a68e83b1a424eeb94f0929">waitingStateTimeout</a> * 1000;</div>
<div class="line"><span class="lineno"> 2728</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;timeout1: &quot;</span> &lt;&lt; tsStart - <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa30dd7c98fe60faad9ba8af0da2da581">candidatestateStartTime</a>);</div>
<div class="line"><span class="lineno"> 2729</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;waitingStateTimeout: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a5bb0123eb1a68e83b1a424eeb94f0929">waitingStateTimeout</a> * 1000);</div>
<div class="line"><span class="lineno"> 2730</span>        <span class="keywordflow">if</span> (isCurrentStateTimeout) </div>
<div class="line"><span class="lineno"> 2731</span>        {</div>
<div class="line"><span class="lineno"> 2732</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;The current candidate follower state is timeout. Change back to leader state.&quot;</span>);</div>
<div class="line"><span class="lineno"> 2733</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> = <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa57f78e815f4fc2ac271a9fd85cd80ebc">PlatoonState::LEADER</a>;</div>
<div class="line"><span class="lineno"> 2734</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#af2f0d9818d07db4a4df484f988635201">clearActionPlan</a>();</div>
<div class="line"><span class="lineno"> 2735</span>        }</div>
<div class="line"><span class="lineno"> 2736</span> </div>
<div class="line"><span class="lineno"> 2737</span>        <span class="comment">// Task 2: plan timeout, check if current plan is still valid (i.e., not timed out).   </span></div>
<div class="line"><span class="lineno"> 2738</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a9474313cd68557978e8dbd481d0408bc">valid</a>) </div>
<div class="line"><span class="lineno"> 2739</span>        {</div>
<div class="line"><span class="lineno"> 2740</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;pm_.current_plan.planStartTime: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a4b43d9a607f76a48b4023fbd9dd3e3e3">planStartTime</a>);</div>
<div class="line"><span class="lineno"> 2741</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;timeout2: &quot;</span> &lt;&lt; tsStart - <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a4b43d9a607f76a48b4023fbd9dd3e3e3">planStartTime</a>);</div>
<div class="line"><span class="lineno"> 2742</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;NEGOTIATION_TIMEOUT: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aef3664c4c7ac360846defce18161e92b">NEGOTIATION_TIMEOUT</a>);</div>
<div class="line"><span class="lineno"> 2743</span>            <span class="keywordtype">bool</span> isPlanTimeout = tsStart - <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a4b43d9a607f76a48b4023fbd9dd3e3e3">planStartTime</a> &gt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aef3664c4c7ac360846defce18161e92b">NEGOTIATION_TIMEOUT</a>;</div>
<div class="line"><span class="lineno"> 2744</span>            <span class="keywordflow">if</span> (isPlanTimeout) </div>
<div class="line"><span class="lineno"> 2745</span>            {</div>
<div class="line"><span class="lineno"> 2746</span>                <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> = <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa57f78e815f4fc2ac271a9fd85cd80ebc">PlatoonState::LEADER</a>;</div>
<div class="line"><span class="lineno"> 2747</span>                <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#af2f0d9818d07db4a4df484f988635201">clearActionPlan</a>();</div>
<div class="line"><span class="lineno"> 2748</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;The current plan did not receive any response. Abort and change to leader state.&quot;</span>);</div>
<div class="line"><span class="lineno"> 2749</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Changed the state back to Leader&quot;</span>);</div>
<div class="line"><span class="lineno"> 2750</span>            }</div>
<div class="line"><span class="lineno"> 2751</span>        }</div>
<div class="line"><span class="lineno"> 2752</span> </div>
<div class="line"><span class="lineno"> 2753</span>        <span class="comment">// Task 3: update plan calculate gap, update plan: send PLATOON_FOLLOWER_JOIN request with new gap</span></div>
<div class="line"><span class="lineno"> 2754</span>        <span class="keywordtype">double</span> desiredJoinGap2 = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a05ce3335d0638ae290bd3674b1499bc6">desiredJoinTimeGap</a> * <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3e827c7f2e764c6e7de83f0a81a9593f">current_speed_</a>;</div>
<div class="line"><span class="lineno"> 2755</span>        <span class="keywordtype">double</span> maxJoinGap = std::max(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#ab3b2aa9cfef500579859652c3aaffe43">desiredJoinGap</a>, desiredJoinGap2);</div>
<div class="line"><span class="lineno"> 2756</span>        <span class="keywordtype">double</span> currentGap = 0.0;</div>
<div class="line"><span class="lineno"> 2757</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a5810c2ddb1b317d7cd7a038615844185">neighbor_platoon_</a>.empty())</div>
<div class="line"><span class="lineno"> 2758</span>        {</div>
<div class="line"><span class="lineno"> 2759</span>            currentGap = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a5810c2ddb1b317d7cd7a038615844185">neighbor_platoon_</a>.back().vehiclePosition - <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa53003d4c3610dbb5f87762a6683dd9f">current_downtrack_</a>;</div>
<div class="line"><span class="lineno"> 2760</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;curent gap calculated from back of neighbor platoon: &quot;</span> &lt;&lt; currentGap);</div>
<div class="line"><span class="lineno"> 2761</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;pm_.neighbor_platoon_.back().vehiclePosition &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a5810c2ddb1b317d7cd7a038615844185">neighbor_platoon_</a>.back().vehiclePosition);</div>
<div class="line"><span class="lineno"> 2762</span>       </div>
<div class="line"><span class="lineno"> 2763</span>        }</div>
<div class="line"><span class="lineno"> 2764</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2765</span>        {</div>
<div class="line"><span class="lineno"> 2766</span>            currentGap = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a472f726662a0702881c52b4da95bd457">getDistanceToPredVehicle</a>();</div>
<div class="line"><span class="lineno"> 2767</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;curent gap when there is no neighbor platoon: &quot;</span> &lt;&lt; currentGap);</div>
<div class="line"><span class="lineno"> 2768</span>        }</div>
<div class="line"><span class="lineno"> 2769</span> </div>
<div class="line"><span class="lineno"> 2770</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Based on desired join time gap, the desired join distance gap is &quot;</span> &lt;&lt; desiredJoinGap2 &lt;&lt; <span class="stringliteral">&quot; ms&quot;</span>);</div>
<div class="line"><span class="lineno"> 2771</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Since we have max allowed gap as &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#ab3b2aa9cfef500579859652c3aaffe43">desiredJoinGap</a> &lt;&lt; <span class="stringliteral">&quot; m then max join gap became &quot;</span> &lt;&lt; maxJoinGap &lt;&lt; <span class="stringliteral">&quot; m&quot;</span>);</div>
<div class="line"><span class="lineno"> 2772</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;The current gap from radar is &quot;</span> &lt;&lt; currentGap &lt;&lt; <span class="stringliteral">&quot; m&quot;</span>);</div>
<div class="line"><span class="lineno"> 2773</span>        <span class="keywordflow">if</span> (currentGap &lt;= maxJoinGap  &amp;&amp;  !<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a9474313cd68557978e8dbd481d0408bc">valid</a>)</div>
<div class="line"><span class="lineno"> 2774</span>        {</div>
<div class="line"><span class="lineno"> 2775</span>            carma_v2x_msgs::msg::MobilityRequest request;</div>
<div class="line"><span class="lineno"> 2776</span>            std::string planId = boost::uuids::to_string(boost::uuids::random_generator()());</div>
<div class="line"><span class="lineno"> 2777</span>            <span class="keywordtype">long</span> currentTime = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a283186f2bbb98f5f85b5486e365bb4b8">timer_factory_</a>-&gt;now().nanoseconds() / 1000000;</div>
<div class="line"><span class="lineno"> 2778</span>            request.m_header.plan_id = planId;</div>
<div class="line"><span class="lineno"> 2779</span>            request.m_header.recipient_id = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a38851b8c1a54cc039c86fa3576c940e4">peerId</a>;</div>
<div class="line"><span class="lineno"> 2780</span>            request.m_header.sender_id = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a473bcce97d7c50beaab678372a354c0d">vehicleID</a>;</div>
<div class="line"><span class="lineno"> 2781</span>            request.m_header.timestamp = currentTime;</div>
<div class="line"><span class="lineno"> 2782</span> </div>
<div class="line"><span class="lineno"> 2783</span>            request.plan_type.type = carma_v2x_msgs::msg::PlanType::PLATOON_FOLLOWER_JOIN;</div>
<div class="line"><span class="lineno"> 2784</span>            request.strategy = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3be0b52376b568130c1c6a5ec5adeb13">PLATOONING_STRATEGY</a>;</div>
<div class="line"><span class="lineno"> 2785</span>            request.strategy_params = <span class="stringliteral">&quot;&quot;</span>; <span class="comment">//params will not be read by receiver since this is 2nd msg in sequence</span></div>
<div class="line"><span class="lineno"> 2786</span>            request.urgency = 50;</div>
<div class="line"><span class="lineno"> 2787</span>            request.location = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a11ffedaaa90fe358ecfdccab7c5a428c">pose_to_ecef</a>(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa67d1b97f198e2f088fb24ffb8e0c690">pose_msg_</a>);</div>
<div class="line"><span class="lineno"> 2788</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae4e916260ddb6f7eb25da13ef9cb158e">mobility_request_publisher_</a>(request);</div>
<div class="line"><span class="lineno"> 2789</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Published Mobility Candidate-Join request to the leader&quot;</span>);</div>
<div class="line"><span class="lineno"> 2790</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;current plan peer id: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a38851b8c1a54cc039c86fa3576c940e4">peerId</a>);</div>
<div class="line"><span class="lineno"> 2791</span> </div>
<div class="line"><span class="lineno"> 2792</span>            <span class="comment">// Update the local record of the new activity plan and now establish that we have a platoon plan as well,</span></div>
<div class="line"><span class="lineno"> 2793</span>            <span class="comment">// which allows us to start sending necessary op STATUS messages</span></div>
<div class="line"><span class="lineno"> 2794</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a> = ActionPlan(<span class="keyword">true</span>, currentTime, planId, <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a38851b8c1a54cc039c86fa3576c940e4">peerId</a>);</div>
<div class="line"><span class="lineno"> 2795</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a05732c5f9b2d8f5d2c66d1cdcf793854">platoonLeaderID</a> = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a38851b8c1a54cc039c86fa3576c940e4">peerId</a>;</div>
<div class="line"><span class="lineno"> 2796</span> </div>
<div class="line"><span class="lineno"> 2797</span>            <span class="comment">// Initialize counter to delay transmission of first operation STATUS message</span></div>
<div class="line"><span class="lineno"> 2798</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a05bae259db41743d775c87f37d132d72">candidate_follower_delay_count_</a> = 0;</div>
<div class="line"><span class="lineno"> 2799</span>        }</div>
<div class="line"><span class="lineno"> 2800</span> </div>
<div class="line"><span class="lineno"> 2801</span>        <span class="comment">//Task 4: publish platoon status message (as single joiner)</span></div>
<div class="line"><span class="lineno"> 2802</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a9474313cd68557978e8dbd481d0408bc">valid</a>) </div>
<div class="line"><span class="lineno"> 2803</span>        {</div>
<div class="line"><span class="lineno"> 2804</span>            <span class="comment">// Don&#39;t want to do this until after the above MobReq message is delivered, otherwise recipient will double-count us in their platoon</span></div>
<div class="line"><span class="lineno"> 2805</span>            <span class="keywordflow">if</span> (++<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a05bae259db41743d775c87f37d132d72">candidate_follower_delay_count_</a> &gt; 2)</div>
<div class="line"><span class="lineno"> 2806</span>            {</div>
<div class="line"><span class="lineno"> 2807</span>                carma_v2x_msgs::msg::MobilityOperation status;</div>
<div class="line"><span class="lineno"> 2808</span>                status = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a657b2d890046589b62c473178a134b20">composeMobilityOperationCandidateFollower</a>();</div>
<div class="line"><span class="lineno"> 2809</span>                <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a19ea827fa9a96b9154f33d364d89260e">mobility_operation_publisher_</a>(status);</div>
<div class="line"><span class="lineno"> 2810</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Published platoon STATUS operation message as Candidate Follower&quot;</span>);</div>
<div class="line"><span class="lineno"> 2811</span>            }</div>
<div class="line"><span class="lineno"> 2812</span>        }</div>
<div class="line"><span class="lineno"> 2813</span> </div>
<div class="line"><span class="lineno"> 2814</span>        <span class="keywordtype">long</span> tsEnd = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a283186f2bbb98f5f85b5486e365bb4b8">timer_factory_</a>-&gt;now().nanoseconds() / 1000000;</div>
<div class="line"><span class="lineno"> 2815</span>        <span class="keywordtype">long</span> sleepDuration = std::max((<a class="code hl_typedef" href="stdint_8h.html#ab1967d8591af1a4e48c37fd2b0f184d0">int32_t</a>)(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae54ec36efc19b9c2edc90148ac10b4e0">statusMessageInterval_</a> - (tsEnd - tsStart)), 0);</div>
<div class="line"><span class="lineno"> 2816</span>        <span class="comment">// TODO this solution is not sim-time complient and should be replaced with one which is when possible</span></div>
<div class="line"><span class="lineno"> 2817</span>        <span class="comment">// https://github.com/usdot-fhwa-stol/carma-platform/issues/1888</span></div>
<div class="line"><span class="lineno"> 2818</span>        std::this_thread::sleep_for(std::chrono::milliseconds(sleepDuration));</div>
<div class="line"><span class="lineno"> 2819</span>    }</div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_a472f726662a0702881c52b4da95bd457"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a472f726662a0702881c52b4da95bd457">platoon_strategic_ihp::PlatoonManager::getDistanceToPredVehicle</a></div><div class="ttdeci">double getDistanceToPredVehicle()</div><div class="ttdoc">Returns distance to the predessecor vehicle, in m.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00728">platoon_manager_ihp.cpp:728</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a05bae259db41743d775c87f37d132d72"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a05bae259db41743d775c87f37d132d72">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::candidate_follower_delay_count_</a></div><div class="ttdeci">int candidate_follower_delay_count_</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8h_source.html#l00785">platoon_strategic_ihp.h:785</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a5bb0123eb1a68e83b1a424eeb94f0929"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a5bb0123eb1a68e83b1a424eeb94f0929">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::waitingStateTimeout</a></div><div class="ttdeci">double waitingStateTimeout</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8h_source.html#l00798">platoon_strategic_ihp.h:798</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a657b2d890046589b62c473178a134b20"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a657b2d890046589b62c473178a134b20">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::composeMobilityOperationCandidateFollower</a></div><div class="ttdeci">carma_v2x_msgs::msg::MobilityOperation composeMobilityOperationCandidateFollower()</div><div class="ttdoc">Function to compose mobility operation in candidate follower state.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l00601">platoon_strategic_ihp.cpp:601</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_ae54ec36efc19b9c2edc90148ac10b4e0"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae54ec36efc19b9c2edc90148ac10b4e0">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::statusMessageInterval_</a></div><div class="ttdeci">int statusMessageInterval_</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8h_source.html#l00793">platoon_strategic_ihp.h:793</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_aef3664c4c7ac360846defce18161e92b"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aef3664c4c7ac360846defce18161e92b">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::NEGOTIATION_TIMEOUT</a></div><div class="ttdeci">unsigned long NEGOTIATION_TIMEOUT</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8h_source.html#l00794">platoon_strategic_ihp.h:794</a></div></div>
<div class="ttc" id="astdint_8h_html_ab1967d8591af1a4e48c37fd2b0f184d0"><div class="ttname"><a href="stdint_8h.html#ab1967d8591af1a4e48c37fd2b0f184d0">int32_t</a></div><div class="ttdeci">signed int int32_t</div><div class="ttdef"><b>Definition:</b> <a href="stdint_8h_source.html#l00123">stdint.h:123</a></div></div>
<div class="ttc" id="astructplatoon__strategic__ihp_1_1ActionPlan_html_a4b43d9a607f76a48b4023fbd9dd3e3e3"><div class="ttname"><a href="structplatoon__strategic__ihp_1_1ActionPlan.html#a4b43d9a607f76a48b4023fbd9dd3e3e3">platoon_strategic_ihp::ActionPlan::planStartTime</a></div><div class="ttdeci">unsigned long planStartTime</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8h_source.html#l00048">platoon_manager_ihp.h:48</a></div></div>
<div class="ttc" id="astructplatoon__strategic__ihp_1_1PlatoonPluginConfig_html_a05ce3335d0638ae290bd3674b1499bc6"><div class="ttname"><a href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a05ce3335d0638ae290bd3674b1499bc6">platoon_strategic_ihp::PlatoonPluginConfig::desiredJoinTimeGap</a></div><div class="ttdeci">double desiredJoinTimeGap</div><div class="ttdef"><b>Definition:</b> <a href="platoon__config__ihp_8h_source.html#l00047">platoon_config_ihp.h:47</a></div></div>
<div class="ttc" id="astructplatoon__strategic__ihp_1_1PlatoonPluginConfig_html_ab3b2aa9cfef500579859652c3aaffe43"><div class="ttname"><a href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#ab3b2aa9cfef500579859652c3aaffe43">platoon_strategic_ihp::PlatoonPluginConfig::desiredJoinGap</a></div><div class="ttdeci">double desiredJoinGap</div><div class="ttdef"><b>Definition:</b> <a href="platoon__config__ihp_8h_source.html#l00048">platoon_config_ihp.h:48</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__strategic__ihp_8h_source.html#l00785">candidate_follower_delay_count_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00336">candidatestateStartTime</a>, <a class="el" href="platoon__manager__ihp_8cpp_source.html#l00285">platoon_strategic_ihp::PlatoonManager::clearActionPlan()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00601">composeMobilityOperationCandidateFollower()</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00318">config_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00330">current_downtrack_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00376">platoon_strategic_ihp::PlatoonManager::current_plan</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00370">platoon_strategic_ihp::PlatoonManager::current_platoon_state</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00328">current_speed_</a>, <a class="el" href="platoon__config__ihp_8h_source.html#l00048">platoon_strategic_ihp::PlatoonPluginConfig::desiredJoinGap</a>, <a class="el" href="platoon__config__ihp_8h_source.html#l00047">platoon_strategic_ihp::PlatoonPluginConfig::desiredJoinTimeGap</a>, <a class="el" href="platoon__manager__ihp_8cpp_source.html#l00728">platoon_strategic_ihp::PlatoonManager::getDistanceToPredVehicle()</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00080">platoon_strategic_ihp::LEADER</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00310">mobility_operation_publisher_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00308">mobility_request_publisher_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00794">NEGOTIATION_TIMEOUT</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00384">platoon_strategic_ihp::PlatoonManager::neighbor_platoon_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00050">platoon_strategic_ihp::ActionPlan::peerId</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00048">platoon_strategic_ihp::ActionPlan::planStartTime</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00820">PLATOONING_STRATEGY</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00367">platoon_strategic_ihp::PlatoonManager::platoonLeaderID</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00817">pm_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00322">pose_msg_</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00064">pose_to_ecef()</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00793">statusMessageInterval_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00814">timer_factory_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00047">platoon_strategic_ihp::ActionPlan::valid</a>, <a class="el" href="platoon__config__ihp_8h_source.html#l00068">platoon_strategic_ihp::PlatoonPluginConfig::vehicleID</a>, and <a class="el" href="platoon__strategic__ihp_8h_source.html#l00798">waitingStateTimeout</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l03060">onSpin()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a7d07b2ec081219ee9fb62418170bb1f8_cgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a7d07b2ec081219ee9fb62418170bb1f8_cgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a7d07b2ec081219ee9fb62418170bb1f8_cgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a7d07b2ec081219ee9fb62418170bb1f8_cgraph">
<area shape="rect" title="Run Candidate Follower State." alt="" coords="5,122,188,178"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#af2f0d9818d07db4a4df484f988635201" title="Resets necessary variables to indicate that the current ActionPlan is dead." alt="" coords="246,5,465,47"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a657b2d890046589b62c473178a134b20" title="Function to compose mobility operation in candidate follower state." alt="" coords="236,71,475,141"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a472f726662a0702881c52b4da95bd457" title="Returns distance to the predessecor vehicle, in m." alt="" coords="257,166,454,222"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a11ffedaaa90fe358ecfdccab7c5a428c" title="Function to convert pose from map frame to ecef location." alt="" coords="264,246,447,302"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aabe87e2046da048da999758ebdd119fe" title="Function to compose mobility operation message with STATUS params." alt="" coords="523,78,757,134"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a7d07b2ec081219ee9fb62418170bb1f8_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a7d07b2ec081219ee9fb62418170bb1f8_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a7d07b2ec081219ee9fb62418170bb1f8_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a7d07b2ec081219ee9fb62418170bb1f8_icgraph">
<area shape="rect" title="Run Candidate Follower State." alt="" coords="429,5,612,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ac7e7160659b61a4ac61be14f74fb1caa" title="Spin callback function." alt="" coords="199,5,381,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,5,151,61"/>
</map>
</div>

</div>
</div>
<a id="aa2c3c1b6030726c8e1931ea0093dd91d" name="aa2c3c1b6030726c8e1931ea0093dd91d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2c3c1b6030726c8e1931ea0093dd91d">&#9670;&nbsp;</a></span>run_candidate_leader()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void platoon_strategic_ihp::PlatoonStrategicIHPPlugin::run_candidate_leader </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Run Candidate Leader State. </p>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02918">2918</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2919</span>    {</div>
<div class="line"><span class="lineno"> 2920</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Run Candidate Leader State &quot;</span>);</div>
<div class="line"><span class="lineno"> 2921</span>        <span class="keywordtype">long</span> tsStart = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a283186f2bbb98f5f85b5486e365bb4b8">timer_factory_</a>-&gt;now().nanoseconds() / 1000000;</div>
<div class="line"><span class="lineno"> 2922</span>        <span class="comment">// Task 1: State time out</span></div>
<div class="line"><span class="lineno"> 2923</span>        <span class="keywordflow">if</span> (tsStart - <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa30dd7c98fe60faad9ba8af0da2da581">candidatestateStartTime</a> &gt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a5bb0123eb1a68e83b1a424eeb94f0929">waitingStateTimeout</a> * 1000)</div>
<div class="line"><span class="lineno"> 2924</span>        {</div>
<div class="line"><span class="lineno"> 2925</span>            <span class="comment">//TODO if the current state timeouts, we need to have a kind of ABORT message to inform the applicant</span></div>
<div class="line"><span class="lineno"> 2926</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;CandidateLeader state is timeout, changing back to PlatoonLeaderState.&quot;</span>);</div>
<div class="line"><span class="lineno"> 2927</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> = <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa57f78e815f4fc2ac271a9fd85cd80ebc">PlatoonState::LEADER</a>;</div>
<div class="line"><span class="lineno"> 2928</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#af2f0d9818d07db4a4df484f988635201">clearActionPlan</a>();</div>
<div class="line"><span class="lineno"> 2929</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ab1c204db4a5056621de299a9dd663c6f">resetHostPlatoon</a>();</div>
<div class="line"><span class="lineno"> 2930</span>        }</div>
<div class="line"><span class="lineno"> 2931</span> </div>
<div class="line"><span class="lineno"> 2932</span>        <span class="comment">// Task 2: publish status message</span></div>
<div class="line"><span class="lineno"> 2933</span>        carma_v2x_msgs::msg::MobilityOperation status;</div>
<div class="line"><span class="lineno"> 2934</span>        status = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a5e18795bb16ef8f84cf6e451def325bb">composeMobilityOperationCandidateLeader</a>();</div>
<div class="line"><span class="lineno"> 2935</span>        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a19ea827fa9a96b9154f33d364d89260e">mobility_operation_publisher_</a>(status);</div>
<div class="line"><span class="lineno"> 2936</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;publish status message&quot;</span>);</div>
<div class="line"><span class="lineno"> 2937</span>        <span class="keywordtype">long</span> tsEnd = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a283186f2bbb98f5f85b5486e365bb4b8">timer_factory_</a>-&gt;now().nanoseconds() / 1000000;</div>
<div class="line"><span class="lineno"> 2938</span>        <span class="keywordtype">long</span> sleepDuration = std::max((<a class="code hl_typedef" href="stdint_8h.html#ab1967d8591af1a4e48c37fd2b0f184d0">int32_t</a>)(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae54ec36efc19b9c2edc90148ac10b4e0">statusMessageInterval_</a> - (tsEnd - tsStart)), 0);</div>
<div class="line"><span class="lineno"> 2939</span>        <span class="comment">// TODO this solution is not sim-time complient and should be replaced with one which is when possible</span></div>
<div class="line"><span class="lineno"> 2940</span>        <span class="comment">// https://github.com/usdot-fhwa-stol/carma-platform/issues/1888</span></div>
<div class="line"><span class="lineno"> 2941</span>        std::this_thread::sleep_for(std::chrono::milliseconds(sleepDuration));</div>
<div class="line"><span class="lineno"> 2942</span>    }</div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a5e18795bb16ef8f84cf6e451def325bb"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a5e18795bb16ef8f84cf6e451def325bb">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::composeMobilityOperationCandidateLeader</a></div><div class="ttdeci">carma_v2x_msgs::msg::MobilityOperation composeMobilityOperationCandidateLeader()</div><div class="ttdoc">Function to compose mobility operation in CandidateLeader.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l00621">platoon_strategic_ihp.cpp:621</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__strategic__ihp_8h_source.html#l00336">candidatestateStartTime</a>, <a class="el" href="platoon__manager__ihp_8cpp_source.html#l00285">platoon_strategic_ihp::PlatoonManager::clearActionPlan()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00621">composeMobilityOperationCandidateLeader()</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00370">platoon_strategic_ihp::PlatoonManager::current_platoon_state</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00080">platoon_strategic_ihp::LEADER</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00310">mobility_operation_publisher_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00817">pm_</a>, <a class="el" href="platoon__manager__ihp_8cpp_source.html#l00295">platoon_strategic_ihp::PlatoonManager::resetHostPlatoon()</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00793">statusMessageInterval_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00814">timer_factory_</a>, and <a class="el" href="platoon__strategic__ihp_8h_source.html#l00798">waitingStateTimeout</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l03060">onSpin()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aa2c3c1b6030726c8e1931ea0093dd91d_cgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aa2c3c1b6030726c8e1931ea0093dd91d_cgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aa2c3c1b6030726c8e1931ea0093dd91d_cgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aa2c3c1b6030726c8e1931ea0093dd91d_cgraph">
<area shape="rect" title="Run Candidate Leader State." alt="" coords="5,78,188,134"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#af2f0d9818d07db4a4df484f988635201" title="Resets necessary variables to indicate that the current ActionPlan is dead." alt="" coords="246,5,465,47"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a5e18795bb16ef8f84cf6e451def325bb" title="Function to compose mobility operation in CandidateLeader." alt="" coords="236,71,475,141"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ab1c204db4a5056621de299a9dd663c6f" title="Resets all variables that might indicate other members of the host&#39;s platoon; sets the host back to s..." alt="" coords="263,166,448,222"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aabe87e2046da048da999758ebdd119fe" title="Function to compose mobility operation message with STATUS params." alt="" coords="523,78,757,134"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aa2c3c1b6030726c8e1931ea0093dd91d_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aa2c3c1b6030726c8e1931ea0093dd91d_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aa2c3c1b6030726c8e1931ea0093dd91d_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_aa2c3c1b6030726c8e1931ea0093dd91d_icgraph">
<area shape="rect" title="Run Candidate Leader State." alt="" coords="429,5,612,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ac7e7160659b61a4ac61be14f74fb1caa" title="Spin callback function." alt="" coords="199,5,381,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,5,151,61"/>
</map>
</div>

</div>
</div>
<a id="a3e9dbfe57693b6d23d99b61af6375a4f" name="a3e9dbfe57693b6d23d99b61af6375a4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e9dbfe57693b6d23d99b61af6375a4f">&#9670;&nbsp;</a></span>run_follower()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void platoon_strategic_ihp::PlatoonStrategicIHPPlugin::run_follower </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Run Follower State. </p>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02679">2679</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2680</span>    {</div>
<div class="line"><span class="lineno"> 2681</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;run follower&quot;</span>);</div>
<div class="line"><span class="lineno"> 2682</span>        <span class="comment">// This is a interrupted-safe loop.</span></div>
<div class="line"><span class="lineno"> 2683</span>        <span class="comment">// This loop has four tasks:</span></div>
<div class="line"><span class="lineno"> 2684</span>        <span class="comment">// 1. Check the state start time, if it exceeds a limit it will give up current plan and change back to leader state</span></div>
<div class="line"><span class="lineno"> 2685</span>        <span class="comment">// 2. Abort current request if we wait for long enough time for response from leader and change back to leader state</span></div>
<div class="line"><span class="lineno"> 2686</span>        </div>
<div class="line"><span class="lineno"> 2687</span>        <span class="keywordtype">long</span> tsStart = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a283186f2bbb98f5f85b5486e365bb4b8">timer_factory_</a>-&gt;now().nanoseconds() / 1000000;</div>
<div class="line"><span class="lineno"> 2688</span>        <span class="comment">// Job 1</span></div>
<div class="line"><span class="lineno"> 2689</span>        carma_v2x_msgs::msg::MobilityOperation status;</div>
<div class="line"><span class="lineno"> 2690</span>        status = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3a80cbd904887d9fa98448f76fba7993">composeMobilityOperationFollower</a>();</div>
<div class="line"><span class="lineno"> 2691</span>        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a19ea827fa9a96b9154f33d364d89260e">mobility_operation_publisher_</a>(status);</div>
<div class="line"><span class="lineno"> 2692</span>        <span class="comment">// Job 2</span></div>
<div class="line"><span class="lineno"> 2693</span>        <span class="comment">// Get the number of vehicles in this platoon who is in front of us</span></div>
<div class="line"><span class="lineno"> 2694</span>        <span class="keywordtype">int</span> vehicleInFront = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a1de160740f47d9b0198e42dcbe67a6fe">getNumberOfVehicleInFront</a>();</div>
<div class="line"><span class="lineno"> 2695</span>        <span class="keywordflow">if</span> (vehicleInFront == 0) </div>
<div class="line"><span class="lineno"> 2696</span>        {</div>
<div class="line"><span class="lineno"> 2697</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3055c6de78415d37b56209a66c079e57">noLeaderUpdatesCounter</a>++;</div>
<div class="line"><span class="lineno"> 2698</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3055c6de78415d37b56209a66c079e57">noLeaderUpdatesCounter</a> &gt;= <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a5873cf01d465c147622626e13bed7df1">LEADER_TIMEOUT_COUNTER_LIMIT</a>) </div>
<div class="line"><span class="lineno"> 2699</span>            {</div>
<div class="line"><span class="lineno"> 2700</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;noLeaderUpdatesCounter = &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3055c6de78415d37b56209a66c079e57">noLeaderUpdatesCounter</a> &lt;&lt; <span class="stringliteral">&quot; and change to leader state&quot;</span>);</div>
<div class="line"><span class="lineno"> 2701</span>                <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#af80fc61208f8a6e2efefdcfcc37ce980">changeFromFollowerToLeader</a>();</div>
<div class="line"><span class="lineno"> 2702</span>                <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> = <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa57f78e815f4fc2ac271a9fd85cd80ebc">PlatoonState::LEADER</a>;</div>
<div class="line"><span class="lineno"> 2703</span>                <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3055c6de78415d37b56209a66c079e57">noLeaderUpdatesCounter</a> = 0;</div>
<div class="line"><span class="lineno"> 2704</span>            }</div>
<div class="line"><span class="lineno"> 2705</span>        }</div>
<div class="line"><span class="lineno"> 2706</span>        <span class="keywordflow">else</span> </div>
<div class="line"><span class="lineno"> 2707</span>        {</div>
<div class="line"><span class="lineno"> 2708</span>            <span class="comment">// reset counter to zero when we get updates again</span></div>
<div class="line"><span class="lineno"> 2709</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3055c6de78415d37b56209a66c079e57">noLeaderUpdatesCounter</a> = 0;</div>
<div class="line"><span class="lineno"> 2710</span>        }</div>
<div class="line"><span class="lineno"> 2711</span>        <span class="keywordtype">long</span> tsEnd = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a283186f2bbb98f5f85b5486e365bb4b8">timer_factory_</a>-&gt;now().nanoseconds() / 1000000;</div>
<div class="line"><span class="lineno"> 2712</span>        <span class="keywordtype">long</span> sleepDuration = std::max((<a class="code hl_typedef" href="stdint_8h.html#ab1967d8591af1a4e48c37fd2b0f184d0">int32_t</a>)(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae54ec36efc19b9c2edc90148ac10b4e0">statusMessageInterval_</a> - (tsEnd - tsStart)), 0);</div>
<div class="line"><span class="lineno"> 2713</span>        <span class="comment">// TODO this solution is not sim-time complient and should be replaced with one which is when possible</span></div>
<div class="line"><span class="lineno"> 2714</span>        <span class="comment">// https://github.com/usdot-fhwa-stol/carma-platform/issues/1888</span></div>
<div class="line"><span class="lineno"> 2715</span>        std::this_thread::sleep_for(std::chrono::milliseconds(sleepDuration));</div>
<div class="line"><span class="lineno"> 2716</span> </div>
<div class="line"><span class="lineno"> 2717</span>        <span class="comment">// Job 3: Dissoleve request. </span></div>
<div class="line"><span class="lineno"> 2718</span>        <span class="comment">//TODO: set departure indicator </span></div>
<div class="line"><span class="lineno"> 2719</span> </div>
<div class="line"><span class="lineno"> 2720</span>    }</div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_af80fc61208f8a6e2efefdcfcc37ce980"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#af80fc61208f8a6e2efefdcfcc37ce980">platoon_strategic_ihp::PlatoonManager::changeFromFollowerToLeader</a></div><div class="ttdeci">void changeFromFollowerToLeader()</div><div class="ttdoc">Update status when state change from Follower to Leader.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00672">platoon_manager_ihp.cpp:672</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a3055c6de78415d37b56209a66c079e57"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3055c6de78415d37b56209a66c079e57">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::noLeaderUpdatesCounter</a></div><div class="ttdeci">int noLeaderUpdatesCounter</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8h_source.html#l00796">platoon_strategic_ihp.h:796</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a3a80cbd904887d9fa98448f76fba7993"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3a80cbd904887d9fa98448f76fba7993">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::composeMobilityOperationFollower</a></div><div class="ttdeci">carma_v2x_msgs::msg::MobilityOperation composeMobilityOperationFollower()</div><div class="ttdoc">Function to compose mobility operation in follower state.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l00583">platoon_strategic_ihp.cpp:583</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a5873cf01d465c147622626e13bed7df1"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a5873cf01d465c147622626e13bed7df1">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::LEADER_TIMEOUT_COUNTER_LIMIT</a></div><div class="ttdeci">int LEADER_TIMEOUT_COUNTER_LIMIT</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8h_source.html#l00797">platoon_strategic_ihp.h:797</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__manager__ihp_8cpp_source.html#l00672">platoon_strategic_ihp::PlatoonManager::changeFromFollowerToLeader()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00583">composeMobilityOperationFollower()</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00370">platoon_strategic_ihp::PlatoonManager::current_platoon_state</a>, <a class="el" href="platoon__manager__ihp_8cpp_source.html#l00723">platoon_strategic_ihp::PlatoonManager::getNumberOfVehicleInFront()</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00080">platoon_strategic_ihp::LEADER</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00797">LEADER_TIMEOUT_COUNTER_LIMIT</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00310">mobility_operation_publisher_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00796">noLeaderUpdatesCounter</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00817">pm_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00793">statusMessageInterval_</a>, and <a class="el" href="platoon__strategic__ihp_8h_source.html#l00814">timer_factory_</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l03060">onSpin()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a3e9dbfe57693b6d23d99b61af6375a4f_cgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a3e9dbfe57693b6d23d99b61af6375a4f_cgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a3e9dbfe57693b6d23d99b61af6375a4f_cgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a3e9dbfe57693b6d23d99b61af6375a4f_cgraph">
<area shape="rect" title="Run Follower State." alt="" coords="5,85,188,141"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#af80fc61208f8a6e2efefdcfcc37ce980" title="Update status when state change from Follower to Leader." alt="" coords="251,5,451,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3a80cbd904887d9fa98448f76fba7993" title="Function to compose mobility operation in follower state." alt="" coords="236,85,467,141"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a1de160740f47d9b0198e42dcbe67a6fe" title="Get number of vehicles in front of host vehicle inside platoon." alt="" coords="255,165,447,221"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aabe87e2046da048da999758ebdd119fe" title="Function to compose mobility operation message with STATUS params." alt="" coords="515,85,749,141"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a3e9dbfe57693b6d23d99b61af6375a4f_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a3e9dbfe57693b6d23d99b61af6375a4f_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a3e9dbfe57693b6d23d99b61af6375a4f_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a3e9dbfe57693b6d23d99b61af6375a4f_icgraph">
<area shape="rect" title="Run Follower State." alt="" coords="429,5,612,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ac7e7160659b61a4ac61be14f74fb1caa" title="Spin callback function." alt="" coords="199,5,381,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,5,151,61"/>
</map>
</div>

</div>
</div>
<a id="ac28094ea4b6d85949859226c860d8bd6" name="ac28094ea4b6d85949859226c860d8bd6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac28094ea4b6d85949859226c860d8bd6">&#9670;&nbsp;</a></span>run_lead_with_operation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void platoon_strategic_ihp::PlatoonStrategicIHPPlugin::run_lead_with_operation </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>UCLA Run lead with operation State. </p>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02945">2945</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2946</span>    {</div>
<div class="line"><span class="lineno"> 2947</span>        <span class="keywordtype">long</span> tsStart = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a283186f2bbb98f5f85b5486e365bb4b8">timer_factory_</a>-&gt;now().nanoseconds() / 1000000;</div>
<div class="line"><span class="lineno"> 2948</span>        <span class="comment">// Task 1: heart beat timeout: constantly send INFO mob_op</span></div>
<div class="line"><span class="lineno"> 2949</span>        <span class="keywordtype">bool</span> isTimeForHeartBeat = tsStart - <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#abe7bd4e91b67d8079a51dc180bd8e5eb">prevHeartBeatTime_</a> &gt;= <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#af12e6e347833e62db64c99229643d23e">infoMessageInterval_</a>;</div>
<div class="line"><span class="lineno"> 2950</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;time since last heart beat: &quot;</span> &lt;&lt; tsStart - <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#abe7bd4e91b67d8079a51dc180bd8e5eb">prevHeartBeatTime_</a>);</div>
<div class="line"><span class="lineno"> 2951</span>        <span class="keywordflow">if</span> (isTimeForHeartBeat) </div>
<div class="line"><span class="lineno"> 2952</span>        {</div>
<div class="line"><span class="lineno"> 2953</span>            carma_v2x_msgs::msg::MobilityOperation infoOperation;</div>
<div class="line"><span class="lineno"> 2954</span>            infoOperation = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2b54d8a43eb72f0c439860b5b5793302">composeMobilityOperationLeadWithOperation</a>(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a56907ad89ed257fc81cbb7faf4221005">OPERATION_INFO_TYPE</a>);</div>
<div class="line"><span class="lineno"> 2955</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a19ea827fa9a96b9154f33d364d89260e">mobility_operation_publisher_</a>(infoOperation);</div>
<div class="line"><span class="lineno"> 2956</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#abe7bd4e91b67d8079a51dc180bd8e5eb">prevHeartBeatTime_</a> = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a283186f2bbb98f5f85b5486e365bb4b8">timer_factory_</a>-&gt;now().nanoseconds() / 1000000;</div>
<div class="line"><span class="lineno"> 2957</span>        }</div>
<div class="line"><span class="lineno"> 2958</span> </div>
<div class="line"><span class="lineno"> 2959</span> </div>
<div class="line"><span class="lineno"> 2960</span>        <span class="comment">// Task 4: STATUS msgs</span></div>
<div class="line"><span class="lineno"> 2961</span>        <span class="keywordtype">bool</span> hasFollower = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a3ef30eeb7a7cf0caccb948e6a41f92">getHostPlatoonSize</a>() &gt; 1  ||  <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a0d4c58751beb06ca6bcdd80c3532be18">test_cutin_join</a>;</div>
<div class="line"><span class="lineno"> 2962</span>        <span class="comment">// if has follower, publish platoon message as STATUS mob_op</span></div>
<div class="line"><span class="lineno"> 2963</span>        <span class="keywordflow">if</span> (hasFollower) </div>
<div class="line"><span class="lineno"> 2964</span>        {</div>
<div class="line"><span class="lineno"> 2965</span>            carma_v2x_msgs::msg::MobilityOperation statusOperation;</div>
<div class="line"><span class="lineno"> 2966</span>            statusOperation = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2b54d8a43eb72f0c439860b5b5793302">composeMobilityOperationLeadWithOperation</a>(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a243c9d3b652447765feab04517074520">OPERATION_STATUS_TYPE</a>);</div>
<div class="line"><span class="lineno"> 2967</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a19ea827fa9a96b9154f33d364d89260e">mobility_operation_publisher_</a>(statusOperation);</div>
<div class="line"><span class="lineno"> 2968</span>        }</div>
<div class="line"><span class="lineno"> 2969</span>        <span class="keywordtype">long</span> tsEnd = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a283186f2bbb98f5f85b5486e365bb4b8">timer_factory_</a>-&gt;now().nanoseconds() / 1000000;</div>
<div class="line"><span class="lineno"> 2970</span>        <span class="keywordtype">long</span> sleepDuration = std::max((<a class="code hl_typedef" href="stdint_8h.html#ab1967d8591af1a4e48c37fd2b0f184d0">int32_t</a>)(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae54ec36efc19b9c2edc90148ac10b4e0">statusMessageInterval_</a> - (tsEnd - tsStart)), 0);</div>
<div class="line"><span class="lineno"> 2971</span>        <span class="comment">// TODO this solution is not sim-time complient and should be replaced with one which is when possible</span></div>
<div class="line"><span class="lineno"> 2972</span>        <span class="comment">// https://github.com/usdot-fhwa-stol/carma-platform/issues/1888</span></div>
<div class="line"><span class="lineno"> 2973</span>        std::this_thread::sleep_for(std::chrono::milliseconds(sleepDuration));</div>
<div class="line"><span class="lineno"> 2974</span>    }</div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a2b54d8a43eb72f0c439860b5b5793302"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2b54d8a43eb72f0c439860b5b5793302">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::composeMobilityOperationLeadWithOperation</a></div><div class="ttdeci">carma_v2x_msgs::msg::MobilityOperation composeMobilityOperationLeadWithOperation(const std::string &amp;type)</div><div class="ttdoc">Function to compose mobility operation in LeadWithOperation (cut-in join)</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l00646">platoon_strategic_ihp.cpp:646</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_abe7bd4e91b67d8079a51dc180bd8e5eb"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#abe7bd4e91b67d8079a51dc180bd8e5eb">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::prevHeartBeatTime_</a></div><div class="ttdeci">unsigned long prevHeartBeatTime_</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8h_source.html#l00792">platoon_strategic_ihp.h:792</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_af12e6e347833e62db64c99229643d23e"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#af12e6e347833e62db64c99229643d23e">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::infoMessageInterval_</a></div><div class="ttdeci">unsigned long infoMessageInterval_</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8h_source.html#l00791">platoon_strategic_ihp.h:791</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00646">composeMobilityOperationLeadWithOperation()</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00318">config_</a>, <a class="el" href="platoon__manager__ihp_8cpp_source.html#l00279">platoon_strategic_ihp::PlatoonManager::getHostPlatoonSize()</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00791">infoMessageInterval_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00310">mobility_operation_publisher_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00821">OPERATION_INFO_TYPE</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00822">OPERATION_STATUS_TYPE</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00817">pm_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00792">prevHeartBeatTime_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00793">statusMessageInterval_</a>, <a class="el" href="platoon__config__ihp_8h_source.html#l00086">platoon_strategic_ihp::PlatoonPluginConfig::test_cutin_join</a>, and <a class="el" href="platoon__strategic__ihp_8h_source.html#l00814">timer_factory_</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l03060">onSpin()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ac28094ea4b6d85949859226c860d8bd6_cgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ac28094ea4b6d85949859226c860d8bd6_cgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ac28094ea4b6d85949859226c860d8bd6_cgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ac28094ea4b6d85949859226c860d8bd6_cgraph">
<area shape="rect" title="UCLA Run lead with operation State." alt="" coords="5,115,188,171"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2b54d8a43eb72f0c439860b5b5793302" title="Function to compose mobility operation in LeadWithOperation (cut&#45;in join)" alt="" coords="236,70,472,141"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a3ef30eeb7a7cf0caccb948e6a41f92" title="Returns total size of the platoon , in number of vehicles." alt="" coords="803,121,1045,162"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#abf34e8d8c0c18809bf551d3b04db81d4" title="Function to compose mobility operation message with INFO params." alt="" coords="531,5,744,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aabe87e2046da048da999758ebdd119fe" title="Function to compose mobility operation message with STATUS params." alt="" coords="520,85,755,141"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#af19d3e4a88f6875cf802442b183694a0" title="Returns overall length of the platoon. in m." alt="" coords="830,5,1018,61"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ac28094ea4b6d85949859226c860d8bd6_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ac28094ea4b6d85949859226c860d8bd6_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ac28094ea4b6d85949859226c860d8bd6_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_ac28094ea4b6d85949859226c860d8bd6_icgraph">
<area shape="rect" title="UCLA Run lead with operation State." alt="" coords="429,5,612,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ac7e7160659b61a4ac61be14f74fb1caa" title="Spin callback function." alt="" coords="199,5,381,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,5,151,61"/>
</map>
</div>

</div>
</div>
<a id="acf8506705dea8579268655c4fdeb4ddf" name="acf8506705dea8579268655c4fdeb4ddf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf8506705dea8579268655c4fdeb4ddf">&#9670;&nbsp;</a></span>run_leader()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void platoon_strategic_ihp::PlatoonStrategicIHPPlugin::run_leader </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Run Leader State. </p>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02622">2622</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2623</span>    {</div>
<div class="line"><span class="lineno"> 2624</span>        <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> tsStart = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a283186f2bbb98f5f85b5486e365bb4b8">timer_factory_</a>-&gt;now().nanoseconds() / 1000000;</div>
<div class="line"><span class="lineno"> 2625</span> </div>
<div class="line"><span class="lineno"> 2626</span>        <span class="comment">// If vehicle is not rolling then return</span></div>
<div class="line"><span class="lineno"> 2627</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3e827c7f2e764c6e7de83f0a81a9593f">current_speed_</a> &lt;= <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae53ddfbfa903ffe85722c9471cdfd3af">STOPPED_SPEED</a>)</div>
<div class="line"><span class="lineno"> 2628</span>        {</div>
<div class="line"><span class="lineno"> 2629</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 2630</span>        }</div>
<div class="line"><span class="lineno"> 2631</span> </div>
<div class="line"><span class="lineno"> 2632</span>        <span class="comment">// Task 1: heart beat timeout: send INFO mob_op</span></div>
<div class="line"><span class="lineno"> 2633</span>        <span class="keywordtype">bool</span> isTimeForHeartBeat = tsStart - <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#abe7bd4e91b67d8079a51dc180bd8e5eb">prevHeartBeatTime_</a> &gt;= <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#af12e6e347833e62db64c99229643d23e">infoMessageInterval_</a>;</div>
<div class="line"><span class="lineno"> 2634</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;time since last heart beat: &quot;</span> &lt;&lt; tsStart - <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#abe7bd4e91b67d8079a51dc180bd8e5eb">prevHeartBeatTime_</a>);</div>
<div class="line"><span class="lineno"> 2635</span>        <span class="keywordflow">if</span> (isTimeForHeartBeat) </div>
<div class="line"><span class="lineno"> 2636</span>        {</div>
<div class="line"><span class="lineno"> 2637</span>            carma_v2x_msgs::msg::MobilityOperation infoOperation;</div>
<div class="line"><span class="lineno"> 2638</span>            infoOperation = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#afc01cfaa2979666119dff63ee09c05a6">composeMobilityOperationLeader</a>(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a56907ad89ed257fc81cbb7faf4221005">OPERATION_INFO_TYPE</a>);</div>
<div class="line"><span class="lineno"> 2639</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a19ea827fa9a96b9154f33d364d89260e">mobility_operation_publisher_</a>(infoOperation);</div>
<div class="line"><span class="lineno"> 2640</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#abe7bd4e91b67d8079a51dc180bd8e5eb">prevHeartBeatTime_</a> = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a283186f2bbb98f5f85b5486e365bb4b8">timer_factory_</a>-&gt;now().nanoseconds() / 1000000;</div>
<div class="line"><span class="lineno"> 2641</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Published heart beat platoon INFO mobility operation message&quot;</span>);</div>
<div class="line"><span class="lineno"> 2642</span>        }</div>
<div class="line"><span class="lineno"> 2643</span> </div>
<div class="line"><span class="lineno"> 2644</span>        <span class="comment">// Task 3: plan time out, check if any current join plan is still valid (i.e., not timed out).</span></div>
<div class="line"><span class="lineno"> 2645</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a9474313cd68557978e8dbd481d0408bc">valid</a>)</div>
<div class="line"><span class="lineno"> 2646</span>        {</div>
<div class="line"><span class="lineno"> 2647</span>            <span class="keywordtype">bool</span> isCurrentPlanTimeout = tsStart - <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a4b43d9a607f76a48b4023fbd9dd3e3e3">planStartTime</a> &gt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aef3664c4c7ac360846defce18161e92b">NEGOTIATION_TIMEOUT</a>;</div>
<div class="line"><span class="lineno"> 2648</span>            <span class="keywordflow">if</span> (isCurrentPlanTimeout)</div>
<div class="line"><span class="lineno"> 2649</span>            {</div>
<div class="line"><span class="lineno"> 2650</span>                RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Give up current on waiting plan with planId: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a34c7e7384914852c5549e8d2a14dc6e9">planId</a>);</div>
<div class="line"><span class="lineno"> 2651</span>                <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#af2f0d9818d07db4a4df484f988635201">clearActionPlan</a>();</div>
<div class="line"><span class="lineno"> 2652</span>            }</div>
<div class="line"><span class="lineno"> 2653</span>        }</div>
<div class="line"><span class="lineno"> 2654</span> </div>
<div class="line"><span class="lineno"> 2655</span>        <span class="comment">// Task 4: STATUS msgs</span></div>
<div class="line"><span class="lineno"> 2656</span>        <span class="keywordtype">bool</span> hasFollower = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a3ef30eeb7a7cf0caccb948e6a41f92">getHostPlatoonSize</a>() &gt; 1  ||  <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a0d4c58751beb06ca6bcdd80c3532be18">test_cutin_join</a>;</div>
<div class="line"><span class="lineno"> 2657</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;hasFollower&quot;</span> &lt;&lt; hasFollower);</div>
<div class="line"><span class="lineno"> 2658</span>        <span class="comment">// if has follower, publish platoon message as STATUS mob_op</span></div>
<div class="line"><span class="lineno"> 2659</span>        <span class="keywordflow">if</span> (hasFollower)</div>
<div class="line"><span class="lineno"> 2660</span>        {</div>
<div class="line"><span class="lineno"> 2661</span>            carma_v2x_msgs::msg::MobilityOperation statusOperation;</div>
<div class="line"><span class="lineno"> 2662</span>            statusOperation = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#afc01cfaa2979666119dff63ee09c05a6">composeMobilityOperationLeader</a>(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a243c9d3b652447765feab04517074520">OPERATION_STATUS_TYPE</a>);</div>
<div class="line"><span class="lineno"> 2663</span>            <span class="comment">// mob_op_pub_.publish(statusOperation);</span></div>
<div class="line"><span class="lineno"> 2664</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a19ea827fa9a96b9154f33d364d89260e">mobility_operation_publisher_</a>(statusOperation);</div>
<div class="line"><span class="lineno"> 2665</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Published platoon STATUS operation message as a Leader with Follower&quot;</span>);</div>
<div class="line"><span class="lineno"> 2666</span>        }</div>
<div class="line"><span class="lineno"> 2667</span> </div>
<div class="line"><span class="lineno"> 2668</span>        <span class="keywordtype">long</span> tsEnd = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a283186f2bbb98f5f85b5486e365bb4b8">timer_factory_</a>-&gt;now().nanoseconds() / 1000000;</div>
<div class="line"><span class="lineno"> 2669</span>        <span class="keywordtype">long</span> sleepDuration = std::max((<a class="code hl_typedef" href="stdint_8h.html#ab1967d8591af1a4e48c37fd2b0f184d0">int32_t</a>)(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae54ec36efc19b9c2edc90148ac10b4e0">statusMessageInterval_</a> - (tsEnd - tsStart)), 0);</div>
<div class="line"><span class="lineno"> 2670</span>        <span class="comment">// TODO this solution is not sim-time complient and should be replaced with one which is when possible</span></div>
<div class="line"><span class="lineno"> 2671</span>        <span class="comment">// https://github.com/usdot-fhwa-stol/carma-platform/issues/1888</span></div>
<div class="line"><span class="lineno"> 2672</span>        std::this_thread::sleep_for(std::chrono::milliseconds(sleepDuration));</div>
<div class="line"><span class="lineno"> 2673</span> </div>
<div class="line"><span class="lineno"> 2674</span>        <span class="comment">// Job 5: Dissoleve request. </span></div>
<div class="line"><span class="lineno"> 2675</span>        <span class="comment">// TODO: Place holder for departure. Need to change to departing state and tracking departng ID.</span></div>
<div class="line"><span class="lineno"> 2676</span> </div>
<div class="line"><span class="lineno"> 2677</span>    }</div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_afc01cfaa2979666119dff63ee09c05a6"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#afc01cfaa2979666119dff63ee09c05a6">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::composeMobilityOperationLeader</a></div><div class="ttdeci">carma_v2x_msgs::msg::MobilityOperation composeMobilityOperationLeader(const std::string &amp;type)</div><div class="ttdoc">Function to compose mobility operation in leader state.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l00558">platoon_strategic_ihp.cpp:558</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__manager__ihp_8cpp_source.html#l00285">platoon_strategic_ihp::PlatoonManager::clearActionPlan()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00558">composeMobilityOperationLeader()</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00318">config_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00376">platoon_strategic_ihp::PlatoonManager::current_plan</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00328">current_speed_</a>, <a class="el" href="platoon__manager__ihp_8cpp_source.html#l00279">platoon_strategic_ihp::PlatoonManager::getHostPlatoonSize()</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00791">infoMessageInterval_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00310">mobility_operation_publisher_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00794">NEGOTIATION_TIMEOUT</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00821">OPERATION_INFO_TYPE</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00822">OPERATION_STATUS_TYPE</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00049">platoon_strategic_ihp::ActionPlan::planId</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00048">platoon_strategic_ihp::ActionPlan::planStartTime</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00817">pm_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00792">prevHeartBeatTime_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00793">statusMessageInterval_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00805">STOPPED_SPEED</a>, <a class="el" href="platoon__config__ihp_8h_source.html#l00086">platoon_strategic_ihp::PlatoonPluginConfig::test_cutin_join</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00814">timer_factory_</a>, and <a class="el" href="platoon__manager__ihp_8h_source.html#l00047">platoon_strategic_ihp::ActionPlan::valid</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l03060">onSpin()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_acf8506705dea8579268655c4fdeb4ddf_cgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_acf8506705dea8579268655c4fdeb4ddf_cgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_acf8506705dea8579268655c4fdeb4ddf_cgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_acf8506705dea8579268655c4fdeb4ddf_cgraph">
<area shape="rect" title="Run Leader State." alt="" coords="5,85,188,141"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#af2f0d9818d07db4a4df484f988635201" title="Resets necessary variables to indicate that the current ActionPlan is dead." alt="" coords="237,21,456,62"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#afc01cfaa2979666119dff63ee09c05a6" title="Function to compose mobility operation in leader state." alt="" coords="236,85,457,141"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a3ef30eeb7a7cf0caccb948e6a41f92" title="Returns total size of the platoon , in number of vehicles." alt="" coords="788,121,1031,162"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#abf34e8d8c0c18809bf551d3b04db81d4" title="Function to compose mobility operation message with INFO params." alt="" coords="516,5,729,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aabe87e2046da048da999758ebdd119fe" title="Function to compose mobility operation message with STATUS params." alt="" coords="505,85,740,141"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#af19d3e4a88f6875cf802442b183694a0" title="Returns overall length of the platoon. in m." alt="" coords="815,5,1003,61"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_acf8506705dea8579268655c4fdeb4ddf_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_acf8506705dea8579268655c4fdeb4ddf_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_acf8506705dea8579268655c4fdeb4ddf_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_acf8506705dea8579268655c4fdeb4ddf_icgraph">
<area shape="rect" title="Run Leader State." alt="" coords="429,5,612,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ac7e7160659b61a4ac61be14f74fb1caa" title="Spin callback function." alt="" coords="199,5,381,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,5,151,61"/>
</map>
</div>

</div>
</div>
<a id="a848aac5dfc1f6a3c4fba8fa0bba0ca66" name="a848aac5dfc1f6a3c4fba8fa0bba0ca66"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a848aac5dfc1f6a3c4fba8fa0bba0ca66">&#9670;&nbsp;</a></span>run_leader_aborting()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void platoon_strategic_ihp::PlatoonStrategicIHPPlugin::run_leader_aborting </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Run Leader Aborting State. </p>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02822">2822</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2823</span>    {</div>
<div class="line"><span class="lineno"> 2824</span>        <span class="comment">/*  </span></div>
<div class="line"><span class="lineno"> 2825</span><span class="comment">            UCLA implementation note:</span></div>
<div class="line"><span class="lineno"> 2826</span><span class="comment">            1. this function  send step plan type: &quot;PLATOON_FRONT_JOIN&quot;</span></div>
<div class="line"><span class="lineno"> 2827</span><span class="comment">            2. the sender of the plan (host vehicle) is the previous leader, it wil prepare to follow front joiner (new leader)</span></div>
<div class="line"><span class="lineno"> 2828</span><span class="comment">        */</span></div>
<div class="line"><span class="lineno"> 2829</span>        <span class="keywordtype">long</span> tsStart = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a283186f2bbb98f5f85b5486e365bb4b8">timer_factory_</a>-&gt;now().nanoseconds() / 1000000;</div>
<div class="line"><span class="lineno"> 2830</span>        <span class="comment">// Task 1: state timeout</span></div>
<div class="line"><span class="lineno"> 2831</span>        <span class="keywordtype">bool</span> isCurrentStateTimeout = (tsStart - <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa30dd7c98fe60faad9ba8af0da2da581">candidatestateStartTime</a>) &gt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a5bb0123eb1a68e83b1a424eeb94f0929">waitingStateTimeout</a> * 1000;</div>
<div class="line"><span class="lineno"> 2832</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;timeout1: &quot;</span> &lt;&lt; tsStart - <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa30dd7c98fe60faad9ba8af0da2da581">candidatestateStartTime</a>);</div>
<div class="line"><span class="lineno"> 2833</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;waitingStateTimeout: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a5bb0123eb1a68e83b1a424eeb94f0929">waitingStateTimeout</a> * 1000);</div>
<div class="line"><span class="lineno"> 2834</span>        <span class="keywordflow">if</span> (isCurrentStateTimeout) </div>
<div class="line"><span class="lineno"> 2835</span>        {</div>
<div class="line"><span class="lineno"> 2836</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;The current leader aborting state is timeout. Change back to leader state.&quot;</span>);</div>
<div class="line"><span class="lineno"> 2837</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> = <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa57f78e815f4fc2ac271a9fd85cd80ebc">PlatoonState::LEADER</a>;</div>
<div class="line"><span class="lineno"> 2838</span> </div>
<div class="line"><span class="lineno"> 2839</span>            <span class="comment">//clear plan validity &amp; end; leave platoon info alone, as we may still be leading a valid platoon</span></div>
<div class="line"><span class="lineno"> 2840</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#af2f0d9818d07db4a4df484f988635201">clearActionPlan</a>();</div>
<div class="line"><span class="lineno"> 2841</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 2842</span>        }</div>
<div class="line"><span class="lineno"> 2843</span> </div>
<div class="line"><span class="lineno"> 2844</span>        <span class="comment">// Task 3: update plan: PLATOON_FRONT_JOIN with new gap</span></div>
<div class="line"><span class="lineno"> 2845</span>        <span class="keywordtype">double</span> desiredJoinGap2 = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a05ce3335d0638ae290bd3674b1499bc6">desiredJoinTimeGap</a> * <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3e827c7f2e764c6e7de83f0a81a9593f">current_speed_</a>;</div>
<div class="line"><span class="lineno"> 2846</span>        <span class="keywordtype">double</span> maxJoinGap = std::max(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#ab3b2aa9cfef500579859652c3aaffe43">desiredJoinGap</a>, desiredJoinGap2);</div>
<div class="line"><span class="lineno"> 2847</span> </div>
<div class="line"><span class="lineno"> 2848</span>        <span class="comment">// check if compatible for front join --&gt; return front gap, no veh type check, is compatible</span></div>
<div class="line"><span class="lineno"> 2849</span>        <span class="comment">// Note that pm_ only represents host&#39;s platoon members. As the aborting leader, the only vehicle</span></div>
<div class="line"><span class="lineno"> 2850</span>        <span class="comment">// preceding host is the candidate joiner. For this code to work, it depends on the candidate to publish</span></div>
<div class="line"><span class="lineno"> 2851</span>        <span class="comment">// mobility operation STATUS messages so that host can include it in the pm_ platoon membership.</span></div>
<div class="line"><span class="lineno"> 2852</span>        <span class="keywordtype">double</span> currentGap = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a472f726662a0702881c52b4da95bd457">getDistanceToPredVehicle</a>(); <span class="comment">//returns 0 if we haven&#39;t received op STATUS from joiner yet</span></div>
<div class="line"><span class="lineno"> 2853</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Based on desired join time gap, the desired join distance gap is &quot;</span> &lt;&lt; desiredJoinGap2 &lt;&lt; <span class="stringliteral">&quot; m&quot;</span>);</div>
<div class="line"><span class="lineno"> 2854</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Since we have max allowed gap as &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#ab3b2aa9cfef500579859652c3aaffe43">desiredJoinGap</a> &lt;&lt; <span class="stringliteral">&quot; m then max join gap became &quot;</span> &lt;&lt; maxJoinGap &lt;&lt; <span class="stringliteral">&quot; m&quot;</span>);</div>
<div class="line"><span class="lineno"> 2855</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;The current gap to joiner is &quot;</span> &lt;&lt; currentGap &lt;&lt; <span class="stringliteral">&quot; m&quot;</span>);</div>
<div class="line"><span class="lineno"> 2856</span> </div>
<div class="line"><span class="lineno"> 2857</span>        <span class="comment">// NOTE: The front join depends upon the joiner to publish op STATUS messages with this platoon&#39;s ID, then host receives at least one</span></div>
<div class="line"><span class="lineno"> 2858</span>        <span class="comment">// and thereby adds the joiner to the platoon record. This process requires host&#39;s mob_req_cb_leader() to ACK the join request, then </span></div>
<div class="line"><span class="lineno"> 2859</span>        <span class="comment">// the remote vehicle to handle that ACK and broadcast its first op STATUS, then host to receive and process it. All that has to happen</span></div>
<div class="line"><span class="lineno"> 2860</span>        <span class="comment">// before the below code block runs, even though this method starts to spin immediately after we send out the mentioned ACK. To avoid</span></div>
<div class="line"><span class="lineno"> 2861</span>        <span class="comment">// a race condition, we must wait a few cycles to ensure the 2-way messaging has completed. The race is that above calculation for</span></div>
<div class="line"><span class="lineno"> 2862</span>        <span class="comment">// current gap will be returned as 0 until we have received said STATUS message from the joiner, which would prematurely trigger the</span></div>
<div class="line"><span class="lineno"> 2863</span>        <span class="comment">// process to move forward.</span></div>
<div class="line"><span class="lineno"> 2864</span> </div>
<div class="line"><span class="lineno"> 2865</span>        <span class="comment">// Check if gap is big enough and if there is no currently active plan and this method has been called several times</span></div>
<div class="line"><span class="lineno"> 2866</span>        <span class="comment">// Add a condition to prevent sending repeated requests (Note: This is a same-lane maneuver, so no need to consider lower bound of joining gap.)</span></div>
<div class="line"><span class="lineno"> 2867</span>        ++<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a50637636926375340be2ba15d016b06a">numLeaderAbortingCalls_</a>;</div>
<div class="line"><span class="lineno"> 2868</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;numLeaderAbortingCalls = &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a50637636926375340be2ba15d016b06a">numLeaderAbortingCalls_</a> &lt;&lt; <span class="stringliteral">&quot;, max = &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a3df70183927833802c8686f228070e01">maxLeaderAbortingCalls</a>);</div>
<div class="line"><span class="lineno"> 2869</span>        <span class="keywordflow">if</span> (currentGap &lt;= maxJoinGap  &amp;&amp;  !pm_.current_plan.valid  &amp;&amp;  numLeaderAbortingCalls_ &gt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a3df70183927833802c8686f228070e01">maxLeaderAbortingCalls</a>) </div>
<div class="line"><span class="lineno"> 2870</span>        {</div>
<div class="line"><span class="lineno"> 2871</span>            <span class="comment">// compose frontal joining plan, senderID is the old leader </span></div>
<div class="line"><span class="lineno"> 2872</span>            carma_v2x_msgs::msg::MobilityRequest request;</div>
<div class="line"><span class="lineno"> 2873</span>            std::string planId = boost::uuids::to_string(boost::uuids::random_generator()());</div>
<div class="line"><span class="lineno"> 2874</span>            <span class="keywordtype">long</span> currentTime = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a283186f2bbb98f5f85b5486e365bb4b8">timer_factory_</a>-&gt;now().nanoseconds() / 1000000;</div>
<div class="line"><span class="lineno"> 2875</span>            request.m_header.plan_id = planId;</div>
<div class="line"><span class="lineno"> 2876</span>            request.m_header.recipient_id = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a05732c5f9b2d8f5d2c66d1cdcf793854">platoonLeaderID</a>; <span class="comment">//the new joiner</span></div>
<div class="line"><span class="lineno"> 2877</span>            request.m_header.sender_id = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a473bcce97d7c50beaab678372a354c0d">vehicleID</a>;</div>
<div class="line"><span class="lineno"> 2878</span>            request.m_header.timestamp = currentTime;</div>
<div class="line"><span class="lineno"> 2879</span> </div>
<div class="line"><span class="lineno"> 2880</span>            <span class="keywordtype">int</span> platoon_size = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a3ef30eeb7a7cf0caccb948e6a41f92">getHostPlatoonSize</a>(); <span class="comment">//depends on joiner to send op STATUS messages while joining</span></div>
<div class="line"><span class="lineno"> 2881</span>            </div>
<div class="line"><span class="lineno"> 2882</span>            boost::format fmter(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aca973fa2125f768cffaf33812403f45c">JOIN_PARAMS</a>); <span class="comment">// Note: Front and rear join uses same params, hence merge to one param for both condition.</span></div>
<div class="line"><span class="lineno"> 2883</span>            <span class="keywordtype">int</span> dummy_join_index = -2; <span class="comment">//leader aborting doesn&#39;t need join_index so use default value</span></div>
<div class="line"><span class="lineno"> 2884</span>            fmter %platoon_size;                <span class="comment">//  index = 0</span></div>
<div class="line"><span class="lineno"> 2885</span>            fmter %<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3e827c7f2e764c6e7de83f0a81a9593f">current_speed_</a>;              <span class="comment">//  index = 1, in m/s</span></div>
<div class="line"><span class="lineno"> 2886</span>            fmter %<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ad10e1df213ec7524892b247d28ec9172">pose_ecef_point_</a>.ecef_x;     <span class="comment">//  index = 2</span></div>
<div class="line"><span class="lineno"> 2887</span>            fmter %<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ad10e1df213ec7524892b247d28ec9172">pose_ecef_point_</a>.ecef_y;     <span class="comment">//  index = 3</span></div>
<div class="line"><span class="lineno"> 2888</span>            fmter %<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ad10e1df213ec7524892b247d28ec9172">pose_ecef_point_</a>.ecef_z;     <span class="comment">//  index = 4   </span></div>
<div class="line"><span class="lineno"> 2889</span>            fmter %dummy_join_index;            <span class="comment">//  index = 5</span></div>
<div class="line"><span class="lineno"> 2890</span>            request.strategy_params = fmter.str();</div>
<div class="line"><span class="lineno"> 2891</span> </div>
<div class="line"><span class="lineno"> 2892</span>            <span class="comment">// assign a new plan type </span></div>
<div class="line"><span class="lineno"> 2893</span>            request.plan_type.type = carma_v2x_msgs::msg::PlanType::PLATOON_FRONT_JOIN;</div>
<div class="line"><span class="lineno"> 2894</span>            request.strategy = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3be0b52376b568130c1c6a5ec5adeb13">PLATOONING_STRATEGY</a>;</div>
<div class="line"><span class="lineno"> 2895</span>            request.urgency = 50;</div>
<div class="line"><span class="lineno"> 2896</span>            request.location = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a11ffedaaa90fe358ecfdccab7c5a428c">pose_to_ecef</a>(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa67d1b97f198e2f088fb24ffb8e0c690">pose_msg_</a>);</div>
<div class="line"><span class="lineno"> 2897</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae4e916260ddb6f7eb25da13ef9cb158e">mobility_request_publisher_</a>(request);</div>
<div class="line"><span class="lineno"> 2898</span>            RCLCPP_WARN(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>),<span class="stringliteral">&quot;Published Mobility Candidate-Join request to the new leader&quot;</span>);</div>
<div class="line"><span class="lineno"> 2899</span> </div>
<div class="line"><span class="lineno"> 2900</span>            <span class="comment">// Create a new join action plan</span></div>
<div class="line"><span class="lineno"> 2901</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a> = ActionPlan(<span class="keyword">true</span>, currentTime, planId, <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a05732c5f9b2d8f5d2c66d1cdcf793854">platoonLeaderID</a>);</div>
<div class="line"><span class="lineno"> 2902</span>        }</div>
<div class="line"><span class="lineno"> 2903</span> </div>
<div class="line"><span class="lineno"> 2904</span>        <span class="comment">//Task 4: publish platoon status message</span></div>
<div class="line"><span class="lineno"> 2905</span>        carma_v2x_msgs::msg::MobilityOperation status;</div>
<div class="line"><span class="lineno"> 2906</span>        status = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a20c23f25255a2e259d5ee9a4f68b722c">composeMobilityOperationLeaderAborting</a>();</div>
<div class="line"><span class="lineno"> 2907</span>        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a19ea827fa9a96b9154f33d364d89260e">mobility_operation_publisher_</a>(status);</div>
<div class="line"><span class="lineno"> 2908</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Published platoon STATUS operation message&quot;</span>);</div>
<div class="line"><span class="lineno"> 2909</span> </div>
<div class="line"><span class="lineno"> 2910</span>        <span class="keywordtype">long</span> tsEnd = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a283186f2bbb98f5f85b5486e365bb4b8">timer_factory_</a>-&gt;now().nanoseconds() / 1000000;</div>
<div class="line"><span class="lineno"> 2911</span>        <span class="keywordtype">long</span> sleepDuration = std::max((<a class="code hl_typedef" href="stdint_8h.html#ab1967d8591af1a4e48c37fd2b0f184d0">int32_t</a>)(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae54ec36efc19b9c2edc90148ac10b4e0">statusMessageInterval_</a> - (tsEnd - tsStart)), 0);</div>
<div class="line"><span class="lineno"> 2912</span>        <span class="comment">// TODO this solution is not sim-time complient and should be replaced with one which is when possible</span></div>
<div class="line"><span class="lineno"> 2913</span>        <span class="comment">// https://github.com/usdot-fhwa-stol/carma-platform/issues/1888</span></div>
<div class="line"><span class="lineno"> 2914</span>        std::this_thread::sleep_for(std::chrono::milliseconds(sleepDuration));</div>
<div class="line"><span class="lineno"> 2915</span>    }</div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a20c23f25255a2e259d5ee9a4f68b722c"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a20c23f25255a2e259d5ee9a4f68b722c">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::composeMobilityOperationLeaderAborting</a></div><div class="ttdeci">carma_v2x_msgs::msg::MobilityOperation composeMobilityOperationLeaderAborting()</div><div class="ttdoc">Function to compose mobility operation in LeaderAborting state.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l00609">platoon_strategic_ihp.cpp:609</a></div></div>
<div class="ttc" id="astructplatoon__strategic__ihp_1_1PlatoonPluginConfig_html_a3df70183927833802c8686f228070e01"><div class="ttname"><a href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a3df70183927833802c8686f228070e01">platoon_strategic_ihp::PlatoonPluginConfig::maxLeaderAbortingCalls</a></div><div class="ttdeci">int maxLeaderAbortingCalls</div><div class="ttdef"><b>Definition:</b> <a href="platoon__config__ihp_8h_source.html#l00049">platoon_config_ihp.h:49</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__strategic__ihp_8h_source.html#l00336">candidatestateStartTime</a>, <a class="el" href="platoon__manager__ihp_8cpp_source.html#l00285">platoon_strategic_ihp::PlatoonManager::clearActionPlan()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00609">composeMobilityOperationLeaderAborting()</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00318">config_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00376">platoon_strategic_ihp::PlatoonManager::current_plan</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00370">platoon_strategic_ihp::PlatoonManager::current_platoon_state</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00328">current_speed_</a>, <a class="el" href="platoon__config__ihp_8h_source.html#l00048">platoon_strategic_ihp::PlatoonPluginConfig::desiredJoinGap</a>, <a class="el" href="platoon__config__ihp_8h_source.html#l00047">platoon_strategic_ihp::PlatoonPluginConfig::desiredJoinTimeGap</a>, <a class="el" href="platoon__manager__ihp_8cpp_source.html#l00728">platoon_strategic_ihp::PlatoonManager::getDistanceToPredVehicle()</a>, <a class="el" href="platoon__manager__ihp_8cpp_source.html#l00279">platoon_strategic_ihp::PlatoonManager::getHostPlatoonSize()</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00858">JOIN_PARAMS</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00080">platoon_strategic_ihp::LEADER</a>, <a class="el" href="platoon__config__ihp_8h_source.html#l00049">platoon_strategic_ihp::PlatoonPluginConfig::maxLeaderAbortingCalls</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00310">mobility_operation_publisher_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00308">mobility_request_publisher_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00782">numLeaderAbortingCalls_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00820">PLATOONING_STRATEGY</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00367">platoon_strategic_ihp::PlatoonManager::platoonLeaderID</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00817">pm_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00257">pose_ecef_point_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00322">pose_msg_</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00064">pose_to_ecef()</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00793">statusMessageInterval_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00814">timer_factory_</a>, <a class="el" href="platoon__config__ihp_8h_source.html#l00068">platoon_strategic_ihp::PlatoonPluginConfig::vehicleID</a>, and <a class="el" href="platoon__strategic__ihp_8h_source.html#l00798">waitingStateTimeout</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l03060">onSpin()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a848aac5dfc1f6a3c4fba8fa0bba0ca66_cgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a848aac5dfc1f6a3c4fba8fa0bba0ca66_cgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a848aac5dfc1f6a3c4fba8fa0bba0ca66_cgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a848aac5dfc1f6a3c4fba8fa0bba0ca66_cgraph">
<area shape="rect" title="Run Leader Aborting State." alt="" coords="5,166,188,222"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#af2f0d9818d07db4a4df484f988635201" title="Resets necessary variables to indicate that the current ActionPlan is dead." alt="" coords="248,5,467,47"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a20c23f25255a2e259d5ee9a4f68b722c" title="Function to compose mobility operation in LeaderAborting state." alt="" coords="247,71,468,141"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a472f726662a0702881c52b4da95bd457" title="Returns distance to the predessecor vehicle, in m." alt="" coords="259,166,456,222"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a3ef30eeb7a7cf0caccb948e6a41f92" title="Returns total size of the platoon , in number of vehicles." alt="" coords="236,245,479,287"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a11ffedaaa90fe358ecfdccab7c5a428c" title="Function to convert pose from map frame to ecef location." alt="" coords="266,310,449,366"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aabe87e2046da048da999758ebdd119fe" title="Function to compose mobility operation message with STATUS params." alt="" coords="527,78,761,134"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a848aac5dfc1f6a3c4fba8fa0bba0ca66_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a848aac5dfc1f6a3c4fba8fa0bba0ca66_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a848aac5dfc1f6a3c4fba8fa0bba0ca66_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a848aac5dfc1f6a3c4fba8fa0bba0ca66_icgraph">
<area shape="rect" title="Run Leader Aborting State." alt="" coords="429,5,612,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ac7e7160659b61a4ac61be14f74fb1caa" title="Spin callback function." alt="" coords="199,5,381,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,5,151,61"/>
</map>
</div>

</div>
</div>
<a id="a7bcebb0d98ab80013c945a2ec283250e" name="a7bcebb0d98ab80013c945a2ec283250e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7bcebb0d98ab80013c945a2ec283250e">&#9670;&nbsp;</a></span>run_leader_waiting()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void platoon_strategic_ihp::PlatoonStrategicIHPPlugin::run_leader_waiting </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Run Leader Waiting State. </p>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02597">2597</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2598</span>    {</div>
<div class="line"><span class="lineno"> 2599</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Run LeaderWaiting State &quot;</span>);</div>
<div class="line"><span class="lineno"> 2600</span>        <span class="keywordtype">long</span> tsStart = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a283186f2bbb98f5f85b5486e365bb4b8">timer_factory_</a>-&gt;now().nanoseconds() / 1000000;</div>
<div class="line"><span class="lineno"> 2601</span>        <span class="comment">// Task 1</span></div>
<div class="line"><span class="lineno"> 2602</span>        <span class="keywordflow">if</span> (tsStart - <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a935cc1406e4a80f9f44669167e43f815">waitingStartTime</a> &gt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a5bb0123eb1a68e83b1a424eeb94f0929">waitingStateTimeout</a> * 1000)</div>
<div class="line"><span class="lineno"> 2603</span>        {</div>
<div class="line"><span class="lineno"> 2604</span>            <span class="comment">//TODO if the current state timeouts, we need to have a kind of ABORT message to inform the applicant</span></div>
<div class="line"><span class="lineno"> 2605</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;LeaderWaitingState is timeout, changing back to PlatoonLeaderState.&quot;</span>);</div>
<div class="line"><span class="lineno"> 2606</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> = <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa57f78e815f4fc2ac271a9fd85cd80ebc">PlatoonState::LEADER</a>;</div>
<div class="line"><span class="lineno"> 2607</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#af2f0d9818d07db4a4df484f988635201">clearActionPlan</a>();</div>
<div class="line"><span class="lineno"> 2608</span>        }</div>
<div class="line"><span class="lineno"> 2609</span>        <span class="comment">// Task 2</span></div>
<div class="line"><span class="lineno"> 2610</span>        carma_v2x_msgs::msg::MobilityOperation status;</div>
<div class="line"><span class="lineno"> 2611</span>        status = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a95d140cc05909e28936b714f41862fc9">composeMobilityOperationLeaderWaiting</a>();</div>
<div class="line"><span class="lineno"> 2612</span>        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a19ea827fa9a96b9154f33d364d89260e">mobility_operation_publisher_</a>(status);</div>
<div class="line"><span class="lineno"> 2613</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;publish status message&quot;</span>);</div>
<div class="line"><span class="lineno"> 2614</span>        <span class="keywordtype">long</span> tsEnd = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a283186f2bbb98f5f85b5486e365bb4b8">timer_factory_</a>-&gt;now().nanoseconds() / 1000000;</div>
<div class="line"><span class="lineno"> 2615</span>        <span class="keywordtype">long</span> sleepDuration = std::max((<a class="code hl_typedef" href="stdint_8h.html#ab1967d8591af1a4e48c37fd2b0f184d0">int32_t</a>)(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae54ec36efc19b9c2edc90148ac10b4e0">statusMessageInterval_</a> - (tsEnd - tsStart)), 0);</div>
<div class="line"><span class="lineno"> 2616</span> </div>
<div class="line"><span class="lineno"> 2617</span>        <span class="comment">// TODO this solution is not sim-time complient and should be replaced with one which is when possible</span></div>
<div class="line"><span class="lineno"> 2618</span>        <span class="comment">// https://github.com/usdot-fhwa-stol/carma-platform/issues/1888</span></div>
<div class="line"><span class="lineno"> 2619</span>        std::this_thread::sleep_for(std::chrono::milliseconds(sleepDuration));</div>
<div class="line"><span class="lineno"> 2620</span>    }</div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a95d140cc05909e28936b714f41862fc9"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a95d140cc05909e28936b714f41862fc9">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::composeMobilityOperationLeaderWaiting</a></div><div class="ttdeci">carma_v2x_msgs::msg::MobilityOperation composeMobilityOperationLeaderWaiting()</div><div class="ttdoc">Function to compose mobility operation in leader waiting state.</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l00591">platoon_strategic_ihp.cpp:591</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__manager__ihp_8cpp_source.html#l00285">platoon_strategic_ihp::PlatoonManager::clearActionPlan()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00591">composeMobilityOperationLeaderWaiting()</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00370">platoon_strategic_ihp::PlatoonManager::current_platoon_state</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00080">platoon_strategic_ihp::LEADER</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00310">mobility_operation_publisher_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00817">pm_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00793">statusMessageInterval_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00814">timer_factory_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00334">waitingStartTime</a>, and <a class="el" href="platoon__strategic__ihp_8h_source.html#l00798">waitingStateTimeout</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l03060">onSpin()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a7bcebb0d98ab80013c945a2ec283250e_cgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a7bcebb0d98ab80013c945a2ec283250e_cgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a7bcebb0d98ab80013c945a2ec283250e_cgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a7bcebb0d98ab80013c945a2ec283250e_cgraph">
<area shape="rect" title="Run Leader Waiting State." alt="" coords="5,38,188,94"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#af2f0d9818d07db4a4df484f988635201" title="Resets necessary variables to indicate that the current ActionPlan is dead." alt="" coords="237,5,456,47"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a95d140cc05909e28936b714f41862fc9" title="Function to compose mobility operation in leader waiting state." alt="" coords="236,71,457,141"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aabe87e2046da048da999758ebdd119fe" title="Function to compose mobility operation message with STATUS params." alt="" coords="505,78,740,134"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a7bcebb0d98ab80013c945a2ec283250e_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a7bcebb0d98ab80013c945a2ec283250e_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a7bcebb0d98ab80013c945a2ec283250e_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a7bcebb0d98ab80013c945a2ec283250e_icgraph">
<area shape="rect" title="Run Leader Waiting State." alt="" coords="429,5,612,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ac7e7160659b61a4ac61be14f74fb1caa" title="Spin callback function." alt="" coords="199,5,381,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,5,151,61"/>
</map>
</div>

</div>
</div>
<a id="a8c989d9220109cab74fb8aff6212f27e" name="a8c989d9220109cab74fb8aff6212f27e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c989d9220109cab74fb8aff6212f27e">&#9670;&nbsp;</a></span>run_prepare_to_join()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void platoon_strategic_ihp::PlatoonStrategicIHPPlugin::run_prepare_to_join </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>UCLA Run prepare to join State. </p>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02977">2977</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2978</span>    {   </div>
<div class="line"><span class="lineno"> 2979</span>        <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 2980</span><span class="comment">        * The prepare join state should have the following tasks: </span></div>
<div class="line"><span class="lineno"> 2981</span><span class="comment">        *   1. Compose mobility operation param: status.</span></div>
<div class="line"><span class="lineno"> 2982</span><span class="comment">        *   2. Time out check.</span></div>
<div class="line"><span class="lineno"> 2983</span><span class="comment">        *   3. Calculate proper cut_in index </span></div>
<div class="line"><span class="lineno"> 2984</span><span class="comment">        *   4. Send out lane change intend to leader.</span></div>
<div class="line"><span class="lineno"> 2985</span><span class="comment">        *   Note: 1. safeToLaneChange_ monitors the gap condition.</span></div>
<div class="line"><span class="lineno"> 2986</span><span class="comment">        *         2. Once it is safe to lane change, the updated plan will send-out in &quot;plan_maneuver_cb&quot;</span></div>
<div class="line"><span class="lineno"> 2987</span><span class="comment">        */</span></div>
<div class="line"><span class="lineno"> 2988</span> </div>
<div class="line"><span class="lineno"> 2989</span>        <span class="comment">// Task 2.1: state timeout</span></div>
<div class="line"><span class="lineno"> 2990</span>        <span class="keywordtype">long</span> tsStart = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a283186f2bbb98f5f85b5486e365bb4b8">timer_factory_</a>-&gt;now().nanoseconds() / 1000000;</div>
<div class="line"><span class="lineno"> 2991</span>        <span class="keywordtype">bool</span> isCurrentStateTimeout = (tsStart - <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa30dd7c98fe60faad9ba8af0da2da581">candidatestateStartTime</a>) &gt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a5bb0123eb1a68e83b1a424eeb94f0929">waitingStateTimeout</a> * 1000;</div>
<div class="line"><span class="lineno"> 2992</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;timeout1: &quot;</span> &lt;&lt; tsStart - <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa30dd7c98fe60faad9ba8af0da2da581">candidatestateStartTime</a>);</div>
<div class="line"><span class="lineno"> 2993</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;waitingStateTimeout: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a5bb0123eb1a68e83b1a424eeb94f0929">waitingStateTimeout</a> * 1000);</div>
<div class="line"><span class="lineno"> 2994</span>        <span class="keywordflow">if</span> (isCurrentStateTimeout) </div>
<div class="line"><span class="lineno"> 2995</span>        {</div>
<div class="line"><span class="lineno"> 2996</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;The current prepare to join state is timeout. Change back to leader state and abort lane change.&quot;</span>);</div>
<div class="line"><span class="lineno"> 2997</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> = <a class="code hl_enumvalue" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403dafa57f78e815f4fc2ac271a9fd85cd80ebc">PlatoonState::LEADER</a>;</div>
<div class="line"><span class="lineno"> 2998</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2bc77445cdb4c025344024395fa94607">safeToLaneChange_</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2999</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#af2f0d9818d07db4a4df484f988635201">clearActionPlan</a>();</div>
<div class="line"><span class="lineno"> 3000</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ab1c204db4a5056621de299a9dd663c6f">resetHostPlatoon</a>();</div>
<div class="line"><span class="lineno"> 3001</span>            <span class="comment">// Leave neighbor platoon info in place, as we may retry the join later</span></div>
<div class="line"><span class="lineno"> 3002</span>        }</div>
<div class="line"><span class="lineno"> 3003</span> </div>
<div class="line"><span class="lineno"> 3004</span>        <span class="comment">// TODO: Plan timeout is not needed for this state</span></div>
<div class="line"><span class="lineno"> 3005</span> </div>
<div class="line"><span class="lineno"> 3006</span>        <span class="comment">// If we aren&#39;t already waiting on a response to one of these plans, create one once neighbor info is available</span></div>
<div class="line"><span class="lineno"> 3007</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;current_plan.valid = &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a9474313cd68557978e8dbd481d0408bc">valid</a> &lt;&lt; <span class="stringliteral">&quot;, is_neighbor_record_complete = &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a8f2badbbe25d2b4d26e1556fa0aa63">is_neighbor_record_complete_</a>);</div>
<div class="line"><span class="lineno"> 3008</span>        </div>
<div class="line"><span class="lineno"> 3009</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1ActionPlan.html#a9474313cd68557978e8dbd481d0408bc">valid</a>  &amp;&amp;  <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a8f2badbbe25d2b4d26e1556fa0aa63">is_neighbor_record_complete_</a>)</div>
<div class="line"><span class="lineno"> 3010</span>        {</div>
<div class="line"><span class="lineno"> 3011</span>            <span class="comment">// Task 1: compose mobility operation (status)</span></div>
<div class="line"><span class="lineno"> 3012</span>            carma_v2x_msgs::msg::MobilityOperation status;</div>
<div class="line"><span class="lineno"> 3013</span>            status = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a4e1a6de5a77b7bceab316768df37fc50">composeMobilityOperationPrepareToJoin</a>(); <span class="comment">//TODO: I bet we could consolidate a lot of these compose methods</span></div>
<div class="line"><span class="lineno"> 3014</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a19ea827fa9a96b9154f33d364d89260e">mobility_operation_publisher_</a>(status);</div>
<div class="line"><span class="lineno"> 3015</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Published platoon STATUS operation message&quot;</span>);</div>
<div class="line"><span class="lineno"> 3016</span> </div>
<div class="line"><span class="lineno"> 3017</span>            <span class="comment">// Task 3: Calculate proper cut_in index </span></div>
<div class="line"><span class="lineno"> 3018</span>            <span class="comment">// Note: The cut-in index is zero-based and points to the gap-leading vehicle&#39;s index. For cut-in from front, the join index = -1.</span></div>
<div class="line"><span class="lineno"> 3019</span>            <span class="keywordtype">double</span> joinerDtD = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa53003d4c3610dbb5f87762a6683dd9f">current_downtrack_</a>;</div>
<div class="line"><span class="lineno"> 3020</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a94ef4b19b4e5f6befabedd4b14908bdd">target_join_index_</a> = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a891585489dfbd709f71347784744ed58">getClosestIndex</a>(joinerDtD);</div>
<div class="line"><span class="lineno"> 3021</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;calculated join index: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a94ef4b19b4e5f6befabedd4b14908bdd">target_join_index_</a>);</div>
<div class="line"><span class="lineno"> 3022</span> </div>
<div class="line"><span class="lineno"> 3023</span>            <span class="comment">// Task 4: Send out request to leader about cut-in position</span></div>
<div class="line"><span class="lineno"> 3024</span>            carma_v2x_msgs::msg::MobilityRequest request;</div>
<div class="line"><span class="lineno"> 3025</span>            std::string planId = boost::uuids::to_string(boost::uuids::random_generator()());</div>
<div class="line"><span class="lineno"> 3026</span>            <span class="keywordtype">long</span> currentTime = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a283186f2bbb98f5f85b5486e365bb4b8">timer_factory_</a>-&gt;now().nanoseconds() / 1000000;</div>
<div class="line"><span class="lineno"> 3027</span>            request.m_header.plan_id = planId;</div>
<div class="line"><span class="lineno"> 3028</span>            request.m_header.recipient_id = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8fa6576577e52bb8e1a31fef457defa9">neighbor_platoon_leader_id_</a>;</div>
<div class="line"><span class="lineno"> 3029</span>            request.m_header.sender_id = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a>.<a class="code hl_variable" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html#a473bcce97d7c50beaab678372a354c0d">vehicleID</a>;</div>
<div class="line"><span class="lineno"> 3030</span>            request.m_header.timestamp = currentTime;</div>
<div class="line"><span class="lineno"> 3031</span>            request.plan_type.type = carma_v2x_msgs::msg::PlanType::PLATOON_CUT_IN_JOIN;</div>
<div class="line"><span class="lineno"> 3032</span>            request.strategy = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3be0b52376b568130c1c6a5ec5adeb13">PLATOONING_STRATEGY</a>;</div>
<div class="line"><span class="lineno"> 3033</span>            request.urgency = 50;</div>
<div class="line"><span class="lineno"> 3034</span>            request.location = <a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a11ffedaaa90fe358ecfdccab7c5a428c">pose_to_ecef</a>(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa67d1b97f198e2f088fb24ffb8e0c690">pose_msg_</a>);</div>
<div class="line"><span class="lineno"> 3035</span>            <span class="keywordtype">double</span> platoon_size = <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_function" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a3ef30eeb7a7cf0caccb948e6a41f92">getHostPlatoonSize</a>(); </div>
<div class="line"><span class="lineno"> 3036</span> </div>
<div class="line"><span class="lineno"> 3037</span>            boost::format fmter(<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aca973fa2125f768cffaf33812403f45c">JOIN_PARAMS</a>);</div>
<div class="line"><span class="lineno"> 3038</span>            fmter %platoon_size;                <span class="comment">//  index = 0</span></div>
<div class="line"><span class="lineno"> 3039</span>            fmter %<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3e827c7f2e764c6e7de83f0a81a9593f">current_speed_</a>;              <span class="comment">//  index = 1, in m/s</span></div>
<div class="line"><span class="lineno"> 3040</span>            fmter %<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ad10e1df213ec7524892b247d28ec9172">pose_ecef_point_</a>.ecef_x;     <span class="comment">//  index = 2</span></div>
<div class="line"><span class="lineno"> 3041</span>            fmter %<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ad10e1df213ec7524892b247d28ec9172">pose_ecef_point_</a>.ecef_y;     <span class="comment">//  index = 3</span></div>
<div class="line"><span class="lineno"> 3042</span>            fmter %<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ad10e1df213ec7524892b247d28ec9172">pose_ecef_point_</a>.ecef_z;     <span class="comment">//  index = 4</span></div>
<div class="line"><span class="lineno"> 3043</span>            fmter %<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a94ef4b19b4e5f6befabedd4b14908bdd">target_join_index_</a>;          <span class="comment">//  index = 5</span></div>
<div class="line"><span class="lineno"> 3044</span>            request.strategy_params = fmter.str();</div>
<div class="line"><span class="lineno"> 3045</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae4e916260ddb6f7eb25da13ef9cb158e">mobility_request_publisher_</a>(request); </div>
<div class="line"><span class="lineno"> 3046</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Published Mobility cut-in join request to leader &quot;</span> &lt;&lt; request.m_header.recipient_id &lt;&lt; <span class="stringliteral">&quot; with planId = &quot;</span> &lt;&lt; planId);</div>
<div class="line"><span class="lineno"> 3047</span> </div>
<div class="line"><span class="lineno"> 3048</span>            <span class="comment">// Create a new join action plan</span></div>
<div class="line"><span class="lineno"> 3049</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a0d0a209aaf6bc5c61a30b091a78cb39d">current_plan</a> = ActionPlan(<span class="keyword">true</span>, currentTime, planId, <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8fa6576577e52bb8e1a31fef457defa9">neighbor_platoon_leader_id_</a>);</div>
<div class="line"><span class="lineno"> 3050</span>        }</div>
<div class="line"><span class="lineno"> 3051</span>    }</div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonManager_html_a891585489dfbd709f71347784744ed58"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a891585489dfbd709f71347784744ed58">platoon_strategic_ihp::PlatoonManager::getClosestIndex</a></div><div class="ttdeci">int getClosestIndex(double joinerDtD)</div><div class="ttdoc">UCLA: Return joiner's desired position in terms of target platoon index to cut into the platoon....</div><div class="ttdef"><b>Definition:</b> <a href="platoon__manager__ihp_8cpp_source.html#l00911">platoon_manager_ihp.cpp:911</a></div></div>
<div class="ttc" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_html_a4e1a6de5a77b7bceab316768df37fc50"><div class="ttname"><a href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a4e1a6de5a77b7bceab316768df37fc50">platoon_strategic_ihp::PlatoonStrategicIHPPlugin::composeMobilityOperationPrepareToJoin</a></div><div class="ttdeci">carma_v2x_msgs::msg::MobilityOperation composeMobilityOperationPrepareToJoin()</div><div class="ttdoc">Function to compose mobility operation in PrepareToJoin (cut-in join)</div><div class="ttdef"><b>Definition:</b> <a href="platoon__strategic__ihp_8cpp_source.html#l00634">platoon_strategic_ihp.cpp:634</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__strategic__ihp_8h_source.html#l00336">candidatestateStartTime</a>, <a class="el" href="platoon__manager__ihp_8cpp_source.html#l00285">platoon_strategic_ihp::PlatoonManager::clearActionPlan()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00634">composeMobilityOperationPrepareToJoin()</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00318">config_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00330">current_downtrack_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00376">platoon_strategic_ihp::PlatoonManager::current_plan</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00370">platoon_strategic_ihp::PlatoonManager::current_platoon_state</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00328">current_speed_</a>, <a class="el" href="platoon__manager__ihp_8cpp_source.html#l00911">platoon_strategic_ihp::PlatoonManager::getClosestIndex()</a>, <a class="el" href="platoon__manager__ihp_8cpp_source.html#l00279">platoon_strategic_ihp::PlatoonManager::getHostPlatoonSize()</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00398">platoon_strategic_ihp::PlatoonManager::is_neighbor_record_complete_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00858">JOIN_PARAMS</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00080">platoon_strategic_ihp::LEADER</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00310">mobility_operation_publisher_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00308">mobility_request_publisher_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00395">platoon_strategic_ihp::PlatoonManager::neighbor_platoon_leader_id_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00820">PLATOONING_STRATEGY</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00817">pm_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00257">pose_ecef_point_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00322">pose_msg_</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00064">pose_to_ecef()</a>, <a class="el" href="platoon__manager__ihp_8cpp_source.html#l00295">platoon_strategic_ihp::PlatoonManager::resetHostPlatoon()</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00811">safeToLaneChange_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00808">target_join_index_</a>, <a class="el" href="platoon__strategic__ihp_8h_source.html#l00814">timer_factory_</a>, <a class="el" href="platoon__manager__ihp_8h_source.html#l00047">platoon_strategic_ihp::ActionPlan::valid</a>, <a class="el" href="platoon__config__ihp_8h_source.html#l00068">platoon_strategic_ihp::PlatoonPluginConfig::vehicleID</a>, and <a class="el" href="platoon__strategic__ihp_8h_source.html#l00798">waitingStateTimeout</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l03060">onSpin()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a8c989d9220109cab74fb8aff6212f27e_cgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a8c989d9220109cab74fb8aff6212f27e_cgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a8c989d9220109cab74fb8aff6212f27e_cgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a8c989d9220109cab74fb8aff6212f27e_cgraph">
<area shape="rect" title="UCLA Run prepare to join State." alt="" coords="5,202,188,258"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#af2f0d9818d07db4a4df484f988635201" title="Resets necessary variables to indicate that the current ActionPlan is dead." alt="" coords="248,5,467,47"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a4e1a6de5a77b7bceab316768df37fc50" title="Function to compose mobility operation in PrepareToJoin (cut&#45;in join)" alt="" coords="244,71,471,141"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a891585489dfbd709f71347784744ed58" title="UCLA: Return joiner&#39;s desired position in terms of target platoon index to cut into the platoon...." alt="" coords="262,166,453,222"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#a8a3ef30eeb7a7cf0caccb948e6a41f92" title="Returns total size of the platoon , in number of vehicles." alt="" coords="236,245,479,287"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a11ffedaaa90fe358ecfdccab7c5a428c" title="Function to convert pose from map frame to ecef location." alt="" coords="266,310,449,366"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ab1c204db4a5056621de299a9dd663c6f" title="Resets all variables that might indicate other members of the host&#39;s platoon; sets the host back to s..." alt="" coords="265,390,450,446"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aabe87e2046da048da999758ebdd119fe" title="Function to compose mobility operation message with STATUS params." alt="" coords="527,78,761,134"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a8c989d9220109cab74fb8aff6212f27e_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a8c989d9220109cab74fb8aff6212f27e_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a8c989d9220109cab74fb8aff6212f27e_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a8c989d9220109cab74fb8aff6212f27e_icgraph">
<area shape="rect" title="UCLA Run prepare to join State." alt="" coords="429,5,612,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ac7e7160659b61a4ac61be14f74fb1caa" title="Spin callback function." alt="" coords="199,5,381,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,5,151,61"/>
</map>
</div>

</div>
</div>
<a id="a83e278a200d79307eae123526701ac5f" name="a83e278a200d79307eae123526701ac5f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83e278a200d79307eae123526701ac5f">&#9670;&nbsp;</a></span>setConfig()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void platoon_strategic_ihp::PlatoonStrategicIHPPlugin::setConfig </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html">PlatoonPluginConfig</a> &amp;&#160;</td>
          <td class="paramname"><em>config</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the current config. </p>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l03517">3517</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3518</span>    {</div>
<div class="line"><span class="lineno"> 3519</span>        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a2fa8cc0acf44a963c53a0461ad38fbac">config_</a> = config;</div>
<div class="line"><span class="lineno"> 3520</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__strategic__ihp_8h_source.html#l00318">config_</a>.</p>

</div>
</div>
<a id="abcab6368ab8bffc15e380b099554b314" name="abcab6368ab8bffc15e380b099554b314"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abcab6368ab8bffc15e380b099554b314">&#9670;&nbsp;</a></span>setHostECEF()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void platoon_strategic_ihp::PlatoonStrategicIHPPlugin::setHostECEF </td>
          <td>(</td>
          <td class="paramtype">carma_v2x_msgs::msg::LocationECEF&#160;</td>
          <td class="paramname"><em>pose_ecef_point</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>UCLA Update the private variable pose_ecef_point_. </p>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00090">90</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   91</span>    {</div>
<div class="line"><span class="lineno">   92</span>        <span class="comment">// Note, the ecef here is in cm. </span></div>
<div class="line"><span class="lineno">   93</span>        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ad10e1df213ec7524892b247d28ec9172">pose_ecef_point_</a> = pose_ecef_point;</div>
<div class="line"><span class="lineno">   94</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__strategic__ihp_8h_source.html#l00257">pose_ecef_point_</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00115">pose_cb()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_abcab6368ab8bffc15e380b099554b314_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_abcab6368ab8bffc15e380b099554b314_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_abcab6368ab8bffc15e380b099554b314_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_abcab6368ab8bffc15e380b099554b314_icgraph">
<area shape="rect" title="UCLA Update the private variable pose_ecef_point_." alt="" coords="429,5,612,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aa81560488f89d886d731bcdbfebbbf37" title="Callback function for current pose." alt="" coords="199,5,381,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,5,151,61"/>
</map>
</div>

</div>
</div>
<a id="a2d2a38cf81006009974698b5ad9dc738" name="a2d2a38cf81006009974698b5ad9dc738"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d2a38cf81006009974698b5ad9dc738">&#9670;&nbsp;</a></span>setPMState()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void platoon_strategic_ihp::PlatoonStrategicIHPPlugin::setPMState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceplatoon__strategic__ihp.html#a20539b6c81ea3b1868c7ca5d7c403daf">PlatoonState</a>&#160;</td>
          <td class="paramname"><em>desiredState</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>UCLA Setter: function to set pm_.platoon_state. </p>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00103">103</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  104</span>    {</div>
<div class="line"><span class="lineno">  105</span>        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#acb517eeb3ddfa40b377d80582e58e741">current_platoon_state</a> = desiredState;</div>
<div class="line"><span class="lineno">  106</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__manager__ihp_8h_source.html#l00370">platoon_strategic_ihp::PlatoonManager::current_platoon_state</a>, and <a class="el" href="platoon__strategic__ihp_8h_source.html#l00817">pm_</a>.</p>

</div>
</div>
<a id="adccd8434590f9faf212576cc5336e492" name="adccd8434590f9faf212576cc5336e492"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adccd8434590f9faf212576cc5336e492">&#9670;&nbsp;</a></span>twist_cb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void platoon_strategic_ihp::PlatoonStrategicIHPPlugin::twist_cb </td>
          <td>(</td>
          <td class="paramtype">const geometry_msgs::msg::TwistStamped::UniquePtr&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Callback for the twist subscriber, which will store latest twist locally. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>Latest twist message </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00143">143</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  144</span>    {</div>
<div class="line"><span class="lineno">  145</span>        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3e827c7f2e764c6e7de83f0a81a9593f">current_speed_</a> = msg-&gt;twist.linear.x;</div>
<div class="line"><span class="lineno">  146</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3e827c7f2e764c6e7de83f0a81a9593f">current_speed_</a> &lt; <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#ae53ddfbfa903ffe85722c9471cdfd3af">STOPPED_SPEED</a>)</div>
<div class="line"><span class="lineno">  147</span>        {</div>
<div class="line"><span class="lineno">  148</span>            <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#a3e827c7f2e764c6e7de83f0a81a9593f">current_speed_</a> = 0.0;</div>
<div class="line"><span class="lineno">  149</span>        }</div>
<div class="line"><span class="lineno">  150</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__strategic__ihp_8h_source.html#l00328">current_speed_</a>, and <a class="el" href="platoon__strategic__ihp_8h_source.html#l00805">STOPPED_SPEED</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp__node_8cpp_source.html#l00118">platoon_strategic_ihp::Node::on_configure_plugin()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_adccd8434590f9faf212576cc5336e492_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_adccd8434590f9faf212576cc5336e492_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_adccd8434590f9faf212576cc5336e492_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_adccd8434590f9faf212576cc5336e492_icgraph">
<area shape="rect" title="Callback for the twist subscriber, which will store latest twist locally." alt="" coords="199,5,381,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1Node.html#ab473b2bc25d4250b7b4eee8dfa29a2a9" title="This method should be used to load parameters and will be called on the configure state transition." alt="" coords="5,5,151,61"/>
</map>
</div>

</div>
</div>
<a id="a609dc105613d0c6ff89e1e955c8f6487" name="a609dc105613d0c6ff89e1e955c8f6487"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a609dc105613d0c6ff89e1e955c8f6487">&#9670;&nbsp;</a></span>updateCurrentStatus()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void platoon_strategic_ihp::PlatoonStrategicIHPPlugin::updateCurrentStatus </td>
          <td>(</td>
          <td class="paramtype">carma_planning_msgs::msg::Maneuver&#160;</td>
          <td class="paramname"><em>maneuver</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>speed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>current_progress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classint.html">int</a> &amp;&#160;</td>
          <td class="paramname"><em>lane_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update maneuver status based on prior plan. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">maneuver</td><td>maneuver </td></tr>
    <tr><td class="paramname">speed</td><td>speed </td></tr>
    <tr><td class="paramname">current_progress</td><td>current progress </td></tr>
    <tr><td class="paramname">lane_id</td><td>lanelet ud </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l03203">3203</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3204</span>    {</div>
<div class="line"><span class="lineno"> 3205</span>        <span class="keywordflow">if</span>(maneuver.type == carma_planning_msgs::msg::Maneuver::LANE_FOLLOWING){</div>
<div class="line"><span class="lineno"> 3206</span>            speed =  maneuver.lane_following_maneuver.end_speed;</div>
<div class="line"><span class="lineno"> 3207</span>            current_progress =  maneuver.lane_following_maneuver.end_dist;</div>
<div class="line"><span class="lineno"> 3208</span>            <span class="keywordflow">if</span> (maneuver.lane_following_maneuver.lane_ids.empty()) </div>
<div class="line"><span class="lineno"> 3209</span>            {</div>
<div class="line"><span class="lineno"> 3210</span>                RCLCPP_WARN_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;platoon_strategic_ihp&quot;</span>), <span class="stringliteral">&quot;Lane id of lane following maneuver not set. Using 0&quot;</span>);</div>
<div class="line"><span class="lineno"> 3211</span>                lane_id = 0;</div>
<div class="line"><span class="lineno"> 3212</span>            } </div>
<div class="line"><span class="lineno"> 3213</span>            <span class="keywordflow">else</span> </div>
<div class="line"><span class="lineno"> 3214</span>            {</div>
<div class="line"><span class="lineno"> 3215</span>                lane_id =  stoi(maneuver.lane_following_maneuver.lane_ids[0]);</div>
<div class="line"><span class="lineno"> 3216</span>            }</div>
<div class="line"><span class="lineno"> 3217</span>        }</div>
<div class="line"><span class="lineno"> 3218</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l03221">plan_maneuver_cb()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a609dc105613d0c6ff89e1e955c8f6487_icgraph.png" border="0" usemap="#aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a609dc105613d0c6ff89e1e955c8f6487_icgraph" alt=""/></div>
<map name="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a609dc105613d0c6ff89e1e955c8f6487_icgraph" id="aclassplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin_a609dc105613d0c6ff89e1e955c8f6487_icgraph">
<area shape="rect" title="Update maneuver status based on prior plan." alt="" coords="236,5,419,61"/>
<area shape="rect" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#aedb5c1f689806047c82f0c7b3ebe9c66" title="Callback function to the maneuver request." alt="" coords="5,5,188,61"/>
</map>
</div>

</div>
</div>
<a id="ae9f897ed93100210dc6396905c7d6ddc" name="ae9f897ed93100210dc6396905c7d6ddc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9f897ed93100210dc6396905c7d6ddc">&#9670;&nbsp;</a></span>updatePlatoonList()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void platoon_strategic_ihp::PlatoonStrategicIHPPlugin::updatePlatoonList </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; <a class="el" href="structplatoon__strategic__ihp_1_1PlatoonMember.html">PlatoonMember</a> &gt;&#160;</td>
          <td class="paramname"><em>platoon_list</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>UCLA Setter: Update platoon list (Unit Test). </p>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00109">109</a> of file <a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  110</span>    {</div>
<div class="line"><span class="lineno">  111</span>        <a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html#adb546b690a5bbb1ad31d02fc6341734f">pm_</a>.<a class="code hl_variable" href="classplatoon__strategic__ihp_1_1PlatoonManager.html#ad408d9fd019a1f61369db874447f4ace">host_platoon_</a> = platoon_list;</div>
<div class="line"><span class="lineno">  112</span>    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="platoon__manager__ihp_8h_source.html#l00361">platoon_strategic_ihp::PlatoonManager::host_platoon_</a>, and <a class="el" href="platoon__strategic__ihp_8h_source.html#l00817">pm_</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a05bae259db41743d775c87f37d132d72" name="a05bae259db41743d775c87f37d132d72"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05bae259db41743d775c87f37d132d72">&#9670;&nbsp;</a></span>candidate_follower_delay_count_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classint.html">int</a> platoon_strategic_ihp::PlatoonStrategicIHPPlugin::candidate_follower_delay_count_ = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8h_source.html#l00785">785</a> of file <a class="el" href="platoon__strategic__ihp_8h_source.html">platoon_strategic_ihp.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02722">run_candidate_follower()</a>.</p>

</div>
</div>
<a id="aa30dd7c98fe60faad9ba8af0da2da581" name="aa30dd7c98fe60faad9ba8af0da2da581"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa30dd7c98fe60faad9ba8af0da2da581">&#9670;&nbsp;</a></span>candidatestateStartTime</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">long platoon_strategic_ihp::PlatoonStrategicIHPPlugin::candidatestateStartTime = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8h_source.html#l00336">336</a> of file <a class="el" href="platoon__strategic__ihp_8h_source.html">platoon_strategic_ihp.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01571">mob_req_cb_leader()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01870">mob_req_cb_leadwithoperation()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02220">mob_resp_cb_follower()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02256">mob_resp_cb_leader()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02455">mob_resp_cb_preparetojoin()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02722">run_candidate_follower()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02918">run_candidate_leader()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02822">run_leader_aborting()</a>, and <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02977">run_prepare_to_join()</a>.</p>

</div>
</div>
<a id="a04e00e8747e98a33b4f708b8e9e58042" name="a04e00e8747e98a33b4f708b8e9e58042"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04e00e8747e98a33b4f708b8e9e58042">&#9670;&nbsp;</a></span>cmd_speed_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double platoon_strategic_ihp::PlatoonStrategicIHPPlugin::cmd_speed_ = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8h_source.html#l00326">326</a> of file <a class="el" href="platoon__strategic__ihp_8h_source.html">platoon_strategic_ihp.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00137">cmd_cb()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00277">composeMobilityOperationSTATUS()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00419">composePlatoonInfoMsg()</a>, and <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l03060">onSpin()</a>.</p>

</div>
</div>
<a id="a2fa8cc0acf44a963c53a0461ad38fbac" name="a2fa8cc0acf44a963c53a0461ad38fbac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2fa8cc0acf44a963c53a0461ad38fbac">&#9670;&nbsp;</a></span>config_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structplatoon__strategic__ihp_1_1PlatoonPluginConfig.html">PlatoonPluginConfig</a> platoon_strategic_ihp::PlatoonStrategicIHPPlugin::config_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8h_source.html#l00318">318</a> of file <a class="el" href="platoon__strategic__ihp_8h_source.html">platoon_strategic_ihp.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00036">PlatoonStrategicIHPPlugin()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l03162">composeLaneChangeManeuverMessage()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l03122">composeManeuverMessage()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00314">composeMobilityOperationINFO()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00277">composeMobilityOperationSTATUS()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00419">composePlatoonInfoMsg()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00353">isJoiningVehicleNearPlatoon()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00388">isVehicleNearTargetPlatoon()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00232">isVehicleRightBehind()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00211">isVehicleRightInFront()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00954">mob_op_cb_leader()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01244">mob_op_cb_preparetojoin()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02551">mob_req_cb()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01827">mob_req_cb_candidateleader()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01571">mob_req_cb_leader()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01510">mob_req_cb_leaderwaiting()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01870">mob_req_cb_leadwithoperation()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02256">mob_resp_cb_leader()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02455">mob_resp_cb_preparetojoin()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l03221">plan_maneuver_cb()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02722">run_candidate_follower()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02945">run_lead_with_operation()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02622">run_leader()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02822">run_leader_aborting()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02977">run_prepare_to_join()</a>, and <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l03517">setConfig()</a>.</p>

</div>
</div>
<a id="a79aaef859aaa4b64f6cf79c50c596bc3" name="a79aaef859aaa4b64f6cf79c50c596bc3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79aaef859aaa4b64f6cf79c50c596bc3">&#9670;&nbsp;</a></span>current_crosstrack_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double platoon_strategic_ihp::PlatoonStrategicIHPPlugin::current_crosstrack_ = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8h_source.html#l00332">332</a> of file <a class="el" href="platoon__strategic__ihp_8h_source.html">platoon_strategic_ihp.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00353">isJoiningVehicleNearPlatoon()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00388">isVehicleNearTargetPlatoon()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00232">isVehicleRightBehind()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00211">isVehicleRightInFront()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01244">mob_op_cb_preparetojoin()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01827">mob_req_cb_candidateleader()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01571">mob_req_cb_leader()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01510">mob_req_cb_leaderwaiting()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l03060">onSpin()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l03221">plan_maneuver_cb()</a>, and <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00115">pose_cb()</a>.</p>

</div>
</div>
<a id="aa53003d4c3610dbb5f87762a6683dd9f" name="aa53003d4c3610dbb5f87762a6683dd9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa53003d4c3610dbb5f87762a6683dd9f">&#9670;&nbsp;</a></span>current_downtrack_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double platoon_strategic_ihp::PlatoonStrategicIHPPlugin::current_downtrack_ = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8h_source.html#l00330">330</a> of file <a class="el" href="platoon__strategic__ihp_8h_source.html">platoon_strategic_ihp.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00419">composePlatoonInfoMsg()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00353">isJoiningVehicleNearPlatoon()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00388">isVehicleNearTargetPlatoon()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00232">isVehicleRightBehind()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00211">isVehicleRightInFront()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01244">mob_op_cb_preparetojoin()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01571">mob_req_cb_leader()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01870">mob_req_cb_leadwithoperation()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l03060">onSpin()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l03221">plan_maneuver_cb()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00115">pose_cb()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02722">run_candidate_follower()</a>, and <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02977">run_prepare_to_join()</a>.</p>

</div>
</div>
<a id="a3e827c7f2e764c6e7de83f0a81a9593f" name="a3e827c7f2e764c6e7de83f0a81a9593f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e827c7f2e764c6e7de83f0a81a9593f">&#9670;&nbsp;</a></span>current_speed_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double platoon_strategic_ihp::PlatoonStrategicIHPPlugin::current_speed_ = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8h_source.html#l00328">328</a> of file <a class="el" href="platoon__strategic__ihp_8h_source.html">platoon_strategic_ihp.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00314">composeMobilityOperationINFO()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00277">composeMobilityOperationSTATUS()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00419">composePlatoonInfoMsg()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00809">mob_op_cb()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00954">mob_op_cb_leader()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01244">mob_op_cb_preparetojoin()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02551">mob_req_cb()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01870">mob_req_cb_leadwithoperation()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02455">mob_resp_cb_preparetojoin()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l03060">onSpin()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l03221">plan_maneuver_cb()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02722">run_candidate_follower()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02622">run_leader()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02822">run_leader_aborting()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02977">run_prepare_to_join()</a>, and <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00143">twist_cb()</a>.</p>

</div>
</div>
<a id="a92f6e3771b23b30e6be6201969e1a5d2" name="a92f6e3771b23b30e6be6201969e1a5d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92f6e3771b23b30e6be6201969e1a5d2">&#9670;&nbsp;</a></span>desiredJoinGap</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double platoon_strategic_ihp::PlatoonStrategicIHPPlugin::desiredJoinGap = 30.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8h_source.html#l00799">799</a> of file <a class="el" href="platoon__strategic__ihp_8h_source.html">platoon_strategic_ihp.h</a>.</p>

</div>
</div>
<a id="ab3712cdbc6fc84fa631da3ec72733880" name="ab3712cdbc6fc84fa631da3ec72733880"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3712cdbc6fc84fa631da3ec72733880">&#9670;&nbsp;</a></span>desiredJoinTimeGap</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double platoon_strategic_ihp::PlatoonStrategicIHPPlugin::desiredJoinTimeGap = 4.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8h_source.html#l00800">800</a> of file <a class="el" href="platoon__strategic__ihp_8h_source.html">platoon_strategic_ihp.h</a>.</p>

</div>
</div>
<a id="a986341c08763b68ba3aa958535b61fda" name="a986341c08763b68ba3aa958535b61fda"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a986341c08763b68ba3aa958535b61fda">&#9670;&nbsp;</a></span>HostMobilityId</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string platoon_strategic_ihp::PlatoonStrategicIHPPlugin::HostMobilityId = &quot;hostid&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8h_source.html#l00339">339</a> of file <a class="el" href="platoon__strategic__ihp_8h_source.html">platoon_strategic_ihp.h</a>.</p>

</div>
</div>
<a id="af12e6e347833e62db64c99229643d23e" name="af12e6e347833e62db64c99229643d23e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af12e6e347833e62db64c99229643d23e">&#9670;&nbsp;</a></span>infoMessageInterval_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned long platoon_strategic_ihp::PlatoonStrategicIHPPlugin::infoMessageInterval_ = 200</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8h_source.html#l00791">791</a> of file <a class="el" href="platoon__strategic__ihp_8h_source.html">platoon_strategic_ihp.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02945">run_lead_with_operation()</a>, and <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02622">run_leader()</a>.</p>

</div>
</div>
<a id="aca973fa2125f768cffaf33812403f45c" name="aca973fa2125f768cffaf33812403f45c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca973fa2125f768cffaf33812403f45c">&#9670;&nbsp;</a></span>JOIN_PARAMS</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::string platoon_strategic_ihp::PlatoonStrategicIHPPlugin::JOIN_PARAMS = &quot;SIZE:%1%,SPEED:%2%,ECEFX:%3%,ECEFY:%4%,ECEFZ:%5%,JOINIDX:%6%&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >index = 0, SIZE, number of members. index = 1, SPEED, in m/s. index = 2, ECEFX, in cm. index = 3, ECEFY, in cm. index = 4, ECEFZ, in cm. index = 5, JOINIDX, index of the position in platoon the incoming vehicle tries to join note: The cut-in index is zero-based and points to the gap-leading vehicle's index. eg: for rear join, cut-in index == platoon.size()-1; for join from front, index == -1; for cut-in in middle, index indicate the gap leading vehicle's index. </p>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8h_source.html#l00858">858</a> of file <a class="el" href="platoon__strategic__ihp_8h_source.html">platoon_strategic_ihp.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00954">mob_op_cb_leader()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01244">mob_op_cb_preparetojoin()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01870">mob_req_cb_leadwithoperation()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02455">mob_resp_cb_preparetojoin()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02822">run_leader_aborting()</a>, and <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02977">run_prepare_to_join()</a>.</p>

</div>
</div>
<a id="ac658e41124dccaeb3b7fbbc3b8d82de7" name="ac658e41124dccaeb3b7fbbc3b8d82de7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac658e41124dccaeb3b7fbbc3b8d82de7">&#9670;&nbsp;</a></span>LANE_CHANGE_TIMEOUT</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned long platoon_strategic_ihp::PlatoonStrategicIHPPlugin::LANE_CHANGE_TIMEOUT = 300000</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8h_source.html#l00795">795</a> of file <a class="el" href="platoon__strategic__ihp_8h_source.html">platoon_strategic_ihp.h</a>.</p>

</div>
</div>
<a id="a5873cf01d465c147622626e13bed7df1" name="a5873cf01d465c147622626e13bed7df1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5873cf01d465c147622626e13bed7df1">&#9670;&nbsp;</a></span>LEADER_TIMEOUT_COUNTER_LIMIT</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classint.html">int</a> platoon_strategic_ihp::PlatoonStrategicIHPPlugin::LEADER_TIMEOUT_COUNTER_LIMIT = 5</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8h_source.html#l00797">797</a> of file <a class="el" href="platoon__strategic__ihp_8h_source.html">platoon_strategic_ihp.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02679">run_follower()</a>.</p>

</div>
</div>
<a id="a53bebbd547236cb76e067bd5fd10d043" name="a53bebbd547236cb76e067bd5fd10d043"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53bebbd547236cb76e067bd5fd10d043">&#9670;&nbsp;</a></span>map_loaded_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> platoon_strategic_ihp::PlatoonStrategicIHPPlugin::map_loaded_ = false</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8h_source.html#l00776">776</a> of file <a class="el" href="platoon__strategic__ihp_8h_source.html">platoon_strategic_ihp.h</a>.</p>

</div>
</div>
<a id="a6aef0343096358d7180a1a301022cd9e" name="a6aef0343096358d7180a1a301022cd9e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6aef0343096358d7180a1a301022cd9e">&#9670;&nbsp;</a></span>map_projector_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_ptr&lt;lanelet::projection::LocalFrameProjector&gt; platoon_strategic_ihp::PlatoonStrategicIHPPlugin::map_projector_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8h_source.html#l00773">773</a> of file <a class="el" href="platoon__strategic__ihp_8h_source.html">platoon_strategic_ihp.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00252">ecef_to_map_point()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00266">georeference_cb()</a>, and <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00064">pose_to_ecef()</a>.</p>

</div>
</div>
<a id="a7377239fa3866dc6a2af27f2ab92e64b" name="a7377239fa3866dc6a2af27f2ab92e64b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7377239fa3866dc6a2af27f2ab92e64b">&#9670;&nbsp;</a></span>maxAllowedJoinGap_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double platoon_strategic_ihp::PlatoonStrategicIHPPlugin::maxAllowedJoinGap_ = 90</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8h_source.html#l00788">788</a> of file <a class="el" href="platoon__strategic__ihp_8h_source.html">platoon_strategic_ihp.h</a>.</p>

</div>
</div>
<a id="ad01e269fda65c87ce4ed83151fca107b" name="ad01e269fda65c87ce4ed83151fca107b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad01e269fda65c87ce4ed83151fca107b">&#9670;&nbsp;</a></span>maxAllowedJoinTimeGap_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double platoon_strategic_ihp::PlatoonStrategicIHPPlugin::maxAllowedJoinTimeGap_ = 15.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8h_source.html#l00787">787</a> of file <a class="el" href="platoon__strategic__ihp_8h_source.html">platoon_strategic_ihp.h</a>.</p>

</div>
</div>
<a id="a6d715885ecbb69b2bb8ad52347574f80" name="a6d715885ecbb69b2bb8ad52347574f80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d715885ecbb69b2bb8ad52347574f80">&#9670;&nbsp;</a></span>maxPlatoonSize_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classint.html">int</a> platoon_strategic_ihp::PlatoonStrategicIHPPlugin::maxPlatoonSize_ = 10</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8h_source.html#l00789">789</a> of file <a class="el" href="platoon__strategic__ihp_8h_source.html">platoon_strategic_ihp.h</a>.</p>

</div>
</div>
<a id="a19ea827fa9a96b9154f33d364d89260e" name="a19ea827fa9a96b9154f33d364d89260e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19ea827fa9a96b9154f33d364d89260e">&#9670;&nbsp;</a></span>mobility_operation_publisher_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceplatoon__strategic__ihp.html#a3c19ae18fa9f6083007c65b58293776a">MobilityOperationCB</a> platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mobility_operation_publisher_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8h_source.html#l00310">310</a> of file <a class="el" href="platoon__strategic__ihp_8h_source.html">platoon_strategic_ihp.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02722">run_candidate_follower()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02918">run_candidate_leader()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02679">run_follower()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02945">run_lead_with_operation()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02622">run_leader()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02822">run_leader_aborting()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02597">run_leader_waiting()</a>, and <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02977">run_prepare_to_join()</a>.</p>

</div>
</div>
<a id="ae4e916260ddb6f7eb25da13ef9cb158e" name="ae4e916260ddb6f7eb25da13ef9cb158e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4e916260ddb6f7eb25da13ef9cb158e">&#9670;&nbsp;</a></span>mobility_request_publisher_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceplatoon__strategic__ihp.html#ae866cb8846f2484b40536e455bfecaff">MobilityRequestCB</a> platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mobility_request_publisher_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8h_source.html#l00308">308</a> of file <a class="el" href="platoon__strategic__ihp_8h_source.html">platoon_strategic_ihp.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00954">mob_op_cb_leader()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01244">mob_op_cb_preparetojoin()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01870">mob_req_cb_leadwithoperation()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02455">mob_resp_cb_preparetojoin()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02722">run_candidate_follower()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02822">run_leader_aborting()</a>, and <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02977">run_prepare_to_join()</a>.</p>

</div>
</div>
<a id="a08781c935cd2c56a9f93448d7a3a96fa" name="a08781c935cd2c56a9f93448d7a3a96fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08781c935cd2c56a9f93448d7a3a96fa">&#9670;&nbsp;</a></span>mobility_response_publisher_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceplatoon__strategic__ihp.html#a71d95090a6e2bf7ed0b85142e9081f97">MobilityResponseCB</a> platoon_strategic_ihp::PlatoonStrategicIHPPlugin::mobility_response_publisher_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8h_source.html#l00309">309</a> of file <a class="el" href="platoon__strategic__ihp_8h_source.html">platoon_strategic_ihp.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02551">mob_req_cb()</a>.</p>

</div>
</div>
<a id="aef3664c4c7ac360846defce18161e92b" name="aef3664c4c7ac360846defce18161e92b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef3664c4c7ac360846defce18161e92b">&#9670;&nbsp;</a></span>NEGOTIATION_TIMEOUT</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned long platoon_strategic_ihp::PlatoonStrategicIHPPlugin::NEGOTIATION_TIMEOUT = 15000</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8h_source.html#l00794">794</a> of file <a class="el" href="platoon__strategic__ihp_8h_source.html">platoon_strategic_ihp.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02722">run_candidate_follower()</a>, and <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02622">run_leader()</a>.</p>

</div>
</div>
<a id="a3055c6de78415d37b56209a66c079e57" name="a3055c6de78415d37b56209a66c079e57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3055c6de78415d37b56209a66c079e57">&#9670;&nbsp;</a></span>noLeaderUpdatesCounter</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classint.html">int</a> platoon_strategic_ihp::PlatoonStrategicIHPPlugin::noLeaderUpdatesCounter = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8h_source.html#l00796">796</a> of file <a class="el" href="platoon__strategic__ihp_8h_source.html">platoon_strategic_ihp.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02679">run_follower()</a>.</p>

</div>
</div>
<a id="a50637636926375340be2ba15d016b06a" name="a50637636926375340be2ba15d016b06a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50637636926375340be2ba15d016b06a">&#9670;&nbsp;</a></span>numLeaderAbortingCalls_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classint.html">int</a> platoon_strategic_ihp::PlatoonStrategicIHPPlugin::numLeaderAbortingCalls_ = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8h_source.html#l00782">782</a> of file <a class="el" href="platoon__strategic__ihp_8h_source.html">platoon_strategic_ihp.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02362">mob_resp_cb_leaderaborting()</a>, and <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02822">run_leader_aborting()</a>.</p>

</div>
</div>
<a id="a31600df15338eab670b092e3ee34a898" name="a31600df15338eab670b092e3ee34a898"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31600df15338eab670b092e3ee34a898">&#9670;&nbsp;</a></span>OPERATION_INFO_PARAMS</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::string platoon_strategic_ihp::PlatoonStrategicIHPPlugin::OPERATION_INFO_PARAMS = &quot;INFO|LENGTH:%.2f,SPEED:%.2f,SIZE:%d,ECEFX:%.2f,ECEFY:%.2f,ECEFZ:%.2f&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >index = 0, LENGTH, physical length of the platoon, in m. index = 1, SPEED, in m/s. index = 2, SIZE, number of members. index = 3, ECEFX, in cm. index = 4, ECEFY, in cm. index = 5, ECEFZ, in cm. </p>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8h_source.html#l00833">833</a> of file <a class="el" href="platoon__strategic__ihp_8h_source.html">platoon_strategic_ihp.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00314">composeMobilityOperationINFO()</a>.</p>

</div>
</div>
<a id="a56907ad89ed257fc81cbb7faf4221005" name="a56907ad89ed257fc81cbb7faf4221005"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56907ad89ed257fc81cbb7faf4221005">&#9670;&nbsp;</a></span>OPERATION_INFO_TYPE</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::string platoon_strategic_ihp::PlatoonStrategicIHPPlugin::OPERATION_INFO_TYPE = &quot;INFO&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8h_source.html#l00821">821</a> of file <a class="el" href="platoon__strategic__ihp_8h_source.html">platoon_strategic_ihp.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00558">composeMobilityOperationLeader()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00646">composeMobilityOperationLeadWithOperation()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00809">mob_op_cb()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00954">mob_op_cb_leader()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01244">mob_op_cb_preparetojoin()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02945">run_lead_with_operation()</a>, and <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02622">run_leader()</a>.</p>

</div>
</div>
<a id="ac80b2f23cf6b860b8cad5c5b6f7a120b" name="ac80b2f23cf6b860b8cad5c5b6f7a120b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac80b2f23cf6b860b8cad5c5b6f7a120b">&#9670;&nbsp;</a></span>OPERATION_STATUS_PARAMS</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::string platoon_strategic_ihp::PlatoonStrategicIHPPlugin::OPERATION_STATUS_PARAMS = &quot;STATUS|CMDSPEED:%1%,SPEED:%2%,ECEFX:%3%,ECEFY:%4%,ECEFZ:%5%&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >index = 0, CMDSPEED, in m/s. index = 1, SPEED, in m/s. index = 2, ECEFX, in cm. index = 3, ECEFY, in cm. index = 4, ECEFZ, in cm. </p>

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8h_source.html#l00842">842</a> of file <a class="el" href="platoon__strategic__ihp_8h_source.html">platoon_strategic_ihp.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00277">composeMobilityOperationSTATUS()</a>.</p>

</div>
</div>
<a id="a243c9d3b652447765feab04517074520" name="a243c9d3b652447765feab04517074520"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a243c9d3b652447765feab04517074520">&#9670;&nbsp;</a></span>OPERATION_STATUS_TYPE</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::string platoon_strategic_ihp::PlatoonStrategicIHPPlugin::OPERATION_STATUS_TYPE = &quot;STATUS&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8h_source.html#l00822">822</a> of file <a class="el" href="platoon__strategic__ihp_8h_source.html">platoon_strategic_ihp.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00558">composeMobilityOperationLeader()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00646">composeMobilityOperationLeadWithOperation()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00809">mob_op_cb()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00708">mob_op_cb_STATUS()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02945">run_lead_with_operation()</a>, and <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02622">run_leader()</a>.</p>

</div>
</div>
<a id="ac4431eacf32294f2c7d2617936e2864c" name="ac4431eacf32294f2c7d2617936e2864c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4431eacf32294f2c7d2617936e2864c">&#9670;&nbsp;</a></span>platooning_info_publisher_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceplatoon__strategic__ihp.html#a5402323f00d5763553277415c786fbca">PlatooningInfoCB</a> platoon_strategic_ihp::PlatoonStrategicIHPPlugin::platooning_info_publisher_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8h_source.html#l00311">311</a> of file <a class="el" href="platoon__strategic__ihp_8h_source.html">platoon_strategic_ihp.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l03060">onSpin()</a>.</p>

</div>
</div>
<a id="a3be0b52376b568130c1c6a5ec5adeb13" name="a3be0b52376b568130c1c6a5ec5adeb13"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3be0b52376b568130c1c6a5ec5adeb13">&#9670;&nbsp;</a></span>PLATOONING_STRATEGY</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::string platoon_strategic_ihp::PlatoonStrategicIHPPlugin::PLATOONING_STRATEGY = &quot;Carma/Platooning&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8h_source.html#l00820">820</a> of file <a class="el" href="platoon__strategic__ihp_8h_source.html">platoon_strategic_ihp.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00314">composeMobilityOperationINFO()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00277">composeMobilityOperationSTATUS()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01354">handle_mob_req()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00809">mob_op_cb()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00954">mob_op_cb_leader()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01244">mob_op_cb_preparetojoin()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02551">mob_req_cb()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01870">mob_req_cb_leadwithoperation()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02455">mob_resp_cb_preparetojoin()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02722">run_candidate_follower()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02822">run_leader_aborting()</a>, and <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02977">run_prepare_to_join()</a>.</p>

</div>
</div>
<a id="a6b29a328e494534efda340274fb2bef9" name="a6b29a328e494534efda340274fb2bef9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b29a328e494534efda340274fb2bef9">&#9670;&nbsp;</a></span>plugin_discovery_msg_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">carma_planning_msgs::msg::Plugin platoon_strategic_ihp::PlatoonStrategicIHPPlugin::plugin_discovery_msg_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8h_source.html#l00779">779</a> of file <a class="el" href="platoon__strategic__ihp_8h_source.html">platoon_strategic_ihp.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00036">PlatoonStrategicIHPPlugin()</a>.</p>

</div>
</div>
<a id="adb546b690a5bbb1ad31d02fc6341734f" name="adb546b690a5bbb1ad31d02fc6341734f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb546b690a5bbb1ad31d02fc6341734f">&#9670;&nbsp;</a></span>pm_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonManager.html">PlatoonManager</a> platoon_strategic_ihp::PlatoonStrategicIHPPlugin::pm_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8h_source.html#l00817">817</a> of file <a class="el" href="platoon__strategic__ihp_8h_source.html">platoon_strategic_ihp.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00036">PlatoonStrategicIHPPlugin()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00314">composeMobilityOperationINFO()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00277">composeMobilityOperationSTATUS()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00419">composePlatoonInfoMsg()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00097">getHostPM()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01354">handle_mob_req()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00353">isJoiningVehicleNearPlatoon()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00809">mob_op_cb()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00954">mob_op_cb_leader()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01244">mob_op_cb_preparetojoin()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00708">mob_op_cb_STATUS()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01827">mob_req_cb_candidateleader()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01428">mob_req_cb_follower()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01571">mob_req_cb_leader()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01510">mob_req_cb_leaderwaiting()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01870">mob_req_cb_leadwithoperation()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02077">mob_resp_cb()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02146">mob_resp_cb_candidatefollower()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02220">mob_resp_cb_follower()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02256">mob_resp_cb_leader()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02362">mob_resp_cb_leaderaborting()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02455">mob_resp_cb_preparetojoin()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l03060">onSpin()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l03221">plan_maneuver_cb()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00115">pose_cb()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02722">run_candidate_follower()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02918">run_candidate_leader()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02679">run_follower()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02945">run_lead_with_operation()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02622">run_leader()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02822">run_leader_aborting()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02597">run_leader_waiting()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02977">run_prepare_to_join()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00103">setPMState()</a>, and <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00109">updatePlatoonList()</a>.</p>

</div>
</div>
<a id="ad10e1df213ec7524892b247d28ec9172" name="ad10e1df213ec7524892b247d28ec9172"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad10e1df213ec7524892b247d28ec9172">&#9670;&nbsp;</a></span>pose_ecef_point_</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">carma_v2x_msgs::msg::LocationECEF platoon_strategic_ihp::PlatoonStrategicIHPPlugin::pose_ecef_point_</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8h_source.html#l00257">257</a> of file <a class="el" href="platoon__strategic__ihp_8h_source.html">platoon_strategic_ihp.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00314">composeMobilityOperationINFO()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00277">composeMobilityOperationSTATUS()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00954">mob_op_cb_leader()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01244">mob_op_cb_preparetojoin()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01870">mob_req_cb_leadwithoperation()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02455">mob_resp_cb_preparetojoin()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02822">run_leader_aborting()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02977">run_prepare_to_join()</a>, and <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00090">setHostECEF()</a>.</p>

</div>
</div>
<a id="aa67d1b97f198e2f088fb24ffb8e0c690" name="aa67d1b97f198e2f088fb24ffb8e0c690"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa67d1b97f198e2f088fb24ffb8e0c690">&#9670;&nbsp;</a></span>pose_msg_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">geometry_msgs::msg::PoseStamped platoon_strategic_ihp::PlatoonStrategicIHPPlugin::pose_msg_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8h_source.html#l00322">322</a> of file <a class="el" href="platoon__strategic__ihp_8h_source.html">platoon_strategic_ihp.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00419">composePlatoonInfoMsg()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00186">findLaneWidth()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00954">mob_op_cb_leader()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01244">mob_op_cb_preparetojoin()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01870">mob_req_cb_leadwithoperation()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02455">mob_resp_cb_preparetojoin()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l03221">plan_maneuver_cb()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00115">pose_cb()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02722">run_candidate_follower()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02822">run_leader_aborting()</a>, and <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02977">run_prepare_to_join()</a>.</p>

</div>
</div>
<a id="abe7bd4e91b67d8079a51dc180bd8e5eb" name="abe7bd4e91b67d8079a51dc180bd8e5eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe7bd4e91b67d8079a51dc180bd8e5eb">&#9670;&nbsp;</a></span>prevHeartBeatTime_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned long platoon_strategic_ihp::PlatoonStrategicIHPPlugin::prevHeartBeatTime_ = 0.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8h_source.html#l00792">792</a> of file <a class="el" href="platoon__strategic__ihp_8h_source.html">platoon_strategic_ihp.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02945">run_lead_with_operation()</a>, and <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02622">run_leader()</a>.</p>

</div>
</div>
<a id="a2bc77445cdb4c025344024395fa94607" name="a2bc77445cdb4c025344024395fa94607"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2bc77445cdb4c025344024395fa94607">&#9670;&nbsp;</a></span>safeToLaneChange_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> platoon_strategic_ihp::PlatoonStrategicIHPPlugin::safeToLaneChange_ = false</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8h_source.html#l00811">811</a> of file <a class="el" href="platoon__strategic__ihp_8h_source.html">platoon_strategic_ihp.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01244">mob_op_cb_preparetojoin()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02455">mob_resp_cb_preparetojoin()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l03221">plan_maneuver_cb()</a>, and <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02977">run_prepare_to_join()</a>.</p>

</div>
</div>
<a id="ae54ec36efc19b9c2edc90148ac10b4e0" name="ae54ec36efc19b9c2edc90148ac10b4e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae54ec36efc19b9c2edc90148ac10b4e0">&#9670;&nbsp;</a></span>statusMessageInterval_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classint.html">int</a> platoon_strategic_ihp::PlatoonStrategicIHPPlugin::statusMessageInterval_ = 100</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8h_source.html#l00793">793</a> of file <a class="el" href="platoon__strategic__ihp_8h_source.html">platoon_strategic_ihp.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02722">run_candidate_follower()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02918">run_candidate_leader()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02679">run_follower()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02945">run_lead_with_operation()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02622">run_leader()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02822">run_leader_aborting()</a>, and <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02597">run_leader_waiting()</a>.</p>

</div>
</div>
<a id="ae53ddfbfa903ffe85722c9471cdfd3af" name="ae53ddfbfa903ffe85722c9471cdfd3af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae53ddfbfa903ffe85722c9471cdfd3af">&#9670;&nbsp;</a></span>STOPPED_SPEED</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const double platoon_strategic_ihp::PlatoonStrategicIHPPlugin::STOPPED_SPEED = 0.5</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8h_source.html#l00805">805</a> of file <a class="el" href="platoon__strategic__ihp_8h_source.html">platoon_strategic_ihp.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00809">mob_op_cb()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02622">run_leader()</a>, and <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00143">twist_cb()</a>.</p>

</div>
</div>
<a id="ab2fa1a4b839a90fee186cc921a5360ab" name="ab2fa1a4b839a90fee186cc921a5360ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2fa1a4b839a90fee186cc921a5360ab">&#9670;&nbsp;</a></span>target_cutin_pose_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">lanelet::BasicPoint2d platoon_strategic_ihp::PlatoonStrategicIHPPlugin::target_cutin_pose_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8h_source.html#l00802">802</a> of file <a class="el" href="platoon__strategic__ihp_8h_source.html">platoon_strategic_ihp.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00954">mob_op_cb_leader()</a>, and <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l03221">plan_maneuver_cb()</a>.</p>

</div>
</div>
<a id="a94ef4b19b4e5f6befabedd4b14908bdd" name="a94ef4b19b4e5f6befabedd4b14908bdd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94ef4b19b4e5f6befabedd4b14908bdd">&#9670;&nbsp;</a></span>target_join_index_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classint.html">int</a> platoon_strategic_ihp::PlatoonStrategicIHPPlugin::target_join_index_ = -2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8h_source.html#l00808">808</a> of file <a class="el" href="platoon__strategic__ihp_8h_source.html">platoon_strategic_ihp.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01244">mob_op_cb_preparetojoin()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02455">mob_resp_cb_preparetojoin()</a>, and <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02977">run_prepare_to_join()</a>.</p>

</div>
</div>
<a id="a283186f2bbb98f5f85b5486e365bb4b8" name="a283186f2bbb98f5f85b5486e365bb4b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a283186f2bbb98f5f85b5486e365bb4b8">&#9670;&nbsp;</a></span>timer_factory_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_ptr&lt;carma_ros2_utils::timers::TimerFactory&gt; platoon_strategic_ihp::PlatoonStrategicIHPPlugin::timer_factory_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8h_source.html#l00814">814</a> of file <a class="el" href="platoon__strategic__ihp_8h_source.html">platoon_strategic_ihp.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00036">PlatoonStrategicIHPPlugin()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00314">composeMobilityOperationINFO()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00277">composeMobilityOperationSTATUS()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00954">mob_op_cb_leader()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01244">mob_op_cb_preparetojoin()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02551">mob_req_cb()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01571">mob_req_cb_leader()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01870">mob_req_cb_leadwithoperation()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02220">mob_resp_cb_follower()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02256">mob_resp_cb_leader()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02455">mob_resp_cb_preparetojoin()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l03221">plan_maneuver_cb()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02722">run_candidate_follower()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02918">run_candidate_leader()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02679">run_follower()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02945">run_lead_with_operation()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02622">run_leader()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02822">run_leader_aborting()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02597">run_leader_waiting()</a>, and <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02977">run_prepare_to_join()</a>.</p>

</div>
</div>
<a id="a5129374153987c3ce12f031cd4316119" name="a5129374153987c3ce12f031cd4316119"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5129374153987c3ce12f031cd4316119">&#9670;&nbsp;</a></span>vehicleLength_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double platoon_strategic_ihp::PlatoonStrategicIHPPlugin::vehicleLength_ = 5.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8h_source.html#l00790">790</a> of file <a class="el" href="platoon__strategic__ihp_8h_source.html">platoon_strategic_ihp.h</a>.</p>

</div>
</div>
<a id="a935cc1406e4a80f9f44669167e43f815" name="a935cc1406e4a80f9f44669167e43f815"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a935cc1406e4a80f9f44669167e43f815">&#9670;&nbsp;</a></span>waitingStartTime</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">long platoon_strategic_ihp::PlatoonStrategicIHPPlugin::waitingStartTime = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8h_source.html#l00334">334</a> of file <a class="el" href="platoon__strategic__ihp_8h_source.html">platoon_strategic_ihp.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01571">mob_req_cb_leader()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01870">mob_req_cb_leadwithoperation()</a>, and <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02597">run_leader_waiting()</a>.</p>

</div>
</div>
<a id="a5bb0123eb1a68e83b1a424eeb94f0929" name="a5bb0123eb1a68e83b1a424eeb94f0929"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5bb0123eb1a68e83b1a424eeb94f0929">&#9670;&nbsp;</a></span>waitingStateTimeout</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double platoon_strategic_ihp::PlatoonStrategicIHPPlugin::waitingStateTimeout = 25.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8h_source.html#l00798">798</a> of file <a class="el" href="platoon__strategic__ihp_8h_source.html">platoon_strategic_ihp.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02722">run_candidate_follower()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02918">run_candidate_leader()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02822">run_leader_aborting()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02597">run_leader_waiting()</a>, and <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l02977">run_prepare_to_join()</a>.</p>

</div>
</div>
<a id="ae65a18d1f14ecdfae3409e47e59a1031" name="ae65a18d1f14ecdfae3409e47e59a1031"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae65a18d1f14ecdfae3409e47e59a1031">&#9670;&nbsp;</a></span>wm_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacecarma__wm.html#a3ac653959e0b6198cae274d68b343228">carma_wm::WorldModelConstPtr</a> platoon_strategic_ihp::PlatoonStrategicIHPPlugin::wm_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="platoon__strategic__ihp_8h_source.html#l00315">315</a> of file <a class="el" href="platoon__strategic__ihp_8h_source.html">platoon_strategic_ihp.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l03122">composeManeuverMessage()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00419">composePlatoonInfoMsg()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00186">findLaneWidth()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00166">findSpeedLimit()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l03472">is_lanechange_possible()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00954">mob_op_cb_leader()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01244">mob_op_cb_preparetojoin()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00708">mob_op_cb_STATUS()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01827">mob_req_cb_candidateleader()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01571">mob_req_cb_leader()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01510">mob_req_cb_leaderwaiting()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l01870">mob_req_cb_leadwithoperation()</a>, <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l03221">plan_maneuver_cb()</a>, and <a class="el" href="platoon__strategic__ihp_8cpp_source.html#l00115">pose_cb()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>platooning_strategic_IHP/include/platoon_strategic_ihp/<a class="el" href="platoon__strategic__ihp_8h_source.html">platoon_strategic_ihp.h</a></li>
<li>platooning_strategic_IHP/src/<a class="el" href="platoon__strategic__ihp_8cpp_source.html">platoon_strategic_ihp.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceplatoon__strategic__ihp.html">platoon_strategic_ihp</a></li><li class="navelem"><a class="el" href="classplatoon__strategic__ihp_1_1PlatoonStrategicIHPPlugin.html">PlatoonStrategicIHPPlugin</a></li>
    <li class="footer">Generated on Wed Jun 7 2023 10:29:06 for Carma-platform by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4 </li>
  </ul>
</div>
</body>
</html>
