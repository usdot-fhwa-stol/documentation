<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Carma-platform: yield_plugin::YieldPlugin Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Carma-platform<span id="projectnumber">&#160;v4.2.0</span>
   </div>
   <div id="projectbrief">CARMA Platform is built on robot operating system (ROS) and utilizes open source software (OSS) that enables Cooperative Driving Automation (CDA) features to allow Automated Driving Systems to interact and cooperate with infrastructure and other vehicles through communication.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classyield__plugin_1_1YieldPlugin.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classyield__plugin_1_1YieldPlugin-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">yield_plugin::YieldPlugin Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Class containing primary business logic for the In-Lane Cruising Plugin.  
 <a href="classyield__plugin_1_1YieldPlugin.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="yield__plugin_8hpp_source.html">yield_plugin.hpp</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for yield_plugin::YieldPlugin:</div>
<div class="dyncontent">
<div class="center"><img src="classyield__plugin_1_1YieldPlugin__coll__graph.png" border="0" usemap="#ayield__plugin_1_1YieldPlugin_coll__map" alt="Collaboration graph"/></div>
<map name="ayield__plugin_1_1YieldPlugin_coll__map" id="ayield__plugin_1_1YieldPlugin_coll__map">
<area shape="rect" title="Class containing primary business logic for the In&#45;Lane Cruising Plugin." alt="" coords="1449,637,1655,1228"/>
<area shape="rect" title=" " alt="" coords="5,453,213,531"/>
<area shape="rect" href="structYieldPluginConfig.html" title="Stuct containing the algorithm configuration values for the YieldPluginConfig." alt="" coords="627,424,794,560"/>
<area shape="rect" title=" " alt="" coords="466,5,526,83"/>
<area shape="rect" href="classbool.html" title=" " alt="" coords="261,5,307,83"/>
<area shape="rect" title=" " alt="" coords="977,5,1031,83"/>
<area shape="rect" href="classint.html" title=" " alt="" coords="794,5,833,83"/>
<area shape="rect" title=" " alt="" coords="1163,439,1322,545"/>
<area shape="rect" title=" " alt="" coords="1347,439,1541,545"/>
<area shape="rect" title=" " alt="" coords="1566,446,1757,538"/>
<area shape="rect" title=" " alt="" coords="1781,453,1899,531"/>
<area shape="rect" title=" " alt="" coords="1923,453,1962,531"/>
<area shape="rect" title=" " alt="" coords="1986,446,2179,538"/>
<area shape="rect" title=" " alt="" coords="2204,446,2361,538"/>
<area shape="rect" title=" " alt="" coords="2386,453,2587,531"/>
<area shape="rect" title=" " alt="" coords="2612,453,2679,531"/>
<area shape="rect" title=" " alt="" coords="2702,446,2925,538"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a9277fa679e3465b090b5a8463690ed61"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classyield__plugin_1_1YieldPlugin.html#a9277fa679e3465b090b5a8463690ed61">YieldPlugin</a> (std::shared_ptr&lt; carma_ros2_utils::CarmaLifecycleNode &gt; nh, <a class="el" href="namespacecarma__wm.html#a3ac653959e0b6198cae274d68b343228">carma_wm::WorldModelConstPtr</a> wm, <a class="el" href="structYieldPluginConfig.html">YieldPluginConfig</a> config, <a class="el" href="namespaceyield__plugin.html#aa28c9381b8df2f7fdf3e7870bc5c2866">MobilityResponseCB</a> mobility_response_publisher, <a class="el" href="namespaceyield__plugin.html#a508edd284962f40938944f9304e66263">LaneChangeStatusCB</a> lc_status_publisher)</td></tr>
<tr class="memdesc:a9277fa679e3465b090b5a8463690ed61"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="classyield__plugin_1_1YieldPlugin.html#a9277fa679e3465b090b5a8463690ed61">More...</a><br /></td></tr>
<tr class="separator:a9277fa679e3465b090b5a8463690ed61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0fd790e287683a2ef404e16a15e0ea29"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classyield__plugin_1_1YieldPlugin.html#a0fd790e287683a2ef404e16a15e0ea29">plan_trajectory_callback</a> (carma_planning_msgs::srv::PlanTrajectory::Request::SharedPtr req, carma_planning_msgs::srv::PlanTrajectory::Response::SharedPtr resp)</td></tr>
<tr class="memdesc:a0fd790e287683a2ef404e16a15e0ea29"><td class="mdescLeft">&#160;</td><td class="mdescRight">Service callback for trajectory planning.  <a href="classyield__plugin_1_1YieldPlugin.html#a0fd790e287683a2ef404e16a15e0ea29">More...</a><br /></td></tr>
<tr class="separator:a0fd790e287683a2ef404e16a15e0ea29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1c423b99887ccbf945a86da7b7809f6"><td class="memItemLeft" align="right" valign="top">carma_planning_msgs::msg::TrajectoryPlan&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classyield__plugin_1_1YieldPlugin.html#ac1c423b99887ccbf945a86da7b7809f6">update_traj_for_object</a> (const carma_planning_msgs::msg::TrajectoryPlan &amp;original_tp, const std::vector&lt; carma_perception_msgs::msg::ExternalObject &gt; &amp;external_objects, double initial_velocity)</td></tr>
<tr class="memdesc:ac1c423b99887ccbf945a86da7b7809f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">trajectory is modified to safely avoid obstacles on the road  <a href="classyield__plugin_1_1YieldPlugin.html#ac1c423b99887ccbf945a86da7b7809f6">More...</a><br /></td></tr>
<tr class="separator:ac1c423b99887ccbf945a86da7b7809f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7ffd46ccbae6de4b60a7f49a8cfa3d6"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classyield__plugin_1_1YieldPlugin.html#ae7ffd46ccbae6de4b60a7f49a8cfa3d6">polynomial_calc</a> (std::vector&lt; double &gt; coeff, double x) const</td></tr>
<tr class="memdesc:ae7ffd46ccbae6de4b60a7f49a8cfa3d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculate quintic polynomial equation for a given x  <a href="classyield__plugin_1_1YieldPlugin.html#ae7ffd46ccbae6de4b60a7f49a8cfa3d6">More...</a><br /></td></tr>
<tr class="separator:ae7ffd46ccbae6de4b60a7f49a8cfa3d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afeab08ed138eafe6e24abd775c3163dd"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classyield__plugin_1_1YieldPlugin.html#afeab08ed138eafe6e24abd775c3163dd">polynomial_calc_d</a> (std::vector&lt; double &gt; coeff, double x) const</td></tr>
<tr class="memdesc:afeab08ed138eafe6e24abd775c3163dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculate derivative of quintic polynomial equation for a given x  <a href="classyield__plugin_1_1YieldPlugin.html#afeab08ed138eafe6e24abd775c3163dd">More...</a><br /></td></tr>
<tr class="separator:afeab08ed138eafe6e24abd775c3163dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae53a42abb996d38cf701a3fba7e473f8"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classyield__plugin_1_1YieldPlugin.html#ae53a42abb996d38cf701a3fba7e473f8">max_trajectory_speed</a> (const std::vector&lt; carma_planning_msgs::msg::TrajectoryPlanPoint &gt; &amp;trajectory_points, double timestamp_in_sec_to_search_until) const</td></tr>
<tr class="memdesc:ae53a42abb996d38cf701a3fba7e473f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculates the maximum speed in a set of tajectory points  <a href="classyield__plugin_1_1YieldPlugin.html#ae53a42abb996d38cf701a3fba7e473f8">More...</a><br /></td></tr>
<tr class="separator:ae53a42abb996d38cf701a3fba7e473f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1bc011c9c2db48289bf40214d972cec4"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classyield__plugin_1_1YieldPlugin.html#a1bc011c9c2db48289bf40214d972cec4">get_relative_downtracks</a> (const carma_planning_msgs::msg::TrajectoryPlan &amp;trajectory_plan) const</td></tr>
<tr class="memdesc:a1bc011c9c2db48289bf40214d972cec4"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculates distance between trajectory points in a plan  <a href="classyield__plugin_1_1YieldPlugin.html#a1bc011c9c2db48289bf40214d972cec4">More...</a><br /></td></tr>
<tr class="separator:a1bc011c9c2db48289bf40214d972cec4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3276c693a65319e769e63078284d3056"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classyield__plugin_1_1YieldPlugin.html#a3276c693a65319e769e63078284d3056">mobilityrequest_cb</a> (const carma_v2x_msgs::msg::MobilityRequest::UniquePtr msg)</td></tr>
<tr class="memdesc:a3276c693a65319e769e63078284d3056"><td class="mdescLeft">&#160;</td><td class="mdescRight">callback for mobility request  <a href="classyield__plugin_1_1YieldPlugin.html#a3276c693a65319e769e63078284d3056">More...</a><br /></td></tr>
<tr class="separator:a3276c693a65319e769e63078284d3056"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b2ee0cdcba01c2df0f1d9df679424f8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classyield__plugin_1_1YieldPlugin.html#a7b2ee0cdcba01c2df0f1d9df679424f8">bsm_cb</a> (const carma_v2x_msgs::msg::BSM::UniquePtr msg)</td></tr>
<tr class="memdesc:a7b2ee0cdcba01c2df0f1d9df679424f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">callback for bsm message  <a href="classyield__plugin_1_1YieldPlugin.html#a7b2ee0cdcba01c2df0f1d9df679424f8">More...</a><br /></td></tr>
<tr class="separator:a7b2ee0cdcba01c2df0f1d9df679424f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5255e398082083d48e7b07054f82fad8"><td class="memItemLeft" align="right" valign="top">std::vector&lt; lanelet::BasicPoint2d &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classyield__plugin_1_1YieldPlugin.html#a5255e398082083d48e7b07054f82fad8">convert_eceftrajectory_to_mappoints</a> (const carma_v2x_msgs::msg::Trajectory &amp;ecef_trajectory) const</td></tr>
<tr class="memdesc:a5255e398082083d48e7b07054f82fad8"><td class="mdescLeft">&#160;</td><td class="mdescRight">convert a carma trajectory from ecef frame to map frame ecef trajectory consists of the point and a set of offsets with reference to the point  <a href="classyield__plugin_1_1YieldPlugin.html#a5255e398082083d48e7b07054f82fad8">More...</a><br /></td></tr>
<tr class="separator:a5255e398082083d48e7b07054f82fad8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0b6fb988e61ce2cfb04c4a1f33070d5"><td class="memItemLeft" align="right" valign="top">lanelet::BasicPoint2d&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classyield__plugin_1_1YieldPlugin.html#ac0b6fb988e61ce2cfb04c4a1f33070d5">ecef_to_map_point</a> (const carma_v2x_msgs::msg::LocationECEF &amp;ecef_point) const</td></tr>
<tr class="memdesc:ac0b6fb988e61ce2cfb04c4a1f33070d5"><td class="mdescLeft">&#160;</td><td class="mdescRight">convert a point in ecef frame (in cm) into map frame (in meters)  <a href="classyield__plugin_1_1YieldPlugin.html#ac0b6fb988e61ce2cfb04c4a1f33070d5">More...</a><br /></td></tr>
<tr class="separator:ac0b6fb988e61ce2cfb04c4a1f33070d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf45eb277044353dbb87226f0bec3f06"><td class="memItemLeft" align="right" valign="top">carma_v2x_msgs::msg::MobilityResponse&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classyield__plugin_1_1YieldPlugin.html#acf45eb277044353dbb87226f0bec3f06">compose_mobility_response</a> (const std::string &amp;resp_recipient_id, const std::string &amp;req_plan_id, <a class="el" href="classbool.html">bool</a> response) const</td></tr>
<tr class="memdesc:acf45eb277044353dbb87226f0bec3f06"><td class="mdescLeft">&#160;</td><td class="mdescRight">compose a mobility response message  <a href="classyield__plugin_1_1YieldPlugin.html#acf45eb277044353dbb87226f0bec3f06">More...</a><br /></td></tr>
<tr class="separator:acf45eb277044353dbb87226f0bec3f06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace53f1895cbbf2a5f109cbfc11d6313f"><td class="memItemLeft" align="right" valign="top">carma_planning_msgs::msg::TrajectoryPlan&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classyield__plugin_1_1YieldPlugin.html#ace53f1895cbbf2a5f109cbfc11d6313f">generate_JMT_trajectory</a> (const carma_planning_msgs::msg::TrajectoryPlan &amp;original_tp, double initial_pos, double goal_pos, double initial_velocity, double goal_velocity, double planning_time, double original_max_speed)</td></tr>
<tr class="memdesc:ace53f1895cbbf2a5f109cbfc11d6313f"><td class="mdescLeft">&#160;</td><td class="mdescRight">generate a Jerk Minimizing Trajectory(JMT) with the provided start and end conditions  <a href="classyield__plugin_1_1YieldPlugin.html#ace53f1895cbbf2a5f109cbfc11d6313f">More...</a><br /></td></tr>
<tr class="separator:ace53f1895cbbf2a5f109cbfc11d6313f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9c9e0e4278774a519de12a6a5f4398f"><td class="memItemLeft" align="right" valign="top">carma_planning_msgs::msg::TrajectoryPlan&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classyield__plugin_1_1YieldPlugin.html#ad9c9e0e4278774a519de12a6a5f4398f">update_traj_for_cooperative_behavior</a> (const carma_planning_msgs::msg::TrajectoryPlan &amp;original_tp, double current_speed)</td></tr>
<tr class="memdesc:ad9c9e0e4278774a519de12a6a5f4398f"><td class="mdescLeft">&#160;</td><td class="mdescRight">update trajectory for yielding to an incoming cooperative behavior  <a href="classyield__plugin_1_1YieldPlugin.html#ad9c9e0e4278774a519de12a6a5f4398f">More...</a><br /></td></tr>
<tr class="separator:ad9c9e0e4278774a519de12a6a5f4398f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb40cf8a08a75c472791dbd91b99d8dc"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::pair&lt; <a class="el" href="classint.html">int</a>, lanelet::BasicPoint2d &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classyield__plugin_1_1YieldPlugin.html#abb40cf8a08a75c472791dbd91b99d8dc">detect_trajectories_intersection</a> (std::vector&lt; lanelet::BasicPoint2d &gt; self_trajectory, std::vector&lt; lanelet::BasicPoint2d &gt; incoming_trajectory) const</td></tr>
<tr class="memdesc:abb40cf8a08a75c472791dbd91b99d8dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">detect intersection point(s) of two trajectories  <a href="classyield__plugin_1_1YieldPlugin.html#abb40cf8a08a75c472791dbd91b99d8dc">More...</a><br /></td></tr>
<tr class="separator:abb40cf8a08a75c472791dbd91b99d8dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2def22504a4972db1994e96033e76ee9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classyield__plugin_1_1YieldPlugin.html#a2def22504a4972db1994e96033e76ee9">set_incoming_request_info</a> (std::vector&lt; lanelet::BasicPoint2d &gt; req_trajectory, double req_speed, double req_planning_time, double req_timestamp)</td></tr>
<tr class="memdesc:a2def22504a4972db1994e96033e76ee9"><td class="mdescLeft">&#160;</td><td class="mdescRight">set values for member variables related to cooperative behavior  <a href="classyield__plugin_1_1YieldPlugin.html#a2def22504a4972db1994e96033e76ee9">More...</a><br /></td></tr>
<tr class="separator:a2def22504a4972db1994e96033e76ee9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d6134d7e7b29394a68a43207f5cb1bc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classyield__plugin_1_1YieldPlugin.html#a5d6134d7e7b29394a68a43207f5cb1bc">lookup_ecef_to_map_transform</a> ()</td></tr>
<tr class="memdesc:a5d6134d7e7b29394a68a43207f5cb1bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Looks up the transform between map and earth frames, and sets the member variable.  <a href="classyield__plugin_1_1YieldPlugin.html#a5d6134d7e7b29394a68a43207f5cb1bc">More...</a><br /></td></tr>
<tr class="separator:a5d6134d7e7b29394a68a43207f5cb1bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3703b49299aa6b61b3889a8e6799ac74"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classyield__plugin_1_1YieldPlugin.html#a3703b49299aa6b61b3889a8e6799ac74">check_traj_for_digital_min_gap</a> (const carma_planning_msgs::msg::TrajectoryPlan &amp;original_tp) const</td></tr>
<tr class="memdesc:a3703b49299aa6b61b3889a8e6799ac74"><td class="mdescLeft">&#160;</td><td class="mdescRight">checks trajectory for minimum gap associated with it  <a href="classyield__plugin_1_1YieldPlugin.html#a3703b49299aa6b61b3889a8e6799ac74">More...</a><br /></td></tr>
<tr class="separator:a3703b49299aa6b61b3889a8e6799ac74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4176fb6da1156062d1ff412016fe86e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classyield__plugin_1_1YieldPlugin.html#aa4176fb6da1156062d1ff412016fe86e">set_georeference_string</a> (const std::string &amp;georeference)</td></tr>
<tr class="memdesc:aa4176fb6da1156062d1ff412016fe86e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Setter for map projection string to define lat/lon -&gt; map conversion.  <a href="classyield__plugin_1_1YieldPlugin.html#aa4176fb6da1156062d1ff412016fe86e">More...</a><br /></td></tr>
<tr class="separator:aa4176fb6da1156062d1ff412016fe86e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d1efa9eb3ded474b8ec28d1c63b1eef"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classyield__plugin_1_1YieldPlugin.html#a8d1efa9eb3ded474b8ec28d1c63b1eef">set_external_objects</a> (const std::vector&lt; carma_perception_msgs::msg::ExternalObject &gt; &amp;object_list)</td></tr>
<tr class="memdesc:a8d1efa9eb3ded474b8ec28d1c63b1eef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Setter for external objects with predictions in the environment.  <a href="classyield__plugin_1_1YieldPlugin.html#a8d1efa9eb3ded474b8ec28d1c63b1eef">More...</a><br /></td></tr>
<tr class="separator:a8d1efa9eb3ded474b8ec28d1c63b1eef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab60b2f939cebede3a6d9a3ae5529b0d9"><td class="memItemLeft" align="right" valign="top">std::optional&lt; <a class="el" href="structyield__plugin_1_1GetCollisionResult.html">GetCollisionResult</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classyield__plugin_1_1YieldPlugin.html#ab60b2f939cebede3a6d9a3ae5529b0d9">get_collision</a> (const carma_planning_msgs::msg::TrajectoryPlan &amp;trajectory1, const std::vector&lt; carma_perception_msgs::msg::PredictedState &gt; &amp;trajectory2, double collision_radius, double trajectory1_max_speed)</td></tr>
<tr class="memdesc:ab60b2f939cebede3a6d9a3ae5529b0d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return naive collision time and locations based on collision radius given two trajectories with one being obstacle's predicted steps.  <a href="classyield__plugin_1_1YieldPlugin.html#ab60b2f939cebede3a6d9a3ae5529b0d9">More...</a><br /></td></tr>
<tr class="separator:ab60b2f939cebede3a6d9a3ae5529b0d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5644e9f63528efc0484b875c7debef01"><td class="memItemLeft" align="right" valign="top">std::optional&lt; rclcpp::Time &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classyield__plugin_1_1YieldPlugin.html#a5644e9f63528efc0484b875c7debef01">get_collision_time</a> (const carma_planning_msgs::msg::TrajectoryPlan &amp;original_tp, const carma_perception_msgs::msg::ExternalObject &amp;curr_obstacle, double original_tp_max_speed)</td></tr>
<tr class="memdesc:a5644e9f63528efc0484b875c7debef01"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return collision time given two trajectories with one being external object with predicted steps.  <a href="classyield__plugin_1_1YieldPlugin.html#a5644e9f63528efc0484b875c7debef01">More...</a><br /></td></tr>
<tr class="separator:a5644e9f63528efc0484b875c7debef01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1279ff6d53eb474b635f992ed854d0b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classyield__plugin_1_1YieldPlugin.html#ae1279ff6d53eb474b635f992ed854d0b">is_object_behind_vehicle</a> (<a class="el" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> object_id, const rclcpp::Time &amp;collision_time, double vehicle_point, double object_downtrack)</td></tr>
<tr class="memdesc:ae1279ff6d53eb474b635f992ed854d0b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if object location is behind the vehicle using estimates of the vehicle's length and route downtracks.  <a href="classyield__plugin_1_1YieldPlugin.html#ae1279ff6d53eb474b635f992ed854d0b">More...</a><br /></td></tr>
<tr class="separator:ae1279ff6d53eb474b635f992ed854d0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a546149400d9d6371c5de50f229d6ecfc"><td class="memItemLeft" align="right" valign="top">std::optional&lt; std::pair&lt; carma_perception_msgs::msg::ExternalObject, double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classyield__plugin_1_1YieldPlugin.html#a546149400d9d6371c5de50f229d6ecfc">get_earliest_collision_object_and_time</a> (const carma_planning_msgs::msg::TrajectoryPlan &amp;original_tp, const std::vector&lt; carma_perception_msgs::msg::ExternalObject &gt; &amp;external_objects)</td></tr>
<tr class="memdesc:a546149400d9d6371c5de50f229d6ecfc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the earliest collision object and time of collision pair from the given trajectory and list of external objects with predicted states. Function first filters obstacles based on whether if their any of predicted state will be on the route. Only then, the logic compares trajectory and predicted states.  <a href="classyield__plugin_1_1YieldPlugin.html#a546149400d9d6371c5de50f229d6ecfc">More...</a><br /></td></tr>
<tr class="separator:a546149400d9d6371c5de50f229d6ecfc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae4fab3792eaa78de9a88299c209246d"><td class="memItemLeft" align="right" valign="top">std::unordered_map&lt; <a class="el" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>, rclcpp::Time &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classyield__plugin_1_1YieldPlugin.html#aae4fab3792eaa78de9a88299c209246d">get_collision_times_concurrently</a> (const carma_planning_msgs::msg::TrajectoryPlan &amp;original_tp, const std::vector&lt; carma_perception_msgs::msg::ExternalObject &gt; &amp;external_objects, double original_tp_max_speed)</td></tr>
<tr class="memdesc:aae4fab3792eaa78de9a88299c209246d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Given the list of objects with predicted states, get all collision times concurrently using multi-threading.  <a href="classyield__plugin_1_1YieldPlugin.html#aae4fab3792eaa78de9a88299c209246d">More...</a><br /></td></tr>
<tr class="separator:aae4fab3792eaa78de9a88299c209246d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a378558cb2b27d8337d980150543d447d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classyield__plugin_1_1YieldPlugin.html#a378558cb2b27d8337d980150543d447d">get_predicted_velocity_at_time</a> (const geometry_msgs::msg::Twist &amp;object_velocity_in_map_frame, const carma_planning_msgs::msg::TrajectoryPlan &amp;original_tp, double timestamp_in_sec_to_predict)</td></tr>
<tr class="memdesc:a378558cb2b27d8337d980150543d447d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Given the object velocity in map frame with x,y components, this function returns the projected velocity along the trajectory at given time.  <a href="classyield__plugin_1_1YieldPlugin.html#a378558cb2b27d8337d980150543d447d">More...</a><br /></td></tr>
<tr class="separator:a378558cb2b27d8337d980150543d447d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-methods" name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a852c927a6a8d94bfdbeeffcf56ba6331"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classyield__plugin_1_1YieldPlugin.html#a852c927a6a8d94bfdbeeffcf56ba6331">bsmIDtoString</a> (carma_v2x_msgs::msg::BSMCoreData bsm_core)</td></tr>
<tr class="separator:a852c927a6a8d94bfdbeeffcf56ba6331"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:aff229ed7bba2a76d0b1b99a83b9fdf88"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacecarma__wm.html#a3ac653959e0b6198cae274d68b343228">carma_wm::WorldModelConstPtr</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classyield__plugin_1_1YieldPlugin.html#aff229ed7bba2a76d0b1b99a83b9fdf88">wm_</a></td></tr>
<tr class="separator:aff229ed7bba2a76d0b1b99a83b9fdf88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1f62a493a4229d4801841eb19fb1e7d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structYieldPluginConfig.html">YieldPluginConfig</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classyield__plugin_1_1YieldPlugin.html#ab1f62a493a4229d4801841eb19fb1e7d">config_</a></td></tr>
<tr class="separator:ab1f62a493a4229d4801841eb19fb1e7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82d36ef453849014abfe64e6ecac5e58"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceyield__plugin.html#aa28c9381b8df2f7fdf3e7870bc5c2866">MobilityResponseCB</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classyield__plugin_1_1YieldPlugin.html#a82d36ef453849014abfe64e6ecac5e58">mobility_response_publisher_</a></td></tr>
<tr class="separator:a82d36ef453849014abfe64e6ecac5e58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a274208e09bc96aaef0ba731904aa57de"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceyield__plugin.html#a508edd284962f40938944f9304e66263">LaneChangeStatusCB</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classyield__plugin_1_1YieldPlugin.html#a274208e09bc96aaef0ba731904aa57de">lc_status_publisher_</a></td></tr>
<tr class="separator:a274208e09bc96aaef0ba731904aa57de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2f96dc545c04733e8ba11a6f3a0c2c6"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; carma_ros2_utils::CarmaLifecycleNode &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a></td></tr>
<tr class="separator:aa2f96dc545c04733e8ba11a6f3a0c2c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03f092d19aab7369af56f9438938d454"><td class="memItemLeft" align="right" valign="top">std::set&lt; lanelet::Id &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classyield__plugin_1_1YieldPlugin.html#a03f092d19aab7369af56f9438938d454">route_llt_ids_</a></td></tr>
<tr class="separator:a03f092d19aab7369af56f9438938d454"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0f4cfd0eb14d39203f52fa86c1bd89d"><td class="memItemLeft" align="right" valign="top">lanelet::Id&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classyield__plugin_1_1YieldPlugin.html#ae0f4cfd0eb14d39203f52fa86c1bd89d">previous_llt_id_</a></td></tr>
<tr class="separator:ae0f4cfd0eb14d39203f52fa86c1bd89d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade1ae58ef6dfc4c31025162c8c150b0a"><td class="memItemLeft" align="right" valign="top">std::vector&lt; carma_perception_msgs::msg::ExternalObject &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classyield__plugin_1_1YieldPlugin.html#ade1ae58ef6dfc4c31025162c8c150b0a">external_objects_</a></td></tr>
<tr class="separator:ade1ae58ef6dfc4c31025162c8c150b0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc6d5d9e4116d9f6ca142e5bb2fd1bc8"><td class="memItemLeft" align="right" valign="top">std::unordered_map&lt; <a class="el" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>, <a class="el" href="classint.html">int</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classyield__plugin_1_1YieldPlugin.html#adc6d5d9e4116d9f6ca142e5bb2fd1bc8">consecutive_clearance_count_for_obstacles_</a></td></tr>
<tr class="separator:adc6d5d9e4116d9f6ca142e5bb2fd1bc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad694d6ea9d5ca884e29f33a48fe19ae3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classyield__plugin_1_1YieldPlugin.html#ad694d6ea9d5ca884e29f33a48fe19ae3">cooperative_request_acceptable_</a> = false</td></tr>
<tr class="separator:ad694d6ea9d5ca884e29f33a48fe19ae3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e806b6f64d4490b88f8947d8a360491"><td class="memItemLeft" align="right" valign="top">std::vector&lt; lanelet::BasicPoint2d &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classyield__plugin_1_1YieldPlugin.html#a2e806b6f64d4490b88f8947d8a360491">req_trajectory_points_</a></td></tr>
<tr class="separator:a2e806b6f64d4490b88f8947d8a360491"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1099523a4ea8b3ecc607cf466e42162"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classyield__plugin_1_1YieldPlugin.html#ac1099523a4ea8b3ecc607cf466e42162">req_target_speed_</a> = 0</td></tr>
<tr class="separator:ac1099523a4ea8b3ecc607cf466e42162"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25b4eec8b5e4648044a4b46570cb4199"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classyield__plugin_1_1YieldPlugin.html#a25b4eec8b5e4648044a4b46570cb4199">req_timestamp_</a> = 0</td></tr>
<tr class="separator:a25b4eec8b5e4648044a4b46570cb4199"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad620a98521987c31d004b5aabbf3a620"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classyield__plugin_1_1YieldPlugin.html#ad620a98521987c31d004b5aabbf3a620">req_target_plan_time_</a> = 0</td></tr>
<tr class="separator:ad620a98521987c31d004b5aabbf3a620"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3f7420f5eccdb7f4b4ec59c7f69ec3f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classint.html">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classyield__plugin_1_1YieldPlugin.html#ae3f7420f5eccdb7f4b4ec59c7f69ec3f">timesteps_since_last_req_</a> = 0</td></tr>
<tr class="separator:ae3f7420f5eccdb7f4b4ec59c7f69ec3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae79ca3ae3dcfb369611d20ffa4ef7660"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classint.html">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classyield__plugin_1_1YieldPlugin.html#ae79ca3ae3dcfb369611d20ffa4ef7660">clc_urgency_</a> = 0</td></tr>
<tr class="separator:ae79ca3ae3dcfb369611d20ffa4ef7660"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7de1720c3d602feb197f52f6ce25fa73"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classyield__plugin_1_1YieldPlugin.html#a7de1720c3d602feb197f52f6ce25fa73">ecef_traj_timestep_</a> = 0.1</td></tr>
<tr class="separator:a7de1720c3d602feb197f52f6ce25fa73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a238b7f67b846cc65d8d55e8d3500f96c"><td class="memItemLeft" align="right" valign="top">geometry_msgs::msg::Vector3&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classyield__plugin_1_1YieldPlugin.html#a238b7f67b846cc65d8d55e8d3500f96c">host_vehicle_size</a></td></tr>
<tr class="separator:a238b7f67b846cc65d8d55e8d3500f96c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ab4d1bc8ff90e4df4b086fb7b75eb02"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classyield__plugin_1_1YieldPlugin.html#a6ab4d1bc8ff90e4df4b086fb7b75eb02">current_speed_</a></td></tr>
<tr class="separator:a6ab4d1bc8ff90e4df4b086fb7b75eb02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad25df251a12c9c052daeab2f58385c7d"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classyield__plugin_1_1YieldPlugin.html#ad25df251a12c9c052daeab2f58385c7d">host_bsm_id_</a></td></tr>
<tr class="separator:ad25df251a12c9c052daeab2f58385c7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0139ba3f27c4205d7820c5e8ed668042"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classyield__plugin_1_1YieldPlugin.html#a0139ba3f27c4205d7820c5e8ed668042">georeference_</a> {&quot;&quot;}</td></tr>
<tr class="separator:a0139ba3f27c4205d7820c5e8ed668042"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42d2a2d8a9f88afbedaa566ad57c8444"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; lanelet::projection::LocalFrameProjector &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classyield__plugin_1_1YieldPlugin.html#a42d2a2d8a9f88afbedaa566ad57c8444">map_projector_</a></td></tr>
<tr class="separator:a42d2a2d8a9f88afbedaa566ad57c8444"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Class containing primary business logic for the In-Lane Cruising Plugin. </p>

<p class="definition">Definition at line <a class="el" href="yield__plugin_8hpp_source.html#l00077">77</a> of file <a class="el" href="yield__plugin_8hpp_source.html">yield_plugin.hpp</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a9277fa679e3465b090b5a8463690ed61" name="a9277fa679e3465b090b5a8463690ed61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9277fa679e3465b090b5a8463690ed61">&#9670;&nbsp;</a></span>YieldPlugin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">yield_plugin::YieldPlugin::YieldPlugin </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; carma_ros2_utils::CarmaLifecycleNode &gt;&#160;</td>
          <td class="paramname"><em>nh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacecarma__wm.html#a3ac653959e0b6198cae274d68b343228">carma_wm::WorldModelConstPtr</a>&#160;</td>
          <td class="paramname"><em>wm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structYieldPluginConfig.html">YieldPluginConfig</a>&#160;</td>
          <td class="paramname"><em>config</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceyield__plugin.html#aa28c9381b8df2f7fdf3e7870bc5c2866">MobilityResponseCB</a>&#160;</td>
          <td class="paramname"><em>mobility_response_publisher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceyield__plugin.html#a508edd284962f40938944f9304e66263">LaneChangeStatusCB</a>&#160;</td>
          <td class="paramname"><em>lc_status_publisher</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">wm</td><td>Pointer to intialized instance of the carma world model for accessing semantic map data </td></tr>
    <tr><td class="paramname">config</td><td>The configuration to be used for this object </td></tr>
    <tr><td class="paramname">mobility_response_publisher</td><td>Callback which will publish the mobility response </td></tr>
    <tr><td class="paramname">lc_status_publisher</td><td>Callback which will publish the cooperative lane change status </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="yield__plugin_8cpp_source.html#l00045">45</a> of file <a class="el" href="yield__plugin_8cpp_source.html">yield_plugin.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   48</span>    : <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>(nh), <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aff229ed7bba2a76d0b1b99a83b9fdf88">wm_</a>(wm), <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#ab1f62a493a4229d4801841eb19fb1e7d">config_</a>(config),<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#a82d36ef453849014abfe64e6ecac5e58">mobility_response_publisher_</a>(mobility_response_publisher), <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#a274208e09bc96aaef0ba731904aa57de">lc_status_publisher_</a>(lc_status_publisher)</div>
<div class="line"><span class="lineno">   49</span>  {</div>
<div class="line"><span class="lineno">   50</span> </div>
<div class="line"><span class="lineno">   51</span>  }</div>
<div class="ttc" id="aclassyield__plugin_1_1YieldPlugin_html_a274208e09bc96aaef0ba731904aa57de"><div class="ttname"><a href="classyield__plugin_1_1YieldPlugin.html#a274208e09bc96aaef0ba731904aa57de">yield_plugin::YieldPlugin::lc_status_publisher_</a></div><div class="ttdeci">LaneChangeStatusCB lc_status_publisher_</div><div class="ttdef"><b>Definition:</b> <a href="yield__plugin_8hpp_source.html#l00314">yield_plugin.hpp:314</a></div></div>
<div class="ttc" id="aclassyield__plugin_1_1YieldPlugin_html_a82d36ef453849014abfe64e6ecac5e58"><div class="ttname"><a href="classyield__plugin_1_1YieldPlugin.html#a82d36ef453849014abfe64e6ecac5e58">yield_plugin::YieldPlugin::mobility_response_publisher_</a></div><div class="ttdeci">MobilityResponseCB mobility_response_publisher_</div><div class="ttdef"><b>Definition:</b> <a href="yield__plugin_8hpp_source.html#l00313">yield_plugin.hpp:313</a></div></div>
<div class="ttc" id="aclassyield__plugin_1_1YieldPlugin_html_aa2f96dc545c04733e8ba11a6f3a0c2c6"><div class="ttname"><a href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">yield_plugin::YieldPlugin::nh_</a></div><div class="ttdeci">std::shared_ptr&lt; carma_ros2_utils::CarmaLifecycleNode &gt; nh_</div><div class="ttdef"><b>Definition:</b> <a href="yield__plugin_8hpp_source.html#l00315">yield_plugin.hpp:315</a></div></div>
<div class="ttc" id="aclassyield__plugin_1_1YieldPlugin_html_ab1f62a493a4229d4801841eb19fb1e7d"><div class="ttname"><a href="classyield__plugin_1_1YieldPlugin.html#ab1f62a493a4229d4801841eb19fb1e7d">yield_plugin::YieldPlugin::config_</a></div><div class="ttdeci">YieldPluginConfig config_</div><div class="ttdef"><b>Definition:</b> <a href="yield__plugin_8hpp_source.html#l00312">yield_plugin.hpp:312</a></div></div>
<div class="ttc" id="aclassyield__plugin_1_1YieldPlugin_html_aff229ed7bba2a76d0b1b99a83b9fdf88"><div class="ttname"><a href="classyield__plugin_1_1YieldPlugin.html#aff229ed7bba2a76d0b1b99a83b9fdf88">yield_plugin::YieldPlugin::wm_</a></div><div class="ttdeci">carma_wm::WorldModelConstPtr wm_</div><div class="ttdef"><b>Definition:</b> <a href="yield__plugin_8hpp_source.html#l00311">yield_plugin.hpp:311</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a7b2ee0cdcba01c2df0f1d9df679424f8" name="a7b2ee0cdcba01c2df0f1d9df679424f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b2ee0cdcba01c2df0f1d9df679424f8">&#9670;&nbsp;</a></span>bsm_cb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void yield_plugin::YieldPlugin::bsm_cb </td>
          <td>(</td>
          <td class="paramtype">const carma_v2x_msgs::msg::BSM::UniquePtr&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>callback for bsm message </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>mobility bsm message </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="yield__plugin_8cpp_source.html#l00246">246</a> of file <a class="el" href="yield__plugin_8cpp_source.html">yield_plugin.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  247</span>  {</div>
<div class="line"><span class="lineno">  248</span>    carma_v2x_msgs::msg::BSMCoreData bsm_core_ = msg-&gt;core_data;</div>
<div class="line"><span class="lineno">  249</span>    <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#ad25df251a12c9c052daeab2f58385c7d">host_bsm_id_</a> = <a class="code hl_function" href="classyield__plugin_1_1YieldPlugin.html#a852c927a6a8d94bfdbeeffcf56ba6331">bsmIDtoString</a>(bsm_core_);</div>
<div class="line"><span class="lineno">  250</span>  }</div>
<div class="ttc" id="aclassyield__plugin_1_1YieldPlugin_html_a852c927a6a8d94bfdbeeffcf56ba6331"><div class="ttname"><a href="classyield__plugin_1_1YieldPlugin.html#a852c927a6a8d94bfdbeeffcf56ba6331">yield_plugin::YieldPlugin::bsmIDtoString</a></div><div class="ttdeci">std::string bsmIDtoString(carma_v2x_msgs::msg::BSMCoreData bsm_core)</div><div class="ttdef"><b>Definition:</b> <a href="yield__plugin_8hpp_source.html#l00342">yield_plugin.hpp:342</a></div></div>
<div class="ttc" id="aclassyield__plugin_1_1YieldPlugin_html_ad25df251a12c9c052daeab2f58385c7d"><div class="ttname"><a href="classyield__plugin_1_1YieldPlugin.html#ad25df251a12c9c052daeab2f58385c7d">yield_plugin::YieldPlugin::host_bsm_id_</a></div><div class="ttdeci">std::string host_bsm_id_</div><div class="ttdef"><b>Definition:</b> <a href="yield__plugin_8hpp_source.html#l00337">yield_plugin.hpp:337</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="yield__plugin_8hpp_source.html#l00342">bsmIDtoString()</a>, and <a class="el" href="yield__plugin_8hpp_source.html#l00337">host_bsm_id_</a>.</p>

<p class="reference">Referenced by <a class="el" href="yield__plugin__node_8cpp_source.html#l00054">yield_plugin::YieldPluginNode::on_configure_plugin()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classyield__plugin_1_1YieldPlugin_a7b2ee0cdcba01c2df0f1d9df679424f8_cgraph.png" border="0" usemap="#aclassyield__plugin_1_1YieldPlugin_a7b2ee0cdcba01c2df0f1d9df679424f8_cgraph" alt=""/></div>
<map name="aclassyield__plugin_1_1YieldPlugin_a7b2ee0cdcba01c2df0f1d9df679424f8_cgraph" id="aclassyield__plugin_1_1YieldPlugin_a7b2ee0cdcba01c2df0f1d9df679424f8_cgraph">
<area shape="rect" title="callback for bsm message" alt="" coords="5,29,165,71"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#a852c927a6a8d94bfdbeeffcf56ba6331" title=" " alt="" coords="213,29,373,71"/>
<area shape="rect" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5" title=" " alt="" coords="421,29,620,71"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classyield__plugin_1_1YieldPlugin_a7b2ee0cdcba01c2df0f1d9df679424f8_icgraph.png" border="0" usemap="#aclassyield__plugin_1_1YieldPlugin_a7b2ee0cdcba01c2df0f1d9df679424f8_icgraph" alt=""/></div>
<map name="aclassyield__plugin_1_1YieldPlugin_a7b2ee0cdcba01c2df0f1d9df679424f8_icgraph" id="aclassyield__plugin_1_1YieldPlugin_a7b2ee0cdcba01c2df0f1d9df679424f8_icgraph">
<area shape="rect" title="callback for bsm message" alt="" coords="227,5,387,47"/>
<area shape="rect" href="classyield__plugin_1_1YieldPluginNode.html#aee4bb2ca0d05cf41f55db567d7c74553" title="Method which is triggered when this plugin is moved from the UNCONFIGURED to INACTIVE states...." alt="" coords="5,5,179,47"/>
</map>
</div>

</div>
</div>
<a id="a852c927a6a8d94bfdbeeffcf56ba6331" name="a852c927a6a8d94bfdbeeffcf56ba6331"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a852c927a6a8d94bfdbeeffcf56ba6331">&#9670;&nbsp;</a></span>bsmIDtoString()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string yield_plugin::YieldPlugin::bsmIDtoString </td>
          <td>(</td>
          <td class="paramtype">carma_v2x_msgs::msg::BSMCoreData&#160;</td>
          <td class="paramname"><em>bsm_core</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="yield__plugin_8hpp_source.html#l00342">342</a> of file <a class="el" href="yield__plugin_8hpp_source.html">yield_plugin.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  343</span>  {</div>
<div class="line"><span class="lineno">  344</span>    std::string res = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><span class="lineno">  345</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>=0; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>&lt;bsm_core.id.size(); <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>++)</div>
<div class="line"><span class="lineno">  346</span>    {</div>
<div class="line"><span class="lineno">  347</span>      res+=<a class="code hl_function" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5">std::to_string</a>(bsm_core.id[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>]);</div>
<div class="line"><span class="lineno">  348</span>    }</div>
<div class="line"><span class="lineno">  349</span>      <span class="keywordflow">return</span> res;</div>
<div class="line"><span class="lineno">  350</span>  }</div>
<div class="ttc" id="anamespacecarma__cooperative__perception_html_a64b708654c8aecb09122d39577df31b5"><div class="ttname"><a href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5">carma_cooperative_perception::to_string</a></div><div class="ttdeci">auto to_string(const UtmZone &amp;zone) -&gt; std::string</div><div class="ttdef"><b>Definition:</b> <a href="utm__zone_8cpp_source.html#l00021">utm_zone.cpp:21</a></div></div>
<div class="ttc" id="anamespaceprocess__bag_html_af102a02c97622dd30b0dbf7bafb0d199"><div class="ttname"><a href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">process_bag.i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="process__bag_8py_source.html#l00059">process_bag.py:59</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="process__bag_8py_source.html#l00059">process_bag::i</a>, and <a class="el" href="utm__zone_8cpp_source.html#l00021">carma_cooperative_perception::to_string()</a>.</p>

<p class="reference">Referenced by <a class="el" href="yield__plugin_8cpp_source.html#l00246">bsm_cb()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classyield__plugin_1_1YieldPlugin_a852c927a6a8d94bfdbeeffcf56ba6331_cgraph.png" border="0" usemap="#aclassyield__plugin_1_1YieldPlugin_a852c927a6a8d94bfdbeeffcf56ba6331_cgraph" alt=""/></div>
<map name="aclassyield__plugin_1_1YieldPlugin_a852c927a6a8d94bfdbeeffcf56ba6331_cgraph" id="aclassyield__plugin_1_1YieldPlugin_a852c927a6a8d94bfdbeeffcf56ba6331_cgraph">
<area shape="rect" title=" " alt="" coords="5,29,165,71"/>
<area shape="rect" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5" title=" " alt="" coords="213,29,412,71"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classyield__plugin_1_1YieldPlugin_a852c927a6a8d94bfdbeeffcf56ba6331_icgraph.png" border="0" usemap="#aclassyield__plugin_1_1YieldPlugin_a852c927a6a8d94bfdbeeffcf56ba6331_icgraph" alt=""/></div>
<map name="aclassyield__plugin_1_1YieldPlugin_a852c927a6a8d94bfdbeeffcf56ba6331_icgraph" id="aclassyield__plugin_1_1YieldPlugin_a852c927a6a8d94bfdbeeffcf56ba6331_icgraph">
<area shape="rect" title=" " alt="" coords="435,5,595,47"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#a7b2ee0cdcba01c2df0f1d9df679424f8" title="callback for bsm message" alt="" coords="227,5,387,47"/>
<area shape="rect" href="classyield__plugin_1_1YieldPluginNode.html#aee4bb2ca0d05cf41f55db567d7c74553" title="Method which is triggered when this plugin is moved from the UNCONFIGURED to INACTIVE states...." alt="" coords="5,5,179,47"/>
</map>
</div>

</div>
</div>
<a id="a3703b49299aa6b61b3889a8e6799ac74" name="a3703b49299aa6b61b3889a8e6799ac74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3703b49299aa6b61b3889a8e6799ac74">&#9670;&nbsp;</a></span>check_traj_for_digital_min_gap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double yield_plugin::YieldPlugin::check_traj_for_digital_min_gap </td>
          <td>(</td>
          <td class="paramtype">const carma_planning_msgs::msg::TrajectoryPlan &amp;&#160;</td>
          <td class="paramname"><em>original_tp</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>checks trajectory for minimum gap associated with it </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">original_tp</td><td>original trajectory plan </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>minumum required </dd></dl>

<p class="definition">Definition at line <a class="el" href="yield__plugin_8cpp_source.html#l01036">1036</a> of file <a class="el" href="yield__plugin_8cpp_source.html">yield_plugin.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1037</span>  {</div>
<div class="line"><span class="lineno"> 1038</span>    <span class="keywordtype">double</span> desired_gap = 0;</div>
<div class="line"><span class="lineno"> 1039</span> </div>
<div class="line"><span class="lineno"> 1040</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> = 0; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> &lt; original_tp.trajectory_points.size(); <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>++)</div>
<div class="line"><span class="lineno"> 1041</span>    {</div>
<div class="line"><span class="lineno"> 1042</span>      lanelet::BasicPoint2d veh_pos(original_tp.trajectory_points.at(<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>).x, original_tp.trajectory_points.at(<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>).y);</div>
<div class="line"><span class="lineno"> 1043</span>      <span class="keyword">auto</span> llts = <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aff229ed7bba2a76d0b1b99a83b9fdf88">wm_</a>-&gt;getLaneletsFromPoint(veh_pos, 1);</div>
<div class="line"><span class="lineno"> 1044</span>      <span class="keywordflow">if</span> (llts.empty())</div>
<div class="line"><span class="lineno"> 1045</span>      {</div>
<div class="line"><span class="lineno"> 1046</span>       RCLCPP_WARN_STREAM(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(),<span class="stringliteral">&quot;Trajectory point: x= &quot;</span> &lt;&lt; original_tp.trajectory_points.at(<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>).x &lt;&lt; <span class="stringliteral">&quot;y=&quot;</span>&lt;&lt; original_tp.trajectory_points.at(<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>).y);</div>
<div class="line"><span class="lineno"> 1047</span> </div>
<div class="line"><span class="lineno"> 1048</span>        <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;Trajectory Point is not on a valid lanelet.&quot;</span>);</div>
<div class="line"><span class="lineno"> 1049</span>      }</div>
<div class="line"><span class="lineno"> 1050</span>      <span class="keyword">auto</span> digital_min_gap = llts[0].regulatoryElementsAs&lt;lanelet::DigitalMinimumGap&gt;(); <span class="comment">//Returns a list of these elements)</span></div>
<div class="line"><span class="lineno"> 1051</span>      <span class="keywordflow">if</span> (!digital_min_gap.empty())</div>
<div class="line"><span class="lineno"> 1052</span>      {</div>
<div class="line"><span class="lineno"> 1053</span>        <span class="keywordtype">double</span> digital_gap = digital_min_gap[0]-&gt;getMinimumGap(); <span class="comment">// Provided gap is in meters</span></div>
<div class="line"><span class="lineno"> 1054</span>        RCLCPP_DEBUG_STREAM(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(),<span class="stringliteral">&quot;Digital Gap found with value: &quot;</span> &lt;&lt; digital_gap);</div>
<div class="line"><span class="lineno"> 1055</span>        desired_gap = std::max(desired_gap, digital_gap);</div>
<div class="line"><span class="lineno"> 1056</span>      }</div>
<div class="line"><span class="lineno"> 1057</span>    }</div>
<div class="line"><span class="lineno"> 1058</span>    <span class="keywordflow">return</span> desired_gap;</div>
<div class="line"><span class="lineno"> 1059</span>  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="process__bag_8py_source.html#l00059">process_bag::i</a>, <a class="el" href="yield__plugin_8hpp_source.html#l00315">nh_</a>, and <a class="el" href="yield__plugin_8hpp_source.html#l00311">wm_</a>.</p>

<p class="reference">Referenced by <a class="el" href="yield__plugin_8cpp_source.html#l00317">update_traj_for_cooperative_behavior()</a>, and <a class="el" href="yield__plugin_8cpp_source.html#l00888">update_traj_for_object()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classyield__plugin_1_1YieldPlugin_a3703b49299aa6b61b3889a8e6799ac74_icgraph.png" border="0" usemap="#aclassyield__plugin_1_1YieldPlugin_a3703b49299aa6b61b3889a8e6799ac74_icgraph" alt=""/></div>
<map name="aclassyield__plugin_1_1YieldPlugin_a3703b49299aa6b61b3889a8e6799ac74_icgraph" id="aclassyield__plugin_1_1YieldPlugin_a3703b49299aa6b61b3889a8e6799ac74_icgraph">
<area shape="rect" title="checks trajectory for minimum gap associated with it" alt="" coords="456,41,616,97"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#ad9c9e0e4278774a519de12a6a5f4398f" title="update trajectory for yielding to an incoming cooperative behavior" alt="" coords="220,5,408,61"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#ac1c423b99887ccbf945a86da7b7809f6" title="trajectory is modified to safely avoid obstacles on the road" alt="" coords="234,85,394,126"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#a0fd790e287683a2ef404e16a15e0ea29" title="Service callback for trajectory planning." alt="" coords="5,49,172,90"/>
</map>
</div>

</div>
</div>
<a id="acf45eb277044353dbb87226f0bec3f06" name="acf45eb277044353dbb87226f0bec3f06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf45eb277044353dbb87226f0bec3f06">&#9670;&nbsp;</a></span>compose_mobility_response()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">carma_v2x_msgs::msg::MobilityResponse yield_plugin::YieldPlugin::compose_mobility_response </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>resp_recipient_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>req_plan_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>response</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>compose a mobility response message </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">resp_recipient_id</td><td>vehicle id of the recipient of the message </td></tr>
    <tr><td class="paramname">req_plan_id</td><td>plan id from the requested message </td></tr>
    <tr><td class="paramname">response</td><td>accept/reject to the response based on conditions </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>filled mobility response </dd></dl>

<p class="definition">Definition at line <a class="el" href="yield__plugin_8cpp_source.html#l00133">133</a> of file <a class="el" href="yield__plugin_8cpp_source.html">yield_plugin.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  134</span>  {</div>
<div class="line"><span class="lineno">  135</span>    carma_v2x_msgs::msg::MobilityResponse out_mobility_response;</div>
<div class="line"><span class="lineno">  136</span>    out_mobility_response.m_header.sender_id = <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#ab1f62a493a4229d4801841eb19fb1e7d">config_</a>.<a class="code hl_variable" href="structYieldPluginConfig.html#a60e81669e3f640da18139b681e4ae426">vehicle_id</a>;</div>
<div class="line"><span class="lineno">  137</span>    out_mobility_response.m_header.recipient_id = resp_recipient_id;</div>
<div class="line"><span class="lineno">  138</span>    out_mobility_response.m_header.sender_bsm_id = <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#ad25df251a12c9c052daeab2f58385c7d">host_bsm_id_</a>;</div>
<div class="line"><span class="lineno">  139</span>    out_mobility_response.m_header.plan_id = req_plan_id;</div>
<div class="line"><span class="lineno">  140</span>    out_mobility_response.m_header.timestamp = <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;now().seconds()*1000;</div>
<div class="line"><span class="lineno">  141</span> </div>
<div class="line"><span class="lineno">  142</span> </div>
<div class="line"><span class="lineno">  143</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#ab1f62a493a4229d4801841eb19fb1e7d">config_</a>.<a class="code hl_variable" href="structYieldPluginConfig.html#a03f93a3be83b27d1d4e80ef4d765c0b0">always_accept_mobility_request</a> &amp;&amp; response)</div>
<div class="line"><span class="lineno">  144</span>    {</div>
<div class="line"><span class="lineno">  145</span>      out_mobility_response.is_accepted = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  146</span>    }</div>
<div class="line"><span class="lineno">  147</span>    <span class="keywordflow">else</span> out_mobility_response.is_accepted = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  148</span> </div>
<div class="line"><span class="lineno">  149</span>    <span class="keywordflow">return</span> out_mobility_response;</div>
<div class="line"><span class="lineno">  150</span>  }</div>
<div class="ttc" id="astructYieldPluginConfig_html_a03f93a3be83b27d1d4e80ef4d765c0b0"><div class="ttname"><a href="structYieldPluginConfig.html#a03f93a3be83b27d1d4e80ef4d765c0b0">YieldPluginConfig::always_accept_mobility_request</a></div><div class="ttdeci">bool always_accept_mobility_request</div><div class="ttdef"><b>Definition:</b> <a href="yield__config_8hpp_source.html#l00037">yield_config.hpp:37</a></div></div>
<div class="ttc" id="astructYieldPluginConfig_html_a60e81669e3f640da18139b681e4ae426"><div class="ttname"><a href="structYieldPluginConfig.html#a60e81669e3f640da18139b681e4ae426">YieldPluginConfig::vehicle_id</a></div><div class="ttdeci">std::string vehicle_id</div><div class="ttdef"><b>Definition:</b> <a href="yield__config_8hpp_source.html#l00038">yield_config.hpp:38</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="yield__config_8hpp_source.html#l00037">YieldPluginConfig::always_accept_mobility_request</a>, <a class="el" href="yield__plugin_8hpp_source.html#l00312">config_</a>, <a class="el" href="yield__plugin_8hpp_source.html#l00337">host_bsm_id_</a>, <a class="el" href="yield__plugin_8hpp_source.html#l00315">nh_</a>, and <a class="el" href="yield__config_8hpp_source.html#l00038">YieldPluginConfig::vehicle_id</a>.</p>

<p class="reference">Referenced by <a class="el" href="yield__plugin_8cpp_source.html#l00153">mobilityrequest_cb()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classyield__plugin_1_1YieldPlugin_acf45eb277044353dbb87226f0bec3f06_icgraph.png" border="0" usemap="#aclassyield__plugin_1_1YieldPlugin_acf45eb277044353dbb87226f0bec3f06_icgraph" alt=""/></div>
<map name="aclassyield__plugin_1_1YieldPlugin_acf45eb277044353dbb87226f0bec3f06_icgraph" id="aclassyield__plugin_1_1YieldPlugin_acf45eb277044353dbb87226f0bec3f06_icgraph">
<area shape="rect" title="compose a mobility response message" alt="" coords="435,5,627,47"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#a3276c693a65319e769e63078284d3056" title="callback for mobility request" alt="" coords="227,5,387,47"/>
<area shape="rect" href="classyield__plugin_1_1YieldPluginNode.html#aee4bb2ca0d05cf41f55db567d7c74553" title="Method which is triggered when this plugin is moved from the UNCONFIGURED to INACTIVE states...." alt="" coords="5,5,179,47"/>
</map>
</div>

</div>
</div>
<a id="a5255e398082083d48e7b07054f82fad8" name="a5255e398082083d48e7b07054f82fad8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5255e398082083d48e7b07054f82fad8">&#9670;&nbsp;</a></span>convert_eceftrajectory_to_mappoints()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; lanelet::BasicPoint2d &gt; yield_plugin::YieldPlugin::convert_eceftrajectory_to_mappoints </td>
          <td>(</td>
          <td class="paramtype">const carma_v2x_msgs::msg::Trajectory &amp;&#160;</td>
          <td class="paramname"><em>ecef_trajectory</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>convert a carma trajectory from ecef frame to map frame ecef trajectory consists of the point and a set of offsets with reference to the point </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ecef_trajectory</td><td>carma trajectory (ecef frame) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>vector of 2d points in map frame </dd></dl>

<p class="definition">Definition at line <a class="el" href="yield__plugin_8cpp_source.html#l00094">94</a> of file <a class="el" href="yield__plugin_8cpp_source.html">yield_plugin.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   95</span>  {</div>
<div class="line"><span class="lineno">   96</span>    carma_planning_msgs::msg::TrajectoryPlan trajectory_plan;</div>
<div class="line"><span class="lineno">   97</span>    std::vector&lt;lanelet::BasicPoint2d&gt; map_points;</div>
<div class="line"><span class="lineno">   98</span> </div>
<div class="line"><span class="lineno">   99</span>    lanelet::BasicPoint2d <a class="code hl_variable" href="namespaceprocess__bag.html#ada7d8d458b66074ad9e74b476c299003">first_point</a> = <a class="code hl_function" href="classyield__plugin_1_1YieldPlugin.html#ac0b6fb988e61ce2cfb04c4a1f33070d5">ecef_to_map_point</a>(ecef_trajectory.location);</div>
<div class="line"><span class="lineno">  100</span> </div>
<div class="line"><span class="lineno">  101</span>    map_points.push_back(<a class="code hl_variable" href="namespaceprocess__bag.html#ada7d8d458b66074ad9e74b476c299003">first_point</a>);</div>
<div class="line"><span class="lineno">  102</span>    <span class="keyword">auto</span> curr_point = ecef_trajectory.location;</div>
<div class="line"><span class="lineno">  103</span> </div>
<div class="line"><span class="lineno">  104</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> = 0; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>&lt;ecef_trajectory.offsets.size(); <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>++)</div>
<div class="line"><span class="lineno">  105</span>    {</div>
<div class="line"><span class="lineno">  106</span>      lanelet::BasicPoint2d offset_point;</div>
<div class="line"><span class="lineno">  107</span>      curr_point.ecef_x += ecef_trajectory.offsets.at(<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>).offset_x;</div>
<div class="line"><span class="lineno">  108</span>      curr_point.ecef_y += ecef_trajectory.offsets.at(<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>).offset_y;</div>
<div class="line"><span class="lineno">  109</span>      curr_point.ecef_z += ecef_trajectory.offsets.at(<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>).offset_z;</div>
<div class="line"><span class="lineno">  110</span> </div>
<div class="line"><span class="lineno">  111</span>      offset_point = <a class="code hl_function" href="classyield__plugin_1_1YieldPlugin.html#ac0b6fb988e61ce2cfb04c4a1f33070d5">ecef_to_map_point</a>(curr_point);</div>
<div class="line"><span class="lineno">  112</span> </div>
<div class="line"><span class="lineno">  113</span>      map_points.push_back(offset_point);</div>
<div class="line"><span class="lineno">  114</span>    }</div>
<div class="line"><span class="lineno">  115</span> </div>
<div class="line"><span class="lineno">  116</span>    <span class="keywordflow">return</span> map_points;</div>
<div class="line"><span class="lineno">  117</span>  }</div>
<div class="ttc" id="aclassyield__plugin_1_1YieldPlugin_html_ac0b6fb988e61ce2cfb04c4a1f33070d5"><div class="ttname"><a href="classyield__plugin_1_1YieldPlugin.html#ac0b6fb988e61ce2cfb04c4a1f33070d5">yield_plugin::YieldPlugin::ecef_to_map_point</a></div><div class="ttdeci">lanelet::BasicPoint2d ecef_to_map_point(const carma_v2x_msgs::msg::LocationECEF &amp;ecef_point) const</div><div class="ttdoc">convert a point in ecef frame (in cm) into map frame (in meters)</div><div class="ttdef"><b>Definition:</b> <a href="yield__plugin_8cpp_source.html#l00119">yield_plugin.cpp:119</a></div></div>
<div class="ttc" id="anamespaceprocess__bag_html_ada7d8d458b66074ad9e74b476c299003"><div class="ttname"><a href="namespaceprocess__bag.html#ada7d8d458b66074ad9e74b476c299003">process_bag.first_point</a></div><div class="ttdeci">list first_point</div><div class="ttdef"><b>Definition:</b> <a href="process__bag_8py_source.html#l00052">process_bag.py:52</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="yield__plugin_8cpp_source.html#l00119">ecef_to_map_point()</a>, <a class="el" href="process__bag_8py_source.html#l00052">process_bag::first_point</a>, and <a class="el" href="process__bag_8py_source.html#l00059">process_bag::i</a>.</p>

<p class="reference">Referenced by <a class="el" href="yield__plugin_8cpp_source.html#l00153">mobilityrequest_cb()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classyield__plugin_1_1YieldPlugin_a5255e398082083d48e7b07054f82fad8_cgraph.png" border="0" usemap="#aclassyield__plugin_1_1YieldPlugin_a5255e398082083d48e7b07054f82fad8_cgraph" alt=""/></div>
<map name="aclassyield__plugin_1_1YieldPlugin_a5255e398082083d48e7b07054f82fad8_cgraph" id="aclassyield__plugin_1_1YieldPlugin_a5255e398082083d48e7b07054f82fad8_cgraph">
<area shape="rect" title="convert a carma trajectory from ecef frame to map frame ecef trajectory consists of the point and a s..." alt="" coords="5,5,165,61"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#ac0b6fb988e61ce2cfb04c4a1f33070d5" title="convert a point in ecef frame (in cm) into map frame (in meters)" alt="" coords="213,13,373,54"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classyield__plugin_1_1YieldPlugin_a5255e398082083d48e7b07054f82fad8_icgraph.png" border="0" usemap="#aclassyield__plugin_1_1YieldPlugin_a5255e398082083d48e7b07054f82fad8_icgraph" alt=""/></div>
<map name="aclassyield__plugin_1_1YieldPlugin_a5255e398082083d48e7b07054f82fad8_icgraph" id="aclassyield__plugin_1_1YieldPlugin_a5255e398082083d48e7b07054f82fad8_icgraph">
<area shape="rect" title="convert a carma trajectory from ecef frame to map frame ecef trajectory consists of the point and a s..." alt="" coords="435,5,595,61"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#a3276c693a65319e769e63078284d3056" title="callback for mobility request" alt="" coords="227,13,387,54"/>
<area shape="rect" href="classyield__plugin_1_1YieldPluginNode.html#aee4bb2ca0d05cf41f55db567d7c74553" title="Method which is triggered when this plugin is moved from the UNCONFIGURED to INACTIVE states...." alt="" coords="5,13,179,54"/>
</map>
</div>

</div>
</div>
<a id="abb40cf8a08a75c472791dbd91b99d8dc" name="abb40cf8a08a75c472791dbd91b99d8dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb40cf8a08a75c472791dbd91b99d8dc">&#9670;&nbsp;</a></span>detect_trajectories_intersection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::pair&lt; <a class="el" href="classint.html">int</a>, lanelet::BasicPoint2d &gt; &gt; yield_plugin::YieldPlugin::detect_trajectories_intersection </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; lanelet::BasicPoint2d &gt;&#160;</td>
          <td class="paramname"><em>self_trajectory</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; lanelet::BasicPoint2d &gt;&#160;</td>
          <td class="paramname"><em>incoming_trajectory</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>detect intersection point(s) of two trajectories </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">trajectory1</td><td>vector of 2d trajectory points </td></tr>
    <tr><td class="paramname">trajectory2</td><td>vector of 2d trajectory points </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>vector of pairs of 2d intersection points and index of the point in trajectory array </dd></dl>

<p class="definition">Definition at line <a class="el" href="yield__plugin_8cpp_source.html#l00073">73</a> of file <a class="el" href="yield__plugin_8cpp_source.html">yield_plugin.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   74</span>  {</div>
<div class="line"><span class="lineno">   75</span>    std::vector&lt;std::pair&lt;int, lanelet::BasicPoint2d&gt;&gt; intersection_points;</div>
<div class="line"><span class="lineno">   76</span>    boost::geometry::model::linestring&lt;lanelet::BasicPoint2d&gt; self_traj;</div>
<div class="line"><span class="lineno">   77</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> tpp:self_trajectory)</div>
<div class="line"><span class="lineno">   78</span>    {</div>
<div class="line"><span class="lineno">   79</span>      boost::geometry::append(self_traj, tpp);</div>
<div class="line"><span class="lineno">   80</span>    }</div>
<div class="line"><span class="lineno">   81</span>    <span class="comment">// distance to consider trajectories colliding (chosen based on lane width and vehicle size)</span></div>
<div class="line"><span class="lineno">   82</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>=0; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>&lt;incoming_trajectory.size(); <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>++)</div>
<div class="line"><span class="lineno">   83</span>    {</div>
<div class="line"><span class="lineno">   84</span>      <span class="keywordtype">double</span> res = boost::geometry::distance(incoming_trajectory.at(<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>), self_traj);</div>
<div class="line"><span class="lineno">   85</span> </div>
<div class="line"><span class="lineno">   86</span>      <span class="keywordflow">if</span> (fabs(res) &lt;= <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#ab1f62a493a4229d4801841eb19fb1e7d">config_</a>.<a class="code hl_variable" href="structYieldPluginConfig.html#a9c609df9146f9f8dbbf4838decc6fb0b">intervehicle_collision_distance_in_m</a>)</div>
<div class="line"><span class="lineno">   87</span>      {</div>
<div class="line"><span class="lineno">   88</span>         intersection_points.push_back(std::make_pair(<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>, incoming_trajectory.at(<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>)));</div>
<div class="line"><span class="lineno">   89</span>      }</div>
<div class="line"><span class="lineno">   90</span>    }</div>
<div class="line"><span class="lineno">   91</span>    <span class="keywordflow">return</span> intersection_points;</div>
<div class="line"><span class="lineno">   92</span>  }</div>
<div class="ttc" id="astructYieldPluginConfig_html_a9c609df9146f9f8dbbf4838decc6fb0b"><div class="ttname"><a href="structYieldPluginConfig.html#a9c609df9146f9f8dbbf4838decc6fb0b">YieldPluginConfig::intervehicle_collision_distance_in_m</a></div><div class="ttdeci">double intervehicle_collision_distance_in_m</div><div class="ttdef"><b>Definition:</b> <a href="yield__config_8hpp_source.html#l00040">yield_config.hpp:40</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="yield__plugin_8hpp_source.html#l00312">config_</a>, <a class="el" href="process__bag_8py_source.html#l00059">process_bag::i</a>, and <a class="el" href="yield__config_8hpp_source.html#l00040">YieldPluginConfig::intervehicle_collision_distance_in_m</a>.</p>

<p class="reference">Referenced by <a class="el" href="yield__plugin_8cpp_source.html#l00317">update_traj_for_cooperative_behavior()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classyield__plugin_1_1YieldPlugin_abb40cf8a08a75c472791dbd91b99d8dc_icgraph.png" border="0" usemap="#aclassyield__plugin_1_1YieldPlugin_abb40cf8a08a75c472791dbd91b99d8dc_icgraph" alt=""/></div>
<map name="aclassyield__plugin_1_1YieldPlugin_abb40cf8a08a75c472791dbd91b99d8dc_icgraph" id="aclassyield__plugin_1_1YieldPlugin_abb40cf8a08a75c472791dbd91b99d8dc_icgraph">
<area shape="rect" title="detect intersection point(s) of two trajectories" alt="" coords="456,13,665,54"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#ad9c9e0e4278774a519de12a6a5f4398f" title="update trajectory for yielding to an incoming cooperative behavior" alt="" coords="220,5,408,61"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#a0fd790e287683a2ef404e16a15e0ea29" title="Service callback for trajectory planning." alt="" coords="5,13,172,54"/>
</map>
</div>

</div>
</div>
<a id="ac0b6fb988e61ce2cfb04c4a1f33070d5" name="ac0b6fb988e61ce2cfb04c4a1f33070d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0b6fb988e61ce2cfb04c4a1f33070d5">&#9670;&nbsp;</a></span>ecef_to_map_point()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">lanelet::BasicPoint2d yield_plugin::YieldPlugin::ecef_to_map_point </td>
          <td>(</td>
          <td class="paramtype">const carma_v2x_msgs::msg::LocationECEF &amp;&#160;</td>
          <td class="paramname"><em>ecef_point</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>convert a point in ecef frame (in cm) into map frame (in meters) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ecef_point</td><td>carma point ecef frame in cm </td></tr>
    <tr><td class="paramname">map_in_earth</td><td>translate frame </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>2d point in map frame </dd></dl>

<p class="definition">Definition at line <a class="el" href="yield__plugin_8cpp_source.html#l00119">119</a> of file <a class="el" href="yield__plugin_8cpp_source.html">yield_plugin.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  120</span>  {</div>
<div class="line"><span class="lineno">  121</span> </div>
<div class="line"><span class="lineno">  122</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#a42d2a2d8a9f88afbedaa566ad57c8444">map_projector_</a>) {</div>
<div class="line"><span class="lineno">  123</span>        <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;No map projector available for ecef conversion&quot;</span>);</div>
<div class="line"><span class="lineno">  124</span>    }</div>
<div class="line"><span class="lineno">  125</span> </div>
<div class="line"><span class="lineno">  126</span>    lanelet::BasicPoint3d map_point = <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#a42d2a2d8a9f88afbedaa566ad57c8444">map_projector_</a>-&gt;projectECEF( { <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(ecef_point.ecef_x)/100.0, <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(ecef_point.ecef_y)/100.0, <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(ecef_point.ecef_z)/100.0 } , 1);</div>
<div class="line"><span class="lineno">  127</span> </div>
<div class="line"><span class="lineno">  128</span>    <span class="keywordflow">return</span> lanelet::traits::to2D(map_point);</div>
<div class="line"><span class="lineno">  129</span>  }</div>
<div class="ttc" id="aclassyield__plugin_1_1YieldPlugin_html_a42d2a2d8a9f88afbedaa566ad57c8444"><div class="ttname"><a href="classyield__plugin_1_1YieldPlugin.html#a42d2a2d8a9f88afbedaa566ad57c8444">yield_plugin::YieldPlugin::map_projector_</a></div><div class="ttdeci">std::shared_ptr&lt; lanelet::projection::LocalFrameProjector &gt; map_projector_</div><div class="ttdef"><b>Definition:</b> <a href="yield__plugin_8hpp_source.html#l00340">yield_plugin.hpp:340</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="yield__plugin_8hpp_source.html#l00340">map_projector_</a>.</p>

<p class="reference">Referenced by <a class="el" href="yield__plugin_8cpp_source.html#l00094">convert_eceftrajectory_to_mappoints()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classyield__plugin_1_1YieldPlugin_ac0b6fb988e61ce2cfb04c4a1f33070d5_icgraph.png" border="0" usemap="#aclassyield__plugin_1_1YieldPlugin_ac0b6fb988e61ce2cfb04c4a1f33070d5_icgraph" alt=""/></div>
<map name="aclassyield__plugin_1_1YieldPlugin_ac0b6fb988e61ce2cfb04c4a1f33070d5_icgraph" id="aclassyield__plugin_1_1YieldPlugin_ac0b6fb988e61ce2cfb04c4a1f33070d5_icgraph">
<area shape="rect" title="convert a point in ecef frame (in cm) into map frame (in meters)" alt="" coords="643,13,803,54"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#a5255e398082083d48e7b07054f82fad8" title="convert a carma trajectory from ecef frame to map frame ecef trajectory consists of the point and a s..." alt="" coords="435,5,595,61"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#a3276c693a65319e769e63078284d3056" title="callback for mobility request" alt="" coords="227,13,387,54"/>
<area shape="rect" href="classyield__plugin_1_1YieldPluginNode.html#aee4bb2ca0d05cf41f55db567d7c74553" title="Method which is triggered when this plugin is moved from the UNCONFIGURED to INACTIVE states...." alt="" coords="5,13,179,54"/>
</map>
</div>

</div>
</div>
<a id="ace53f1895cbbf2a5f109cbfc11d6313f" name="ace53f1895cbbf2a5f109cbfc11d6313f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace53f1895cbbf2a5f109cbfc11d6313f">&#9670;&nbsp;</a></span>generate_JMT_trajectory()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">carma_planning_msgs::msg::TrajectoryPlan yield_plugin::YieldPlugin::generate_JMT_trajectory </td>
          <td>(</td>
          <td class="paramtype">const carma_planning_msgs::msg::TrajectoryPlan &amp;&#160;</td>
          <td class="paramname"><em>original_tp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>initial_pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>goal_pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>initial_velocity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>goal_velocity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>planning_time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>original_max_speed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>generate a Jerk Minimizing Trajectory(JMT) with the provided start and end conditions </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">original_tp</td><td>original trajectory plan </td></tr>
    <tr><td class="paramname">intial_pos</td><td>start position </td></tr>
    <tr><td class="paramname">goal_pos</td><td>final position </td></tr>
    <tr><td class="paramname">initial_velocity</td><td>start velocity </td></tr>
    <tr><td class="paramname">goal_velocity</td><td>end velocity </td></tr>
    <tr><td class="paramname">planning_time</td><td>time duration of the planning </td></tr>
    <tr><td class="paramname">original</td><td>original_max_speed from original_tp up until the goal_pos portion NOTE: the function would generate trajectory duration arbitrarily high if stopping motion is needed. This is to keep the original trajectory's shape in terms of location so that the vehicle steers toward the direction of travel even when stopping. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>updated JMT trajectory </dd></dl>

<p class="definition">Definition at line <a class="el" href="yield__plugin_8cpp_source.html#l00402">402</a> of file <a class="el" href="yield__plugin_8cpp_source.html">yield_plugin.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  404</span>  {</div>
<div class="line"><span class="lineno">  405</span>    carma_planning_msgs::msg::TrajectoryPlan jmt_trajectory;</div>
<div class="line"><span class="lineno">  406</span>    std::vector&lt;carma_planning_msgs::msg::TrajectoryPlanPoint&gt; jmt_trajectory_points;</div>
<div class="line"><span class="lineno">  407</span>    jmt_trajectory_points.push_back(original_tp.trajectory_points[0]);</div>
<div class="line"><span class="lineno">  408</span> </div>
<div class="line"><span class="lineno">  409</span>    std::vector&lt;double&gt; original_traj_relative_downtracks = <a class="code hl_function" href="classyield__plugin_1_1YieldPlugin.html#a1bc011c9c2db48289bf40214d972cec4">get_relative_downtracks</a>(original_tp);</div>
<div class="line"><span class="lineno">  410</span>    std::vector&lt;double&gt; calculated_speeds = {};</div>
<div class="line"><span class="lineno">  411</span>    std::vector&lt;double&gt; new_relative_downtracks = {};</div>
<div class="line"><span class="lineno">  412</span>    new_relative_downtracks.push_back(0.0);</div>
<div class="line"><span class="lineno">  413</span>    calculated_speeds.push_back(initial_velocity);</div>
<div class="line"><span class="lineno">  414</span>    <span class="keywordtype">double</span> new_traj_accumulated_downtrack = 0.0;</div>
<div class="line"><span class="lineno">  415</span>    <span class="keywordtype">double</span> original_traj_accumulated_downtrack = original_traj_relative_downtracks.at(1);</div>
<div class="line"><span class="lineno">  416</span> </div>
<div class="line"><span class="lineno">  417</span>    <span class="comment">// Up until goal_pos (which also can be until end of the entire original trajectory), generate new speeds at</span></div>
<div class="line"><span class="lineno">  418</span>    <span class="comment">// or near original trajectory points by generating them at a fixed time interval using the JMT polynomial equation</span></div>
<div class="line"><span class="lineno">  419</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> initial_time = 0;</div>
<div class="line"><span class="lineno">  420</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> initial_accel = 0;</div>
<div class="line"><span class="lineno">  421</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> goal_accel = 0;</div>
<div class="line"><span class="lineno">  422</span>    <span class="keywordtype">int</span> new_traj_idx = 1;</div>
<div class="line"><span class="lineno">  423</span>    <span class="keywordtype">int</span> original_traj_idx = 1;</div>
<div class="line"><span class="lineno">  424</span>    RCLCPP_DEBUG_STREAM(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(),<span class="stringliteral">&quot;Following parameters used for JMT: &quot;</span></div>
<div class="line"><span class="lineno">  425</span>      <span class="stringliteral">&quot;\ninitial_pos: &quot;</span> &lt;&lt; initial_pos &lt;&lt;</div>
<div class="line"><span class="lineno">  426</span>      <span class="stringliteral">&quot;\ngoal_pos: &quot;</span> &lt;&lt; goal_pos &lt;&lt;</div>
<div class="line"><span class="lineno">  427</span>      <span class="stringliteral">&quot;\ninitial_velocity: &quot;</span> &lt;&lt; initial_velocity &lt;&lt;</div>
<div class="line"><span class="lineno">  428</span>      <span class="stringliteral">&quot;\ngoal_velocity: &quot;</span> &lt;&lt; goal_velocity &lt;&lt;</div>
<div class="line"><span class="lineno">  429</span>      <span class="stringliteral">&quot;\ninitial_accel: &quot;</span> &lt;&lt; initial_accel &lt;&lt;</div>
<div class="line"><span class="lineno">  430</span>      <span class="stringliteral">&quot;\ngoal_accel: &quot;</span> &lt;&lt; goal_accel &lt;&lt;</div>
<div class="line"><span class="lineno">  431</span>      <span class="stringliteral">&quot;\nplanning_time: &quot;</span> &lt;&lt; planning_time &lt;&lt;</div>
<div class="line"><span class="lineno">  432</span>      <span class="stringliteral">&quot;\noriginal_max_speed: &quot;</span> &lt;&lt; original_max_speed);</div>
<div class="line"><span class="lineno">  433</span> </div>
<div class="line"><span class="lineno">  434</span>    <span class="comment">// Get the polynomial solutions used to generate the trajectory</span></div>
<div class="line"><span class="lineno">  435</span>    std::vector&lt;double&gt; polynomial_coefficients = quintic_coefficient_calculator::quintic_coefficient_calculator(initial_pos,</div>
<div class="line"><span class="lineno">  436</span>                                                                                                goal_pos,</div>
<div class="line"><span class="lineno">  437</span>                                                                                                initial_velocity,</div>
<div class="line"><span class="lineno">  438</span>                                                                                                goal_velocity,</div>
<div class="line"><span class="lineno">  439</span>                                                                                                initial_accel,</div>
<div class="line"><span class="lineno">  440</span>                                                                                                goal_accel,</div>
<div class="line"><span class="lineno">  441</span>                                                                                                initial_time,</div>
<div class="line"><span class="lineno">  442</span>                                                                                                planning_time);</div>
<div class="line"><span class="lineno">  443</span>    RCLCPP_DEBUG_STREAM(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(),<span class="stringliteral">&quot;Used original_max_speed: &quot;</span> &lt;&lt; original_max_speed);</div>
<div class="line"><span class="lineno">  444</span>    <span class="keyword">const</span> <span class="keyword">auto</span> smallest_time_step = <a class="code hl_function" href="namespaceyield__plugin.html#a6685355374aa80334c267d788788cb2f">get_smallest_time_step_of_traj</a>(original_tp);</div>
<div class="line"><span class="lineno">  445</span>    <span class="keywordflow">while</span> (new_traj_accumulated_downtrack &lt; goal_pos - <a class="code hl_variable" href="yield__plugin_8cpp.html#a6f9399eaf2efb1b12e797b77909df9ac">EPSILON</a> &amp;&amp; original_traj_idx &lt; original_traj_relative_downtracks.size())</div>
<div class="line"><span class="lineno">  446</span>    {</div>
<div class="line"><span class="lineno">  447</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> target_time = new_traj_idx * smallest_time_step;</div>
<div class="line"><span class="lineno">  448</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> downtrack_at_target_time = <a class="code hl_function" href="classyield__plugin_1_1YieldPlugin.html#ae7ffd46ccbae6de4b60a7f49a8cfa3d6">polynomial_calc</a>(polynomial_coefficients, target_time);</div>
<div class="line"><span class="lineno">  449</span>      <span class="keywordtype">double</span> velocity_at_target_time = <a class="code hl_function" href="classyield__plugin_1_1YieldPlugin.html#afeab08ed138eafe6e24abd775c3163dd">polynomial_calc_d</a>(polynomial_coefficients, target_time);</div>
<div class="line"><span class="lineno">  450</span> </div>
<div class="line"><span class="lineno">  451</span>      RCLCPP_DEBUG_STREAM(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(), <span class="stringliteral">&quot;Calculated speed velocity_at_target_time: &quot;</span> &lt;&lt; velocity_at_target_time</div>
<div class="line"><span class="lineno">  452</span>        &lt;&lt; <span class="stringliteral">&quot;, downtrack_at_target_time: &quot;</span>&lt;&lt; downtrack_at_target_time &lt;&lt; <span class="stringliteral">&quot;, target_time: &quot;</span> &lt;&lt; target_time);</div>
<div class="line"><span class="lineno">  453</span> </div>
<div class="line"><span class="lineno">  454</span>      <span class="comment">// if the speed becomes negative, the downtrack starts reversing to negative as well</span></div>
<div class="line"><span class="lineno">  455</span>      <span class="comment">// which will never reach the goal_pos, so break here.</span></div>
<div class="line"><span class="lineno">  456</span>      <span class="keywordflow">if</span> (velocity_at_target_time &lt; 0.0)</div>
<div class="line"><span class="lineno">  457</span>      {</div>
<div class="line"><span class="lineno">  458</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  459</span>      }</div>
<div class="line"><span class="lineno">  460</span> </div>
<div class="line"><span class="lineno">  461</span>      <span class="comment">// Cannot have a negative speed or have a higher speed than that of the original trajectory</span></div>
<div class="line"><span class="lineno">  462</span>      velocity_at_target_time = std::clamp(velocity_at_target_time, 0.0, original_max_speed);</div>
<div class="line"><span class="lineno">  463</span> </div>
<div class="line"><span class="lineno">  464</span>      <span class="comment">// Pick the speed if it matches with the original downtracks</span></div>
<div class="line"><span class="lineno">  465</span>      <span class="keywordflow">if</span> (downtrack_at_target_time &gt;= original_traj_accumulated_downtrack)</div>
<div class="line"><span class="lineno">  466</span>      {</div>
<div class="line"><span class="lineno">  467</span>        RCLCPP_DEBUG_STREAM(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(), <span class="stringliteral">&quot;Picked calculated speed velocity_at_target_time: &quot;</span> &lt;&lt; velocity_at_target_time</div>
<div class="line"><span class="lineno">  468</span>          &lt;&lt; <span class="stringliteral">&quot;, downtrack_at_target_time: &quot;</span>&lt;&lt; downtrack_at_target_time &lt;&lt; <span class="stringliteral">&quot;, target_time: &quot;</span> &lt;&lt; target_time);</div>
<div class="line"><span class="lineno">  469</span>        <span class="comment">// velocity_at_target_time doesn&#39;t exactly correspond to original_traj_accumulated_downtrack but does for new_traj_accumulated_downtrack.</span></div>
<div class="line"><span class="lineno">  470</span>        <span class="comment">// however, the logic is assuming they are close enough that the speed is usable</span></div>
<div class="line"><span class="lineno">  471</span>        calculated_speeds.push_back(velocity_at_target_time);</div>
<div class="line"><span class="lineno">  472</span>        original_traj_accumulated_downtrack += original_traj_relative_downtracks.at(original_traj_idx);</div>
<div class="line"><span class="lineno">  473</span>        original_traj_idx ++;</div>
<div class="line"><span class="lineno">  474</span>      }</div>
<div class="line"><span class="lineno">  475</span>      new_traj_accumulated_downtrack = downtrack_at_target_time;</div>
<div class="line"><span class="lineno">  476</span>      new_traj_idx++;</div>
<div class="line"><span class="lineno">  477</span> </div>
<div class="line"><span class="lineno">  478</span>    }</div>
<div class="line"><span class="lineno">  479</span> </div>
<div class="line"><span class="lineno">  480</span>    <span class="comment">// if the loop above finished prematurely due to negative speed, fill with 0.0 speeds</span></div>
<div class="line"><span class="lineno">  481</span>    <span class="comment">// since the speed crossed 0.0 and algorithm indicates stopping</span></div>
<div class="line"><span class="lineno">  482</span>    std::fill_n(std::back_inserter(calculated_speeds),</div>
<div class="line"><span class="lineno">  483</span>                std::size(original_traj_relative_downtracks) - std::size(calculated_speeds),</div>
<div class="line"><span class="lineno">  484</span>                0.0);</div>
<div class="line"><span class="lineno">  485</span> </div>
<div class="line"><span class="lineno">  486</span>    <span class="comment">// Moving average filter to smoothen the speeds</span></div>
<div class="line"><span class="lineno">  487</span>    std::vector&lt;double&gt; filtered_speeds = <a class="code hl_function" href="namespacebasic__autonomy_1_1smoothing.html#afb726e75a21ada8efa3ca5561ffc9984">basic_autonomy::smoothing::moving_average_filter</a>(calculated_speeds, <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#ab1f62a493a4229d4801841eb19fb1e7d">config_</a>.<a class="code hl_variable" href="structYieldPluginConfig.html#a712ad260a3344fe9828d6022211743fe">speed_moving_average_window_size</a>);</div>
<div class="line"><span class="lineno">  488</span>    RCLCPP_DEBUG_STREAM(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(), <span class="stringliteral">&quot;filtered_speeds size: &quot;</span> &lt;&lt; filtered_speeds.size());</div>
<div class="line"><span class="lineno">  489</span> </div>
<div class="line"><span class="lineno">  490</span>    <span class="comment">// Replace the original trajectory&#39;s associated timestamps based on the newly calculated speeds</span></div>
<div class="line"><span class="lineno">  491</span>    <span class="keywordtype">double</span> prev_speed = filtered_speeds.at(0);</div>
<div class="line"><span class="lineno">  492</span>    RCLCPP_DEBUG_STREAM(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(), <span class="stringliteral">&quot;start speed: &quot;</span> &lt;&lt; prev_speed &lt;&lt; <span class="stringliteral">&quot;, target_time: &quot;</span> &lt;&lt; <a class="code hl_function" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5">std::to_string</a>(rclcpp::Time(original_tp.trajectory_points[0].target_time).seconds()));</div>
<div class="line"><span class="lineno">  493</span> </div>
<div class="line"><span class="lineno">  494</span>    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> = 1; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> &lt; original_tp.trajectory_points.size(); <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>++)</div>
<div class="line"><span class="lineno">  495</span>    {</div>
<div class="line"><span class="lineno">  496</span>      carma_planning_msgs::msg::TrajectoryPlanPoint jmt_tpp = original_tp.trajectory_points.at(<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>);</div>
<div class="line"><span class="lineno">  497</span> </div>
<div class="line"><span class="lineno">  498</span>      <span class="comment">// In case only subset of original trajectory needs modification,</span></div>
<div class="line"><span class="lineno">  499</span>      <span class="comment">// the rest of the points should keep the last speed to cruise</span></div>
<div class="line"><span class="lineno">  500</span>      <span class="keywordtype">double</span> current_speed = goal_velocity;</div>
<div class="line"><span class="lineno">  501</span> </div>
<div class="line"><span class="lineno">  502</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> &lt; filtered_speeds.size())</div>
<div class="line"><span class="lineno">  503</span>      {</div>
<div class="line"><span class="lineno">  504</span>        current_speed = filtered_speeds.at(<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>);</div>
<div class="line"><span class="lineno">  505</span>      }</div>
<div class="line"><span class="lineno">  506</span> </div>
<div class="line"><span class="lineno">  507</span>      <span class="comment">//Force the speed to 0 if below configured value for more control over stopping behavior</span></div>
<div class="line"><span class="lineno">  508</span>      <span class="keywordflow">if</span> (current_speed &lt; <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#ab1f62a493a4229d4801841eb19fb1e7d">config_</a>.<a class="code hl_variable" href="structYieldPluginConfig.html#a17c3152e5b5091ad40df3a4ee8969b25">max_stop_speed_in_ms</a>)</div>
<div class="line"><span class="lineno">  509</span>      {</div>
<div class="line"><span class="lineno">  510</span>        current_speed = 0;</div>
<div class="line"><span class="lineno">  511</span>      }</div>
<div class="line"><span class="lineno">  512</span> </div>
<div class="line"><span class="lineno">  513</span>      <span class="comment">// Derived from constant accelaration kinematic equation: (vi + vf) / 2 * dt = d_dist</span></div>
<div class="line"><span class="lineno">  514</span>      <span class="comment">// This also handles a case correctly when current_speed is 0, but prev_speed is not 0 yet</span></div>
<div class="line"><span class="lineno">  515</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> dt = (2 * original_traj_relative_downtracks.at(<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>)) / (current_speed + prev_speed);</div>
<div class="line"><span class="lineno">  516</span>      jmt_tpp.target_time =  rclcpp::Time(jmt_trajectory_points.back().target_time) + rclcpp::Duration(dt*1e9);</div>
<div class="line"><span class="lineno">  517</span> </div>
<div class="line"><span class="lineno">  518</span>      <span class="keywordflow">if</span> (prev_speed &lt; <a class="code hl_variable" href="yield__plugin_8cpp.html#a6f9399eaf2efb1b12e797b77909df9ac">EPSILON</a>) <span class="comment">// Handle a special case if prev_speed (thus current_speed too) is 0</span></div>
<div class="line"><span class="lineno">  519</span>      {</div>
<div class="line"><span class="lineno">  520</span>        <span class="comment">// NOTE: Assigning arbitrary 100 mins dt between points where normally dt is only 1 sec to model a stopping behavior.</span></div>
<div class="line"><span class="lineno">  521</span>        <span class="comment">// Another way to model it is to keep the trajectory point at a same location and increment time slightly. However,</span></div>
<div class="line"><span class="lineno">  522</span>        <span class="comment">// if the vehicle goes past the point, it may cruise toward undesirable location (for example into the intersection).</span></div>
<div class="line"><span class="lineno">  523</span>        <span class="comment">// Keeping the points help the controller steer the vehicle toward direction of travel even when stopping.</span></div>
<div class="line"><span class="lineno">  524</span>        <span class="comment">// Only downside is the trajectory plan is huge where only 15 sec is expected, but since this is stopping case, it shouldn&#39;t matter.</span></div>
<div class="line"><span class="lineno">  525</span>        jmt_tpp.target_time = rclcpp::Time(jmt_trajectory_points.back().target_time) + rclcpp::Duration(6000 * 1e9);</div>
<div class="line"><span class="lineno">  526</span>        RCLCPP_DEBUG_STREAM(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(), <span class="stringliteral">&quot;Zero speed = x: &quot;</span> &lt;&lt; jmt_tpp.x &lt;&lt; <span class="stringliteral">&quot;, y:&quot;</span> &lt;&lt; jmt_tpp.y</div>
<div class="line"><span class="lineno">  527</span>          &lt;&lt; <span class="stringliteral">&quot;, t:&quot;</span> &lt;&lt; <a class="code hl_function" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5">std::to_string</a>(rclcpp::Time(jmt_tpp.target_time).seconds())</div>
<div class="line"><span class="lineno">  528</span>          &lt;&lt; <span class="stringliteral">&quot;, prev_speed: &quot;</span> &lt;&lt; prev_speed &lt;&lt; <span class="stringliteral">&quot;, current_speed: &quot;</span> &lt;&lt; current_speed);</div>
<div class="line"><span class="lineno">  529</span>      }</div>
<div class="line"><span class="lineno">  530</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  531</span>      {</div>
<div class="line"><span class="lineno">  532</span>        RCLCPP_DEBUG_STREAM(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(), <span class="stringliteral">&quot;Non-zero speed = x: &quot;</span> &lt;&lt; jmt_tpp.x &lt;&lt; <span class="stringliteral">&quot;, y:&quot;</span> &lt;&lt; jmt_tpp.y</div>
<div class="line"><span class="lineno">  533</span>          &lt;&lt; <span class="stringliteral">&quot;, t:&quot;</span> &lt;&lt; <a class="code hl_function" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5">std::to_string</a>(rclcpp::Time(jmt_tpp.target_time).seconds())</div>
<div class="line"><span class="lineno">  534</span>          &lt;&lt; <span class="stringliteral">&quot;, prev_speed: &quot;</span> &lt;&lt; prev_speed &lt;&lt; <span class="stringliteral">&quot;, current_speed: &quot;</span> &lt;&lt; current_speed);</div>
<div class="line"><span class="lineno">  535</span>      }</div>
<div class="line"><span class="lineno">  536</span> </div>
<div class="line"><span class="lineno">  537</span>      jmt_trajectory_points.push_back(jmt_tpp);</div>
<div class="line"><span class="lineno">  538</span>      <span class="keywordtype">double</span> insta_decel = (current_speed - prev_speed) / (rclcpp::Time(jmt_trajectory_points.at(<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>).target_time).seconds() - rclcpp::Time(jmt_trajectory_points.at(<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> - 1).target_time).seconds());</div>
<div class="line"><span class="lineno">  539</span>      RCLCPP_DEBUG_STREAM(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(), <span class="stringliteral">&quot;insta_decel: &quot;</span> &lt;&lt; insta_decel );</div>
<div class="line"><span class="lineno">  540</span>      prev_speed = current_speed;</div>
<div class="line"><span class="lineno">  541</span>    }</div>
<div class="line"><span class="lineno">  542</span> </div>
<div class="line"><span class="lineno">  543</span>    jmt_trajectory.header = original_tp.header;</div>
<div class="line"><span class="lineno">  544</span>    jmt_trajectory.trajectory_id = original_tp.trajectory_id;</div>
<div class="line"><span class="lineno">  545</span>    jmt_trajectory.trajectory_points = jmt_trajectory_points;</div>
<div class="line"><span class="lineno">  546</span>    jmt_trajectory.initial_longitudinal_velocity = initial_velocity;</div>
<div class="line"><span class="lineno">  547</span>    <span class="keywordflow">return</span> jmt_trajectory;</div>
<div class="line"><span class="lineno">  548</span>  }</div>
<div class="ttc" id="aclassyield__plugin_1_1YieldPlugin_html_a1bc011c9c2db48289bf40214d972cec4"><div class="ttname"><a href="classyield__plugin_1_1YieldPlugin.html#a1bc011c9c2db48289bf40214d972cec4">yield_plugin::YieldPlugin::get_relative_downtracks</a></div><div class="ttdeci">std::vector&lt; double &gt; get_relative_downtracks(const carma_planning_msgs::msg::TrajectoryPlan &amp;trajectory_plan) const</div><div class="ttdoc">calculates distance between trajectory points in a plan</div><div class="ttdef"><b>Definition:</b> <a href="yield__plugin_8cpp_source.html#l00976">yield_plugin.cpp:976</a></div></div>
<div class="ttc" id="aclassyield__plugin_1_1YieldPlugin_html_ae7ffd46ccbae6de4b60a7f49a8cfa3d6"><div class="ttname"><a href="classyield__plugin_1_1YieldPlugin.html#ae7ffd46ccbae6de4b60a7f49a8cfa3d6">yield_plugin::YieldPlugin::polynomial_calc</a></div><div class="ttdeci">double polynomial_calc(std::vector&lt; double &gt; coeff, double x) const</div><div class="ttdoc">calculate quintic polynomial equation for a given x</div><div class="ttdef"><b>Definition:</b> <a href="yield__plugin_8cpp_source.html#l00991">yield_plugin.cpp:991</a></div></div>
<div class="ttc" id="aclassyield__plugin_1_1YieldPlugin_html_afeab08ed138eafe6e24abd775c3163dd"><div class="ttname"><a href="classyield__plugin_1_1YieldPlugin.html#afeab08ed138eafe6e24abd775c3163dd">yield_plugin::YieldPlugin::polynomial_calc_d</a></div><div class="ttdeci">double polynomial_calc_d(std::vector&lt; double &gt; coeff, double x) const</div><div class="ttdoc">calculate derivative of quintic polynomial equation for a given x</div><div class="ttdef"><b>Definition:</b> <a href="yield__plugin_8cpp_source.html#l01002">yield_plugin.cpp:1002</a></div></div>
<div class="ttc" id="anamespacebasic__autonomy_1_1smoothing_html_afb726e75a21ada8efa3ca5561ffc9984"><div class="ttname"><a href="namespacebasic__autonomy_1_1smoothing.html#afb726e75a21ada8efa3ca5561ffc9984">basic_autonomy::smoothing::moving_average_filter</a></div><div class="ttdeci">std::vector&lt; double &gt; moving_average_filter(const std::vector&lt; double &gt; input, int window_size, bool ignore_first_point=true)</div><div class="ttdoc">Extremely simplie moving average filter.</div><div class="ttdef"><b>Definition:</b> <a href="filters_8cpp_source.html#l00024">filters.cpp:24</a></div></div>
<div class="ttc" id="anamespaceyield__plugin_html_a6685355374aa80334c267d788788cb2f"><div class="ttname"><a href="namespaceyield__plugin.html#a6685355374aa80334c267d788788cb2f">yield_plugin::get_smallest_time_step_of_traj</a></div><div class="ttdeci">double get_smallest_time_step_of_traj(const carma_planning_msgs::msg::TrajectoryPlan &amp;original_tp)</div><div class="ttdef"><b>Definition:</b> <a href="yield__plugin_8cpp_source.html#l00388">yield_plugin.cpp:388</a></div></div>
<div class="ttc" id="astructYieldPluginConfig_html_a17c3152e5b5091ad40df3a4ee8969b25"><div class="ttname"><a href="structYieldPluginConfig.html#a17c3152e5b5091ad40df3a4ee8969b25">YieldPluginConfig::max_stop_speed_in_ms</a></div><div class="ttdeci">double max_stop_speed_in_ms</div><div class="ttdef"><b>Definition:</b> <a href="yield__config_8hpp_source.html#l00035">yield_config.hpp:35</a></div></div>
<div class="ttc" id="astructYieldPluginConfig_html_a712ad260a3344fe9828d6022211743fe"><div class="ttname"><a href="structYieldPluginConfig.html#a712ad260a3344fe9828d6022211743fe">YieldPluginConfig::speed_moving_average_window_size</a></div><div class="ttdeci">double speed_moving_average_window_size</div><div class="ttdef"><b>Definition:</b> <a href="yield__config_8hpp_source.html#l00045">yield_config.hpp:45</a></div></div>
<div class="ttc" id="ayield__plugin_8cpp_html_a6f9399eaf2efb1b12e797b77909df9ac"><div class="ttname"><a href="yield__plugin_8cpp.html#a6f9399eaf2efb1b12e797b77909df9ac">EPSILON</a></div><div class="ttdeci">constexpr auto EPSILON</div><div class="ttdef"><b>Definition:</b> <a href="yield__plugin_8cpp_source.html#l00041">yield_plugin.cpp:41</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="yield__plugin_8hpp_source.html#l00312">config_</a>, <a class="el" href="yield__plugin_8cpp_source.html#l00041">EPSILON</a>, <a class="el" href="yield__plugin_8cpp_source.html#l00976">get_relative_downtracks()</a>, <a class="el" href="yield__plugin_8cpp_source.html#l00388">yield_plugin::get_smallest_time_step_of_traj()</a>, <a class="el" href="process__bag_8py_source.html#l00059">process_bag::i</a>, <a class="el" href="yield__config_8hpp_source.html#l00035">YieldPluginConfig::max_stop_speed_in_ms</a>, <a class="el" href="filters_8cpp_source.html#l00024">basic_autonomy::smoothing::moving_average_filter()</a>, <a class="el" href="yield__plugin_8hpp_source.html#l00315">nh_</a>, <a class="el" href="yield__plugin_8cpp_source.html#l00991">polynomial_calc()</a>, <a class="el" href="yield__plugin_8cpp_source.html#l01002">polynomial_calc_d()</a>, <a class="el" href="yield__config_8hpp_source.html#l00045">YieldPluginConfig::speed_moving_average_window_size</a>, and <a class="el" href="utm__zone_8cpp_source.html#l00021">carma_cooperative_perception::to_string()</a>.</p>

<p class="reference">Referenced by <a class="el" href="yield__plugin_8cpp_source.html#l00317">update_traj_for_cooperative_behavior()</a>, and <a class="el" href="yield__plugin_8cpp_source.html#l00888">update_traj_for_object()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classyield__plugin_1_1YieldPlugin_ace53f1895cbbf2a5f109cbfc11d6313f_cgraph.png" border="0" usemap="#aclassyield__plugin_1_1YieldPlugin_ace53f1895cbbf2a5f109cbfc11d6313f_cgraph" alt=""/></div>
<map name="aclassyield__plugin_1_1YieldPlugin_ace53f1895cbbf2a5f109cbfc11d6313f_cgraph" id="aclassyield__plugin_1_1YieldPlugin_ace53f1895cbbf2a5f109cbfc11d6313f_cgraph">
<area shape="rect" title="generate a Jerk Minimizing Trajectory(JMT) with the provided start and end conditions" alt="" coords="5,169,176,211"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#a1bc011c9c2db48289bf40214d972cec4" title="calculates distance between trajectory points in a plan" alt="" coords="239,5,408,47"/>
<area shape="rect" href="namespaceyield__plugin.html#a6685355374aa80334c267d788788cb2f" title=" " alt="" coords="239,71,408,112"/>
<area shape="rect" href="namespacebasic__autonomy_1_1smoothing.html#afb726e75a21ada8efa3ca5561ffc9984" title="Extremely simplie moving average filter." alt="" coords="232,136,415,177"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#ae7ffd46ccbae6de4b60a7f49a8cfa3d6" title="calculate quintic polynomial equation for a given x" alt="" coords="243,201,403,243"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#afeab08ed138eafe6e24abd775c3163dd" title="calculate derivative of quintic polynomial equation for a given x" alt="" coords="243,267,403,308"/>
<area shape="rect" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5" title=" " alt="" coords="224,356,423,397"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classyield__plugin_1_1YieldPlugin_ace53f1895cbbf2a5f109cbfc11d6313f_icgraph.png" border="0" usemap="#aclassyield__plugin_1_1YieldPlugin_ace53f1895cbbf2a5f109cbfc11d6313f_icgraph" alt=""/></div>
<map name="aclassyield__plugin_1_1YieldPlugin_ace53f1895cbbf2a5f109cbfc11d6313f_icgraph" id="aclassyield__plugin_1_1YieldPlugin_ace53f1895cbbf2a5f109cbfc11d6313f_icgraph">
<area shape="rect" title="generate a Jerk Minimizing Trajectory(JMT) with the provided start and end conditions" alt="" coords="456,49,627,90"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#ad9c9e0e4278774a519de12a6a5f4398f" title="update trajectory for yielding to an incoming cooperative behavior" alt="" coords="220,5,408,61"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#ac1c423b99887ccbf945a86da7b7809f6" title="trajectory is modified to safely avoid obstacles on the road" alt="" coords="234,85,394,126"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#a0fd790e287683a2ef404e16a15e0ea29" title="Service callback for trajectory planning." alt="" coords="5,49,172,90"/>
</map>
</div>

</div>
</div>
<a id="ab60b2f939cebede3a6d9a3ae5529b0d9" name="ab60b2f939cebede3a6d9a3ae5529b0d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab60b2f939cebede3a6d9a3ae5529b0d9">&#9670;&nbsp;</a></span>get_collision()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::optional&lt; <a class="el" href="structyield__plugin_1_1GetCollisionResult.html">GetCollisionResult</a> &gt; yield_plugin::YieldPlugin::get_collision </td>
          <td>(</td>
          <td class="paramtype">const carma_planning_msgs::msg::TrajectoryPlan &amp;&#160;</td>
          <td class="paramname"><em>trajectory1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; carma_perception_msgs::msg::PredictedState &gt; &amp;&#160;</td>
          <td class="paramname"><em>trajectory2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>collision_radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>trajectory1_max_speed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return naive collision time and locations based on collision radius given two trajectories with one being obstacle's predicted steps. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">trajectory1</td><td>trajectory of the ego vehicle </td></tr>
    <tr><td class="paramname">trajectory2</td><td>trajectory of predicted steps </td></tr>
    <tr><td class="paramname">collision_radius</td><td>a distance to check between two trajectory points at a same timestamp that is considered a collision </td></tr>
    <tr><td class="paramname">trajectory1_max_speed</td><td>max speed of the trajectory1 to efficiently traverse through possible collision combination of the two trajectories NOTE: Currently Traj2 is assumed to be a simple cv model to save computational performance NOTE: Collisions are based on only collision radius at the same predicted time even if ego vehicle maybe past the obstacle. To filter these cases, see <code><a class="el" href="classyield__plugin_1_1YieldPlugin.html#ae1279ff6d53eb474b635f992ed854d0b" title="Check if object location is behind the vehicle using estimates of the vehicle&#39;s length and route down...">is_object_behind_vehicle()</a></code> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>data of time of collision if detected, otherwise, std::nullopt </dd></dl>

<p class="definition">Definition at line <a class="el" href="yield__plugin_8cpp_source.html#l00550">550</a> of file <a class="el" href="yield__plugin_8cpp_source.html">yield_plugin.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  552</span>  {</div>
<div class="line"><span class="lineno">  553</span> </div>
<div class="line"><span class="lineno">  554</span>    <span class="comment">// Iterate through each pair of consecutive points in the trajectories</span></div>
<div class="line"><span class="lineno">  555</span>    RCLCPP_DEBUG_STREAM(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(), <span class="stringliteral">&quot;Starting a new collision detection, trajectory size: &quot;</span></div>
<div class="line"><span class="lineno">  556</span>      &lt;&lt; trajectory1.trajectory_points.size() &lt;&lt; <span class="stringliteral">&quot;. prediction size: &quot;</span> &lt;&lt; trajectory2.size());</div>
<div class="line"><span class="lineno">  557</span> </div>
<div class="line"><span class="lineno">  558</span>    <span class="comment">// Iterate through the object to check if it&#39;s on the route</span></div>
<div class="line"><span class="lineno">  559</span>    <span class="keywordtype">bool</span> on_route = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  560</span>    <span class="keywordtype">int</span> on_route_idx = 0;</div>
<div class="line"><span class="lineno">  561</span> </div>
<div class="line"><span class="lineno">  562</span>    <span class="comment">// A flag to stop searching more than one lanelet if the object has no velocity</span></div>
<div class="line"><span class="lineno">  563</span>    <span class="keyword">const</span> <span class="keyword">auto</span> traj2_speed{std::hypot(trajectory2.front().predicted_velocity.linear.x,</div>
<div class="line"><span class="lineno">  564</span>                                  trajectory2.front().predicted_velocity.linear.y)};</div>
<div class="line"><span class="lineno">  565</span>    <span class="keywordtype">bool</span> traj2_has_zero_speed = traj2_speed &lt; <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#ab1f62a493a4229d4801841eb19fb1e7d">config_</a>.<a class="code hl_variable" href="structYieldPluginConfig.html#abe6d1c18b2a7f34566828c71eb4573ef">obstacle_zero_speed_threshold_in_ms</a>;</div>
<div class="line"><span class="lineno">  566</span> </div>
<div class="line"><span class="lineno">  567</span>    <span class="keywordflow">if</span> (trajectory2.size() &lt; 2)</div>
<div class="line"><span class="lineno">  568</span>    {</div>
<div class="line"><span class="lineno">  569</span>      <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;Object on ther road doesn&#39;t have enough predicted states! Please check motion_computation is correctly applying predicted states&quot;</span>);</div>
<div class="line"><span class="lineno">  570</span>    }</div>
<div class="line"><span class="lineno">  571</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> predict_step_duration = (rclcpp::Time(trajectory2.at(1).header.stamp) - rclcpp::Time(trajectory2.front().header.stamp)).seconds();</div>
<div class="line"><span class="lineno">  572</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> predict_total_duration = <a class="code hl_function" href="namespaceyield__plugin.html#ad78fa1e6a7a22eff6b76dd32700fc55f">get_trajectory_duration</a>(trajectory2);</div>
<div class="line"><span class="lineno">  573</span> </div>
<div class="line"><span class="lineno">  574</span>    <span class="keywordflow">if</span> (predict_step_duration &lt; 0.0)</div>
<div class="line"><span class="lineno">  575</span>    {</div>
<div class="line"><span class="lineno">  576</span>      <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;Predicted states of the object is malformed. Detected trajectory going backwards in time!&quot;</span>);</div>
<div class="line"><span class="lineno">  577</span>    }</div>
<div class="line"><span class="lineno">  578</span> </div>
<div class="line"><span class="lineno">  579</span>    <span class="comment">// In order to optimize the for loops for comparing two trajectories, following logic skips every iteration_stride-th points of the traj2.</span></div>
<div class="line"><span class="lineno">  580</span>    <span class="comment">// Since skipping number of points from the traj2 may result in ignoring potential collisions, its value is dependent on two</span></div>
<div class="line"><span class="lineno">  581</span>    <span class="comment">// trajectories&#39; speeds and intervehicle_collision_distance_in_m radius.</span></div>
<div class="line"><span class="lineno">  582</span>    <span class="comment">// Therefore, the derivation first calculates the max time, t, that both actors can move while still being in collision radius:</span></div>
<div class="line"><span class="lineno">  583</span>    <span class="comment">// sqrt( (v1 * t / 2)^2 + (v2 * t / 2)^2 ) = collision_radius. Here v1 and v2 are assumed to be perpendicular to each other and</span></div>
<div class="line"><span class="lineno">  584</span>    <span class="comment">// intersecting at t/2 to get max possible collision_radius. Solving for t gives following:</span></div>
<div class="line"><span class="lineno">  585</span>    <span class="keywordtype">double</span> iteration_stride_max_time_s = 2 * <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#ab1f62a493a4229d4801841eb19fb1e7d">config_</a>.<a class="code hl_variable" href="structYieldPluginConfig.html#a9c609df9146f9f8dbbf4838decc6fb0b">intervehicle_collision_distance_in_m</a> / sqrt(pow(traj2_speed, 2) + pow(trajectory1_max_speed, 2));</div>
<div class="line"><span class="lineno">  586</span>    <span class="keywordtype">int</span> iteration_stride = std::max(1, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(iteration_stride_max_time_s / predict_step_duration));</div>
<div class="line"><span class="lineno">  587</span> </div>
<div class="line"><span class="lineno">  588</span>    RCLCPP_DEBUG_STREAM(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(), <span class="stringliteral">&quot;Determined iteration_stride: &quot;</span> &lt;&lt; iteration_stride</div>
<div class="line"><span class="lineno">  589</span>      &lt;&lt; <span class="stringliteral">&quot;, with traj2_speed: &quot;</span> &lt;&lt; traj2_speed</div>
<div class="line"><span class="lineno">  590</span>      &lt;&lt; <span class="stringliteral">&quot;, with trajectory1_max_speed: &quot;</span> &lt;&lt; trajectory1_max_speed</div>
<div class="line"><span class="lineno">  591</span>      &lt;&lt; <span class="stringliteral">&quot;, with predict_step_duration: &quot;</span> &lt;&lt; predict_step_duration</div>
<div class="line"><span class="lineno">  592</span>      &lt;&lt; <span class="stringliteral">&quot;, iteration_stride_max_time_s: &quot;</span> &lt;&lt; iteration_stride_max_time_s);</div>
<div class="line"><span class="lineno">  593</span> </div>
<div class="line"><span class="lineno">  594</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; trajectory2.size(); j += iteration_stride) <span class="comment">// Saving computation time aiming for 1.5 meter interval</span></div>
<div class="line"><span class="lineno">  595</span>    {</div>
<div class="line"><span class="lineno">  596</span>      lanelet::BasicPoint2d curr_point;</div>
<div class="line"><span class="lineno">  597</span>      curr_point.x() = trajectory2.at(j).predicted_position.position.x;</div>
<div class="line"><span class="lineno">  598</span>      curr_point.y() = trajectory2.at(j).predicted_position.position.y;</div>
<div class="line"><span class="lineno">  599</span> </div>
<div class="line"><span class="lineno">  600</span>      <span class="keyword">auto</span> corresponding_lanelets = <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aff229ed7bba2a76d0b1b99a83b9fdf88">wm_</a>-&gt;getLaneletsFromPoint(curr_point, 8); <span class="comment">// some intersection can have 8 overlapping lanelets</span></div>
<div class="line"><span class="lineno">  601</span> </div>
<div class="line"><span class="lineno">  602</span>      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; llt: corresponding_lanelets)</div>
<div class="line"><span class="lineno">  603</span>      {</div>
<div class="line"><span class="lineno">  604</span>        RCLCPP_DEBUG_STREAM(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(), <span class="stringliteral">&quot;Checking llt: &quot;</span> &lt;&lt; llt.id());</div>
<div class="line"><span class="lineno">  605</span> </div>
<div class="line"><span class="lineno">  606</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#a03f092d19aab7369af56f9438938d454">route_llt_ids_</a>.find(llt.id()) != <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#a03f092d19aab7369af56f9438938d454">route_llt_ids_</a>.end())</div>
<div class="line"><span class="lineno">  607</span>        {</div>
<div class="line"><span class="lineno">  608</span>          on_route = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  609</span>          on_route_idx = j;</div>
<div class="line"><span class="lineno">  610</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  611</span>        }</div>
<div class="line"><span class="lineno">  612</span>      }</div>
<div class="line"><span class="lineno">  613</span>      <span class="keywordflow">if</span> (on_route || traj2_has_zero_speed)</div>
<div class="line"><span class="lineno">  614</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  615</span>    }</div>
<div class="line"><span class="lineno">  616</span> </div>
<div class="line"><span class="lineno">  617</span>    <span class="keywordflow">if</span> (!on_route)</div>
<div class="line"><span class="lineno">  618</span>    {</div>
<div class="line"><span class="lineno">  619</span>      RCLCPP_DEBUG(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(), <span class="stringliteral">&quot;Predicted states are not on the route! ignoring&quot;</span>);</div>
<div class="line"><span class="lineno">  620</span>      <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><span class="lineno">  621</span>    }</div>
<div class="line"><span class="lineno">  622</span> </div>
<div class="line"><span class="lineno">  623</span>    <span class="keywordtype">double</span> smallest_dist = std::numeric_limits&lt;double&gt;::infinity();</div>
<div class="line"><span class="lineno">  624</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> = 0; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> &lt; trajectory1.trajectory_points.size() - 1; ++<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>)</div>
<div class="line"><span class="lineno">  625</span>    {</div>
<div class="line"><span class="lineno">  626</span>      <span class="keyword">auto</span> p1a = trajectory1.trajectory_points.at(<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>);</div>
<div class="line"><span class="lineno">  627</span>      <span class="keyword">auto</span> p1b = trajectory1.trajectory_points.at(<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> + 1);</div>
<div class="line"><span class="lineno">  628</span>      <span class="keywordtype">double</span> previous_distance_between_predictions = std::numeric_limits&lt;double&gt;::infinity();</div>
<div class="line"><span class="lineno">  629</span>      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = on_route_idx; j &lt; trajectory2.size() - 1; j += iteration_stride)</div>
<div class="line"><span class="lineno">  630</span>      {</div>
<div class="line"><span class="lineno">  631</span>        <span class="keyword">auto</span> p2a = trajectory2.at(j);</div>
<div class="line"><span class="lineno">  632</span>        <span class="keyword">auto</span> p2b = trajectory2.at(j + 1);</div>
<div class="line"><span class="lineno">  633</span>        <span class="keywordtype">double</span> p1a_t = rclcpp::Time(p1a.target_time).seconds();</div>
<div class="line"><span class="lineno">  634</span>        <span class="keywordtype">double</span> p1b_t = rclcpp::Time(p1b.target_time).seconds();</div>
<div class="line"><span class="lineno">  635</span>        <span class="keywordtype">double</span> p2a_t = rclcpp::Time(p2a.header.stamp).seconds();</div>
<div class="line"><span class="lineno">  636</span>        <span class="keywordtype">double</span> p2b_t = rclcpp::Time(p2b.header.stamp).seconds();</div>
<div class="line"><span class="lineno">  637</span> </div>
<div class="line"><span class="lineno">  638</span>        RCLCPP_DEBUG_STREAM(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(), <span class="stringliteral">&quot;p1a.target_time: &quot;</span> &lt;&lt; <a class="code hl_function" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5">std::to_string</a>(p1a_t) &lt;&lt; <span class="stringliteral">&quot;, p1b.target_time: &quot;</span> &lt;&lt; <a class="code hl_function" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5">std::to_string</a>(p1b_t));</div>
<div class="line"><span class="lineno">  639</span>        RCLCPP_DEBUG_STREAM(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(), <span class="stringliteral">&quot;p2a.target_time: &quot;</span> &lt;&lt; <a class="code hl_function" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5">std::to_string</a>(p2a_t) &lt;&lt; <span class="stringliteral">&quot;, p2b.target_time: &quot;</span> &lt;&lt; <a class="code hl_function" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5">std::to_string</a>(p2b_t));</div>
<div class="line"><span class="lineno">  640</span>        RCLCPP_DEBUG_STREAM(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(), <span class="stringliteral">&quot;p1a.x: &quot;</span> &lt;&lt; p1a.x &lt;&lt; <span class="stringliteral">&quot;, p1a.y: &quot;</span> &lt;&lt; p1a.y);</div>
<div class="line"><span class="lineno">  641</span>        RCLCPP_DEBUG_STREAM(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(), <span class="stringliteral">&quot;p1b.x: &quot;</span> &lt;&lt; p1b.x &lt;&lt; <span class="stringliteral">&quot;, p1b.y: &quot;</span> &lt;&lt; p1b.y);</div>
<div class="line"><span class="lineno">  642</span> </div>
<div class="line"><span class="lineno">  643</span>        RCLCPP_DEBUG_STREAM(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(), <span class="stringliteral">&quot;p2a.x: &quot;</span> &lt;&lt; p2a.predicted_position.position.x &lt;&lt; <span class="stringliteral">&quot;, p2a.y: &quot;</span> &lt;&lt; p2a.predicted_position.position.y);</div>
<div class="line"><span class="lineno">  644</span>        RCLCPP_DEBUG_STREAM(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(), <span class="stringliteral">&quot;p2b.x: &quot;</span> &lt;&lt; p2b.predicted_position.position.x &lt;&lt; <span class="stringliteral">&quot;, p2b.y: &quot;</span> &lt;&lt; p2b.predicted_position.position.y);</div>
<div class="line"><span class="lineno">  645</span> </div>
<div class="line"><span class="lineno">  646</span>        <span class="comment">// Linearly interpolate positions at a common timestamp for both trajectories</span></div>
<div class="line"><span class="lineno">  647</span>        <span class="keywordtype">double</span> dt = (p2a_t - p1a_t) / (p1b_t - p1a_t);</div>
<div class="line"><span class="lineno">  648</span>        <span class="keywordtype">double</span> x1 = p1a.x + dt * (p1b.x - p1a.x);</div>
<div class="line"><span class="lineno">  649</span>        <span class="keywordtype">double</span> y1 = p1a.y + dt * (p1b.y - p1a.y);</div>
<div class="line"><span class="lineno">  650</span>        <span class="keywordtype">double</span> x2 = p2a.predicted_position.position.x;</div>
<div class="line"><span class="lineno">  651</span>        <span class="keywordtype">double</span> y2 = p2a.predicted_position.position.y;</div>
<div class="line"><span class="lineno">  652</span> </div>
<div class="line"><span class="lineno">  653</span>        <span class="comment">// Calculate the distance between the two interpolated points</span></div>
<div class="line"><span class="lineno">  654</span>        <span class="keyword">const</span> <span class="keyword">auto</span> distance{std::hypot(x1 - x2, y1 - y2)};</div>
<div class="line"><span class="lineno">  655</span> </div>
<div class="line"><span class="lineno">  656</span>        smallest_dist = std::min(distance, smallest_dist);</div>
<div class="line"><span class="lineno">  657</span>        RCLCPP_DEBUG_STREAM(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(), <span class="stringliteral">&quot;Smallest_dist: &quot;</span> &lt;&lt; smallest_dist &lt;&lt; <span class="stringliteral">&quot;, distance: &quot;</span> &lt;&lt; distance &lt;&lt; <span class="stringliteral">&quot;, dt: &quot;</span> &lt;&lt; dt</div>
<div class="line"><span class="lineno">  658</span>          &lt;&lt; <span class="stringliteral">&quot;, x1: &quot;</span> &lt;&lt; x1 &lt;&lt; <span class="stringliteral">&quot;, y1: &quot;</span> &lt;&lt; y1</div>
<div class="line"><span class="lineno">  659</span>          &lt;&lt; <span class="stringliteral">&quot;, x2: &quot;</span> &lt;&lt; x2 &lt;&lt; <span class="stringliteral">&quot;, y2: &quot;</span> &lt;&lt; y2</div>
<div class="line"><span class="lineno">  660</span>          &lt;&lt; <span class="stringliteral">&quot;, p2a_t:&quot;</span> &lt;&lt; <a class="code hl_function" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5">std::to_string</a>(p2a_t));</div>
<div class="line"><span class="lineno">  661</span> </div>
<div class="line"><span class="lineno">  662</span>        <span class="comment">// Following &quot;if logic&quot; assumes the traj2 is a simple cv model, aka, traj2 point is a straight line over time.</span></div>
<div class="line"><span class="lineno">  663</span>        <span class="comment">// And current traj1 point is fixed in this iteration.</span></div>
<div class="line"><span class="lineno">  664</span>        <span class="comment">// Then once the distance between the two start to increase over traj2 iteration,</span></div>
<div class="line"><span class="lineno">  665</span>        <span class="comment">// the distance will always increase and it&#39;s unnecessary to continue the logic to find the smallest_dist</span></div>
<div class="line"><span class="lineno">  666</span>        <span class="keywordflow">if</span> (previous_distance_between_predictions &lt; distance)</div>
<div class="line"><span class="lineno">  667</span>        {</div>
<div class="line"><span class="lineno">  668</span>          RCLCPP_DEBUG_STREAM(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(), <span class="stringliteral">&quot;Stopping search here because the distance between predictions started to increase&quot;</span>);</div>
<div class="line"><span class="lineno">  669</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  670</span>        }</div>
<div class="line"><span class="lineno">  671</span>        previous_distance_between_predictions = distance;</div>
<div class="line"><span class="lineno">  672</span> </div>
<div class="line"><span class="lineno">  673</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> == 0 &amp;&amp; j == 0 &amp;&amp; distance &gt; <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#ab1f62a493a4229d4801841eb19fb1e7d">config_</a>.<a class="code hl_variable" href="structYieldPluginConfig.html#a1e7bba4a59d1301d477e64ad1a403cee">collision_check_radius_in_m</a>)</div>
<div class="line"><span class="lineno">  674</span>        {</div>
<div class="line"><span class="lineno">  675</span>          RCLCPP_DEBUG(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(), <span class="stringliteral">&quot;Too far away&quot;</span> );</div>
<div class="line"><span class="lineno">  676</span>          <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><span class="lineno">  677</span>        }</div>
<div class="line"><span class="lineno">  678</span> </div>
<div class="line"><span class="lineno">  679</span>        <span class="keywordflow">if</span> (distance &gt; collision_radius)</div>
<div class="line"><span class="lineno">  680</span>        {</div>
<div class="line"><span class="lineno">  681</span>          <span class="comment">// continue searching for collision</span></div>
<div class="line"><span class="lineno">  682</span>          <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  683</span>        }</div>
<div class="line"><span class="lineno">  684</span> </div>
<div class="line"><span class="lineno">  685</span>        GetCollisionResult collision_result;</div>
<div class="line"><span class="lineno">  686</span>        collision_result.point1 = lanelet::BasicPoint2d(x1,y1);</div>
<div class="line"><span class="lineno">  687</span>        collision_result.point2 = lanelet::BasicPoint2d(x2,y2);</div>
<div class="line"><span class="lineno">  688</span>        collision_result.collision_time = rclcpp::Time(p2a.header.stamp);</div>
<div class="line"><span class="lineno">  689</span>        <span class="keywordflow">return</span> collision_result;</div>
<div class="line"><span class="lineno">  690</span>      }</div>
<div class="line"><span class="lineno">  691</span>    }</div>
<div class="line"><span class="lineno">  692</span> </div>
<div class="line"><span class="lineno">  693</span>    <span class="comment">// No collision detected</span></div>
<div class="line"><span class="lineno">  694</span>    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><span class="lineno">  695</span>  }</div>
<div class="ttc" id="aclassyield__plugin_1_1YieldPlugin_html_a03f092d19aab7369af56f9438938d454"><div class="ttname"><a href="classyield__plugin_1_1YieldPlugin.html#a03f092d19aab7369af56f9438938d454">yield_plugin::YieldPlugin::route_llt_ids_</a></div><div class="ttdeci">std::set&lt; lanelet::Id &gt; route_llt_ids_</div><div class="ttdef"><b>Definition:</b> <a href="yield__plugin_8hpp_source.html#l00316">yield_plugin.hpp:316</a></div></div>
<div class="ttc" id="anamespaceyield__plugin_html_ad78fa1e6a7a22eff6b76dd32700fc55f"><div class="ttname"><a href="namespaceyield__plugin.html#ad78fa1e6a7a22eff6b76dd32700fc55f">yield_plugin::get_trajectory_duration</a></div><div class="ttdeci">double get_trajectory_duration(const carma_planning_msgs::msg::TrajectoryPlan &amp;trajectory)</div><div class="ttdef"><b>Definition:</b> <a href="yield__plugin_8cpp_source.html#l00063">yield_plugin.cpp:63</a></div></div>
<div class="ttc" id="astructYieldPluginConfig_html_a1e7bba4a59d1301d477e64ad1a403cee"><div class="ttname"><a href="structYieldPluginConfig.html#a1e7bba4a59d1301d477e64ad1a403cee">YieldPluginConfig::collision_check_radius_in_m</a></div><div class="ttdeci">double collision_check_radius_in_m</div><div class="ttdef"><b>Definition:</b> <a href="yield__config_8hpp_source.html#l00046">yield_config.hpp:46</a></div></div>
<div class="ttc" id="astructYieldPluginConfig_html_abe6d1c18b2a7f34566828c71eb4573ef"><div class="ttname"><a href="structYieldPluginConfig.html#abe6d1c18b2a7f34566828c71eb4573ef">YieldPluginConfig::obstacle_zero_speed_threshold_in_ms</a></div><div class="ttdeci">double obstacle_zero_speed_threshold_in_ms</div><div class="ttdef"><b>Definition:</b> <a href="yield__config_8hpp_source.html#l00028">yield_config.hpp:28</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="yield__config_8hpp_source.html#l00046">YieldPluginConfig::collision_check_radius_in_m</a>, <a class="el" href="yield__plugin_8hpp_source.html#l00068">yield_plugin::GetCollisionResult::collision_time</a>, <a class="el" href="yield__plugin_8hpp_source.html#l00312">config_</a>, <a class="el" href="yield__plugin_8cpp_source.html#l00063">yield_plugin::get_trajectory_duration()</a>, <a class="el" href="process__bag_8py_source.html#l00059">process_bag::i</a>, <a class="el" href="yield__config_8hpp_source.html#l00040">YieldPluginConfig::intervehicle_collision_distance_in_m</a>, <a class="el" href="yield__plugin_8hpp_source.html#l00315">nh_</a>, <a class="el" href="yield__config_8hpp_source.html#l00028">YieldPluginConfig::obstacle_zero_speed_threshold_in_ms</a>, <a class="el" href="yield__plugin_8hpp_source.html#l00069">yield_plugin::GetCollisionResult::point1</a>, <a class="el" href="yield__plugin_8hpp_source.html#l00070">yield_plugin::GetCollisionResult::point2</a>, <a class="el" href="yield__plugin_8hpp_source.html#l00316">route_llt_ids_</a>, <a class="el" href="utm__zone_8cpp_source.html#l00021">carma_cooperative_perception::to_string()</a>, and <a class="el" href="yield__plugin_8hpp_source.html#l00311">wm_</a>.</p>

<p class="reference">Referenced by <a class="el" href="yield__plugin_8cpp_source.html#l00723">get_collision_time()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classyield__plugin_1_1YieldPlugin_ab60b2f939cebede3a6d9a3ae5529b0d9_cgraph.png" border="0" usemap="#aclassyield__plugin_1_1YieldPlugin_ab60b2f939cebede3a6d9a3ae5529b0d9_cgraph" alt=""/></div>
<map name="aclassyield__plugin_1_1YieldPlugin_ab60b2f939cebede3a6d9a3ae5529b0d9_cgraph" id="aclassyield__plugin_1_1YieldPlugin_ab60b2f939cebede3a6d9a3ae5529b0d9_cgraph">
<area shape="rect" title="Return naive collision time and locations based on collision radius given two trajectories with one b..." alt="" coords="5,83,165,124"/>
<area shape="rect" href="namespaceyield__plugin.html#ad78fa1e6a7a22eff6b76dd32700fc55f" title=" " alt="" coords="226,37,399,79"/>
<area shape="rect" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5" title=" " alt="" coords="213,127,412,168"/>
<area shape="rect" href="namespaceyield__plugin.html#a82b2a694528d42a4af068732befca882" title=" " alt="" coords="460,5,633,47"/>
<area shape="rect" href="namespaceyield__plugin.html#a754c9aebad547b09cdeff7080a639bd3" title=" " alt="" coords="460,71,633,112"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classyield__plugin_1_1YieldPlugin_ab60b2f939cebede3a6d9a3ae5529b0d9_icgraph.png" border="0" usemap="#aclassyield__plugin_1_1YieldPlugin_ab60b2f939cebede3a6d9a3ae5529b0d9_icgraph" alt=""/></div>
<map name="aclassyield__plugin_1_1YieldPlugin_ab60b2f939cebede3a6d9a3ae5529b0d9_icgraph" id="aclassyield__plugin_1_1YieldPlugin_ab60b2f939cebede3a6d9a3ae5529b0d9_icgraph">
<area shape="rect" title="Return naive collision time and locations based on collision radius given two trajectories with one b..." alt="" coords="1108,13,1268,54"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#a5644e9f63528efc0484b875c7debef01" title="Return collision time given two trajectories with one being external object with predicted steps." alt="" coords="900,13,1060,54"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#aae4fab3792eaa78de9a88299c209246d" title="Given the list of objects with predicted states, get all collision times concurrently using multi&#45;thr..." alt="" coords="636,13,852,54"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#a546149400d9d6371c5de50f229d6ecfc" title="Return the earliest collision object and time of collision pair from the given trajectory and list of..." alt="" coords="428,5,588,61"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#ac1c423b99887ccbf945a86da7b7809f6" title="trajectory is modified to safely avoid obstacles on the road" alt="" coords="220,13,380,54"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#a0fd790e287683a2ef404e16a15e0ea29" title="Service callback for trajectory planning." alt="" coords="5,13,172,54"/>
</map>
</div>

</div>
</div>
<a id="a5644e9f63528efc0484b875c7debef01" name="a5644e9f63528efc0484b875c7debef01"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5644e9f63528efc0484b875c7debef01">&#9670;&nbsp;</a></span>get_collision_time()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::optional&lt; rclcpp::Time &gt; yield_plugin::YieldPlugin::get_collision_time </td>
          <td>(</td>
          <td class="paramtype">const carma_planning_msgs::msg::TrajectoryPlan &amp;&#160;</td>
          <td class="paramname"><em>original_tp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const carma_perception_msgs::msg::ExternalObject &amp;&#160;</td>
          <td class="paramname"><em>curr_obstacle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>original_tp_max_speed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return collision time given two trajectories with one being external object with predicted steps. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">trajectory1</td><td>trajectory of the ego vehicle </td></tr>
    <tr><td class="paramname">trajectory2</td><td>trajectory of the obstacle </td></tr>
    <tr><td class="paramname">original_tp_max_speed</td><td>max speed of the original_tp to efficiently traverse through possible collision combination of the two trajectories NOTE: Currently curr_obstacle is assumed to be using a simple cv model to save computational performance </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>time_of_collision if collision detected, otherwise, std::nullopt </dd></dl>

<p class="definition">Definition at line <a class="el" href="yield__plugin_8cpp_source.html#l00723">723</a> of file <a class="el" href="yield__plugin_8cpp_source.html">yield_plugin.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  725</span>  {</div>
<div class="line"><span class="lineno">  726</span>    <span class="keyword">auto</span> plan_start_time = <a class="code hl_function" href="namespaceyield__plugin.html#a754c9aebad547b09cdeff7080a639bd3">get_trajectory_start_time</a>(original_tp);</div>
<div class="line"><span class="lineno">  727</span> </div>
<div class="line"><span class="lineno">  728</span>    RCLCPP_DEBUG_STREAM(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(), <span class="stringliteral">&quot;Object&#39;s back time: &quot;</span> &lt;&lt; <a class="code hl_function" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5">std::to_string</a>(rclcpp::Time(curr_obstacle.predictions.back().header.stamp).seconds())</div>
<div class="line"><span class="lineno">  729</span>      &lt;&lt; <span class="stringliteral">&quot;, plan_start_time: &quot;</span> &lt;&lt; <a class="code hl_function" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5">std::to_string</a>(plan_start_time));</div>
<div class="line"><span class="lineno">  730</span> </div>
<div class="line"><span class="lineno">  731</span>    <span class="comment">// do not process outdated objects</span></div>
<div class="line"><span class="lineno">  732</span>    <span class="keywordflow">if</span> (rclcpp::Time(curr_obstacle.predictions.back().header.stamp).seconds() &lt;= plan_start_time)</div>
<div class="line"><span class="lineno">  733</span>    {</div>
<div class="line"><span class="lineno">  734</span>      <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><span class="lineno">  735</span>    }</div>
<div class="line"><span class="lineno">  736</span> </div>
<div class="line"><span class="lineno">  737</span>    std::vector&lt;carma_perception_msgs::msg::PredictedState&gt; new_list;</div>
<div class="line"><span class="lineno">  738</span>    carma_perception_msgs::msg::PredictedState curr_state;</div>
<div class="line"><span class="lineno">  739</span>    <span class="comment">// artificially include current position as one of the predicted states</span></div>
<div class="line"><span class="lineno">  740</span>    curr_state.header.stamp = curr_obstacle.header.stamp;</div>
<div class="line"><span class="lineno">  741</span>    curr_state.predicted_position.position.x = curr_obstacle.pose.pose.position.x;</div>
<div class="line"><span class="lineno">  742</span>    curr_state.predicted_position.position.y = curr_obstacle.pose.pose.position.y;</div>
<div class="line"><span class="lineno">  743</span>    <span class="comment">// NOTE: predicted_velocity is not used for collision calculation, but timestamps</span></div>
<div class="line"><span class="lineno">  744</span>    curr_state.predicted_velocity.linear.x = curr_obstacle.velocity.twist.linear.x;</div>
<div class="line"><span class="lineno">  745</span>    curr_state.predicted_velocity.linear.y = curr_obstacle.velocity.twist.linear.y;</div>
<div class="line"><span class="lineno">  746</span>    RCLCPP_DEBUG_STREAM(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(), <span class="stringliteral">&quot;Object: &quot;</span> &lt;&lt; curr_obstacle.id &lt;&lt;<span class="stringliteral">&quot;, type: &quot;</span> &lt;&lt; <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(curr_obstacle.object_type)</div>
<div class="line"><span class="lineno">  747</span>      &lt;&lt; <span class="stringliteral">&quot;, speed_x: &quot;</span> &lt;&lt; curr_obstacle.velocity.twist.linear.x  &lt;&lt; <span class="stringliteral">&quot;, speed_y: &quot;</span> &lt;&lt; curr_obstacle.velocity.twist.linear.y);</div>
<div class="line"><span class="lineno">  748</span>    new_list.push_back(curr_state);</div>
<div class="line"><span class="lineno">  749</span>    new_list.insert(new_list.end(), curr_obstacle.predictions.cbegin(), curr_obstacle.predictions.cend());</div>
<div class="line"><span class="lineno">  750</span> </div>
<div class="line"><span class="lineno">  751</span>    <span class="keyword">const</span> <span class="keyword">auto</span> collision_result = <a class="code hl_function" href="classyield__plugin_1_1YieldPlugin.html#ab60b2f939cebede3a6d9a3ae5529b0d9">get_collision</a>(original_tp, new_list, <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#ab1f62a493a4229d4801841eb19fb1e7d">config_</a>.<a class="code hl_variable" href="structYieldPluginConfig.html#a9c609df9146f9f8dbbf4838decc6fb0b">intervehicle_collision_distance_in_m</a>, original_tp_max_speed);</div>
<div class="line"><span class="lineno">  752</span> </div>
<div class="line"><span class="lineno">  753</span>    <span class="keywordflow">if</span> (!collision_result)</div>
<div class="line"><span class="lineno">  754</span>    {</div>
<div class="line"><span class="lineno">  755</span>      <span class="comment">// reset the consecutive clearance counter because no collision was detected at this iteration</span></div>
<div class="line"><span class="lineno">  756</span>      <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#adc6d5d9e4116d9f6ca142e5bb2fd1bc8">consecutive_clearance_count_for_obstacles_</a>[curr_obstacle.id] = 0;</div>
<div class="line"><span class="lineno">  757</span>      <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><span class="lineno">  758</span>    }</div>
<div class="line"><span class="lineno">  759</span> </div>
<div class="line"><span class="lineno">  760</span>    <span class="comment">// if within collision radius, it is not a collision if obstacle is behind the vehicle despite being in collision radius</span></div>
<div class="line"><span class="lineno">  761</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> vehicle_downtrack = <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aff229ed7bba2a76d0b1b99a83b9fdf88">wm_</a>-&gt;routeTrackPos(collision_result.value().point1).downtrack;</div>
<div class="line"><span class="lineno">  762</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> object_downtrack = <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aff229ed7bba2a76d0b1b99a83b9fdf88">wm_</a>-&gt;routeTrackPos(collision_result.value().point2).downtrack;</div>
<div class="line"><span class="lineno">  763</span> </div>
<div class="line"><span class="lineno">  764</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="classyield__plugin_1_1YieldPlugin.html#ae1279ff6d53eb474b635f992ed854d0b">is_object_behind_vehicle</a>(curr_obstacle.id, collision_result.value().collision_time, vehicle_downtrack, object_downtrack))</div>
<div class="line"><span class="lineno">  765</span>    {</div>
<div class="line"><span class="lineno">  766</span>      RCLCPP_INFO_STREAM(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(), <span class="stringliteral">&quot;Confirmed that the object: &quot;</span> &lt;&lt; curr_obstacle.id &lt;&lt; <span class="stringliteral">&quot; is behind the vehicle at timestamp &quot;</span> &lt;&lt; <a class="code hl_function" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5">std::to_string</a>(collision_result.value().collision_time.seconds()));</div>
<div class="line"><span class="lineno">  767</span>      <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><span class="lineno">  768</span>    }</div>
<div class="line"><span class="lineno">  769</span> </div>
<div class="line"><span class="lineno">  770</span>    <span class="keyword">const</span> <span class="keyword">auto</span> distance{std::hypot(</div>
<div class="line"><span class="lineno">  771</span>      collision_result.value().point1.x() - collision_result.value().point2.x(),</div>
<div class="line"><span class="lineno">  772</span>      collision_result.value().point1.y() - collision_result.value().point2.y()</div>
<div class="line"><span class="lineno">  773</span>    )}; <span class="comment">//for debug</span></div>
<div class="line"><span class="lineno">  774</span> </div>
<div class="line"><span class="lineno">  775</span>    RCLCPP_WARN_STREAM(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(), <span class="stringliteral">&quot;Collision detected for object: &quot;</span> &lt;&lt; curr_obstacle.id &lt;&lt; <span class="stringliteral">&quot;, at timestamp &quot;</span> &lt;&lt; <a class="code hl_function" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5">std::to_string</a>(collision_result.value().collision_time.seconds()) &lt;&lt;</div>
<div class="line"><span class="lineno">  776</span>      <span class="stringliteral">&quot;, x: &quot;</span> &lt;&lt; collision_result.value().point1.x() &lt;&lt; <span class="stringliteral">&quot;, y: &quot;</span> &lt;&lt; collision_result.value().point1.y() &lt;&lt;</div>
<div class="line"><span class="lineno">  777</span>      <span class="stringliteral">&quot;, within actual downtrack distance: &quot;</span> &lt;&lt; object_downtrack - vehicle_downtrack &lt;&lt;</div>
<div class="line"><span class="lineno">  778</span>      <span class="stringliteral">&quot;, and collision distance: &quot;</span> &lt;&lt; distance);</div>
<div class="line"><span class="lineno">  779</span> </div>
<div class="line"><span class="lineno">  780</span>    <span class="keywordflow">return</span> collision_result.value().collision_time;</div>
<div class="line"><span class="lineno">  781</span>  }</div>
<div class="ttc" id="aclassyield__plugin_1_1YieldPlugin_html_ab60b2f939cebede3a6d9a3ae5529b0d9"><div class="ttname"><a href="classyield__plugin_1_1YieldPlugin.html#ab60b2f939cebede3a6d9a3ae5529b0d9">yield_plugin::YieldPlugin::get_collision</a></div><div class="ttdeci">std::optional&lt; GetCollisionResult &gt; get_collision(const carma_planning_msgs::msg::TrajectoryPlan &amp;trajectory1, const std::vector&lt; carma_perception_msgs::msg::PredictedState &gt; &amp;trajectory2, double collision_radius, double trajectory1_max_speed)</div><div class="ttdoc">Return naive collision time and locations based on collision radius given two trajectories with one b...</div><div class="ttdef"><b>Definition:</b> <a href="yield__plugin_8cpp_source.html#l00550">yield_plugin.cpp:550</a></div></div>
<div class="ttc" id="aclassyield__plugin_1_1YieldPlugin_html_adc6d5d9e4116d9f6ca142e5bb2fd1bc8"><div class="ttname"><a href="classyield__plugin_1_1YieldPlugin.html#adc6d5d9e4116d9f6ca142e5bb2fd1bc8">yield_plugin::YieldPlugin::consecutive_clearance_count_for_obstacles_</a></div><div class="ttdeci">std::unordered_map&lt; uint32_t, int &gt; consecutive_clearance_count_for_obstacles_</div><div class="ttdef"><b>Definition:</b> <a href="yield__plugin_8hpp_source.html#l00319">yield_plugin.hpp:319</a></div></div>
<div class="ttc" id="aclassyield__plugin_1_1YieldPlugin_html_ae1279ff6d53eb474b635f992ed854d0b"><div class="ttname"><a href="classyield__plugin_1_1YieldPlugin.html#ae1279ff6d53eb474b635f992ed854d0b">yield_plugin::YieldPlugin::is_object_behind_vehicle</a></div><div class="ttdeci">bool is_object_behind_vehicle(uint32_t object_id, const rclcpp::Time &amp;collision_time, double vehicle_point, double object_downtrack)</div><div class="ttdoc">Check if object location is behind the vehicle using estimates of the vehicle's length and route down...</div><div class="ttdef"><b>Definition:</b> <a href="yield__plugin_8cpp_source.html#l00697">yield_plugin.cpp:697</a></div></div>
<div class="ttc" id="anamespaceyield__plugin_html_a754c9aebad547b09cdeff7080a639bd3"><div class="ttname"><a href="namespaceyield__plugin.html#a754c9aebad547b09cdeff7080a639bd3">yield_plugin::get_trajectory_start_time</a></div><div class="ttdeci">double get_trajectory_start_time(const carma_planning_msgs::msg::TrajectoryPlan &amp;trajectory)</div><div class="ttdef"><b>Definition:</b> <a href="yield__plugin_8cpp_source.html#l00058">yield_plugin.cpp:58</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="yield__plugin_8hpp_source.html#l00312">config_</a>, <a class="el" href="yield__plugin_8hpp_source.html#l00319">consecutive_clearance_count_for_obstacles_</a>, <a class="el" href="yield__plugin_8cpp_source.html#l00550">get_collision()</a>, <a class="el" href="yield__plugin_8cpp_source.html#l00058">yield_plugin::get_trajectory_start_time()</a>, <a class="el" href="yield__config_8hpp_source.html#l00040">YieldPluginConfig::intervehicle_collision_distance_in_m</a>, <a class="el" href="yield__plugin_8cpp_source.html#l00697">is_object_behind_vehicle()</a>, <a class="el" href="yield__plugin_8hpp_source.html#l00315">nh_</a>, <a class="el" href="utm__zone_8cpp_source.html#l00021">carma_cooperative_perception::to_string()</a>, and <a class="el" href="yield__plugin_8hpp_source.html#l00311">wm_</a>.</p>

<p class="reference">Referenced by <a class="el" href="yield__plugin_8cpp_source.html#l00783">get_collision_times_concurrently()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classyield__plugin_1_1YieldPlugin_a5644e9f63528efc0484b875c7debef01_cgraph.png" border="0" usemap="#aclassyield__plugin_1_1YieldPlugin_a5644e9f63528efc0484b875c7debef01_cgraph" alt=""/></div>
<map name="aclassyield__plugin_1_1YieldPlugin_a5644e9f63528efc0484b875c7debef01_cgraph" id="aclassyield__plugin_1_1YieldPlugin_a5644e9f63528efc0484b875c7debef01_cgraph">
<area shape="rect" title="Return collision time given two trajectories with one being external object with predicted steps." alt="" coords="5,93,165,135"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#ab60b2f939cebede3a6d9a3ae5529b0d9" title="Return naive collision time and locations based on collision radius given two trajectories with one b..." alt="" coords="220,5,380,47"/>
<area shape="rect" href="namespaceyield__plugin.html#a754c9aebad547b09cdeff7080a639bd3" title=" " alt="" coords="681,125,855,167"/>
<area shape="rect" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5" title=" " alt="" coords="435,95,633,136"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#ae1279ff6d53eb474b635f992ed854d0b" title="Check if object location is behind the vehicle using estimates of the vehicle&#39;s length and route down..." alt="" coords="213,123,387,164"/>
<area shape="rect" href="namespaceyield__plugin.html#ad78fa1e6a7a22eff6b76dd32700fc55f" title=" " alt="" coords="447,5,621,47"/>
<area shape="rect" href="namespaceyield__plugin.html#a82b2a694528d42a4af068732befca882" title=" " alt="" coords="681,5,855,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classyield__plugin_1_1YieldPlugin_a5644e9f63528efc0484b875c7debef01_icgraph.png" border="0" usemap="#aclassyield__plugin_1_1YieldPlugin_a5644e9f63528efc0484b875c7debef01_icgraph" alt=""/></div>
<map name="aclassyield__plugin_1_1YieldPlugin_a5644e9f63528efc0484b875c7debef01_icgraph" id="aclassyield__plugin_1_1YieldPlugin_a5644e9f63528efc0484b875c7debef01_icgraph">
<area shape="rect" title="Return collision time given two trajectories with one being external object with predicted steps." alt="" coords="900,13,1060,54"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#aae4fab3792eaa78de9a88299c209246d" title="Given the list of objects with predicted states, get all collision times concurrently using multi&#45;thr..." alt="" coords="636,13,852,54"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#a546149400d9d6371c5de50f229d6ecfc" title="Return the earliest collision object and time of collision pair from the given trajectory and list of..." alt="" coords="428,5,588,61"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#ac1c423b99887ccbf945a86da7b7809f6" title="trajectory is modified to safely avoid obstacles on the road" alt="" coords="220,13,380,54"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#a0fd790e287683a2ef404e16a15e0ea29" title="Service callback for trajectory planning." alt="" coords="5,13,172,54"/>
</map>
</div>

</div>
</div>
<a id="aae4fab3792eaa78de9a88299c209246d" name="aae4fab3792eaa78de9a88299c209246d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae4fab3792eaa78de9a88299c209246d">&#9670;&nbsp;</a></span>get_collision_times_concurrently()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::unordered_map&lt; <a class="el" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>, rclcpp::Time &gt; yield_plugin::YieldPlugin::get_collision_times_concurrently </td>
          <td>(</td>
          <td class="paramtype">const carma_planning_msgs::msg::TrajectoryPlan &amp;&#160;</td>
          <td class="paramname"><em>original_tp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; carma_perception_msgs::msg::ExternalObject &gt; &amp;&#160;</td>
          <td class="paramname"><em>external_objects</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>original_tp_max_speed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Given the list of objects with predicted states, get all collision times concurrently using multi-threading. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">original_tp</td><td>trajectory of the ego vehicle </td></tr>
    <tr><td class="paramname">external_objects</td><td>list of external objects with predicted states </td></tr>
    <tr><td class="paramname">original_tp_max_speed</td><td>max speed of the original_tp to efficiently traverse through possible collision combination of the two trajectories </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>mapping of objects' ids and their corresponding collision times (non-colliding objects are omitted) </dd></dl>

<p class="definition">Definition at line <a class="el" href="yield__plugin_8cpp_source.html#l00783">783</a> of file <a class="el" href="yield__plugin_8cpp_source.html">yield_plugin.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  785</span>  {</div>
<div class="line"><span class="lineno">  786</span> </div>
<div class="line"><span class="lineno">  787</span>    std::unordered_map&lt;uint32_t, std::future&lt;std::optional&lt;rclcpp::Time&gt;&gt;&gt; futures;</div>
<div class="line"><span class="lineno">  788</span>    std::unordered_map&lt;uint32_t, rclcpp::Time&gt; collision_times;</div>
<div class="line"><span class="lineno">  789</span> </div>
<div class="line"><span class="lineno">  790</span>    <span class="comment">// Launch asynchronous tasks to check for collision times</span></div>
<div class="line"><span class="lineno">  791</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; <span class="keywordtype">object</span> : external_objects) {</div>
<div class="line"><span class="lineno">  792</span>      futures[<span class="keywordtype">object</span>.id] = std::async(std::launch::async,[<span class="keyword">this</span>, &amp;original_tp, &amp;<span class="keywordtype">object</span>, &amp;original_tp_max_speed]{</div>
<div class="line"><span class="lineno">  793</span>          <span class="keywordflow">return</span> <a class="code hl_function" href="classyield__plugin_1_1YieldPlugin.html#a5644e9f63528efc0484b875c7debef01">get_collision_time</a>(original_tp, <span class="keywordtype">object</span>, original_tp_max_speed);</div>
<div class="line"><span class="lineno">  794</span>        });</div>
<div class="line"><span class="lineno">  795</span>    }</div>
<div class="line"><span class="lineno">  796</span> </div>
<div class="line"><span class="lineno">  797</span>    <span class="comment">// Collect results from futures and update collision_times</span></div>
<div class="line"><span class="lineno">  798</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; <span class="keywordtype">object</span> : external_objects) {</div>
<div class="line"><span class="lineno">  799</span>      <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> collision_time{futures.at(<span class="keywordtype">object</span>.<span class="keywordtype">id</span>).get()}) {</div>
<div class="line"><span class="lineno">  800</span>        collision_times[<span class="keywordtype">object</span>.id] = collision_time.value();</div>
<div class="line"><span class="lineno">  801</span>      }</div>
<div class="line"><span class="lineno">  802</span>    }</div>
<div class="line"><span class="lineno">  803</span> </div>
<div class="line"><span class="lineno">  804</span>    <span class="keywordflow">return</span> collision_times;</div>
<div class="line"><span class="lineno">  805</span>  }</div>
<div class="ttc" id="aclassyield__plugin_1_1YieldPlugin_html_a5644e9f63528efc0484b875c7debef01"><div class="ttname"><a href="classyield__plugin_1_1YieldPlugin.html#a5644e9f63528efc0484b875c7debef01">yield_plugin::YieldPlugin::get_collision_time</a></div><div class="ttdeci">std::optional&lt; rclcpp::Time &gt; get_collision_time(const carma_planning_msgs::msg::TrajectoryPlan &amp;original_tp, const carma_perception_msgs::msg::ExternalObject &amp;curr_obstacle, double original_tp_max_speed)</div><div class="ttdoc">Return collision time given two trajectories with one being external object with predicted steps.</div><div class="ttdef"><b>Definition:</b> <a href="yield__plugin_8cpp_source.html#l00723">yield_plugin.cpp:723</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="yield__plugin_8cpp_source.html#l00723">get_collision_time()</a>.</p>

<p class="reference">Referenced by <a class="el" href="yield__plugin_8cpp_source.html#l00807">get_earliest_collision_object_and_time()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classyield__plugin_1_1YieldPlugin_aae4fab3792eaa78de9a88299c209246d_cgraph.png" border="0" usemap="#aclassyield__plugin_1_1YieldPlugin_aae4fab3792eaa78de9a88299c209246d_cgraph" alt=""/></div>
<map name="aclassyield__plugin_1_1YieldPlugin_aae4fab3792eaa78de9a88299c209246d_cgraph" id="aclassyield__plugin_1_1YieldPlugin_aae4fab3792eaa78de9a88299c209246d_cgraph">
<area shape="rect" title="Given the list of objects with predicted states, get all collision times concurrently using multi&#45;thr..." alt="" coords="5,93,221,135"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#a5644e9f63528efc0484b875c7debef01" title="Return collision time given two trajectories with one being external object with predicted steps." alt="" coords="269,93,429,135"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#ab60b2f939cebede3a6d9a3ae5529b0d9" title="Return naive collision time and locations based on collision radius given two trajectories with one b..." alt="" coords="484,5,644,47"/>
<area shape="rect" href="namespaceyield__plugin.html#a754c9aebad547b09cdeff7080a639bd3" title=" " alt="" coords="945,125,1119,167"/>
<area shape="rect" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5" title=" " alt="" coords="699,95,897,136"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#ae1279ff6d53eb474b635f992ed854d0b" title="Check if object location is behind the vehicle using estimates of the vehicle&#39;s length and route down..." alt="" coords="477,123,651,164"/>
<area shape="rect" href="namespaceyield__plugin.html#ad78fa1e6a7a22eff6b76dd32700fc55f" title=" " alt="" coords="711,5,885,47"/>
<area shape="rect" href="namespaceyield__plugin.html#a82b2a694528d42a4af068732befca882" title=" " alt="" coords="945,5,1119,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classyield__plugin_1_1YieldPlugin_aae4fab3792eaa78de9a88299c209246d_icgraph.png" border="0" usemap="#aclassyield__plugin_1_1YieldPlugin_aae4fab3792eaa78de9a88299c209246d_icgraph" alt=""/></div>
<map name="aclassyield__plugin_1_1YieldPlugin_aae4fab3792eaa78de9a88299c209246d_icgraph" id="aclassyield__plugin_1_1YieldPlugin_aae4fab3792eaa78de9a88299c209246d_icgraph">
<area shape="rect" title="Given the list of objects with predicted states, get all collision times concurrently using multi&#45;thr..." alt="" coords="636,13,852,54"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#a546149400d9d6371c5de50f229d6ecfc" title="Return the earliest collision object and time of collision pair from the given trajectory and list of..." alt="" coords="428,5,588,61"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#ac1c423b99887ccbf945a86da7b7809f6" title="trajectory is modified to safely avoid obstacles on the road" alt="" coords="220,13,380,54"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#a0fd790e287683a2ef404e16a15e0ea29" title="Service callback for trajectory planning." alt="" coords="5,13,172,54"/>
</map>
</div>

</div>
</div>
<a id="a546149400d9d6371c5de50f229d6ecfc" name="a546149400d9d6371c5de50f229d6ecfc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a546149400d9d6371c5de50f229d6ecfc">&#9670;&nbsp;</a></span>get_earliest_collision_object_and_time()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::optional&lt; std::pair&lt; carma_perception_msgs::msg::ExternalObject, double &gt; &gt; yield_plugin::YieldPlugin::get_earliest_collision_object_and_time </td>
          <td>(</td>
          <td class="paramtype">const carma_planning_msgs::msg::TrajectoryPlan &amp;&#160;</td>
          <td class="paramname"><em>original_tp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; carma_perception_msgs::msg::ExternalObject &gt; &amp;&#160;</td>
          <td class="paramname"><em>external_objects</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the earliest collision object and time of collision pair from the given trajectory and list of external objects with predicted states. Function first filters obstacles based on whether if their any of predicted state will be on the route. Only then, the logic compares trajectory and predicted states. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">original_tp</td><td>trajectory of the ego vehicle </td></tr>
    <tr><td class="paramname">external_objects</td><td>list of external objects with predicted states </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>earliest collision object and its collision time if collision detected. std::nullopt if no collision is detected or if route is not available. </dd></dl>

<p class="definition">Definition at line <a class="el" href="yield__plugin_8cpp_source.html#l00807">807</a> of file <a class="el" href="yield__plugin_8cpp_source.html">yield_plugin.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  809</span>  {</div>
<div class="line"><span class="lineno">  810</span>    RCLCPP_DEBUG_STREAM(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(), <span class="stringliteral">&quot;ExternalObjects size: &quot;</span> &lt;&lt; external_objects.size());</div>
<div class="line"><span class="lineno">  811</span> </div>
<div class="line"><span class="lineno">  812</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aff229ed7bba2a76d0b1b99a83b9fdf88">wm_</a>-&gt;getRoute())</div>
<div class="line"><span class="lineno">  813</span>    {</div>
<div class="line"><span class="lineno">  814</span>      RCLCPP_WARN(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(), <span class="stringliteral">&quot;Yield plugin was not able to analyze collision since route is not available! Please check if route is set&quot;</span>);</div>
<div class="line"><span class="lineno">  815</span>      <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><span class="lineno">  816</span>    }</div>
<div class="line"><span class="lineno">  817</span> </div>
<div class="line"><span class="lineno">  818</span>    <span class="comment">// save route Ids for faster access</span></div>
<div class="line"><span class="lineno">  819</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; llt: <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aff229ed7bba2a76d0b1b99a83b9fdf88">wm_</a>-&gt;getRoute()-&gt;shortestPath())</div>
<div class="line"><span class="lineno">  820</span>    {</div>
<div class="line"><span class="lineno">  821</span>      <span class="comment">// TODO: Enhancement https://github.com/usdot-fhwa-stol/carma-platform/issues/2316</span></div>
<div class="line"><span class="lineno">  822</span>      <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#a03f092d19aab7369af56f9438938d454">route_llt_ids_</a>.insert(llt.id());</div>
<div class="line"><span class="lineno">  823</span>    }</div>
<div class="line"><span class="lineno">  824</span> </div>
<div class="line"><span class="lineno">  825</span>    RCLCPP_DEBUG_STREAM(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(),<span class="stringliteral">&quot;External Object List (external_objects) size: &quot;</span> &lt;&lt; external_objects.size());</div>
<div class="line"><span class="lineno">  826</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> original_max_speed = <a class="code hl_function" href="classyield__plugin_1_1YieldPlugin.html#ae53a42abb996d38cf701a3fba7e473f8">max_trajectory_speed</a>(original_tp.trajectory_points, <a class="code hl_function" href="namespaceyield__plugin.html#a82b2a694528d42a4af068732befca882">get_trajectory_end_time</a>(original_tp));</div>
<div class="line"><span class="lineno">  827</span>    std::unordered_map&lt;uint32_t, rclcpp::Time&gt; collision_times = <a class="code hl_function" href="classyield__plugin_1_1YieldPlugin.html#aae4fab3792eaa78de9a88299c209246d">get_collision_times_concurrently</a>(original_tp,external_objects, original_max_speed);</div>
<div class="line"><span class="lineno">  828</span> </div>
<div class="line"><span class="lineno">  829</span>    <span class="keywordflow">if</span> (collision_times.empty()) { <span class="keywordflow">return</span> std::nullopt; }</div>
<div class="line"><span class="lineno">  830</span> </div>
<div class="line"><span class="lineno">  831</span>    <span class="keyword">const</span> <span class="keyword">auto</span> earliest_colliding_object_id{std::min_element(</div>
<div class="line"><span class="lineno">  832</span>      std::cbegin(collision_times), std::cend(collision_times),</div>
<div class="line"><span class="lineno">  833</span>      [](<span class="keyword">const</span> <span class="keyword">auto</span> &amp; <a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a>, <span class="keyword">const</span> <span class="keyword">auto</span> &amp; b){ <span class="keywordflow">return</span> <a class="code hl_variable" href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a>.second &lt; b.second; })-&gt;first};</div>
<div class="line"><span class="lineno">  834</span> </div>
<div class="line"><span class="lineno">  835</span>    <span class="keyword">const</span> <span class="keyword">auto</span> earliest_colliding_object{std::find_if(</div>
<div class="line"><span class="lineno">  836</span>      std::cbegin(external_objects), std::cend(external_objects),</div>
<div class="line"><span class="lineno">  837</span>      [&amp;earliest_colliding_object_id](<span class="keyword">const</span> <span class="keyword">auto</span> &amp; <span class="keywordtype">object</span>) { <span class="keywordflow">return</span> <span class="keywordtype">object</span>.id == earliest_colliding_object_id; })};</div>
<div class="line"><span class="lineno">  838</span> </div>
<div class="line"><span class="lineno">  839</span>    RCLCPP_DEBUG_STREAM(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(),<span class="stringliteral">&quot;earliest object x: &quot;</span> &lt;&lt; earliest_colliding_object-&gt;velocity.twist.linear.x</div>
<div class="line"><span class="lineno">  840</span>        &lt;&lt; <span class="stringliteral">&quot;, y: &quot;</span> &lt;&lt; earliest_colliding_object-&gt;velocity.twist.linear.y);</div>
<div class="line"><span class="lineno">  841</span>    <span class="keywordflow">return</span> std::make_pair(*earliest_colliding_object, collision_times.at(earliest_colliding_object_id).seconds());</div>
<div class="line"><span class="lineno">  842</span> </div>
<div class="line"><span class="lineno">  843</span>  }</div>
<div class="ttc" id="aclassyield__plugin_1_1YieldPlugin_html_aae4fab3792eaa78de9a88299c209246d"><div class="ttname"><a href="classyield__plugin_1_1YieldPlugin.html#aae4fab3792eaa78de9a88299c209246d">yield_plugin::YieldPlugin::get_collision_times_concurrently</a></div><div class="ttdeci">std::unordered_map&lt; uint32_t, rclcpp::Time &gt; get_collision_times_concurrently(const carma_planning_msgs::msg::TrajectoryPlan &amp;original_tp, const std::vector&lt; carma_perception_msgs::msg::ExternalObject &gt; &amp;external_objects, double original_tp_max_speed)</div><div class="ttdoc">Given the list of objects with predicted states, get all collision times concurrently using multi-thr...</div><div class="ttdef"><b>Definition:</b> <a href="yield__plugin_8cpp_source.html#l00783">yield_plugin.cpp:783</a></div></div>
<div class="ttc" id="aclassyield__plugin_1_1YieldPlugin_html_ae53a42abb996d38cf701a3fba7e473f8"><div class="ttname"><a href="classyield__plugin_1_1YieldPlugin.html#ae53a42abb996d38cf701a3fba7e473f8">yield_plugin::YieldPlugin::max_trajectory_speed</a></div><div class="ttdeci">double max_trajectory_speed(const std::vector&lt; carma_planning_msgs::msg::TrajectoryPlanPoint &gt; &amp;trajectory_points, double timestamp_in_sec_to_search_until) const</div><div class="ttdoc">calculates the maximum speed in a set of tajectory points</div><div class="ttdef"><b>Definition:</b> <a href="yield__plugin_8cpp_source.html#l01013">yield_plugin.cpp:1013</a></div></div>
<div class="ttc" id="anamespaceyield__plugin_html_a82b2a694528d42a4af068732befca882"><div class="ttname"><a href="namespaceyield__plugin.html#a82b2a694528d42a4af068732befca882">yield_plugin::get_trajectory_end_time</a></div><div class="ttdeci">double get_trajectory_end_time(const carma_planning_msgs::msg::TrajectoryPlan &amp;trajectory)</div><div class="ttdef"><b>Definition:</b> <a href="yield__plugin_8cpp_source.html#l00053">yield_plugin.cpp:53</a></div></div>
<div class="ttc" id="apointer_8h_html_aeeddce917cf130d62c370b8f216026dd"><div class="ttname"><a href="pointer_8h.html#aeeddce917cf130d62c370b8f216026dd">a</a></div><div class="ttdeci">const GenericPointer&lt; typename T::ValueType &gt; T2 T::AllocatorType &amp; a</div><div class="ttdef"><b>Definition:</b> <a href="pointer_8h_source.html#l01121">pointer.h:1121</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="pointer_8h_source.html#l01121">a</a>, <a class="el" href="yield__plugin_8cpp_source.html#l00783">get_collision_times_concurrently()</a>, <a class="el" href="yield__plugin_8cpp_source.html#l00053">yield_plugin::get_trajectory_end_time()</a>, <a class="el" href="yield__plugin_8cpp_source.html#l01013">max_trajectory_speed()</a>, <a class="el" href="yield__plugin_8hpp_source.html#l00315">nh_</a>, <a class="el" href="yield__plugin_8hpp_source.html#l00316">route_llt_ids_</a>, and <a class="el" href="yield__plugin_8hpp_source.html#l00311">wm_</a>.</p>

<p class="reference">Referenced by <a class="el" href="yield__plugin_8cpp_source.html#l00888">update_traj_for_object()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classyield__plugin_1_1YieldPlugin_a546149400d9d6371c5de50f229d6ecfc_cgraph.png" border="0" usemap="#aclassyield__plugin_1_1YieldPlugin_a546149400d9d6371c5de50f229d6ecfc_cgraph" alt=""/></div>
<map name="aclassyield__plugin_1_1YieldPlugin_a546149400d9d6371c5de50f229d6ecfc_cgraph" id="aclassyield__plugin_1_1YieldPlugin_a546149400d9d6371c5de50f229d6ecfc_cgraph">
<area shape="rect" title="Return the earliest collision object and time of collision pair from the given trajectory and list of..." alt="" coords="5,219,165,275"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#aae4fab3792eaa78de9a88299c209246d" title="Given the list of objects with predicted states, get all collision times concurrently using multi&#45;thr..." alt="" coords="213,139,429,180"/>
<area shape="rect" href="namespaceyield__plugin.html#a82b2a694528d42a4af068732befca882" title=" " alt="" coords="1153,141,1327,183"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#ae53a42abb996d38cf701a3fba7e473f8" title="calculates the maximum speed in a set of tajectory points" alt="" coords="241,285,401,327"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#a5644e9f63528efc0484b875c7debef01" title="Return collision time given two trajectories with one being external object with predicted steps." alt="" coords="477,109,637,151"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#ab60b2f939cebede3a6d9a3ae5529b0d9" title="Return naive collision time and locations based on collision radius given two trajectories with one b..." alt="" coords="692,51,852,92"/>
<area shape="rect" href="namespaceyield__plugin.html#a754c9aebad547b09cdeff7080a639bd3" title=" " alt="" coords="1153,21,1327,63"/>
<area shape="rect" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5" title=" " alt="" coords="907,140,1105,181"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#ae1279ff6d53eb474b635f992ed854d0b" title="Check if object location is behind the vehicle using estimates of the vehicle&#39;s length and route down..." alt="" coords="685,168,859,209"/>
<area shape="rect" href="namespaceyield__plugin.html#ad78fa1e6a7a22eff6b76dd32700fc55f" title=" " alt="" coords="919,51,1093,92"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classyield__plugin_1_1YieldPlugin_a546149400d9d6371c5de50f229d6ecfc_icgraph.png" border="0" usemap="#aclassyield__plugin_1_1YieldPlugin_a546149400d9d6371c5de50f229d6ecfc_icgraph" alt=""/></div>
<map name="aclassyield__plugin_1_1YieldPlugin_a546149400d9d6371c5de50f229d6ecfc_icgraph" id="aclassyield__plugin_1_1YieldPlugin_a546149400d9d6371c5de50f229d6ecfc_icgraph">
<area shape="rect" title="Return the earliest collision object and time of collision pair from the given trajectory and list of..." alt="" coords="428,5,588,61"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#ac1c423b99887ccbf945a86da7b7809f6" title="trajectory is modified to safely avoid obstacles on the road" alt="" coords="220,13,380,54"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#a0fd790e287683a2ef404e16a15e0ea29" title="Service callback for trajectory planning." alt="" coords="5,13,172,54"/>
</map>
</div>

</div>
</div>
<a id="a378558cb2b27d8337d980150543d447d" name="a378558cb2b27d8337d980150543d447d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a378558cb2b27d8337d980150543d447d">&#9670;&nbsp;</a></span>get_predicted_velocity_at_time()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double yield_plugin::YieldPlugin::get_predicted_velocity_at_time </td>
          <td>(</td>
          <td class="paramtype">const geometry_msgs::msg::Twist &amp;&#160;</td>
          <td class="paramname"><em>object_velocity_in_map_frame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const carma_planning_msgs::msg::TrajectoryPlan &amp;&#160;</td>
          <td class="paramname"><em>original_tp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>timestamp_in_sec_to_predict</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Given the object velocity in map frame with x,y components, this function returns the projected velocity along the trajectory at given time. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">object_velocity_in_map_frame</td><td>trajectory of the ego vehicle </td></tr>
    <tr><td class="paramname">original_tp</td><td>trajectory of the ego vehicle </td></tr>
    <tr><td class="paramname">timestamp_in_sec_to_predict</td><td>timestamp in seconds along the trajectory to return the projected velocity NOTE: returns the last point's speed if the specified time is past the trajectory's planning time </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>get_predicted_velocity_at_time </dd></dl>

<p class="definition">Definition at line <a class="el" href="yield__plugin_8cpp_source.html#l00845">845</a> of file <a class="el" href="yield__plugin_8cpp_source.html">yield_plugin.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  847</span>  {</div>
<div class="line"><span class="lineno">  848</span>    RCLCPP_DEBUG_STREAM(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(), <span class="stringliteral">&quot;timestamp_in_sec_to_predict: &quot;</span> &lt;&lt; <a class="code hl_function" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5">std::to_string</a>(timestamp_in_sec_to_predict) &lt;&lt;</div>
<div class="line"><span class="lineno">  849</span>      <span class="stringliteral">&quot;, trajectory_end_time: &quot;</span> &lt;&lt; <a class="code hl_function" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5">std::to_string</a>(<a class="code hl_function" href="namespaceyield__plugin.html#a82b2a694528d42a4af068732befca882">get_trajectory_end_time</a>(original_tp)));</div>
<div class="line"><span class="lineno">  850</span> </div>
<div class="line"><span class="lineno">  851</span>    <span class="keywordtype">double</span> point_b_time = 0.0;</div>
<div class="line"><span class="lineno">  852</span>    carma_planning_msgs::msg::TrajectoryPlanPoint point_a;</div>
<div class="line"><span class="lineno">  853</span>    carma_planning_msgs::msg::TrajectoryPlanPoint point_b;</div>
<div class="line"><span class="lineno">  854</span> </div>
<div class="line"><span class="lineno">  855</span>    <span class="comment">// trajectory points&#39; time is guaranteed to be increasing</span></div>
<div class="line"><span class="lineno">  856</span>    <span class="comment">// then find the corresponding point at timestamp_in_sec_to_predict</span></div>
<div class="line"><span class="lineno">  857</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> = 0; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> &lt; original_tp.trajectory_points.size() - 1; ++<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>)</div>
<div class="line"><span class="lineno">  858</span>    {</div>
<div class="line"><span class="lineno">  859</span>      point_a = original_tp.trajectory_points.at(<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>);</div>
<div class="line"><span class="lineno">  860</span>      point_b = original_tp.trajectory_points.at(<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> + 1);</div>
<div class="line"><span class="lineno">  861</span>      point_b_time = rclcpp::Time(point_b.target_time).seconds();</div>
<div class="line"><span class="lineno">  862</span>      <span class="keywordflow">if</span> (point_b_time &gt;= timestamp_in_sec_to_predict)</div>
<div class="line"><span class="lineno">  863</span>      {</div>
<div class="line"><span class="lineno">  864</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  865</span>      }</div>
<div class="line"><span class="lineno">  866</span>    }</div>
<div class="line"><span class="lineno">  867</span> </div>
<div class="line"><span class="lineno">  868</span>    <span class="keyword">auto</span> dx = point_b.x - point_a.x;</div>
<div class="line"><span class="lineno">  869</span>    <span class="keyword">auto</span> dy = point_b.y - point_a.y;</div>
<div class="line"><span class="lineno">  870</span>    <span class="keyword">const</span> tf2::Vector3 trajectory_direction(dx, dy, 0);</div>
<div class="line"><span class="lineno">  871</span> </div>
<div class="line"><span class="lineno">  872</span>    RCLCPP_DEBUG_STREAM(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(), <span class="stringliteral">&quot;timestamp_in_sec_to_predict: &quot;</span> &lt;&lt; <a class="code hl_function" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5">std::to_string</a>(timestamp_in_sec_to_predict)</div>
<div class="line"><span class="lineno">  873</span>      &lt;&lt; <span class="stringliteral">&quot;, point_b_time: &quot;</span> &lt;&lt; <a class="code hl_function" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5">std::to_string</a>(point_b_time)</div>
<div class="line"><span class="lineno">  874</span>      &lt;&lt; <span class="stringliteral">&quot;, dx: &quot;</span> &lt;&lt; dx &lt;&lt; <span class="stringliteral">&quot;, dy: &quot;</span> &lt;&lt; dy &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line"><span class="lineno">  875</span>      &lt;&lt; <span class="stringliteral">&quot;, object_velocity_in_map_frame.x: &quot;</span> &lt;&lt; object_velocity_in_map_frame.linear.x</div>
<div class="line"><span class="lineno">  876</span>      &lt;&lt; <span class="stringliteral">&quot;, object_velocity_in_map_frame.y: &quot;</span> &lt;&lt; object_velocity_in_map_frame.linear.y);</div>
<div class="line"><span class="lineno">  877</span> </div>
<div class="line"><span class="lineno">  878</span>    <span class="keywordflow">if</span> (trajectory_direction.length() &lt; 0.001) <span class="comment">//EPSILON</span></div>
<div class="line"><span class="lineno">  879</span>    {</div>
<div class="line"><span class="lineno">  880</span>      <span class="keywordflow">return</span> 0.0;</div>
<div class="line"><span class="lineno">  881</span>    }</div>
<div class="line"><span class="lineno">  882</span> </div>
<div class="line"><span class="lineno">  883</span>    <span class="keyword">const</span> tf2::Vector3 object_direction(object_velocity_in_map_frame.linear.x, object_velocity_in_map_frame.linear.y, 0);</div>
<div class="line"><span class="lineno">  884</span> </div>
<div class="line"><span class="lineno">  885</span>    <span class="keywordflow">return</span> tf2::tf2Dot(object_direction, trajectory_direction) / trajectory_direction.length();</div>
<div class="line"><span class="lineno">  886</span>  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="yield__plugin_8cpp_source.html#l00053">yield_plugin::get_trajectory_end_time()</a>, <a class="el" href="process__bag_8py_source.html#l00059">process_bag::i</a>, <a class="el" href="yield__plugin_8hpp_source.html#l00315">nh_</a>, and <a class="el" href="utm__zone_8cpp_source.html#l00021">carma_cooperative_perception::to_string()</a>.</p>

<p class="reference">Referenced by <a class="el" href="yield__plugin_8cpp_source.html#l00888">update_traj_for_object()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classyield__plugin_1_1YieldPlugin_a378558cb2b27d8337d980150543d447d_cgraph.png" border="0" usemap="#aclassyield__plugin_1_1YieldPlugin_a378558cb2b27d8337d980150543d447d_cgraph" alt=""/></div>
<map name="aclassyield__plugin_1_1YieldPlugin_a378558cb2b27d8337d980150543d447d_cgraph" id="aclassyield__plugin_1_1YieldPlugin_a378558cb2b27d8337d980150543d447d_cgraph">
<area shape="rect" title="Given the object velocity in map frame with x,y components, this function returns the projected veloc..." alt="" coords="5,43,165,99"/>
<area shape="rect" href="namespaceyield__plugin.html#a82b2a694528d42a4af068732befca882" title=" " alt="" coords="226,5,399,47"/>
<area shape="rect" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5" title=" " alt="" coords="213,95,412,136"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classyield__plugin_1_1YieldPlugin_a378558cb2b27d8337d980150543d447d_icgraph.png" border="0" usemap="#aclassyield__plugin_1_1YieldPlugin_a378558cb2b27d8337d980150543d447d_icgraph" alt=""/></div>
<map name="aclassyield__plugin_1_1YieldPlugin_a378558cb2b27d8337d980150543d447d_icgraph" id="aclassyield__plugin_1_1YieldPlugin_a378558cb2b27d8337d980150543d447d_icgraph">
<area shape="rect" title="Given the object velocity in map frame with x,y components, this function returns the projected veloc..." alt="" coords="428,5,588,61"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#ac1c423b99887ccbf945a86da7b7809f6" title="trajectory is modified to safely avoid obstacles on the road" alt="" coords="220,13,380,54"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#a0fd790e287683a2ef404e16a15e0ea29" title="Service callback for trajectory planning." alt="" coords="5,13,172,54"/>
</map>
</div>

</div>
</div>
<a id="a1bc011c9c2db48289bf40214d972cec4" name="a1bc011c9c2db48289bf40214d972cec4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1bc011c9c2db48289bf40214d972cec4">&#9670;&nbsp;</a></span>get_relative_downtracks()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; double &gt; yield_plugin::YieldPlugin::get_relative_downtracks </td>
          <td>(</td>
          <td class="paramtype">const carma_planning_msgs::msg::TrajectoryPlan &amp;&#160;</td>
          <td class="paramname"><em>trajectory_plan</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculates distance between trajectory points in a plan </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">trajectory_plan</td><td>input trajectory plan </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>vector of relative distances between trajectory points </dd></dl>

<p class="definition">Definition at line <a class="el" href="yield__plugin_8cpp_source.html#l00976">976</a> of file <a class="el" href="yield__plugin_8cpp_source.html">yield_plugin.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  977</span>  {</div>
<div class="line"><span class="lineno">  978</span>    std::vector&lt;double&gt; downtracks;</div>
<div class="line"><span class="lineno">  979</span>    downtracks.reserve(trajectory_plan.trajectory_points.size());</div>
<div class="line"><span class="lineno">  980</span>    <span class="comment">// relative downtrack distance of the fist Point is 0.0</span></div>
<div class="line"><span class="lineno">  981</span>    downtracks.push_back(0.0);</div>
<div class="line"><span class="lineno">  982</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>=1; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> &lt; trajectory_plan.trajectory_points.size(); <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>++){</div>
<div class="line"><span class="lineno">  983</span> </div>
<div class="line"><span class="lineno">  984</span>      <span class="keywordtype">double</span> dx = trajectory_plan.trajectory_points.at(<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>).x - trajectory_plan.trajectory_points.at(<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>-1).x;</div>
<div class="line"><span class="lineno">  985</span>      <span class="keywordtype">double</span> dy = trajectory_plan.trajectory_points.at(<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>).y - trajectory_plan.trajectory_points.at(<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>-1).y;</div>
<div class="line"><span class="lineno">  986</span>      downtracks.push_back(sqrt(dx*dx + dy*dy));</div>
<div class="line"><span class="lineno">  987</span>    }</div>
<div class="line"><span class="lineno">  988</span>    <span class="keywordflow">return</span> downtracks;</div>
<div class="line"><span class="lineno">  989</span>  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="process__bag_8py_source.html#l00059">process_bag::i</a>.</p>

<p class="reference">Referenced by <a class="el" href="yield__plugin_8cpp_source.html#l00402">generate_JMT_trajectory()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classyield__plugin_1_1YieldPlugin_a1bc011c9c2db48289bf40214d972cec4_icgraph.png" border="0" usemap="#aclassyield__plugin_1_1YieldPlugin_a1bc011c9c2db48289bf40214d972cec4_icgraph" alt=""/></div>
<map name="aclassyield__plugin_1_1YieldPlugin_a1bc011c9c2db48289bf40214d972cec4_icgraph" id="aclassyield__plugin_1_1YieldPlugin_a1bc011c9c2db48289bf40214d972cec4_icgraph">
<area shape="rect" title="calculates distance between trajectory points in a plan" alt="" coords="675,49,844,90"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#ace53f1895cbbf2a5f109cbfc11d6313f" title="generate a Jerk Minimizing Trajectory(JMT) with the provided start and end conditions" alt="" coords="456,49,627,90"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#ad9c9e0e4278774a519de12a6a5f4398f" title="update trajectory for yielding to an incoming cooperative behavior" alt="" coords="220,5,408,61"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#ac1c423b99887ccbf945a86da7b7809f6" title="trajectory is modified to safely avoid obstacles on the road" alt="" coords="234,85,394,126"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#a0fd790e287683a2ef404e16a15e0ea29" title="Service callback for trajectory planning." alt="" coords="5,49,172,90"/>
</map>
</div>

</div>
</div>
<a id="ae1279ff6d53eb474b635f992ed854d0b" name="ae1279ff6d53eb474b635f992ed854d0b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1279ff6d53eb474b635f992ed854d0b">&#9670;&nbsp;</a></span>is_object_behind_vehicle()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> yield_plugin::YieldPlugin::is_object_behind_vehicle </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>object_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const rclcpp::Time &amp;&#160;</td>
          <td class="paramname"><em>collision_time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>vehicle_point</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>object_downtrack</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if object location is behind the vehicle using estimates of the vehicle's length and route downtracks. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">object_id</td><td>object id to use for the consecutive_clearance_count_for_obstacles_ </td></tr>
    <tr><td class="paramname">collision_time</td><td>predicted time of collision </td></tr>
    <tr><td class="paramname">vehicle_downtrack</td><td>at the time of collision </td></tr>
    <tr><td class="paramname">object_downtrack</td><td>at the time of collision NOTE: Uses internal counter low pass filter to confirm the object is behind only if it counted continuously above config_.consecutive_clearance_count_for_obstacles_threshold </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>return true if object is behind the vehicle </dd></dl>

<p class="definition">Definition at line <a class="el" href="yield__plugin_8cpp_source.html#l00697">697</a> of file <a class="el" href="yield__plugin_8cpp_source.html">yield_plugin.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  698</span>  {</div>
<div class="line"><span class="lineno">  699</span>    <span class="keyword">const</span> <span class="keyword">auto</span> previous_clearance_count = <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#adc6d5d9e4116d9f6ca142e5bb2fd1bc8">consecutive_clearance_count_for_obstacles_</a>[object_id];</div>
<div class="line"><span class="lineno">  700</span>    <span class="comment">// if the object&#39;s location is half a length of the vehicle past its rear-axle, it is considered behind</span></div>
<div class="line"><span class="lineno">  701</span>    <span class="comment">// half a length of the vehicle to conservatively estimate the rear axle to rear bumper length</span></div>
<div class="line"><span class="lineno">  702</span>    <span class="keywordflow">if</span> (object_downtrack &lt; vehicle_downtrack - <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#ab1f62a493a4229d4801841eb19fb1e7d">config_</a>.<a class="code hl_variable" href="structYieldPluginConfig.html#a7b0405c10307bac9613aba5a228de94e">vehicle_length</a> / 2)</div>
<div class="line"><span class="lineno">  703</span>    {</div>
<div class="line"><span class="lineno">  704</span>      <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#adc6d5d9e4116d9f6ca142e5bb2fd1bc8">consecutive_clearance_count_for_obstacles_</a>[object_id] = std::min(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#adc6d5d9e4116d9f6ca142e5bb2fd1bc8">consecutive_clearance_count_for_obstacles_</a>[object_id] + 1, <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#ab1f62a493a4229d4801841eb19fb1e7d">config_</a>.<a class="code hl_variable" href="structYieldPluginConfig.html#a7e5796ed6d92befd6c726b5a0b6ef4f8">consecutive_clearance_count_for_obstacles_threshold</a>);</div>
<div class="line"><span class="lineno">  705</span>      RCLCPP_INFO_STREAM(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(), <span class="stringliteral">&quot;Detected an object nearby might be behind the vehicle at timestamp: &quot;</span> &lt;&lt; <a class="code hl_function" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5">std::to_string</a>(collision_time.seconds()) &lt;&lt;</div>
<div class="line"><span class="lineno">  706</span>        <span class="stringliteral">&quot;, and consecutive_clearance_count_for obstacle: &quot;</span> &lt;&lt;  object_id &lt;&lt; <span class="stringliteral">&quot;, is: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#adc6d5d9e4116d9f6ca142e5bb2fd1bc8">consecutive_clearance_count_for_obstacles_</a>[object_id]);</div>
<div class="line"><span class="lineno">  707</span>    }</div>
<div class="line"><span class="lineno">  708</span>    <span class="comment">// confirmed false positive for a collision</span></div>
<div class="line"><span class="lineno">  709</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#adc6d5d9e4116d9f6ca142e5bb2fd1bc8">consecutive_clearance_count_for_obstacles_</a>[object_id] &gt;= <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#ab1f62a493a4229d4801841eb19fb1e7d">config_</a>.<a class="code hl_variable" href="structYieldPluginConfig.html#a7e5796ed6d92befd6c726b5a0b6ef4f8">consecutive_clearance_count_for_obstacles_threshold</a>)</div>
<div class="line"><span class="lineno">  710</span>    {</div>
<div class="line"><span class="lineno">  711</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  712</span>    }</div>
<div class="line"><span class="lineno">  713</span>    <span class="comment">// if the clearance counter didn&#39;t increase by this point, true collision was detected</span></div>
<div class="line"><span class="lineno">  714</span>    <span class="comment">// therefore reset the consecutive clearance counter as it is no longer consecutive</span></div>
<div class="line"><span class="lineno">  715</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#adc6d5d9e4116d9f6ca142e5bb2fd1bc8">consecutive_clearance_count_for_obstacles_</a>[object_id] == previous_clearance_count)</div>
<div class="line"><span class="lineno">  716</span>    {</div>
<div class="line"><span class="lineno">  717</span>      <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#adc6d5d9e4116d9f6ca142e5bb2fd1bc8">consecutive_clearance_count_for_obstacles_</a>[object_id] = 0;</div>
<div class="line"><span class="lineno">  718</span>    }</div>
<div class="line"><span class="lineno">  719</span> </div>
<div class="line"><span class="lineno">  720</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  721</span>  }</div>
<div class="ttc" id="astructYieldPluginConfig_html_a7b0405c10307bac9613aba5a228de94e"><div class="ttname"><a href="structYieldPluginConfig.html#a7b0405c10307bac9613aba5a228de94e">YieldPluginConfig::vehicle_length</a></div><div class="ttdeci">double vehicle_length</div><div class="ttdef"><b>Definition:</b> <a href="yield__config_8hpp_source.html#l00032">yield_config.hpp:32</a></div></div>
<div class="ttc" id="astructYieldPluginConfig_html_a7e5796ed6d92befd6c726b5a0b6ef4f8"><div class="ttname"><a href="structYieldPluginConfig.html#a7e5796ed6d92befd6c726b5a0b6ef4f8">YieldPluginConfig::consecutive_clearance_count_for_obstacles_threshold</a></div><div class="ttdeci">int consecutive_clearance_count_for_obstacles_threshold</div><div class="ttdef"><b>Definition:</b> <a href="yield__config_8hpp_source.html#l00041">yield_config.hpp:41</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="yield__plugin_8hpp_source.html#l00312">config_</a>, <a class="el" href="yield__plugin_8hpp_source.html#l00319">consecutive_clearance_count_for_obstacles_</a>, <a class="el" href="yield__config_8hpp_source.html#l00041">YieldPluginConfig::consecutive_clearance_count_for_obstacles_threshold</a>, <a class="el" href="yield__plugin_8hpp_source.html#l00315">nh_</a>, <a class="el" href="utm__zone_8cpp_source.html#l00021">carma_cooperative_perception::to_string()</a>, and <a class="el" href="yield__config_8hpp_source.html#l00032">YieldPluginConfig::vehicle_length</a>.</p>

<p class="reference">Referenced by <a class="el" href="yield__plugin_8cpp_source.html#l00723">get_collision_time()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classyield__plugin_1_1YieldPlugin_ae1279ff6d53eb474b635f992ed854d0b_cgraph.png" border="0" usemap="#aclassyield__plugin_1_1YieldPlugin_ae1279ff6d53eb474b635f992ed854d0b_cgraph" alt=""/></div>
<map name="aclassyield__plugin_1_1YieldPlugin_ae1279ff6d53eb474b635f992ed854d0b_cgraph" id="aclassyield__plugin_1_1YieldPlugin_ae1279ff6d53eb474b635f992ed854d0b_cgraph">
<area shape="rect" title="Check if object location is behind the vehicle using estimates of the vehicle&#39;s length and route down..." alt="" coords="5,29,179,71"/>
<area shape="rect" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5" title=" " alt="" coords="227,29,425,71"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classyield__plugin_1_1YieldPlugin_ae1279ff6d53eb474b635f992ed854d0b_icgraph.png" border="0" usemap="#aclassyield__plugin_1_1YieldPlugin_ae1279ff6d53eb474b635f992ed854d0b_icgraph" alt=""/></div>
<map name="aclassyield__plugin_1_1YieldPlugin_ae1279ff6d53eb474b635f992ed854d0b_icgraph" id="aclassyield__plugin_1_1YieldPlugin_ae1279ff6d53eb474b635f992ed854d0b_icgraph">
<area shape="rect" title="Check if object location is behind the vehicle using estimates of the vehicle&#39;s length and route down..." alt="" coords="1108,13,1281,54"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#a5644e9f63528efc0484b875c7debef01" title="Return collision time given two trajectories with one being external object with predicted steps." alt="" coords="900,13,1060,54"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#aae4fab3792eaa78de9a88299c209246d" title="Given the list of objects with predicted states, get all collision times concurrently using multi&#45;thr..." alt="" coords="636,13,852,54"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#a546149400d9d6371c5de50f229d6ecfc" title="Return the earliest collision object and time of collision pair from the given trajectory and list of..." alt="" coords="428,5,588,61"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#ac1c423b99887ccbf945a86da7b7809f6" title="trajectory is modified to safely avoid obstacles on the road" alt="" coords="220,13,380,54"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#a0fd790e287683a2ef404e16a15e0ea29" title="Service callback for trajectory planning." alt="" coords="5,13,172,54"/>
</map>
</div>

</div>
</div>
<a id="a5d6134d7e7b29394a68a43207f5cb1bc" name="a5d6134d7e7b29394a68a43207f5cb1bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d6134d7e7b29394a68a43207f5cb1bc">&#9670;&nbsp;</a></span>lookup_ecef_to_map_transform()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void yield_plugin::YieldPlugin::lookup_ecef_to_map_transform </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Looks up the transform between map and earth frames, and sets the member variable. </p>

</div>
</div>
<a id="ae53a42abb996d38cf701a3fba7e473f8" name="ae53a42abb996d38cf701a3fba7e473f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae53a42abb996d38cf701a3fba7e473f8">&#9670;&nbsp;</a></span>max_trajectory_speed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double yield_plugin::YieldPlugin::max_trajectory_speed </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; carma_planning_msgs::msg::TrajectoryPlanPoint &gt; &amp;&#160;</td>
          <td class="paramname"><em>trajectory_points</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>timestamp_in_sec_to_search_until</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculates the maximum speed in a set of tajectory points </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">trajectory_points</td><td>trajectory points </td></tr>
  </table>
  </dd>
</dl>
<h1><a class="anchor" id="autotoc_md288"></a>
\param timestamp_in_sec_to_search_until before which to look for max trajectory speed</h1>
<dl class="section return"><dt>Returns</dt><dd>maximum speed </dd></dl>

<p class="definition">Definition at line <a class="el" href="yield__plugin_8cpp_source.html#l01013">1013</a> of file <a class="el" href="yield__plugin_8cpp_source.html">yield_plugin.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1014</span>  {</div>
<div class="line"><span class="lineno"> 1015</span>    <span class="keywordtype">double</span> max_speed = 0;</div>
<div class="line"><span class="lineno"> 1016</span>    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> = 0; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> &lt; trajectory_points.size() - 2; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>++ )</div>
<div class="line"><span class="lineno"> 1017</span>    {</div>
<div class="line"><span class="lineno"> 1018</span>      <span class="keywordtype">double</span> dx = trajectory_points.at(<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> + 1).x - trajectory_points.at(<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>).x;</div>
<div class="line"><span class="lineno"> 1019</span>      <span class="keywordtype">double</span> dy = trajectory_points.at(<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> + 1).y - trajectory_points.at(<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>).y;</div>
<div class="line"><span class="lineno"> 1020</span>      <span class="keywordtype">double</span> d = sqrt(dx*dx + dy*dy);</div>
<div class="line"><span class="lineno"> 1021</span>      <span class="keywordtype">double</span> t = (rclcpp::Time(trajectory_points.at(<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> + 1).target_time).seconds() - rclcpp::Time(trajectory_points.at(<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>).target_time).seconds());</div>
<div class="line"><span class="lineno"> 1022</span>      <span class="keywordtype">double</span> v = d/t;</div>
<div class="line"><span class="lineno"> 1023</span>      <span class="keywordflow">if</span>(v &gt; max_speed)</div>
<div class="line"><span class="lineno"> 1024</span>      {</div>
<div class="line"><span class="lineno"> 1025</span>        max_speed = v;</div>
<div class="line"><span class="lineno"> 1026</span>      }</div>
<div class="line"><span class="lineno"> 1027</span>      <span class="keywordflow">if</span> (rclcpp::Time(trajectory_points.at(<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> + 1).target_time).seconds() &gt;= timestamp_in_sec_to_search_until)</div>
<div class="line"><span class="lineno"> 1028</span>      {</div>
<div class="line"><span class="lineno"> 1029</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1030</span>      }</div>
<div class="line"><span class="lineno"> 1031</span> </div>
<div class="line"><span class="lineno"> 1032</span>    }</div>
<div class="line"><span class="lineno"> 1033</span>    <span class="keywordflow">return</span> max_speed;</div>
<div class="line"><span class="lineno"> 1034</span>  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="process__bag_8py_source.html#l00059">process_bag::i</a>.</p>

<p class="reference">Referenced by <a class="el" href="yield__plugin_8cpp_source.html#l00807">get_earliest_collision_object_and_time()</a>, <a class="el" href="yield__plugin_8cpp_source.html#l00317">update_traj_for_cooperative_behavior()</a>, and <a class="el" href="yield__plugin_8cpp_source.html#l00888">update_traj_for_object()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classyield__plugin_1_1YieldPlugin_ae53a42abb996d38cf701a3fba7e473f8_icgraph.png" border="0" usemap="#aclassyield__plugin_1_1YieldPlugin_ae53a42abb996d38cf701a3fba7e473f8_icgraph" alt=""/></div>
<map name="aclassyield__plugin_1_1YieldPlugin_ae53a42abb996d38cf701a3fba7e473f8_icgraph" id="aclassyield__plugin_1_1YieldPlugin_ae53a42abb996d38cf701a3fba7e473f8_icgraph">
<area shape="rect" title="calculates the maximum speed in a set of tajectory points" alt="" coords="664,78,824,119"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#a546149400d9d6371c5de50f229d6ecfc" title="Return the earliest collision object and time of collision pair from the given trajectory and list of..." alt="" coords="456,5,616,61"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#ac1c423b99887ccbf945a86da7b7809f6" title="trajectory is modified to safely avoid obstacles on the road" alt="" coords="234,57,394,98"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#ad9c9e0e4278774a519de12a6a5f4398f" title="update trajectory for yielding to an incoming cooperative behavior" alt="" coords="220,121,408,177"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#a0fd790e287683a2ef404e16a15e0ea29" title="Service callback for trajectory planning." alt="" coords="5,93,172,134"/>
</map>
</div>

</div>
</div>
<a id="a3276c693a65319e769e63078284d3056" name="a3276c693a65319e769e63078284d3056"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3276c693a65319e769e63078284d3056">&#9670;&nbsp;</a></span>mobilityrequest_cb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void yield_plugin::YieldPlugin::mobilityrequest_cb </td>
          <td>(</td>
          <td class="paramtype">const carma_v2x_msgs::msg::MobilityRequest::UniquePtr&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>callback for mobility request </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>mobility request message </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="yield__plugin_8cpp_source.html#l00153">153</a> of file <a class="el" href="yield__plugin_8cpp_source.html">yield_plugin.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  154</span>  {</div>
<div class="line"><span class="lineno">  155</span>    carma_v2x_msgs::msg::MobilityRequest incoming_request = *msg;</div>
<div class="line"><span class="lineno">  156</span>    carma_planning_msgs::msg::LaneChangeStatus lc_status_msg;</div>
<div class="line"><span class="lineno">  157</span>    <span class="keywordflow">if</span> (incoming_request.strategy == <span class="stringliteral">&quot;carma/cooperative-lane-change&quot;</span>)</div>
<div class="line"><span class="lineno">  158</span>    {</div>
<div class="line"><span class="lineno">  159</span>      <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#a42d2a2d8a9f88afbedaa566ad57c8444">map_projector_</a>) {</div>
<div class="line"><span class="lineno">  160</span>        RCLCPP_ERROR(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(),<span class="stringliteral">&quot;Cannot process mobility request as map projection is not yet set!&quot;</span>);</div>
<div class="line"><span class="lineno">  161</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  162</span>      }</div>
<div class="line"><span class="lineno">  163</span>      <span class="keywordflow">if</span> (incoming_request.plan_type.type == carma_v2x_msgs::msg::PlanType::CHANGE_LANE_LEFT || incoming_request.plan_type.type == carma_v2x_msgs::msg::PlanType::CHANGE_LANE_RIGHT)</div>
<div class="line"><span class="lineno">  164</span>      {</div>
<div class="line"><span class="lineno">  165</span>        RCLCPP_DEBUG(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(),<span class="stringliteral">&quot;Cooperative Lane Change Request Received&quot;</span>);</div>
<div class="line"><span class="lineno">  166</span>        lc_status_msg.status = carma_planning_msgs::msg::LaneChangeStatus::REQUEST_RECEIVED;</div>
<div class="line"><span class="lineno">  167</span>        lc_status_msg.description = <span class="stringliteral">&quot;Received lane merge request&quot;</span>;</div>
<div class="line"><span class="lineno">  168</span> </div>
<div class="line"><span class="lineno">  169</span>        <span class="keywordflow">if</span> (incoming_request.m_header.recipient_id == <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#ab1f62a493a4229d4801841eb19fb1e7d">config_</a>.<a class="code hl_variable" href="structYieldPluginConfig.html#a60e81669e3f640da18139b681e4ae426">vehicle_id</a>)</div>
<div class="line"><span class="lineno">  170</span>        {</div>
<div class="line"><span class="lineno">  171</span>          RCLCPP_DEBUG(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(),<span class="stringliteral">&quot;CLC Request correctly received&quot;</span>);</div>
<div class="line"><span class="lineno">  172</span>        }</div>
<div class="line"><span class="lineno">  173</span> </div>
<div class="line"><span class="lineno">  174</span>        <span class="comment">// extract mobility header</span></div>
<div class="line"><span class="lineno">  175</span>        std::string req_sender_id = incoming_request.m_header.sender_id;</div>
<div class="line"><span class="lineno">  176</span>        std::string req_plan_id = incoming_request.m_header.plan_id;</div>
<div class="line"><span class="lineno">  177</span>        <span class="comment">// extract mobility request</span></div>
<div class="line"><span class="lineno">  178</span>        carma_v2x_msgs::msg::LocationECEF ecef_location = incoming_request.location;</div>
<div class="line"><span class="lineno">  179</span>        carma_v2x_msgs::msg::Trajectory incoming_trajectory = incoming_request.trajectory;</div>
<div class="line"><span class="lineno">  180</span>        std::string req_strategy_params = incoming_request.strategy_params;</div>
<div class="line"><span class="lineno">  181</span>        <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#ae79ca3ae3dcfb369611d20ffa4ef7660">clc_urgency_</a> = incoming_request.urgency;</div>
<div class="line"><span class="lineno">  182</span>        RCLCPP_DEBUG_STREAM(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(),<span class="stringliteral">&quot;received urgency: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#ae79ca3ae3dcfb369611d20ffa4ef7660">clc_urgency_</a>);</div>
<div class="line"><span class="lineno">  183</span> </div>
<div class="line"><span class="lineno">  184</span>        <span class="comment">// Parse strategy parameters</span></div>
<div class="line"><span class="lineno">  185</span>        <span class="keyword">using </span>boost::property_tree::ptree;</div>
<div class="line"><span class="lineno">  186</span>        ptree pt;</div>
<div class="line"><span class="lineno">  187</span>        std::istringstream strstream(req_strategy_params);</div>
<div class="line"><span class="lineno">  188</span>        boost::property_tree::json_parser::read_json(strstream, pt);</div>
<div class="line"><span class="lineno">  189</span>        <span class="keywordtype">int</span> req_traj_speed_full = pt.get&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;s&quot;</span>);</div>
<div class="line"><span class="lineno">  190</span>        <span class="keywordtype">int</span> req_traj_fractional = pt.get&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;f&quot;</span>);</div>
<div class="line"><span class="lineno">  191</span>        <span class="keywordtype">int</span> start_lanelet_id = pt.get&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;sl&quot;</span>);</div>
<div class="line"><span class="lineno">  192</span>        <span class="keywordtype">int</span> end_lanelet_id = pt.get&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;el&quot;</span>);</div>
<div class="line"><span class="lineno">  193</span>        <span class="keywordtype">double</span> req_traj_speed = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(req_traj_speed_full) + <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(req_traj_fractional)/10.0;</div>
<div class="line"><span class="lineno">  194</span>        RCLCPP_DEBUG_STREAM(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(),<span class="stringliteral">&quot;req_traj_speed&quot;</span> &lt;&lt; req_traj_speed);</div>
<div class="line"><span class="lineno">  195</span>        RCLCPP_DEBUG_STREAM(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(),<span class="stringliteral">&quot;start_lanelet_id&quot;</span> &lt;&lt; start_lanelet_id);</div>
<div class="line"><span class="lineno">  196</span>        RCLCPP_DEBUG_STREAM(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(),<span class="stringliteral">&quot;end_lanelet_id&quot;</span> &lt;&lt; end_lanelet_id);</div>
<div class="line"><span class="lineno">  197</span> </div>
<div class="line"><span class="lineno">  198</span>        std::vector&lt;lanelet::BasicPoint2d&gt; req_traj_plan = {};</div>
<div class="line"><span class="lineno">  199</span> </div>
<div class="line"><span class="lineno">  200</span>        req_traj_plan = <a class="code hl_function" href="classyield__plugin_1_1YieldPlugin.html#a5255e398082083d48e7b07054f82fad8">convert_eceftrajectory_to_mappoints</a>(incoming_trajectory);</div>
<div class="line"><span class="lineno">  201</span> </div>
<div class="line"><span class="lineno">  202</span>        <span class="keywordtype">double</span> req_expiration_sec = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(incoming_request.expiration);</div>
<div class="line"><span class="lineno">  203</span>        <span class="keywordtype">double</span> current_time_sec = <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;now().seconds();</div>
<div class="line"><span class="lineno">  204</span> </div>
<div class="line"><span class="lineno">  205</span>        <span class="keywordtype">bool</span> response_to_clc_req = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  206</span>        <span class="comment">// ensure there is enough time for the yield</span></div>
<div class="line"><span class="lineno">  207</span>        <span class="keywordtype">double</span> req_plan_time = req_expiration_sec - current_time_sec;</div>
<div class="line"><span class="lineno">  208</span>        <span class="keywordtype">double</span> req_timestamp = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(incoming_request.m_header.timestamp) / 1000.0 - current_time_sec;</div>
<div class="line"><span class="lineno">  209</span>        <a class="code hl_function" href="classyield__plugin_1_1YieldPlugin.html#a2def22504a4972db1994e96033e76ee9">set_incoming_request_info</a>(req_traj_plan, req_traj_speed, req_plan_time, req_timestamp);</div>
<div class="line"><span class="lineno">  210</span> </div>
<div class="line"><span class="lineno">  211</span> </div>
<div class="line"><span class="lineno">  212</span>        <span class="keywordflow">if</span> (req_expiration_sec - current_time_sec &gt;= <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#ab1f62a493a4229d4801841eb19fb1e7d">config_</a>.<a class="code hl_variable" href="structYieldPluginConfig.html#accd4e108184fe5a470d4f8af1de1e7a2">min_obj_avoidance_plan_time_in_s</a> &amp;&amp; <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#ad694d6ea9d5ca884e29f33a48fe19ae3">cooperative_request_acceptable_</a>)</div>
<div class="line"><span class="lineno">  213</span>        {</div>
<div class="line"><span class="lineno">  214</span>          <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#ae3f7420f5eccdb7f4b4ec59c7f69ec3f">timesteps_since_last_req_</a> = 0;</div>
<div class="line"><span class="lineno">  215</span>          lc_status_msg.status = carma_planning_msgs::msg::LaneChangeStatus::REQUEST_ACCEPTED;</div>
<div class="line"><span class="lineno">  216</span>          lc_status_msg.description = <span class="stringliteral">&quot;Accepted lane merge request&quot;</span>;</div>
<div class="line"><span class="lineno">  217</span>          response_to_clc_req = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  218</span>          RCLCPP_DEBUG(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(),<span class="stringliteral">&quot;CLC accepted&quot;</span>);</div>
<div class="line"><span class="lineno">  219</span>        }</div>
<div class="line"><span class="lineno">  220</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  221</span>        {</div>
<div class="line"><span class="lineno">  222</span>          lc_status_msg.status = carma_planning_msgs::msg::LaneChangeStatus::REQUEST_REJECTED;</div>
<div class="line"><span class="lineno">  223</span>          lc_status_msg.description = <span class="stringliteral">&quot;Rejected lane merge request&quot;</span>;</div>
<div class="line"><span class="lineno">  224</span>          response_to_clc_req = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  225</span>          RCLCPP_DEBUG(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(),<span class="stringliteral">&quot;CLC rejected&quot;</span>);</div>
<div class="line"><span class="lineno">  226</span>        }</div>
<div class="line"><span class="lineno">  227</span>        carma_v2x_msgs::msg::MobilityResponse outgoing_response = <a class="code hl_function" href="classyield__plugin_1_1YieldPlugin.html#acf45eb277044353dbb87226f0bec3f06">compose_mobility_response</a>(req_sender_id, req_plan_id, response_to_clc_req);</div>
<div class="line"><span class="lineno">  228</span>        <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#a82d36ef453849014abfe64e6ecac5e58">mobility_response_publisher_</a>(outgoing_response);</div>
<div class="line"><span class="lineno">  229</span>        lc_status_msg.status = carma_planning_msgs::msg::LaneChangeStatus::RESPONSE_SENT;</div>
<div class="line"><span class="lineno">  230</span>        RCLCPP_DEBUG(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(),<span class="stringliteral">&quot;response sent&quot;</span>);</div>
<div class="line"><span class="lineno">  231</span>      }</div>
<div class="line"><span class="lineno">  232</span>    }</div>
<div class="line"><span class="lineno">  233</span>    <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#a274208e09bc96aaef0ba731904aa57de">lc_status_publisher_</a>(lc_status_msg);</div>
<div class="line"><span class="lineno">  234</span> </div>
<div class="line"><span class="lineno">  235</span>  }</div>
<div class="ttc" id="aclassyield__plugin_1_1YieldPlugin_html_a2def22504a4972db1994e96033e76ee9"><div class="ttname"><a href="classyield__plugin_1_1YieldPlugin.html#a2def22504a4972db1994e96033e76ee9">yield_plugin::YieldPlugin::set_incoming_request_info</a></div><div class="ttdeci">void set_incoming_request_info(std::vector&lt; lanelet::BasicPoint2d &gt; req_trajectory, double req_speed, double req_planning_time, double req_timestamp)</div><div class="ttdoc">set values for member variables related to cooperative behavior</div><div class="ttdef"><b>Definition:</b> <a href="yield__plugin_8cpp_source.html#l00237">yield_plugin.cpp:237</a></div></div>
<div class="ttc" id="aclassyield__plugin_1_1YieldPlugin_html_a5255e398082083d48e7b07054f82fad8"><div class="ttname"><a href="classyield__plugin_1_1YieldPlugin.html#a5255e398082083d48e7b07054f82fad8">yield_plugin::YieldPlugin::convert_eceftrajectory_to_mappoints</a></div><div class="ttdeci">std::vector&lt; lanelet::BasicPoint2d &gt; convert_eceftrajectory_to_mappoints(const carma_v2x_msgs::msg::Trajectory &amp;ecef_trajectory) const</div><div class="ttdoc">convert a carma trajectory from ecef frame to map frame ecef trajectory consists of the point and a s...</div><div class="ttdef"><b>Definition:</b> <a href="yield__plugin_8cpp_source.html#l00094">yield_plugin.cpp:94</a></div></div>
<div class="ttc" id="aclassyield__plugin_1_1YieldPlugin_html_acf45eb277044353dbb87226f0bec3f06"><div class="ttname"><a href="classyield__plugin_1_1YieldPlugin.html#acf45eb277044353dbb87226f0bec3f06">yield_plugin::YieldPlugin::compose_mobility_response</a></div><div class="ttdeci">carma_v2x_msgs::msg::MobilityResponse compose_mobility_response(const std::string &amp;resp_recipient_id, const std::string &amp;req_plan_id, bool response) const</div><div class="ttdoc">compose a mobility response message</div><div class="ttdef"><b>Definition:</b> <a href="yield__plugin_8cpp_source.html#l00133">yield_plugin.cpp:133</a></div></div>
<div class="ttc" id="aclassyield__plugin_1_1YieldPlugin_html_ad694d6ea9d5ca884e29f33a48fe19ae3"><div class="ttname"><a href="classyield__plugin_1_1YieldPlugin.html#ad694d6ea9d5ca884e29f33a48fe19ae3">yield_plugin::YieldPlugin::cooperative_request_acceptable_</a></div><div class="ttdeci">bool cooperative_request_acceptable_</div><div class="ttdef"><b>Definition:</b> <a href="yield__plugin_8hpp_source.html#l00321">yield_plugin.hpp:321</a></div></div>
<div class="ttc" id="aclassyield__plugin_1_1YieldPlugin_html_ae3f7420f5eccdb7f4b4ec59c7f69ec3f"><div class="ttname"><a href="classyield__plugin_1_1YieldPlugin.html#ae3f7420f5eccdb7f4b4ec59c7f69ec3f">yield_plugin::YieldPlugin::timesteps_since_last_req_</a></div><div class="ttdeci">int timesteps_since_last_req_</div><div class="ttdef"><b>Definition:</b> <a href="yield__plugin_8hpp_source.html#l00328">yield_plugin.hpp:328</a></div></div>
<div class="ttc" id="aclassyield__plugin_1_1YieldPlugin_html_ae79ca3ae3dcfb369611d20ffa4ef7660"><div class="ttname"><a href="classyield__plugin_1_1YieldPlugin.html#ae79ca3ae3dcfb369611d20ffa4ef7660">yield_plugin::YieldPlugin::clc_urgency_</a></div><div class="ttdeci">int clc_urgency_</div><div class="ttdef"><b>Definition:</b> <a href="yield__plugin_8hpp_source.html#l00329">yield_plugin.hpp:329</a></div></div>
<div class="ttc" id="astructYieldPluginConfig_html_accd4e108184fe5a470d4f8af1de1e7a2"><div class="ttname"><a href="structYieldPluginConfig.html#accd4e108184fe5a470d4f8af1de1e7a2">YieldPluginConfig::min_obj_avoidance_plan_time_in_s</a></div><div class="ttdeci">double min_obj_avoidance_plan_time_in_s</div><div class="ttdef"><b>Definition:</b> <a href="yield__config_8hpp_source.html#l00029">yield_config.hpp:29</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="yield__plugin_8hpp_source.html#l00329">clc_urgency_</a>, <a class="el" href="yield__plugin_8cpp_source.html#l00133">compose_mobility_response()</a>, <a class="el" href="yield__plugin_8hpp_source.html#l00312">config_</a>, <a class="el" href="yield__plugin_8cpp_source.html#l00094">convert_eceftrajectory_to_mappoints()</a>, <a class="el" href="yield__plugin_8hpp_source.html#l00321">cooperative_request_acceptable_</a>, <a class="el" href="yield__plugin_8hpp_source.html#l00314">lc_status_publisher_</a>, <a class="el" href="yield__plugin_8hpp_source.html#l00340">map_projector_</a>, <a class="el" href="yield__config_8hpp_source.html#l00029">YieldPluginConfig::min_obj_avoidance_plan_time_in_s</a>, <a class="el" href="yield__plugin_8hpp_source.html#l00313">mobility_response_publisher_</a>, <a class="el" href="yield__plugin_8hpp_source.html#l00315">nh_</a>, <a class="el" href="yield__plugin_8cpp_source.html#l00237">set_incoming_request_info()</a>, <a class="el" href="yield__plugin_8hpp_source.html#l00328">timesteps_since_last_req_</a>, and <a class="el" href="yield__config_8hpp_source.html#l00038">YieldPluginConfig::vehicle_id</a>.</p>

<p class="reference">Referenced by <a class="el" href="yield__plugin__node_8cpp_source.html#l00054">yield_plugin::YieldPluginNode::on_configure_plugin()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classyield__plugin_1_1YieldPlugin_a3276c693a65319e769e63078284d3056_cgraph.png" border="0" usemap="#aclassyield__plugin_1_1YieldPlugin_a3276c693a65319e769e63078284d3056_cgraph" alt=""/></div>
<map name="aclassyield__plugin_1_1YieldPlugin_a3276c693a65319e769e63078284d3056_cgraph" id="aclassyield__plugin_1_1YieldPlugin_a3276c693a65319e769e63078284d3056_cgraph">
<area shape="rect" title="callback for mobility request" alt="" coords="5,77,165,119"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#acf45eb277044353dbb87226f0bec3f06" title="compose a mobility response message" alt="" coords="213,5,405,47"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#a5255e398082083d48e7b07054f82fad8" title="convert a carma trajectory from ecef frame to map frame ecef trajectory consists of the point and a s..." alt="" coords="229,70,389,126"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#a2def22504a4972db1994e96033e76ee9" title="set values for member variables related to cooperative behavior" alt="" coords="218,149,401,191"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#ac0b6fb988e61ce2cfb04c4a1f33070d5" title="convert a point in ecef frame (in cm) into map frame (in meters)" alt="" coords="453,77,613,119"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classyield__plugin_1_1YieldPlugin_a3276c693a65319e769e63078284d3056_icgraph.png" border="0" usemap="#aclassyield__plugin_1_1YieldPlugin_a3276c693a65319e769e63078284d3056_icgraph" alt=""/></div>
<map name="aclassyield__plugin_1_1YieldPlugin_a3276c693a65319e769e63078284d3056_icgraph" id="aclassyield__plugin_1_1YieldPlugin_a3276c693a65319e769e63078284d3056_icgraph">
<area shape="rect" title="callback for mobility request" alt="" coords="227,5,387,47"/>
<area shape="rect" href="classyield__plugin_1_1YieldPluginNode.html#aee4bb2ca0d05cf41f55db567d7c74553" title="Method which is triggered when this plugin is moved from the UNCONFIGURED to INACTIVE states...." alt="" coords="5,5,179,47"/>
</map>
</div>

</div>
</div>
<a id="a0fd790e287683a2ef404e16a15e0ea29" name="a0fd790e287683a2ef404e16a15e0ea29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0fd790e287683a2ef404e16a15e0ea29">&#9670;&nbsp;</a></span>plan_trajectory_callback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void yield_plugin::YieldPlugin::plan_trajectory_callback </td>
          <td>(</td>
          <td class="paramtype">carma_planning_msgs::srv::PlanTrajectory::Request::SharedPtr&#160;</td>
          <td class="paramname"><em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">carma_planning_msgs::srv::PlanTrajectory::Response::SharedPtr&#160;</td>
          <td class="paramname"><em>resp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Service callback for trajectory planning. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">srv_header</td><td>header </td></tr>
    <tr><td class="paramname">req</td><td>The service request </td></tr>
    <tr><td class="paramname">resp</td><td>The service response </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="yield__plugin_8cpp_source.html#l00252">252</a> of file <a class="el" href="yield__plugin_8cpp_source.html">yield_plugin.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  255</span>{</div>
<div class="line"><span class="lineno">  256</span>    RCLCPP_DEBUG(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(),<span class="stringliteral">&quot;Yield_plugin was called!&quot;</span>);</div>
<div class="line"><span class="lineno">  257</span>    <span class="keywordflow">if</span> (req-&gt;initial_trajectory_plan.trajectory_points.size() &lt; 2){</div>
<div class="line"><span class="lineno">  258</span>      <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;Empty Trajectory received by Yield&quot;</span>);</div>
<div class="line"><span class="lineno">  259</span>    }</div>
<div class="line"><span class="lineno">  260</span>    rclcpp::Clock system_clock(RCL_SYSTEM_TIME);</div>
<div class="line"><span class="lineno">  261</span>    rclcpp::Time start_time = system_clock.now();  <span class="comment">// Start timing the execution time for planning so it can be logged</span></div>
<div class="line"><span class="lineno">  262</span> </div>
<div class="line"><span class="lineno">  263</span>    carma_planning_msgs::msg::TrajectoryPlan original_trajectory = req-&gt;initial_trajectory_plan;</div>
<div class="line"><span class="lineno">  264</span>    carma_planning_msgs::msg::TrajectoryPlan yield_trajectory;</div>
<div class="line"><span class="lineno">  265</span> </div>
<div class="line"><span class="lineno">  266</span> </div>
<div class="line"><span class="lineno">  267</span>    <span class="keywordtype">double</span> initial_velocity = req-&gt;vehicle_state.longitudinal_vel;</div>
<div class="line"><span class="lineno">  268</span>    <span class="comment">// If vehicle_state is stopped, non-zero velocity from the trajectory</span></div>
<div class="line"><span class="lineno">  269</span>    <span class="comment">// should be used. Otherwise, vehicle will not move.</span></div>
<div class="line"><span class="lineno">  270</span>    <span class="keywordflow">if</span> (initial_velocity &lt; <a class="code hl_variable" href="yield__plugin_8cpp.html#a6f9399eaf2efb1b12e797b77909df9ac">EPSILON</a>)</div>
<div class="line"><span class="lineno">  271</span>    {</div>
<div class="line"><span class="lineno">  272</span>      initial_velocity = original_trajectory.initial_longitudinal_velocity;</div>
<div class="line"><span class="lineno">  273</span>    }</div>
<div class="line"><span class="lineno">  274</span> </div>
<div class="line"><span class="lineno">  275</span>    <span class="comment">// seperating cooperative yield with regular object detection for better performance.</span></div>
<div class="line"><span class="lineno">  276</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#ab1f62a493a4229d4801841eb19fb1e7d">config_</a>.<a class="code hl_variable" href="structYieldPluginConfig.html#ac9bcf3101e2e858035adbf089cfe57a9">enable_cooperative_behavior</a> &amp;&amp; <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#ae79ca3ae3dcfb369611d20ffa4ef7660">clc_urgency_</a> &gt; <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#ab1f62a493a4229d4801841eb19fb1e7d">config_</a>.<a class="code hl_variable" href="structYieldPluginConfig.html#ab38d52251f92d06ed380887824745784">acceptable_urgency</a>)</div>
<div class="line"><span class="lineno">  277</span>    {</div>
<div class="line"><span class="lineno">  278</span>      RCLCPP_DEBUG(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(),<span class="stringliteral">&quot;Only consider high urgency clc&quot;</span>);</div>
<div class="line"><span class="lineno">  279</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#ae3f7420f5eccdb7f4b4ec59c7f69ec3f">timesteps_since_last_req_</a> &lt; <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#ab1f62a493a4229d4801841eb19fb1e7d">config_</a>.<a class="code hl_variable" href="structYieldPluginConfig.html#af17f6b695b3a4372462f7c252ec4daa8">acceptable_passed_timesteps</a>)</div>
<div class="line"><span class="lineno">  280</span>      {</div>
<div class="line"><span class="lineno">  281</span>        RCLCPP_DEBUG(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(),<span class="stringliteral">&quot;Yield for CLC. We haven&#39;t received an updated negotiation this timestep&quot;</span>);</div>
<div class="line"><span class="lineno">  282</span>        yield_trajectory = <a class="code hl_function" href="classyield__plugin_1_1YieldPlugin.html#ad9c9e0e4278774a519de12a6a5f4398f">update_traj_for_cooperative_behavior</a>(original_trajectory, initial_velocity);</div>
<div class="line"><span class="lineno">  283</span>        <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#ae3f7420f5eccdb7f4b4ec59c7f69ec3f">timesteps_since_last_req_</a>++;</div>
<div class="line"><span class="lineno">  284</span>      }</div>
<div class="line"><span class="lineno">  285</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  286</span>      {</div>
<div class="line"><span class="lineno">  287</span>        RCLCPP_DEBUG(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(),<span class="stringliteral">&quot;unreliable CLC communication, switching to object avoidance&quot;</span>);</div>
<div class="line"><span class="lineno">  288</span>        yield_trajectory = <a class="code hl_function" href="classyield__plugin_1_1YieldPlugin.html#ac1c423b99887ccbf945a86da7b7809f6">update_traj_for_object</a>(original_trajectory, <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#ade1ae58ef6dfc4c31025162c8c150b0a">external_objects_</a>, initial_velocity); <span class="comment">// Compute the trajectory</span></div>
<div class="line"><span class="lineno">  289</span>      }</div>
<div class="line"><span class="lineno">  290</span>    }</div>
<div class="line"><span class="lineno">  291</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  292</span>    {</div>
<div class="line"><span class="lineno">  293</span>      RCLCPP_DEBUG(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(),<span class="stringliteral">&quot;Yield for object avoidance&quot;</span>);</div>
<div class="line"><span class="lineno">  294</span>      yield_trajectory = <a class="code hl_function" href="classyield__plugin_1_1YieldPlugin.html#ac1c423b99887ccbf945a86da7b7809f6">update_traj_for_object</a>(original_trajectory, <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#ade1ae58ef6dfc4c31025162c8c150b0a">external_objects_</a>, initial_velocity); <span class="comment">// Compute the trajectory</span></div>
<div class="line"><span class="lineno">  295</span>    }</div>
<div class="line"><span class="lineno">  296</span> </div>
<div class="line"><span class="lineno">  297</span>    <span class="comment">// return original trajectory if no difference in trajectory points a.k.a no collision</span></div>
<div class="line"><span class="lineno">  298</span>    <span class="keywordflow">if</span> (fabs(<a class="code hl_function" href="namespaceyield__plugin.html#a82b2a694528d42a4af068732befca882">get_trajectory_end_time</a>(original_trajectory) - <a class="code hl_function" href="namespaceyield__plugin.html#a82b2a694528d42a4af068732befca882">get_trajectory_end_time</a>(yield_trajectory)) &lt; <a class="code hl_variable" href="yield__plugin_8cpp.html#a6f9399eaf2efb1b12e797b77909df9ac">EPSILON</a>)</div>
<div class="line"><span class="lineno">  299</span>    {</div>
<div class="line"><span class="lineno">  300</span>      resp-&gt;trajectory_plan = original_trajectory;</div>
<div class="line"><span class="lineno">  301</span>    }</div>
<div class="line"><span class="lineno">  302</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  303</span>    {</div>
<div class="line"><span class="lineno">  304</span>      yield_trajectory.header.frame_id = <span class="stringliteral">&quot;map&quot;</span>;</div>
<div class="line"><span class="lineno">  305</span>      yield_trajectory.header.stamp = <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;now();</div>
<div class="line"><span class="lineno">  306</span>      yield_trajectory.trajectory_id = original_trajectory.trajectory_id;</div>
<div class="line"><span class="lineno">  307</span>      resp-&gt;trajectory_plan = yield_trajectory;</div>
<div class="line"><span class="lineno">  308</span>    }</div>
<div class="line"><span class="lineno">  309</span> </div>
<div class="line"><span class="lineno">  310</span>    rclcpp::Time end_time = system_clock.now();  <span class="comment">// Planning complete</span></div>
<div class="line"><span class="lineno">  311</span> </div>
<div class="line"><span class="lineno">  312</span>    <span class="keyword">auto</span> duration = end_time - start_time;</div>
<div class="line"><span class="lineno">  313</span>    RCLCPP_DEBUG_STREAM(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(), <span class="stringliteral">&quot;ExecutionTime: &quot;</span> &lt;&lt; <a class="code hl_function" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5">std::to_string</a>(duration.seconds()));</div>
<div class="line"><span class="lineno">  314</span> </div>
<div class="line"><span class="lineno">  315</span>  }</div>
<div class="ttc" id="aclassyield__plugin_1_1YieldPlugin_html_ac1c423b99887ccbf945a86da7b7809f6"><div class="ttname"><a href="classyield__plugin_1_1YieldPlugin.html#ac1c423b99887ccbf945a86da7b7809f6">yield_plugin::YieldPlugin::update_traj_for_object</a></div><div class="ttdeci">carma_planning_msgs::msg::TrajectoryPlan update_traj_for_object(const carma_planning_msgs::msg::TrajectoryPlan &amp;original_tp, const std::vector&lt; carma_perception_msgs::msg::ExternalObject &gt; &amp;external_objects, double initial_velocity)</div><div class="ttdoc">trajectory is modified to safely avoid obstacles on the road</div><div class="ttdef"><b>Definition:</b> <a href="yield__plugin_8cpp_source.html#l00888">yield_plugin.cpp:888</a></div></div>
<div class="ttc" id="aclassyield__plugin_1_1YieldPlugin_html_ad9c9e0e4278774a519de12a6a5f4398f"><div class="ttname"><a href="classyield__plugin_1_1YieldPlugin.html#ad9c9e0e4278774a519de12a6a5f4398f">yield_plugin::YieldPlugin::update_traj_for_cooperative_behavior</a></div><div class="ttdeci">carma_planning_msgs::msg::TrajectoryPlan update_traj_for_cooperative_behavior(const carma_planning_msgs::msg::TrajectoryPlan &amp;original_tp, double current_speed)</div><div class="ttdoc">update trajectory for yielding to an incoming cooperative behavior</div><div class="ttdef"><b>Definition:</b> <a href="yield__plugin_8cpp_source.html#l00317">yield_plugin.cpp:317</a></div></div>
<div class="ttc" id="aclassyield__plugin_1_1YieldPlugin_html_ade1ae58ef6dfc4c31025162c8c150b0a"><div class="ttname"><a href="classyield__plugin_1_1YieldPlugin.html#ade1ae58ef6dfc4c31025162c8c150b0a">yield_plugin::YieldPlugin::external_objects_</a></div><div class="ttdeci">std::vector&lt; carma_perception_msgs::msg::ExternalObject &gt; external_objects_</div><div class="ttdef"><b>Definition:</b> <a href="yield__plugin_8hpp_source.html#l00318">yield_plugin.hpp:318</a></div></div>
<div class="ttc" id="astructYieldPluginConfig_html_ab38d52251f92d06ed380887824745784"><div class="ttname"><a href="structYieldPluginConfig.html#ab38d52251f92d06ed380887824745784">YieldPluginConfig::acceptable_urgency</a></div><div class="ttdeci">int acceptable_urgency</div><div class="ttdef"><b>Definition:</b> <a href="yield__config_8hpp_source.html#l00044">yield_config.hpp:44</a></div></div>
<div class="ttc" id="astructYieldPluginConfig_html_ac9bcf3101e2e858035adbf089cfe57a9"><div class="ttname"><a href="structYieldPluginConfig.html#ac9bcf3101e2e858035adbf089cfe57a9">YieldPluginConfig::enable_cooperative_behavior</a></div><div class="ttdeci">bool enable_cooperative_behavior</div><div class="ttdef"><b>Definition:</b> <a href="yield__config_8hpp_source.html#l00036">yield_config.hpp:36</a></div></div>
<div class="ttc" id="astructYieldPluginConfig_html_af17f6b695b3a4372462f7c252ec4daa8"><div class="ttname"><a href="structYieldPluginConfig.html#af17f6b695b3a4372462f7c252ec4daa8">YieldPluginConfig::acceptable_passed_timesteps</a></div><div class="ttdeci">int acceptable_passed_timesteps</div><div class="ttdef"><b>Definition:</b> <a href="yield__config_8hpp_source.html#l00039">yield_config.hpp:39</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="yield__config_8hpp_source.html#l00039">YieldPluginConfig::acceptable_passed_timesteps</a>, <a class="el" href="yield__config_8hpp_source.html#l00044">YieldPluginConfig::acceptable_urgency</a>, <a class="el" href="yield__plugin_8hpp_source.html#l00329">clc_urgency_</a>, <a class="el" href="yield__plugin_8hpp_source.html#l00312">config_</a>, <a class="el" href="yield__config_8hpp_source.html#l00036">YieldPluginConfig::enable_cooperative_behavior</a>, <a class="el" href="yield__plugin_8cpp_source.html#l00041">EPSILON</a>, <a class="el" href="yield__plugin_8hpp_source.html#l00318">external_objects_</a>, <a class="el" href="yield__plugin_8cpp_source.html#l00053">yield_plugin::get_trajectory_end_time()</a>, <a class="el" href="yield__plugin_8hpp_source.html#l00315">nh_</a>, <a class="el" href="yield__plugin_8hpp_source.html#l00328">timesteps_since_last_req_</a>, <a class="el" href="utm__zone_8cpp_source.html#l00021">carma_cooperative_perception::to_string()</a>, <a class="el" href="yield__plugin_8cpp_source.html#l00317">update_traj_for_cooperative_behavior()</a>, and <a class="el" href="yield__plugin_8cpp_source.html#l00888">update_traj_for_object()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classyield__plugin_1_1YieldPlugin_a0fd790e287683a2ef404e16a15e0ea29_cgraph.png" border="0" usemap="#aclassyield__plugin_1_1YieldPlugin_a0fd790e287683a2ef404e16a15e0ea29_cgraph" alt=""/></div>
<map name="aclassyield__plugin_1_1YieldPlugin_a0fd790e287683a2ef404e16a15e0ea29_cgraph" id="aclassyield__plugin_1_1YieldPlugin_a0fd790e287683a2ef404e16a15e0ea29_cgraph">
<area shape="rect" title="Service callback for trajectory planning." alt="" coords="5,367,172,409"/>
<area shape="rect" href="namespaceyield__plugin.html#a82b2a694528d42a4af068732befca882" title=" " alt="" coords="1653,415,1827,457"/>
<area shape="rect" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5" title=" " alt="" coords="1407,619,1605,661"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#ad9c9e0e4278774a519de12a6a5f4398f" title="update trajectory for yielding to an incoming cooperative behavior" alt="" coords="220,297,408,353"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#ac1c423b99887ccbf945a86da7b7809f6" title="trajectory is modified to safely avoid obstacles on the road" alt="" coords="234,433,394,474"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#a3703b49299aa6b61b3889a8e6799ac74" title="checks trajectory for minimum gap associated with it" alt="" coords="481,392,641,448"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#abb40cf8a08a75c472791dbd91b99d8dc" title="detect intersection point(s) of two trajectories" alt="" coords="456,210,665,251"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#ace53f1895cbbf2a5f109cbfc11d6313f" title="generate a Jerk Minimizing Trajectory(JMT) with the provided start and end conditions" alt="" coords="475,275,646,317"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#ae53a42abb996d38cf701a3fba7e473f8" title="calculates the maximum speed in a set of tajectory points" alt="" coords="741,523,901,565"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#a1bc011c9c2db48289bf40214d972cec4" title="calculates distance between trajectory points in a plan" alt="" coords="737,159,906,201"/>
<area shape="rect" href="namespaceyield__plugin.html#a6685355374aa80334c267d788788cb2f" title=" " alt="" coords="737,225,906,266"/>
<area shape="rect" href="namespacebasic__autonomy_1_1smoothing.html#afb726e75a21ada8efa3ca5561ffc9984" title="Extremely simplie moving average filter." alt="" coords="730,290,913,331"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#ae7ffd46ccbae6de4b60a7f49a8cfa3d6" title="calculate quintic polynomial equation for a given x" alt="" coords="741,355,901,397"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#afeab08ed138eafe6e24abd775c3163dd" title="calculate derivative of quintic polynomial equation for a given x" alt="" coords="741,94,901,135"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#a546149400d9d6371c5de50f229d6ecfc" title="Return the earliest collision object and time of collision pair from the given trajectory and list of..." alt="" coords="481,575,641,631"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#a378558cb2b27d8337d980150543d447d" title="Given the object velocity in map frame with x,y components, this function returns the projected veloc..." alt="" coords="1192,408,1352,464"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#aae4fab3792eaa78de9a88299c209246d" title="Given the list of objects with predicted states, get all collision times concurrently using multi&#45;thr..." alt="" coords="713,641,929,682"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#a5644e9f63528efc0484b875c7debef01" title="Return collision time given two trajectories with one being external object with predicted steps." alt="" coords="977,641,1137,682"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#ab60b2f939cebede3a6d9a3ae5529b0d9" title="Return naive collision time and locations based on collision radius given two trajectories with one b..." alt="" coords="1192,758,1352,799"/>
<area shape="rect" href="namespaceyield__plugin.html#a754c9aebad547b09cdeff7080a639bd3" title=" " alt="" coords="1653,787,1827,829"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#ae1279ff6d53eb474b635f992ed854d0b" title="Check if object location is behind the vehicle using estimates of the vehicle&#39;s length and route down..." alt="" coords="1185,590,1359,631"/>
<area shape="rect" href="namespaceyield__plugin.html#ad78fa1e6a7a22eff6b76dd32700fc55f" title=" " alt="" coords="1419,758,1593,799"/>
</map>
</div>

</div>
</div>
<a id="ae7ffd46ccbae6de4b60a7f49a8cfa3d6" name="ae7ffd46ccbae6de4b60a7f49a8cfa3d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7ffd46ccbae6de4b60a7f49a8cfa3d6">&#9670;&nbsp;</a></span>polynomial_calc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double yield_plugin::YieldPlugin::polynomial_calc </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; double &gt;&#160;</td>
          <td class="paramname"><em>coeff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculate quintic polynomial equation for a given x </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">coeff</td><td>vector including polynomial coefficiencrs </td></tr>
    <tr><td class="paramname">x</td><td>input variable to the polynomial </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>value of polynomial for given input </dd></dl>

<p class="definition">Definition at line <a class="el" href="yield__plugin_8cpp_source.html#l00991">991</a> of file <a class="el" href="yield__plugin_8cpp_source.html">yield_plugin.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  992</span>  {</div>
<div class="line"><span class="lineno">  993</span>    <span class="keywordtype">double</span> result = 0;</div>
<div class="line"><span class="lineno">  994</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> = 0; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> &lt; coeff.size(); <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>++)</div>
<div class="line"><span class="lineno">  995</span>    {</div>
<div class="line"><span class="lineno">  996</span>      <span class="keywordtype">double</span> <a class="code hl_variable" href="pointer_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a> = coeff.at(<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>) * pow(<a class="code hl_variable" href="namespaceprocess__traj__logs.html#af3ba6144a2d35a4990f1a8d04632a052">x</a>, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(coeff.size() - 1 - <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>));</div>
<div class="line"><span class="lineno">  997</span>      result = result + <a class="code hl_variable" href="pointer_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a>;</div>
<div class="line"><span class="lineno">  998</span>    }</div>
<div class="line"><span class="lineno">  999</span>    <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno"> 1000</span>  }</div>
<div class="ttc" id="anamespaceprocess__traj__logs_html_af3ba6144a2d35a4990f1a8d04632a052"><div class="ttname"><a href="namespaceprocess__traj__logs.html#af3ba6144a2d35a4990f1a8d04632a052">process_traj_logs.x</a></div><div class="ttdeci">x</div><div class="ttdef"><b>Definition:</b> <a href="process__traj__logs_8py_source.html#l00128">process_traj_logs.py:128</a></div></div>
<div class="ttc" id="apointer_8h_html_a32aff7c6c4cd253fdf6563677afab5ce"><div class="ttname"><a href="pointer_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a></div><div class="ttdeci">const GenericPointer&lt; typename T::ValueType &gt; T2 value</div><div class="ttdef"><b>Definition:</b> <a href="pointer_8h_source.html#l01222">pointer.h:1222</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="process__bag_8py_source.html#l00059">process_bag::i</a>, <a class="el" href="pointer_8h_source.html#l01222">value</a>, and <a class="el" href="process__traj__logs_8py_source.html#l00128">process_traj_logs::x</a>.</p>

<p class="reference">Referenced by <a class="el" href="yield__plugin_8cpp_source.html#l00402">generate_JMT_trajectory()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classyield__plugin_1_1YieldPlugin_ae7ffd46ccbae6de4b60a7f49a8cfa3d6_icgraph.png" border="0" usemap="#aclassyield__plugin_1_1YieldPlugin_ae7ffd46ccbae6de4b60a7f49a8cfa3d6_icgraph" alt=""/></div>
<map name="aclassyield__plugin_1_1YieldPlugin_ae7ffd46ccbae6de4b60a7f49a8cfa3d6_icgraph" id="aclassyield__plugin_1_1YieldPlugin_ae7ffd46ccbae6de4b60a7f49a8cfa3d6_icgraph">
<area shape="rect" title="calculate quintic polynomial equation for a given x" alt="" coords="675,49,835,90"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#ace53f1895cbbf2a5f109cbfc11d6313f" title="generate a Jerk Minimizing Trajectory(JMT) with the provided start and end conditions" alt="" coords="456,49,627,90"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#ad9c9e0e4278774a519de12a6a5f4398f" title="update trajectory for yielding to an incoming cooperative behavior" alt="" coords="220,5,408,61"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#ac1c423b99887ccbf945a86da7b7809f6" title="trajectory is modified to safely avoid obstacles on the road" alt="" coords="234,85,394,126"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#a0fd790e287683a2ef404e16a15e0ea29" title="Service callback for trajectory planning." alt="" coords="5,49,172,90"/>
</map>
</div>

</div>
</div>
<a id="afeab08ed138eafe6e24abd775c3163dd" name="afeab08ed138eafe6e24abd775c3163dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afeab08ed138eafe6e24abd775c3163dd">&#9670;&nbsp;</a></span>polynomial_calc_d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double yield_plugin::YieldPlugin::polynomial_calc_d </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; double &gt;&#160;</td>
          <td class="paramname"><em>coeff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculate derivative of quintic polynomial equation for a given x </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">coeff</td><td>vector including polynomial coefficiencrs </td></tr>
    <tr><td class="paramname">x</td><td>input variable to the polynomial </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>value of derivative polynomial for given input </dd></dl>

<p class="definition">Definition at line <a class="el" href="yield__plugin_8cpp_source.html#l01002">1002</a> of file <a class="el" href="yield__plugin_8cpp_source.html">yield_plugin.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1003</span>  {</div>
<div class="line"><span class="lineno"> 1004</span>    <span class="keywordtype">double</span> result = 0;</div>
<div class="line"><span class="lineno"> 1005</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> = 0; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> &lt; coeff.size()-1; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>++)</div>
<div class="line"><span class="lineno"> 1006</span>    {</div>
<div class="line"><span class="lineno"> 1007</span>      <span class="keywordtype">double</span> <a class="code hl_variable" href="pointer_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(coeff.size() - 1 - <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>) * coeff.at(<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>) * pow(<a class="code hl_variable" href="namespaceprocess__traj__logs.html#af3ba6144a2d35a4990f1a8d04632a052">x</a>, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(coeff.size() - 2 - <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>));</div>
<div class="line"><span class="lineno"> 1008</span>      result = result + <a class="code hl_variable" href="pointer_8h.html#a32aff7c6c4cd253fdf6563677afab5ce">value</a>;</div>
<div class="line"><span class="lineno"> 1009</span>    }</div>
<div class="line"><span class="lineno"> 1010</span>    <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno"> 1011</span>  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="process__bag_8py_source.html#l00059">process_bag::i</a>, <a class="el" href="pointer_8h_source.html#l01222">value</a>, and <a class="el" href="process__traj__logs_8py_source.html#l00128">process_traj_logs::x</a>.</p>

<p class="reference">Referenced by <a class="el" href="yield__plugin_8cpp_source.html#l00402">generate_JMT_trajectory()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classyield__plugin_1_1YieldPlugin_afeab08ed138eafe6e24abd775c3163dd_icgraph.png" border="0" usemap="#aclassyield__plugin_1_1YieldPlugin_afeab08ed138eafe6e24abd775c3163dd_icgraph" alt=""/></div>
<map name="aclassyield__plugin_1_1YieldPlugin_afeab08ed138eafe6e24abd775c3163dd_icgraph" id="aclassyield__plugin_1_1YieldPlugin_afeab08ed138eafe6e24abd775c3163dd_icgraph">
<area shape="rect" title="calculate derivative of quintic polynomial equation for a given x" alt="" coords="675,49,835,90"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#ace53f1895cbbf2a5f109cbfc11d6313f" title="generate a Jerk Minimizing Trajectory(JMT) with the provided start and end conditions" alt="" coords="456,49,627,90"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#ad9c9e0e4278774a519de12a6a5f4398f" title="update trajectory for yielding to an incoming cooperative behavior" alt="" coords="220,5,408,61"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#ac1c423b99887ccbf945a86da7b7809f6" title="trajectory is modified to safely avoid obstacles on the road" alt="" coords="234,85,394,126"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#a0fd790e287683a2ef404e16a15e0ea29" title="Service callback for trajectory planning." alt="" coords="5,49,172,90"/>
</map>
</div>

</div>
</div>
<a id="a8d1efa9eb3ded474b8ec28d1c63b1eef" name="a8d1efa9eb3ded474b8ec28d1c63b1eef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d1efa9eb3ded474b8ec28d1c63b1eef">&#9670;&nbsp;</a></span>set_external_objects()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void yield_plugin::YieldPlugin::set_external_objects </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; carma_perception_msgs::msg::ExternalObject &gt; &amp;&#160;</td>
          <td class="paramname"><em>object_list</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Setter for external objects with predictions in the environment. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">object_list</td><td>The object list. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="yield__plugin_8cpp_source.html#l01070">1070</a> of file <a class="el" href="yield__plugin_8cpp_source.html">yield_plugin.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1071</span>  {</div>
<div class="line"><span class="lineno"> 1072</span>    <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#ade1ae58ef6dfc4c31025162c8c150b0a">external_objects_</a> = object_list;</div>
<div class="line"><span class="lineno"> 1073</span>  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="yield__plugin_8hpp_source.html#l00318">external_objects_</a>.</p>

</div>
</div>
<a id="aa4176fb6da1156062d1ff412016fe86e" name="aa4176fb6da1156062d1ff412016fe86e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4176fb6da1156062d1ff412016fe86e">&#9670;&nbsp;</a></span>set_georeference_string()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void yield_plugin::YieldPlugin::set_georeference_string </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>georeference</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Setter for map projection string to define lat/lon -&gt; map conversion. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">georeference</td><td>The proj string defining the projection. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="yield__plugin_8cpp_source.html#l01061">1061</a> of file <a class="el" href="yield__plugin_8cpp_source.html">yield_plugin.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1062</span>  {</div>
<div class="line"><span class="lineno"> 1063</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#a0139ba3f27c4205d7820c5e8ed668042">georeference_</a> != georeference)</div>
<div class="line"><span class="lineno"> 1064</span>    {</div>
<div class="line"><span class="lineno"> 1065</span>      <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#a0139ba3f27c4205d7820c5e8ed668042">georeference_</a> = georeference;</div>
<div class="line"><span class="lineno"> 1066</span>      <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#a42d2a2d8a9f88afbedaa566ad57c8444">map_projector_</a> = std::make_shared&lt;lanelet::projection::LocalFrameProjector&gt;(georeference.c_str());  <span class="comment">// Build projector from proj string</span></div>
<div class="line"><span class="lineno"> 1067</span>    }</div>
<div class="line"><span class="lineno"> 1068</span>  }</div>
<div class="ttc" id="aclassyield__plugin_1_1YieldPlugin_html_a0139ba3f27c4205d7820c5e8ed668042"><div class="ttname"><a href="classyield__plugin_1_1YieldPlugin.html#a0139ba3f27c4205d7820c5e8ed668042">yield_plugin::YieldPlugin::georeference_</a></div><div class="ttdeci">std::string georeference_</div><div class="ttdef"><b>Definition:</b> <a href="yield__plugin_8hpp_source.html#l00339">yield_plugin.hpp:339</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="yield__plugin_8hpp_source.html#l00339">georeference_</a>, and <a class="el" href="yield__plugin_8hpp_source.html#l00340">map_projector_</a>.</p>

</div>
</div>
<a id="a2def22504a4972db1994e96033e76ee9" name="a2def22504a4972db1994e96033e76ee9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2def22504a4972db1994e96033e76ee9">&#9670;&nbsp;</a></span>set_incoming_request_info()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void yield_plugin::YieldPlugin::set_incoming_request_info </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; lanelet::BasicPoint2d &gt;&#160;</td>
          <td class="paramname"><em>req_trajectory</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>req_speed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>req_planning_time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>req_timestamp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>set values for member variables related to cooperative behavior </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">req_trajectory</td><td>requested trajectory </td></tr>
    <tr><td class="paramname">req_speed</td><td>speed of requested cooperative behavior </td></tr>
    <tr><td class="paramname">req_planning_time</td><td>planning time for the requested cooperative behavior </td></tr>
    <tr><td class="paramname">req_timestamp</td><td>the mobility request time stamp </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="yield__plugin_8cpp_source.html#l00237">237</a> of file <a class="el" href="yield__plugin_8cpp_source.html">yield_plugin.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  238</span>  {</div>
<div class="line"><span class="lineno">  239</span>    <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#a2e806b6f64d4490b88f8947d8a360491">req_trajectory_points_</a> = req_trajectory;</div>
<div class="line"><span class="lineno">  240</span>    <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#ac1099523a4ea8b3ecc607cf466e42162">req_target_speed_</a> = req_speed;</div>
<div class="line"><span class="lineno">  241</span>    <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#ad620a98521987c31d004b5aabbf3a620">req_target_plan_time_</a> = req_planning_time;</div>
<div class="line"><span class="lineno">  242</span>    RCLCPP_DEBUG_STREAM(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(),<span class="stringliteral">&quot;req_target_plan_time_&quot;</span> &lt;&lt; <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#ad620a98521987c31d004b5aabbf3a620">req_target_plan_time_</a>);</div>
<div class="line"><span class="lineno">  243</span>    <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#a25b4eec8b5e4648044a4b46570cb4199">req_timestamp_</a> = req_timestamp;</div>
<div class="line"><span class="lineno">  244</span>  }</div>
<div class="ttc" id="aclassyield__plugin_1_1YieldPlugin_html_a25b4eec8b5e4648044a4b46570cb4199"><div class="ttname"><a href="classyield__plugin_1_1YieldPlugin.html#a25b4eec8b5e4648044a4b46570cb4199">yield_plugin::YieldPlugin::req_timestamp_</a></div><div class="ttdeci">double req_timestamp_</div><div class="ttdef"><b>Definition:</b> <a href="yield__plugin_8hpp_source.html#l00326">yield_plugin.hpp:326</a></div></div>
<div class="ttc" id="aclassyield__plugin_1_1YieldPlugin_html_a2e806b6f64d4490b88f8947d8a360491"><div class="ttname"><a href="classyield__plugin_1_1YieldPlugin.html#a2e806b6f64d4490b88f8947d8a360491">yield_plugin::YieldPlugin::req_trajectory_points_</a></div><div class="ttdeci">std::vector&lt; lanelet::BasicPoint2d &gt; req_trajectory_points_</div><div class="ttdef"><b>Definition:</b> <a href="yield__plugin_8hpp_source.html#l00324">yield_plugin.hpp:324</a></div></div>
<div class="ttc" id="aclassyield__plugin_1_1YieldPlugin_html_ac1099523a4ea8b3ecc607cf466e42162"><div class="ttname"><a href="classyield__plugin_1_1YieldPlugin.html#ac1099523a4ea8b3ecc607cf466e42162">yield_plugin::YieldPlugin::req_target_speed_</a></div><div class="ttdeci">double req_target_speed_</div><div class="ttdef"><b>Definition:</b> <a href="yield__plugin_8hpp_source.html#l00325">yield_plugin.hpp:325</a></div></div>
<div class="ttc" id="aclassyield__plugin_1_1YieldPlugin_html_ad620a98521987c31d004b5aabbf3a620"><div class="ttname"><a href="classyield__plugin_1_1YieldPlugin.html#ad620a98521987c31d004b5aabbf3a620">yield_plugin::YieldPlugin::req_target_plan_time_</a></div><div class="ttdeci">double req_target_plan_time_</div><div class="ttdef"><b>Definition:</b> <a href="yield__plugin_8hpp_source.html#l00327">yield_plugin.hpp:327</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="yield__plugin_8hpp_source.html#l00315">nh_</a>, <a class="el" href="yield__plugin_8hpp_source.html#l00327">req_target_plan_time_</a>, <a class="el" href="yield__plugin_8hpp_source.html#l00325">req_target_speed_</a>, <a class="el" href="yield__plugin_8hpp_source.html#l00326">req_timestamp_</a>, and <a class="el" href="yield__plugin_8hpp_source.html#l00324">req_trajectory_points_</a>.</p>

<p class="reference">Referenced by <a class="el" href="yield__plugin_8cpp_source.html#l00153">mobilityrequest_cb()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classyield__plugin_1_1YieldPlugin_a2def22504a4972db1994e96033e76ee9_icgraph.png" border="0" usemap="#aclassyield__plugin_1_1YieldPlugin_a2def22504a4972db1994e96033e76ee9_icgraph" alt=""/></div>
<map name="aclassyield__plugin_1_1YieldPlugin_a2def22504a4972db1994e96033e76ee9_icgraph" id="aclassyield__plugin_1_1YieldPlugin_a2def22504a4972db1994e96033e76ee9_icgraph">
<area shape="rect" title="set values for member variables related to cooperative behavior" alt="" coords="435,5,617,47"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#a3276c693a65319e769e63078284d3056" title="callback for mobility request" alt="" coords="227,5,387,47"/>
<area shape="rect" href="classyield__plugin_1_1YieldPluginNode.html#aee4bb2ca0d05cf41f55db567d7c74553" title="Method which is triggered when this plugin is moved from the UNCONFIGURED to INACTIVE states...." alt="" coords="5,5,179,47"/>
</map>
</div>

</div>
</div>
<a id="ad9c9e0e4278774a519de12a6a5f4398f" name="ad9c9e0e4278774a519de12a6a5f4398f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9c9e0e4278774a519de12a6a5f4398f">&#9670;&nbsp;</a></span>update_traj_for_cooperative_behavior()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">carma_planning_msgs::msg::TrajectoryPlan yield_plugin::YieldPlugin::update_traj_for_cooperative_behavior </td>
          <td>(</td>
          <td class="paramtype">const carma_planning_msgs::msg::TrajectoryPlan &amp;&#160;</td>
          <td class="paramname"><em>original_tp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>current_speed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>update trajectory for yielding to an incoming cooperative behavior </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">original_tp</td><td>original trajectory plan </td></tr>
    <tr><td class="paramname">current_speed</td><td>current speed of the vehicle </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>updated trajectory for cooperative behavior </dd></dl>

<p class="definition">Definition at line <a class="el" href="yield__plugin_8cpp_source.html#l00317">317</a> of file <a class="el" href="yield__plugin_8cpp_source.html">yield_plugin.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  318</span>  {</div>
<div class="line"><span class="lineno">  319</span>    carma_planning_msgs::msg::TrajectoryPlan cooperative_trajectory;</div>
<div class="line"><span class="lineno">  320</span> </div>
<div class="line"><span class="lineno">  321</span>    <span class="keywordtype">double</span> initial_pos = 0;</div>
<div class="line"><span class="lineno">  322</span>    <span class="keywordtype">double</span> goal_pos;</div>
<div class="line"><span class="lineno">  323</span>    <span class="keywordtype">double</span> initial_velocity = current_speed;</div>
<div class="line"><span class="lineno">  324</span>    <span class="keywordtype">double</span> goal_velocity = <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#ac1099523a4ea8b3ecc607cf466e42162">req_target_speed_</a>;</div>
<div class="line"><span class="lineno">  325</span>    <span class="keywordtype">double</span> planning_time = <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#ad620a98521987c31d004b5aabbf3a620">req_target_plan_time_</a>;</div>
<div class="line"><span class="lineno">  326</span> </div>
<div class="line"><span class="lineno">  327</span>    std::vector&lt;lanelet::BasicPoint2d&gt; host_traj_points = {};</div>
<div class="line"><span class="lineno">  328</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>=0; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>&lt;original_tp.trajectory_points.size(); <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>++)</div>
<div class="line"><span class="lineno">  329</span>    {</div>
<div class="line"><span class="lineno">  330</span>      lanelet::BasicPoint2d traj_point;</div>
<div class="line"><span class="lineno">  331</span>      traj_point.x() = original_tp.trajectory_points.at(<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>).x;</div>
<div class="line"><span class="lineno">  332</span>      traj_point.y() = original_tp.trajectory_points.at(<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>).y;</div>
<div class="line"><span class="lineno">  333</span>      host_traj_points.push_back(traj_point);</div>
<div class="line"><span class="lineno">  334</span>    }</div>
<div class="line"><span class="lineno">  335</span> </div>
<div class="line"><span class="lineno">  336</span>    std::vector&lt;std::pair&lt;int, lanelet::BasicPoint2d&gt;&gt; intersection_points = <a class="code hl_function" href="classyield__plugin_1_1YieldPlugin.html#abb40cf8a08a75c472791dbd91b99d8dc">detect_trajectories_intersection</a>(host_traj_points, <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#a2e806b6f64d4490b88f8947d8a360491">req_trajectory_points_</a>);</div>
<div class="line"><span class="lineno">  337</span>    <span class="keywordflow">if</span> (!intersection_points.empty())</div>
<div class="line"><span class="lineno">  338</span>    {</div>
<div class="line"><span class="lineno">  339</span>      lanelet::BasicPoint2d intersection_point = intersection_points[0].second;</div>
<div class="line"><span class="lineno">  340</span>      <span class="keywordtype">double</span> dx = original_tp.trajectory_points[0].x - intersection_point.x();</div>
<div class="line"><span class="lineno">  341</span>      <span class="keywordtype">double</span> dy = original_tp.trajectory_points[0].y - intersection_point.y();</div>
<div class="line"><span class="lineno">  342</span>      <span class="comment">// check if a digital_gap is available</span></div>
<div class="line"><span class="lineno">  343</span>      <span class="keywordtype">double</span> digital_gap = <a class="code hl_function" href="classyield__plugin_1_1YieldPlugin.html#a3703b49299aa6b61b3889a8e6799ac74">check_traj_for_digital_min_gap</a>(original_tp);</div>
<div class="line"><span class="lineno">  344</span>      RCLCPP_DEBUG_STREAM(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(),<span class="stringliteral">&quot;digital_gap: &quot;</span> &lt;&lt; digital_gap);</div>
<div class="line"><span class="lineno">  345</span>      goal_pos = sqrt(dx*dx + dy*dy) - <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#ab1f62a493a4229d4801841eb19fb1e7d">config_</a>.<a class="code hl_variable" href="structYieldPluginConfig.html#ada1059dd1218ecd9b513195b775aa633">minimum_safety_gap_in_meters</a>;</div>
<div class="line"><span class="lineno">  346</span>      RCLCPP_DEBUG_STREAM(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(),<span class="stringliteral">&quot;Goal position (goal_pos): &quot;</span> &lt;&lt; goal_pos);</div>
<div class="line"><span class="lineno">  347</span>      <span class="keywordtype">double</span> collision_time = <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#a25b4eec8b5e4648044a4b46570cb4199">req_timestamp_</a> + (intersection_points[0].first * <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#a7de1720c3d602feb197f52f6ce25fa73">ecef_traj_timestep_</a>) - <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#ab1f62a493a4229d4801841eb19fb1e7d">config_</a>.<a class="code hl_variable" href="structYieldPluginConfig.html#affc7ab1122ea90f3bd0b377f5ec4af49">safety_collision_time_gap_in_s</a>;</div>
<div class="line"><span class="lineno">  348</span>      RCLCPP_DEBUG_STREAM(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(),<span class="stringliteral">&quot;req time stamp: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#a25b4eec8b5e4648044a4b46570cb4199">req_timestamp_</a>);</div>
<div class="line"><span class="lineno">  349</span>      RCLCPP_DEBUG_STREAM(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(),<span class="stringliteral">&quot;Collision time: &quot;</span> &lt;&lt; collision_time);</div>
<div class="line"><span class="lineno">  350</span>      RCLCPP_DEBUG_STREAM(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(),<span class="stringliteral">&quot;intersection num: &quot;</span> &lt;&lt; intersection_points[0].first);</div>
<div class="line"><span class="lineno">  351</span>      RCLCPP_DEBUG_STREAM(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(),<span class="stringliteral">&quot;Planning time: &quot;</span> &lt;&lt; planning_time);</div>
<div class="line"><span class="lineno">  352</span>      <span class="comment">// calculate distance traveled from beginning of trajectory to collision point</span></div>
<div class="line"><span class="lineno">  353</span>      <span class="keywordtype">double</span> dx2 = intersection_point.x() - <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#a2e806b6f64d4490b88f8947d8a360491">req_trajectory_points_</a>[0].x();</div>
<div class="line"><span class="lineno">  354</span>      <span class="keywordtype">double</span> dy2 = intersection_point.y() - <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#a2e806b6f64d4490b88f8947d8a360491">req_trajectory_points_</a>[0].y();</div>
<div class="line"><span class="lineno">  355</span>      <span class="comment">// calculate incoming trajectory speed from time and distance between trajectory points</span></div>
<div class="line"><span class="lineno">  356</span>      <span class="keywordtype">double</span> incoming_trajectory_speed = sqrt(dx2*dx2 + dy2*dy2)/(intersection_points[0].first * <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#a7de1720c3d602feb197f52f6ce25fa73">ecef_traj_timestep_</a>);</div>
<div class="line"><span class="lineno">  357</span>      <span class="comment">// calculate goal velocity from request trajectory</span></div>
<div class="line"><span class="lineno">  358</span>      goal_velocity = std::min(goal_velocity, incoming_trajectory_speed);</div>
<div class="line"><span class="lineno">  359</span>      <span class="keywordtype">double</span> min_time = (initial_velocity - goal_velocity)/<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#ab1f62a493a4229d4801841eb19fb1e7d">config_</a>.<a class="code hl_variable" href="structYieldPluginConfig.html#a92f70f21fdd60cc19df76491b18c041e">yield_max_deceleration_in_ms2</a>;</div>
<div class="line"><span class="lineno">  360</span> </div>
<div class="line"><span class="lineno">  361</span>      RCLCPP_DEBUG_STREAM(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(),<span class="stringliteral">&quot;goal_velocity: &quot;</span> &lt;&lt; goal_velocity);</div>
<div class="line"><span class="lineno">  362</span>      RCLCPP_DEBUG_STREAM(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(),<span class="stringliteral">&quot;incoming_trajectory_speed: &quot;</span> &lt;&lt; incoming_trajectory_speed);</div>
<div class="line"><span class="lineno">  363</span> </div>
<div class="line"><span class="lineno">  364</span>      <span class="keywordflow">if</span> (planning_time &gt; min_time)</div>
<div class="line"><span class="lineno">  365</span>      {</div>
<div class="line"><span class="lineno">  366</span>        <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#ad694d6ea9d5ca884e29f33a48fe19ae3">cooperative_request_acceptable_</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  367</span>        <span class="keywordtype">double</span> original_max_speed = <a class="code hl_function" href="classyield__plugin_1_1YieldPlugin.html#ae53a42abb996d38cf701a3fba7e473f8">max_trajectory_speed</a>(original_tp.trajectory_points, <a class="code hl_function" href="namespaceyield__plugin.html#a82b2a694528d42a4af068732befca882">get_trajectory_end_time</a>(original_tp));</div>
<div class="line"><span class="lineno">  368</span>        cooperative_trajectory = <a class="code hl_function" href="classyield__plugin_1_1YieldPlugin.html#ace53f1895cbbf2a5f109cbfc11d6313f">generate_JMT_trajectory</a>(original_tp, initial_pos, goal_pos, initial_velocity, goal_velocity, planning_time, original_max_speed);</div>
<div class="line"><span class="lineno">  369</span>      }</div>
<div class="line"><span class="lineno">  370</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  371</span>      {</div>
<div class="line"><span class="lineno">  372</span>        <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#ad694d6ea9d5ca884e29f33a48fe19ae3">cooperative_request_acceptable_</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  373</span>        RCLCPP_DEBUG(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(),<span class="stringliteral">&quot;The incoming requested trajectory is rejected, due to insufficient gap&quot;</span>);</div>
<div class="line"><span class="lineno">  374</span>        cooperative_trajectory = original_tp;</div>
<div class="line"><span class="lineno">  375</span>      }</div>
<div class="line"><span class="lineno">  376</span> </div>
<div class="line"><span class="lineno">  377</span>    }</div>
<div class="line"><span class="lineno">  378</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  379</span>    {</div>
<div class="line"><span class="lineno">  380</span>      <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#ad694d6ea9d5ca884e29f33a48fe19ae3">cooperative_request_acceptable_</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  381</span>      RCLCPP_DEBUG(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(),<span class="stringliteral">&quot;The incoming requested trajectory does not overlap with host vehicle&#39;s trajectory&quot;</span>);</div>
<div class="line"><span class="lineno">  382</span>      cooperative_trajectory = original_tp;</div>
<div class="line"><span class="lineno">  383</span>    }</div>
<div class="line"><span class="lineno">  384</span> </div>
<div class="line"><span class="lineno">  385</span>    <span class="keywordflow">return</span> cooperative_trajectory;</div>
<div class="line"><span class="lineno">  386</span>  }</div>
<div class="ttc" id="aclassyield__plugin_1_1YieldPlugin_html_a3703b49299aa6b61b3889a8e6799ac74"><div class="ttname"><a href="classyield__plugin_1_1YieldPlugin.html#a3703b49299aa6b61b3889a8e6799ac74">yield_plugin::YieldPlugin::check_traj_for_digital_min_gap</a></div><div class="ttdeci">double check_traj_for_digital_min_gap(const carma_planning_msgs::msg::TrajectoryPlan &amp;original_tp) const</div><div class="ttdoc">checks trajectory for minimum gap associated with it</div><div class="ttdef"><b>Definition:</b> <a href="yield__plugin_8cpp_source.html#l01036">yield_plugin.cpp:1036</a></div></div>
<div class="ttc" id="aclassyield__plugin_1_1YieldPlugin_html_a7de1720c3d602feb197f52f6ce25fa73"><div class="ttname"><a href="classyield__plugin_1_1YieldPlugin.html#a7de1720c3d602feb197f52f6ce25fa73">yield_plugin::YieldPlugin::ecef_traj_timestep_</a></div><div class="ttdeci">double ecef_traj_timestep_</div><div class="ttdef"><b>Definition:</b> <a href="yield__plugin_8hpp_source.html#l00332">yield_plugin.hpp:332</a></div></div>
<div class="ttc" id="aclassyield__plugin_1_1YieldPlugin_html_abb40cf8a08a75c472791dbd91b99d8dc"><div class="ttname"><a href="classyield__plugin_1_1YieldPlugin.html#abb40cf8a08a75c472791dbd91b99d8dc">yield_plugin::YieldPlugin::detect_trajectories_intersection</a></div><div class="ttdeci">std::vector&lt; std::pair&lt; int, lanelet::BasicPoint2d &gt; &gt; detect_trajectories_intersection(std::vector&lt; lanelet::BasicPoint2d &gt; self_trajectory, std::vector&lt; lanelet::BasicPoint2d &gt; incoming_trajectory) const</div><div class="ttdoc">detect intersection point(s) of two trajectories</div><div class="ttdef"><b>Definition:</b> <a href="yield__plugin_8cpp_source.html#l00073">yield_plugin.cpp:73</a></div></div>
<div class="ttc" id="aclassyield__plugin_1_1YieldPlugin_html_ace53f1895cbbf2a5f109cbfc11d6313f"><div class="ttname"><a href="classyield__plugin_1_1YieldPlugin.html#ace53f1895cbbf2a5f109cbfc11d6313f">yield_plugin::YieldPlugin::generate_JMT_trajectory</a></div><div class="ttdeci">carma_planning_msgs::msg::TrajectoryPlan generate_JMT_trajectory(const carma_planning_msgs::msg::TrajectoryPlan &amp;original_tp, double initial_pos, double goal_pos, double initial_velocity, double goal_velocity, double planning_time, double original_max_speed)</div><div class="ttdoc">generate a Jerk Minimizing Trajectory(JMT) with the provided start and end conditions</div><div class="ttdef"><b>Definition:</b> <a href="yield__plugin_8cpp_source.html#l00402">yield_plugin.cpp:402</a></div></div>
<div class="ttc" id="astructYieldPluginConfig_html_a92f70f21fdd60cc19df76491b18c041e"><div class="ttname"><a href="structYieldPluginConfig.html#a92f70f21fdd60cc19df76491b18c041e">YieldPluginConfig::yield_max_deceleration_in_ms2</a></div><div class="ttdeci">double yield_max_deceleration_in_ms2</div><div class="ttdef"><b>Definition:</b> <a href="yield__config_8hpp_source.html#l00030">yield_config.hpp:30</a></div></div>
<div class="ttc" id="astructYieldPluginConfig_html_ada1059dd1218ecd9b513195b775aa633"><div class="ttname"><a href="structYieldPluginConfig.html#ada1059dd1218ecd9b513195b775aa633">YieldPluginConfig::minimum_safety_gap_in_meters</a></div><div class="ttdeci">double minimum_safety_gap_in_meters</div><div class="ttdef"><b>Definition:</b> <a href="yield__config_8hpp_source.html#l00031">yield_config.hpp:31</a></div></div>
<div class="ttc" id="astructYieldPluginConfig_html_affc7ab1122ea90f3bd0b377f5ec4af49"><div class="ttname"><a href="structYieldPluginConfig.html#affc7ab1122ea90f3bd0b377f5ec4af49">YieldPluginConfig::safety_collision_time_gap_in_s</a></div><div class="ttdeci">double safety_collision_time_gap_in_s</div><div class="ttdef"><b>Definition:</b> <a href="yield__config_8hpp_source.html#l00042">yield_config.hpp:42</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="yield__plugin_8cpp_source.html#l01036">check_traj_for_digital_min_gap()</a>, <a class="el" href="yield__plugin_8hpp_source.html#l00312">config_</a>, <a class="el" href="yield__plugin_8hpp_source.html#l00321">cooperative_request_acceptable_</a>, <a class="el" href="yield__plugin_8cpp_source.html#l00073">detect_trajectories_intersection()</a>, <a class="el" href="yield__plugin_8hpp_source.html#l00332">ecef_traj_timestep_</a>, <a class="el" href="yield__plugin_8cpp_source.html#l00402">generate_JMT_trajectory()</a>, <a class="el" href="yield__plugin_8cpp_source.html#l00053">yield_plugin::get_trajectory_end_time()</a>, <a class="el" href="process__bag_8py_source.html#l00059">process_bag::i</a>, <a class="el" href="yield__plugin_8cpp_source.html#l01013">max_trajectory_speed()</a>, <a class="el" href="yield__config_8hpp_source.html#l00031">YieldPluginConfig::minimum_safety_gap_in_meters</a>, <a class="el" href="yield__plugin_8hpp_source.html#l00315">nh_</a>, <a class="el" href="yield__plugin_8hpp_source.html#l00327">req_target_plan_time_</a>, <a class="el" href="yield__plugin_8hpp_source.html#l00325">req_target_speed_</a>, <a class="el" href="yield__plugin_8hpp_source.html#l00326">req_timestamp_</a>, <a class="el" href="yield__plugin_8hpp_source.html#l00324">req_trajectory_points_</a>, <a class="el" href="yield__config_8hpp_source.html#l00042">YieldPluginConfig::safety_collision_time_gap_in_s</a>, and <a class="el" href="yield__config_8hpp_source.html#l00030">YieldPluginConfig::yield_max_deceleration_in_ms2</a>.</p>

<p class="reference">Referenced by <a class="el" href="yield__plugin_8cpp_source.html#l00252">plan_trajectory_callback()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classyield__plugin_1_1YieldPlugin_ad9c9e0e4278774a519de12a6a5f4398f_cgraph.png" border="0" usemap="#aclassyield__plugin_1_1YieldPlugin_ad9c9e0e4278774a519de12a6a5f4398f_cgraph" alt=""/></div>
<map name="aclassyield__plugin_1_1YieldPlugin_ad9c9e0e4278774a519de12a6a5f4398f_cgraph" id="aclassyield__plugin_1_1YieldPlugin_ad9c9e0e4278774a519de12a6a5f4398f_cgraph">
<area shape="rect" title="update trajectory for yielding to an incoming cooperative behavior" alt="" coords="5,162,193,218"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#a3703b49299aa6b61b3889a8e6799ac74" title="checks trajectory for minimum gap associated with it" alt="" coords="266,25,426,81"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#abb40cf8a08a75c472791dbd91b99d8dc" title="detect intersection point(s) of two trajectories" alt="" coords="241,104,451,145"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#ace53f1895cbbf2a5f109cbfc11d6313f" title="generate a Jerk Minimizing Trajectory(JMT) with the provided start and end conditions" alt="" coords="261,169,431,211"/>
<area shape="rect" href="namespaceyield__plugin.html#a82b2a694528d42a4af068732befca882" title=" " alt="" coords="259,235,433,276"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#ae53a42abb996d38cf701a3fba7e473f8" title="calculates the maximum speed in a set of tajectory points" alt="" coords="266,300,426,341"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#a1bc011c9c2db48289bf40214d972cec4" title="calculates distance between trajectory points in a plan" alt="" coords="513,5,683,47"/>
<area shape="rect" href="namespaceyield__plugin.html#a6685355374aa80334c267d788788cb2f" title=" " alt="" coords="513,71,683,112"/>
<area shape="rect" href="namespacebasic__autonomy_1_1smoothing.html#afb726e75a21ada8efa3ca5561ffc9984" title="Extremely simplie moving average filter." alt="" coords="507,136,689,177"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#ae7ffd46ccbae6de4b60a7f49a8cfa3d6" title="calculate quintic polynomial equation for a given x" alt="" coords="518,201,678,243"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#afeab08ed138eafe6e24abd775c3163dd" title="calculate derivative of quintic polynomial equation for a given x" alt="" coords="518,267,678,308"/>
<area shape="rect" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5" title=" " alt="" coords="499,356,697,397"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classyield__plugin_1_1YieldPlugin_ad9c9e0e4278774a519de12a6a5f4398f_icgraph.png" border="0" usemap="#aclassyield__plugin_1_1YieldPlugin_ad9c9e0e4278774a519de12a6a5f4398f_icgraph" alt=""/></div>
<map name="aclassyield__plugin_1_1YieldPlugin_ad9c9e0e4278774a519de12a6a5f4398f_icgraph" id="aclassyield__plugin_1_1YieldPlugin_ad9c9e0e4278774a519de12a6a5f4398f_icgraph">
<area shape="rect" title="update trajectory for yielding to an incoming cooperative behavior" alt="" coords="220,5,408,61"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#a0fd790e287683a2ef404e16a15e0ea29" title="Service callback for trajectory planning." alt="" coords="5,13,172,54"/>
</map>
</div>

</div>
</div>
<a id="ac1c423b99887ccbf945a86da7b7809f6" name="ac1c423b99887ccbf945a86da7b7809f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1c423b99887ccbf945a86da7b7809f6">&#9670;&nbsp;</a></span>update_traj_for_object()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">carma_planning_msgs::msg::TrajectoryPlan yield_plugin::YieldPlugin::update_traj_for_object </td>
          <td>(</td>
          <td class="paramtype">const carma_planning_msgs::msg::TrajectoryPlan &amp;&#160;</td>
          <td class="paramname"><em>original_tp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; carma_perception_msgs::msg::ExternalObject &gt; &amp;&#160;</td>
          <td class="paramname"><em>external_objects</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>initial_velocity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>trajectory is modified to safely avoid obstacles on the road </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">original_tp</td><td>original trajectory plan without object avoidance </td></tr>
    <tr><td class="paramname">current_speed_</td><td>current speed of the vehicle </td></tr>
    <tr><td class="paramname"></td><td></td></tr>
  </table>
  </dd>
</dl>
<p>return modified trajectory plan </p>

<p class="definition">Definition at line <a class="el" href="yield__plugin_8cpp_source.html#l00888">888</a> of file <a class="el" href="yield__plugin_8cpp_source.html">yield_plugin.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  890</span>  {</div>
<div class="line"><span class="lineno">  891</span>    <span class="keywordflow">if</span> (original_tp.trajectory_points.size() &lt; 2)</div>
<div class="line"><span class="lineno">  892</span>    {</div>
<div class="line"><span class="lineno">  893</span>      RCLCPP_WARN(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(), <span class="stringliteral">&quot;Yield plugin received less than 2 points in update_traj_for_object, returning unchanged...&quot;</span>);</div>
<div class="line"><span class="lineno">  894</span>      <span class="keywordflow">return</span> original_tp;</div>
<div class="line"><span class="lineno">  895</span>    }</div>
<div class="line"><span class="lineno">  896</span> </div>
<div class="line"><span class="lineno">  897</span>    <span class="comment">// Get earliest collision object</span></div>
<div class="line"><span class="lineno">  898</span>    <span class="keyword">const</span> <span class="keyword">auto</span> earliest_collision_obj_pair = <a class="code hl_function" href="classyield__plugin_1_1YieldPlugin.html#a546149400d9d6371c5de50f229d6ecfc">get_earliest_collision_object_and_time</a>(original_tp, external_objects);</div>
<div class="line"><span class="lineno">  899</span> </div>
<div class="line"><span class="lineno">  900</span>    <span class="keywordflow">if</span> (!earliest_collision_obj_pair)</div>
<div class="line"><span class="lineno">  901</span>    {</div>
<div class="line"><span class="lineno">  902</span>      RCLCPP_DEBUG(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(),<span class="stringliteral">&quot;No collision detected, so trajectory not modified.&quot;</span>);</div>
<div class="line"><span class="lineno">  903</span>      <span class="keywordflow">return</span> original_tp;</div>
<div class="line"><span class="lineno">  904</span>    }</div>
<div class="line"><span class="lineno">  905</span> </div>
<div class="line"><span class="lineno">  906</span>    carma_perception_msgs::msg::ExternalObject earliest_collision_obj = earliest_collision_obj_pair.value().first;</div>
<div class="line"><span class="lineno">  907</span>    <span class="keywordtype">double</span> earliest_collision_time_in_seconds = earliest_collision_obj_pair.value().second;</div>
<div class="line"><span class="lineno">  908</span> </div>
<div class="line"><span class="lineno">  909</span>    <span class="comment">// Issue (https://github.com/usdot-fhwa-stol/carma-platform/issues/2155): If the yield_plugin can detect if the roadway object is moving along the route,</span></div>
<div class="line"><span class="lineno">  910</span>    <span class="comment">// it is able to plan yielding much earlier and smoother using on_route_vehicle_collision_horizon_in_s.</span></div>
<div class="line"><span class="lineno">  911</span> </div>
<div class="line"><span class="lineno">  912</span>    <span class="keyword">const</span> lanelet::BasicPoint2d vehicle_point(original_tp.trajectory_points[0].x,original_tp.trajectory_points[0].y);</div>
<div class="line"><span class="lineno">  913</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> vehicle_downtrack = <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aff229ed7bba2a76d0b1b99a83b9fdf88">wm_</a>-&gt;routeTrackPos(vehicle_point).downtrack;</div>
<div class="line"><span class="lineno">  914</span> </div>
<div class="line"><span class="lineno">  915</span>    RCLCPP_DEBUG_STREAM(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(),<span class="stringliteral">&quot;vehicle_downtrack: &quot;</span> &lt;&lt; vehicle_downtrack);</div>
<div class="line"><span class="lineno">  916</span> </div>
<div class="line"><span class="lineno">  917</span>    RCLCPP_WARN_STREAM(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(),<span class="stringliteral">&quot;Collision Detected!&quot;</span>);</div>
<div class="line"><span class="lineno">  918</span> </div>
<div class="line"><span class="lineno">  919</span>    <span class="keyword">const</span> lanelet::BasicPoint2d object_point(earliest_collision_obj.pose.pose.position.x, earliest_collision_obj.pose.pose.position.y);</div>
<div class="line"><span class="lineno">  920</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> object_downtrack = <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aff229ed7bba2a76d0b1b99a83b9fdf88">wm_</a>-&gt;routeTrackPos(object_point).downtrack;</div>
<div class="line"><span class="lineno">  921</span> </div>
<div class="line"><span class="lineno">  922</span>    RCLCPP_DEBUG_STREAM(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(),<span class="stringliteral">&quot;object_downtrack: &quot;</span> &lt;&lt; object_downtrack);</div>
<div class="line"><span class="lineno">  923</span> </div>
<div class="line"><span class="lineno">  924</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> object_downtrack_lead = std::max(0.0, object_downtrack - vehicle_downtrack);</div>
<div class="line"><span class="lineno">  925</span>    RCLCPP_DEBUG_STREAM(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(),<span class="stringliteral">&quot;object_downtrack_lead: &quot;</span> &lt;&lt; object_downtrack_lead);</div>
<div class="line"><span class="lineno">  926</span> </div>
<div class="line"><span class="lineno">  927</span>    <span class="comment">// The vehicle&#39;s goal velocity of the yielding behavior is to match the velocity of the object along the trajectory.</span></div>
<div class="line"><span class="lineno">  928</span>    <span class="keywordtype">double</span> goal_velocity = <a class="code hl_function" href="classyield__plugin_1_1YieldPlugin.html#a378558cb2b27d8337d980150543d447d">get_predicted_velocity_at_time</a>(earliest_collision_obj.velocity.twist, original_tp, earliest_collision_time_in_seconds);</div>
<div class="line"><span class="lineno">  929</span>    RCLCPP_DEBUG_STREAM(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(),<span class="stringliteral">&quot;object&#39;s speed along trajectory at collision: &quot;</span> &lt;&lt; goal_velocity);</div>
<div class="line"><span class="lineno">  930</span> </div>
<div class="line"><span class="lineno">  931</span>    <span class="comment">// roadway object position</span></div>
<div class="line"><span class="lineno">  932</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> gap_time_until_min_gap_distance = std::max(0.0, object_downtrack_lead - <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#ab1f62a493a4229d4801841eb19fb1e7d">config_</a>.<a class="code hl_variable" href="structYieldPluginConfig.html#ada1059dd1218ecd9b513195b775aa633">minimum_safety_gap_in_meters</a>)/initial_velocity;</div>
<div class="line"><span class="lineno">  933</span> </div>
<div class="line"><span class="lineno">  934</span>    <span class="keywordflow">if</span> (goal_velocity &lt;= <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#ab1f62a493a4229d4801841eb19fb1e7d">config_</a>.<a class="code hl_variable" href="structYieldPluginConfig.html#abe6d1c18b2a7f34566828c71eb4573ef">obstacle_zero_speed_threshold_in_ms</a>){</div>
<div class="line"><span class="lineno">  935</span>      RCLCPP_WARN_STREAM(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(),<span class="stringliteral">&quot;The obstacle is not moving, goal velocity is set to 0 from: &quot;</span> &lt;&lt; goal_velocity);</div>
<div class="line"><span class="lineno">  936</span>      goal_velocity = 0.0;</div>
<div class="line"><span class="lineno">  937</span>    }</div>
<div class="line"><span class="lineno">  938</span> </div>
<div class="line"><span class="lineno">  939</span>    <span class="comment">// determine the safety inter-vehicle gap based on speed</span></div>
<div class="line"><span class="lineno">  940</span>    <span class="keywordtype">double</span> safety_gap = std::max(goal_velocity * gap_time_until_min_gap_distance, <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#ab1f62a493a4229d4801841eb19fb1e7d">config_</a>.<a class="code hl_variable" href="structYieldPluginConfig.html#ada1059dd1218ecd9b513195b775aa633">minimum_safety_gap_in_meters</a>);</div>
<div class="line"><span class="lineno">  941</span>    <span class="keywordflow">if</span> (!std::isnormal(safety_gap))</div>
<div class="line"><span class="lineno">  942</span>    {</div>
<div class="line"><span class="lineno">  943</span>      RCLCPP_WARN_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;yield_plugin&quot;</span>),<span class="stringliteral">&quot;Detected non-normal (nan, inf, etc.) safety_gap.&quot;</span></div>
<div class="line"><span class="lineno">  944</span>        <span class="stringliteral">&quot;Making it desired safety gap configured at config_.minimum_safety_gap_in_meters: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#ab1f62a493a4229d4801841eb19fb1e7d">config_</a>.<a class="code hl_variable" href="structYieldPluginConfig.html#ada1059dd1218ecd9b513195b775aa633">minimum_safety_gap_in_meters</a>);</div>
<div class="line"><span class="lineno">  945</span>      safety_gap = <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#ab1f62a493a4229d4801841eb19fb1e7d">config_</a>.<a class="code hl_variable" href="structYieldPluginConfig.html#ada1059dd1218ecd9b513195b775aa633">minimum_safety_gap_in_meters</a>;</div>
<div class="line"><span class="lineno">  946</span>    }</div>
<div class="line"><span class="lineno">  947</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#ab1f62a493a4229d4801841eb19fb1e7d">config_</a>.<a class="code hl_variable" href="structYieldPluginConfig.html#a31b1781ef97ad5d956fe8c51cc161d69">enable_adjustable_gap</a>)</div>
<div class="line"><span class="lineno">  948</span>    {</div>
<div class="line"><span class="lineno">  949</span>      <span class="comment">// externally_commanded_safety_gap is desired distance gap commanded from external sources</span></div>
<div class="line"><span class="lineno">  950</span>      <span class="comment">// such as different plugin, map, or infrastructure depending on the use case</span></div>
<div class="line"><span class="lineno">  951</span>      <span class="keywordtype">double</span> externally_commanded_safety_gap = <a class="code hl_function" href="classyield__plugin_1_1YieldPlugin.html#a3703b49299aa6b61b3889a8e6799ac74">check_traj_for_digital_min_gap</a>(original_tp);</div>
<div class="line"><span class="lineno">  952</span>      RCLCPP_DEBUG_STREAM(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(),<span class="stringliteral">&quot;externally_commanded_safety_gap: &quot;</span> &lt;&lt; externally_commanded_safety_gap);</div>
<div class="line"><span class="lineno">  953</span>      <span class="comment">// if a digital gap is available, it is replaced as safety gap</span></div>
<div class="line"><span class="lineno">  954</span>      safety_gap = std::max(safety_gap, externally_commanded_safety_gap);</div>
<div class="line"><span class="lineno">  955</span>    }</div>
<div class="line"><span class="lineno">  956</span> </div>
<div class="line"><span class="lineno">  957</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> goal_pos = std::max(0.0, object_downtrack_lead - safety_gap - <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#ab1f62a493a4229d4801841eb19fb1e7d">config_</a>.<a class="code hl_variable" href="structYieldPluginConfig.html#a7b0405c10307bac9613aba5a228de94e">vehicle_length</a>);</div>
<div class="line"><span class="lineno">  958</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> initial_pos = 0.0; <span class="comment">//relative initial position (first trajectory point)</span></div>
<div class="line"><span class="lineno">  959</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> original_max_speed = <a class="code hl_function" href="classyield__plugin_1_1YieldPlugin.html#ae53a42abb996d38cf701a3fba7e473f8">max_trajectory_speed</a>(original_tp.trajectory_points, earliest_collision_time_in_seconds);</div>
<div class="line"><span class="lineno">  960</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> delta_v_max = fabs(goal_velocity - original_max_speed);</div>
<div class="line"><span class="lineno">  961</span>    RCLCPP_DEBUG_STREAM(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(),<span class="stringliteral">&quot;delta_v_max: &quot;</span> &lt;&lt; delta_v_max &lt;&lt; <span class="stringliteral">&quot;, safety_gap: &quot;</span> &lt;&lt; safety_gap);</div>
<div class="line"><span class="lineno">  962</span> </div>
<div class="line"><span class="lineno">  963</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> time_required_for_comfortable_decel_in_s = <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#ab1f62a493a4229d4801841eb19fb1e7d">config_</a>.<a class="code hl_variable" href="structYieldPluginConfig.html#a7d48460ee46f906c2e6b33dc46238f12">acceleration_adjustment_factor</a> * 2 * goal_pos / delta_v_max;</div>
<div class="line"><span class="lineno">  964</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> min_time_required_for_comfortable_decel_in_s = delta_v_max / <a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#ab1f62a493a4229d4801841eb19fb1e7d">config_</a>.<a class="code hl_variable" href="structYieldPluginConfig.html#a92f70f21fdd60cc19df76491b18c041e">yield_max_deceleration_in_ms2</a>;</div>
<div class="line"><span class="lineno">  965</span> </div>
<div class="line"><span class="lineno">  966</span>    <span class="comment">// planning time for object avoidance</span></div>
<div class="line"><span class="lineno">  967</span>    <span class="keywordtype">double</span> planning_time_in_s = std::max({<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#ab1f62a493a4229d4801841eb19fb1e7d">config_</a>.<a class="code hl_variable" href="structYieldPluginConfig.html#accd4e108184fe5a470d4f8af1de1e7a2">min_obj_avoidance_plan_time_in_s</a>, time_required_for_comfortable_decel_in_s, min_time_required_for_comfortable_decel_in_s});</div>
<div class="line"><span class="lineno">  968</span>    RCLCPP_DEBUG_STREAM(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(),<span class="stringliteral">&quot;time_required_for_comfortable_decel_in_s: &quot;</span> &lt;&lt; time_required_for_comfortable_decel_in_s &lt;&lt; <span class="stringliteral">&quot;, min_time_required_for_comfortable_decel_in_s: &quot;</span> &lt;&lt; min_time_required_for_comfortable_decel_in_s);</div>
<div class="line"><span class="lineno">  969</span> </div>
<div class="line"><span class="lineno">  970</span>    RCLCPP_DEBUG_STREAM(<a class="code hl_variable" href="classyield__plugin_1_1YieldPlugin.html#aa2f96dc545c04733e8ba11a6f3a0c2c6">nh_</a>-&gt;get_logger(),<span class="stringliteral">&quot;Object avoidance planning time: &quot;</span> &lt;&lt; planning_time_in_s);</div>
<div class="line"><span class="lineno">  971</span> </div>
<div class="line"><span class="lineno">  972</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="classyield__plugin_1_1YieldPlugin.html#ace53f1895cbbf2a5f109cbfc11d6313f">generate_JMT_trajectory</a>(original_tp, initial_pos, goal_pos, initial_velocity, goal_velocity, planning_time_in_s, original_max_speed);</div>
<div class="line"><span class="lineno">  973</span>  }</div>
<div class="ttc" id="aclassyield__plugin_1_1YieldPlugin_html_a378558cb2b27d8337d980150543d447d"><div class="ttname"><a href="classyield__plugin_1_1YieldPlugin.html#a378558cb2b27d8337d980150543d447d">yield_plugin::YieldPlugin::get_predicted_velocity_at_time</a></div><div class="ttdeci">double get_predicted_velocity_at_time(const geometry_msgs::msg::Twist &amp;object_velocity_in_map_frame, const carma_planning_msgs::msg::TrajectoryPlan &amp;original_tp, double timestamp_in_sec_to_predict)</div><div class="ttdoc">Given the object velocity in map frame with x,y components, this function returns the projected veloc...</div><div class="ttdef"><b>Definition:</b> <a href="yield__plugin_8cpp_source.html#l00845">yield_plugin.cpp:845</a></div></div>
<div class="ttc" id="aclassyield__plugin_1_1YieldPlugin_html_a546149400d9d6371c5de50f229d6ecfc"><div class="ttname"><a href="classyield__plugin_1_1YieldPlugin.html#a546149400d9d6371c5de50f229d6ecfc">yield_plugin::YieldPlugin::get_earliest_collision_object_and_time</a></div><div class="ttdeci">std::optional&lt; std::pair&lt; carma_perception_msgs::msg::ExternalObject, double &gt; &gt; get_earliest_collision_object_and_time(const carma_planning_msgs::msg::TrajectoryPlan &amp;original_tp, const std::vector&lt; carma_perception_msgs::msg::ExternalObject &gt; &amp;external_objects)</div><div class="ttdoc">Return the earliest collision object and time of collision pair from the given trajectory and list of...</div><div class="ttdef"><b>Definition:</b> <a href="yield__plugin_8cpp_source.html#l00807">yield_plugin.cpp:807</a></div></div>
<div class="ttc" id="astructYieldPluginConfig_html_a31b1781ef97ad5d956fe8c51cc161d69"><div class="ttname"><a href="structYieldPluginConfig.html#a31b1781ef97ad5d956fe8c51cc161d69">YieldPluginConfig::enable_adjustable_gap</a></div><div class="ttdeci">bool enable_adjustable_gap</div><div class="ttdef"><b>Definition:</b> <a href="yield__config_8hpp_source.html#l00043">yield_config.hpp:43</a></div></div>
<div class="ttc" id="astructYieldPluginConfig_html_a7d48460ee46f906c2e6b33dc46238f12"><div class="ttname"><a href="structYieldPluginConfig.html#a7d48460ee46f906c2e6b33dc46238f12">YieldPluginConfig::acceleration_adjustment_factor</a></div><div class="ttdeci">double acceleration_adjustment_factor</div><div class="ttdef"><b>Definition:</b> <a href="yield__config_8hpp_source.html#l00026">yield_config.hpp:26</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="yield__config_8hpp_source.html#l00026">YieldPluginConfig::acceleration_adjustment_factor</a>, <a class="el" href="yield__plugin_8cpp_source.html#l01036">check_traj_for_digital_min_gap()</a>, <a class="el" href="yield__plugin_8hpp_source.html#l00312">config_</a>, <a class="el" href="yield__config_8hpp_source.html#l00043">YieldPluginConfig::enable_adjustable_gap</a>, <a class="el" href="yield__plugin_8cpp_source.html#l00402">generate_JMT_trajectory()</a>, <a class="el" href="yield__plugin_8cpp_source.html#l00807">get_earliest_collision_object_and_time()</a>, <a class="el" href="yield__plugin_8cpp_source.html#l00845">get_predicted_velocity_at_time()</a>, <a class="el" href="yield__plugin_8cpp_source.html#l01013">max_trajectory_speed()</a>, <a class="el" href="yield__config_8hpp_source.html#l00029">YieldPluginConfig::min_obj_avoidance_plan_time_in_s</a>, <a class="el" href="yield__config_8hpp_source.html#l00031">YieldPluginConfig::minimum_safety_gap_in_meters</a>, <a class="el" href="yield__plugin_8hpp_source.html#l00315">nh_</a>, <a class="el" href="yield__config_8hpp_source.html#l00028">YieldPluginConfig::obstacle_zero_speed_threshold_in_ms</a>, <a class="el" href="yield__config_8hpp_source.html#l00032">YieldPluginConfig::vehicle_length</a>, <a class="el" href="yield__plugin_8hpp_source.html#l00311">wm_</a>, and <a class="el" href="yield__config_8hpp_source.html#l00030">YieldPluginConfig::yield_max_deceleration_in_ms2</a>.</p>

<p class="reference">Referenced by <a class="el" href="yield__plugin_8cpp_source.html#l00252">plan_trajectory_callback()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classyield__plugin_1_1YieldPlugin_ac1c423b99887ccbf945a86da7b7809f6_cgraph.png" border="0" usemap="#aclassyield__plugin_1_1YieldPlugin_ac1c423b99887ccbf945a86da7b7809f6_cgraph" alt=""/></div>
<map name="aclassyield__plugin_1_1YieldPlugin_ac1c423b99887ccbf945a86da7b7809f6_cgraph" id="aclassyield__plugin_1_1YieldPlugin_ac1c423b99887ccbf945a86da7b7809f6_cgraph">
<area shape="rect" title="trajectory is modified to safely avoid obstacles on the road" alt="" coords="5,391,165,432"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#a3703b49299aa6b61b3889a8e6799ac74" title="checks trajectory for minimum gap associated with it" alt="" coords="219,155,379,211"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#ace53f1895cbbf2a5f109cbfc11d6313f" title="generate a Jerk Minimizing Trajectory(JMT) with the provided start and end conditions" alt="" coords="213,235,384,276"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#a546149400d9d6371c5de50f229d6ecfc" title="Return the earliest collision object and time of collision pair from the given trajectory and list of..." alt="" coords="219,463,379,519"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#ae53a42abb996d38cf701a3fba7e473f8" title="calculates the maximum speed in a set of tajectory points" alt="" coords="460,580,620,621"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#a378558cb2b27d8337d980150543d447d" title="Given the object velocity in map frame with x,y components, this function returns the projected veloc..." alt="" coords="911,383,1071,439"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#a1bc011c9c2db48289bf40214d972cec4" title="calculates distance between trajectory points in a plan" alt="" coords="455,267,625,308"/>
<area shape="rect" href="namespaceyield__plugin.html#a6685355374aa80334c267d788788cb2f" title=" " alt="" coords="455,5,625,47"/>
<area shape="rect" href="namespacebasic__autonomy_1_1smoothing.html#afb726e75a21ada8efa3ca5561ffc9984" title="Extremely simplie moving average filter." alt="" coords="449,71,631,112"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#ae7ffd46ccbae6de4b60a7f49a8cfa3d6" title="calculate quintic polynomial equation for a given x" alt="" coords="460,136,620,177"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#afeab08ed138eafe6e24abd775c3163dd" title="calculate derivative of quintic polynomial equation for a given x" alt="" coords="460,201,620,243"/>
<area shape="rect" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5" title=" " alt="" coords="1125,539,1324,580"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#aae4fab3792eaa78de9a88299c209246d" title="Given the list of objects with predicted states, get all collision times concurrently using multi&#45;thr..." alt="" coords="432,515,648,556"/>
<area shape="rect" href="namespaceyield__plugin.html#a82b2a694528d42a4af068732befca882" title=" " alt="" coords="1372,456,1545,497"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#a5644e9f63528efc0484b875c7debef01" title="Return collision time given two trajectories with one being external object with predicted steps." alt="" coords="696,573,856,615"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#ab60b2f939cebede3a6d9a3ae5529b0d9" title="Return naive collision time and locations based on collision radius given two trajectories with one b..." alt="" coords="911,632,1071,673"/>
<area shape="rect" href="namespaceyield__plugin.html#a754c9aebad547b09cdeff7080a639bd3" title=" " alt="" coords="1372,661,1545,703"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#ae1279ff6d53eb474b635f992ed854d0b" title="Check if object location is behind the vehicle using estimates of the vehicle&#39;s length and route down..." alt="" coords="904,515,1077,556"/>
<area shape="rect" href="namespaceyield__plugin.html#ad78fa1e6a7a22eff6b76dd32700fc55f" title=" " alt="" coords="1138,632,1311,673"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classyield__plugin_1_1YieldPlugin_ac1c423b99887ccbf945a86da7b7809f6_icgraph.png" border="0" usemap="#aclassyield__plugin_1_1YieldPlugin_ac1c423b99887ccbf945a86da7b7809f6_icgraph" alt=""/></div>
<map name="aclassyield__plugin_1_1YieldPlugin_ac1c423b99887ccbf945a86da7b7809f6_icgraph" id="aclassyield__plugin_1_1YieldPlugin_ac1c423b99887ccbf945a86da7b7809f6_icgraph">
<area shape="rect" title="trajectory is modified to safely avoid obstacles on the road" alt="" coords="220,5,380,47"/>
<area shape="rect" href="classyield__plugin_1_1YieldPlugin.html#a0fd790e287683a2ef404e16a15e0ea29" title="Service callback for trajectory planning." alt="" coords="5,5,172,47"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="ae79ca3ae3dcfb369611d20ffa4ef7660" name="ae79ca3ae3dcfb369611d20ffa4ef7660"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae79ca3ae3dcfb369611d20ffa4ef7660">&#9670;&nbsp;</a></span>clc_urgency_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classint.html">int</a> yield_plugin::YieldPlugin::clc_urgency_ = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="yield__plugin_8hpp_source.html#l00329">329</a> of file <a class="el" href="yield__plugin_8hpp_source.html">yield_plugin.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="yield__plugin_8cpp_source.html#l00153">mobilityrequest_cb()</a>, and <a class="el" href="yield__plugin_8cpp_source.html#l00252">plan_trajectory_callback()</a>.</p>

</div>
</div>
<a id="ab1f62a493a4229d4801841eb19fb1e7d" name="ab1f62a493a4229d4801841eb19fb1e7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1f62a493a4229d4801841eb19fb1e7d">&#9670;&nbsp;</a></span>config_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structYieldPluginConfig.html">YieldPluginConfig</a> yield_plugin::YieldPlugin::config_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="yield__plugin_8hpp_source.html#l00312">312</a> of file <a class="el" href="yield__plugin_8hpp_source.html">yield_plugin.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="yield__plugin_8cpp_source.html#l00133">compose_mobility_response()</a>, <a class="el" href="yield__plugin_8cpp_source.html#l00073">detect_trajectories_intersection()</a>, <a class="el" href="yield__plugin_8cpp_source.html#l00402">generate_JMT_trajectory()</a>, <a class="el" href="yield__plugin_8cpp_source.html#l00550">get_collision()</a>, <a class="el" href="yield__plugin_8cpp_source.html#l00723">get_collision_time()</a>, <a class="el" href="yield__plugin_8cpp_source.html#l00697">is_object_behind_vehicle()</a>, <a class="el" href="yield__plugin_8cpp_source.html#l00153">mobilityrequest_cb()</a>, <a class="el" href="yield__plugin_8cpp_source.html#l00252">plan_trajectory_callback()</a>, <a class="el" href="yield__plugin_8cpp_source.html#l00317">update_traj_for_cooperative_behavior()</a>, and <a class="el" href="yield__plugin_8cpp_source.html#l00888">update_traj_for_object()</a>.</p>

</div>
</div>
<a id="adc6d5d9e4116d9f6ca142e5bb2fd1bc8" name="adc6d5d9e4116d9f6ca142e5bb2fd1bc8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc6d5d9e4116d9f6ca142e5bb2fd1bc8">&#9670;&nbsp;</a></span>consecutive_clearance_count_for_obstacles_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unordered_map&lt;<a class="el" href="stdint_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>, <a class="el" href="classint.html">int</a>&gt; yield_plugin::YieldPlugin::consecutive_clearance_count_for_obstacles_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="yield__plugin_8hpp_source.html#l00319">319</a> of file <a class="el" href="yield__plugin_8hpp_source.html">yield_plugin.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="yield__plugin_8cpp_source.html#l00723">get_collision_time()</a>, and <a class="el" href="yield__plugin_8cpp_source.html#l00697">is_object_behind_vehicle()</a>.</p>

</div>
</div>
<a id="ad694d6ea9d5ca884e29f33a48fe19ae3" name="ad694d6ea9d5ca884e29f33a48fe19ae3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad694d6ea9d5ca884e29f33a48fe19ae3">&#9670;&nbsp;</a></span>cooperative_request_acceptable_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> yield_plugin::YieldPlugin::cooperative_request_acceptable_ = false</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="yield__plugin_8hpp_source.html#l00321">321</a> of file <a class="el" href="yield__plugin_8hpp_source.html">yield_plugin.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="yield__plugin_8cpp_source.html#l00153">mobilityrequest_cb()</a>, and <a class="el" href="yield__plugin_8cpp_source.html#l00317">update_traj_for_cooperative_behavior()</a>.</p>

</div>
</div>
<a id="a6ab4d1bc8ff90e4df4b086fb7b75eb02" name="a6ab4d1bc8ff90e4df4b086fb7b75eb02"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ab4d1bc8ff90e4df4b086fb7b75eb02">&#9670;&nbsp;</a></span>current_speed_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double yield_plugin::YieldPlugin::current_speed_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="yield__plugin_8hpp_source.html#l00335">335</a> of file <a class="el" href="yield__plugin_8hpp_source.html">yield_plugin.hpp</a>.</p>

</div>
</div>
<a id="a7de1720c3d602feb197f52f6ce25fa73" name="a7de1720c3d602feb197f52f6ce25fa73"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7de1720c3d602feb197f52f6ce25fa73">&#9670;&nbsp;</a></span>ecef_traj_timestep_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double yield_plugin::YieldPlugin::ecef_traj_timestep_ = 0.1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="yield__plugin_8hpp_source.html#l00332">332</a> of file <a class="el" href="yield__plugin_8hpp_source.html">yield_plugin.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="yield__plugin_8cpp_source.html#l00317">update_traj_for_cooperative_behavior()</a>.</p>

</div>
</div>
<a id="ade1ae58ef6dfc4c31025162c8c150b0a" name="ade1ae58ef6dfc4c31025162c8c150b0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade1ae58ef6dfc4c31025162c8c150b0a">&#9670;&nbsp;</a></span>external_objects_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;carma_perception_msgs::msg::ExternalObject&gt; yield_plugin::YieldPlugin::external_objects_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="yield__plugin_8hpp_source.html#l00318">318</a> of file <a class="el" href="yield__plugin_8hpp_source.html">yield_plugin.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="yield__plugin_8cpp_source.html#l00252">plan_trajectory_callback()</a>, and <a class="el" href="yield__plugin_8cpp_source.html#l01070">set_external_objects()</a>.</p>

</div>
</div>
<a id="a0139ba3f27c4205d7820c5e8ed668042" name="a0139ba3f27c4205d7820c5e8ed668042"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0139ba3f27c4205d7820c5e8ed668042">&#9670;&nbsp;</a></span>georeference_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string yield_plugin::YieldPlugin::georeference_ {&quot;&quot;}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="yield__plugin_8hpp_source.html#l00339">339</a> of file <a class="el" href="yield__plugin_8hpp_source.html">yield_plugin.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="yield__plugin_8cpp_source.html#l01061">set_georeference_string()</a>.</p>

</div>
</div>
<a id="ad25df251a12c9c052daeab2f58385c7d" name="ad25df251a12c9c052daeab2f58385c7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad25df251a12c9c052daeab2f58385c7d">&#9670;&nbsp;</a></span>host_bsm_id_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string yield_plugin::YieldPlugin::host_bsm_id_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="yield__plugin_8hpp_source.html#l00337">337</a> of file <a class="el" href="yield__plugin_8hpp_source.html">yield_plugin.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="yield__plugin_8cpp_source.html#l00246">bsm_cb()</a>, and <a class="el" href="yield__plugin_8cpp_source.html#l00133">compose_mobility_response()</a>.</p>

</div>
</div>
<a id="a238b7f67b846cc65d8d55e8d3500f96c" name="a238b7f67b846cc65d8d55e8d3500f96c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a238b7f67b846cc65d8d55e8d3500f96c">&#9670;&nbsp;</a></span>host_vehicle_size</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">geometry_msgs::msg::Vector3 yield_plugin::YieldPlugin::host_vehicle_size</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="yield__plugin_8hpp_source.html#l00334">334</a> of file <a class="el" href="yield__plugin_8hpp_source.html">yield_plugin.hpp</a>.</p>

</div>
</div>
<a id="a274208e09bc96aaef0ba731904aa57de" name="a274208e09bc96aaef0ba731904aa57de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a274208e09bc96aaef0ba731904aa57de">&#9670;&nbsp;</a></span>lc_status_publisher_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceyield__plugin.html#a508edd284962f40938944f9304e66263">LaneChangeStatusCB</a> yield_plugin::YieldPlugin::lc_status_publisher_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="yield__plugin_8hpp_source.html#l00314">314</a> of file <a class="el" href="yield__plugin_8hpp_source.html">yield_plugin.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="yield__plugin_8cpp_source.html#l00153">mobilityrequest_cb()</a>.</p>

</div>
</div>
<a id="a42d2a2d8a9f88afbedaa566ad57c8444" name="a42d2a2d8a9f88afbedaa566ad57c8444"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42d2a2d8a9f88afbedaa566ad57c8444">&#9670;&nbsp;</a></span>map_projector_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_ptr&lt;lanelet::projection::LocalFrameProjector&gt; yield_plugin::YieldPlugin::map_projector_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="yield__plugin_8hpp_source.html#l00340">340</a> of file <a class="el" href="yield__plugin_8hpp_source.html">yield_plugin.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="yield__plugin_8cpp_source.html#l00119">ecef_to_map_point()</a>, <a class="el" href="yield__plugin_8cpp_source.html#l00153">mobilityrequest_cb()</a>, and <a class="el" href="yield__plugin_8cpp_source.html#l01061">set_georeference_string()</a>.</p>

</div>
</div>
<a id="a82d36ef453849014abfe64e6ecac5e58" name="a82d36ef453849014abfe64e6ecac5e58"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82d36ef453849014abfe64e6ecac5e58">&#9670;&nbsp;</a></span>mobility_response_publisher_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceyield__plugin.html#aa28c9381b8df2f7fdf3e7870bc5c2866">MobilityResponseCB</a> yield_plugin::YieldPlugin::mobility_response_publisher_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="yield__plugin_8hpp_source.html#l00313">313</a> of file <a class="el" href="yield__plugin_8hpp_source.html">yield_plugin.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="yield__plugin_8cpp_source.html#l00153">mobilityrequest_cb()</a>.</p>

</div>
</div>
<a id="aa2f96dc545c04733e8ba11a6f3a0c2c6" name="aa2f96dc545c04733e8ba11a6f3a0c2c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2f96dc545c04733e8ba11a6f3a0c2c6">&#9670;&nbsp;</a></span>nh_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_ptr&lt;carma_ros2_utils::CarmaLifecycleNode&gt; yield_plugin::YieldPlugin::nh_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="yield__plugin_8hpp_source.html#l00315">315</a> of file <a class="el" href="yield__plugin_8hpp_source.html">yield_plugin.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="yield__plugin_8cpp_source.html#l01036">check_traj_for_digital_min_gap()</a>, <a class="el" href="yield__plugin_8cpp_source.html#l00133">compose_mobility_response()</a>, <a class="el" href="yield__plugin_8cpp_source.html#l00402">generate_JMT_trajectory()</a>, <a class="el" href="yield__plugin_8cpp_source.html#l00550">get_collision()</a>, <a class="el" href="yield__plugin_8cpp_source.html#l00723">get_collision_time()</a>, <a class="el" href="yield__plugin_8cpp_source.html#l00807">get_earliest_collision_object_and_time()</a>, <a class="el" href="yield__plugin_8cpp_source.html#l00845">get_predicted_velocity_at_time()</a>, <a class="el" href="yield__plugin_8cpp_source.html#l00697">is_object_behind_vehicle()</a>, <a class="el" href="yield__plugin_8cpp_source.html#l00153">mobilityrequest_cb()</a>, <a class="el" href="yield__plugin_8cpp_source.html#l00252">plan_trajectory_callback()</a>, <a class="el" href="yield__plugin_8cpp_source.html#l00237">set_incoming_request_info()</a>, <a class="el" href="yield__plugin_8cpp_source.html#l00317">update_traj_for_cooperative_behavior()</a>, and <a class="el" href="yield__plugin_8cpp_source.html#l00888">update_traj_for_object()</a>.</p>

</div>
</div>
<a id="ae0f4cfd0eb14d39203f52fa86c1bd89d" name="ae0f4cfd0eb14d39203f52fa86c1bd89d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0f4cfd0eb14d39203f52fa86c1bd89d">&#9670;&nbsp;</a></span>previous_llt_id_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">lanelet::Id yield_plugin::YieldPlugin::previous_llt_id_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="yield__plugin_8hpp_source.html#l00317">317</a> of file <a class="el" href="yield__plugin_8hpp_source.html">yield_plugin.hpp</a>.</p>

</div>
</div>
<a id="ad620a98521987c31d004b5aabbf3a620" name="ad620a98521987c31d004b5aabbf3a620"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad620a98521987c31d004b5aabbf3a620">&#9670;&nbsp;</a></span>req_target_plan_time_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double yield_plugin::YieldPlugin::req_target_plan_time_ = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="yield__plugin_8hpp_source.html#l00327">327</a> of file <a class="el" href="yield__plugin_8hpp_source.html">yield_plugin.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="yield__plugin_8cpp_source.html#l00237">set_incoming_request_info()</a>, and <a class="el" href="yield__plugin_8cpp_source.html#l00317">update_traj_for_cooperative_behavior()</a>.</p>

</div>
</div>
<a id="ac1099523a4ea8b3ecc607cf466e42162" name="ac1099523a4ea8b3ecc607cf466e42162"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1099523a4ea8b3ecc607cf466e42162">&#9670;&nbsp;</a></span>req_target_speed_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double yield_plugin::YieldPlugin::req_target_speed_ = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="yield__plugin_8hpp_source.html#l00325">325</a> of file <a class="el" href="yield__plugin_8hpp_source.html">yield_plugin.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="yield__plugin_8cpp_source.html#l00237">set_incoming_request_info()</a>, and <a class="el" href="yield__plugin_8cpp_source.html#l00317">update_traj_for_cooperative_behavior()</a>.</p>

</div>
</div>
<a id="a25b4eec8b5e4648044a4b46570cb4199" name="a25b4eec8b5e4648044a4b46570cb4199"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25b4eec8b5e4648044a4b46570cb4199">&#9670;&nbsp;</a></span>req_timestamp_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double yield_plugin::YieldPlugin::req_timestamp_ = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="yield__plugin_8hpp_source.html#l00326">326</a> of file <a class="el" href="yield__plugin_8hpp_source.html">yield_plugin.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="yield__plugin_8cpp_source.html#l00237">set_incoming_request_info()</a>, and <a class="el" href="yield__plugin_8cpp_source.html#l00317">update_traj_for_cooperative_behavior()</a>.</p>

</div>
</div>
<a id="a2e806b6f64d4490b88f8947d8a360491" name="a2e806b6f64d4490b88f8947d8a360491"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e806b6f64d4490b88f8947d8a360491">&#9670;&nbsp;</a></span>req_trajectory_points_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;lanelet::BasicPoint2d&gt; yield_plugin::YieldPlugin::req_trajectory_points_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="yield__plugin_8hpp_source.html#l00324">324</a> of file <a class="el" href="yield__plugin_8hpp_source.html">yield_plugin.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="yield__plugin_8cpp_source.html#l00237">set_incoming_request_info()</a>, and <a class="el" href="yield__plugin_8cpp_source.html#l00317">update_traj_for_cooperative_behavior()</a>.</p>

</div>
</div>
<a id="a03f092d19aab7369af56f9438938d454" name="a03f092d19aab7369af56f9438938d454"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03f092d19aab7369af56f9438938d454">&#9670;&nbsp;</a></span>route_llt_ids_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::set&lt;lanelet::Id&gt; yield_plugin::YieldPlugin::route_llt_ids_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="yield__plugin_8hpp_source.html#l00316">316</a> of file <a class="el" href="yield__plugin_8hpp_source.html">yield_plugin.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="yield__plugin_8cpp_source.html#l00550">get_collision()</a>, and <a class="el" href="yield__plugin_8cpp_source.html#l00807">get_earliest_collision_object_and_time()</a>.</p>

</div>
</div>
<a id="ae3f7420f5eccdb7f4b4ec59c7f69ec3f" name="ae3f7420f5eccdb7f4b4ec59c7f69ec3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3f7420f5eccdb7f4b4ec59c7f69ec3f">&#9670;&nbsp;</a></span>timesteps_since_last_req_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classint.html">int</a> yield_plugin::YieldPlugin::timesteps_since_last_req_ = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="yield__plugin_8hpp_source.html#l00328">328</a> of file <a class="el" href="yield__plugin_8hpp_source.html">yield_plugin.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="yield__plugin_8cpp_source.html#l00153">mobilityrequest_cb()</a>, and <a class="el" href="yield__plugin_8cpp_source.html#l00252">plan_trajectory_callback()</a>.</p>

</div>
</div>
<a id="aff229ed7bba2a76d0b1b99a83b9fdf88" name="aff229ed7bba2a76d0b1b99a83b9fdf88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff229ed7bba2a76d0b1b99a83b9fdf88">&#9670;&nbsp;</a></span>wm_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacecarma__wm.html#a3ac653959e0b6198cae274d68b343228">carma_wm::WorldModelConstPtr</a> yield_plugin::YieldPlugin::wm_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="yield__plugin_8hpp_source.html#l00311">311</a> of file <a class="el" href="yield__plugin_8hpp_source.html">yield_plugin.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="yield__plugin_8cpp_source.html#l01036">check_traj_for_digital_min_gap()</a>, <a class="el" href="yield__plugin_8cpp_source.html#l00550">get_collision()</a>, <a class="el" href="yield__plugin_8cpp_source.html#l00723">get_collision_time()</a>, <a class="el" href="yield__plugin_8cpp_source.html#l00807">get_earliest_collision_object_and_time()</a>, and <a class="el" href="yield__plugin_8cpp_source.html#l00888">update_traj_for_object()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>yield_plugin/include/yield_plugin/<a class="el" href="yield__plugin_8hpp_source.html">yield_plugin.hpp</a></li>
<li>yield_plugin/src/<a class="el" href="yield__plugin_8cpp_source.html">yield_plugin.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceyield__plugin.html">yield_plugin</a></li><li class="navelem"><a class="el" href="classyield__plugin_1_1YieldPlugin.html">YieldPlugin</a></li>
    <li class="footer">Generated on Tue Jul 30 2024 19:27:45 for Carma-platform by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4 </li>
  </ul>
</div>
</body>
</html>
