<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Carma-platform: carma_wm_ctrl::WMBroadcaster Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Carma-platform<span id="projectnumber">&#160;v4.2.0</span>
   </div>
   <div id="projectbrief">CARMA Platform is built on robot operating system (ROS) and utilizes open source software (OSS) that enables Cooperative Driving Automation (CDA) features to allow Automated Driving Systems to interact and cooperate with infrastructure and other vehicles through communication.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classcarma__wm__ctrl_1_1WMBroadcaster.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pri-types">Private Types</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classcarma__wm__ctrl_1_1WMBroadcaster-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">carma_wm_ctrl::WMBroadcaster Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Class which provies exposes map publication and <a class="el" href="namespacecarma__wm.html">carma_wm</a> update logic.  
 <a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="WMBroadcaster_8hpp_source.html">WMBroadcaster.hpp</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for carma_wm_ctrl::WMBroadcaster:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster__coll__graph.png" border="0" usemap="#acarma__wm__ctrl_1_1WMBroadcaster_coll__map" alt="Collaboration graph"/></div>
<map name="acarma__wm__ctrl_1_1WMBroadcaster_coll__map" id="acarma__wm__ctrl_1_1WMBroadcaster_coll__map">
<area shape="rect" title="Class which provies exposes map publication and carma_wm update logic." alt="" coords="1993,505,2213,1448"/>
<area shape="rect" title=" " alt="" coords="5,255,97,333"/>
<area shape="rect" title=" " alt="" coords="122,255,314,333"/>
<area shape="rect" title=" " alt="" coords="338,255,447,333"/>
<area shape="rect" title=" " alt="" coords="500,255,560,333"/>
<area shape="rect" title=" " alt="" coords="585,255,691,333"/>
<area shape="rect" title=" " alt="" coords="716,248,869,340"/>
<area shape="rect" title=" " alt="" coords="893,241,1092,347"/>
<area shape="rect" title=" " alt="" coords="1117,248,1274,340"/>
<area shape="rect" title=" " alt="" coords="1298,255,1405,333"/>
<area shape="rect" title=" " alt="" coords="1429,255,1548,333"/>
<area shape="rect" title=" " alt="" coords="1572,255,1640,333"/>
<area shape="rect" title=" " alt="" coords="1664,255,1719,333"/>
<area shape="rect" title=" " alt="" coords="1743,248,1877,340"/>
<area shape="rect" title=" " alt="" coords="1901,248,2057,340"/>
<area shape="rect" title=" " alt="" coords="1981,20,2039,97"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1GeofenceScheduler.html" title="A GeofenceScheduler is responsable for notifying the user when a geofence is active or inactive accor..." alt="" coords="2212,189,2443,399"/>
<area shape="rect" title=" " alt="" coords="2467,241,2636,347"/>
<area shape="rect" title=" " alt="" coords="2661,241,2837,347"/>
<area shape="rect" title=" " alt="" coords="2861,241,3074,347"/>
<area shape="rect" title=" " alt="" coords="2063,20,2245,97"/>
<area shape="rect" title=" " alt="" coords="2269,5,2426,112"/>
<area shape="rect" title=" " alt="" coords="2451,20,2588,97"/>
<area shape="rect" title=" " alt="" coords="2613,5,2773,112"/>
<area shape="rect" title=" " alt="" coords="2796,20,2864,97"/>
<area shape="rect" title=" " alt="" coords="2888,20,3004,97"/>
<area shape="rect" title=" " alt="" coords="3099,241,3257,347"/>
<area shape="rect" title=" " alt="" coords="3281,248,3504,340"/>
<area shape="rect" title=" " alt="" coords="3528,255,3575,333"/>
<area shape="rect" title=" " alt="" coords="3599,255,3655,333"/>
<area shape="rect" title=" " alt="" coords="3679,255,3735,333"/>
<area shape="rect" title=" " alt="" coords="3760,248,3935,340"/>
<area shape="rect" title=" " alt="" coords="3959,248,4175,340"/>
<area shape="rect" title=" " alt="" coords="4200,255,4255,333"/>
<area shape="rect" title=" " alt="" coords="4341,255,4380,333"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-types" name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:ad4e8773338ce55f7132025e04d492e23"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ad4e8773338ce55f7132025e04d492e23">PublishMapCallback</a> = std::function&lt; void(const autoware_lanelet2_msgs::msg::MapBin &amp;)&gt;</td></tr>
<tr class="separator:ad4e8773338ce55f7132025e04d492e23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ed209093ad1ddb36c00f97951063f8b"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a7ed209093ad1ddb36c00f97951063f8b">PublishMapUpdateCallback</a> = std::function&lt; void(const autoware_lanelet2_msgs::msg::MapBin &amp;)&gt;</td></tr>
<tr class="separator:a7ed209093ad1ddb36c00f97951063f8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3784647580aee6501347090b46c3244"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#af3784647580aee6501347090b46c3244">PublishCtrlRequestCallback</a> = std::function&lt; void(const carma_v2x_msgs::msg::TrafficControlRequest &amp;)&gt;</td></tr>
<tr class="separator:af3784647580aee6501347090b46c3244"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f39f2021825ba09363d9ee1c456ced6"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a1f39f2021825ba09363d9ee1c456ced6">PublishActiveGeofCallback</a> = std::function&lt; void(const carma_perception_msgs::msg::CheckActiveGeofence &amp;)&gt;</td></tr>
<tr class="separator:a1f39f2021825ba09363d9ee1c456ced6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4bb2c122bfd96977dd89b9999a4050d"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ac4bb2c122bfd96977dd89b9999a4050d">PublishMobilityOperationCallback</a> = std::function&lt; void(const carma_v2x_msgs::msg::MobilityOperation &amp;)&gt;</td></tr>
<tr class="separator:ac4bb2c122bfd96977dd89b9999a4050d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a95cb7c60682d7b455a8624534ad94706"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a95cb7c60682d7b455a8624534ad94706">WMBroadcaster</a> (const <a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ad4e8773338ce55f7132025e04d492e23">PublishMapCallback</a> &amp;map_pub, const <a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a7ed209093ad1ddb36c00f97951063f8b">PublishMapUpdateCallback</a> &amp;map_update_pub, const <a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#af3784647580aee6501347090b46c3244">PublishCtrlRequestCallback</a> &amp;control_msg_pub, const <a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a1f39f2021825ba09363d9ee1c456ced6">PublishActiveGeofCallback</a> &amp;active_pub, std::shared_ptr&lt; carma_ros2_utils::timers::TimerFactory &gt; timer_factory, const <a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ac4bb2c122bfd96977dd89b9999a4050d">PublishMobilityOperationCallback</a> &amp;tcm_ack_pub)</td></tr>
<tr class="memdesc:a95cb7c60682d7b455a8624534ad94706"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a95cb7c60682d7b455a8624534ad94706">More...</a><br /></td></tr>
<tr class="separator:a95cb7c60682d7b455a8624534ad94706"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a243d8d82a364aad6270e38f0202a68cb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a243d8d82a364aad6270e38f0202a68cb">baseMapCallback</a> (autoware_lanelet2_msgs::msg::MapBin::UniquePtr map_msg)</td></tr>
<tr class="memdesc:a243d8d82a364aad6270e38f0202a68cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback to set the base map when it has been loaded.  <a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a243d8d82a364aad6270e38f0202a68cb">More...</a><br /></td></tr>
<tr class="separator:a243d8d82a364aad6270e38f0202a68cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af400fb26c47adae60502bc64c600b298"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#af400fb26c47adae60502bc64c600b298">geoReferenceCallback</a> (std_msgs::msg::String::UniquePtr geo_ref)</td></tr>
<tr class="memdesc:af400fb26c47adae60502bc64c600b298"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback to set the base map georeference (proj string)  <a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#af400fb26c47adae60502bc64c600b298">More...</a><br /></td></tr>
<tr class="separator:af400fb26c47adae60502bc64c600b298"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63a919c2cf6736a80fa29a706b020330"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a63a919c2cf6736a80fa29a706b020330">geofenceCallback</a> (carma_v2x_msgs::msg::TrafficControlMessage::UniquePtr geofence_msg)</td></tr>
<tr class="memdesc:a63a919c2cf6736a80fa29a706b020330"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback to add a geofence to the map. Currently only supports version 1 TrafficControlMessage.  <a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a63a919c2cf6736a80fa29a706b020330">More...</a><br /></td></tr>
<tr class="separator:a63a919c2cf6736a80fa29a706b020330"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d4ee6959ff334d9f4f16864e5bd0cfe"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a9d4ee6959ff334d9f4f16864e5bd0cfe">externalMapMsgCallback</a> (carma_v2x_msgs::msg::MapData::UniquePtr map_msg)</td></tr>
<tr class="memdesc:a9d4ee6959ff334d9f4f16864e5bd0cfe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback to MAP.msg which contains intersections' static info such geometry and lane ids.  <a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a9d4ee6959ff334d9f4f16864e5bd0cfe">More...</a><br /></td></tr>
<tr class="separator:a9d4ee6959ff334d9f4f16864e5bd0cfe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a649174a7a7270df95532cad5131bf4cb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a649174a7a7270df95532cad5131bf4cb">addGeofence</a> (std::shared_ptr&lt; <a class="el" href="classcarma__wm__ctrl_1_1Geofence.html">Geofence</a> &gt; gf_ptr)</td></tr>
<tr class="memdesc:a649174a7a7270df95532cad5131bf4cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds a geofence to the current map and publishes the ROS msg.  <a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a649174a7a7270df95532cad5131bf4cb">More...</a><br /></td></tr>
<tr class="separator:a649174a7a7270df95532cad5131bf4cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3751e2e2dc4455fc7e3e80f1ae2c672e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a3751e2e2dc4455fc7e3e80f1ae2c672e">removeGeofence</a> (std::shared_ptr&lt; <a class="el" href="classcarma__wm__ctrl_1_1Geofence.html">Geofence</a> &gt; gf_ptr)</td></tr>
<tr class="memdesc:a3751e2e2dc4455fc7e3e80f1ae2c672e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Removes a geofence from the current map and publishes the ROS msg.  <a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a3751e2e2dc4455fc7e3e80f1ae2c672e">More...</a><br /></td></tr>
<tr class="separator:a3751e2e2dc4455fc7e3e80f1ae2c672e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7efa8028648e4ed8b847c97e952b07d1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a7efa8028648e4ed8b847c97e952b07d1">routeCallbackMessage</a> (carma_planning_msgs::msg::Route::UniquePtr route_msg)</td></tr>
<tr class="memdesc:a7efa8028648e4ed8b847c97e952b07d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calls <a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a0fcc6904e5b3fb2fca13e9488069ec10" title="Pulls vehicle information from CARMA Cloud at startup by providing its selected route in a TrafficCon...">controlRequestFromRoute()</a> and publishes the TrafficControlRequest Message returned after the completed operations.  <a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a7efa8028648e4ed8b847c97e952b07d1">More...</a><br /></td></tr>
<tr class="separator:a7efa8028648e4ed8b847c97e952b07d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2493db4c5843a143c61cd27b0489ca7a"><td class="memItemLeft" align="right" valign="top">visualization_msgs::msg::Marker&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a2493db4c5843a143c61cd27b0489ca7a">composeTCMMarkerVisualizer</a> (const std::vector&lt; lanelet::Point3d &gt; &amp;input)</td></tr>
<tr class="memdesc:a2493db4c5843a143c61cd27b0489ca7a"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a2493db4c5843a143c61cd27b0489ca7a" title="composeTCMMarkerVisualizer() compose TCM Marker visualization">composeTCMMarkerVisualizer()</a> compose TCM Marker visualization  <a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a2493db4c5843a143c61cd27b0489ca7a">More...</a><br /></td></tr>
<tr class="separator:a2493db4c5843a143c61cd27b0489ca7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c72c6fdeb1568b078bf6131c906b377"><td class="memItemLeft" align="right" valign="top">carma_v2x_msgs::msg::TrafficControlRequestPolygon&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a8c72c6fdeb1568b078bf6131c906b377">composeTCRStatus</a> (const lanelet::BasicPoint3d &amp;localPoint, const carma_v2x_msgs::msg::TrafficControlBounds &amp;cB, const lanelet::projection::LocalFrameProjector &amp;local_projector)</td></tr>
<tr class="memdesc:a8c72c6fdeb1568b078bf6131c906b377"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a8c72c6fdeb1568b078bf6131c906b377" title="composeTCRStatus() compose TCM Request visualization on UI">composeTCRStatus()</a> compose TCM Request visualization on UI  <a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a8c72c6fdeb1568b078bf6131c906b377">More...</a><br /></td></tr>
<tr class="separator:a8c72c6fdeb1568b078bf6131c906b377"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0fcc6904e5b3fb2fca13e9488069ec10"><td class="memItemLeft" align="right" valign="top">carma_v2x_msgs::msg::TrafficControlRequest&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a0fcc6904e5b3fb2fca13e9488069ec10">controlRequestFromRoute</a> (const carma_planning_msgs::msg::Route &amp;route_msg, std::shared_ptr&lt; j2735_v2x_msgs::msg::Id64b &gt; req_id_for_testing=NULL)</td></tr>
<tr class="memdesc:a0fcc6904e5b3fb2fca13e9488069ec10"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pulls vehicle information from CARMA Cloud at startup by providing its selected route in a TrafficControlRequest message that is published after a route is selected. During operation at ~10s intervals the vehicle will make another control request for the remainder of its route.  <a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a0fcc6904e5b3fb2fca13e9488069ec10">More...</a><br /></td></tr>
<tr class="separator:a0fcc6904e5b3fb2fca13e9488069ec10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44fed247724b501a968aec27479ed58d"><td class="memItemLeft" align="right" valign="top">lanelet::Points3d&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a44fed247724b501a968aec27479ed58d">getPointsInLocalFrame</a> (const carma_v2x_msgs::msg::TrafficControlMessageV01 &amp;geofence_msg)</td></tr>
<tr class="memdesc:a44fed247724b501a968aec27479ed58d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extract geofence points from geofence message using its given proj and datum fields.  <a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a44fed247724b501a968aec27479ed58d">More...</a><br /></td></tr>
<tr class="separator:a44fed247724b501a968aec27479ed58d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1327952ca44a5e817b0498f93f6143ac"><td class="memItemLeft" align="right" valign="top">lanelet::ConstLaneletOrAreas&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a1327952ca44a5e817b0498f93f6143ac">getAffectedLaneletOrAreas</a> (const lanelet::Points3d &amp;gf_pts)</td></tr>
<tr class="memdesc:a1327952ca44a5e817b0498f93f6143ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the affected lanelet or areas based on the points in local frame.  <a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a1327952ca44a5e817b0498f93f6143ac">More...</a><br /></td></tr>
<tr class="separator:a1327952ca44a5e817b0498f93f6143ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a634326ffd890a920f456bd8c1ebc5e6f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a634326ffd890a920f456bd8c1ebc5e6f">setMaxLaneWidth</a> (double max_lane_width)</td></tr>
<tr class="memdesc:a634326ffd890a920f456bd8c1ebc5e6f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the max lane width in meters. <a class="el" href="classcarma__wm__ctrl_1_1Geofence.html" title="An object representing a geofence use for communications with CARMA Cloud.">Geofence</a> points are associated to a lanelet if they are within this distance to a lanelet as geofence points are guaranteed to apply to a single lane.  <a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a634326ffd890a920f456bd8c1ebc5e6f">More...</a><br /></td></tr>
<tr class="separator:a634326ffd890a920f456bd8c1ebc5e6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0225013dc8793cf940e8007f96ead71"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ad0225013dc8793cf940e8007f96ead71">setIntersectionCoordCorrection</a> (const std::vector&lt; int64_t &gt; &amp;intersection_ids_for_correction, const std::vector&lt; double &gt; &amp;intersection_correction)</td></tr>
<tr class="memdesc:ad0225013dc8793cf940e8007f96ead71"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the coordinate correction for intersection.  <a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ad0225013dc8793cf940e8007f96ead71">More...</a><br /></td></tr>
<tr class="separator:ad0225013dc8793cf940e8007f96ead71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69a944cfa523079a3b9cdd29267d6d68"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a69a944cfa523079a3b9cdd29267d6d68">setConfigSpeedLimit</a> (double cL)</td></tr>
<tr class="memdesc:a69a944cfa523079a3b9cdd29267d6d68"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the configured speed limit.  <a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a69a944cfa523079a3b9cdd29267d6d68">More...</a><br /></td></tr>
<tr class="separator:a69a944cfa523079a3b9cdd29267d6d68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7731acf2acd03792583bba969571235f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a7731acf2acd03792583bba969571235f">setVehicleParticipationType</a> (std::string participant)</td></tr>
<tr class="memdesc:a7731acf2acd03792583bba969571235f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the Vehicle Participation Type.  <a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a7731acf2acd03792583bba969571235f">More...</a><br /></td></tr>
<tr class="separator:a7731acf2acd03792583bba969571235f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83cf47dec758a15a42d30905a3b9b7b8"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a83cf47dec758a15a42d30905a3b9b7b8">getVehicleParticipationType</a> ()</td></tr>
<tr class="memdesc:a83cf47dec758a15a42d30905a3b9b7b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the Vehicle Participation Type object.  <a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a83cf47dec758a15a42d30905a3b9b7b8">More...</a><br /></td></tr>
<tr class="separator:a83cf47dec758a15a42d30905a3b9b7b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0e373523dc84a409331d01b62d2fce0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#af0e373523dc84a409331d01b62d2fce0">geofenceFromMsg</a> (std::shared_ptr&lt; <a class="el" href="classcarma__wm__ctrl_1_1Geofence.html">Geofence</a> &gt; gf_ptr, const carma_v2x_msgs::msg::TrafficControlMessageV01 &amp;geofence_msg)</td></tr>
<tr class="memdesc:af0e373523dc84a409331d01b62d2fce0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fills geofence object from TrafficControlMessageV01 ROS Msg.  <a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#af0e373523dc84a409331d01b62d2fce0">More...</a><br /></td></tr>
<tr class="separator:af0e373523dc84a409331d01b62d2fce0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac72e7333f997bfe19547a235f389c07"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::shared_ptr&lt; <a class="el" href="classcarma__wm__ctrl_1_1Geofence.html">Geofence</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aac72e7333f997bfe19547a235f389c07">geofenceFromMapMsg</a> (std::shared_ptr&lt; <a class="el" href="classcarma__wm__ctrl_1_1Geofence.html">Geofence</a> &gt; gf_ptr, const carma_v2x_msgs::msg::MapData &amp;map_msg)</td></tr>
<tr class="memdesc:aac72e7333f997bfe19547a235f389c07"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fills geofence object from MAP Data ROS Msg which contains intersections' static data such as geometry and signal_group.  <a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aac72e7333f997bfe19547a235f389c07">More...</a><br /></td></tr>
<tr class="separator:aac72e7333f997bfe19547a235f389c07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35a706cbbb3b04dc4dfc3eea40ececcc"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a35a706cbbb3b04dc4dfc3eea40ececcc">distToNearestActiveGeofence</a> (const lanelet::BasicPoint2d &amp;curr_pos)</td></tr>
<tr class="memdesc:a35a706cbbb3b04dc4dfc3eea40ececcc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the route distance (downtrack or crosstrack in meters) to the nearest active geofence lanelet.  <a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a35a706cbbb3b04dc4dfc3eea40ececcc">More...</a><br /></td></tr>
<tr class="separator:a35a706cbbb3b04dc4dfc3eea40ececcc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7269b37f5fcdbc502122c980fa814387"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a7269b37f5fcdbc502122c980fa814387">currentLocationCallback</a> (geometry_msgs::msg::PoseStamped::UniquePtr current_pos)</td></tr>
<tr class="separator:a7269b37f5fcdbc502122c980fa814387"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c4ca5d0774ffa2aa06fbf0f979b02b0"><td class="memItemLeft" align="right" valign="top">carma_perception_msgs::msg::CheckActiveGeofence&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a7c4ca5d0774ffa2aa06fbf0f979b02b0">checkActiveGeofenceLogic</a> (const geometry_msgs::msg::PoseStamped &amp;current_pos)</td></tr>
<tr class="memdesc:a7c4ca5d0774ffa2aa06fbf0f979b02b0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a message indicating whether or not the vehicle is inside of an active geofence lanelet.  <a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a7c4ca5d0774ffa2aa06fbf0f979b02b0">More...</a><br /></td></tr>
<tr class="separator:a7c4ca5d0774ffa2aa06fbf0f979b02b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae34565da1566e777745a92161422404c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ae34565da1566e777745a92161422404c">addRegionAccessRule</a> (std::shared_ptr&lt; <a class="el" href="classcarma__wm__ctrl_1_1Geofence.html">Geofence</a> &gt; gf_ptr, const carma_v2x_msgs::msg::TrafficControlMessageV01 &amp;msg_v01, const std::vector&lt; lanelet::Lanelet &gt; &amp;affected_llts) const</td></tr>
<tr class="memdesc:ae34565da1566e777745a92161422404c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds RegionAccessRule to the map.  <a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ae34565da1566e777745a92161422404c">More...</a><br /></td></tr>
<tr class="separator:ae34565da1566e777745a92161422404c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a116928c0070cfa7587c219a6629dadb8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a116928c0070cfa7587c219a6629dadb8">addRegionMinimumGap</a> (std::shared_ptr&lt; <a class="el" href="classcarma__wm__ctrl_1_1Geofence.html">Geofence</a> &gt; gf_ptr, const carma_v2x_msgs::msg::TrafficControlMessageV01 &amp;msg_v01, double min_gap, const std::vector&lt; lanelet::Lanelet &gt; &amp;affected_llts, const std::vector&lt; lanelet::Area &gt; &amp;affected_areas) const</td></tr>
<tr class="memdesc:a116928c0070cfa7587c219a6629dadb8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds Minimum Gap to the map.  <a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a116928c0070cfa7587c219a6629dadb8">More...</a><br /></td></tr>
<tr class="separator:a116928c0070cfa7587c219a6629dadb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa326eab73fe1583c1fa937ed2e38b33f"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aa326eab73fe1583c1fa937ed2e38b33f">participantsChecker</a> (const carma_v2x_msgs::msg::TrafficControlMessageV01 &amp;msg_v01) const</td></tr>
<tr class="memdesc:aa326eab73fe1583c1fa937ed2e38b33f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates participants list.  <a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aa326eab73fe1583c1fa937ed2e38b33f">More...</a><br /></td></tr>
<tr class="separator:aa326eab73fe1583c1fa937ed2e38b33f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac71c9fdbf27cbfbe3988c3a77d6e7067"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ac71c9fdbf27cbfbe3988c3a77d6e7067">invertParticipants</a> (const std::vector&lt; std::string &gt; &amp;input_participants) const</td></tr>
<tr class="memdesc:ac71c9fdbf27cbfbe3988c3a77d6e7067"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates inverse participants list of the given participants.  <a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ac71c9fdbf27cbfbe3988c3a77d6e7067">More...</a><br /></td></tr>
<tr class="separator:ac71c9fdbf27cbfbe3988c3a77d6e7067"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c6c3606e5f4b3c12a984261823c1d71"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a2c6c3606e5f4b3c12a984261823c1d71">combineParticipantsToVehicle</a> (const std::vector&lt; std::string &gt; &amp;input_participants) const</td></tr>
<tr class="memdesc:a2c6c3606e5f4b3c12a984261823c1d71"><td class="mdescLeft">&#160;</td><td class="mdescRight">Combines a list of the given participants into a single "vehicle" type if participants cover all possible vehicle types. Returns the input with no change if it doesn't cover all.  <a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a2c6c3606e5f4b3c12a984261823c1d71">More...</a><br /></td></tr>
<tr class="separator:a2c6c3606e5f4b3c12a984261823c1d71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addb8a4d7c2bae6f3763833a3c6f6c5dc"><td class="memItemLeft" align="right" valign="top">carma_planning_msgs::msg::Route&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#addb8a4d7c2bae6f3763833a3c6f6c5dc">getRoute</a> ()</td></tr>
<tr class="memdesc:addb8a4d7c2bae6f3763833a3c6f6c5dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the most recently recieved route message.  <a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#addb8a4d7c2bae6f3763833a3c6f6c5dc">More...</a><br /></td></tr>
<tr class="separator:addb8a4d7c2bae6f3763833a3c6f6c5dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ae3f2086831ebd932e19b2bdfd76405"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="classcarma__wm__ctrl_1_1Geofence.html">Geofence</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a5ae3f2086831ebd932e19b2bdfd76405">createWorkzoneGeofence</a> (std::unordered_map&lt; uint8_t, std::shared_ptr&lt; <a class="el" href="classcarma__wm__ctrl_1_1Geofence.html">Geofence</a> &gt; &gt; work_zone_geofence_cache)</td></tr>
<tr class="memdesc:a5ae3f2086831ebd932e19b2bdfd76405"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a single workzone geofence (in the vector) that includes all additional lanelets (housing traffic lights) and update_list that blocks old lanelets. <a class="el" href="classcarma__wm__ctrl_1_1Geofence.html" title="An object representing a geofence use for communications with CARMA Cloud.">Geofence</a> will have minimum of 6 lanelet_additions_ (front parallel, front diagonal, middle lanelet(s), back diagonal, back parallel, 1 opposing lanelet with trafficlight). And regulatory_element_ of this geofence will be region_access_rule, where it blocks entire affected_parts of CLOSED, TAPERRIGHT, OPENRIGHT. It also blocks the opposing lane's lanelet that would have had the trafficlight, and new lanelet(s) would be added to replace it.  <a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a5ae3f2086831ebd932e19b2bdfd76405">More...</a><br /></td></tr>
<tr class="separator:a5ae3f2086831ebd932e19b2bdfd76405"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc221f65f0b99586fc8c2ffc97c5feea"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#adc221f65f0b99586fc8c2ffc97c5feea">preprocessWorkzoneGeometry</a> (std::unordered_map&lt; uint8_t, std::shared_ptr&lt; <a class="el" href="classcarma__wm__ctrl_1_1Geofence.html">Geofence</a> &gt; &gt; work_zone_geofence_cache, std::shared_ptr&lt; std::vector&lt; lanelet::Lanelet &gt; &gt; parallel_llts, std::shared_ptr&lt; std::vector&lt; lanelet::Lanelet &gt; &gt; opposite_llts)</td></tr>
<tr class="memdesc:adc221f65f0b99586fc8c2ffc97c5feea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Preprocess for workzone area. Parallel_llts will have front_parallel and back_parallel lanelets that were created from splitting (if necessary) TAPERRIGHT and OPENRIGHT lanelets. Opposite_llts will have new lanelets split from REVERSE part with same direction as parallel lanelets that connect to diagonal ones.  <a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#adc221f65f0b99586fc8c2ffc97c5feea">More...</a><br /></td></tr>
<tr class="separator:adc221f65f0b99586fc8c2ffc97c5feea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12708b289f7f3d8f10c6dc749bf14d65"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="classcarma__wm__ctrl_1_1Geofence.html">Geofence</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a12708b289f7f3d8f10c6dc749bf14d65">createWorkzoneGeometry</a> (std::unordered_map&lt; uint8_t, std::shared_ptr&lt; <a class="el" href="classcarma__wm__ctrl_1_1Geofence.html">Geofence</a> &gt; &gt; work_zone_geofence_cache, lanelet::Lanelet parallel_llt_front, lanelet::Lanelet parallel_llt_back, std::shared_ptr&lt; std::vector&lt; lanelet::Lanelet &gt; &gt; middle_opposite_lanelets)</td></tr>
<tr class="memdesc:a12708b289f7f3d8f10c6dc749bf14d65"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create workzone geofence. Create diagonal lanelets and a lanelet that houses opposing lane's trafficlight. Fill lanelet_additions_ with every newly created lanelets New lanelets will have traffic light. Old lanelets (and those from CLOSED) will be blocked using update_list as region_access_rule.  <a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a12708b289f7f3d8f10c6dc749bf14d65">More...</a><br /></td></tr>
<tr class="separator:a12708b289f7f3d8f10c6dc749bf14d65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a883734808f44db2778371ce3fbeecdd3"><td class="memItemLeft" align="right" valign="top">std::vector&lt; lanelet::Lanelet &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a883734808f44db2778371ce3fbeecdd3">splitLaneletWithPoint</a> (const std::vector&lt; lanelet::BasicPoint2d &gt; &amp;input_pts, const lanelet::Lanelet &amp;input_llt, double error_distance)</td></tr>
<tr class="memdesc:a883734808f44db2778371ce3fbeecdd3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Split given lanelet with same proportion as the given points' downtrack relative to the lanelet. Newly created lanelet will have old regulatory elements copied into each of them. From the front and back boundaries, it is deemed not necessary to split if the ratios are within error_distance from either of it. For example, if front and back points of 3 points given are both within error_distance, only middle point will be used to split into 2 lanelets. It will return duplicate of old lanelet (with different id) if no splitting was done.  <a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a883734808f44db2778371ce3fbeecdd3">More...</a><br /></td></tr>
<tr class="separator:a883734808f44db2778371ce3fbeecdd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a264607b6ec5b20d8971f8dc14a4b1825"><td class="memItemLeft" align="right" valign="top">lanelet::Lanelets&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a264607b6ec5b20d8971f8dc14a4b1825">splitOppositeLaneletWithPoint</a> (std::shared_ptr&lt; std::vector&lt; lanelet::Lanelet &gt; &gt; opposite_llts, const lanelet::BasicPoint2d &amp;input_pt, const lanelet::Lanelet &amp;input_llt, double error_distance)</td></tr>
<tr class="memdesc:a264607b6ec5b20d8971f8dc14a4b1825"><td class="mdescLeft">&#160;</td><td class="mdescRight">Split given lanelet's adjacent, OPPOSITE lanelet with same proportion as the given point's downtrack relative to the lanelet. Newly created lanelet will have old regulatory elements copied into each of them. From the front and back boundaries, it is deemed not necessary to split if the ratios are within error_distance from either of it. It will return duplicate of old lanelet (with different id) if no splitting was done.  <a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a264607b6ec5b20d8971f8dc14a4b1825">More...</a><br /></td></tr>
<tr class="separator:a264607b6ec5b20d8971f8dc14a4b1825"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1dfc2ec5be906966916939c75874cbab"><td class="memItemLeft" align="right" valign="top">std::vector&lt; lanelet::Lanelet &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a1dfc2ec5be906966916939c75874cbab">splitLaneletWithRatio</a> (std::vector&lt; double &gt; ratios, lanelet::Lanelet input_lanelet, double error_distance) const</td></tr>
<tr class="memdesc:a1dfc2ec5be906966916939c75874cbab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Split given lanelet with given downtrack ratios relative to the lanelet. Newly created lanelet will have old regulatory elements copied into each of them. From the front and back boundaries, it is deemed not necessary to split if the ratios are within error_distance from either of it. For example, if front and back points of 3 ratios given are both within error_distance, only middle ratio will be used to split, so 2 lanelets will be returned. It will return duplicate of old lanelet (with different id) if no splitting was done.  <a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a1dfc2ec5be906966916939c75874cbab">More...</a><br /></td></tr>
<tr class="separator:a1dfc2ec5be906966916939c75874cbab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adfb94b051e74a67830c1795e32081cbc"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#adfb94b051e74a67830c1795e32081cbc">generate32BitId</a> (const std::string &amp;label)</td></tr>
<tr class="memdesc:adfb94b051e74a67830c1795e32081cbc"><td class="mdescLeft">&#160;</td><td class="mdescRight">helper for generating 32bit traffic light Id from TCM label field consisting workzone intersection/signal group ids  <a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#adfb94b051e74a67830c1795e32081cbc">More...</a><br /></td></tr>
<tr class="separator:adfb94b051e74a67830c1795e32081cbc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b5b09f05f4f3ed3a6d5027328f687a3"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a4b5b09f05f4f3ed3a6d5027328f687a3">convertLightIdToInterGroupId</a> (unsigned &amp;intersection_id, unsigned &amp;group_id, const lanelet::Id &amp;lanelet_id)</td></tr>
<tr class="memdesc:a4b5b09f05f4f3ed3a6d5027328f687a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">helper for generating intersection and group Id of a traffic light from lanelet id  <a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a4b5b09f05f4f3ed3a6d5027328f687a3">More...</a><br /></td></tr>
<tr class="separator:a4b5b09f05f4f3ed3a6d5027328f687a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e4581c0020ab957f80062f40b89a4cf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a1e4581c0020ab957f80062f40b89a4cf">setErrorDistance</a> (double error_distance)</td></tr>
<tr class="separator:a1e4581c0020ab957f80062f40b89a4cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bd681a01c6f93dba31882b370a87aef"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a0bd681a01c6f93dba31882b370a87aef">publishLightId</a> ()</td></tr>
<tr class="memdesc:a0bd681a01c6f93dba31882b370a87aef"><td class="mdescLeft">&#160;</td><td class="mdescRight">helps to populate upcoming_intersection_ids_ from local traffic lanelet ids  <a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a0bd681a01c6f93dba31882b370a87aef">More...</a><br /></td></tr>
<tr class="separator:a0bd681a01c6f93dba31882b370a87aef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e4ce19e4beeb74ae79ae8b1ca02cbb7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a3e4ce19e4beeb74ae79ae8b1ca02cbb7">setConfigVehicleId</a> (const std::string &amp;vehicle_id)</td></tr>
<tr class="memdesc:a3e4ce19e4beeb74ae79ae8b1ca02cbb7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve the vehicle ID from global vehicle parameters, and set instance memeber vehicle id.  <a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a3e4ce19e4beeb74ae79ae8b1ca02cbb7">More...</a><br /></td></tr>
<tr class="separator:a3e4ce19e4beeb74ae79ae8b1ca02cbb7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae520d10dda3ac342470fd49304cf0e21"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ae520d10dda3ac342470fd49304cf0e21">setConfigACKPubTimes</a> (int ack_pub_times)</td></tr>
<tr class="memdesc:ae520d10dda3ac342470fd49304cf0e21"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the TCM Acknowledgement publish times.  <a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ae520d10dda3ac342470fd49304cf0e21">More...</a><br /></td></tr>
<tr class="separator:ae520d10dda3ac342470fd49304cf0e21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc8891ed0c1949e44412537e7c904f4c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#acc8891ed0c1949e44412537e7c904f4c">pubTCMACK</a> (j2735_v2x_msgs::msg::Id64b tcm_req_id, uint16_t msgnum, int ack_status, const std::string &amp;ack_reason)</td></tr>
<tr class="memdesc:acc8891ed0c1949e44412537e7c904f4c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct TCM acknowledgement object and populate it with params. Publish the object for a configured number of times.  <a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#acc8891ed0c1949e44412537e7c904f4c">More...</a><br /></td></tr>
<tr class="separator:acc8891ed0c1949e44412537e7c904f4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8d0e8fc5b08ab5f722e4f0afb8ee9f6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ad8d0e8fc5b08ab5f722e4f0afb8ee9f6">updateUpcomingSGIntersectionIds</a> ()</td></tr>
<tr class="memdesc:ad8d0e8fc5b08ab5f722e4f0afb8ee9f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">populate upcoming_intersection_ids_ from local traffic lanelet ids  <a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ad8d0e8fc5b08ab5f722e4f0afb8ee9f6">More...</a><br /></td></tr>
<tr class="separator:ad8d0e8fc5b08ab5f722e4f0afb8ee9f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a0953785489057b443058b4ed4adb74ec"><td class="memItemLeft" align="right" valign="top">visualization_msgs::msg::MarkerArray&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a0953785489057b443058b4ed4adb74ec">tcm_marker_array_</a></td></tr>
<tr class="separator:a0953785489057b443058b4ed4adb74ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb6d33eb34b7cc277012ddce4274f0d1"><td class="memItemLeft" align="right" valign="top">carma_v2x_msgs::msg::TrafficControlRequestPolygon&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#abb6d33eb34b7cc277012ddce4274f0d1">tcr_polygon_</a></td></tr>
<tr class="separator:abb6d33eb34b7cc277012ddce4274f0d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9976591578b2eb031c24c9f63f9c3051"><td class="memItemLeft" align="right" valign="top">std_msgs::msg::Int32MultiArray&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a9976591578b2eb031c24c9f63f9c3051">upcoming_intersection_ids_</a></td></tr>
<tr class="separator:a9976591578b2eb031c24c9f63f9c3051"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-types" name="pri-types"></a>
Private Types</h2></td></tr>
<tr class="memitem:a4f20a8fa387e6ae0d4db62b8f3207efe"><td class="memItemLeft" align="right" valign="top">enum class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a4f20a8fa387e6ae0d4db62b8f3207efe">AcknowledgementStatus</a> { <a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a4f20a8fa387e6ae0d4db62b8f3207efea7e83ae21b9e9b168f12ba5a90ee82c94">ACKNOWLEDGED</a> = 1
, <a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a4f20a8fa387e6ae0d4db62b8f3207efea9cc8ad3d99798c6726d4af0bd14e49d2">REJECTED</a> = 2
 }</td></tr>
<tr class="separator:a4f20a8fa387e6ae0d4db62b8f3207efe"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-methods" name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:aa7f599cf26d1e2ff6ea7cb943de23071"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aa7f599cf26d1e2ff6ea7cb943de23071">addRegulatoryComponent</a> (std::shared_ptr&lt; <a class="el" href="classcarma__wm__ctrl_1_1Geofence.html">Geofence</a> &gt; gf_ptr) const</td></tr>
<tr class="separator:aa7f599cf26d1e2ff6ea7cb943de23071"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1b3b20607c1fde289b41fc6a51ee88a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#af1b3b20607c1fde289b41fc6a51ee88a">addBackRegulatoryComponent</a> (std::shared_ptr&lt; <a class="el" href="classcarma__wm__ctrl_1_1Geofence.html">Geofence</a> &gt; gf_ptr) const</td></tr>
<tr class="separator:af1b3b20607c1fde289b41fc6a51ee88a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a119e3571ef94545fc979ca3190c5f1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a0a119e3571ef94545fc979ca3190c5f1">removeGeofenceHelper</a> (std::shared_ptr&lt; <a class="el" href="classcarma__wm__ctrl_1_1Geofence.html">Geofence</a> &gt; gf_ptr) const</td></tr>
<tr class="separator:a0a119e3571ef94545fc979ca3190c5f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59dfece11887f76f024c34ef7f6e0f05"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a59dfece11887f76f024c34ef7f6e0f05">addGeofenceHelper</a> (std::shared_ptr&lt; <a class="el" href="classcarma__wm__ctrl_1_1Geofence.html">Geofence</a> &gt; gf_ptr)</td></tr>
<tr class="separator:a59dfece11887f76f024c34ef7f6e0f05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af027533b2d500770301e17520f9e4863"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#af027533b2d500770301e17520f9e4863">shouldChangeControlLine</a> (const lanelet::ConstLaneletOrArea &amp;el, const lanelet::RegulatoryElementConstPtr &amp;regem, std::shared_ptr&lt; <a class="el" href="classcarma__wm__ctrl_1_1Geofence.html">Geofence</a> &gt; gf_ptr) const</td></tr>
<tr class="memdesc:af027533b2d500770301e17520f9e4863"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is a helper function that returns true if the provided regem is marked to be changed by the geofence as there are usually multiple passing control lines are in the lanelet.  <a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#af027533b2d500770301e17520f9e4863">More...</a><br /></td></tr>
<tr class="separator:af027533b2d500770301e17520f9e4863"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13393bf085e59efc687c5d9b407326cf"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a13393bf085e59efc687c5d9b407326cf">shouldChangeTrafficSignal</a> (const lanelet::ConstLaneletOrArea &amp;el, const lanelet::RegulatoryElementConstPtr &amp;regem, std::shared_ptr&lt; <a class="el" href="classcarma__wm_1_1SignalizedIntersectionManager.html">carma_wm::SignalizedIntersectionManager</a> &gt; sim) const</td></tr>
<tr class="memdesc:a13393bf085e59efc687c5d9b407326cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is a helper function that returns true if signal in the lanelet should be changed according to the records of signalizer intersection manager Used in managing multiple signal_groups in a single entry lanelet for example.  <a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a13393bf085e59efc687c5d9b407326cf">More...</a><br /></td></tr>
<tr class="separator:a13393bf085e59efc687c5d9b407326cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74d10f4f0534115f672f8995f0036b49"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a74d10f4f0534115f672f8995f0036b49">addPassingControlLineFromMsg</a> (std::shared_ptr&lt; <a class="el" href="classcarma__wm__ctrl_1_1Geofence.html">Geofence</a> &gt; gf_ptr, const carma_v2x_msgs::msg::TrafficControlMessageV01 &amp;msg_v01, const std::vector&lt; lanelet::Lanelet &gt; &amp;affected_llts) const</td></tr>
<tr class="separator:a74d10f4f0534115f672f8995f0036b49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abea25fd0b879387b68454225ebb0ebc6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#abea25fd0b879387b68454225ebb0ebc6">addScheduleFromMsg</a> (std::shared_ptr&lt; <a class="el" href="classcarma__wm__ctrl_1_1Geofence.html">Geofence</a> &gt; gf_ptr, const carma_v2x_msgs::msg::TrafficControlMessageV01 &amp;msg_v01)</td></tr>
<tr class="memdesc:abea25fd0b879387b68454225ebb0ebc6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Populates the schedules member of the geofence object from given TrafficControlMessageV01 message.  <a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#abea25fd0b879387b68454225ebb0ebc6">More...</a><br /></td></tr>
<tr class="separator:abea25fd0b879387b68454225ebb0ebc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6bfd98359ff2f28688bf7503b43a336"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ab6bfd98359ff2f28688bf7503b43a336">scheduleGeofence</a> (std::shared_ptr&lt; <a class="el" href="classcarma__wm__ctrl_1_1Geofence.html">carma_wm_ctrl::Geofence</a> &gt; gf_ptr_list)</td></tr>
<tr class="separator:ab6bfd98359ff2f28688bf7503b43a336"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef58891043a14a620343f1fc477b8393"><td class="memItemLeft" align="right" valign="top">lanelet::LineString3d&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aef58891043a14a620343f1fc477b8393">createLinearInterpolatingLinestring</a> (const lanelet::Point3d &amp;front_pt, const lanelet::Point3d &amp;back_pt, double increment_distance=0.25)</td></tr>
<tr class="separator:aef58891043a14a620343f1fc477b8393"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07466352083e95712cfed377a61c3bc7"><td class="memItemLeft" align="right" valign="top">lanelet::Lanelet&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a07466352083e95712cfed377a61c3bc7">createLinearInterpolatingLanelet</a> (const lanelet::Point3d &amp;left_front_pt, const lanelet::Point3d &amp;right_front_pt, const lanelet::Point3d &amp;left_back_pt, const lanelet::Point3d &amp;right_back_pt, double increment_distance=0.25)</td></tr>
<tr class="separator:a07466352083e95712cfed377a61c3bc7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67e0f46f02797b84730f04cdcb045568"><td class="memItemLeft" align="right" valign="top">std::unordered_set&lt; lanelet::Lanelet &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a67e0f46f02797b84730f04cdcb045568">filterSuccessorLanelets</a> (const std::unordered_set&lt; lanelet::Lanelet &gt; &amp;possible_lanelets, const std::unordered_set&lt; lanelet::Lanelet &gt; &amp;root_lanelets)</td></tr>
<tr class="separator:a67e0f46f02797b84730f04cdcb045568"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:ab5567570e8a54c507f1c55c23f364933"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ab5567570e8a54c507f1c55c23f364933">error_distance_</a> = 5</td></tr>
<tr class="separator:ab5567570e8a54c507f1c55c23f364933"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60ad34ffaa6843dc3225a95e828c3df8"><td class="memItemLeft" align="right" valign="top">lanelet::ConstLanelets&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a60ad34ffaa6843dc3225a95e828c3df8">route_path_</a></td></tr>
<tr class="separator:a60ad34ffaa6843dc3225a95e828c3df8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f7ae45f954ed5f177756a56b9387545"><td class="memItemLeft" align="right" valign="top">std::unordered_set&lt; lanelet::Id &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a9f7ae45f954ed5f177756a56b9387545">active_geofence_llt_ids_</a></td></tr>
<tr class="separator:a9f7ae45f954ed5f177756a56b9387545"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4610499a06e220327a8eb10cbc18d8de"><td class="memItemLeft" align="right" valign="top">std::unordered_map&lt; uint8_t, std::shared_ptr&lt; <a class="el" href="classcarma__wm__ctrl_1_1Geofence.html">Geofence</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a4610499a06e220327a8eb10cbc18d8de">work_zone_geofence_cache_</a></td></tr>
<tr class="separator:a4610499a06e220327a8eb10cbc18d8de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa03b08ee979d7a4cfd7577280374b97e"><td class="memItemLeft" align="right" valign="top">std::unordered_map&lt; uint32_t, lanelet::Id &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aa03b08ee979d7a4cfd7577280374b97e">traffic_light_id_lookup_</a></td></tr>
<tr class="separator:aa03b08ee979d7a4cfd7577280374b97e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a0a12165535501b0dc4e174f3029642"><td class="memItemLeft" align="right" valign="top">lanelet::LaneletMapPtr&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a3a0a12165535501b0dc4e174f3029642">base_map_</a></td></tr>
<tr class="separator:a3a0a12165535501b0dc4e174f3029642"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a040ca7a37cb8e92574f77401eb80b856"><td class="memItemLeft" align="right" valign="top">lanelet::LaneletMapPtr&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a></td></tr>
<tr class="separator:a040ca7a37cb8e92574f77401eb80b856"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c64c73d83158f9b82682ad3bcc4af74"><td class="memItemLeft" align="right" valign="top">lanelet::routing::RoutingGraphPtr&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a4c64c73d83158f9b82682ad3bcc4af74">current_routing_graph_</a></td></tr>
<tr class="separator:a4c64c73d83158f9b82682ad3bcc4af74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bf605c8ea54b5a03e01d010d6014389"><td class="memItemLeft" align="right" valign="top">lanelet::Velocity&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a4bf605c8ea54b5a03e01d010d6014389">config_limit</a></td></tr>
<tr class="separator:a4bf605c8ea54b5a03e01d010d6014389"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d9fd775035c8389502d5185fa890070"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a9d9fd775035c8389502d5185fa890070">participant_</a> = lanelet::Participants::VehicleCar</td></tr>
<tr class="separator:a9d9fd775035c8389502d5185fa890070"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af032eaea663f829c386e54bef319b09c"><td class="memItemLeft" align="right" valign="top">std::unordered_set&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#af032eaea663f829c386e54bef319b09c">checked_geofence_ids_</a></td></tr>
<tr class="separator:af032eaea663f829c386e54bef319b09c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae21047d8e9e8273c80ae80c4749feee0"><td class="memItemLeft" align="right" valign="top">std::unordered_set&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ae21047d8e9e8273c80ae80c4749feee0">generated_geofence_reqids_</a></td></tr>
<tr class="separator:ae21047d8e9e8273c80ae80c4749feee0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adaf5a7b70e0bf779f638b739e356bb88"><td class="memItemLeft" align="right" valign="top">std::vector&lt; lanelet::LaneletMapPtr &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#adaf5a7b70e0bf779f638b739e356bb88">cached_maps_</a></td></tr>
<tr class="separator:adaf5a7b70e0bf779f638b739e356bb88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ac51e0b0b57eda669c87372bd079ede"><td class="memItemLeft" align="right" valign="top">std::mutex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a1ac51e0b0b57eda669c87372bd079ede">map_mutex_</a></td></tr>
<tr class="separator:a1ac51e0b0b57eda669c87372bd079ede"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa787188a277093da1500213ddcfc67ef"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ad4e8773338ce55f7132025e04d492e23">PublishMapCallback</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aa787188a277093da1500213ddcfc67ef">map_pub_</a></td></tr>
<tr class="separator:aa787188a277093da1500213ddcfc67ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee1d8ad2f6c7865da16ea7f40140b04a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a7ed209093ad1ddb36c00f97951063f8b">PublishMapUpdateCallback</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aee1d8ad2f6c7865da16ea7f40140b04a">map_update_pub_</a></td></tr>
<tr class="separator:aee1d8ad2f6c7865da16ea7f40140b04a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a220595697a17eed6a334c9e858e611f5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#af3784647580aee6501347090b46c3244">PublishCtrlRequestCallback</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a220595697a17eed6a334c9e858e611f5">control_msg_pub_</a></td></tr>
<tr class="separator:a220595697a17eed6a334c9e858e611f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd83bad51ddd9d019add9b8a7de697ae"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a1f39f2021825ba09363d9ee1c456ced6">PublishActiveGeofCallback</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#abd83bad51ddd9d019add9b8a7de697ae">active_pub_</a></td></tr>
<tr class="separator:abd83bad51ddd9d019add9b8a7de697ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbf8a6885fb83de6bdf0241ef3e1401f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classcarma__wm__ctrl_1_1GeofenceScheduler.html">GeofenceScheduler</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#abbf8a6885fb83de6bdf0241ef3e1401f">scheduler_</a></td></tr>
<tr class="separator:abbf8a6885fb83de6bdf0241ef3e1401f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96fcd16e9d674a448e5a46a08c3a3b64"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ac4bb2c122bfd96977dd89b9999a4050d">PublishMobilityOperationCallback</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a96fcd16e9d674a448e5a46a08c3a3b64">tcm_ack_pub_</a></td></tr>
<tr class="separator:a96fcd16e9d674a448e5a46a08c3a3b64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8960147050728c13bb19f8157cd51d25"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a8960147050728c13bb19f8157cd51d25">base_map_georef_</a></td></tr>
<tr class="separator:a8960147050728c13bb19f8157cd51d25"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af150debc195a3c34c9320232a9b9a1eb"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#af150debc195a3c34c9320232a9b9a1eb">max_lane_width_</a></td></tr>
<tr class="separator:af150debc195a3c34c9320232a9b9a1eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09a01dfc3759b71f3040e701c4fe258f"><td class="memItemLeft" align="right" valign="top">std::vector&lt; carma_v2x_msgs::msg::TrafficControlMessageV01 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a09a01dfc3759b71f3040e701c4fe258f">workzone_remaining_msgs_</a></td></tr>
<tr class="separator:a09a01dfc3759b71f3040e701c4fe258f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84bf2071aeab82b686fa8165a5da9830"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a84bf2071aeab82b686fa8165a5da9830">workzone_geometry_published_</a> = false</td></tr>
<tr class="separator:a84bf2071aeab82b686fa8165a5da9830"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab963fffc1b41395dd3393aee9b3e88e4"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ab963fffc1b41395dd3393aee9b3e88e4">current_map_version_</a> = 0</td></tr>
<tr class="separator:ab963fffc1b41395dd3393aee9b3e88e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c67e3708a1f2e191b24bdec5caf2af3"><td class="memItemLeft" align="right" valign="top">carma_planning_msgs::msg::Route&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a2c67e3708a1f2e191b24bdec5caf2af3">current_route</a></td></tr>
<tr class="separator:a2c67e3708a1f2e191b24bdec5caf2af3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23df6022be994abaef6d4dfefa4d0cd4"><td class="memItemLeft" align="right" valign="top">std::vector&lt; autoware_lanelet2_msgs::msg::MapBin &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a23df6022be994abaef6d4dfefa4d0cd4">map_update_message_queue_</a></td></tr>
<tr class="separator:a23df6022be994abaef6d4dfefa4d0cd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a644d3ebd9dd0e50b9152e965fd9f0721"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a644d3ebd9dd0e50b9152e965fd9f0721">update_count_</a> = -1</td></tr>
<tr class="separator:a644d3ebd9dd0e50b9152e965fd9f0721"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa26bb2f41f25b523fd2a98010af60cb0"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="classcarma__wm_1_1SignalizedIntersectionManager.html">carma_wm::SignalizedIntersectionManager</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aa26bb2f41f25b523fd2a98010af60cb0">sim_</a></td></tr>
<tr class="separator:aa26bb2f41f25b523fd2a98010af60cb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a229cd9488710003a3f7da5be95ce9f4f"><td class="memItemLeft" align="right" valign="top">const std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a229cd9488710003a3f7da5be95ce9f4f">geofence_ack_strategy_</a> = &quot;carma3/Geofence_Acknowledgement&quot;</td></tr>
<tr class="separator:a229cd9488710003a3f7da5be95ce9f4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19e428bc63bdb7eef768738e08af92ac"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a19e428bc63bdb7eef768738e08af92ac">ack_pub_times_</a> = 1</td></tr>
<tr class="separator:a19e428bc63bdb7eef768738e08af92ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac34bbb28c302480f2876f0946105cbd6"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ac34bbb28c302480f2876f0946105cbd6">vehicle_id_</a></td></tr>
<tr class="separator:ac34bbb28c302480f2876f0946105cbd6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Class which provies exposes map publication and <a class="el" href="namespacecarma__wm.html">carma_wm</a> update logic. </p>
<p >The <a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html" title="Class which provies exposes map publication and carma_wm update logic.">WMBroadcaster</a> handles updating the lanelet2 base map and publishing the new versions to the rest of the CARMA Platform ROS network. The broadcaster also provides functions for adding or removing geofences from the map and notifying the rest of the system. </p>

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8hpp_source.html#l00072">72</a> of file <a class="el" href="WMBroadcaster_8hpp_source.html">WMBroadcaster.hpp</a>.</p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a id="a1f39f2021825ba09363d9ee1c456ced6" name="a1f39f2021825ba09363d9ee1c456ced6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f39f2021825ba09363d9ee1c456ced6">&#9670;&nbsp;</a></span>PublishActiveGeofCallback</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a1f39f2021825ba09363d9ee1c456ced6">carma_wm_ctrl::WMBroadcaster::PublishActiveGeofCallback</a> =  std::function&lt;void(const carma_perception_msgs::msg::CheckActiveGeofence&amp;)&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8hpp_source.html#l00078">78</a> of file <a class="el" href="WMBroadcaster_8hpp_source.html">WMBroadcaster.hpp</a>.</p>

</div>
</div>
<a id="af3784647580aee6501347090b46c3244" name="af3784647580aee6501347090b46c3244"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3784647580aee6501347090b46c3244">&#9670;&nbsp;</a></span>PublishCtrlRequestCallback</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#af3784647580aee6501347090b46c3244">carma_wm_ctrl::WMBroadcaster::PublishCtrlRequestCallback</a> =  std::function&lt;void(const carma_v2x_msgs::msg::TrafficControlRequest&amp;)&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8hpp_source.html#l00077">77</a> of file <a class="el" href="WMBroadcaster_8hpp_source.html">WMBroadcaster.hpp</a>.</p>

</div>
</div>
<a id="ad4e8773338ce55f7132025e04d492e23" name="ad4e8773338ce55f7132025e04d492e23"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4e8773338ce55f7132025e04d492e23">&#9670;&nbsp;</a></span>PublishMapCallback</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ad4e8773338ce55f7132025e04d492e23">carma_wm_ctrl::WMBroadcaster::PublishMapCallback</a> =  std::function&lt;void(const autoware_lanelet2_msgs::msg::MapBin&amp;)&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8hpp_source.html#l00075">75</a> of file <a class="el" href="WMBroadcaster_8hpp_source.html">WMBroadcaster.hpp</a>.</p>

</div>
</div>
<a id="a7ed209093ad1ddb36c00f97951063f8b" name="a7ed209093ad1ddb36c00f97951063f8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ed209093ad1ddb36c00f97951063f8b">&#9670;&nbsp;</a></span>PublishMapUpdateCallback</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a7ed209093ad1ddb36c00f97951063f8b">carma_wm_ctrl::WMBroadcaster::PublishMapUpdateCallback</a> =  std::function&lt;void(const autoware_lanelet2_msgs::msg::MapBin&amp;)&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8hpp_source.html#l00076">76</a> of file <a class="el" href="WMBroadcaster_8hpp_source.html">WMBroadcaster.hpp</a>.</p>

</div>
</div>
<a id="ac4bb2c122bfd96977dd89b9999a4050d" name="ac4bb2c122bfd96977dd89b9999a4050d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4bb2c122bfd96977dd89b9999a4050d">&#9670;&nbsp;</a></span>PublishMobilityOperationCallback</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ac4bb2c122bfd96977dd89b9999a4050d">carma_wm_ctrl::WMBroadcaster::PublishMobilityOperationCallback</a> =  std::function&lt;void(const carma_v2x_msgs::msg::MobilityOperation&amp;)&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8hpp_source.html#l00079">79</a> of file <a class="el" href="WMBroadcaster_8hpp_source.html">WMBroadcaster.hpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Enumeration Documentation</h2>
<a id="a4f20a8fa387e6ae0d4db62b8f3207efe" name="a4f20a8fa387e6ae0d4db62b8f3207efe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f20a8fa387e6ae0d4db62b8f3207efe">&#9670;&nbsp;</a></span>AcknowledgementStatus</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">enum class <a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a4f20a8fa387e6ae0d4db62b8f3207efe">carma_wm_ctrl::WMBroadcaster::AcknowledgementStatus</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">strong</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a4f20a8fa387e6ae0d4db62b8f3207efea7e83ae21b9e9b168f12ba5a90ee82c94" name="a4f20a8fa387e6ae0d4db62b8f3207efea7e83ae21b9e9b168f12ba5a90ee82c94"></a>ACKNOWLEDGED&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a4f20a8fa387e6ae0d4db62b8f3207efea9cc8ad3d99798c6726d4af0bd14e49d2" name="a4f20a8fa387e6ae0d4db62b8f3207efea9cc8ad3d99798c6726d4af0bd14e49d2"></a>REJECTED&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8hpp_source.html#l00465">465</a> of file <a class="el" href="WMBroadcaster_8hpp_source.html">WMBroadcaster.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  465</span>                                   {</div>
<div class="line"><span class="lineno">  466</span>    ACKNOWLEDGED = 1,</div>
<div class="line"><span class="lineno">  467</span>    REJECTED = 2</div>
<div class="line"><span class="lineno">  468</span>  };</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a95cb7c60682d7b455a8624534ad94706" name="a95cb7c60682d7b455a8624534ad94706"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95cb7c60682d7b455a8624534ad94706">&#9670;&nbsp;</a></span>WMBroadcaster()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">carma_wm_ctrl::WMBroadcaster::WMBroadcaster </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ad4e8773338ce55f7132025e04d492e23">PublishMapCallback</a> &amp;&#160;</td>
          <td class="paramname"><em>map_pub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a7ed209093ad1ddb36c00f97951063f8b">PublishMapUpdateCallback</a> &amp;&#160;</td>
          <td class="paramname"><em>map_update_pub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#af3784647580aee6501347090b46c3244">PublishCtrlRequestCallback</a> &amp;&#160;</td>
          <td class="paramname"><em>control_msg_pub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a1f39f2021825ba09363d9ee1c456ced6">PublishActiveGeofCallback</a> &amp;&#160;</td>
          <td class="paramname"><em>active_pub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::shared_ptr&lt; carma_ros2_utils::timers::TimerFactory &gt;&#160;</td>
          <td class="paramname"><em>timer_factory</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ac4bb2c122bfd96977dd89b9999a4050d">PublishMobilityOperationCallback</a> &amp;&#160;</td>
          <td class="paramname"><em>tcm_ack_pub</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8cpp_source.html#l00047">47</a> of file <a class="el" href="WMBroadcaster_8cpp_source.html">WMBroadcaster.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   49</span>  : <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aa787188a277093da1500213ddcfc67ef">map_pub_</a>(map_pub), <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aee1d8ad2f6c7865da16ea7f40140b04a">map_update_pub_</a>(map_update_pub), <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a220595697a17eed6a334c9e858e611f5">control_msg_pub_</a>(control_msg_pub), <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#abd83bad51ddd9d019add9b8a7de697ae">active_pub_</a>(active_pub), <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#abbf8a6885fb83de6bdf0241ef3e1401f">scheduler_</a>(timer_factory), <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a96fcd16e9d674a448e5a46a08c3a3b64">tcm_ack_pub_</a>(tcm_ack_pub)</div>
<div class="line"><span class="lineno">   50</span>{</div>
<div class="line"><span class="lineno">   51</span>  <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#abbf8a6885fb83de6bdf0241ef3e1401f">scheduler_</a>.<a class="code hl_function" href="classcarma__wm__ctrl_1_1GeofenceScheduler.html#a0c5d51c65cfe9cc7f51ff51b1b5efe9e">onGeofenceActive</a>(std::bind(&amp;<a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a649174a7a7270df95532cad5131bf4cb">WMBroadcaster::addGeofence</a>, <span class="keyword">this</span>, _1));</div>
<div class="line"><span class="lineno">   52</span>  <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#abbf8a6885fb83de6bdf0241ef3e1401f">scheduler_</a>.<a class="code hl_function" href="classcarma__wm__ctrl_1_1GeofenceScheduler.html#ab7a29ddc80e0d8b4c2551ab8eac55dfb">onGeofenceInactive</a>(std::bind(&amp;<a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a3751e2e2dc4455fc7e3e80f1ae2c672e">WMBroadcaster::removeGeofence</a>, <span class="keyword">this</span>, _1));</div>
<div class="line"><span class="lineno">   53</span>  std::bind(&amp;<a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a7efa8028648e4ed8b847c97e952b07d1">WMBroadcaster::routeCallbackMessage</a>, <span class="keyword">this</span>, _1);</div>
<div class="line"><span class="lineno">   54</span>};</div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1GeofenceScheduler_html_a0c5d51c65cfe9cc7f51ff51b1b5efe9e"><div class="ttname"><a href="classcarma__wm__ctrl_1_1GeofenceScheduler.html#a0c5d51c65cfe9cc7f51ff51b1b5efe9e">carma_wm_ctrl::GeofenceScheduler::onGeofenceActive</a></div><div class="ttdeci">void onGeofenceActive(std::function&lt; void(std::shared_ptr&lt; Geofence &gt;)&gt; active_callback)</div><div class="ttdoc">Method which allows the user to set a callback which will be triggered when a geofence becomes active...</div><div class="ttdef"><b>Definition:</b> <a href="GeofenceScheduler_8cpp_source.html#l00169">GeofenceScheduler.cpp:169</a></div></div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1GeofenceScheduler_html_ab7a29ddc80e0d8b4c2551ab8eac55dfb"><div class="ttname"><a href="classcarma__wm__ctrl_1_1GeofenceScheduler.html#ab7a29ddc80e0d8b4c2551ab8eac55dfb">carma_wm_ctrl::GeofenceScheduler::onGeofenceInactive</a></div><div class="ttdeci">void onGeofenceInactive(std::function&lt; void(std::shared_ptr&lt; Geofence &gt;)&gt; inactive_callback)</div><div class="ttdoc">Method which allows the user to set a callback which will be triggered when a geofence becomes in-act...</div><div class="ttdef"><b>Definition:</b> <a href="GeofenceScheduler_8cpp_source.html#l00175">GeofenceScheduler.cpp:175</a></div></div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_a220595697a17eed6a334c9e858e611f5"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a220595697a17eed6a334c9e858e611f5">carma_wm_ctrl::WMBroadcaster::control_msg_pub_</a></div><div class="ttdeci">PublishCtrlRequestCallback control_msg_pub_</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8hpp_source.html#l00439">WMBroadcaster.hpp:439</a></div></div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_a3751e2e2dc4455fc7e3e80f1ae2c672e"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a3751e2e2dc4455fc7e3e80f1ae2c672e">carma_wm_ctrl::WMBroadcaster::removeGeofence</a></div><div class="ttdeci">void removeGeofence(std::shared_ptr&lt; Geofence &gt; gf_ptr)</div><div class="ttdoc">Removes a geofence from the current map and publishes the ROS msg.</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8cpp_source.html#l01578">WMBroadcaster.cpp:1578</a></div></div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_a649174a7a7270df95532cad5131bf4cb"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a649174a7a7270df95532cad5131bf4cb">carma_wm_ctrl::WMBroadcaster::addGeofence</a></div><div class="ttdeci">void addGeofence(std::shared_ptr&lt; Geofence &gt; gf_ptr)</div><div class="ttdoc">Adds a geofence to the current map and publishes the ROS msg.</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8cpp_source.html#l01488">WMBroadcaster.cpp:1488</a></div></div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_a7efa8028648e4ed8b847c97e952b07d1"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a7efa8028648e4ed8b847c97e952b07d1">carma_wm_ctrl::WMBroadcaster::routeCallbackMessage</a></div><div class="ttdeci">void routeCallbackMessage(carma_planning_msgs::msg::Route::UniquePtr route_msg)</div><div class="ttdoc">Calls controlRequestFromRoute() and publishes the TrafficControlRequest Message returned after the co...</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8cpp_source.html#l01632">WMBroadcaster.cpp:1632</a></div></div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_a96fcd16e9d674a448e5a46a08c3a3b64"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a96fcd16e9d674a448e5a46a08c3a3b64">carma_wm_ctrl::WMBroadcaster::tcm_ack_pub_</a></div><div class="ttdeci">PublishMobilityOperationCallback tcm_ack_pub_</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8hpp_source.html#l00442">WMBroadcaster.hpp:442</a></div></div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_aa787188a277093da1500213ddcfc67ef"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aa787188a277093da1500213ddcfc67ef">carma_wm_ctrl::WMBroadcaster::map_pub_</a></div><div class="ttdeci">PublishMapCallback map_pub_</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8hpp_source.html#l00437">WMBroadcaster.hpp:437</a></div></div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_abbf8a6885fb83de6bdf0241ef3e1401f"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#abbf8a6885fb83de6bdf0241ef3e1401f">carma_wm_ctrl::WMBroadcaster::scheduler_</a></div><div class="ttdeci">GeofenceScheduler scheduler_</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8hpp_source.html#l00441">WMBroadcaster.hpp:441</a></div></div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_abd83bad51ddd9d019add9b8a7de697ae"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#abd83bad51ddd9d019add9b8a7de697ae">carma_wm_ctrl::WMBroadcaster::active_pub_</a></div><div class="ttdeci">PublishActiveGeofCallback active_pub_</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8hpp_source.html#l00440">WMBroadcaster.hpp:440</a></div></div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_aee1d8ad2f6c7865da16ea7f40140b04a"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aee1d8ad2f6c7865da16ea7f40140b04a">carma_wm_ctrl::WMBroadcaster::map_update_pub_</a></div><div class="ttdeci">PublishMapUpdateCallback map_update_pub_</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8hpp_source.html#l00438">WMBroadcaster.hpp:438</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMBroadcaster_8cpp_source.html#l01488">addGeofence()</a>, <a class="el" href="GeofenceScheduler_8cpp_source.html#l00169">carma_wm_ctrl::GeofenceScheduler::onGeofenceActive()</a>, <a class="el" href="GeofenceScheduler_8cpp_source.html#l00175">carma_wm_ctrl::GeofenceScheduler::onGeofenceInactive()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l01578">removeGeofence()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l01632">routeCallbackMessage()</a>, and <a class="el" href="WMBroadcaster_8hpp_source.html#l00441">scheduler_</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_a95cb7c60682d7b455a8624534ad94706_cgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_a95cb7c60682d7b455a8624534ad94706_cgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_a95cb7c60682d7b455a8624534ad94706_cgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_a95cb7c60682d7b455a8624534ad94706_cgraph">
<area shape="rect" title="Constructor." alt="" coords="5,585,216,627"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a649174a7a7270df95532cad5131bf4cb" title="Adds a geofence to the current map and publishes the ROS msg." alt="" coords="274,520,485,561"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1GeofenceScheduler.html#a0c5d51c65cfe9cc7f51ff51b1b5efe9e" title="Method which allows the user to set a callback which will be triggered when a geofence becomes active..." alt="" coords="264,651,495,692"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1GeofenceScheduler.html#ab7a29ddc80e0d8b4c2551ab8eac55dfb" title="Method which allows the user to set a callback which will be triggered when a geofence becomes in&#45;act..." alt="" coords="264,716,495,757"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a3751e2e2dc4455fc7e3e80f1ae2c672e" title="Removes a geofence from the current map and publishes the ROS msg." alt="" coords="274,377,485,419"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a7efa8028648e4ed8b847c97e952b07d1" title="Calls controlRequestFromRoute() and publishes the TrafficControlRequest Message returned after the co..." alt="" coords="274,585,485,627"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a59dfece11887f76f024c34ef7f6e0f05" title=" " alt="" coords="543,487,753,528"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a2493db4c5843a143c61cd27b0489ca7a" title="composeTCMMarkerVisualizer() compose TCM Marker visualization" alt="" coords="543,683,753,724"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a5ae3f2086831ebd932e19b2bdfd76405" title="Creates a single workzone geofence (in the vector) that includes all additional lanelets (housing tra..." alt="" coords="543,552,753,593"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aac72e7333f997bfe19547a235f389c07" title="Fills geofence object from MAP Data ROS Msg which contains intersections&#39; static data such as geometr..." alt="" coords="543,617,753,659"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#af0e373523dc84a409331d01b62d2fce0" title="Fills geofence object from TrafficControlMessageV01 ROS Msg." alt="" coords="801,201,1012,243"/>
<area shape="rect" href="namespacecarma__wm.html#aef665263f7df5afa3781f4319fe95e9c" title=" " alt="" coords="575,385,721,411"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aa7f599cf26d1e2ff6ea7cb943de23071" title=" " alt="" coords="801,384,1012,425"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#af027533b2d500770301e17520f9e4863" title="This is a helper function that returns true if the provided regem is marked to be changed by the geof..." alt="" coords="1063,319,1274,360"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a13393bf085e59efc687c5d9b407326cf" title="This is a helper function that returns true if signal in the lanelet should be changed according to t..." alt="" coords="1063,384,1274,425"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a12708b289f7f3d8f10c6dc749bf14d65" title="Create workzone geofence. Create diagonal lanelets and a lanelet that houses opposing lane&#39;s trafficl..." alt="" coords="801,552,1012,593"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#adc221f65f0b99586fc8c2ffc97c5feea" title="Preprocess for workzone area. Parallel_llts will have front_parallel and back_parallel lanelets that ..." alt="" coords="801,711,1012,752"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ae34565da1566e777745a92161422404c" title="Adds RegionAccessRule to the map." alt="" coords="1063,449,1274,491"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a07466352083e95712cfed377a61c3bc7" title=" " alt="" coords="1061,515,1276,556"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#adfb94b051e74a67830c1795e32081cbc" title="helper for generating 32bit traffic light Id from TCM label field consisting workzone intersection/si..." alt="" coords="1063,580,1274,621"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a264607b6ec5b20d8971f8dc14a4b1825" title="Split given lanelet&#39;s adjacent, OPPOSITE lanelet with same proportion as the given point&#39;s downtrack ..." alt="" coords="1063,645,1274,687"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ac71c9fdbf27cbfbe3988c3a77d6e7067" title="Generates inverse participants list of the given participants." alt="" coords="1335,361,1546,403"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aa326eab73fe1583c1fa937ed2e38b33f" title="Generates participants list." alt="" coords="1335,231,1546,272"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a2c6c3606e5f4b3c12a984261823c1d71" title="Combines a list of the given participants into a single &quot;vehicle&quot; type if participants cover all poss..." alt="" coords="1606,231,1817,272"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aef58891043a14a620343f1fc477b8393" title=" " alt="" coords="1327,427,1555,468"/>
<area shape="rect" href="namespacecarma__wm_1_1utils.html#a5f9cfb53df6903542a0cb9bf2f8a7d7c" title="Get 32bit id by concatenating 16bit id with 8bit signal_group_id." alt="" coords="1350,493,1531,519"/>
<area shape="rect" href="namespacecarma__wm_1_1query.html#a9fb50939b2ae576d2eb7fcfc42fcdc22" title="Given the cartesian point on the map, tries to get the opposite direction lanelet on the left This fu..." alt="" coords="1335,645,1547,687"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#aebce986f21c117983313292d5e82b50a" title="Returns the TrackPos, computed in 2d, of the provided point relative to the centerline of the provide..." alt="" coords="1639,557,1784,599"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a1dfc2ec5be906966916939c75874cbab" title="Split given lanelet with given downtrack ratios relative to the lanelet. Newly created lanelet will h..." alt="" coords="1335,711,1546,752"/>
<area shape="rect" href="namespacecarma__wm_1_1query.html#a8933b74d652e02d07be1170b787d87a2" title="carma_wm::query namespace contains implementations for query functions (input and output read or writ..." alt="" coords="1613,688,1810,729"/>
<area shape="rect" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5" title=" " alt="" coords="1612,820,1811,861"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#ab675b2b8862a2ba9c139a8b5b353b846" title="Get the TrackPos of the provided point along the linestring and the segment of the line string which ..." alt="" coords="1867,557,2012,599"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#ae0a06818149f7430fee80e295ef04548" title="Helper function to identify whether to select the preceeding or succeeding segment of a linstring poi..." alt="" coords="2060,557,2205,599"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a883734808f44db2778371ce3fbeecdd3" title="Split given lanelet with same proportion as the given points&#39; downtrack relative to the lanelet...." alt="" coords="1063,711,1274,752"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a74d10f4f0534115f672f8995f0036b49" title=" " alt="" coords="1060,136,1277,177"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a116928c0070cfa7587c219a6629dadb8" title="Adds Minimum Gap to the map." alt="" coords="1063,201,1274,243"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a1327952ca44a5e817b0498f93f6143ac" title="Gets the affected lanelet or areas based on the points in local frame." alt="" coords="1063,5,1274,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a44fed247724b501a968aec27479ed58d" title="Extract geofence points from geofence message using its given proj and datum fields." alt="" coords="1063,71,1274,112"/>
<area shape="rect" href="namespacecarma__wm_1_1query.html#a9c9935e22582f37c01441115bce72f58" title="Gets the affected lanelet or areas based on the points in the given map&#39;s frame." alt="" coords="1343,85,1538,127"/>
<area shape="rect" href="namespacecarma__wm_1_1query.html#a382665a2ddc42be06fca9c1f8dfd0489" title="A function that filters successor lanelets of root_lanelets from possible_lanelets." alt="" coords="1604,53,1819,95"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#abab7ba4e773f03d6cfc09492742c6b7b" title="Calculates the angle between two vectors." alt="" coords="1624,119,1799,160"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#a50c966bd5e6ed00ea0b1a70e93cd0d4a" title="acos method that caps the input x value for 1 or &#45;1 to avoid undefined output. This is meant to preve..." alt="" coords="1867,119,2012,160"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a0a119e3571ef94545fc979ca3190c5f1" title=" " alt="" coords="543,319,753,360"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#af1b3b20607c1fde289b41fc6a51ee88a" title=" " alt="" coords="801,319,1012,360"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a0fcc6904e5b3fb2fca13e9488069ec10" title="Pulls vehicle information from CARMA Cloud at startup by providing its selected route in a TrafficCon..." alt="" coords="1063,853,1274,895"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a8c72c6fdeb1568b078bf6131c906b377" title="composeTCRStatus() compose TCM Request visualization on UI" alt="" coords="1335,944,1546,985"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1GeofenceScheduler.html#a2fecf322a302aff00ce8d76b0965e02e" title="Get the clock type of the clock being created by the timer factory." alt="" coords="1325,879,1556,920"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="af1b3b20607c1fde289b41fc6a51ee88a" name="af1b3b20607c1fde289b41fc6a51ee88a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1b3b20607c1fde289b41fc6a51ee88a">&#9670;&nbsp;</a></span>addBackRegulatoryComponent()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void carma_wm_ctrl::WMBroadcaster::addBackRegulatoryComponent </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classcarma__wm__ctrl_1_1Geofence.html">Geofence</a> &gt;&#160;</td>
          <td class="paramname"><em>gf_ptr</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8cpp_source.html#l01457">1457</a> of file <a class="el" href="WMBroadcaster_8cpp_source.html">WMBroadcaster.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1458</span>{</div>
<div class="line"><span class="lineno"> 1459</span>  <span class="comment">// First loop is to remove the relation between element and regulatory element that this geofence added initially</span></div>
<div class="line"><span class="lineno"> 1460</span>  </div>
<div class="line"><span class="lineno"> 1461</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> el: gf_ptr-&gt;affected_parts_)</div>
<div class="line"><span class="lineno"> 1462</span>  {</div>
<div class="line"><span class="lineno"> 1463</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> regem : el.regulatoryElements())</div>
<div class="line"><span class="lineno"> 1464</span>    {</div>
<div class="line"><span class="lineno"> 1465</span>      <span class="keywordflow">if</span> (!<a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#af027533b2d500770301e17520f9e4863">shouldChangeControlLine</a>(el, regem, gf_ptr)) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1466</span> </div>
<div class="line"><span class="lineno"> 1467</span>      <span class="keywordflow">if</span> (regem-&gt;attribute(lanelet::AttributeName::Subtype).value() ==  gf_ptr-&gt;regulatory_element_-&gt;attribute(lanelet::AttributeName::Subtype).value())</div>
<div class="line"><span class="lineno"> 1468</span>      {</div>
<div class="line"><span class="lineno"> 1469</span>        <span class="keyword">auto</span> nonconst_regem = <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;regulatoryElementLayer.get(regem-&gt;id());</div>
<div class="line"><span class="lineno"> 1470</span>        gf_ptr-&gt;remove_list_.push_back(std::make_pair(el.id(), nonconst_regem));</div>
<div class="line"><span class="lineno"> 1471</span>        <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;remove(<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;laneletLayer.get(el.lanelet()-&gt;id()), nonconst_regem);</div>
<div class="line"><span class="lineno"> 1472</span>      }</div>
<div class="line"><span class="lineno"> 1473</span>    }</div>
<div class="line"><span class="lineno"> 1474</span>  }</div>
<div class="line"><span class="lineno"> 1475</span>  </div>
<div class="line"><span class="lineno"> 1476</span>  <span class="comment">// As this gf received is the first gf that was sent in through addGeofence,</span></div>
<div class="line"><span class="lineno"> 1477</span>  <span class="comment">// we have prev speed limit information inside it to put them back</span></div>
<div class="line"><span class="lineno"> 1478</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> pair : gf_ptr-&gt;prev_regems_)</div>
<div class="line"><span class="lineno"> 1479</span>  {</div>
<div class="line"><span class="lineno"> 1480</span>    <span class="keywordflow">if</span> (pair.second-&gt;attribute(lanelet::AttributeName::Subtype).value() ==  gf_ptr-&gt;regulatory_element_-&gt;attribute(lanelet::AttributeName::Subtype).value())</div>
<div class="line"><span class="lineno"> 1481</span>    {</div>
<div class="line"><span class="lineno"> 1482</span>      <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;update(<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;laneletLayer.get(pair.first), pair.second);</div>
<div class="line"><span class="lineno"> 1483</span>      gf_ptr-&gt;update_list_.push_back(pair);</div>
<div class="line"><span class="lineno"> 1484</span>    } </div>
<div class="line"><span class="lineno"> 1485</span>  }</div>
<div class="line"><span class="lineno"> 1486</span>}</div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_a040ca7a37cb8e92574f77401eb80b856"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">carma_wm_ctrl::WMBroadcaster::current_map_</a></div><div class="ttdeci">lanelet::LaneletMapPtr current_map_</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8hpp_source.html#l00429">WMBroadcaster.hpp:429</a></div></div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_af027533b2d500770301e17520f9e4863"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#af027533b2d500770301e17520f9e4863">carma_wm_ctrl::WMBroadcaster::shouldChangeControlLine</a></div><div class="ttdeci">bool shouldChangeControlLine(const lanelet::ConstLaneletOrArea &amp;el, const lanelet::RegulatoryElementConstPtr &amp;regem, std::shared_ptr&lt; Geofence &gt; gf_ptr) const</div><div class="ttdoc">This is a helper function that returns true if the provided regem is marked to be changed by the geof...</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8cpp_source.html#l01357">WMBroadcaster.cpp:1357</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMBroadcaster_8hpp_source.html#l00429">current_map_</a>, and <a class="el" href="WMBroadcaster_8cpp_source.html#l01357">shouldChangeControlLine()</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l01935">removeGeofenceHelper()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_af1b3b20607c1fde289b41fc6a51ee88a_cgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_af1b3b20607c1fde289b41fc6a51ee88a_cgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_af1b3b20607c1fde289b41fc6a51ee88a_cgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_af1b3b20607c1fde289b41fc6a51ee88a_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,216,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#af027533b2d500770301e17520f9e4863" title="This is a helper function that returns true if the provided regem is marked to be changed by the geof..." alt="" coords="264,5,475,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_af1b3b20607c1fde289b41fc6a51ee88a_icgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_af1b3b20607c1fde289b41fc6a51ee88a_icgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_af1b3b20607c1fde289b41fc6a51ee88a_icgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_af1b3b20607c1fde289b41fc6a51ee88a_icgraph">
<area shape="rect" title=" " alt="" coords="781,5,992,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a0a119e3571ef94545fc979ca3190c5f1" title=" " alt="" coords="523,5,733,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a3751e2e2dc4455fc7e3e80f1ae2c672e" title="Removes a geofence from the current map and publishes the ROS msg." alt="" coords="264,5,475,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a95cb7c60682d7b455a8624534ad94706" title="Constructor." alt="" coords="5,5,216,47"/>
</map>
</div>

</div>
</div>
<a id="a649174a7a7270df95532cad5131bf4cb" name="a649174a7a7270df95532cad5131bf4cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a649174a7a7270df95532cad5131bf4cb">&#9670;&nbsp;</a></span>addGeofence()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void carma_wm_ctrl::WMBroadcaster::addGeofence </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classcarma__wm__ctrl_1_1Geofence.html">Geofence</a> &gt;&#160;</td>
          <td class="paramname"><em>gf_ptr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds a geofence to the current map and publishes the ROS msg. </p>

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8cpp_source.html#l01488">1488</a> of file <a class="el" href="WMBroadcaster_8cpp_source.html">WMBroadcaster.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1489</span>{</div>
<div class="line"><span class="lineno"> 1490</span>   </div>
<div class="line"><span class="lineno"> 1491</span>  std::lock_guard&lt;std::mutex&gt; guard(<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a1ac51e0b0b57eda669c87372bd079ede">map_mutex_</a>);</div>
<div class="line"><span class="lineno"> 1492</span>  RCLCPP_INFO_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Adding active geofence to the map with geofence id: &quot;</span> &lt;&lt; gf_ptr-&gt;id_);</div>
<div class="line"><span class="lineno"> 1493</span>  </div>
<div class="line"><span class="lineno"> 1494</span>  <span class="comment">// if applying workzone geometry geofence, utilize workzone chache to create one </span></div>
<div class="line"><span class="lineno"> 1495</span>  <span class="comment">// also multiple map updates can be sent from one geofence object</span></div>
<div class="line"><span class="lineno"> 1496</span>  std::vector&lt;std::shared_ptr&lt;Geofence&gt;&gt; updates_to_send;</div>
<div class="line"><span class="lineno"> 1497</span> </div>
<div class="line"><span class="lineno"> 1498</span>  <span class="keywordtype">bool</span> detected_workzone_signal = gf_ptr-&gt;msg_.package.label_exists &amp;&amp; gf_ptr-&gt;msg_.package.label.find(<span class="stringliteral">&quot;SIG_WZ&quot;</span>) != std::string::npos;</div>
<div class="line"><span class="lineno"> 1499</span>  <span class="keywordtype">bool</span> detected_map_msg_signal = gf_ptr-&gt;msg_.package.label_exists &amp;&amp; gf_ptr-&gt;msg_.package.label.find(<span class="stringliteral">&quot;MAP_MSG&quot;</span>) != std::string::npos;</div>
<div class="line"><span class="lineno"> 1500</span>  <span class="keywordflow">if</span> (detected_workzone_signal &amp;&amp; gf_ptr-&gt;msg_.params.detail.choice != carma_v2x_msgs::msg::TrafficControlDetail::MAXSPEED_CHOICE)</div>
<div class="line"><span class="lineno"> 1501</span>  {</div>
<div class="line"><span class="lineno"> 1502</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> gf_cache_ptr : <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a4610499a06e220327a8eb10cbc18d8de">work_zone_geofence_cache_</a>)</div>
<div class="line"><span class="lineno"> 1503</span>    {</div>
<div class="line"><span class="lineno"> 1504</span>      <a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#af0e373523dc84a409331d01b62d2fce0">geofenceFromMsg</a>(gf_cache_ptr.second, gf_cache_ptr.second-&gt;msg_);</div>
<div class="line"><span class="lineno"> 1505</span>    }</div>
<div class="line"><span class="lineno"> 1506</span>    updates_to_send.push_back(<a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a5ae3f2086831ebd932e19b2bdfd76405">createWorkzoneGeofence</a>(<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a4610499a06e220327a8eb10cbc18d8de">work_zone_geofence_cache_</a>));</div>
<div class="line"><span class="lineno"> 1507</span>  }</div>
<div class="line"><span class="lineno"> 1508</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (detected_map_msg_signal)</div>
<div class="line"><span class="lineno"> 1509</span>  {</div>
<div class="line"><span class="lineno"> 1510</span>    updates_to_send = <a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aac72e7333f997bfe19547a235f389c07">geofenceFromMapMsg</a>(gf_ptr, gf_ptr-&gt;map_msg_);</div>
<div class="line"><span class="lineno"> 1511</span>  }</div>
<div class="line"><span class="lineno"> 1512</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1513</span>  {</div>
<div class="line"><span class="lineno"> 1514</span>    <a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#af0e373523dc84a409331d01b62d2fce0">geofenceFromMsg</a>(gf_ptr, gf_ptr-&gt;msg_);</div>
<div class="line"><span class="lineno"> 1515</span>    updates_to_send.push_back(gf_ptr);</div>
<div class="line"><span class="lineno"> 1516</span>  }</div>
<div class="line"><span class="lineno"> 1517</span> </div>
<div class="line"><span class="lineno"> 1518</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> update : updates_to_send)</div>
<div class="line"><span class="lineno"> 1519</span>  {    </div>
<div class="line"><span class="lineno"> 1520</span>    <span class="comment">// add marker to rviz</span></div>
<div class="line"><span class="lineno"> 1521</span>    <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a0953785489057b443058b4ed4adb74ec">tcm_marker_array_</a>.markers.push_back(<a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a2493db4c5843a143c61cd27b0489ca7a">composeTCMMarkerVisualizer</a>(update-&gt;gf_pts)); <span class="comment">// create visualizer in rviz</span></div>
<div class="line"><span class="lineno"> 1522</span> </div>
<div class="line"><span class="lineno"> 1523</span>    <span class="keywordflow">if</span> (update-&gt;affected_parts_.empty())</div>
<div class="line"><span class="lineno"> 1524</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1525</span> </div>
<div class="line"><span class="lineno"> 1526</span>    <span class="comment">// Process the geofence object to populate update remove lists</span></div>
<div class="line"><span class="lineno"> 1527</span>    <a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a59dfece11887f76f024c34ef7f6e0f05">addGeofenceHelper</a>(update);</div>
<div class="line"><span class="lineno"> 1528</span>    </div>
<div class="line"><span class="lineno"> 1529</span>    <span class="keywordflow">if</span> (!detected_map_msg_signal)</div>
<div class="line"><span class="lineno"> 1530</span>    {</div>
<div class="line"><span class="lineno"> 1531</span>      <span class="keywordflow">for</span> (<span class="keyword">auto</span> pair : update-&gt;update_list_) <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a9f7ae45f954ed5f177756a56b9387545">active_geofence_llt_ids_</a>.insert(pair.first);</div>
<div class="line"><span class="lineno"> 1532</span>    }</div>
<div class="line"><span class="lineno"> 1533</span> </div>
<div class="line"><span class="lineno"> 1534</span>    autoware_lanelet2_msgs::msg::MapBin gf_msg;</div>
<div class="line"><span class="lineno"> 1535</span>    </div>
<div class="line"><span class="lineno"> 1536</span>    <span class="comment">// If the geofence invalidates the route graph then recompute the routing graph now that the map has been updated</span></div>
<div class="line"><span class="lineno"> 1537</span>    <span class="keywordflow">if</span> (update-&gt;invalidate_route_) {</div>
<div class="line"><span class="lineno"> 1538</span> </div>
<div class="line"><span class="lineno"> 1539</span>      RCLCPP_INFO_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Rebuilding routing graph after is was invalidated by geofence&quot;</span>);</div>
<div class="line"><span class="lineno"> 1540</span> </div>
<div class="line"><span class="lineno"> 1541</span>      lanelet::traffic_rules::TrafficRulesUPtr traffic_rules_car = lanelet::traffic_rules::TrafficRulesFactory::create(</div>
<div class="line"><span class="lineno"> 1542</span>      lanelet::traffic_rules::CarmaUSTrafficRules::Location, <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a9d9fd775035c8389502d5185fa890070">participant_</a>);</div>
<div class="line"><span class="lineno"> 1543</span>      <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a4c64c73d83158f9b82682ad3bcc4af74">current_routing_graph_</a> = lanelet::routing::RoutingGraph::build(*<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>, *traffic_rules_car);</div>
<div class="line"><span class="lineno"> 1544</span> </div>
<div class="line"><span class="lineno"> 1545</span>      RCLCPP_INFO_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Done rebuilding routing graph after is was invalidated by geofence&quot;</span>);</div>
<div class="line"><span class="lineno"> 1546</span> </div>
<div class="line"><span class="lineno"> 1547</span>      <span class="comment">// Populate routing graph structure</span></div>
<div class="line"><span class="lineno"> 1548</span>      RCLCPP_INFO_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Creating routing graph message&quot;</span>);</div>
<div class="line"><span class="lineno"> 1549</span> </div>
<div class="line"><span class="lineno"> 1550</span>      <span class="keyword">auto</span> readable_graph = std::static_pointer_cast&lt;RoutingGraphAccessor&gt;(<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a4c64c73d83158f9b82682ad3bcc4af74">current_routing_graph_</a>);</div>
<div class="line"><span class="lineno"> 1551</span> </div>
<div class="line"><span class="lineno"> 1552</span>      gf_msg.routing_graph = readable_graph-&gt;routingGraphToMsg(<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a9d9fd775035c8389502d5185fa890070">participant_</a>);</div>
<div class="line"><span class="lineno"> 1553</span>      gf_msg.has_routing_graph = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1554</span> </div>
<div class="line"><span class="lineno"> 1555</span>      RCLCPP_INFO_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Done creating routing graph message&quot;</span>);</div>
<div class="line"><span class="lineno"> 1556</span>    }</div>
<div class="line"><span class="lineno"> 1557</span>    </div>
<div class="line"><span class="lineno"> 1558</span> </div>
<div class="line"><span class="lineno"> 1559</span>    <span class="comment">// Publish</span></div>
<div class="line"><span class="lineno"> 1560</span>    <span class="keyword">auto</span> send_data = std::make_shared&lt;carma_wm::TrafficControl&gt;(<a class="code hl_class" href="classcarma__wm_1_1TrafficControl.html">carma_wm::TrafficControl</a>(update-&gt;id_, update-&gt;update_list_, update-&gt;remove_list_, update-&gt;lanelet_additions_));</div>
<div class="line"><span class="lineno"> 1561</span>    send_data-&gt;traffic_light_id_lookup_ = update-&gt;traffic_light_id_lookup_;</div>
<div class="line"><span class="lineno"> 1562</span> </div>
<div class="line"><span class="lineno"> 1563</span>    <span class="keywordflow">if</span> (detected_map_msg_signal &amp;&amp; updates_to_send.back() == update) <span class="comment">// if last update</span></div>
<div class="line"><span class="lineno"> 1564</span>    {</div>
<div class="line"><span class="lineno"> 1565</span>      send_data-&gt;sim_ = *<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aa26bb2f41f25b523fd2a98010af60cb0">sim_</a>;</div>
<div class="line"><span class="lineno"> 1566</span>    }</div>
<div class="line"><span class="lineno"> 1567</span> </div>
<div class="line"><span class="lineno"> 1568</span>    <a class="code hl_function" href="namespacecarma__wm.html#aef665263f7df5afa3781f4319fe95e9c">carma_wm::toBinMsg</a>(send_data, &amp;gf_msg);</div>
<div class="line"><span class="lineno"> 1569</span>    <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a644d3ebd9dd0e50b9152e965fd9f0721">update_count_</a>++; <span class="comment">// Update the sequence count for the geofence messages</span></div>
<div class="line"><span class="lineno"> 1570</span>    gf_msg.seq_id = <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a644d3ebd9dd0e50b9152e965fd9f0721">update_count_</a>;</div>
<div class="line"><span class="lineno"> 1571</span>    gf_msg.invalidates_route=update-&gt;invalidate_route_; </div>
<div class="line"><span class="lineno"> 1572</span>    gf_msg.map_version = <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ab963fffc1b41395dd3393aee9b3e88e4">current_map_version_</a>;</div>
<div class="line"><span class="lineno"> 1573</span>    <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aee1d8ad2f6c7865da16ea7f40140b04a">map_update_pub_</a>(gf_msg);</div>
<div class="line"><span class="lineno"> 1574</span>  }</div>
<div class="line"><span class="lineno"> 1575</span>  </div>
<div class="line"><span class="lineno"> 1576</span>}</div>
<div class="ttc" id="aclasscarma__wm_1_1TrafficControl_html"><div class="ttname"><a href="classcarma__wm_1_1TrafficControl.html">carma_wm::TrafficControl</a></div><div class="ttdef"><b>Definition:</b> <a href="TrafficControl_8hpp_source.html#l00049">TrafficControl.hpp:50</a></div></div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_a0953785489057b443058b4ed4adb74ec"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a0953785489057b443058b4ed4adb74ec">carma_wm_ctrl::WMBroadcaster::tcm_marker_array_</a></div><div class="ttdeci">visualization_msgs::msg::MarkerArray tcm_marker_array_</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8hpp_source.html#l00404">WMBroadcaster.hpp:404</a></div></div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_a1ac51e0b0b57eda669c87372bd079ede"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a1ac51e0b0b57eda669c87372bd079ede">carma_wm_ctrl::WMBroadcaster::map_mutex_</a></div><div class="ttdeci">std::mutex map_mutex_</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8hpp_source.html#l00436">WMBroadcaster.hpp:436</a></div></div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_a2493db4c5843a143c61cd27b0489ca7a"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a2493db4c5843a143c61cd27b0489ca7a">carma_wm_ctrl::WMBroadcaster::composeTCMMarkerVisualizer</a></div><div class="ttdeci">visualization_msgs::msg::Marker composeTCMMarkerVisualizer(const std::vector&lt; lanelet::Point3d &gt; &amp;input)</div><div class="ttdoc">composeTCMMarkerVisualizer() compose TCM Marker visualization</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8cpp_source.html#l01826">WMBroadcaster.cpp:1826</a></div></div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_a4610499a06e220327a8eb10cbc18d8de"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a4610499a06e220327a8eb10cbc18d8de">carma_wm_ctrl::WMBroadcaster::work_zone_geofence_cache_</a></div><div class="ttdeci">std::unordered_map&lt; uint8_t, std::shared_ptr&lt; Geofence &gt; &gt; work_zone_geofence_cache_</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8hpp_source.html#l00412">WMBroadcaster.hpp:412</a></div></div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_a4c64c73d83158f9b82682ad3bcc4af74"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a4c64c73d83158f9b82682ad3bcc4af74">carma_wm_ctrl::WMBroadcaster::current_routing_graph_</a></div><div class="ttdeci">lanelet::routing::RoutingGraphPtr current_routing_graph_</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8hpp_source.html#l00430">WMBroadcaster.hpp:430</a></div></div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_a59dfece11887f76f024c34ef7f6e0f05"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a59dfece11887f76f024c34ef7f6e0f05">carma_wm_ctrl::WMBroadcaster::addGeofenceHelper</a></div><div class="ttdeci">void addGeofenceHelper(std::shared_ptr&lt; Geofence &gt; gf_ptr)</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8cpp_source.html#l01912">WMBroadcaster.cpp:1912</a></div></div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_a5ae3f2086831ebd932e19b2bdfd76405"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a5ae3f2086831ebd932e19b2bdfd76405">carma_wm_ctrl::WMBroadcaster::createWorkzoneGeofence</a></div><div class="ttdeci">std::shared_ptr&lt; Geofence &gt; createWorkzoneGeofence(std::unordered_map&lt; uint8_t, std::shared_ptr&lt; Geofence &gt; &gt; work_zone_geofence_cache)</div><div class="ttdoc">Creates a single workzone geofence (in the vector) that includes all additional lanelets (housing tra...</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8cpp_source.html#l00393">WMBroadcaster.cpp:393</a></div></div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_a644d3ebd9dd0e50b9152e965fd9f0721"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a644d3ebd9dd0e50b9152e965fd9f0721">carma_wm_ctrl::WMBroadcaster::update_count_</a></div><div class="ttdeci">size_t update_count_</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8hpp_source.html#l00461">WMBroadcaster.hpp:461</a></div></div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_a9d9fd775035c8389502d5185fa890070"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a9d9fd775035c8389502d5185fa890070">carma_wm_ctrl::WMBroadcaster::participant_</a></div><div class="ttdeci">std::string participant_</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8hpp_source.html#l00432">WMBroadcaster.hpp:432</a></div></div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_a9f7ae45f954ed5f177756a56b9387545"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a9f7ae45f954ed5f177756a56b9387545">carma_wm_ctrl::WMBroadcaster::active_geofence_llt_ids_</a></div><div class="ttdeci">std::unordered_set&lt; lanelet::Id &gt; active_geofence_llt_ids_</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8hpp_source.html#l00411">WMBroadcaster.hpp:411</a></div></div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_aa26bb2f41f25b523fd2a98010af60cb0"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aa26bb2f41f25b523fd2a98010af60cb0">carma_wm_ctrl::WMBroadcaster::sim_</a></div><div class="ttdeci">std::shared_ptr&lt; carma_wm::SignalizedIntersectionManager &gt; sim_</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8hpp_source.html#l00463">WMBroadcaster.hpp:463</a></div></div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_aac72e7333f997bfe19547a235f389c07"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aac72e7333f997bfe19547a235f389c07">carma_wm_ctrl::WMBroadcaster::geofenceFromMapMsg</a></div><div class="ttdeci">std::vector&lt; std::shared_ptr&lt; Geofence &gt; &gt; geofenceFromMapMsg(std::shared_ptr&lt; Geofence &gt; gf_ptr, const carma_v2x_msgs::msg::MapData &amp;map_msg)</div><div class="ttdoc">Fills geofence object from MAP Data ROS Msg which contains intersections' static data such as geometr...</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8cpp_source.html#l00217">WMBroadcaster.cpp:217</a></div></div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_ab963fffc1b41395dd3393aee9b3e88e4"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ab963fffc1b41395dd3393aee9b3e88e4">carma_wm_ctrl::WMBroadcaster::current_map_version_</a></div><div class="ttdeci">size_t current_map_version_</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8hpp_source.html#l00451">WMBroadcaster.hpp:451</a></div></div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_af0e373523dc84a409331d01b62d2fce0"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#af0e373523dc84a409331d01b62d2fce0">carma_wm_ctrl::WMBroadcaster::geofenceFromMsg</a></div><div class="ttdeci">void geofenceFromMsg(std::shared_ptr&lt; Geofence &gt; gf_ptr, const carma_v2x_msgs::msg::TrafficControlMessageV01 &amp;geofence_msg)</div><div class="ttdoc">Fills geofence object from TrafficControlMessageV01 ROS Msg.</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8cpp_source.html#l00262">WMBroadcaster.cpp:262</a></div></div>
<div class="ttc" id="anamespacecarma__wm_html_aef665263f7df5afa3781f4319fe95e9c"><div class="ttname"><a href="namespacecarma__wm.html#aef665263f7df5afa3781f4319fe95e9c">carma_wm::toBinMsg</a></div><div class="ttdeci">void toBinMsg(std::shared_ptr&lt; carma_wm::TrafficControl &gt; gf_ptr, autoware_lanelet2_msgs::msg::MapBin *msg)</div><div class="ttdef"><b>Definition:</b> <a href="TrafficControl_8cpp_source.html#l00024">TrafficControl.cpp:24</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMBroadcaster_8hpp_source.html#l00411">active_geofence_llt_ids_</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l01912">addGeofenceHelper()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l01826">composeTCMMarkerVisualizer()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l00393">createWorkzoneGeofence()</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00429">current_map_</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00451">current_map_version_</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00430">current_routing_graph_</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l00217">geofenceFromMapMsg()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l00262">geofenceFromMsg()</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00436">map_mutex_</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00438">map_update_pub_</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00432">participant_</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00463">sim_</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00404">tcm_marker_array_</a>, <a class="el" href="TrafficControl_8cpp_source.html#l00024">carma_wm::toBinMsg()</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00461">update_count_</a>, and <a class="el" href="WMBroadcaster_8hpp_source.html#l00412">work_zone_geofence_cache_</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l00047">WMBroadcaster()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_a649174a7a7270df95532cad5131bf4cb_cgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_a649174a7a7270df95532cad5131bf4cb_cgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_a649174a7a7270df95532cad5131bf4cb_cgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_a649174a7a7270df95532cad5131bf4cb_cgraph">
<area shape="rect" title="Adds a geofence to the current map and publishes the ROS msg." alt="" coords="5,420,216,461"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a59dfece11887f76f024c34ef7f6e0f05" title=" " alt="" coords="264,136,475,177"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a2493db4c5843a143c61cd27b0489ca7a" title="composeTCMMarkerVisualizer() compose TCM Marker visualization" alt="" coords="264,332,475,373"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a5ae3f2086831ebd932e19b2bdfd76405" title="Creates a single workzone geofence (in the vector) that includes all additional lanelets (housing tra..." alt="" coords="264,449,475,491"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aac72e7333f997bfe19547a235f389c07" title="Fills geofence object from MAP Data ROS Msg which contains intersections&#39; static data such as geometr..." alt="" coords="264,515,475,556"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#af0e373523dc84a409331d01b62d2fce0" title="Fills geofence object from TrafficControlMessageV01 ROS Msg." alt="" coords="523,319,733,360"/>
<area shape="rect" href="namespacecarma__wm.html#aef665263f7df5afa3781f4319fe95e9c" title=" " alt="" coords="296,581,443,607"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aa7f599cf26d1e2ff6ea7cb943de23071" title=" " alt="" coords="523,71,733,112"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#af027533b2d500770301e17520f9e4863" title="This is a helper function that returns true if the provided regem is marked to be changed by the geof..." alt="" coords="785,71,995,112"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a13393bf085e59efc687c5d9b407326cf" title="This is a helper function that returns true if signal in the lanelet should be changed according to t..." alt="" coords="785,5,995,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a12708b289f7f3d8f10c6dc749bf14d65" title="Create workzone geofence. Create diagonal lanelets and a lanelet that houses opposing lane&#39;s trafficl..." alt="" coords="523,515,733,556"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#adc221f65f0b99586fc8c2ffc97c5feea" title="Preprocess for workzone area. Parallel_llts will have front_parallel and back_parallel lanelets that ..." alt="" coords="523,660,733,701"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ae34565da1566e777745a92161422404c" title="Adds RegionAccessRule to the map." alt="" coords="785,449,995,491"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a07466352083e95712cfed377a61c3bc7" title=" " alt="" coords="783,515,997,556"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#adfb94b051e74a67830c1795e32081cbc" title="helper for generating 32bit traffic light Id from TCM label field consisting workzone intersection/si..." alt="" coords="785,580,995,621"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a264607b6ec5b20d8971f8dc14a4b1825" title="Split given lanelet&#39;s adjacent, OPPOSITE lanelet with same proportion as the given point&#39;s downtrack ..." alt="" coords="785,733,995,775"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ac71c9fdbf27cbfbe3988c3a77d6e7067" title="Generates inverse participants list of the given participants." alt="" coords="1055,449,1266,491"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aa326eab73fe1583c1fa937ed2e38b33f" title="Generates participants list." alt="" coords="1055,221,1266,263"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a2c6c3606e5f4b3c12a984261823c1d71" title="Combines a list of the given participants into a single &quot;vehicle&quot; type if participants cover all poss..." alt="" coords="1325,221,1535,263"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aef58891043a14a620343f1fc477b8393" title=" " alt="" coords="1047,515,1275,556"/>
<area shape="rect" href="namespacecarma__wm_1_1utils.html#a5f9cfb53df6903542a0cb9bf2f8a7d7c" title="Get 32bit id by concatenating 16bit id with 8bit signal_group_id." alt="" coords="1070,581,1251,607"/>
<area shape="rect" href="namespacecarma__wm_1_1query.html#a9fb50939b2ae576d2eb7fcfc42fcdc22" title="Given the cartesian point on the map, tries to get the opposite direction lanelet on the left This fu..." alt="" coords="1055,800,1267,841"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#aebce986f21c117983313292d5e82b50a" title="Returns the TrackPos, computed in 2d, of the provided point relative to the centerline of the provide..." alt="" coords="1357,664,1503,705"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a1dfc2ec5be906966916939c75874cbab" title="Split given lanelet with given downtrack ratios relative to the lanelet. Newly created lanelet will h..." alt="" coords="1055,683,1266,724"/>
<area shape="rect" href="namespacecarma__wm_1_1query.html#a8933b74d652e02d07be1170b787d87a2" title="carma_wm::query namespace contains implementations for query functions (input and output read or writ..." alt="" coords="1331,859,1529,900"/>
<area shape="rect" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5" title=" " alt="" coords="1331,793,1529,835"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#ab675b2b8862a2ba9c139a8b5b353b846" title="Get the TrackPos of the provided point along the linestring and the segment of the line string which ..." alt="" coords="1585,664,1731,705"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#ae0a06818149f7430fee80e295ef04548" title="Helper function to identify whether to select the preceeding or succeeding segment of a linstring poi..." alt="" coords="1779,664,1924,705"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a883734808f44db2778371ce3fbeecdd3" title="Split given lanelet with same proportion as the given points&#39; downtrack relative to the lanelet...." alt="" coords="785,660,995,701"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a74d10f4f0534115f672f8995f0036b49" title=" " alt="" coords="781,188,999,229"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a116928c0070cfa7587c219a6629dadb8" title="Adds Minimum Gap to the map." alt="" coords="785,253,995,295"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a1327952ca44a5e817b0498f93f6143ac" title="Gets the affected lanelet or areas based on the points in local frame." alt="" coords="785,384,995,425"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a44fed247724b501a968aec27479ed58d" title="Extract geofence points from geofence message using its given proj and datum fields." alt="" coords="785,319,995,360"/>
<area shape="rect" href="namespacecarma__wm_1_1query.html#a9c9935e22582f37c01441115bce72f58" title="Gets the affected lanelet or areas based on the points in the given map&#39;s frame." alt="" coords="1063,384,1258,425"/>
<area shape="rect" href="namespacecarma__wm_1_1query.html#a382665a2ddc42be06fca9c1f8dfd0489" title="A function that filters successor lanelets of root_lanelets from possible_lanelets." alt="" coords="1323,417,1537,459"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#abab7ba4e773f03d6cfc09492742c6b7b" title="Calculates the angle between two vectors." alt="" coords="1343,352,1517,393"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#a50c966bd5e6ed00ea0b1a70e93cd0d4a" title="acos method that caps the input x value for 1 or &#45;1 to avoid undefined output. This is meant to preve..." alt="" coords="1585,352,1731,393"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_a649174a7a7270df95532cad5131bf4cb_icgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_a649174a7a7270df95532cad5131bf4cb_icgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_a649174a7a7270df95532cad5131bf4cb_icgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_a649174a7a7270df95532cad5131bf4cb_icgraph">
<area shape="rect" title="Adds a geofence to the current map and publishes the ROS msg." alt="" coords="264,5,475,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a95cb7c60682d7b455a8624534ad94706" title="Constructor." alt="" coords="5,5,216,47"/>
</map>
</div>

</div>
</div>
<a id="a59dfece11887f76f024c34ef7f6e0f05" name="a59dfece11887f76f024c34ef7f6e0f05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59dfece11887f76f024c34ef7f6e0f05">&#9670;&nbsp;</a></span>addGeofenceHelper()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void carma_wm_ctrl::WMBroadcaster::addGeofenceHelper </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classcarma__wm__ctrl_1_1Geofence.html">Geofence</a> &gt;&#160;</td>
          <td class="paramname"><em>gf_ptr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8cpp_source.html#l01912">1912</a> of file <a class="el" href="WMBroadcaster_8cpp_source.html">WMBroadcaster.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1913</span>{</div>
<div class="line"><span class="lineno"> 1914</span>  <span class="comment">// resetting the information inside geofence</span></div>
<div class="line"><span class="lineno"> 1915</span>  gf_ptr-&gt;remove_list_ = {};</div>
<div class="line"><span class="lineno"> 1916</span>  gf_ptr-&gt;update_list_ = {};</div>
<div class="line"><span class="lineno"> 1917</span> </div>
<div class="line"><span class="lineno"> 1918</span>  <span class="comment">// add additional lanelets that need to be added</span></div>
<div class="line"><span class="lineno"> 1919</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> llt : gf_ptr-&gt;lanelet_additions_)</div>
<div class="line"><span class="lineno"> 1920</span>  {</div>
<div class="line"><span class="lineno"> 1921</span>    <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;add(llt);</div>
<div class="line"><span class="lineno"> 1922</span>  }</div>
<div class="line"><span class="lineno"> 1923</span> </div>
<div class="line"><span class="lineno"> 1924</span>  <span class="comment">// add trafficlight id mapping</span></div>
<div class="line"><span class="lineno"> 1925</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> pair : gf_ptr-&gt;traffic_light_id_lookup_)</div>
<div class="line"><span class="lineno"> 1926</span>  {</div>
<div class="line"><span class="lineno"> 1927</span>    <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aa03b08ee979d7a4cfd7577280374b97e">traffic_light_id_lookup_</a>[pair.first] = pair.second;</div>
<div class="line"><span class="lineno"> 1928</span>  }</div>
<div class="line"><span class="lineno"> 1929</span> </div>
<div class="line"><span class="lineno"> 1930</span>  <span class="comment">// Logic to determine what type of geofence</span></div>
<div class="line"><span class="lineno"> 1931</span>  <a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aa7f599cf26d1e2ff6ea7cb943de23071">addRegulatoryComponent</a>(gf_ptr);</div>
<div class="line"><span class="lineno"> 1932</span>}</div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_aa03b08ee979d7a4cfd7577280374b97e"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aa03b08ee979d7a4cfd7577280374b97e">carma_wm_ctrl::WMBroadcaster::traffic_light_id_lookup_</a></div><div class="ttdeci">std::unordered_map&lt; uint32_t, lanelet::Id &gt; traffic_light_id_lookup_</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8hpp_source.html#l00413">WMBroadcaster.hpp:413</a></div></div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_aa7f599cf26d1e2ff6ea7cb943de23071"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aa7f599cf26d1e2ff6ea7cb943de23071">carma_wm_ctrl::WMBroadcaster::addRegulatoryComponent</a></div><div class="ttdeci">void addRegulatoryComponent(std::shared_ptr&lt; Geofence &gt; gf_ptr) const</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8cpp_source.html#l01416">WMBroadcaster.cpp:1416</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMBroadcaster_8cpp_source.html#l01416">addRegulatoryComponent()</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00429">current_map_</a>, and <a class="el" href="WMBroadcaster_8hpp_source.html#l00413">traffic_light_id_lookup_</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l01488">addGeofence()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_a59dfece11887f76f024c34ef7f6e0f05_cgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_a59dfece11887f76f024c34ef7f6e0f05_cgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_a59dfece11887f76f024c34ef7f6e0f05_cgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_a59dfece11887f76f024c34ef7f6e0f05_cgraph">
<area shape="rect" title=" " alt="" coords="5,39,216,80"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aa7f599cf26d1e2ff6ea7cb943de23071" title=" " alt="" coords="264,39,475,80"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#af027533b2d500770301e17520f9e4863" title="This is a helper function that returns true if the provided regem is marked to be changed by the geof..." alt="" coords="523,5,733,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a13393bf085e59efc687c5d9b407326cf" title="This is a helper function that returns true if signal in the lanelet should be changed according to t..." alt="" coords="523,71,733,112"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_a59dfece11887f76f024c34ef7f6e0f05_icgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_a59dfece11887f76f024c34ef7f6e0f05_icgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_a59dfece11887f76f024c34ef7f6e0f05_icgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_a59dfece11887f76f024c34ef7f6e0f05_icgraph">
<area shape="rect" title=" " alt="" coords="523,5,733,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a649174a7a7270df95532cad5131bf4cb" title="Adds a geofence to the current map and publishes the ROS msg." alt="" coords="264,5,475,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a95cb7c60682d7b455a8624534ad94706" title="Constructor." alt="" coords="5,5,216,47"/>
</map>
</div>

</div>
</div>
<a id="a74d10f4f0534115f672f8995f0036b49" name="a74d10f4f0534115f672f8995f0036b49"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74d10f4f0534115f672f8995f0036b49">&#9670;&nbsp;</a></span>addPassingControlLineFromMsg()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void carma_wm_ctrl::WMBroadcaster::addPassingControlLineFromMsg </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classcarma__wm__ctrl_1_1Geofence.html">Geofence</a> &gt;&#160;</td>
          <td class="paramname"><em>gf_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const carma_v2x_msgs::msg::TrafficControlMessageV01 &amp;&#160;</td>
          <td class="paramname"><em>msg_v01</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; lanelet::Lanelet &gt; &amp;&#160;</td>
          <td class="paramname"><em>affected_llts</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8cpp_source.html#l00880">880</a> of file <a class="el" href="WMBroadcaster_8cpp_source.html">WMBroadcaster.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  881</span>{</div>
<div class="line"><span class="lineno">  882</span>  carma_v2x_msgs::msg::TrafficControlDetail msg_detail;</div>
<div class="line"><span class="lineno">  883</span>  msg_detail = msg_v01.params.detail;</div>
<div class="line"><span class="lineno">  884</span>  <span class="comment">// Get affected bounds</span></div>
<div class="line"><span class="lineno">  885</span>  lanelet::LineStrings3d pcl_bounds;</div>
<div class="line"><span class="lineno">  886</span>  <span class="keywordflow">if</span> (msg_detail.lataffinity == carma_v2x_msgs::msg::TrafficControlDetail::LEFT)</div>
<div class="line"><span class="lineno">  887</span>  {</div>
<div class="line"><span class="lineno">  888</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> llt : affected_llts) pcl_bounds.push_back(llt.leftBound());</div>
<div class="line"><span class="lineno">  889</span>    gf_ptr-&gt;pcl_affects_left_ = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  890</span>  }</div>
<div class="line"><span class="lineno">  891</span>  <span class="keywordflow">else</span> <span class="comment">//right</span></div>
<div class="line"><span class="lineno">  892</span>  {</div>
<div class="line"><span class="lineno">  893</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> llt : affected_llts) pcl_bounds.push_back(llt.rightBound());</div>
<div class="line"><span class="lineno">  894</span>    gf_ptr-&gt;pcl_affects_right_ = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  895</span>  }</div>
<div class="line"><span class="lineno">  896</span> </div>
<div class="line"><span class="lineno">  897</span>  <span class="comment">// Get specified participants</span></div>
<div class="line"><span class="lineno">  898</span>  std::vector&lt;std::string&gt; left_participants;</div>
<div class="line"><span class="lineno">  899</span>  std::vector&lt;std::string&gt; right_participants;</div>
<div class="line"><span class="lineno">  900</span>  std::vector&lt;std::string&gt; participants=<a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aa326eab73fe1583c1fa937ed2e38b33f">participantsChecker</a>(msg_v01);</div>
<div class="line"><span class="lineno">  901</span> </div>
<div class="line"><span class="lineno">  902</span>  <span class="comment">// Create the pcl depending on the allowed passing control direction, left, right, or both</span></div>
<div class="line"><span class="lineno">  903</span>  <span class="keywordflow">if</span> (msg_detail.latperm[0] == carma_v2x_msgs::msg::TrafficControlDetail::PERMITTED ||</div>
<div class="line"><span class="lineno">  904</span>      msg_detail.latperm[0] == carma_v2x_msgs::msg::TrafficControlDetail::PASSINGONLY)</div>
<div class="line"><span class="lineno">  905</span>  {</div>
<div class="line"><span class="lineno">  906</span>    left_participants = participants; </div>
<div class="line"><span class="lineno">  907</span>  }</div>
<div class="line"><span class="lineno">  908</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (msg_detail.latperm[0] == carma_v2x_msgs::msg::TrafficControlDetail::EMERGENCYONLY)</div>
<div class="line"><span class="lineno">  909</span>  {</div>
<div class="line"><span class="lineno">  910</span>    left_participants.push_back(lanelet::Participants::VehicleEmergency);</div>
<div class="line"><span class="lineno">  911</span>  }</div>
<div class="line"><span class="lineno">  912</span>  <span class="keywordflow">if</span> (msg_detail.latperm[1] == carma_v2x_msgs::msg::TrafficControlDetail::PERMITTED ||</div>
<div class="line"><span class="lineno">  913</span>      msg_detail.latperm[1] == carma_v2x_msgs::msg::TrafficControlDetail::PASSINGONLY)</div>
<div class="line"><span class="lineno">  914</span>  {</div>
<div class="line"><span class="lineno">  915</span>    right_participants = participants; </div>
<div class="line"><span class="lineno">  916</span>  }</div>
<div class="line"><span class="lineno">  917</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (msg_detail.latperm[1] == carma_v2x_msgs::msg::TrafficControlDetail::EMERGENCYONLY)</div>
<div class="line"><span class="lineno">  918</span>  {</div>
<div class="line"><span class="lineno">  919</span>    right_participants.push_back(lanelet::Participants::VehicleEmergency);</div>
<div class="line"><span class="lineno">  920</span>  }</div>
<div class="line"><span class="lineno">  921</span> </div>
<div class="line"><span class="lineno">  922</span>  gf_ptr-&gt;regulatory_element_ = std::make_shared&lt;lanelet::PassingControlLine&gt;(lanelet::PassingControlLine::buildData(</div>
<div class="line"><span class="lineno">  923</span>    lanelet::utils::getId(), pcl_bounds, left_participants, right_participants));</div>
<div class="line"><span class="lineno">  924</span>}</div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_aa326eab73fe1583c1fa937ed2e38b33f"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aa326eab73fe1583c1fa937ed2e38b33f">carma_wm_ctrl::WMBroadcaster::participantsChecker</a></div><div class="ttdeci">std::vector&lt; std::string &gt; participantsChecker(const carma_v2x_msgs::msg::TrafficControlMessageV01 &amp;msg_v01) const</div><div class="ttdoc">Generates participants list.</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8cpp_source.html#l00951">WMBroadcaster.cpp:951</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMBroadcaster_8cpp_source.html#l00951">participantsChecker()</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l00262">geofenceFromMsg()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_a74d10f4f0534115f672f8995f0036b49_cgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_a74d10f4f0534115f672f8995f0036b49_cgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_a74d10f4f0534115f672f8995f0036b49_cgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_a74d10f4f0534115f672f8995f0036b49_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,223,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aa326eab73fe1583c1fa937ed2e38b33f" title="Generates participants list." alt="" coords="271,5,481,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a2c6c3606e5f4b3c12a984261823c1d71" title="Combines a list of the given participants into a single &quot;vehicle&quot; type if participants cover all poss..." alt="" coords="529,5,740,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_a74d10f4f0534115f672f8995f0036b49_icgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_a74d10f4f0534115f672f8995f0036b49_icgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_a74d10f4f0534115f672f8995f0036b49_icgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_a74d10f4f0534115f672f8995f0036b49_icgraph">
<area shape="rect" title=" " alt="" coords="781,5,999,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#af0e373523dc84a409331d01b62d2fce0" title="Fills geofence object from TrafficControlMessageV01 ROS Msg." alt="" coords="523,5,733,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a649174a7a7270df95532cad5131bf4cb" title="Adds a geofence to the current map and publishes the ROS msg." alt="" coords="264,5,475,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a95cb7c60682d7b455a8624534ad94706" title="Constructor." alt="" coords="5,5,216,47"/>
</map>
</div>

</div>
</div>
<a id="ae34565da1566e777745a92161422404c" name="ae34565da1566e777745a92161422404c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae34565da1566e777745a92161422404c">&#9670;&nbsp;</a></span>addRegionAccessRule()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void carma_wm_ctrl::WMBroadcaster::addRegionAccessRule </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classcarma__wm__ctrl_1_1Geofence.html">Geofence</a> &gt;&#160;</td>
          <td class="paramname"><em>gf_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const carma_v2x_msgs::msg::TrafficControlMessageV01 &amp;&#160;</td>
          <td class="paramname"><em>msg_v01</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; lanelet::Lanelet &gt; &amp;&#160;</td>
          <td class="paramname"><em>affected_llts</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds RegionAccessRule to the map. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">gf_ptr</td><td>geofence pointer </td></tr>
    <tr><td class="paramname">msg_v01</td><td>message type </td></tr>
    <tr><td class="paramname">afffected_llts</td><td>affected lanelets </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8cpp_source.html#l00926">926</a> of file <a class="el" href="WMBroadcaster_8cpp_source.html">WMBroadcaster.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  927</span>{</div>
<div class="line"><span class="lineno">  928</span>  <span class="keyword">const</span> std::string&amp; reason = msg_v01.package.label;</div>
<div class="line"><span class="lineno">  929</span>  gf_ptr-&gt;label_ = msg_v01.package.label;</div>
<div class="line"><span class="lineno">  930</span>  <span class="keyword">auto</span> regulatory_element = std::make_shared&lt;lanelet::RegionAccessRule&gt;(lanelet::RegionAccessRule::buildData(lanelet::utils::getId(),affected_llts,{},<a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ac71c9fdbf27cbfbe3988c3a77d6e7067">invertParticipants</a>(<a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aa326eab73fe1583c1fa937ed2e38b33f">participantsChecker</a>(msg_v01)), reason));</div>
<div class="line"><span class="lineno">  931</span> </div>
<div class="line"><span class="lineno">  932</span>  <span class="keywordflow">if</span>(!regulatory_element-&gt;accessable(lanelet::Participants::VehicleCar) || !regulatory_element-&gt;accessable(lanelet::Participants::VehicleTruck )) </div>
<div class="line"><span class="lineno">  933</span>  {</div>
<div class="line"><span class="lineno">  934</span>    gf_ptr-&gt;invalidate_route_=<span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  935</span>  }</div>
<div class="line"><span class="lineno">  936</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  937</span>  {</div>
<div class="line"><span class="lineno">  938</span>    gf_ptr-&gt;invalidate_route_=<span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  939</span>  }</div>
<div class="line"><span class="lineno">  940</span>  gf_ptr-&gt;regulatory_element_ = regulatory_element;</div>
<div class="line"><span class="lineno">  941</span>}</div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_ac71c9fdbf27cbfbe3988c3a77d6e7067"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ac71c9fdbf27cbfbe3988c3a77d6e7067">carma_wm_ctrl::WMBroadcaster::invertParticipants</a></div><div class="ttdeci">std::vector&lt; std::string &gt; invertParticipants(const std::vector&lt; std::string &gt; &amp;input_participants) const</div><div class="ttdoc">Generates inverse participants list of the given participants.</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8cpp_source.html#l00993">WMBroadcaster.cpp:993</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMBroadcaster_8cpp_source.html#l00993">invertParticipants()</a>, and <a class="el" href="WMBroadcaster_8cpp_source.html#l00951">participantsChecker()</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l00420">createWorkzoneGeometry()</a>, and <a class="el" href="WMBroadcaster_8cpp_source.html#l00262">geofenceFromMsg()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_ae34565da1566e777745a92161422404c_cgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_ae34565da1566e777745a92161422404c_cgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_ae34565da1566e777745a92161422404c_cgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_ae34565da1566e777745a92161422404c_cgraph">
<area shape="rect" title="Adds RegionAccessRule to the map." alt="" coords="5,39,216,80"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ac71c9fdbf27cbfbe3988c3a77d6e7067" title="Generates inverse participants list of the given participants." alt="" coords="264,5,475,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aa326eab73fe1583c1fa937ed2e38b33f" title="Generates participants list." alt="" coords="264,71,475,112"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a2c6c3606e5f4b3c12a984261823c1d71" title="Combines a list of the given participants into a single &quot;vehicle&quot; type if participants cover all poss..." alt="" coords="523,71,733,112"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_ae34565da1566e777745a92161422404c_icgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_ae34565da1566e777745a92161422404c_icgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_ae34565da1566e777745a92161422404c_icgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_ae34565da1566e777745a92161422404c_icgraph">
<area shape="rect" title="Adds RegionAccessRule to the map." alt="" coords="1040,39,1251,80"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a12708b289f7f3d8f10c6dc749bf14d65" title="Create workzone geofence. Create diagonal lanelets and a lanelet that houses opposing lane&#39;s trafficl..." alt="" coords="781,8,992,49"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#af0e373523dc84a409331d01b62d2fce0" title="Fills geofence object from TrafficControlMessageV01 ROS Msg." alt="" coords="523,71,733,112"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a5ae3f2086831ebd932e19b2bdfd76405" title="Creates a single workzone geofence (in the vector) that includes all additional lanelets (housing tra..." alt="" coords="523,5,733,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a649174a7a7270df95532cad5131bf4cb" title="Adds a geofence to the current map and publishes the ROS msg." alt="" coords="264,39,475,80"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a95cb7c60682d7b455a8624534ad94706" title="Constructor." alt="" coords="5,39,216,80"/>
</map>
</div>

</div>
</div>
<a id="a116928c0070cfa7587c219a6629dadb8" name="a116928c0070cfa7587c219a6629dadb8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a116928c0070cfa7587c219a6629dadb8">&#9670;&nbsp;</a></span>addRegionMinimumGap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void carma_wm_ctrl::WMBroadcaster::addRegionMinimumGap </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classcarma__wm__ctrl_1_1Geofence.html">Geofence</a> &gt;&#160;</td>
          <td class="paramname"><em>gf_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const carma_v2x_msgs::msg::TrafficControlMessageV01 &amp;&#160;</td>
          <td class="paramname"><em>msg_v01</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>min_gap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; lanelet::Lanelet &gt; &amp;&#160;</td>
          <td class="paramname"><em>affected_llts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; lanelet::Area &gt; &amp;&#160;</td>
          <td class="paramname"><em>affected_areas</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds Minimum Gap to the map. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">gf_ptr</td><td>geofence pointer </td></tr>
    <tr><td class="paramname">double</td><td>min_gap </td></tr>
    <tr><td class="paramname">afffected_llts</td><td>affected lanelets </td></tr>
    <tr><td class="paramname">affected_areas</td><td>affected areas </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8cpp_source.html#l00943">943</a> of file <a class="el" href="WMBroadcaster_8cpp_source.html">WMBroadcaster.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  944</span>{</div>
<div class="line"><span class="lineno">  945</span>  <span class="keyword">auto</span> regulatory_element = std::make_shared&lt;lanelet::DigitalMinimumGap&gt;(lanelet::DigitalMinimumGap::buildData(lanelet::utils::getId(), </div>
<div class="line"><span class="lineno">  946</span>                                        min_gap, affected_llts, affected_areas,<a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aa326eab73fe1583c1fa937ed2e38b33f">participantsChecker</a>(msg_v01) ));</div>
<div class="line"><span class="lineno">  947</span>  </div>
<div class="line"><span class="lineno">  948</span>  gf_ptr-&gt;regulatory_element_ = regulatory_element;</div>
<div class="line"><span class="lineno">  949</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMBroadcaster_8cpp_source.html#l00951">participantsChecker()</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l00262">geofenceFromMsg()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_a116928c0070cfa7587c219a6629dadb8_cgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_a116928c0070cfa7587c219a6629dadb8_cgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_a116928c0070cfa7587c219a6629dadb8_cgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_a116928c0070cfa7587c219a6629dadb8_cgraph">
<area shape="rect" title="Adds Minimum Gap to the map." alt="" coords="5,5,216,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aa326eab73fe1583c1fa937ed2e38b33f" title="Generates participants list." alt="" coords="264,5,475,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a2c6c3606e5f4b3c12a984261823c1d71" title="Combines a list of the given participants into a single &quot;vehicle&quot; type if participants cover all poss..." alt="" coords="523,5,733,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_a116928c0070cfa7587c219a6629dadb8_icgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_a116928c0070cfa7587c219a6629dadb8_icgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_a116928c0070cfa7587c219a6629dadb8_icgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_a116928c0070cfa7587c219a6629dadb8_icgraph">
<area shape="rect" title="Adds Minimum Gap to the map." alt="" coords="781,5,992,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#af0e373523dc84a409331d01b62d2fce0" title="Fills geofence object from TrafficControlMessageV01 ROS Msg." alt="" coords="523,5,733,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a649174a7a7270df95532cad5131bf4cb" title="Adds a geofence to the current map and publishes the ROS msg." alt="" coords="264,5,475,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a95cb7c60682d7b455a8624534ad94706" title="Constructor." alt="" coords="5,5,216,47"/>
</map>
</div>

</div>
</div>
<a id="aa7f599cf26d1e2ff6ea7cb943de23071" name="aa7f599cf26d1e2ff6ea7cb943de23071"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7f599cf26d1e2ff6ea7cb943de23071">&#9670;&nbsp;</a></span>addRegulatoryComponent()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void carma_wm_ctrl::WMBroadcaster::addRegulatoryComponent </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classcarma__wm__ctrl_1_1Geofence.html">Geofence</a> &gt;&#160;</td>
          <td class="paramname"><em>gf_ptr</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8cpp_source.html#l01416">1416</a> of file <a class="el" href="WMBroadcaster_8cpp_source.html">WMBroadcaster.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1417</span>{</div>
<div class="line"><span class="lineno"> 1418</span>  <span class="comment">// First loop is to save the relation between element and regulatory element</span></div>
<div class="line"><span class="lineno"> 1419</span>  <span class="comment">// so that we can add back the old one after geofence deactivates</span></div>
<div class="line"><span class="lineno"> 1420</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> el: gf_ptr-&gt;affected_parts_)</div>
<div class="line"><span class="lineno"> 1421</span>  {</div>
<div class="line"><span class="lineno"> 1422</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> regem : el.regulatoryElements())</div>
<div class="line"><span class="lineno"> 1423</span>    {</div>
<div class="line"><span class="lineno"> 1424</span>      <span class="keywordflow">if</span> (!<a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#af027533b2d500770301e17520f9e4863">shouldChangeControlLine</a>(el, regem, gf_ptr) ||</div>
<div class="line"><span class="lineno"> 1425</span>        !<a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a13393bf085e59efc687c5d9b407326cf">shouldChangeTrafficSignal</a>(el, regem, <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aa26bb2f41f25b523fd2a98010af60cb0">sim_</a>))</div>
<div class="line"><span class="lineno"> 1426</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1427</span> </div>
<div class="line"><span class="lineno"> 1428</span>      <span class="keywordflow">if</span> (regem-&gt;attribute(lanelet::AttributeName::Subtype).value() == gf_ptr-&gt;regulatory_element_-&gt;attribute(lanelet::AttributeName::Subtype).value())</div>
<div class="line"><span class="lineno"> 1429</span>      {</div>
<div class="line"><span class="lineno"> 1430</span>        lanelet::RegulatoryElementPtr nonconst_regem = <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;regulatoryElementLayer.get(regem-&gt;id());</div>
<div class="line"><span class="lineno"> 1431</span>        gf_ptr-&gt;prev_regems_.push_back(std::make_pair(el.id(), nonconst_regem));</div>
<div class="line"><span class="lineno"> 1432</span>        gf_ptr-&gt;remove_list_.push_back(std::make_pair(el.id(), nonconst_regem));</div>
<div class="line"><span class="lineno"> 1433</span>        <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;remove(<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;laneletLayer.get(el.lanelet()-&gt;id()), nonconst_regem);</div>
<div class="line"><span class="lineno"> 1434</span>      }</div>
<div class="line"><span class="lineno"> 1435</span>    }</div>
<div class="line"><span class="lineno"> 1436</span>  }</div>
<div class="line"><span class="lineno"> 1437</span> </div>
<div class="line"><span class="lineno"> 1438</span> </div>
<div class="line"><span class="lineno"> 1439</span>  <span class="comment">// this loop is also kept separately because previously we assumed </span></div>
<div class="line"><span class="lineno"> 1440</span>  <span class="comment">// there was existing regem, but this handles changes to all of the elements</span></div>
<div class="line"><span class="lineno"> 1441</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> el: gf_ptr-&gt;affected_parts_)</div>
<div class="line"><span class="lineno"> 1442</span>  {</div>
<div class="line"><span class="lineno"> 1443</span>    <span class="comment">// update it with new regem</span></div>
<div class="line"><span class="lineno"> 1444</span>    <span class="keywordflow">if</span> (gf_ptr-&gt;regulatory_element_-&gt;id() != lanelet::InvalId)</div>
<div class="line"><span class="lineno"> 1445</span>    {</div>
<div class="line"><span class="lineno"> 1446</span>      <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;update(<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;laneletLayer.get(el.id()), gf_ptr-&gt;regulatory_element_);</div>
<div class="line"><span class="lineno"> 1447</span>      gf_ptr-&gt;update_list_.push_back(std::pair&lt;lanelet::Id, lanelet::RegulatoryElementPtr&gt;(el.id(), gf_ptr-&gt;regulatory_element_));</div>
<div class="line"><span class="lineno"> 1448</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1449</span>      RCLCPP_WARN_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Regulatory element with invalid id in geofence cannot be added to the map&quot;</span>);</div>
<div class="line"><span class="lineno"> 1450</span>    }</div>
<div class="line"><span class="lineno"> 1451</span>  }</div>
<div class="line"><span class="lineno"> 1452</span>  </div>
<div class="line"><span class="lineno"> 1453</span> </div>
<div class="line"><span class="lineno"> 1454</span> </div>
<div class="line"><span class="lineno"> 1455</span>}</div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_a13393bf085e59efc687c5d9b407326cf"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a13393bf085e59efc687c5d9b407326cf">carma_wm_ctrl::WMBroadcaster::shouldChangeTrafficSignal</a></div><div class="ttdeci">bool shouldChangeTrafficSignal(const lanelet::ConstLaneletOrArea &amp;el, const lanelet::RegulatoryElementConstPtr &amp;regem, std::shared_ptr&lt; carma_wm::SignalizedIntersectionManager &gt; sim) const</div><div class="ttdoc">This is a helper function that returns true if signal in the lanelet should be changed according to t...</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8cpp_source.html#l01388">WMBroadcaster.cpp:1388</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMBroadcaster_8hpp_source.html#l00429">current_map_</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l01357">shouldChangeControlLine()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l01388">shouldChangeTrafficSignal()</a>, and <a class="el" href="WMBroadcaster_8hpp_source.html#l00463">sim_</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l01912">addGeofenceHelper()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_aa7f599cf26d1e2ff6ea7cb943de23071_cgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_aa7f599cf26d1e2ff6ea7cb943de23071_cgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_aa7f599cf26d1e2ff6ea7cb943de23071_cgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_aa7f599cf26d1e2ff6ea7cb943de23071_cgraph">
<area shape="rect" title=" " alt="" coords="5,39,216,80"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#af027533b2d500770301e17520f9e4863" title="This is a helper function that returns true if the provided regem is marked to be changed by the geof..." alt="" coords="264,5,475,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a13393bf085e59efc687c5d9b407326cf" title="This is a helper function that returns true if signal in the lanelet should be changed according to t..." alt="" coords="264,71,475,112"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_aa7f599cf26d1e2ff6ea7cb943de23071_icgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_aa7f599cf26d1e2ff6ea7cb943de23071_icgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_aa7f599cf26d1e2ff6ea7cb943de23071_icgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_aa7f599cf26d1e2ff6ea7cb943de23071_icgraph">
<area shape="rect" title=" " alt="" coords="781,5,992,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a59dfece11887f76f024c34ef7f6e0f05" title=" " alt="" coords="523,5,733,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a649174a7a7270df95532cad5131bf4cb" title="Adds a geofence to the current map and publishes the ROS msg." alt="" coords="264,5,475,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a95cb7c60682d7b455a8624534ad94706" title="Constructor." alt="" coords="5,5,216,47"/>
</map>
</div>

</div>
</div>
<a id="abea25fd0b879387b68454225ebb0ebc6" name="abea25fd0b879387b68454225ebb0ebc6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abea25fd0b879387b68454225ebb0ebc6">&#9670;&nbsp;</a></span>addScheduleFromMsg()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void carma_wm_ctrl::WMBroadcaster::addScheduleFromMsg </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classcarma__wm__ctrl_1_1Geofence.html">Geofence</a> &gt;&#160;</td>
          <td class="paramname"><em>gf_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const carma_v2x_msgs::msg::TrafficControlMessageV01 &amp;&#160;</td>
          <td class="paramname"><em>msg_v01</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Populates the schedules member of the geofence object from given TrafficControlMessageV01 message. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">gf_ptr</td><td>geofence pointer </td></tr>
    <tr><td class="paramname">msg_v01</td><td>TrafficControlMessageV01 (geofence msg) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8cpp_source.html#l00117">117</a> of file <a class="el" href="WMBroadcaster_8cpp_source.html">WMBroadcaster.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  118</span>{</div>
<div class="line"><span class="lineno">  119</span>  <span class="comment">// Handle schedule processing</span></div>
<div class="line"><span class="lineno">  120</span>  carma_v2x_msgs::msg::TrafficControlSchedule msg_schedule = msg_v01.params.schedule;</div>
<div class="line"><span class="lineno">  121</span>  <span class="keywordtype">double</span> ns_to_sec = 1.0e9;</div>
<div class="line"><span class="lineno">  122</span>  <span class="keyword">auto</span> clock_type = <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#abbf8a6885fb83de6bdf0241ef3e1401f">scheduler_</a>.<a class="code hl_function" href="classcarma__wm__ctrl_1_1GeofenceScheduler.html#a2fecf322a302aff00ce8d76b0965e02e">getClockType</a>();</div>
<div class="line"><span class="lineno">  123</span>  </div>
<div class="line"><span class="lineno">  124</span>  rclcpp::Time end_time = {msg_schedule.end, clock_type};</div>
<div class="line"><span class="lineno">  125</span>  <span class="keywordflow">if</span> (!msg_schedule.end_exists) {</div>
<div class="line"><span class="lineno">  126</span>    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;No end time for geofence, using rclcpp::Time::max()&quot;</span>);</div>
<div class="line"><span class="lineno">  127</span>    end_time = {rclcpp::Time::max(), clock_type}; <span class="comment">// If there is no end time use the max time</span></div>
<div class="line"><span class="lineno">  128</span>  }</div>
<div class="line"><span class="lineno">  129</span> </div>
<div class="line"><span class="lineno">  130</span>  <span class="comment">// If the days of the week are specified then convert them to the boost format. </span></div>
<div class="line"><span class="lineno">  131</span>  <a class="code hl_typedef" href="classcarma__wm__ctrl_1_1GeofenceSchedule.html#ab1dea98b14679330b6ef2127461bf29d">GeofenceSchedule::DayOfTheWeekSet</a> week_day_set = { 0, 1, 2, 3, 4, 5, 6 }; <span class="comment">// Default to all days  0==Sun to 6==Sat</span></div>
<div class="line"><span class="lineno">  132</span>  <span class="keywordflow">if</span> (msg_schedule.dow_exists) {</div>
<div class="line"><span class="lineno">  133</span>   <span class="comment">// sun (6), mon (5), tue (4), wed (3), thu (2), fri (1), sat (0)</span></div>
<div class="line"><span class="lineno">  134</span>   week_day_set.clear();</div>
<div class="line"><span class="lineno">  135</span>   <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> = 0; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> &lt; msg_schedule.dow.dow.size(); <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>++) {</div>
<div class="line"><span class="lineno">  136</span>     <span class="keywordflow">if</span> (msg_schedule.dow.dow[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>] == 1) {</div>
<div class="line"><span class="lineno">  137</span>      <span class="keywordflow">switch</span>(<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>) {</div>
<div class="line"><span class="lineno">  138</span>          <span class="keywordflow">case</span> 6: <span class="comment">// sun</span></div>
<div class="line"><span class="lineno">  139</span>            week_day_set.emplace(boost::gregorian::greg_weekday::weekday_enum::Sunday);</div>
<div class="line"><span class="lineno">  140</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  141</span>          <span class="keywordflow">case</span> 5: <span class="comment">// mon</span></div>
<div class="line"><span class="lineno">  142</span>            week_day_set.emplace(boost::gregorian::greg_weekday::weekday_enum::Monday);</div>
<div class="line"><span class="lineno">  143</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  144</span>          <span class="keywordflow">case</span> 4: <span class="comment">// tue</span></div>
<div class="line"><span class="lineno">  145</span>            week_day_set.emplace(boost::gregorian::greg_weekday::weekday_enum::Tuesday);</div>
<div class="line"><span class="lineno">  146</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  147</span>          <span class="keywordflow">case</span> 3: <span class="comment">// wed</span></div>
<div class="line"><span class="lineno">  148</span>            week_day_set.emplace(boost::gregorian::greg_weekday::weekday_enum::Wednesday);</div>
<div class="line"><span class="lineno">  149</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  150</span>          <span class="keywordflow">case</span> 2: <span class="comment">// thur</span></div>
<div class="line"><span class="lineno">  151</span>            week_day_set.emplace(boost::gregorian::greg_weekday::weekday_enum::Thursday);</div>
<div class="line"><span class="lineno">  152</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  153</span>          <span class="keywordflow">case</span> 1: <span class="comment">// fri</span></div>
<div class="line"><span class="lineno">  154</span>            week_day_set.emplace(boost::gregorian::greg_weekday::weekday_enum::Friday);</div>
<div class="line"><span class="lineno">  155</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  156</span>          <span class="keywordflow">case</span> 0: <span class="comment">// sat</span></div>
<div class="line"><span class="lineno">  157</span>            week_day_set.emplace(boost::gregorian::greg_weekday::weekday_enum::Saturday);</div>
<div class="line"><span class="lineno">  158</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  159</span>          <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  160</span>            <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;Unrecognized weekday value: &quot;</span> + <a class="code hl_function" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5">std::to_string</a>(<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>));</div>
<div class="line"><span class="lineno">  161</span>      }</div>
<div class="line"><span class="lineno">  162</span>     }</div>
<div class="line"><span class="lineno">  163</span>   }</div>
<div class="line"><span class="lineno">  164</span>  }</div>
<div class="line"><span class="lineno">  165</span> </div>
<div class="line"><span class="lineno">  166</span>  <span class="keywordflow">if</span> (msg_schedule.between_exists) {</div>
<div class="line"><span class="lineno">  167</span> </div>
<div class="line"><span class="lineno">  168</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> daily_schedule : msg_schedule.between)</div>
<div class="line"><span class="lineno">  169</span>    {</div>
<div class="line"><span class="lineno">  170</span>      <span class="keywordflow">if</span> (msg_schedule.repeat_exists) {</div>
<div class="line"><span class="lineno">  171</span>        gf_ptr-&gt;schedules.push_back(GeofenceSchedule({msg_schedule.start, clock_type},  </div>
<div class="line"><span class="lineno">  172</span>                                    end_time,</div>
<div class="line"><span class="lineno">  173</span>                                    rclcpp::Duration(daily_schedule.begin),     </div>
<div class="line"><span class="lineno">  174</span>                                    rclcpp::Duration(daily_schedule.duration),</div>
<div class="line"><span class="lineno">  175</span>                                    rclcpp::Duration(msg_schedule.repeat.offset),</div>
<div class="line"><span class="lineno">  176</span>                                    rclcpp::Duration(msg_schedule.repeat.span),   </div>
<div class="line"><span class="lineno">  177</span>                                    rclcpp::Duration(msg_schedule.repeat.period),</div>
<div class="line"><span class="lineno">  178</span>                                    week_day_set));</div>
<div class="line"><span class="lineno">  179</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  180</span>        gf_ptr-&gt;schedules.push_back(GeofenceSchedule({msg_schedule.start, clock_type},  </div>
<div class="line"><span class="lineno">  181</span>                                  end_time,</div>
<div class="line"><span class="lineno">  182</span>                                  rclcpp::Duration(daily_schedule.begin),     </div>
<div class="line"><span class="lineno">  183</span>                                  rclcpp::Duration(daily_schedule.duration),</div>
<div class="line"><span class="lineno">  184</span>                                  rclcpp::Duration(0.0), <span class="comment">// No offset</span></div>
<div class="line"><span class="lineno">  185</span>                                  rclcpp::Duration(daily_schedule.duration) - rclcpp::Duration(daily_schedule.begin),   <span class="comment">// Compute schedule portion end time</span></div>
<div class="line"><span class="lineno">  186</span>                                  rclcpp::Duration(daily_schedule.duration) - rclcpp::Duration(daily_schedule.begin),   <span class="comment">// No repetition so same as portion end time</span></div>
<div class="line"><span class="lineno">  187</span>                                  week_day_set));         </div>
<div class="line"><span class="lineno">  188</span>      }</div>
<div class="line"><span class="lineno">  189</span> </div>
<div class="line"><span class="lineno">  190</span>    }</div>
<div class="line"><span class="lineno">  191</span>  }</div>
<div class="line"><span class="lineno">  192</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  193</span>    <span class="keywordflow">if</span> (msg_schedule.repeat_exists) {</div>
<div class="line"><span class="lineno">  194</span>      gf_ptr-&gt;schedules.push_back(GeofenceSchedule({msg_schedule.start, clock_type},  </div>
<div class="line"><span class="lineno">  195</span>                                  end_time,</div>
<div class="line"><span class="lineno">  196</span>                                  rclcpp::Duration(0.0),     </div>
<div class="line"><span class="lineno">  197</span>                                  rclcpp::Duration(86400.0e9), <span class="comment">// 24 hr daily application</span></div>
<div class="line"><span class="lineno">  198</span>                                  rclcpp::Duration(msg_schedule.repeat.offset),</div>
<div class="line"><span class="lineno">  199</span>                                  rclcpp::Duration(msg_schedule.repeat.span),   </div>
<div class="line"><span class="lineno">  200</span>                                  rclcpp::Duration(msg_schedule.repeat.period),</div>
<div class="line"><span class="lineno">  201</span>                                  week_day_set)); </div>
<div class="line"><span class="lineno">  202</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  203</span>      gf_ptr-&gt;schedules.push_back(GeofenceSchedule({msg_schedule.start, clock_type},  </div>
<div class="line"><span class="lineno">  204</span>                                  end_time,</div>
<div class="line"><span class="lineno">  205</span>                                  rclcpp::Duration(0.0),     </div>
<div class="line"><span class="lineno">  206</span>                                  rclcpp::Duration(86400.0e9), <span class="comment">// 24 hr daily application</span></div>
<div class="line"><span class="lineno">  207</span>                                  rclcpp::Duration(0.0),     <span class="comment">// No offset</span></div>
<div class="line"><span class="lineno">  208</span>                                  rclcpp::Duration(86400.0e9), <span class="comment">// Applied for full lenth of 24 hrs</span></div>
<div class="line"><span class="lineno">  209</span>                                  rclcpp::Duration(86400.0e9), <span class="comment">// No repetition</span></div>
<div class="line"><span class="lineno">  210</span>                                  week_day_set)); </div>
<div class="line"><span class="lineno">  211</span>    }</div>
<div class="line"><span class="lineno">  212</span>   </div>
<div class="line"><span class="lineno">  213</span>  }</div>
<div class="line"><span class="lineno">  214</span>}</div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1GeofenceSchedule_html_ab1dea98b14679330b6ef2127461bf29d"><div class="ttname"><a href="classcarma__wm__ctrl_1_1GeofenceSchedule.html#ab1dea98b14679330b6ef2127461bf29d">carma_wm_ctrl::GeofenceSchedule::DayOfTheWeekSet</a></div><div class="ttdeci">std::unordered_set&lt; boost::gregorian::greg_weekday, std::hash&lt; int &gt; &gt; DayOfTheWeekSet</div><div class="ttdef"><b>Definition:</b> <a href="GeofenceSchedule_8hpp_source.html#l00038">GeofenceSchedule.hpp:39</a></div></div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1GeofenceScheduler_html_a2fecf322a302aff00ce8d76b0965e02e"><div class="ttname"><a href="classcarma__wm__ctrl_1_1GeofenceScheduler.html#a2fecf322a302aff00ce8d76b0965e02e">carma_wm_ctrl::GeofenceScheduler::getClockType</a></div><div class="ttdeci">rcl_clock_type_t getClockType()</div><div class="ttdoc">Get the clock type of the clock being created by the timer factory.</div><div class="ttdef"><b>Definition:</b> <a href="GeofenceScheduler_8cpp_source.html#l00043">GeofenceScheduler.cpp:43</a></div></div>
<div class="ttc" id="anamespacecarma__cooperative__perception_html_a64b708654c8aecb09122d39577df31b5"><div class="ttname"><a href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5">carma_cooperative_perception::to_string</a></div><div class="ttdeci">auto to_string(const UtmZone &amp;zone) -&gt; std::string</div><div class="ttdef"><b>Definition:</b> <a href="utm__zone_8cpp_source.html#l00021">utm_zone.cpp:21</a></div></div>
<div class="ttc" id="anamespaceprocess__bag_html_af102a02c97622dd30b0dbf7bafb0d199"><div class="ttname"><a href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">process_bag.i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="process__bag_8py_source.html#l00059">process_bag.py:59</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="GeofenceScheduler_8cpp_source.html#l00043">carma_wm_ctrl::GeofenceScheduler::getClockType()</a>, <a class="el" href="process__bag_8py_source.html#l00059">process_bag::i</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00441">scheduler_</a>, and <a class="el" href="utm__zone_8cpp_source.html#l00021">carma_cooperative_perception::to_string()</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l01030">externalMapMsgCallback()</a>, and <a class="el" href="WMBroadcaster_8cpp_source.html#l01077">geofenceCallback()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_abea25fd0b879387b68454225ebb0ebc6_cgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_abea25fd0b879387b68454225ebb0ebc6_cgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_abea25fd0b879387b68454225ebb0ebc6_cgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_abea25fd0b879387b68454225ebb0ebc6_cgraph">
<area shape="rect" title="Populates the schedules member of the geofence object from given TrafficControlMessageV01 message." alt="" coords="5,51,216,92"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1GeofenceScheduler.html#a2fecf322a302aff00ce8d76b0965e02e" title="Get the clock type of the clock being created by the timer factory." alt="" coords="264,5,495,47"/>
<area shape="rect" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5" title=" " alt="" coords="280,95,479,136"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_abea25fd0b879387b68454225ebb0ebc6_icgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_abea25fd0b879387b68454225ebb0ebc6_icgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_abea25fd0b879387b68454225ebb0ebc6_icgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_abea25fd0b879387b68454225ebb0ebc6_icgraph">
<area shape="rect" title="Populates the schedules member of the geofence object from given TrafficControlMessageV01 message." alt="" coords="523,39,733,80"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a9d4ee6959ff334d9f4f16864e5bd0cfe" title="Callback to MAP.msg which contains intersections&#39; static info such geometry and lane ids." alt="" coords="264,5,475,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a63a919c2cf6736a80fa29a706b020330" title="Callback to add a geofence to the map. Currently only supports version 1 TrafficControlMessage." alt="" coords="264,71,475,112"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcasterNode.html#ab0c14f6d7e30870755a4dcf6b228de82" title=" " alt="" coords="5,39,216,80"/>
</map>
</div>

</div>
</div>
<a id="a243d8d82a364aad6270e38f0202a68cb" name="a243d8d82a364aad6270e38f0202a68cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a243d8d82a364aad6270e38f0202a68cb">&#9670;&nbsp;</a></span>baseMapCallback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void carma_wm_ctrl::WMBroadcaster::baseMapCallback </td>
          <td>(</td>
          <td class="paramtype">autoware_lanelet2_msgs::msg::MapBin::UniquePtr&#160;</td>
          <td class="paramname"><em>map_msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Callback to set the base map when it has been loaded. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">map_msg</td><td>The map message to use as the base map </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8cpp_source.html#l00056">56</a> of file <a class="el" href="WMBroadcaster_8cpp_source.html">WMBroadcaster.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   57</span>{</div>
<div class="line"><span class="lineno">   58</span>  std::lock_guard&lt;std::mutex&gt; guard(<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a1ac51e0b0b57eda669c87372bd079ede">map_mutex_</a>);</div>
<div class="line"><span class="lineno">   59</span> </div>
<div class="line"><span class="lineno">   60</span>  <span class="keyword">static</span> <span class="keywordtype">bool</span> firstCall = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">   61</span>  <span class="comment">// This function should generally only ever be called one time so log a warning if it occurs multiple times</span></div>
<div class="line"><span class="lineno">   62</span>  <span class="keywordflow">if</span> (firstCall)</div>
<div class="line"><span class="lineno">   63</span>  {</div>
<div class="line"><span class="lineno">   64</span>    firstCall = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   65</span>    RCLCPP_INFO_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;WMBroadcaster::baseMapCallback called for first time with new map message&quot;</span>);</div>
<div class="line"><span class="lineno">   66</span>  }</div>
<div class="line"><span class="lineno">   67</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">   68</span>  {</div>
<div class="line"><span class="lineno">   69</span>    RCLCPP_WARN_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;WMBroadcaster::baseMapCallback called multiple times in the same node&quot;</span>);</div>
<div class="line"><span class="lineno">   70</span>  }</div>
<div class="line"><span class="lineno">   71</span> </div>
<div class="line"><span class="lineno">   72</span>  lanelet::LaneletMapPtr new_map(<span class="keyword">new</span> lanelet::LaneletMap);</div>
<div class="line"><span class="lineno">   73</span>  lanelet::LaneletMapPtr new_map_to_change(<span class="keyword">new</span> lanelet::LaneletMap);</div>
<div class="line"><span class="lineno">   74</span> </div>
<div class="line"><span class="lineno">   75</span>  <a class="code hl_function" href="namespacecarma__wm.html#a3c6c82d3e0fcfc7dd50176a453598911">lanelet::utils::conversion::fromBinMsg</a>(*map_msg, new_map);</div>
<div class="line"><span class="lineno">   76</span>  <a class="code hl_function" href="namespacecarma__wm.html#a3c6c82d3e0fcfc7dd50176a453598911">lanelet::utils::conversion::fromBinMsg</a>(*map_msg, new_map_to_change);</div>
<div class="line"><span class="lineno">   77</span> </div>
<div class="line"><span class="lineno">   78</span>  <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a3a0a12165535501b0dc4e174f3029642">base_map_</a> = new_map;  <span class="comment">// Store map</span></div>
<div class="line"><span class="lineno">   79</span>  <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a> = new_map_to_change; <span class="comment">// broadcaster makes changes to this</span></div>
<div class="line"><span class="lineno">   80</span> </div>
<div class="line"><span class="lineno">   81</span>  <a class="code hl_function" href="namespacelanelet_1_1MapConformer.html#a20caaf0f529166126f0f4ea4d80f80d0">lanelet::MapConformer::ensureCompliance</a>(<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a3a0a12165535501b0dc4e174f3029642">base_map_</a>, <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a4bf605c8ea54b5a03e01d010d6014389">config_limit</a>);     <span class="comment">// Update map to ensure it complies with expectations</span></div>
<div class="line"><span class="lineno">   82</span>  <a class="code hl_function" href="namespacelanelet_1_1MapConformer.html#a20caaf0f529166126f0f4ea4d80f80d0">lanelet::MapConformer::ensureCompliance</a>(<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>, <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a4bf605c8ea54b5a03e01d010d6014389">config_limit</a>);</div>
<div class="line"><span class="lineno">   83</span> </div>
<div class="line"><span class="lineno">   84</span>  RCLCPP_INFO_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Building routing graph for base map&quot;</span>);</div>
<div class="line"><span class="lineno">   85</span> </div>
<div class="line"><span class="lineno">   86</span>  lanelet::traffic_rules::TrafficRulesUPtr traffic_rules_car = lanelet::traffic_rules::TrafficRulesFactory::create(</div>
<div class="line"><span class="lineno">   87</span>  lanelet::traffic_rules::CarmaUSTrafficRules::Location, <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a9d9fd775035c8389502d5185fa890070">participant_</a>);</div>
<div class="line"><span class="lineno">   88</span>  <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a4c64c73d83158f9b82682ad3bcc4af74">current_routing_graph_</a> = lanelet::routing::RoutingGraph::build(*<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>, *traffic_rules_car);</div>
<div class="line"><span class="lineno">   89</span> </div>
<div class="line"><span class="lineno">   90</span>  RCLCPP_INFO_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Done building routing graph for base map&quot;</span>);</div>
<div class="line"><span class="lineno">   91</span> </div>
<div class="line"><span class="lineno">   92</span>  <span class="comment">// Publish map</span></div>
<div class="line"><span class="lineno">   93</span>  <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ab963fffc1b41395dd3393aee9b3e88e4">current_map_version_</a> += 1; <span class="comment">// Increment the map version. It should always start from 1 for the first map</span></div>
<div class="line"><span class="lineno">   94</span>  </div>
<div class="line"><span class="lineno">   95</span>  autoware_lanelet2_msgs::msg::MapBin compliant_map_msg;</div>
<div class="line"><span class="lineno">   96</span> </div>
<div class="line"><span class="lineno">   97</span>  <span class="comment">// Populate the routing graph message</span></div>
<div class="line"><span class="lineno">   98</span>  RCLCPP_INFO_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Creating routing graph message.&quot;</span>);</div>
<div class="line"><span class="lineno">   99</span> </div>
<div class="line"><span class="lineno">  100</span>  <span class="keyword">auto</span> readable_graph = std::static_pointer_cast&lt;RoutingGraphAccessor&gt;(<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a4c64c73d83158f9b82682ad3bcc4af74">current_routing_graph_</a>);</div>
<div class="line"><span class="lineno">  101</span> </div>
<div class="line"><span class="lineno">  102</span>  compliant_map_msg.routing_graph = readable_graph-&gt;routingGraphToMsg(<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a9d9fd775035c8389502d5185fa890070">participant_</a>);</div>
<div class="line"><span class="lineno">  103</span>  compliant_map_msg.has_routing_graph = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  104</span> </div>
<div class="line"><span class="lineno">  105</span>  RCLCPP_INFO_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Done creating routing graph message.&quot;</span>);</div>
<div class="line"><span class="lineno">  106</span> </div>
<div class="line"><span class="lineno">  107</span>  <a class="code hl_function" href="namespacecarma__wm.html#aef665263f7df5afa3781f4319fe95e9c">lanelet::utils::conversion::toBinMsg</a>(<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>, &amp;compliant_map_msg);</div>
<div class="line"><span class="lineno">  108</span>  compliant_map_msg.map_version = <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ab963fffc1b41395dd3393aee9b3e88e4">current_map_version_</a>;</div>
<div class="line"><span class="lineno">  109</span>  <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aa787188a277093da1500213ddcfc67ef">map_pub_</a>(compliant_map_msg);</div>
<div class="line"><span class="lineno">  110</span>};</div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_a3a0a12165535501b0dc4e174f3029642"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a3a0a12165535501b0dc4e174f3029642">carma_wm_ctrl::WMBroadcaster::base_map_</a></div><div class="ttdeci">lanelet::LaneletMapPtr base_map_</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8hpp_source.html#l00428">WMBroadcaster.hpp:428</a></div></div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_a4bf605c8ea54b5a03e01d010d6014389"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a4bf605c8ea54b5a03e01d010d6014389">carma_wm_ctrl::WMBroadcaster::config_limit</a></div><div class="ttdeci">lanelet::Velocity config_limit</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8hpp_source.html#l00431">WMBroadcaster.hpp:431</a></div></div>
<div class="ttc" id="anamespacecarma__wm_html_a3c6c82d3e0fcfc7dd50176a453598911"><div class="ttname"><a href="namespacecarma__wm.html#a3c6c82d3e0fcfc7dd50176a453598911">carma_wm::fromBinMsg</a></div><div class="ttdeci">void fromBinMsg(const autoware_lanelet2_msgs::msg::MapBin &amp;msg, std::shared_ptr&lt; carma_wm::TrafficControl &gt; gf_ptr, lanelet::LaneletMapPtr lanelet_map=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="TrafficControl_8cpp_source.html#l00040">TrafficControl.cpp:40</a></div></div>
<div class="ttc" id="anamespacelanelet_1_1MapConformer_html_a20caaf0f529166126f0f4ea4d80f80d0"><div class="ttname"><a href="namespacelanelet_1_1MapConformer.html#a20caaf0f529166126f0f4ea4d80f80d0">lanelet::MapConformer::ensureCompliance</a></div><div class="ttdeci">void ensureCompliance(lanelet::LaneletMapPtr map, lanelet::Velocity config_limit=80_mph)</div><div class="ttdoc">Function modifies an existing map to make a best effort attempt at ensuring the map confroms to the e...</div><div class="ttdef"><b>Definition:</b> <a href="MapConformer_8cpp_source.html#l00550">MapConformer.cpp:550</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMBroadcaster_8hpp_source.html#l00428">base_map_</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00431">config_limit</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00429">current_map_</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00451">current_map_version_</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00430">current_routing_graph_</a>, <a class="el" href="MapConformer_8cpp_source.html#l00550">lanelet::MapConformer::ensureCompliance()</a>, <a class="el" href="TrafficControl_8cpp_source.html#l00040">carma_wm::fromBinMsg()</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00436">map_mutex_</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00437">map_pub_</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00432">participant_</a>, and <a class="el" href="TrafficControl_8cpp_source.html#l00024">carma_wm::toBinMsg()</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcasterNode_8cpp_source.html#l00153">carma_wm_ctrl::WMBroadcasterNode::handle_on_activate()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_a243d8d82a364aad6270e38f0202a68cb_cgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_a243d8d82a364aad6270e38f0202a68cb_cgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_a243d8d82a364aad6270e38f0202a68cb_cgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_a243d8d82a364aad6270e38f0202a68cb_cgraph">
<area shape="rect" title="Callback to set the base map when it has been loaded." alt="" coords="5,268,216,309"/>
<area shape="rect" href="namespacelanelet_1_1MapConformer.html#a20caaf0f529166126f0f4ea4d80f80d0" title="Function modifies an existing map to make a best effort attempt at ensuring the map confroms to the e..." alt="" coords="270,209,421,251"/>
<area shape="rect" href="namespacecarma__wm.html#a3c6c82d3e0fcfc7dd50176a453598911" title=" " alt="" coords="264,275,427,302"/>
<area shape="rect" href="namespacecarma__wm.html#aef665263f7df5afa3781f4319fe95e9c" title=" " alt="" coords="272,326,419,353"/>
<area shape="rect" href="namespacelanelet_1_1MapConformer_1_1anonymous__namespace_02MapConformer_8cpp_03.html#ae80c94af49478480f8b4795333455307" title="Generate RegionAccessRules from the inferred regulations in the provided map and area." alt="" coords="481,5,695,76"/>
<area shape="rect" href="namespacelanelet_1_1MapConformer_1_1anonymous__namespace_02MapConformer_8cpp_03.html#a4319f59405930feb81d5313eefde3a2c" title="Generate DirectionOfTravel from the inferred regulations in the provided map and lanelet Only adds a ..." alt="" coords="481,100,695,171"/>
<area shape="rect" href="namespacelanelet_1_1MapConformer_1_1anonymous__namespace_02MapConformer_8cpp_03.html#a977838b10c0e695c774107fd26c335f7" title="Generate PassingControlLines from the inferred regulations in the provided map and area." alt="" coords="481,195,695,265"/>
<area shape="rect" href="namespacelanelet_1_1MapConformer_1_1anonymous__namespace_02MapConformer_8cpp_03.html#a76a04caafb69f81d7f16c58060b3644f" title=" " alt="" coords="489,289,687,360"/>
<area shape="rect" href="namespacelanelet_1_1MapConformer_1_1anonymous__namespace_02MapConformer_8cpp_03.html#a01b13b2659da99328b90f3d9ef8a332a" title="Helper function to return the set of all german traffic rules which are currently implemented." alt="" coords="475,384,701,455"/>
<area shape="rect" href="namespacelanelet_1_1MapConformer_1_1anonymous__namespace_02MapConformer_8cpp_03.html#a20f16cf50f446f986b716c00d71c6e86" title="Helper function constructs a PassingControlLine based off the provided bound and lane change type." alt="" coords="749,162,991,218"/>
<area shape="rect" href="namespacelanelet_1_1MapConformer_1_1anonymous__namespace_02MapConformer_8cpp_03.html#a3dcd4f6f6ba91a1012f1200d38bc16af" title="Helper function to determine the type of lane change implicitly allowed by the markings on the road." alt="" coords="751,242,989,298"/>
<area shape="rect" href="namespacelanelet_1_1MapConformer_1_1anonymous__namespace_02MapConformer_8cpp_03.html#ae5cd14f5d9ebf27510d794f22e61e887" title="Helper function to get a value from a map or return a default value when key is not present." alt="" coords="1039,191,1244,261"/>
<area shape="rect" href="namespacelanelet_1_1MapConformer_1_1anonymous__namespace_02MapConformer_8cpp_03.html#ac65728eb2e5688331a88d9dd20ac75a3" title="Helper function to check if a string starts with another string." alt="" coords="1039,286,1244,342"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_a243d8d82a364aad6270e38f0202a68cb_icgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_a243d8d82a364aad6270e38f0202a68cb_icgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_a243d8d82a364aad6270e38f0202a68cb_icgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_a243d8d82a364aad6270e38f0202a68cb_icgraph">
<area shape="rect" title="Callback to set the base map when it has been loaded." alt="" coords="264,5,475,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcasterNode.html#ab0c14f6d7e30870755a4dcf6b228de82" title=" " alt="" coords="5,5,216,47"/>
</map>
</div>

</div>
</div>
<a id="a7c4ca5d0774ffa2aa06fbf0f979b02b0" name="a7c4ca5d0774ffa2aa06fbf0f979b02b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c4ca5d0774ffa2aa06fbf0f979b02b0">&#9670;&nbsp;</a></span>checkActiveGeofenceLogic()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">carma_perception_msgs::msg::CheckActiveGeofence carma_wm_ctrl::WMBroadcaster::checkActiveGeofenceLogic </td>
          <td>(</td>
          <td class="paramtype">const geometry_msgs::msg::PoseStamped &amp;&#160;</td>
          <td class="paramname"><em>current_pos</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns a message indicating whether or not the vehicle is inside of an active geofence lanelet. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">current_pos</td><td>Current position of the vehicle </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if vehicle is not on an active geofence </dd></dl>

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8cpp_source.html#l02012">2012</a> of file <a class="el" href="WMBroadcaster_8cpp_source.html">WMBroadcaster.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2013</span>{</div>
<div class="line"><span class="lineno"> 2014</span> </div>
<div class="line"><span class="lineno"> 2015</span>  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a> || <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;laneletLayer.size() == 0) </div>
<div class="line"><span class="lineno"> 2016</span>  {</div>
<div class="line"><span class="lineno"> 2017</span>    <span class="keywordflow">throw</span> lanelet::InvalidObjectStateError(std::string(<span class="stringliteral">&quot;Lanelet map &#39;current_map_&#39; is not loaded to the WMBroadcaster&quot;</span>));</div>
<div class="line"><span class="lineno"> 2018</span>  }</div>
<div class="line"><span class="lineno"> 2019</span> </div>
<div class="line"><span class="lineno"> 2020</span>  <span class="comment">// Store current position values to be compared to geofence boundary values</span></div>
<div class="line"><span class="lineno"> 2021</span>  <span class="keywordtype">double</span> current_pos_x = current_pos.pose.position.x;</div>
<div class="line"><span class="lineno"> 2022</span>  <span class="keywordtype">double</span> current_pos_y = current_pos.pose.position.y;</div>
<div class="line"><span class="lineno"> 2023</span> </div>
<div class="line"><span class="lineno"> 2024</span>  </div>
<div class="line"><span class="lineno"> 2025</span>  </div>
<div class="line"><span class="lineno"> 2026</span> </div>
<div class="line"><span class="lineno"> 2027</span>  lanelet::BasicPoint2d curr_pos;</div>
<div class="line"><span class="lineno"> 2028</span>  curr_pos.x() = current_pos_x;</div>
<div class="line"><span class="lineno"> 2029</span>  curr_pos.y() = current_pos_y;</div>
<div class="line"><span class="lineno"> 2030</span> </div>
<div class="line"><span class="lineno"> 2031</span>  carma_perception_msgs::msg::CheckActiveGeofence outgoing_geof; <span class="comment">//message to publish</span></div>
<div class="line"><span class="lineno"> 2032</span>  <span class="keywordtype">double</span> next_distance = 0 ; <span class="comment">//Distance to next geofence</span></div>
<div class="line"><span class="lineno"> 2033</span> </div>
<div class="line"><span class="lineno"> 2034</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a9f7ae45f954ed5f177756a56b9387545">active_geofence_llt_ids_</a>.size() &lt;= 0 ) </div>
<div class="line"><span class="lineno"> 2035</span>  {</div>
<div class="line"><span class="lineno"> 2036</span>    <span class="keywordflow">return</span> outgoing_geof;</div>
<div class="line"><span class="lineno"> 2037</span>  }</div>
<div class="line"><span class="lineno"> 2038</span>  </div>
<div class="line"><span class="lineno"> 2039</span>  RCLCPP_INFO_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Active geofence llt ids are loaded to the WMBroadcaster&quot;</span>);</div>
<div class="line"><span class="lineno"> 2040</span> </div>
<div class="line"><span class="lineno"> 2041</span>  <span class="comment">// Obtain the closest lanelet to the vehicle&#39;s current position</span></div>
<div class="line"><span class="lineno"> 2042</span>  <span class="keyword">auto</span> current_llt = lanelet::geometry::findNearest(<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;laneletLayer, curr_pos, 1)[0].second;</div>
<div class="line"><span class="lineno"> 2043</span> </div>
<div class="line"><span class="lineno"> 2044</span> </div>
<div class="line"><span class="lineno"> 2045</span>  <span class="comment">/* determine whether or not the vehicle&#39;s current position is within an active geofence */</span></div>
<div class="line"><span class="lineno"> 2046</span>  <span class="keywordflow">if</span> (boost::geometry::within(curr_pos, current_llt.polygon2d().basicPolygon()))</div>
<div class="line"><span class="lineno"> 2047</span>  {         </div>
<div class="line"><span class="lineno"> 2048</span>    next_distance = <a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a35a706cbbb3b04dc4dfc3eea40ececcc">distToNearestActiveGeofence</a>(curr_pos);</div>
<div class="line"><span class="lineno"> 2049</span>    outgoing_geof.distance_to_next_geofence = next_distance;</div>
<div class="line"><span class="lineno"> 2050</span> </div>
<div class="line"><span class="lineno"> 2051</span>    <span class="keywordflow">for</span>(<span class="keyword">auto</span> <span class="keywordtype">id</span> : <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a9f7ae45f954ed5f177756a56b9387545">active_geofence_llt_ids_</a>) </div>
<div class="line"><span class="lineno"> 2052</span>    {</div>
<div class="line"><span class="lineno"> 2053</span>      <span class="keywordflow">if</span> (<span class="keywordtype">id</span> == current_llt.id())</div>
<div class="line"><span class="lineno"> 2054</span>      {           </div>
<div class="line"><span class="lineno"> 2055</span>        RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Vehicle is on Lanelet &quot;</span> &lt;&lt; current_llt.id() &lt;&lt; <span class="stringliteral">&quot;, which has an active geofence&quot;</span>);</div>
<div class="line"><span class="lineno"> 2056</span>        outgoing_geof.is_on_active_geofence = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2057</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> regem: current_llt.regulatoryElements())</div>
<div class="line"><span class="lineno"> 2058</span>        {</div>
<div class="line"><span class="lineno"> 2059</span>          <span class="comment">// Assign active geofence fields based on the speed limit associated with this lanelet</span></div>
<div class="line"><span class="lineno"> 2060</span>          <span class="keywordflow">if</span> (regem-&gt;attribute(lanelet::AttributeName::Subtype).value().compare(lanelet::DigitalSpeedLimit::RuleName) == 0)</div>
<div class="line"><span class="lineno"> 2061</span>          {</div>
<div class="line"><span class="lineno"> 2062</span>            lanelet::DigitalSpeedLimitPtr speed =  std::dynamic_pointer_cast&lt;lanelet::DigitalSpeedLimit&gt;</div>
<div class="line"><span class="lineno"> 2063</span>            (<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;regulatoryElementLayer.get(regem-&gt;id()));</div>
<div class="line"><span class="lineno"> 2064</span>            outgoing_geof.value = speed-&gt;speed_limit_.value();</div>
<div class="line"><span class="lineno"> 2065</span>            outgoing_geof.advisory_speed = speed-&gt;speed_limit_.value();</div>
<div class="line"><span class="lineno"> 2066</span>            outgoing_geof.reason = speed-&gt;getReason(); </div>
<div class="line"><span class="lineno"> 2067</span> </div>
<div class="line"><span class="lineno"> 2068</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Active geofence has a speed limit of &quot;</span> &lt;&lt; speed-&gt;speed_limit_.value());</div>
<div class="line"><span class="lineno"> 2069</span>                    </div>
<div class="line"><span class="lineno"> 2070</span>            <span class="comment">// Cannot overrule outgoing_geof.type if it is already set to LANE_CLOSED</span></div>
<div class="line"><span class="lineno"> 2071</span>            <span class="keywordflow">if</span>(outgoing_geof.type != carma_perception_msgs::msg::CheckActiveGeofence::LANE_CLOSED)</div>
<div class="line"><span class="lineno"> 2072</span>            {</div>
<div class="line"><span class="lineno"> 2073</span>              outgoing_geof.type = carma_perception_msgs::msg::CheckActiveGeofence::SPEED_LIMIT;</div>
<div class="line"><span class="lineno"> 2074</span>            }</div>
<div class="line"><span class="lineno"> 2075</span>          }</div>
<div class="line"><span class="lineno"> 2076</span> </div>
<div class="line"><span class="lineno"> 2077</span>          <span class="comment">// Assign active geofence fields based on the minimum gap associated with this lanelet (if it exists)</span></div>
<div class="line"><span class="lineno"> 2078</span>          <span class="keywordflow">if</span>(regem-&gt;attribute(lanelet::AttributeName::Subtype).value().compare(lanelet::DigitalMinimumGap::RuleName) == 0)</div>
<div class="line"><span class="lineno"> 2079</span>          {</div>
<div class="line"><span class="lineno"> 2080</span>            lanelet::DigitalMinimumGapPtr min_gap =  std::dynamic_pointer_cast&lt;lanelet::DigitalMinimumGap&gt;</div>
<div class="line"><span class="lineno"> 2081</span>            (<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;regulatoryElementLayer.get(regem-&gt;id()));</div>
<div class="line"><span class="lineno"> 2082</span>            outgoing_geof.minimum_gap = min_gap-&gt;getMinimumGap();</div>
<div class="line"><span class="lineno"> 2083</span>            RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Active geofence has a minimum gap of &quot;</span> &lt;&lt; min_gap-&gt;getMinimumGap());</div>
<div class="line"><span class="lineno"> 2084</span>          }</div>
<div class="line"><span class="lineno"> 2085</span>                 </div>
<div class="line"><span class="lineno"> 2086</span>          <span class="comment">// Assign active geofence fields based on whether the current lane is closed or is immediately adjacent to a closed lane</span></div>
<div class="line"><span class="lineno"> 2087</span>          <span class="keywordflow">if</span>(regem-&gt;attribute(lanelet::AttributeName::Subtype).value().compare(lanelet::RegionAccessRule::RuleName) == 0)</div>
<div class="line"><span class="lineno"> 2088</span>          {</div>
<div class="line"><span class="lineno"> 2089</span>            lanelet::RegionAccessRulePtr accessRuleReg =  std::dynamic_pointer_cast&lt;lanelet::RegionAccessRule&gt;</div>
<div class="line"><span class="lineno"> 2090</span>            (<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;regulatoryElementLayer.get(regem-&gt;id()));</div>
<div class="line"><span class="lineno"> 2091</span> </div>
<div class="line"><span class="lineno"> 2092</span>            <span class="comment">// Update the &#39;type&#39; and &#39;reason&#39; for this active geofence if the vehicle is in a closed lane</span></div>
<div class="line"><span class="lineno"> 2093</span>            <span class="keywordflow">if</span>(!accessRuleReg-&gt;accessable(lanelet::Participants::VehicleCar) || !accessRuleReg-&gt;accessable(lanelet::Participants::VehicleTruck)) </div>
<div class="line"><span class="lineno"> 2094</span>            {</div>
<div class="line"><span class="lineno"> 2095</span>              RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Active geofence is a closed lane.&quot;</span>);</div>
<div class="line"><span class="lineno"> 2096</span>              RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Closed lane reason: &quot;</span> &lt;&lt; accessRuleReg-&gt;getReason());</div>
<div class="line"><span class="lineno"> 2097</span>              outgoing_geof.reason = accessRuleReg-&gt;getReason();</div>
<div class="line"><span class="lineno"> 2098</span>              outgoing_geof.type = carma_perception_msgs::msg::CheckActiveGeofence::LANE_CLOSED;</div>
<div class="line"><span class="lineno"> 2099</span>            }</div>
<div class="line"><span class="lineno"> 2100</span>            <span class="comment">// Otherwise, update the &#39;type&#39; and &#39;reason&#39; for this active geofence if the vehicle is in a lane immediately adjacent to a closed lane with the same travel direction</span></div>
<div class="line"><span class="lineno"> 2101</span>            <span class="keywordflow">else</span> </div>
<div class="line"><span class="lineno"> 2102</span>            {</div>
<div class="line"><span class="lineno"> 2103</span>              <span class="comment">// Obtain all same-direction lanes sharing the right lane boundary (will include the current lanelet)</span></div>
<div class="line"><span class="lineno"> 2104</span>              <span class="keyword">auto</span> right_boundary_lanelets = <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;laneletLayer.findUsages(current_llt.rightBound());</div>
<div class="line"><span class="lineno"> 2105</span> </div>
<div class="line"><span class="lineno"> 2106</span>              <span class="comment">// Check if the adjacent right lane is closed</span></div>
<div class="line"><span class="lineno"> 2107</span>              <span class="keywordflow">if</span>(right_boundary_lanelets.size() &gt; 1)</div>
<div class="line"><span class="lineno"> 2108</span>              {</div>
<div class="line"><span class="lineno"> 2109</span>                <span class="keywordflow">for</span>(<span class="keyword">auto</span> <a class="code hl_namespace" href="namespacelanelet.html">lanelet</a> : right_boundary_lanelets)</div>
<div class="line"><span class="lineno"> 2110</span>                {</div>
<div class="line"><span class="lineno"> 2111</span>                  <span class="comment">// Only check the adjacent right lanelet; ignore the current lanelet</span></div>
<div class="line"><span class="lineno"> 2112</span>                  <span class="keywordflow">if</span>(<a class="code hl_namespace" href="namespacelanelet.html">lanelet</a>.id() != current_llt.id())</div>
<div class="line"><span class="lineno"> 2113</span>                  {</div>
<div class="line"><span class="lineno"> 2114</span>                    <span class="keywordflow">for</span> (<span class="keyword">auto</span> rightRegem: <a class="code hl_namespace" href="namespacelanelet.html">lanelet</a>.regulatoryElements())</div>
<div class="line"><span class="lineno"> 2115</span>                    {</div>
<div class="line"><span class="lineno"> 2116</span>                      <span class="keywordflow">if</span>(rightRegem-&gt;attribute(lanelet::AttributeName::Subtype).value().compare(lanelet::RegionAccessRule::RuleName) == 0)</div>
<div class="line"><span class="lineno"> 2117</span>                      {</div>
<div class="line"><span class="lineno"> 2118</span>                        lanelet::RegionAccessRulePtr rightAccessRuleReg =  std::dynamic_pointer_cast&lt;lanelet::RegionAccessRule&gt;</div>
<div class="line"><span class="lineno"> 2119</span>                        (<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;regulatoryElementLayer.get(rightRegem-&gt;id()));</div>
<div class="line"><span class="lineno"> 2120</span>                        <span class="keywordflow">if</span>(!rightAccessRuleReg-&gt;accessable(lanelet::Participants::VehicleCar) || !rightAccessRuleReg-&gt;accessable(lanelet::Participants::VehicleTruck))</div>
<div class="line"><span class="lineno"> 2121</span>                        {</div>
<div class="line"><span class="lineno"> 2122</span>                          RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Right adjacent Lanelet &quot;</span> &lt;&lt; <a class="code hl_namespace" href="namespacelanelet.html">lanelet</a>.id() &lt;&lt; <span class="stringliteral">&quot; is CLOSED&quot;</span>);</div>
<div class="line"><span class="lineno"> 2123</span>                          RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Assigning LANE_CLOSED type to active geofence&quot;</span>);</div>
<div class="line"><span class="lineno"> 2124</span>                          RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Assigning reason &quot;</span> &lt;&lt; rightAccessRuleReg-&gt;getReason());</div>
<div class="line"><span class="lineno"> 2125</span>                          outgoing_geof.reason = rightAccessRuleReg-&gt;getReason();</div>
<div class="line"><span class="lineno"> 2126</span>                          outgoing_geof.type = carma_perception_msgs::msg::CheckActiveGeofence::LANE_CLOSED;</div>
<div class="line"><span class="lineno"> 2127</span>                        }</div>
<div class="line"><span class="lineno"> 2128</span>                      }</div>
<div class="line"><span class="lineno"> 2129</span>                    }</div>
<div class="line"><span class="lineno"> 2130</span>                  }</div>
<div class="line"><span class="lineno"> 2131</span>                }</div>
<div class="line"><span class="lineno"> 2132</span>              }</div>
<div class="line"><span class="lineno"> 2133</span> </div>
<div class="line"><span class="lineno"> 2134</span>              <span class="comment">// Check if the adjacent left lane is closed</span></div>
<div class="line"><span class="lineno"> 2135</span>              <span class="keyword">auto</span> left_boundary_lanelets = <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;laneletLayer.findUsages(current_llt.leftBound());</div>
<div class="line"><span class="lineno"> 2136</span>              <span class="keywordflow">if</span>(left_boundary_lanelets.size() &gt; 1)</div>
<div class="line"><span class="lineno"> 2137</span>              {</div>
<div class="line"><span class="lineno"> 2138</span>                <span class="keywordflow">for</span>(<span class="keyword">auto</span> <a class="code hl_namespace" href="namespacelanelet.html">lanelet</a> : left_boundary_lanelets)</div>
<div class="line"><span class="lineno"> 2139</span>                {</div>
<div class="line"><span class="lineno"> 2140</span>                  <span class="comment">// Only check the adjacent left lanelet; ignore the current lanelet</span></div>
<div class="line"><span class="lineno"> 2141</span>                  <span class="keywordflow">if</span>(<a class="code hl_namespace" href="namespacelanelet.html">lanelet</a>.id() != current_llt.id())</div>
<div class="line"><span class="lineno"> 2142</span>                  {</div>
<div class="line"><span class="lineno"> 2143</span>                    <span class="keywordflow">for</span> (<span class="keyword">auto</span> leftRegem: <a class="code hl_namespace" href="namespacelanelet.html">lanelet</a>.regulatoryElements())</div>
<div class="line"><span class="lineno"> 2144</span>                    {</div>
<div class="line"><span class="lineno"> 2145</span>                      <span class="keywordflow">if</span>(leftRegem-&gt;attribute(lanelet::AttributeName::Subtype).value().compare(lanelet::RegionAccessRule::RuleName) == 0)</div>
<div class="line"><span class="lineno"> 2146</span>                      {</div>
<div class="line"><span class="lineno"> 2147</span>                        lanelet::RegionAccessRulePtr leftAccessRuleReg =  std::dynamic_pointer_cast&lt;lanelet::RegionAccessRule&gt;</div>
<div class="line"><span class="lineno"> 2148</span>                        (<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;regulatoryElementLayer.get(leftRegem-&gt;id()));</div>
<div class="line"><span class="lineno"> 2149</span>                        <span class="keywordflow">if</span>(!leftAccessRuleReg-&gt;accessable(lanelet::Participants::VehicleCar) || !leftAccessRuleReg-&gt;accessable(lanelet::Participants::VehicleTruck))</div>
<div class="line"><span class="lineno"> 2150</span>                        {</div>
<div class="line"><span class="lineno"> 2151</span>                          RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Left adjacent Lanelet &quot;</span> &lt;&lt; <a class="code hl_namespace" href="namespacelanelet.html">lanelet</a>.id() &lt;&lt; <span class="stringliteral">&quot; is CLOSED&quot;</span>);</div>
<div class="line"><span class="lineno"> 2152</span>                          RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Assigning LANE_CLOSED type to active geofence&quot;</span>);</div>
<div class="line"><span class="lineno"> 2153</span>                          RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Assigning reason &quot;</span> &lt;&lt; leftAccessRuleReg-&gt;getReason());</div>
<div class="line"><span class="lineno"> 2154</span>                          outgoing_geof.reason = leftAccessRuleReg-&gt;getReason();</div>
<div class="line"><span class="lineno"> 2155</span>                          outgoing_geof.type = carma_perception_msgs::msg::CheckActiveGeofence::LANE_CLOSED;</div>
<div class="line"><span class="lineno"> 2156</span>                        }</div>
<div class="line"><span class="lineno"> 2157</span>                      }</div>
<div class="line"><span class="lineno"> 2158</span>                    }</div>
<div class="line"><span class="lineno"> 2159</span>                  }</div>
<div class="line"><span class="lineno"> 2160</span>                }</div>
<div class="line"><span class="lineno"> 2161</span>              }</div>
<div class="line"><span class="lineno"> 2162</span>            }</div>
<div class="line"><span class="lineno"> 2163</span>          }</div>
<div class="line"><span class="lineno"> 2164</span>        }</div>
<div class="line"><span class="lineno"> 2165</span>      }</div>
<div class="line"><span class="lineno"> 2166</span>    }</div>
<div class="line"><span class="lineno"> 2167</span>  }</div>
<div class="line"><span class="lineno"> 2168</span>  <span class="keywordflow">return</span> outgoing_geof;</div>
<div class="line"><span class="lineno"> 2169</span>}</div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_a35a706cbbb3b04dc4dfc3eea40ececcc"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a35a706cbbb3b04dc4dfc3eea40ececcc">carma_wm_ctrl::WMBroadcaster::distToNearestActiveGeofence</a></div><div class="ttdeci">double distToNearestActiveGeofence(const lanelet::BasicPoint2d &amp;curr_pos)</div><div class="ttdoc">Returns the route distance (downtrack or crosstrack in meters) to the nearest active geofence lanelet...</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8cpp_source.html#l01868">WMBroadcaster.cpp:1868</a></div></div>
<div class="ttc" id="anamespacelanelet_html"><div class="ttname"><a href="namespacelanelet.html">lanelet</a></div><div class="ttdef"><b>Definition:</b> <a href="MapConformer_8hpp_source.html#l00038">MapConformer.hpp:39</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMBroadcaster_8hpp_source.html#l00411">active_geofence_llt_ids_</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00429">current_map_</a>, and <a class="el" href="WMBroadcaster_8cpp_source.html#l01868">distToNearestActiveGeofence()</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l01946">currentLocationCallback()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_a7c4ca5d0774ffa2aa06fbf0f979b02b0_cgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_a7c4ca5d0774ffa2aa06fbf0f979b02b0_cgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_a7c4ca5d0774ffa2aa06fbf0f979b02b0_cgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_a7c4ca5d0774ffa2aa06fbf0f979b02b0_cgraph">
<area shape="rect" title="Returns a message indicating whether or not the vehicle is inside of an active geofence lanelet." alt="" coords="5,5,216,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a35a706cbbb3b04dc4dfc3eea40ececcc" title="Returns the route distance (downtrack or crosstrack in meters) to the nearest active geofence lanelet..." alt="" coords="264,5,475,47"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#aebce986f21c117983313292d5e82b50a" title="Returns the TrackPos, computed in 2d, of the provided point relative to the centerline of the provide..." alt="" coords="523,5,668,47"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#ab675b2b8862a2ba9c139a8b5b353b846" title="Get the TrackPos of the provided point along the linestring and the segment of the line string which ..." alt="" coords="716,5,861,47"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#ae0a06818149f7430fee80e295ef04548" title="Helper function to identify whether to select the preceeding or succeeding segment of a linstring poi..." alt="" coords="909,5,1055,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_a7c4ca5d0774ffa2aa06fbf0f979b02b0_icgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_a7c4ca5d0774ffa2aa06fbf0f979b02b0_icgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_a7c4ca5d0774ffa2aa06fbf0f979b02b0_icgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_a7c4ca5d0774ffa2aa06fbf0f979b02b0_icgraph">
<area shape="rect" title="Returns a message indicating whether or not the vehicle is inside of an active geofence lanelet." alt="" coords="523,5,733,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a7269b37f5fcdbc502122c980fa814387" title=" " alt="" coords="264,5,475,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcasterNode.html#ab0c14f6d7e30870755a4dcf6b228de82" title=" " alt="" coords="5,5,216,47"/>
</map>
</div>

</div>
</div>
<a id="a2c6c3606e5f4b3c12a984261823c1d71" name="a2c6c3606e5f4b3c12a984261823c1d71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c6c3606e5f4b3c12a984261823c1d71">&#9670;&nbsp;</a></span>combineParticipantsToVehicle()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::string &gt; carma_wm_ctrl::WMBroadcaster::combineParticipantsToVehicle </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>input_participants</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Combines a list of the given participants into a single "vehicle" type if participants cover all possible vehicle types. Returns the input with no change if it doesn't cover all. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">std::vector&lt;std::string&gt;</td><td>participants vector of strings </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8cpp_source.html#l01009">1009</a> of file <a class="el" href="WMBroadcaster_8cpp_source.html">WMBroadcaster.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1010</span>{</div>
<div class="line"><span class="lineno"> 1011</span>  std::vector&lt;std::string&gt; participants;</div>
<div class="line"><span class="lineno"> 1012</span> </div>
<div class="line"><span class="lineno"> 1013</span>  <span class="keywordflow">if</span>(std::find(input_participants.begin(),input_participants.end(),lanelet::Participants::VehicleMotorcycle)!= input_participants.end() &amp;&amp;</div>
<div class="line"><span class="lineno"> 1014</span>      std::find(input_participants.begin(),input_participants.end(),lanelet::Participants::VehicleBus) != input_participants.end() &amp;&amp;</div>
<div class="line"><span class="lineno"> 1015</span>      std::find(input_participants.begin(),input_participants.end(),lanelet::Participants::VehicleCar) != input_participants.end() &amp;&amp;</div>
<div class="line"><span class="lineno"> 1016</span>      std::find(input_participants.begin(),input_participants.end(),lanelet::Participants::VehicleTruck) != input_participants.end())</div>
<div class="line"><span class="lineno"> 1017</span>  {</div>
<div class="line"><span class="lineno"> 1018</span>    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Detected participants to cover all possible vehicle types&quot;</span>);</div>
<div class="line"><span class="lineno"> 1019</span>    participants.emplace_back(lanelet::Participants::Vehicle);</div>
<div class="line"><span class="lineno"> 1020</span>  }</div>
<div class="line"><span class="lineno"> 1021</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1022</span>  {</div>
<div class="line"><span class="lineno"> 1023</span>    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Not making any changes to the participants list&quot;</span>);</div>
<div class="line"><span class="lineno"> 1024</span>    participants = input_participants;</div>
<div class="line"><span class="lineno"> 1025</span>  }</div>
<div class="line"><span class="lineno"> 1026</span> </div>
<div class="line"><span class="lineno"> 1027</span>  <span class="keywordflow">return</span> participants;</div>
<div class="line"><span class="lineno"> 1028</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l00951">participantsChecker()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_a2c6c3606e5f4b3c12a984261823c1d71_icgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_a2c6c3606e5f4b3c12a984261823c1d71_icgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_a2c6c3606e5f4b3c12a984261823c1d71_icgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_a2c6c3606e5f4b3c12a984261823c1d71_icgraph">
<area shape="rect" title="Combines a list of the given participants into a single &quot;vehicle&quot; type if participants cover all poss..." alt="" coords="1564,93,1775,135"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aa326eab73fe1583c1fa937ed2e38b33f" title="Generates participants list." alt="" coords="1305,93,1516,135"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a74d10f4f0534115f672f8995f0036b49" title=" " alt="" coords="1040,5,1257,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#af0e373523dc84a409331d01b62d2fce0" title="Fills geofence object from TrafficControlMessageV01 ROS Msg." alt="" coords="781,123,992,164"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ae34565da1566e777745a92161422404c" title="Adds RegionAccessRule to the map." alt="" coords="1043,188,1254,229"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a116928c0070cfa7587c219a6629dadb8" title="Adds Minimum Gap to the map." alt="" coords="1043,123,1254,164"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a649174a7a7270df95532cad5131bf4cb" title="Adds a geofence to the current map and publishes the ROS msg." alt="" coords="264,156,475,197"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a95cb7c60682d7b455a8624534ad94706" title="Constructor." alt="" coords="5,156,216,197"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a12708b289f7f3d8f10c6dc749bf14d65" title="Create workzone geofence. Create diagonal lanelets and a lanelet that houses opposing lane&#39;s trafficl..." alt="" coords="781,188,992,229"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a5ae3f2086831ebd932e19b2bdfd76405" title="Creates a single workzone geofence (in the vector) that includes all additional lanelets (housing tra..." alt="" coords="523,185,733,227"/>
</map>
</div>

</div>
</div>
<a id="a2493db4c5843a143c61cd27b0489ca7a" name="a2493db4c5843a143c61cd27b0489ca7a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2493db4c5843a143c61cd27b0489ca7a">&#9670;&nbsp;</a></span>composeTCMMarkerVisualizer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">visualization_msgs::msg::Marker carma_wm_ctrl::WMBroadcaster::composeTCMMarkerVisualizer </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; lanelet::Point3d &gt; &amp;&#160;</td>
          <td class="paramname"><em>input</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a2493db4c5843a143c61cd27b0489ca7a" title="composeTCMMarkerVisualizer() compose TCM Marker visualization">composeTCMMarkerVisualizer()</a> compose TCM Marker visualization </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">input</td><td>The message containing tcm information </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8cpp_source.html#l01826">1826</a> of file <a class="el" href="WMBroadcaster_8cpp_source.html">WMBroadcaster.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1827</span> {</div>
<div class="line"><span class="lineno"> 1828</span> </div>
<div class="line"><span class="lineno"> 1829</span>         <span class="comment">// create the marker msgs</span></div>
<div class="line"><span class="lineno"> 1830</span>        visualization_msgs::msg::Marker marker;</div>
<div class="line"><span class="lineno"> 1831</span>        marker.header.frame_id = <span class="stringliteral">&quot;map&quot;</span>;</div>
<div class="line"><span class="lineno"> 1832</span>        marker.header.stamp = rclcpp::Time();</div>
<div class="line"><span class="lineno"> 1833</span>        marker.type = visualization_msgs::msg::Marker::SPHERE_LIST;</div>
<div class="line"><span class="lineno"> 1834</span>        marker.action = visualization_msgs::msg::Marker::ADD;</div>
<div class="line"><span class="lineno"> 1835</span>        marker.ns = <span class="stringliteral">&quot;route_visualizer&quot;</span>;</div>
<div class="line"><span class="lineno"> 1836</span> </div>
<div class="line"><span class="lineno"> 1837</span>        marker.scale.x = 0.65;</div>
<div class="line"><span class="lineno"> 1838</span>        marker.scale.y = 0.65;</div>
<div class="line"><span class="lineno"> 1839</span>        marker.scale.z = 0.65;</div>
<div class="line"><span class="lineno"> 1840</span>        marker.frame_locked = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1841</span> </div>
<div class="line"><span class="lineno"> 1842</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a0953785489057b443058b4ed4adb74ec">tcm_marker_array_</a>.markers.empty()) </div>
<div class="line"><span class="lineno"> 1843</span>        {</div>
<div class="line"><span class="lineno"> 1844</span>        marker.id = <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a0953785489057b443058b4ed4adb74ec">tcm_marker_array_</a>.markers.back().id + 1;</div>
<div class="line"><span class="lineno"> 1845</span>        }</div>
<div class="line"><span class="lineno"> 1846</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1847</span>        {</div>
<div class="line"><span class="lineno"> 1848</span>        marker.id = 0;</div>
<div class="line"><span class="lineno"> 1849</span>        }</div>
<div class="line"><span class="lineno"> 1850</span>        marker.color.r = 0.0F;</div>
<div class="line"><span class="lineno"> 1851</span>        marker.color.g = 1.0F;</div>
<div class="line"><span class="lineno"> 1852</span>        marker.color.b = 0.0F;</div>
<div class="line"><span class="lineno"> 1853</span>        marker.color.a = 1.0F;</div>
<div class="line"><span class="lineno"> 1854</span> </div>
<div class="line"><span class="lineno"> 1855</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> = 0; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> &lt; input.size(); <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>++)</div>
<div class="line"><span class="lineno"> 1856</span>        {</div>
<div class="line"><span class="lineno"> 1857</span>            geometry_msgs::msg::Point temp_point;</div>
<div class="line"><span class="lineno"> 1858</span>            temp_point.x = input[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>].x();</div>
<div class="line"><span class="lineno"> 1859</span>            temp_point.y = input[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>].y();</div>
<div class="line"><span class="lineno"> 1860</span>            temp_point.z = 2; <span class="comment">//to show up on top of the lanelet lines</span></div>
<div class="line"><span class="lineno"> 1861</span> </div>
<div class="line"><span class="lineno"> 1862</span>            marker.points.push_back(temp_point);</div>
<div class="line"><span class="lineno"> 1863</span>        }</div>
<div class="line"><span class="lineno"> 1864</span> </div>
<div class="line"><span class="lineno"> 1865</span>        <span class="keywordflow">return</span> marker;</div>
<div class="line"><span class="lineno"> 1866</span> }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="process__bag_8py_source.html#l00059">process_bag::i</a>, and <a class="el" href="WMBroadcaster_8hpp_source.html#l00404">tcm_marker_array_</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l01488">addGeofence()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_a2493db4c5843a143c61cd27b0489ca7a_icgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_a2493db4c5843a143c61cd27b0489ca7a_icgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_a2493db4c5843a143c61cd27b0489ca7a_icgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_a2493db4c5843a143c61cd27b0489ca7a_icgraph">
<area shape="rect" title="composeTCMMarkerVisualizer() compose TCM Marker visualization" alt="" coords="523,5,733,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a649174a7a7270df95532cad5131bf4cb" title="Adds a geofence to the current map and publishes the ROS msg." alt="" coords="264,5,475,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a95cb7c60682d7b455a8624534ad94706" title="Constructor." alt="" coords="5,5,216,47"/>
</map>
</div>

</div>
</div>
<a id="a8c72c6fdeb1568b078bf6131c906b377" name="a8c72c6fdeb1568b078bf6131c906b377"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c72c6fdeb1568b078bf6131c906b377">&#9670;&nbsp;</a></span>composeTCRStatus()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">carma_v2x_msgs::msg::TrafficControlRequestPolygon carma_wm_ctrl::WMBroadcaster::composeTCRStatus </td>
          <td>(</td>
          <td class="paramtype">const lanelet::BasicPoint3d &amp;&#160;</td>
          <td class="paramname"><em>localPoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const carma_v2x_msgs::msg::TrafficControlBounds &amp;&#160;</td>
          <td class="paramname"><em>cB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const lanelet::projection::LocalFrameProjector &amp;&#160;</td>
          <td class="paramname"><em>local_projector</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a8c72c6fdeb1568b078bf6131c906b377" title="composeTCRStatus() compose TCM Request visualization on UI">composeTCRStatus()</a> compose TCM Request visualization on UI </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">input</td><td>The message containing tcr information </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8cpp_source.html#l01792">1792</a> of file <a class="el" href="WMBroadcaster_8cpp_source.html">WMBroadcaster.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1793</span>{</div>
<div class="line"><span class="lineno"> 1794</span>  carma_v2x_msgs::msg::TrafficControlRequestPolygon output;</div>
<div class="line"><span class="lineno"> 1795</span>  lanelet::BasicPoint3d local_point_tmp;</div>
<div class="line"><span class="lineno"> 1796</span> </div>
<div class="line"><span class="lineno"> 1797</span>  <span class="keywordtype">int</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> = -1;</div>
<div class="line"><span class="lineno"> 1798</span>  <span class="keywordflow">while</span> (<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> &lt; 3) <span class="comment">// three offsets; offsets.size() doesn&#39;t return accurate size</span></div>
<div class="line"><span class="lineno"> 1799</span>  {</div>
<div class="line"><span class="lineno"> 1800</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> == -1)</div>
<div class="line"><span class="lineno"> 1801</span>    {</div>
<div class="line"><span class="lineno"> 1802</span>      local_point_tmp.x() = localPoint.x();</div>
<div class="line"><span class="lineno"> 1803</span>      local_point_tmp.y() = localPoint.y();</div>
<div class="line"><span class="lineno"> 1804</span>    }</div>
<div class="line"><span class="lineno"> 1805</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1806</span>    {</div>
<div class="line"><span class="lineno"> 1807</span>      local_point_tmp.x() = localPoint.x() + cB.offsets[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>].deltax;;</div>
<div class="line"><span class="lineno"> 1808</span>      local_point_tmp.y() = localPoint.y() + cB.offsets[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>].deltay;;</div>
<div class="line"><span class="lineno"> 1809</span>    }</div>
<div class="line"><span class="lineno"> 1810</span>    lanelet::GPSPoint gps_vertex = local_projector.reverse(local_point_tmp);</div>
<div class="line"><span class="lineno"> 1811</span>    </div>
<div class="line"><span class="lineno"> 1812</span>    carma_v2x_msgs::msg::Position3D gps_msg;</div>
<div class="line"><span class="lineno"> 1813</span>    gps_msg.elevation = gps_vertex.ele;</div>
<div class="line"><span class="lineno"> 1814</span>    gps_msg.latitude = gps_vertex.lat;</div>
<div class="line"><span class="lineno"> 1815</span>    gps_msg.longitude = gps_vertex.lon;</div>
<div class="line"><span class="lineno"> 1816</span>    output.polygon_list.push_back(gps_msg);</div>
<div class="line"><span class="lineno"> 1817</span> </div>
<div class="line"><span class="lineno"> 1818</span>    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;TCR Vertex Lat: &quot;</span>&lt;&lt; <a class="code hl_function" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5">std::to_string</a>(gps_vertex.lat));</div>
<div class="line"><span class="lineno"> 1819</span>    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;TCR Vertex Lon: &quot;</span>&lt;&lt;<a class="code hl_function" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5">std::to_string</a>(gps_vertex.lon));</div>
<div class="line"><span class="lineno"> 1820</span> </div>
<div class="line"><span class="lineno"> 1821</span>    <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>++;</div>
<div class="line"><span class="lineno"> 1822</span>  }</div>
<div class="line"><span class="lineno"> 1823</span>  <span class="keywordflow">return</span> output;</div>
<div class="line"><span class="lineno"> 1824</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="process__bag_8py_source.html#l00059">process_bag::i</a>, and <a class="el" href="utm__zone_8cpp_source.html#l00021">carma_cooperative_perception::to_string()</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l01641">controlRequestFromRoute()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_a8c72c6fdeb1568b078bf6131c906b377_cgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_a8c72c6fdeb1568b078bf6131c906b377_cgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_a8c72c6fdeb1568b078bf6131c906b377_cgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_a8c72c6fdeb1568b078bf6131c906b377_cgraph">
<area shape="rect" title="composeTCRStatus() compose TCM Request visualization on UI" alt="" coords="5,29,216,71"/>
<area shape="rect" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5" title=" " alt="" coords="264,29,463,71"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_a8c72c6fdeb1568b078bf6131c906b377_icgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_a8c72c6fdeb1568b078bf6131c906b377_icgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_a8c72c6fdeb1568b078bf6131c906b377_icgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_a8c72c6fdeb1568b078bf6131c906b377_icgraph">
<area shape="rect" title="composeTCRStatus() compose TCM Request visualization on UI" alt="" coords="781,39,992,80"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a0fcc6904e5b3fb2fca13e9488069ec10" title="Pulls vehicle information from CARMA Cloud at startup by providing its selected route in a TrafficCon..." alt="" coords="523,39,733,80"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a7efa8028648e4ed8b847c97e952b07d1" title="Calls controlRequestFromRoute() and publishes the TrafficControlRequest Message returned after the co..." alt="" coords="264,39,475,80"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a95cb7c60682d7b455a8624534ad94706" title="Constructor." alt="" coords="5,5,216,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcasterNode.html#ab0c14f6d7e30870755a4dcf6b228de82" title=" " alt="" coords="5,71,216,112"/>
</map>
</div>

</div>
</div>
<a id="a0fcc6904e5b3fb2fca13e9488069ec10" name="a0fcc6904e5b3fb2fca13e9488069ec10"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0fcc6904e5b3fb2fca13e9488069ec10">&#9670;&nbsp;</a></span>controlRequestFromRoute()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">carma_v2x_msgs::msg::TrafficControlRequest carma_wm_ctrl::WMBroadcaster::controlRequestFromRoute </td>
          <td>(</td>
          <td class="paramtype">const carma_planning_msgs::msg::Route &amp;&#160;</td>
          <td class="paramname"><em>route_msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::shared_ptr&lt; j2735_v2x_msgs::msg::Id64b &gt;&#160;</td>
          <td class="paramname"><em>req_id_for_testing</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Pulls vehicle information from CARMA Cloud at startup by providing its selected route in a TrafficControlRequest message that is published after a route is selected. During operation at ~10s intervals the vehicle will make another control request for the remainder of its route. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">route_msg</td><td>The message containing route information pulled from <a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a7efa8028648e4ed8b847c97e952b07d1" title="Calls controlRequestFromRoute() and publishes the TrafficControlRequest Message returned after the co...">routeCallbackMessage()</a> </td></tr>
    <tr><td class="paramname">req_id_for_testing</td><td>this ptr is optional. it gives req_id for developer to test TrafficControlMessage as it needs it </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8cpp_source.html#l01641">1641</a> of file <a class="el" href="WMBroadcaster_8cpp_source.html">WMBroadcaster.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1642</span>{</div>
<div class="line"><span class="lineno"> 1643</span>  lanelet::ConstLanelets path; </div>
<div class="line"><span class="lineno"> 1644</span> </div>
<div class="line"><span class="lineno"> 1645</span>  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a> || <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;laneletLayer.size() == 0)</div>
<div class="line"><span class="lineno"> 1646</span>  {</div>
<div class="line"><span class="lineno"> 1647</span>   <span class="comment">// Return / log warning etc.</span></div>
<div class="line"><span class="lineno"> 1648</span>    RCLCPP_INFO_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Value &#39;current_map_&#39; does not exist.&quot;</span>);</div>
<div class="line"><span class="lineno"> 1649</span>    <span class="keywordflow">throw</span> lanelet::InvalidObjectStateError(std::string(<span class="stringliteral">&quot;Base lanelet map is not loaded to the WMBroadcaster&quot;</span>));</div>
<div class="line"><span class="lineno"> 1650</span> </div>
<div class="line"><span class="lineno"> 1651</span>  }</div>
<div class="line"><span class="lineno"> 1652</span> </div>
<div class="line"><span class="lineno"> 1653</span>  <span class="keywordflow">for</span>(<span class="keyword">auto</span> <span class="keywordtype">id</span> : route_msg.route_path_lanelet_ids) </div>
<div class="line"><span class="lineno"> 1654</span>  {</div>
<div class="line"><span class="lineno"> 1655</span>    <span class="keyword">auto</span> laneLayer = <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;laneletLayer.get(<span class="keywordtype">id</span>);</div>
<div class="line"><span class="lineno"> 1656</span>    path.push_back(laneLayer);</div>
<div class="line"><span class="lineno"> 1657</span>  }</div>
<div class="line"><span class="lineno"> 1658</span> </div>
<div class="line"><span class="lineno"> 1659</span>  <span class="comment">// update local copy</span></div>
<div class="line"><span class="lineno"> 1660</span>  <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a60ad34ffaa6843dc3225a95e828c3df8">route_path_</a> = path;</div>
<div class="line"><span class="lineno"> 1661</span>  </div>
<div class="line"><span class="lineno"> 1662</span>  <span class="keywordflow">if</span>(path.size() == 0) <span class="keywordflow">throw</span> lanelet::InvalidObjectStateError(std::string(<span class="stringliteral">&quot;No lanelets available in path.&quot;</span>));</div>
<div class="line"><span class="lineno"> 1663</span> </div>
<div class="line"><span class="lineno"> 1664</span>   <span class="comment">/*logic to determine route bounds*/</span></div>
<div class="line"><span class="lineno"> 1665</span>  std::vector&lt;lanelet::ConstLanelet&gt; llt; </div>
<div class="line"><span class="lineno"> 1666</span>  std::vector&lt;lanelet::BoundingBox2d&gt; pathBox; </div>
<div class="line"><span class="lineno"> 1667</span>  <span class="keywordtype">double</span> minX = std::numeric_limits&lt;double&gt;::max();</div>
<div class="line"><span class="lineno"> 1668</span>  <span class="keywordtype">double</span> minY = std::numeric_limits&lt;double&gt;::max();</div>
<div class="line"><span class="lineno"> 1669</span>  <span class="keywordtype">double</span> maxX = std::numeric_limits&lt;double&gt;::lowest();</div>
<div class="line"><span class="lineno"> 1670</span>  <span class="keywordtype">double</span> maxY = std::numeric_limits&lt;double&gt;::lowest();</div>
<div class="line"><span class="lineno"> 1671</span> </div>
<div class="line"><span class="lineno"> 1672</span>  <span class="keywordflow">while</span> (path.size() != 0) <span class="comment">//Continue until there are no more lanelet elements in path</span></div>
<div class="line"><span class="lineno"> 1673</span>  {</div>
<div class="line"><span class="lineno"> 1674</span>      llt.push_back(path.back()); <span class="comment">//Add a lanelet to the vector</span></div>
<div class="line"><span class="lineno"> 1675</span>    </div>
<div class="line"><span class="lineno"> 1676</span> </div>
<div class="line"><span class="lineno"> 1677</span>      pathBox.push_back(lanelet::geometry::boundingBox2d(llt.back())); <span class="comment">//Create a bounding box of the added lanelet and add it to the vector</span></div>
<div class="line"><span class="lineno"> 1678</span> </div>
<div class="line"><span class="lineno"> 1679</span> </div>
<div class="line"><span class="lineno"> 1680</span>      <span class="keywordflow">if</span> (pathBox.back().corner(lanelet::BoundingBox2d::BottomLeft).x() &lt; minX)</div>
<div class="line"><span class="lineno"> 1681</span>        minX = pathBox.back().corner(lanelet::BoundingBox2d::BottomLeft).x(); <span class="comment">//minimum x-value</span></div>
<div class="line"><span class="lineno"> 1682</span> </div>
<div class="line"><span class="lineno"> 1683</span> </div>
<div class="line"><span class="lineno"> 1684</span>      <span class="keywordflow">if</span> (pathBox.back().corner(lanelet::BoundingBox2d::BottomLeft).y() &lt; minY)</div>
<div class="line"><span class="lineno"> 1685</span>        minY = pathBox.back().corner(lanelet::BoundingBox2d::BottomLeft).y(); <span class="comment">//minimum y-value</span></div>
<div class="line"><span class="lineno"> 1686</span> </div>
<div class="line"><span class="lineno"> 1687</span> </div>
<div class="line"><span class="lineno"> 1688</span> </div>
<div class="line"><span class="lineno"> 1689</span>     <span class="keywordflow">if</span> (pathBox.back().corner(lanelet::BoundingBox2d::TopRight).x() &gt; maxX)</div>
<div class="line"><span class="lineno"> 1690</span>        maxX = pathBox.back().corner(lanelet::BoundingBox2d::TopRight).x(); <span class="comment">//maximum x-value</span></div>
<div class="line"><span class="lineno"> 1691</span> </div>
<div class="line"><span class="lineno"> 1692</span> </div>
<div class="line"><span class="lineno"> 1693</span>     <span class="keywordflow">if</span> (pathBox.back().corner(lanelet::BoundingBox2d::TopRight).y() &gt; maxY)</div>
<div class="line"><span class="lineno"> 1694</span>        maxY = pathBox.back().corner(lanelet::BoundingBox2d::TopRight).y(); <span class="comment">//maximum y-value</span></div>
<div class="line"><span class="lineno"> 1695</span> </div>
<div class="line"><span class="lineno"> 1696</span> </div>
<div class="line"><span class="lineno"> 1697</span>      path.pop_back(); <span class="comment">//remove the added lanelet from path an reduce pack.size() by 1</span></div>
<div class="line"><span class="lineno"> 1698</span>  } <span class="comment">//end of while loop</span></div>
<div class="line"><span class="lineno"> 1699</span>  </div>
<div class="line"><span class="lineno"> 1700</span> </div>
<div class="line"><span class="lineno"> 1701</span>  std::string target_frame = <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a8960147050728c13bb19f8157cd51d25">base_map_georef_</a>;</div>
<div class="line"><span class="lineno"> 1702</span>  <span class="keywordflow">if</span> (target_frame.empty()) </div>
<div class="line"><span class="lineno"> 1703</span>  {</div>
<div class="line"><span class="lineno"> 1704</span>   <span class="comment">// Return / log warning etc.</span></div>
<div class="line"><span class="lineno"> 1705</span>    RCLCPP_INFO_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Value &#39;target_frame&#39; is empty.&quot;</span>);</div>
<div class="line"><span class="lineno"> 1706</span>    <span class="keywordflow">throw</span> lanelet::InvalidObjectStateError(std::string(<span class="stringliteral">&quot;Base georeference map may not be loaded to the WMBroadcaster&quot;</span>));</div>
<div class="line"><span class="lineno"> 1707</span> </div>
<div class="line"><span class="lineno"> 1708</span>  }</div>
<div class="line"><span class="lineno"> 1709</span>  </div>
<div class="line"><span class="lineno"> 1710</span>  <span class="comment">// Convert the minimum point to latlon</span></div>
<div class="line"><span class="lineno"> 1711</span>  lanelet::projection::LocalFrameProjector local_projector(target_frame.c_str());</div>
<div class="line"><span class="lineno"> 1712</span>  lanelet::BasicPoint3d localPoint;</div>
<div class="line"><span class="lineno"> 1713</span> </div>
<div class="line"><span class="lineno"> 1714</span>  localPoint.x()= minX;</div>
<div class="line"><span class="lineno"> 1715</span>  localPoint.y()= minY;</div>
<div class="line"><span class="lineno"> 1716</span> </div>
<div class="line"><span class="lineno"> 1717</span>  lanelet::GPSPoint gpsRoute = local_projector.reverse(localPoint); <span class="comment">//If the appropriate library is included, the reverse() function can be used to convert from local xyz to lat/lon</span></div>
<div class="line"><span class="lineno"> 1718</span> </div>
<div class="line"><span class="lineno"> 1719</span>  <span class="comment">// Create a local transverse mercator frame at the minimum point to allow us to get east,north oriented bounds </span></div>
<div class="line"><span class="lineno"> 1720</span>  std::string local_tmerc_enu_proj = <span class="stringliteral">&quot;+proj=tmerc +datum=WGS84 +h_0=0 +lat_0=&quot;</span> + <a class="code hl_function" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5">std::to_string</a>(gpsRoute.lat) + <span class="stringliteral">&quot; +lon_0=&quot;</span> + <a class="code hl_function" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5">std::to_string</a>(gpsRoute.lon);</div>
<div class="line"><span class="lineno"> 1721</span> </div>
<div class="line"><span class="lineno"> 1722</span>  <span class="comment">// Create transform from map frame to local transform mercator frame at bounds min point</span></div>
<div class="line"><span class="lineno"> 1723</span>  PJ* tmerc_proj = proj_create_crs_to_crs(PJ_DEFAULT_CTX, target_frame.c_str(), local_tmerc_enu_proj.c_str(), <span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno"> 1724</span>  </div>
<div class="line"><span class="lineno"> 1725</span>  <span class="keywordflow">if</span> (tmerc_proj == <span class="keyword">nullptr</span>) { <span class="comment">// proj_create_crs_to_crs returns 0 when there is an error in the projection</span></div>
<div class="line"><span class="lineno"> 1726</span>    </div>
<div class="line"><span class="lineno"> 1727</span>    RCLCPP_ERROR_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Failed to generate projection between request bounds frame and map with error number: &quot;</span> &lt;&lt;  proj_context_errno(PJ_DEFAULT_CTX) </div>
<div class="line"><span class="lineno"> 1728</span>      &lt;&lt; <span class="stringliteral">&quot; MapProjection: &quot;</span> &lt;&lt; target_frame &lt;&lt; <span class="stringliteral">&quot; Message Projection: &quot;</span> &lt;&lt; local_tmerc_enu_proj);</div>
<div class="line"><span class="lineno"> 1729</span> </div>
<div class="line"><span class="lineno"> 1730</span>    <span class="keywordflow">return</span> {}; <span class="comment">// Ignore geofence if it could not be projected into the map frame</span></div>
<div class="line"><span class="lineno"> 1731</span>  </div>
<div class="line"><span class="lineno"> 1732</span>  }</div>
<div class="line"><span class="lineno"> 1733</span> </div>
<div class="line"><span class="lineno"> 1734</span>  RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Before conversion: Top Left: (&quot;</span>&lt;&lt; minX &lt;&lt;<span class="stringliteral">&quot;, &quot;</span>&lt;&lt;maxY&lt;&lt;<span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><span class="lineno"> 1735</span>  RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Before conversion: Top Right: (&quot;</span>&lt;&lt; maxX &lt;&lt;<span class="stringliteral">&quot;, &quot;</span>&lt;&lt;maxY&lt;&lt;<span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><span class="lineno"> 1736</span>  RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Before conversion: Bottom Left: (&quot;</span>&lt;&lt; minX &lt;&lt;<span class="stringliteral">&quot;, &quot;</span>&lt;&lt;minY&lt;&lt;<span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><span class="lineno"> 1737</span>  RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Before conversion: Bottom Right: (&quot;</span>&lt;&lt; maxX &lt;&lt;<span class="stringliteral">&quot;, &quot;</span>&lt;&lt;minY&lt;&lt;<span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><span class="lineno"> 1738</span> </div>
<div class="line"><span class="lineno"> 1739</span>  PJ_COORD pj_min {{minX, minY, 0, 0}}; <span class="comment">// z is not currently used</span></div>
<div class="line"><span class="lineno"> 1740</span>  PJ_COORD pj_min_tmerc;</div>
<div class="line"><span class="lineno"> 1741</span>  PJ_COORD pj_max {{maxX, maxY, 0, 0}}; <span class="comment">// z is not currently used</span></div>
<div class="line"><span class="lineno"> 1742</span>  PJ_COORD pj_max_tmerc;</div>
<div class="line"><span class="lineno"> 1743</span>  pj_min_tmerc = proj_trans(tmerc_proj, PJ_FWD, pj_min);</div>
<div class="line"><span class="lineno"> 1744</span>  pj_max_tmerc = proj_trans(tmerc_proj, PJ_FWD, pj_max);</div>
<div class="line"><span class="lineno"> 1745</span> </div>
<div class="line"><span class="lineno"> 1746</span>  RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;After conversion: MinPoint ( &quot;</span>&lt;&lt; pj_min_tmerc.xyz.x &lt;&lt;<span class="stringliteral">&quot;, &quot;</span> &lt;&lt; pj_min_tmerc.xyz.y &lt;&lt;<span class="stringliteral">&quot; )&quot;</span>);</div>
<div class="line"><span class="lineno"> 1747</span>  RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;After conversion: MaxPoint ( &quot;</span>&lt;&lt; pj_max_tmerc.xyz.x &lt;&lt;<span class="stringliteral">&quot;, &quot;</span> &lt;&lt; pj_max_tmerc.xyz.y &lt;&lt;<span class="stringliteral">&quot; )&quot;</span>);</div>
<div class="line"><span class="lineno"> 1748</span> </div>
<div class="line"><span class="lineno"> 1749</span>  carma_v2x_msgs::msg::TrafficControlRequest cR; <span class="comment">/*Fill the latitude value in message cB with the value of lat */</span></div>
<div class="line"><span class="lineno"> 1750</span>  carma_v2x_msgs::msg::TrafficControlBounds cB; <span class="comment">/*Fill the longitude value in message cB with the value of lon*/</span></div>
<div class="line"><span class="lineno"> 1751</span>  </div>
<div class="line"><span class="lineno"> 1752</span>  cB.reflat = gpsRoute.lat;</div>
<div class="line"><span class="lineno"> 1753</span>  cB.reflon = gpsRoute.lon;</div>
<div class="line"><span class="lineno"> 1754</span> </div>
<div class="line"><span class="lineno"> 1755</span>  cB.offsets[0].deltax = pj_max_tmerc.xyz.x - pj_min_tmerc.xyz.x; <span class="comment">// Points in clockwise order min,min (lat,lon point) -&gt; max,min -&gt; max,max -&gt; min,max</span></div>
<div class="line"><span class="lineno"> 1756</span>  cB.offsets[0].deltay = 0.0;                                     <span class="comment">// calculating the offsets</span></div>
<div class="line"><span class="lineno"> 1757</span>  cB.offsets[1].deltax = pj_max_tmerc.xyz.x - pj_min_tmerc.xyz.x;</div>
<div class="line"><span class="lineno"> 1758</span>  cB.offsets[1].deltay = pj_max_tmerc.xyz.y - pj_min_tmerc.xyz.y;</div>
<div class="line"><span class="lineno"> 1759</span>  cB.offsets[2].deltax = 0.0;</div>
<div class="line"><span class="lineno"> 1760</span>  cB.offsets[2].deltay = pj_max_tmerc.xyz.y - pj_min_tmerc.xyz.y;</div>
<div class="line"><span class="lineno"> 1761</span> </div>
<div class="line"><span class="lineno"> 1762</span>  <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#abb6d33eb34b7cc277012ddce4274f0d1">tcr_polygon_</a> = <a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a8c72c6fdeb1568b078bf6131c906b377">composeTCRStatus</a>(localPoint, cB, local_projector); <span class="comment">// TCR polygon can be visualized in UI</span></div>
<div class="line"><span class="lineno"> 1763</span> </div>
<div class="line"><span class="lineno"> 1764</span>  cB.oldest =rclcpp::Time(0.0,0.0, <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#abbf8a6885fb83de6bdf0241ef3e1401f">scheduler_</a>.<a class="code hl_function" href="classcarma__wm__ctrl_1_1GeofenceScheduler.html#a2fecf322a302aff00ce8d76b0965e02e">getClockType</a>()); <span class="comment">// TODO this needs to be set to 0 or an older value as otherwise this will filter out all controls</span></div>
<div class="line"><span class="lineno"> 1765</span>  </div>
<div class="line"><span class="lineno"> 1766</span>  cR.choice = carma_v2x_msgs::msg::TrafficControlRequest::TCRV01;</div>
<div class="line"><span class="lineno"> 1767</span>  </div>
<div class="line"><span class="lineno"> 1768</span>  <span class="comment">// create 16 byte uuid</span></div>
<div class="line"><span class="lineno"> 1769</span>  boost::uuids::uuid uuid_id = boost::uuids::random_generator()(); </div>
<div class="line"><span class="lineno"> 1770</span>  <span class="comment">// take half as string</span></div>
<div class="line"><span class="lineno"> 1771</span>  std::string reqid = <a class="code hl_function" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5">boost::uuids::to_string</a>(uuid_id).substr(0, 8);</div>
<div class="line"><span class="lineno"> 1772</span>  std::string req_id_test = <span class="stringliteral">&quot;12345678&quot;</span>; <span class="comment">// TODO this is an extremely risky way of performing a unit test. This method needs to be refactored so that unit tests cannot side affect actual implementations</span></div>
<div class="line"><span class="lineno"> 1773</span>  <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ae21047d8e9e8273c80ae80c4749feee0">generated_geofence_reqids_</a>.insert(req_id_test);</div>
<div class="line"><span class="lineno"> 1774</span>  <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ae21047d8e9e8273c80ae80c4749feee0">generated_geofence_reqids_</a>.insert(reqid);</div>
<div class="line"><span class="lineno"> 1775</span> </div>
<div class="line"><span class="lineno"> 1776</span> </div>
<div class="line"><span class="lineno"> 1777</span>  <span class="comment">// copy to reqid array</span></div>
<div class="line"><span class="lineno"> 1778</span>  boost::array&lt;uint8_t, 16UL&gt; req_id;</div>
<div class="line"><span class="lineno"> 1779</span>  std::copy(uuid_id.begin(),uuid_id.end(), req_id.begin());</div>
<div class="line"><span class="lineno"> 1780</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> = 0; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> &lt; 8; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> ++)</div>
<div class="line"><span class="lineno"> 1781</span>  {</div>
<div class="line"><span class="lineno"> 1782</span>    cR.tcr_v01.reqid.id[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>] = req_id[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>];</div>
<div class="line"><span class="lineno"> 1783</span>    <span class="keywordflow">if</span> (req_id_for_testing) req_id_for_testing-&gt;id[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>] = req_id[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>];</div>
<div class="line"><span class="lineno"> 1784</span>  }</div>
<div class="line"><span class="lineno"> 1785</span> </div>
<div class="line"><span class="lineno"> 1786</span>  cR.tcr_v01.bounds.push_back(cB);</div>
<div class="line"><span class="lineno"> 1787</span>  </div>
<div class="line"><span class="lineno"> 1788</span>  <span class="keywordflow">return</span> cR;</div>
<div class="line"><span class="lineno"> 1789</span> </div>
<div class="line"><span class="lineno"> 1790</span>}</div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_a60ad34ffaa6843dc3225a95e828c3df8"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a60ad34ffaa6843dc3225a95e828c3df8">carma_wm_ctrl::WMBroadcaster::route_path_</a></div><div class="ttdeci">lanelet::ConstLanelets route_path_</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8hpp_source.html#l00410">WMBroadcaster.hpp:410</a></div></div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_a8960147050728c13bb19f8157cd51d25"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a8960147050728c13bb19f8157cd51d25">carma_wm_ctrl::WMBroadcaster::base_map_georef_</a></div><div class="ttdeci">std::string base_map_georef_</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8hpp_source.html#l00443">WMBroadcaster.hpp:443</a></div></div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_a8c72c6fdeb1568b078bf6131c906b377"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a8c72c6fdeb1568b078bf6131c906b377">carma_wm_ctrl::WMBroadcaster::composeTCRStatus</a></div><div class="ttdeci">carma_v2x_msgs::msg::TrafficControlRequestPolygon composeTCRStatus(const lanelet::BasicPoint3d &amp;localPoint, const carma_v2x_msgs::msg::TrafficControlBounds &amp;cB, const lanelet::projection::LocalFrameProjector &amp;local_projector)</div><div class="ttdoc">composeTCRStatus() compose TCM Request visualization on UI</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8cpp_source.html#l01792">WMBroadcaster.cpp:1792</a></div></div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_abb6d33eb34b7cc277012ddce4274f0d1"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#abb6d33eb34b7cc277012ddce4274f0d1">carma_wm_ctrl::WMBroadcaster::tcr_polygon_</a></div><div class="ttdeci">carma_v2x_msgs::msg::TrafficControlRequestPolygon tcr_polygon_</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8hpp_source.html#l00405">WMBroadcaster.hpp:405</a></div></div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_ae21047d8e9e8273c80ae80c4749feee0"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ae21047d8e9e8273c80ae80c4749feee0">carma_wm_ctrl::WMBroadcaster::generated_geofence_reqids_</a></div><div class="ttdeci">std::unordered_set&lt; std::string &gt; generated_geofence_reqids_</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8hpp_source.html#l00434">WMBroadcaster.hpp:434</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMBroadcaster_8hpp_source.html#l00443">base_map_georef_</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l01792">composeTCRStatus()</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00429">current_map_</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00434">generated_geofence_reqids_</a>, <a class="el" href="GeofenceScheduler_8cpp_source.html#l00043">carma_wm_ctrl::GeofenceScheduler::getClockType()</a>, <a class="el" href="process__bag_8py_source.html#l00059">process_bag::i</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00410">route_path_</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00441">scheduler_</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00405">tcr_polygon_</a>, and <a class="el" href="utm__zone_8cpp_source.html#l00021">carma_cooperative_perception::to_string()</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l01632">routeCallbackMessage()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_a0fcc6904e5b3fb2fca13e9488069ec10_cgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_a0fcc6904e5b3fb2fca13e9488069ec10_cgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_a0fcc6904e5b3fb2fca13e9488069ec10_cgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_a0fcc6904e5b3fb2fca13e9488069ec10_cgraph">
<area shape="rect" title="Pulls vehicle information from CARMA Cloud at startup by providing its selected route in a TrafficCon..." alt="" coords="5,64,216,105"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a8c72c6fdeb1568b078bf6131c906b377" title="composeTCRStatus() compose TCM Request visualization on UI" alt="" coords="274,5,485,47"/>
<area shape="rect" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5" title=" " alt="" coords="543,35,741,76"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1GeofenceScheduler.html#a2fecf322a302aff00ce8d76b0965e02e" title="Get the clock type of the clock being created by the timer factory." alt="" coords="264,123,495,164"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_a0fcc6904e5b3fb2fca13e9488069ec10_icgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_a0fcc6904e5b3fb2fca13e9488069ec10_icgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_a0fcc6904e5b3fb2fca13e9488069ec10_icgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_a0fcc6904e5b3fb2fca13e9488069ec10_icgraph">
<area shape="rect" title="Pulls vehicle information from CARMA Cloud at startup by providing its selected route in a TrafficCon..." alt="" coords="523,39,733,80"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a7efa8028648e4ed8b847c97e952b07d1" title="Calls controlRequestFromRoute() and publishes the TrafficControlRequest Message returned after the co..." alt="" coords="264,39,475,80"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a95cb7c60682d7b455a8624534ad94706" title="Constructor." alt="" coords="5,5,216,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcasterNode.html#ab0c14f6d7e30870755a4dcf6b228de82" title=" " alt="" coords="5,71,216,112"/>
</map>
</div>

</div>
</div>
<a id="a4b5b09f05f4f3ed3a6d5027328f687a3" name="a4b5b09f05f4f3ed3a6d5027328f687a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b5b09f05f4f3ed3a6d5027328f687a3">&#9670;&nbsp;</a></span>convertLightIdToInterGroupId()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool carma_wm_ctrl::WMBroadcaster::convertLightIdToInterGroupId </td>
          <td>(</td>
          <td class="paramtype">unsigned &amp;&#160;</td>
          <td class="paramname"><em>intersection_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned &amp;&#160;</td>
          <td class="paramname"><em>group_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const lanelet::Id &amp;&#160;</td>
          <td class="paramname"><em>lanelet_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>helper for generating intersection and group Id of a traffic light from lanelet id </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">traffic</td><td>lanelet_id </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">intersection_id</td><td>and group_id </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>return true if conversion was successful </dd></dl>

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8cpp_source.html#l01956">1956</a> of file <a class="el" href="WMBroadcaster_8cpp_source.html">WMBroadcaster.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1957</span>{</div>
<div class="line"><span class="lineno"> 1958</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aa03b08ee979d7a4cfd7577280374b97e">traffic_light_id_lookup_</a>.begin(); it != <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aa03b08ee979d7a4cfd7577280374b97e">traffic_light_id_lookup_</a>.end(); ++it)</div>
<div class="line"><span class="lineno"> 1959</span>  {</div>
<div class="line"><span class="lineno"> 1960</span>    <span class="comment">// Reverse of the logic for generating the lanelet_id. Reference function generate32BitId(const std::string&amp; label)</span></div>
<div class="line"><span class="lineno"> 1961</span>    <span class="keywordflow">if</span> (it -&gt; second == lanelet_id)</div>
<div class="line"><span class="lineno"> 1962</span>    {</div>
<div class="line"><span class="lineno"> 1963</span>      group_id = (it -&gt; first &amp; 0xFF);</div>
<div class="line"><span class="lineno"> 1964</span>      intersection_id = (it -&gt; first &gt;&gt; 8);</div>
<div class="line"><span class="lineno"> 1965</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1966</span>    }</div>
<div class="line"><span class="lineno"> 1967</span>  }</div>
<div class="line"><span class="lineno"> 1968</span>  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1969</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMBroadcaster_8hpp_source.html#l00413">traffic_light_id_lookup_</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l01971">publishLightId()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_a4b5b09f05f4f3ed3a6d5027328f687a3_icgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_a4b5b09f05f4f3ed3a6d5027328f687a3_icgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_a4b5b09f05f4f3ed3a6d5027328f687a3_icgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_a4b5b09f05f4f3ed3a6d5027328f687a3_icgraph">
<area shape="rect" title="helper for generating intersection and group Id of a traffic light from lanelet id" alt="" coords="264,5,475,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a0bd681a01c6f93dba31882b370a87aef" title="helps to populate upcoming_intersection_ids_ from local traffic lanelet ids" alt="" coords="5,5,216,47"/>
</map>
</div>

</div>
</div>
<a id="a07466352083e95712cfed377a61c3bc7" name="a07466352083e95712cfed377a61c3bc7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07466352083e95712cfed377a61c3bc7">&#9670;&nbsp;</a></span>createLinearInterpolatingLanelet()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">lanelet::Lanelet carma_wm_ctrl::WMBroadcaster::createLinearInterpolatingLanelet </td>
          <td>(</td>
          <td class="paramtype">const lanelet::Point3d &amp;&#160;</td>
          <td class="paramname"><em>left_front_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const lanelet::Point3d &amp;&#160;</td>
          <td class="paramname"><em>right_front_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const lanelet::Point3d &amp;&#160;</td>
          <td class="paramname"><em>left_back_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const lanelet::Point3d &amp;&#160;</td>
          <td class="paramname"><em>right_back_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>increment_distance</em> = <code>0.25</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8cpp_source.html#l02192">2192</a> of file <a class="el" href="WMBroadcaster_8cpp_source.html">WMBroadcaster.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2193</span>{</div>
<div class="line"><span class="lineno"> 2194</span>  <span class="keywordflow">return</span> lanelet::Lanelet(lanelet::utils::getId(), <a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aef58891043a14a620343f1fc477b8393">createLinearInterpolatingLinestring</a>(left_front_pt, left_back_pt, increment_distance), <a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aef58891043a14a620343f1fc477b8393">createLinearInterpolatingLinestring</a>(right_front_pt, right_back_pt, increment_distance));</div>
<div class="line"><span class="lineno"> 2195</span>}</div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_aef58891043a14a620343f1fc477b8393"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aef58891043a14a620343f1fc477b8393">carma_wm_ctrl::WMBroadcaster::createLinearInterpolatingLinestring</a></div><div class="ttdeci">lanelet::LineString3d createLinearInterpolatingLinestring(const lanelet::Point3d &amp;front_pt, const lanelet::Point3d &amp;back_pt, double increment_distance=0.25)</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8cpp_source.html#l02171">WMBroadcaster.cpp:2171</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMBroadcaster_8cpp_source.html#l02171">createLinearInterpolatingLinestring()</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l00420">createWorkzoneGeometry()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_a07466352083e95712cfed377a61c3bc7_cgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_a07466352083e95712cfed377a61c3bc7_cgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_a07466352083e95712cfed377a61c3bc7_cgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_a07466352083e95712cfed377a61c3bc7_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,220,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aef58891043a14a620343f1fc477b8393" title=" " alt="" coords="268,5,496,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_a07466352083e95712cfed377a61c3bc7_icgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_a07466352083e95712cfed377a61c3bc7_icgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_a07466352083e95712cfed377a61c3bc7_icgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_a07466352083e95712cfed377a61c3bc7_icgraph">
<area shape="rect" title=" " alt="" coords="1040,5,1255,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a12708b289f7f3d8f10c6dc749bf14d65" title="Create workzone geofence. Create diagonal lanelets and a lanelet that houses opposing lane&#39;s trafficl..." alt="" coords="781,5,992,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a5ae3f2086831ebd932e19b2bdfd76405" title="Creates a single workzone geofence (in the vector) that includes all additional lanelets (housing tra..." alt="" coords="523,5,733,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a649174a7a7270df95532cad5131bf4cb" title="Adds a geofence to the current map and publishes the ROS msg." alt="" coords="264,5,475,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a95cb7c60682d7b455a8624534ad94706" title="Constructor." alt="" coords="5,5,216,47"/>
</map>
</div>

</div>
</div>
<a id="aef58891043a14a620343f1fc477b8393" name="aef58891043a14a620343f1fc477b8393"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef58891043a14a620343f1fc477b8393">&#9670;&nbsp;</a></span>createLinearInterpolatingLinestring()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">lanelet::LineString3d carma_wm_ctrl::WMBroadcaster::createLinearInterpolatingLinestring </td>
          <td>(</td>
          <td class="paramtype">const lanelet::Point3d &amp;&#160;</td>
          <td class="paramname"><em>front_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const lanelet::Point3d &amp;&#160;</td>
          <td class="paramname"><em>back_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>increment_distance</em> = <code>0.25</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8cpp_source.html#l02171">2171</a> of file <a class="el" href="WMBroadcaster_8cpp_source.html">WMBroadcaster.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2172</span>{</div>
<div class="line"><span class="lineno"> 2173</span>  <span class="keywordtype">double</span> dx = back_pt.x() - front_pt.x();</div>
<div class="line"><span class="lineno"> 2174</span>  <span class="keywordtype">double</span> dy = back_pt.y() - front_pt.y();</div>
<div class="line"><span class="lineno"> 2175</span> </div>
<div class="line"><span class="lineno"> 2176</span>  std::vector&lt;lanelet::Point3d&gt; points;</div>
<div class="line"><span class="lineno"> 2177</span>  <span class="keywordtype">double</span> distance = std::sqrt(pow(dx, 2) + pow(dy,2));</div>
<div class="line"><span class="lineno"> 2178</span>  <span class="keywordtype">double</span> cos = dx / distance;</div>
<div class="line"><span class="lineno"> 2179</span>  <span class="keywordtype">double</span> sin = dy / distance;</div>
<div class="line"><span class="lineno"> 2180</span>  points.push_back(front_pt);</div>
<div class="line"><span class="lineno"> 2181</span>  <span class="keywordtype">double</span> sum = increment_distance;</div>
<div class="line"><span class="lineno"> 2182</span>  <span class="keywordflow">while</span> ( sum &lt; distance)</div>
<div class="line"><span class="lineno"> 2183</span>  {</div>
<div class="line"><span class="lineno"> 2184</span>    points.push_back(lanelet::Point3d(lanelet::utils::getId(),front_pt.x() + sum * cos, front_pt.y() + sum * sin, 0.0));</div>
<div class="line"><span class="lineno"> 2185</span>    sum += increment_distance;</div>
<div class="line"><span class="lineno"> 2186</span>  }</div>
<div class="line"><span class="lineno"> 2187</span>  points.push_back(back_pt);</div>
<div class="line"><span class="lineno"> 2188</span> </div>
<div class="line"><span class="lineno"> 2189</span>  <span class="keywordflow">return</span> lanelet::LineString3d(lanelet::utils::getId(), points);</div>
<div class="line"><span class="lineno"> 2190</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l02192">createLinearInterpolatingLanelet()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_aef58891043a14a620343f1fc477b8393_icgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_aef58891043a14a620343f1fc477b8393_icgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_aef58891043a14a620343f1fc477b8393_icgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_aef58891043a14a620343f1fc477b8393_icgraph">
<area shape="rect" title=" " alt="" coords="1303,5,1531,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a07466352083e95712cfed377a61c3bc7" title=" " alt="" coords="1040,5,1255,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a12708b289f7f3d8f10c6dc749bf14d65" title="Create workzone geofence. Create diagonal lanelets and a lanelet that houses opposing lane&#39;s trafficl..." alt="" coords="781,5,992,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a5ae3f2086831ebd932e19b2bdfd76405" title="Creates a single workzone geofence (in the vector) that includes all additional lanelets (housing tra..." alt="" coords="523,5,733,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a649174a7a7270df95532cad5131bf4cb" title="Adds a geofence to the current map and publishes the ROS msg." alt="" coords="264,5,475,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a95cb7c60682d7b455a8624534ad94706" title="Constructor." alt="" coords="5,5,216,47"/>
</map>
</div>

</div>
</div>
<a id="a5ae3f2086831ebd932e19b2bdfd76405" name="a5ae3f2086831ebd932e19b2bdfd76405"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ae3f2086831ebd932e19b2bdfd76405">&#9670;&nbsp;</a></span>createWorkzoneGeofence()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_ptr&lt; <a class="el" href="classcarma__wm__ctrl_1_1Geofence.html">Geofence</a> &gt; carma_wm_ctrl::WMBroadcaster::createWorkzoneGeofence </td>
          <td>(</td>
          <td class="paramtype">std::unordered_map&lt; uint8_t, std::shared_ptr&lt; <a class="el" href="classcarma__wm__ctrl_1_1Geofence.html">Geofence</a> &gt; &gt;&#160;</td>
          <td class="paramname"><em>work_zone_geofence_cache</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a single workzone geofence (in the vector) that includes all additional lanelets (housing traffic lights) and update_list that blocks old lanelets. <a class="el" href="classcarma__wm__ctrl_1_1Geofence.html" title="An object representing a geofence use for communications with CARMA Cloud.">Geofence</a> will have minimum of 6 lanelet_additions_ (front parallel, front diagonal, middle lanelet(s), back diagonal, back parallel, 1 opposing lanelet with trafficlight). And regulatory_element_ of this geofence will be region_access_rule, where it blocks entire affected_parts of CLOSED, TAPERRIGHT, OPENRIGHT. It also blocks the opposing lane's lanelet that would have had the trafficlight, and new lanelet(s) would be added to replace it. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">work_zone_geofence_cache</td><td><a class="el" href="classcarma__wm__ctrl_1_1Geofence.html" title="An object representing a geofence use for communications with CARMA Cloud.">Geofence</a> map with size of 4 corresponding to CLOSED, TAPERRIGHT, OPENRIGHT, REVERSE TrafficControlMessages. Each should have gf_pts, affected_parts, schedule, and id filled. TAPERRIGHT's id and schedule is used as all should have same schedule. </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">InvalidObjectStateError</td><td>if no map is available </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>geofence housing all necessary workzone elements </dd></dl>

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8cpp_source.html#l00393">393</a> of file <a class="el" href="WMBroadcaster_8cpp_source.html">WMBroadcaster.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  394</span>{</div>
<div class="line"><span class="lineno">  395</span>  std::shared_ptr&lt;std::vector&lt;lanelet::Lanelet&gt;&gt; parallel_llts = std::make_shared&lt;std::vector&lt;lanelet::Lanelet&gt;&gt;(std::vector&lt;lanelet::Lanelet&gt;());</div>
<div class="line"><span class="lineno">  396</span>  std::shared_ptr&lt;std::vector&lt;lanelet::Lanelet&gt;&gt; middle_opposite_lanelets = std::make_shared&lt;std::vector&lt;lanelet::Lanelet&gt;&gt;(std::vector&lt;lanelet::Lanelet&gt;());</div>
<div class="line"><span class="lineno">  397</span>  </div>
<div class="line"><span class="lineno">  398</span>  <span class="comment">// Split existing lanelets and filter into parallel_llts and middle_opposite_lanelets</span></div>
<div class="line"><span class="lineno">  399</span>  <a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#adc221f65f0b99586fc8c2ffc97c5feea">preprocessWorkzoneGeometry</a>(work_zone_geofence_cache, parallel_llts, middle_opposite_lanelets);</div>
<div class="line"><span class="lineno">  400</span> </div>
<div class="line"><span class="lineno">  401</span>  <span class="comment">// Create geofence and rest of the required lanelets along with traffic light for completing workzone area</span></div>
<div class="line"><span class="lineno">  402</span>  <span class="keyword">auto</span> gf_ptr = <a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a12708b289f7f3d8f10c6dc749bf14d65">createWorkzoneGeometry</a>(work_zone_geofence_cache, parallel_llts-&gt;front(), parallel_llts-&gt;back(), middle_opposite_lanelets );</div>
<div class="line"><span class="lineno">  403</span> </div>
<div class="line"><span class="lineno">  404</span>  <span class="comment">// copy static info from the existing workzone</span></div>
<div class="line"><span class="lineno">  405</span>  gf_ptr-&gt;id_ = work_zone_geofence_cache[<a class="code hl_variable" href="structcarma__wm__ctrl_1_1WorkZoneSection.html#a132b6a0453690caded522cf9ce8a0a75">WorkZoneSection::TAPERRIGHT</a>]-&gt;id_; <span class="comment">//using taperright&#39;s id as the whole geofence&#39;s id</span></div>
<div class="line"><span class="lineno">  406</span>  </div>
<div class="line"><span class="lineno">  407</span>  <span class="comment">// schedule</span></div>
<div class="line"><span class="lineno">  408</span>  gf_ptr-&gt;schedules = work_zone_geofence_cache[<a class="code hl_variable" href="structcarma__wm__ctrl_1_1WorkZoneSection.html#a132b6a0453690caded522cf9ce8a0a75">WorkZoneSection::TAPERRIGHT</a>]-&gt;schedules; <span class="comment">//using taperright&#39;s schedule as the whole geofence&#39;s schedule</span></div>
<div class="line"><span class="lineno">  409</span>  </div>
<div class="line"><span class="lineno">  410</span>  <span class="comment">// erase cache now that it is processed</span></div>
<div class="line"><span class="lineno">  411</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> pair : work_zone_geofence_cache)</div>
<div class="line"><span class="lineno">  412</span>  {</div>
<div class="line"><span class="lineno">  413</span>    RCLCPP_INFO_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Workzone geofence finished processing. Therefore following geofence id is being dropped from cache as it is processed as part of it: &quot;</span> &lt;&lt; pair.second-&gt;id_);</div>
<div class="line"><span class="lineno">  414</span>  }</div>
<div class="line"><span class="lineno">  415</span>  work_zone_geofence_cache.clear();</div>
<div class="line"><span class="lineno">  416</span> </div>
<div class="line"><span class="lineno">  417</span>  <span class="keywordflow">return</span> gf_ptr;</div>
<div class="line"><span class="lineno">  418</span>}</div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_a12708b289f7f3d8f10c6dc749bf14d65"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a12708b289f7f3d8f10c6dc749bf14d65">carma_wm_ctrl::WMBroadcaster::createWorkzoneGeometry</a></div><div class="ttdeci">std::shared_ptr&lt; Geofence &gt; createWorkzoneGeometry(std::unordered_map&lt; uint8_t, std::shared_ptr&lt; Geofence &gt; &gt; work_zone_geofence_cache, lanelet::Lanelet parallel_llt_front, lanelet::Lanelet parallel_llt_back, std::shared_ptr&lt; std::vector&lt; lanelet::Lanelet &gt; &gt; middle_opposite_lanelets)</div><div class="ttdoc">Create workzone geofence. Create diagonal lanelets and a lanelet that houses opposing lane's trafficl...</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8cpp_source.html#l00420">WMBroadcaster.cpp:420</a></div></div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_adc221f65f0b99586fc8c2ffc97c5feea"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#adc221f65f0b99586fc8c2ffc97c5feea">carma_wm_ctrl::WMBroadcaster::preprocessWorkzoneGeometry</a></div><div class="ttdeci">void preprocessWorkzoneGeometry(std::unordered_map&lt; uint8_t, std::shared_ptr&lt; Geofence &gt; &gt; work_zone_geofence_cache, std::shared_ptr&lt; std::vector&lt; lanelet::Lanelet &gt; &gt; parallel_llts, std::shared_ptr&lt; std::vector&lt; lanelet::Lanelet &gt; &gt; opposite_llts)</div><div class="ttdoc">Preprocess for workzone area. Parallel_llts will have front_parallel and back_parallel lanelets that ...</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8cpp_source.html#l00600">WMBroadcaster.cpp:600</a></div></div>
<div class="ttc" id="astructcarma__wm__ctrl_1_1WorkZoneSection_html_a132b6a0453690caded522cf9ce8a0a75"><div class="ttname"><a href="structcarma__wm__ctrl_1_1WorkZoneSection.html#a132b6a0453690caded522cf9ce8a0a75">carma_wm_ctrl::WorkZoneSection::TAPERRIGHT</a></div><div class="ttdeci">static const uint8_t TAPERRIGHT</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8hpp_source.html#l00062">WMBroadcaster.hpp:62</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMBroadcaster_8cpp_source.html#l00420">createWorkzoneGeometry()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l00600">preprocessWorkzoneGeometry()</a>, and <a class="el" href="WMBroadcaster_8hpp_source.html#l00062">carma_wm_ctrl::WorkZoneSection::TAPERRIGHT</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l01488">addGeofence()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_a5ae3f2086831ebd932e19b2bdfd76405_cgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_a5ae3f2086831ebd932e19b2bdfd76405_cgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_a5ae3f2086831ebd932e19b2bdfd76405_cgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_a5ae3f2086831ebd932e19b2bdfd76405_cgraph">
<area shape="rect" title="Creates a single workzone geofence (in the vector) that includes all additional lanelets (housing tra..." alt="" coords="5,232,216,273"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a12708b289f7f3d8f10c6dc749bf14d65" title="Create workzone geofence. Create diagonal lanelets and a lanelet that houses opposing lane&#39;s trafficl..." alt="" coords="264,199,475,240"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#adc221f65f0b99586fc8c2ffc97c5feea" title="Preprocess for workzone area. Parallel_llts will have front_parallel and back_parallel lanelets that ..." alt="" coords="264,264,475,305"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ae34565da1566e777745a92161422404c" title="Adds RegionAccessRule to the map." alt="" coords="525,71,735,112"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a07466352083e95712cfed377a61c3bc7" title=" " alt="" coords="523,136,737,177"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#adfb94b051e74a67830c1795e32081cbc" title="helper for generating 32bit traffic light Id from TCM label field consisting workzone intersection/si..." alt="" coords="525,201,735,243"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a264607b6ec5b20d8971f8dc14a4b1825" title="Split given lanelet&#39;s adjacent, OPPOSITE lanelet with same proportion as the given point&#39;s downtrack ..." alt="" coords="525,344,735,385"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ac71c9fdbf27cbfbe3988c3a77d6e7067" title="Generates inverse participants list of the given participants." alt="" coords="794,5,1005,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aa326eab73fe1583c1fa937ed2e38b33f" title="Generates participants list." alt="" coords="794,71,1005,112"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a2c6c3606e5f4b3c12a984261823c1d71" title="Combines a list of the given participants into a single &quot;vehicle&quot; type if participants cover all poss..." alt="" coords="1061,71,1272,112"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aef58891043a14a620343f1fc477b8393" title=" " alt="" coords="785,136,1013,177"/>
<area shape="rect" href="namespacecarma__wm_1_1utils.html#a5f9cfb53df6903542a0cb9bf2f8a7d7c" title="Get 32bit id by concatenating 16bit id with 8bit signal_group_id." alt="" coords="809,209,990,235"/>
<area shape="rect" href="namespacecarma__wm_1_1query.html#a9fb50939b2ae576d2eb7fcfc42fcdc22" title="Given the cartesian point on the map, tries to get the opposite direction lanelet on the left This fu..." alt="" coords="793,319,1005,360"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#aebce986f21c117983313292d5e82b50a" title="Returns the TrackPos, computed in 2d, of the provided point relative to the centerline of the provide..." alt="" coords="1094,400,1239,441"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a1dfc2ec5be906966916939c75874cbab" title="Split given lanelet with given downtrack ratios relative to the lanelet. Newly created lanelet will h..." alt="" coords="794,436,1005,477"/>
<area shape="rect" href="namespacecarma__wm_1_1query.html#a8933b74d652e02d07be1170b787d87a2" title="carma_wm::query namespace contains implementations for query functions (input and output read or writ..." alt="" coords="1068,245,1265,287"/>
<area shape="rect" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5" title=" " alt="" coords="1067,335,1266,376"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#ab675b2b8862a2ba9c139a8b5b353b846" title="Get the TrackPos of the provided point along the linestring and the segment of the line string which ..." alt="" coords="1320,400,1465,441"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#ae0a06818149f7430fee80e295ef04548" title="Helper function to identify whether to select the preceeding or succeeding segment of a linstring poi..." alt="" coords="1513,400,1659,441"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a883734808f44db2778371ce3fbeecdd3" title="Split given lanelet with same proportion as the given points&#39; downtrack relative to the lanelet...." alt="" coords="525,436,735,477"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_a5ae3f2086831ebd932e19b2bdfd76405_icgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_a5ae3f2086831ebd932e19b2bdfd76405_icgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_a5ae3f2086831ebd932e19b2bdfd76405_icgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_a5ae3f2086831ebd932e19b2bdfd76405_icgraph">
<area shape="rect" title="Creates a single workzone geofence (in the vector) that includes all additional lanelets (housing tra..." alt="" coords="523,5,733,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a649174a7a7270df95532cad5131bf4cb" title="Adds a geofence to the current map and publishes the ROS msg." alt="" coords="264,5,475,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a95cb7c60682d7b455a8624534ad94706" title="Constructor." alt="" coords="5,5,216,47"/>
</map>
</div>

</div>
</div>
<a id="a12708b289f7f3d8f10c6dc749bf14d65" name="a12708b289f7f3d8f10c6dc749bf14d65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a12708b289f7f3d8f10c6dc749bf14d65">&#9670;&nbsp;</a></span>createWorkzoneGeometry()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_ptr&lt; <a class="el" href="classcarma__wm__ctrl_1_1Geofence.html">Geofence</a> &gt; carma_wm_ctrl::WMBroadcaster::createWorkzoneGeometry </td>
          <td>(</td>
          <td class="paramtype">std::unordered_map&lt; uint8_t, std::shared_ptr&lt; <a class="el" href="classcarma__wm__ctrl_1_1Geofence.html">Geofence</a> &gt; &gt;&#160;</td>
          <td class="paramname"><em>work_zone_geofence_cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">lanelet::Lanelet&#160;</td>
          <td class="paramname"><em>parallel_llt_front</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">lanelet::Lanelet&#160;</td>
          <td class="paramname"><em>parallel_llt_back</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::shared_ptr&lt; std::vector&lt; lanelet::Lanelet &gt; &gt;&#160;</td>
          <td class="paramname"><em>middle_opposite_lanelets</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create workzone geofence. Create diagonal lanelets and a lanelet that houses opposing lane's trafficlight. Fill lanelet_additions_ with every newly created lanelets New lanelets will have traffic light. Old lanelets (and those from CLOSED) will be blocked using update_list as region_access_rule. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">work_zone_geofence_cache</td><td><a class="el" href="classcarma__wm__ctrl_1_1Geofence.html" title="An object representing a geofence use for communications with CARMA Cloud.">Geofence</a> map with size of 4 corresponding to CLOSED, TAPERRIGHT, OPENRIGHT, REVERSE TrafficControlMessages. Each should have gf_pts, affected_parts. </td></tr>
    <tr><td class="paramname">parallel_llt_front</td><td>A lanelet whose end should connect to front diagonal lanelet </td></tr>
    <tr><td class="paramname">parallel_llt_back</td><td>A lanelet whose start should connect to back diagonal lanelet </td></tr>
    <tr><td class="paramname">middle_opposite_lanelets</td><td>A getInterGroupIdsByLightReg() connects to back diagonal (their directions are expected to be opposite of parallel ones) </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">InvalidObjectStateError</td><td>if no map is available </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8cpp_source.html#l00420">420</a> of file <a class="el" href="WMBroadcaster_8cpp_source.html">WMBroadcaster.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  422</span>{</div>
<div class="line"><span class="lineno">  423</span>  <span class="keyword">auto</span> gf_ptr = std::make_shared&lt;Geofence&gt;();</div>
<div class="line"><span class="lineno">  424</span> </div>
<div class="line"><span class="lineno">  426</span>  <span class="comment">//FRONT DIAGONAL LANELET</span></div>
<div class="line"><span class="lineno">  428</span><span class="comment"></span> </div>
<div class="line"><span class="lineno">  429</span>  lanelet::Lanelet front_llt_diag = <a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a07466352083e95712cfed377a61c3bc7">createLinearInterpolatingLanelet</a>(parallel_llt_front.leftBound3d().back(), parallel_llt_front.rightBound3d().back(), </div>
<div class="line"><span class="lineno">  430</span>                                                                        middle_opposite_lanelets-&gt;back().rightBound3d().back(), middle_opposite_lanelets-&gt;back().leftBound3d().back());</div>
<div class="line"><span class="lineno">  431</span>  RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Created diag front_llt_diag id:&quot;</span> &lt;&lt; front_llt_diag.id());</div>
<div class="line"><span class="lineno">  432</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> regem : middle_opposite_lanelets-&gt;back().regulatoryElements()) <span class="comment">//copy existing regem into the new llts</span></div>
<div class="line"><span class="lineno">  433</span>  {</div>
<div class="line"><span class="lineno">  434</span>    front_llt_diag.addRegulatoryElement(regem);</div>
<div class="line"><span class="lineno">  435</span>  }</div>
<div class="line"><span class="lineno">  436</span> </div>
<div class="line"><span class="lineno">  438</span>  <span class="comment">//BACK DIAGONAL LANELET</span></div>
<div class="line"><span class="lineno">  440</span><span class="comment"></span> </div>
<div class="line"><span class="lineno">  441</span>  lanelet::Lanelet back_llt_diag = <a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a07466352083e95712cfed377a61c3bc7">createLinearInterpolatingLanelet</a>(middle_opposite_lanelets-&gt;front().rightBound3d().front(),  middle_opposite_lanelets-&gt;front().leftBound3d().front(), </div>
<div class="line"><span class="lineno">  442</span>                                                                     parallel_llt_back.leftBound3d().front(), parallel_llt_back.rightBound3d().front());</div>
<div class="line"><span class="lineno">  443</span>  RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Created back_llt_diag diag id:&quot;</span> &lt;&lt; back_llt_diag.id());</div>
<div class="line"><span class="lineno">  444</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> regem : parallel_llt_back.regulatoryElements()) <span class="comment">//copy existing regem into the new llts</span></div>
<div class="line"><span class="lineno">  445</span>  {</div>
<div class="line"><span class="lineno">  446</span>    back_llt_diag.addRegulatoryElement(regem);</div>
<div class="line"><span class="lineno">  447</span>  }</div>
<div class="line"><span class="lineno">  448</span> </div>
<div class="line"><span class="lineno">  450</span>  <span class="comment">//MIDDLE LANELETS TO MATCH PARALLEL DIRECTION</span></div>
<div class="line"><span class="lineno">  452</span><span class="comment"></span> </div>
<div class="line"><span class="lineno">  453</span>  std::vector&lt;lanelet::Lanelet&gt; middle_llts;</div>
<div class="line"><span class="lineno">  454</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> = middle_opposite_lanelets-&gt;size() - 1; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> &gt;= 0; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>--) <span class="comment">//do no use size_t as it might overflow</span></div>
<div class="line"><span class="lineno">  455</span>  {</div>
<div class="line"><span class="lineno">  456</span>    lanelet::Lanelet middle_llt (lanelet::utils::getId(), (*(middle_opposite_lanelets.get()))[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>].rightBound3d().invert(), (*(middle_opposite_lanelets.get()))[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>].leftBound3d().invert());</div>
<div class="line"><span class="lineno">  457</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> regem : (*(middle_opposite_lanelets.get()))[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>].regulatoryElements())</div>
<div class="line"><span class="lineno">  458</span>    {</div>
<div class="line"><span class="lineno">  459</span>      middle_llt.addRegulatoryElement(regem); <span class="comment">//copy existing regem into the new llts</span></div>
<div class="line"><span class="lineno">  460</span>    }</div>
<div class="line"><span class="lineno">  461</span>    middle_llts.push_back(middle_llt);</div>
<div class="line"><span class="lineno">  462</span>    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Created matching direction of middle_llt id:&quot;</span> &lt;&lt; middle_llt.id());</div>
<div class="line"><span class="lineno">  463</span>  }</div>
<div class="line"><span class="lineno">  464</span> </div>
<div class="line"><span class="lineno">  466</span>  <span class="comment">//ADD TF_LIGHT TO PARALLEL LANELET</span></div>
<div class="line"><span class="lineno">  468</span><span class="comment"></span>  lanelet::LineString3d parallel_stop_ls(lanelet::utils::getId(), {parallel_llt_front.leftBound3d().back(), parallel_llt_front.rightBound3d().back()});</div>
<div class="line"><span class="lineno">  469</span>  <span class="comment">// controlled lanelet:</span></div>
<div class="line"><span class="lineno">  470</span>  std::vector&lt;lanelet::Lanelet&gt; controlled_taper_right;</div>
<div class="line"><span class="lineno">  471</span> </div>
<div class="line"><span class="lineno">  472</span>  controlled_taper_right.push_back(parallel_llt_front); <span class="comment">//which has the light</span></div>
<div class="line"><span class="lineno">  473</span> </div>
<div class="line"><span class="lineno">  474</span>  controlled_taper_right.push_back(front_llt_diag);</div>
<div class="line"><span class="lineno">  475</span> </div>
<div class="line"><span class="lineno">  476</span>  controlled_taper_right.insert(controlled_taper_right.end(), middle_llts.begin(), middle_llts.end());</div>
<div class="line"><span class="lineno">  477</span> </div>
<div class="line"><span class="lineno">  478</span>  controlled_taper_right.push_back(back_llt_diag);</div>
<div class="line"><span class="lineno">  479</span> </div>
<div class="line"><span class="lineno">  480</span>  lanelet::CarmaTrafficSignalPtr tfl_parallel = std::make_shared&lt;lanelet::CarmaTrafficSignal&gt;(lanelet::CarmaTrafficSignal::buildData(lanelet::utils::getId(), {parallel_stop_ls}, {controlled_taper_right.front()}, {controlled_taper_right.back()})); </div>
<div class="line"><span class="lineno">  481</span> </div>
<div class="line"><span class="lineno">  482</span>  gf_ptr-&gt;traffic_light_id_lookup_.push_back({<a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#adfb94b051e74a67830c1795e32081cbc">generate32BitId</a>(work_zone_geofence_cache[<a class="code hl_variable" href="structcarma__wm__ctrl_1_1WorkZoneSection.html#a132b6a0453690caded522cf9ce8a0a75">WorkZoneSection::TAPERRIGHT</a>]-&gt;label_),tfl_parallel-&gt;id()});</div>
<div class="line"><span class="lineno">  483</span> </div>
<div class="line"><span class="lineno">  484</span>  parallel_llt_front.addRegulatoryElement(tfl_parallel);</div>
<div class="line"><span class="lineno">  485</span>  RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Created TF_LIGHT of Id: &quot;</span> &lt;&lt; tfl_parallel-&gt;id() &lt;&lt; <span class="stringliteral">&quot;, to parallel_llt_front id:&quot;</span> &lt;&lt; parallel_llt_front.id());</div>
<div class="line"><span class="lineno">  486</span> </div>
<div class="line"><span class="lineno">  488</span>  <span class="comment">//ADD TF_LIGHT TO OPPOSITE LANELET</span></div>
<div class="line"><span class="lineno">  490</span><span class="comment"></span>  std::shared_ptr&lt;std::vector&lt;lanelet::Lanelet&gt;&gt; opposite_llts_with_stop_line = std::make_shared&lt;std::vector&lt;lanelet::Lanelet&gt;&gt;(std::vector&lt;lanelet::Lanelet&gt;());</div>
<div class="line"><span class="lineno">  491</span>  </div>
<div class="line"><span class="lineno">  492</span>  <span class="keyword">auto</span> old_opposite_llts = <a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a264607b6ec5b20d8971f8dc14a4b1825">splitOppositeLaneletWithPoint</a>(opposite_llts_with_stop_line, work_zone_geofence_cache[<a class="code hl_variable" href="structcarma__wm__ctrl_1_1WorkZoneSection.html#ac422b9b0dab0dea3fdf1a8ee4dc64abc">WorkZoneSection::OPENRIGHT</a>]-&gt;gf_pts.back().basicPoint2d(), </div>
<div class="line"><span class="lineno">  493</span>                        <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;laneletLayer.get(work_zone_geofence_cache[<a class="code hl_variable" href="structcarma__wm__ctrl_1_1WorkZoneSection.html#ac422b9b0dab0dea3fdf1a8ee4dc64abc">WorkZoneSection::OPENRIGHT</a>]-&gt;affected_parts_.back().lanelet().get().id()), <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ab5567570e8a54c507f1c55c23f364933">error_distance_</a>);</div>
<div class="line"><span class="lineno">  494</span>  </div>
<div class="line"><span class="lineno">  495</span>  lanelet::LineString3d opposite_stop_ls(lanelet::utils::getId(), {opposite_llts_with_stop_line-&gt;front().leftBound3d().back(), opposite_llts_with_stop_line-&gt;front().rightBound3d().back()});</div>
<div class="line"><span class="lineno">  496</span>  </div>
<div class="line"><span class="lineno">  497</span>  std::vector&lt;lanelet::Lanelet&gt; controlled_open_right;</div>
<div class="line"><span class="lineno">  498</span>  </div>
<div class="line"><span class="lineno">  499</span>  controlled_open_right.insert(controlled_open_right.end(), opposite_llts_with_stop_line-&gt;begin(), opposite_llts_with_stop_line-&gt;end());; <span class="comment">//split lanelet one of which has light</span></div>
<div class="line"><span class="lineno">  500</span>  </div>
<div class="line"><span class="lineno">  501</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> llt : work_zone_geofence_cache[<a class="code hl_variable" href="structcarma__wm__ctrl_1_1WorkZoneSection.html#ade4ff9d14cf9c540b8235d25a3fe1b61">WorkZoneSection::REVERSE</a>]-&gt;affected_parts_)</div>
<div class="line"><span class="lineno">  502</span>  {</div>
<div class="line"><span class="lineno">  503</span>    controlled_open_right.push_back(<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;laneletLayer.get(llt.lanelet().get().id()));</div>
<div class="line"><span class="lineno">  504</span>  }</div>
<div class="line"><span class="lineno">  505</span> </div>
<div class="line"><span class="lineno">  506</span>  lanelet::CarmaTrafficSignalPtr tfl_opposite = std::make_shared&lt;lanelet::CarmaTrafficSignal&gt;(lanelet::CarmaTrafficSignal::buildData(lanelet::utils::getId(), {opposite_stop_ls}, {controlled_open_right.front()}, {controlled_open_right.back()}));</div>
<div class="line"><span class="lineno">  507</span>  </div>
<div class="line"><span class="lineno">  508</span>  gf_ptr-&gt;traffic_light_id_lookup_.push_back({<a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#adfb94b051e74a67830c1795e32081cbc">generate32BitId</a>(work_zone_geofence_cache[<a class="code hl_variable" href="structcarma__wm__ctrl_1_1WorkZoneSection.html#ac422b9b0dab0dea3fdf1a8ee4dc64abc">WorkZoneSection::OPENRIGHT</a>]-&gt;label_), tfl_opposite-&gt;id()});</div>
<div class="line"><span class="lineno">  509</span>  </div>
<div class="line"><span class="lineno">  510</span>  opposite_llts_with_stop_line-&gt;front().addRegulatoryElement(tfl_opposite);</div>
<div class="line"><span class="lineno">  511</span>  RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Created TF_LIGHT of Id: &quot;</span> &lt;&lt; tfl_opposite-&gt;id() &lt;&lt; <span class="stringliteral">&quot;, to opposite_llts_with_stop_line-&gt;front() id:&quot;</span> &lt;&lt; opposite_llts_with_stop_line-&gt;front().id());</div>
<div class="line"><span class="lineno">  512</span> </div>
<div class="line"><span class="lineno">  514</span>  <span class="comment">//ADD ALL NEWLY CREATED LANELETS INTO GEOFENCE </span></div>
<div class="line"><span class="lineno">  515</span>  <span class="comment">//OBJECTS TO BE PROCESSED LATER BY SCHEDULER</span></div>
<div class="line"><span class="lineno">  517</span><span class="comment"></span>  RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Added parallel_llt_front id:&quot;</span> &lt;&lt; parallel_llt_front.id());</div>
<div class="line"><span class="lineno">  518</span>  gf_ptr-&gt;lanelet_additions_.push_back(parallel_llt_front);</div>
<div class="line"><span class="lineno">  519</span> </div>
<div class="line"><span class="lineno">  520</span>  gf_ptr-&gt;lanelet_additions_.push_back(front_llt_diag);</div>
<div class="line"><span class="lineno">  521</span> </div>
<div class="line"><span class="lineno">  522</span>  gf_ptr-&gt;lanelet_additions_.insert(gf_ptr-&gt;lanelet_additions_.end(), middle_llts.begin(), middle_llts.end());</div>
<div class="line"><span class="lineno">  523</span> </div>
<div class="line"><span class="lineno">  524</span>  gf_ptr-&gt;lanelet_additions_.push_back(back_llt_diag);</div>
<div class="line"><span class="lineno">  525</span>  RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Added parallel_llt_back id:&quot;</span> &lt;&lt; parallel_llt_back.id());</div>
<div class="line"><span class="lineno">  526</span>  gf_ptr-&gt;lanelet_additions_.push_back(parallel_llt_back);</div>
<div class="line"><span class="lineno">  527</span> </div>
<div class="line"><span class="lineno">  528</span>  gf_ptr-&gt;lanelet_additions_.insert(gf_ptr-&gt;lanelet_additions_.end(), opposite_llts_with_stop_line-&gt;begin(), opposite_llts_with_stop_line-&gt;end());;</div>
<div class="line"><span class="lineno">  529</span> </div>
<div class="line"><span class="lineno">  531</span>  <span class="comment">// ADD REGION_ACCESS_RULE REGEM TO THE OUTDATED LANELETS </span></div>
<div class="line"><span class="lineno">  532</span>  <span class="comment">// AS WELL AS LANELETS BEING BLOCKED BY WORKZONE GEOFENCE</span></div>
<div class="line"><span class="lineno">  534</span><span class="comment"></span>    </div>
<div class="line"><span class="lineno">  535</span>  <span class="comment">// fill information for paricipants and reason for blocking</span></div>
<div class="line"><span class="lineno">  536</span>  carma_v2x_msgs::msg::TrafficControlMessageV01 participants_and_reason_only;</div>
<div class="line"><span class="lineno">  537</span> </div>
<div class="line"><span class="lineno">  538</span>  j2735_v2x_msgs::msg::TrafficControlVehClass participant; <span class="comment">// sending all possible VEHICLE will be processed as they are not accessuble by regionAccessRule</span></div>
<div class="line"><span class="lineno">  539</span>  </div>
<div class="line"><span class="lineno">  540</span>  participant.vehicle_class =  j2735_v2x_msgs::msg::TrafficControlVehClass::MICROMOBILE;</div>
<div class="line"><span class="lineno">  541</span> </div>
<div class="line"><span class="lineno">  542</span>  participants_and_reason_only.params.vclasses.push_back(participant);</div>
<div class="line"><span class="lineno">  543</span> </div>
<div class="line"><span class="lineno">  544</span>  participant.vehicle_class =  j2735_v2x_msgs::msg::TrafficControlVehClass::BUS;</div>
<div class="line"><span class="lineno">  545</span> </div>
<div class="line"><span class="lineno">  546</span>  participants_and_reason_only.params.vclasses.push_back(participant);</div>
<div class="line"><span class="lineno">  547</span> </div>
<div class="line"><span class="lineno">  548</span>  participant.vehicle_class =  j2735_v2x_msgs::msg::TrafficControlVehClass::PASSENGER_CAR;</div>
<div class="line"><span class="lineno">  549</span> </div>
<div class="line"><span class="lineno">  550</span>  participants_and_reason_only.params.vclasses.push_back(participant);</div>
<div class="line"><span class="lineno">  551</span> </div>
<div class="line"><span class="lineno">  552</span>  participant.vehicle_class =  j2735_v2x_msgs::msg::TrafficControlVehClass::TWO_AXLE_SIX_TIRE_SINGLE_UNIT_TRUCK;</div>
<div class="line"><span class="lineno">  553</span> </div>
<div class="line"><span class="lineno">  554</span>  participants_and_reason_only.params.vclasses.push_back(participant);</div>
<div class="line"><span class="lineno">  555</span> </div>
<div class="line"><span class="lineno">  556</span>  participants_and_reason_only.package.label = <span class="stringliteral">&quot;SIG_WZ&quot;</span>;</div>
<div class="line"><span class="lineno">  557</span> </div>
<div class="line"><span class="lineno">  558</span>  std::vector&lt;lanelet::Lanelet&gt; old_or_blocked_llts; <span class="comment">// this is needed to addRegionAccessRule input signatures</span></div>
<div class="line"><span class="lineno">  559</span>  </div>
<div class="line"><span class="lineno">  560</span>  <span class="comment">// from all affected parts, remove duplicate entries</span></div>
<div class="line"><span class="lineno">  561</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> llt : work_zone_geofence_cache[<a class="code hl_variable" href="structcarma__wm__ctrl_1_1WorkZoneSection.html#a132b6a0453690caded522cf9ce8a0a75">WorkZoneSection::TAPERRIGHT</a>]-&gt;affected_parts_)</div>
<div class="line"><span class="lineno">  562</span>  {</div>
<div class="line"><span class="lineno">  563</span>    <span class="keywordflow">if</span> (std::find(old_or_blocked_llts.begin(), old_or_blocked_llts.end(), llt) == old_or_blocked_llts.end())</div>
<div class="line"><span class="lineno">  564</span>    {</div>
<div class="line"><span class="lineno">  565</span>      gf_ptr-&gt;affected_parts_.push_back(<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;laneletLayer.get(llt.lanelet()-&gt;id()));</div>
<div class="line"><span class="lineno">  566</span>      old_or_blocked_llts.push_back(<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;laneletLayer.get(llt.lanelet()-&gt;id()));</div>
<div class="line"><span class="lineno">  567</span>    }</div>
<div class="line"><span class="lineno">  568</span>  }</div>
<div class="line"><span class="lineno">  569</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> llt : work_zone_geofence_cache[<a class="code hl_variable" href="structcarma__wm__ctrl_1_1WorkZoneSection.html#a561823991a08efb93de13f9251b067e8">WorkZoneSection::CLOSED</a>]-&gt;affected_parts_)</div>
<div class="line"><span class="lineno">  570</span>  {</div>
<div class="line"><span class="lineno">  571</span>    <span class="keywordflow">if</span> (std::find(old_or_blocked_llts.begin(), old_or_blocked_llts.end(), llt) == old_or_blocked_llts.end())</div>
<div class="line"><span class="lineno">  572</span>    {</div>
<div class="line"><span class="lineno">  573</span>      gf_ptr-&gt;affected_parts_.push_back(<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;laneletLayer.get(llt.lanelet()-&gt;id()));</div>
<div class="line"><span class="lineno">  574</span>      old_or_blocked_llts.push_back(<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;laneletLayer.get(llt.lanelet()-&gt;id()));</div>
<div class="line"><span class="lineno">  575</span>    }</div>
<div class="line"><span class="lineno">  576</span>  }</div>
<div class="line"><span class="lineno">  577</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> llt : work_zone_geofence_cache[<a class="code hl_variable" href="structcarma__wm__ctrl_1_1WorkZoneSection.html#ac422b9b0dab0dea3fdf1a8ee4dc64abc">WorkZoneSection::OPENRIGHT</a>]-&gt;affected_parts_)</div>
<div class="line"><span class="lineno">  578</span>  {</div>
<div class="line"><span class="lineno">  579</span>    <span class="keywordflow">if</span> (std::find(old_or_blocked_llts.begin(), old_or_blocked_llts.end(), llt) == old_or_blocked_llts.end())</div>
<div class="line"><span class="lineno">  580</span>    {</div>
<div class="line"><span class="lineno">  581</span>      gf_ptr-&gt;affected_parts_.push_back(<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;laneletLayer.get(llt.lanelet()-&gt;id()));</div>
<div class="line"><span class="lineno">  582</span>      old_or_blocked_llts.push_back(<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;laneletLayer.get(llt.lanelet()-&gt;id()));</div>
<div class="line"><span class="lineno">  583</span>    }</div>
<div class="line"><span class="lineno">  584</span>  }</div>
<div class="line"><span class="lineno">  585</span>  </div>
<div class="line"><span class="lineno">  586</span>  gf_ptr-&gt;affected_parts_.push_back(old_opposite_llts[0]); <span class="comment">// block old lanelet in the opposing lanelet that will be replaced with split lanelets that have trafficlight</span></div>
<div class="line"><span class="lineno">  587</span>  old_or_blocked_llts.push_back(old_opposite_llts[0]);</div>
<div class="line"><span class="lineno">  588</span> </div>
<div class="line"><span class="lineno">  589</span>  <span class="comment">// actual regulatory element adder</span></div>
<div class="line"><span class="lineno">  590</span>  <a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ae34565da1566e777745a92161422404c">addRegionAccessRule</a>(gf_ptr, participants_and_reason_only, old_or_blocked_llts); </div>
<div class="line"><span class="lineno">  591</span>  </div>
<div class="line"><span class="lineno">  592</span>  <span class="keywordflow">return</span> gf_ptr;</div>
<div class="line"><span class="lineno">  593</span>}</div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_a07466352083e95712cfed377a61c3bc7"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a07466352083e95712cfed377a61c3bc7">carma_wm_ctrl::WMBroadcaster::createLinearInterpolatingLanelet</a></div><div class="ttdeci">lanelet::Lanelet createLinearInterpolatingLanelet(const lanelet::Point3d &amp;left_front_pt, const lanelet::Point3d &amp;right_front_pt, const lanelet::Point3d &amp;left_back_pt, const lanelet::Point3d &amp;right_back_pt, double increment_distance=0.25)</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8cpp_source.html#l02192">WMBroadcaster.cpp:2192</a></div></div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_a264607b6ec5b20d8971f8dc14a4b1825"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a264607b6ec5b20d8971f8dc14a4b1825">carma_wm_ctrl::WMBroadcaster::splitOppositeLaneletWithPoint</a></div><div class="ttdeci">lanelet::Lanelets splitOppositeLaneletWithPoint(std::shared_ptr&lt; std::vector&lt; lanelet::Lanelet &gt; &gt; opposite_llts, const lanelet::BasicPoint2d &amp;input_pt, const lanelet::Lanelet &amp;input_llt, double error_distance)</div><div class="ttdoc">Split given lanelet's adjacent, OPPOSITE lanelet with same proportion as the given point's downtrack ...</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8cpp_source.html#l00776">WMBroadcaster.cpp:776</a></div></div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_ab5567570e8a54c507f1c55c23f364933"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ab5567570e8a54c507f1c55c23f364933">carma_wm_ctrl::WMBroadcaster::error_distance_</a></div><div class="ttdeci">double error_distance_</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8hpp_source.html#l00409">WMBroadcaster.hpp:409</a></div></div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_adfb94b051e74a67830c1795e32081cbc"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#adfb94b051e74a67830c1795e32081cbc">carma_wm_ctrl::WMBroadcaster::generate32BitId</a></div><div class="ttdeci">uint32_t generate32BitId(const std::string &amp;label)</div><div class="ttdoc">helper for generating 32bit traffic light Id from TCM label field consisting workzone intersection/si...</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8cpp_source.html#l01252">WMBroadcaster.cpp:1252</a></div></div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_ae34565da1566e777745a92161422404c"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ae34565da1566e777745a92161422404c">carma_wm_ctrl::WMBroadcaster::addRegionAccessRule</a></div><div class="ttdeci">void addRegionAccessRule(std::shared_ptr&lt; Geofence &gt; gf_ptr, const carma_v2x_msgs::msg::TrafficControlMessageV01 &amp;msg_v01, const std::vector&lt; lanelet::Lanelet &gt; &amp;affected_llts) const</div><div class="ttdoc">Adds RegionAccessRule to the map.</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8cpp_source.html#l00926">WMBroadcaster.cpp:926</a></div></div>
<div class="ttc" id="astructcarma__wm__ctrl_1_1WorkZoneSection_html_a561823991a08efb93de13f9251b067e8"><div class="ttname"><a href="structcarma__wm__ctrl_1_1WorkZoneSection.html#a561823991a08efb93de13f9251b067e8">carma_wm_ctrl::WorkZoneSection::CLOSED</a></div><div class="ttdeci">static const uint8_t CLOSED</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8hpp_source.html#l00062">WMBroadcaster.hpp:62</a></div></div>
<div class="ttc" id="astructcarma__wm__ctrl_1_1WorkZoneSection_html_ac422b9b0dab0dea3fdf1a8ee4dc64abc"><div class="ttname"><a href="structcarma__wm__ctrl_1_1WorkZoneSection.html#ac422b9b0dab0dea3fdf1a8ee4dc64abc">carma_wm_ctrl::WorkZoneSection::OPENRIGHT</a></div><div class="ttdeci">static const uint8_t OPENRIGHT</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8hpp_source.html#l00062">WMBroadcaster.hpp:62</a></div></div>
<div class="ttc" id="astructcarma__wm__ctrl_1_1WorkZoneSection_html_ade4ff9d14cf9c540b8235d25a3fe1b61"><div class="ttname"><a href="structcarma__wm__ctrl_1_1WorkZoneSection.html#ade4ff9d14cf9c540b8235d25a3fe1b61">carma_wm_ctrl::WorkZoneSection::REVERSE</a></div><div class="ttdeci">static const uint8_t REVERSE</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8hpp_source.html#l00062">WMBroadcaster.hpp:62</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMBroadcaster_8cpp_source.html#l00926">addRegionAccessRule()</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00062">carma_wm_ctrl::WorkZoneSection::CLOSED</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l02192">createLinearInterpolatingLanelet()</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00429">current_map_</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00409">error_distance_</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l01252">generate32BitId()</a>, <a class="el" href="process__bag_8py_source.html#l00059">process_bag::i</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00062">carma_wm_ctrl::WorkZoneSection::OPENRIGHT</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00062">carma_wm_ctrl::WorkZoneSection::REVERSE</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l00776">splitOppositeLaneletWithPoint()</a>, and <a class="el" href="WMBroadcaster_8hpp_source.html#l00062">carma_wm_ctrl::WorkZoneSection::TAPERRIGHT</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l00393">createWorkzoneGeofence()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_a12708b289f7f3d8f10c6dc749bf14d65_cgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_a12708b289f7f3d8f10c6dc749bf14d65_cgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_a12708b289f7f3d8f10c6dc749bf14d65_cgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_a12708b289f7f3d8f10c6dc749bf14d65_cgraph">
<area shape="rect" title="Create workzone geofence. Create diagonal lanelets and a lanelet that houses opposing lane&#39;s trafficl..." alt="" coords="5,169,216,211"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ae34565da1566e777745a92161422404c" title="Adds RegionAccessRule to the map." alt="" coords="266,71,477,112"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a07466352083e95712cfed377a61c3bc7" title=" " alt="" coords="264,136,479,177"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#adfb94b051e74a67830c1795e32081cbc" title="helper for generating 32bit traffic light Id from TCM label field consisting workzone intersection/si..." alt="" coords="266,201,477,243"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a264607b6ec5b20d8971f8dc14a4b1825" title="Split given lanelet&#39;s adjacent, OPPOSITE lanelet with same proportion as the given point&#39;s downtrack ..." alt="" coords="266,289,477,331"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ac71c9fdbf27cbfbe3988c3a77d6e7067" title="Generates inverse participants list of the given participants." alt="" coords="535,5,746,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aa326eab73fe1583c1fa937ed2e38b33f" title="Generates participants list." alt="" coords="535,71,746,112"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a2c6c3606e5f4b3c12a984261823c1d71" title="Combines a list of the given participants into a single &quot;vehicle&quot; type if participants cover all poss..." alt="" coords="803,71,1013,112"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aef58891043a14a620343f1fc477b8393" title=" " alt="" coords="527,136,755,177"/>
<area shape="rect" href="namespacecarma__wm_1_1utils.html#a5f9cfb53df6903542a0cb9bf2f8a7d7c" title="Get 32bit id by concatenating 16bit id with 8bit signal_group_id." alt="" coords="550,205,731,231"/>
<area shape="rect" href="namespacecarma__wm_1_1query.html#a9fb50939b2ae576d2eb7fcfc42fcdc22" title="Given the cartesian point on the map, tries to get the opposite direction lanelet on the left This fu..." alt="" coords="535,256,747,297"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#aebce986f21c117983313292d5e82b50a" title="Returns the TrackPos, computed in 2d, of the provided point relative to the centerline of the provide..." alt="" coords="835,317,981,359"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a1dfc2ec5be906966916939c75874cbab" title="Split given lanelet with given downtrack ratios relative to the lanelet. Newly created lanelet will h..." alt="" coords="535,373,746,415"/>
<area shape="rect" href="namespacecarma__wm_1_1query.html#a8933b74d652e02d07be1170b787d87a2" title="carma_wm::query namespace contains implementations for query functions (input and output read or writ..." alt="" coords="809,163,1007,204"/>
<area shape="rect" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5" title=" " alt="" coords="809,252,1007,293"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#ab675b2b8862a2ba9c139a8b5b353b846" title="Get the TrackPos of the provided point along the linestring and the segment of the line string which ..." alt="" coords="1061,317,1207,359"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#ae0a06818149f7430fee80e295ef04548" title="Helper function to identify whether to select the preceeding or succeeding segment of a linstring poi..." alt="" coords="1255,317,1400,359"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_a12708b289f7f3d8f10c6dc749bf14d65_icgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_a12708b289f7f3d8f10c6dc749bf14d65_icgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_a12708b289f7f3d8f10c6dc749bf14d65_icgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_a12708b289f7f3d8f10c6dc749bf14d65_icgraph">
<area shape="rect" title="Create workzone geofence. Create diagonal lanelets and a lanelet that houses opposing lane&#39;s trafficl..." alt="" coords="781,5,992,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a5ae3f2086831ebd932e19b2bdfd76405" title="Creates a single workzone geofence (in the vector) that includes all additional lanelets (housing tra..." alt="" coords="523,5,733,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a649174a7a7270df95532cad5131bf4cb" title="Adds a geofence to the current map and publishes the ROS msg." alt="" coords="264,5,475,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a95cb7c60682d7b455a8624534ad94706" title="Constructor." alt="" coords="5,5,216,47"/>
</map>
</div>

</div>
</div>
<a id="a7269b37f5fcdbc502122c980fa814387" name="a7269b37f5fcdbc502122c980fa814387"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7269b37f5fcdbc502122c980fa814387">&#9670;&nbsp;</a></span>currentLocationCallback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void carma_wm_ctrl::WMBroadcaster::currentLocationCallback </td>
          <td>(</td>
          <td class="paramtype">geometry_msgs::msg::PoseStamped::UniquePtr&#160;</td>
          <td class="paramname"><em>current_pos</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8cpp_source.html#l01946">1946</a> of file <a class="el" href="WMBroadcaster_8cpp_source.html">WMBroadcaster.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1947</span>{</div>
<div class="line"><span class="lineno"> 1948</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a> &amp;&amp; <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;laneletLayer.size() != 0) {</div>
<div class="line"><span class="lineno"> 1949</span>    carma_perception_msgs::msg::CheckActiveGeofence check = <a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a7c4ca5d0774ffa2aa06fbf0f979b02b0">checkActiveGeofenceLogic</a>(*current_pos);</div>
<div class="line"><span class="lineno"> 1950</span>    <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#abd83bad51ddd9d019add9b8a7de697ae">active_pub_</a>(check);<span class="comment">//Publish</span></div>
<div class="line"><span class="lineno"> 1951</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1952</span>    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Could not check active geofence logic because map was not loaded&quot;</span>);</div>
<div class="line"><span class="lineno"> 1953</span>  }</div>
<div class="line"><span class="lineno"> 1954</span>}</div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_a7c4ca5d0774ffa2aa06fbf0f979b02b0"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a7c4ca5d0774ffa2aa06fbf0f979b02b0">carma_wm_ctrl::WMBroadcaster::checkActiveGeofenceLogic</a></div><div class="ttdeci">carma_perception_msgs::msg::CheckActiveGeofence checkActiveGeofenceLogic(const geometry_msgs::msg::PoseStamped &amp;current_pos)</div><div class="ttdoc">Returns a message indicating whether or not the vehicle is inside of an active geofence lanelet.</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8cpp_source.html#l02012">WMBroadcaster.cpp:2012</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMBroadcaster_8hpp_source.html#l00440">active_pub_</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l02012">checkActiveGeofenceLogic()</a>, and <a class="el" href="WMBroadcaster_8hpp_source.html#l00429">current_map_</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcasterNode_8cpp_source.html#l00153">carma_wm_ctrl::WMBroadcasterNode::handle_on_activate()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_a7269b37f5fcdbc502122c980fa814387_cgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_a7269b37f5fcdbc502122c980fa814387_cgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_a7269b37f5fcdbc502122c980fa814387_cgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_a7269b37f5fcdbc502122c980fa814387_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,216,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a7c4ca5d0774ffa2aa06fbf0f979b02b0" title="Returns a message indicating whether or not the vehicle is inside of an active geofence lanelet." alt="" coords="264,5,475,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a35a706cbbb3b04dc4dfc3eea40ececcc" title="Returns the route distance (downtrack or crosstrack in meters) to the nearest active geofence lanelet..." alt="" coords="523,5,733,47"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#aebce986f21c117983313292d5e82b50a" title="Returns the TrackPos, computed in 2d, of the provided point relative to the centerline of the provide..." alt="" coords="781,5,927,47"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#ab675b2b8862a2ba9c139a8b5b353b846" title="Get the TrackPos of the provided point along the linestring and the segment of the line string which ..." alt="" coords="975,5,1120,47"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#ae0a06818149f7430fee80e295ef04548" title="Helper function to identify whether to select the preceeding or succeeding segment of a linstring poi..." alt="" coords="1168,5,1313,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_a7269b37f5fcdbc502122c980fa814387_icgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_a7269b37f5fcdbc502122c980fa814387_icgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_a7269b37f5fcdbc502122c980fa814387_icgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_a7269b37f5fcdbc502122c980fa814387_icgraph">
<area shape="rect" title=" " alt="" coords="264,5,475,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcasterNode.html#ab0c14f6d7e30870755a4dcf6b228de82" title=" " alt="" coords="5,5,216,47"/>
</map>
</div>

</div>
</div>
<a id="a35a706cbbb3b04dc4dfc3eea40ececcc" name="a35a706cbbb3b04dc4dfc3eea40ececcc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35a706cbbb3b04dc4dfc3eea40ececcc">&#9670;&nbsp;</a></span>distToNearestActiveGeofence()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double carma_wm_ctrl::WMBroadcaster::distToNearestActiveGeofence </td>
          <td>(</td>
          <td class="paramtype">const lanelet::BasicPoint2d &amp;&#160;</td>
          <td class="paramname"><em>curr_pos</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the route distance (downtrack or crosstrack in meters) to the nearest active geofence lanelet. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">curr_pos</td><td>Current position in local coordinates </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">InvalidObjectStateError</td><td>if base_map is not set </td></tr>
    <tr><td class="paramname">std::invalid_argument</td><td>if curr_pos is not on the road </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if there is no active geofence on the vehicle's route </dd></dl>

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8cpp_source.html#l01868">1868</a> of file <a class="el" href="WMBroadcaster_8cpp_source.html">WMBroadcaster.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1869</span>{</div>
<div class="line"><span class="lineno"> 1870</span>  std::lock_guard&lt;std::mutex&gt; guard(<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a1ac51e0b0b57eda669c87372bd079ede">map_mutex_</a>);</div>
<div class="line"><span class="lineno"> 1871</span> </div>
<div class="line"><span class="lineno"> 1872</span>  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a> || <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;laneletLayer.size() == 0) </div>
<div class="line"><span class="lineno"> 1873</span>  {</div>
<div class="line"><span class="lineno"> 1874</span>    <span class="keywordflow">throw</span> lanelet::InvalidObjectStateError(std::string(<span class="stringliteral">&quot;Lanelet map (current_map_) is not loaded to the WMBroadcaster&quot;</span>));</div>
<div class="line"><span class="lineno"> 1875</span>  }</div>
<div class="line"><span class="lineno"> 1876</span> </div>
<div class="line"><span class="lineno"> 1877</span>  <span class="comment">// filter only the lanelets in the route</span></div>
<div class="line"><span class="lineno"> 1878</span>  std::vector&lt;lanelet::Id&gt; active_geofence_on_route;</div>
<div class="line"><span class="lineno"> 1879</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> llt : <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a60ad34ffaa6843dc3225a95e828c3df8">route_path_</a>)</div>
<div class="line"><span class="lineno"> 1880</span>  {</div>
<div class="line"><span class="lineno"> 1881</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a9f7ae45f954ed5f177756a56b9387545">active_geofence_llt_ids_</a>.find(llt.id()) != <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a9f7ae45f954ed5f177756a56b9387545">active_geofence_llt_ids_</a>.end()) </div>
<div class="line"><span class="lineno"> 1882</span>      active_geofence_on_route.push_back(llt.id());</div>
<div class="line"><span class="lineno"> 1883</span>  }</div>
<div class="line"><span class="lineno"> 1884</span>  <span class="comment">// Get the lanelet of this point</span></div>
<div class="line"><span class="lineno"> 1885</span>  <span class="keyword">auto</span> curr_lanelet = lanelet::geometry::findNearest(<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;laneletLayer, curr_pos, 1)[0].second;</div>
<div class="line"><span class="lineno"> 1886</span> </div>
<div class="line"><span class="lineno"> 1887</span>  <span class="comment">// Check if this point at least is actually within this lanelets</span></div>
<div class="line"><span class="lineno"> 1888</span>  <span class="keywordflow">if</span> (!boost::geometry::within(curr_pos, curr_lanelet.polygon2d().basicPolygon()))</div>
<div class="line"><span class="lineno"> 1889</span>    <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;Given point is not within any lanelet&quot;</span>);</div>
<div class="line"><span class="lineno"> 1890</span> </div>
<div class="line"><span class="lineno"> 1891</span>  <span class="comment">// get route distance (downtrack + cross_track) distances to every lanelets by their ids</span></div>
<div class="line"><span class="lineno"> 1892</span>  std::vector&lt;double&gt; route_distances;</div>
<div class="line"><span class="lineno"> 1893</span>  <span class="comment">// and take abs of cross_track to add them to get route distance</span></div>
<div class="line"><span class="lineno"> 1894</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keywordtype">id</span>: active_geofence_on_route)</div>
<div class="line"><span class="lineno"> 1895</span>  {</div>
<div class="line"><span class="lineno"> 1896</span>    <a class="code hl_class" href="classcarma__wm_1_1TrackPos.html">carma_wm::TrackPos</a> tp = <a class="code hl_function" href="namespacecarma__wm_1_1geometry.html#aebce986f21c117983313292d5e82b50a">carma_wm::geometry::trackPos</a>(<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;laneletLayer.get(<span class="keywordtype">id</span>), curr_pos);</div>
<div class="line"><span class="lineno"> 1897</span>    <span class="comment">// downtrack needs to be negative for lanelet to be in front of the point, </span></div>
<div class="line"><span class="lineno"> 1898</span>    <span class="comment">// also we don&#39;t account for the lanelet that the vehicle is on</span></div>
<div class="line"><span class="lineno"> 1899</span>    <span class="keywordflow">if</span> (tp.<a class="code hl_variable" href="classcarma__wm_1_1TrackPos.html#a6ea99bbb9c6a75685ceaaf370d58ea24">downtrack</a> &lt; 0 &amp;&amp; <span class="keywordtype">id</span> != curr_lanelet.id())</div>
<div class="line"><span class="lineno"> 1900</span>    {</div>
<div class="line"><span class="lineno"> 1901</span>      <span class="keywordtype">double</span> dist = fabs(tp.<a class="code hl_variable" href="classcarma__wm_1_1TrackPos.html#a6ea99bbb9c6a75685ceaaf370d58ea24">downtrack</a>) + fabs(tp.<a class="code hl_variable" href="classcarma__wm_1_1TrackPos.html#a60c766fa11f68e1d8832d79cd2d292c2">crosstrack</a>);</div>
<div class="line"><span class="lineno"> 1902</span>      route_distances.push_back(dist);</div>
<div class="line"><span class="lineno"> 1903</span>    }</div>
<div class="line"><span class="lineno"> 1904</span>  }</div>
<div class="line"><span class="lineno"> 1905</span>  std::sort(route_distances.begin(), route_distances.end());</div>
<div class="line"><span class="lineno"> 1906</span> </div>
<div class="line"><span class="lineno"> 1907</span>  <span class="keywordflow">if</span> (route_distances.size() != 0 ) <span class="keywordflow">return</span> route_distances[0];</div>
<div class="line"><span class="lineno"> 1908</span>  <span class="keywordflow">else</span> <span class="keywordflow">return</span> 0.0;</div>
<div class="line"><span class="lineno"> 1909</span> </div>
<div class="line"><span class="lineno"> 1910</span>}</div>
<div class="ttc" id="aclasscarma__wm_1_1TrackPos_html"><div class="ttname"><a href="classcarma__wm_1_1TrackPos.html">carma_wm::TrackPos</a></div><div class="ttdoc">Position in a track based coordinate system where the axis are downtrack and crosstrack....</div><div class="ttdef"><b>Definition:</b> <a href="TrackPos_8hpp_source.html#l00034">TrackPos.hpp:35</a></div></div>
<div class="ttc" id="aclasscarma__wm_1_1TrackPos_html_a60c766fa11f68e1d8832d79cd2d292c2"><div class="ttname"><a href="classcarma__wm_1_1TrackPos.html#a60c766fa11f68e1d8832d79cd2d292c2">carma_wm::TrackPos::crosstrack</a></div><div class="ttdeci">double crosstrack</div><div class="ttdef"><b>Definition:</b> <a href="TrackPos_8hpp_source.html#l00038">TrackPos.hpp:38</a></div></div>
<div class="ttc" id="aclasscarma__wm_1_1TrackPos_html_a6ea99bbb9c6a75685ceaaf370d58ea24"><div class="ttname"><a href="classcarma__wm_1_1TrackPos.html#a6ea99bbb9c6a75685ceaaf370d58ea24">carma_wm::TrackPos::downtrack</a></div><div class="ttdeci">double downtrack</div><div class="ttdef"><b>Definition:</b> <a href="TrackPos_8hpp_source.html#l00037">TrackPos.hpp:37</a></div></div>
<div class="ttc" id="anamespacecarma__wm_1_1geometry_html_aebce986f21c117983313292d5e82b50a"><div class="ttname"><a href="namespacecarma__wm_1_1geometry.html#aebce986f21c117983313292d5e82b50a">carma_wm::geometry::trackPos</a></div><div class="ttdeci">TrackPos trackPos(const lanelet::ConstLanelet &amp;lanelet, const lanelet::BasicPoint2d &amp;point)</div><div class="ttdoc">Returns the TrackPos, computed in 2d, of the provided point relative to the centerline of the provide...</div><div class="ttdef"><b>Definition:</b> <a href="Geometry_8cpp_source.html#l00120">Geometry.cpp:120</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMBroadcaster_8hpp_source.html#l00411">active_geofence_llt_ids_</a>, <a class="el" href="TrackPos_8hpp_source.html#l00038">carma_wm::TrackPos::crosstrack</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00429">current_map_</a>, <a class="el" href="TrackPos_8hpp_source.html#l00037">carma_wm::TrackPos::downtrack</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00436">map_mutex_</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00410">route_path_</a>, and <a class="el" href="Geometry_8cpp_source.html#l00120">carma_wm::geometry::trackPos()</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l02012">checkActiveGeofenceLogic()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_a35a706cbbb3b04dc4dfc3eea40ececcc_cgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_a35a706cbbb3b04dc4dfc3eea40ececcc_cgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_a35a706cbbb3b04dc4dfc3eea40ececcc_cgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_a35a706cbbb3b04dc4dfc3eea40ececcc_cgraph">
<area shape="rect" title="Returns the route distance (downtrack or crosstrack in meters) to the nearest active geofence lanelet..." alt="" coords="5,5,216,47"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#aebce986f21c117983313292d5e82b50a" title="Returns the TrackPos, computed in 2d, of the provided point relative to the centerline of the provide..." alt="" coords="264,5,409,47"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#ab675b2b8862a2ba9c139a8b5b353b846" title="Get the TrackPos of the provided point along the linestring and the segment of the line string which ..." alt="" coords="457,5,603,47"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#ae0a06818149f7430fee80e295ef04548" title="Helper function to identify whether to select the preceeding or succeeding segment of a linstring poi..." alt="" coords="651,5,796,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_a35a706cbbb3b04dc4dfc3eea40ececcc_icgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_a35a706cbbb3b04dc4dfc3eea40ececcc_icgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_a35a706cbbb3b04dc4dfc3eea40ececcc_icgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_a35a706cbbb3b04dc4dfc3eea40ececcc_icgraph">
<area shape="rect" title="Returns the route distance (downtrack or crosstrack in meters) to the nearest active geofence lanelet..." alt="" coords="781,5,992,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a7c4ca5d0774ffa2aa06fbf0f979b02b0" title="Returns a message indicating whether or not the vehicle is inside of an active geofence lanelet." alt="" coords="523,5,733,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a7269b37f5fcdbc502122c980fa814387" title=" " alt="" coords="264,5,475,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcasterNode.html#ab0c14f6d7e30870755a4dcf6b228de82" title=" " alt="" coords="5,5,216,47"/>
</map>
</div>

</div>
</div>
<a id="a9d4ee6959ff334d9f4f16864e5bd0cfe" name="a9d4ee6959ff334d9f4f16864e5bd0cfe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d4ee6959ff334d9f4f16864e5bd0cfe">&#9670;&nbsp;</a></span>externalMapMsgCallback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void carma_wm_ctrl::WMBroadcaster::externalMapMsgCallback </td>
          <td>(</td>
          <td class="paramtype">carma_v2x_msgs::msg::MapData::UniquePtr&#160;</td>
          <td class="paramname"><em>map_msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Callback to MAP.msg which contains intersections' static info such geometry and lane ids. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">map_msg</td><td>The ROS msg of the MAP.msg to process </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8cpp_source.html#l01030">1030</a> of file <a class="el" href="WMBroadcaster_8cpp_source.html">WMBroadcaster.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1031</span>{</div>
<div class="line"><span class="lineno"> 1032</span>  <span class="keyword">auto</span> gf_ptr = std::make_shared&lt;Geofence&gt;();</div>
<div class="line"><span class="lineno"> 1033</span> </div>
<div class="line"><span class="lineno"> 1034</span>  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a> || <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;laneletLayer.size() == 0)</div>
<div class="line"><span class="lineno"> 1035</span>  {</div>
<div class="line"><span class="lineno"> 1036</span>    RCLCPP_INFO_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Map is not available yet. Skipping MAP msg&quot;</span>);</div>
<div class="line"><span class="lineno"> 1037</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1038</span>  }</div>
<div class="line"><span class="lineno"> 1039</span> </div>
<div class="line"><span class="lineno"> 1040</span>  <span class="comment">// check if we have seen this message already</span></div>
<div class="line"><span class="lineno"> 1041</span>  <span class="keywordtype">bool</span> up_to_date = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1042</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aa26bb2f41f25b523fd2a98010af60cb0">sim_</a>-&gt;intersection_id_to_regem_id_.size() == map_msg-&gt;intersections.size())</div>
<div class="line"><span class="lineno"> 1043</span>  {</div>
<div class="line"><span class="lineno"> 1044</span>    up_to_date = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1045</span>    <span class="comment">// check id of the intersection only</span></div>
<div class="line"><span class="lineno"> 1046</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> intersection : map_msg-&gt;intersections)</div>
<div class="line"><span class="lineno"> 1047</span>    {</div>
<div class="line"><span class="lineno"> 1048</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aa26bb2f41f25b523fd2a98010af60cb0">sim_</a>-&gt;intersection_id_to_regem_id_.find(intersection.id.id) == <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aa26bb2f41f25b523fd2a98010af60cb0">sim_</a>-&gt;intersection_id_to_regem_id_.end())</div>
<div class="line"><span class="lineno"> 1049</span>      {</div>
<div class="line"><span class="lineno"> 1050</span>        up_to_date = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1051</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1052</span>      }</div>
<div class="line"><span class="lineno"> 1053</span>    }</div>
<div class="line"><span class="lineno"> 1054</span>  }</div>
<div class="line"><span class="lineno"> 1055</span> </div>
<div class="line"><span class="lineno"> 1056</span>  <span class="keywordflow">if</span>(up_to_date)</div>
<div class="line"><span class="lineno"> 1057</span>  {</div>
<div class="line"><span class="lineno"> 1058</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1059</span>  }</div>
<div class="line"><span class="lineno"> 1060</span>    </div>
<div class="line"><span class="lineno"> 1061</span>  gf_ptr-&gt;map_msg_ = *map_msg;</div>
<div class="line"><span class="lineno"> 1062</span>  gf_ptr-&gt;msg_.package.label_exists = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1063</span>  gf_ptr-&gt;msg_.package.label = <span class="stringliteral">&quot;MAP_MSG&quot;</span>;</div>
<div class="line"><span class="lineno"> 1064</span>  gf_ptr-&gt;id_ = boost::uuids::random_generator()(); </div>
<div class="line"><span class="lineno"> 1065</span> </div>
<div class="line"><span class="lineno"> 1066</span>  <span class="comment">// create dummy traffic Control message to add instant activation schedule</span></div>
<div class="line"><span class="lineno"> 1067</span>  carma_v2x_msgs::msg::TrafficControlMessageV01 traffic_control_msg;</div>
<div class="line"><span class="lineno"> 1068</span> </div>
<div class="line"><span class="lineno"> 1069</span>  <span class="comment">// process schedule from message</span></div>
<div class="line"><span class="lineno"> 1070</span>  <a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#abea25fd0b879387b68454225ebb0ebc6">addScheduleFromMsg</a>(gf_ptr, traffic_control_msg);</div>
<div class="line"><span class="lineno"> 1071</span>  </div>
<div class="line"><span class="lineno"> 1072</span>  <a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ab6bfd98359ff2f28688bf7503b43a336">scheduleGeofence</a>(gf_ptr);</div>
<div class="line"><span class="lineno"> 1073</span> </div>
<div class="line"><span class="lineno"> 1074</span>}</div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_ab6bfd98359ff2f28688bf7503b43a336"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ab6bfd98359ff2f28688bf7503b43a336">carma_wm_ctrl::WMBroadcaster::scheduleGeofence</a></div><div class="ttdeci">void scheduleGeofence(std::shared_ptr&lt; carma_wm_ctrl::Geofence &gt; gf_ptr_list)</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8cpp_source.html#l01137">WMBroadcaster.cpp:1137</a></div></div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_abea25fd0b879387b68454225ebb0ebc6"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#abea25fd0b879387b68454225ebb0ebc6">carma_wm_ctrl::WMBroadcaster::addScheduleFromMsg</a></div><div class="ttdeci">void addScheduleFromMsg(std::shared_ptr&lt; Geofence &gt; gf_ptr, const carma_v2x_msgs::msg::TrafficControlMessageV01 &amp;msg_v01)</div><div class="ttdoc">Populates the schedules member of the geofence object from given TrafficControlMessageV01 message.</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8cpp_source.html#l00117">WMBroadcaster.cpp:117</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMBroadcaster_8cpp_source.html#l00117">addScheduleFromMsg()</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00429">current_map_</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l01137">scheduleGeofence()</a>, and <a class="el" href="WMBroadcaster_8hpp_source.html#l00463">sim_</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcasterNode_8cpp_source.html#l00153">carma_wm_ctrl::WMBroadcasterNode::handle_on_activate()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_a9d4ee6959ff334d9f4f16864e5bd0cfe_cgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_a9d4ee6959ff334d9f4f16864e5bd0cfe_cgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_a9d4ee6959ff334d9f4f16864e5bd0cfe_cgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_a9d4ee6959ff334d9f4f16864e5bd0cfe_cgraph">
<area shape="rect" title="Callback to MAP.msg which contains intersections&#39; static info such geometry and lane ids." alt="" coords="5,128,216,169"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#abea25fd0b879387b68454225ebb0ebc6" title="Populates the schedules member of the geofence object from given TrafficControlMessageV01 message." alt="" coords="264,95,475,136"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ab6bfd98359ff2f28688bf7503b43a336" title=" " alt="" coords="264,160,475,201"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1GeofenceScheduler.html#a2fecf322a302aff00ce8d76b0965e02e" title="Get the clock type of the clock being created by the timer factory." alt="" coords="523,5,753,47"/>
<area shape="rect" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5" title=" " alt="" coords="539,95,737,136"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1GeofenceScheduler.html#aa6e1c118ed8765ca03a7e52518c6e007" title="Add a geofence to the scheduler. This will cause it to trigger an event when it becomes active or goe..." alt="" coords="523,160,753,201"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1GeofenceScheduler.html#a9072b770cf240953a50f1d926b733b7c" title="Generates the next id to be used for a timer." alt="" coords="1359,156,1589,197"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1GeofenceScheduler.html#a8e993e68cb77c8c77b81dc8dfba2bc1e" title="The callback which is triggered when a geofence becomes active This will call the user set active_cal..." alt="" coords="801,189,1032,231"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1GeofenceScheduler.html#a0f58b227dcbd413eb451146d36cb1728" title="The callback which is triggered when a geofence becomes in&#45;active This will call the user set inactiv..." alt="" coords="1080,215,1311,256"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_a9d4ee6959ff334d9f4f16864e5bd0cfe_icgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_a9d4ee6959ff334d9f4f16864e5bd0cfe_icgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_a9d4ee6959ff334d9f4f16864e5bd0cfe_icgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_a9d4ee6959ff334d9f4f16864e5bd0cfe_icgraph">
<area shape="rect" title="Callback to MAP.msg which contains intersections&#39; static info such geometry and lane ids." alt="" coords="264,5,475,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcasterNode.html#ab0c14f6d7e30870755a4dcf6b228de82" title=" " alt="" coords="5,5,216,47"/>
</map>
</div>

</div>
</div>
<a id="a67e0f46f02797b84730f04cdcb045568" name="a67e0f46f02797b84730f04cdcb045568"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67e0f46f02797b84730f04cdcb045568">&#9670;&nbsp;</a></span>filterSuccessorLanelets()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unordered_set&lt; lanelet::Lanelet &gt; carma_wm_ctrl::WMBroadcaster::filterSuccessorLanelets </td>
          <td>(</td>
          <td class="paramtype">const std::unordered_set&lt; lanelet::Lanelet &gt; &amp;&#160;</td>
          <td class="paramname"><em>possible_lanelets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::unordered_set&lt; lanelet::Lanelet &gt; &amp;&#160;</td>
          <td class="paramname"><em>root_lanelets</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="adfb94b051e74a67830c1795e32081cbc" name="adfb94b051e74a67830c1795e32081cbc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adfb94b051e74a67830c1795e32081cbc">&#9670;&nbsp;</a></span>generate32BitId()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t carma_wm_ctrl::WMBroadcaster::generate32BitId </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>label</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>helper for generating 32bit traffic light Id from TCM label field consisting workzone intersection/signal group ids </p>

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8cpp_source.html#l01252">1252</a> of file <a class="el" href="WMBroadcaster_8cpp_source.html">WMBroadcaster.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1253</span>{</div>
<div class="line"><span class="lineno"> 1254</span>  <span class="keyword">auto</span> pos1 = label.find(<span class="stringliteral">&quot;INT_ID:&quot;</span>) + 7;</div>
<div class="line"><span class="lineno"> 1255</span>  <span class="keyword">auto</span> pos2 = label.find(<span class="stringliteral">&quot;SG_ID:&quot;</span>) + 6;</div>
<div class="line"><span class="lineno"> 1256</span>  </div>
<div class="line"><span class="lineno"> 1257</span>  uint16_t intersection_id = std::stoi(label.substr(pos1 , 4));</div>
<div class="line"><span class="lineno"> 1258</span>  uint8_t signal_id = std::stoi(label.substr(pos2 , 3));</div>
<div class="line"><span class="lineno"> 1259</span> </div>
<div class="line"><span class="lineno"> 1260</span>  <span class="keywordflow">return</span> <a class="code hl_function" href="namespacecarma__wm_1_1utils.html#a5f9cfb53df6903542a0cb9bf2f8a7d7c">carma_wm::utils::get32BitId</a>(intersection_id, signal_id);</div>
<div class="line"><span class="lineno"> 1261</span>}</div>
<div class="ttc" id="anamespacecarma__wm_1_1utils_html_a5f9cfb53df6903542a0cb9bf2f8a7d7c"><div class="ttname"><a href="namespacecarma__wm_1_1utils.html#a5f9cfb53df6903542a0cb9bf2f8a7d7c">carma_wm::utils::get32BitId</a></div><div class="ttdeci">uint32_t get32BitId(uint16_t intersection_id, uint8_t signal_group_id)</div><div class="ttdoc">Get 32bit id by concatenating 16bit id with 8bit signal_group_id.</div><div class="ttdef"><b>Definition:</b> <a href="WorldModelUtils_8cpp_source.html#l00302">WorldModelUtils.cpp:302</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WorldModelUtils_8cpp_source.html#l00302">carma_wm::utils::get32BitId()</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l00420">createWorkzoneGeometry()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_adfb94b051e74a67830c1795e32081cbc_cgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_adfb94b051e74a67830c1795e32081cbc_cgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_adfb94b051e74a67830c1795e32081cbc_cgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_adfb94b051e74a67830c1795e32081cbc_cgraph">
<area shape="rect" title="helper for generating 32bit traffic light Id from TCM label field consisting workzone intersection/si..." alt="" coords="5,5,216,47"/>
<area shape="rect" href="namespacecarma__wm_1_1utils.html#a5f9cfb53df6903542a0cb9bf2f8a7d7c" title="Get 32bit id by concatenating 16bit id with 8bit signal_group_id." alt="" coords="264,13,445,39"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_adfb94b051e74a67830c1795e32081cbc_icgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_adfb94b051e74a67830c1795e32081cbc_icgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_adfb94b051e74a67830c1795e32081cbc_icgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_adfb94b051e74a67830c1795e32081cbc_icgraph">
<area shape="rect" title="helper for generating 32bit traffic light Id from TCM label field consisting workzone intersection/si..." alt="" coords="1040,5,1251,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a12708b289f7f3d8f10c6dc749bf14d65" title="Create workzone geofence. Create diagonal lanelets and a lanelet that houses opposing lane&#39;s trafficl..." alt="" coords="781,5,992,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a5ae3f2086831ebd932e19b2bdfd76405" title="Creates a single workzone geofence (in the vector) that includes all additional lanelets (housing tra..." alt="" coords="523,5,733,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a649174a7a7270df95532cad5131bf4cb" title="Adds a geofence to the current map and publishes the ROS msg." alt="" coords="264,5,475,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a95cb7c60682d7b455a8624534ad94706" title="Constructor." alt="" coords="5,5,216,47"/>
</map>
</div>

</div>
</div>
<a id="a63a919c2cf6736a80fa29a706b020330" name="a63a919c2cf6736a80fa29a706b020330"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63a919c2cf6736a80fa29a706b020330">&#9670;&nbsp;</a></span>geofenceCallback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void carma_wm_ctrl::WMBroadcaster::geofenceCallback </td>
          <td>(</td>
          <td class="paramtype">carma_v2x_msgs::msg::TrafficControlMessage::UniquePtr&#160;</td>
          <td class="paramname"><em>geofence_msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Callback to add a geofence to the map. Currently only supports version 1 TrafficControlMessage. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">geofence_msg</td><td>The ROS msg of the geofence to add. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8cpp_source.html#l01077">1077</a> of file <a class="el" href="WMBroadcaster_8cpp_source.html">WMBroadcaster.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1078</span>{</div>
<div class="line"><span class="lineno"> 1079</span>  </div>
<div class="line"><span class="lineno"> 1080</span>  std::lock_guard&lt;std::mutex&gt; guard(<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a1ac51e0b0b57eda669c87372bd079ede">map_mutex_</a>);</div>
<div class="line"><span class="lineno"> 1081</span>  std::stringstream reason_ss;</div>
<div class="line"><span class="lineno"> 1082</span>  <span class="comment">// quickly check if the id has been added</span></div>
<div class="line"><span class="lineno"> 1083</span>  <span class="keywordflow">if</span> (geofence_msg-&gt;choice != carma_v2x_msgs::msg::TrafficControlMessage::TCMV01) {</div>
<div class="line"><span class="lineno"> 1084</span>    reason_ss &lt;&lt; <span class="stringliteral">&quot;Dropping received geofence for unsupported TrafficControl version: &quot;</span> &lt;&lt; geofence_msg-&gt;choice;</div>
<div class="line"><span class="lineno"> 1085</span>    RCLCPP_WARN_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), reason_ss.str());</div>
<div class="line"><span class="lineno"> 1086</span>    <a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#acc8891ed0c1949e44412537e7c904f4c">pubTCMACK</a>(geofence_msg-&gt;tcm_v01.reqid, geofence_msg-&gt;tcm_v01.msgnum, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_enumvalue" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a4f20a8fa387e6ae0d4db62b8f3207efea9cc8ad3d99798c6726d4af0bd14e49d2">AcknowledgementStatus::REJECTED</a>), reason_ss.str());</div>
<div class="line"><span class="lineno"> 1087</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1088</span>  }</div>
<div class="line"><span class="lineno"> 1089</span> </div>
<div class="line"><span class="lineno"> 1090</span>  boost::uuids::uuid id;</div>
<div class="line"><span class="lineno"> 1091</span>  std::copy(geofence_msg-&gt;tcm_v01.id.id.begin(), geofence_msg-&gt;tcm_v01.id.id.end(), <span class="keywordtype">id</span>.begin());</div>
<div class="line"><span class="lineno"> 1092</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#af032eaea663f829c386e54bef319b09c">checked_geofence_ids_</a>.find(<a class="code hl_function" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5">boost::uuids::to_string</a>(<span class="keywordtype">id</span>)) != <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#af032eaea663f829c386e54bef319b09c">checked_geofence_ids_</a>.end()) { </div>
<div class="line"><span class="lineno"> 1093</span>    reason_ss.str(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno"> 1094</span>    reason_ss &lt;&lt; <span class="stringliteral">&quot;Dropping received TrafficControl message with already handled id: &quot;</span> &lt;&lt; <a class="code hl_function" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5">boost::uuids::to_string</a>(<span class="keywordtype">id</span>);</div>
<div class="line"><span class="lineno"> 1095</span>    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), reason_ss.str());</div>
<div class="line"><span class="lineno"> 1096</span>    <a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#acc8891ed0c1949e44412537e7c904f4c">pubTCMACK</a>(geofence_msg-&gt;tcm_v01.reqid, geofence_msg-&gt;tcm_v01.msgnum, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_enumvalue" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a4f20a8fa387e6ae0d4db62b8f3207efea7e83ae21b9e9b168f12ba5a90ee82c94">AcknowledgementStatus::ACKNOWLEDGED</a>), reason_ss.str());</div>
<div class="line"><span class="lineno"> 1097</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1098</span>  }</div>
<div class="line"><span class="lineno"> 1099</span> </div>
<div class="line"><span class="lineno"> 1100</span>  <span class="comment">// convert reqid to string check if it has been seen before</span></div>
<div class="line"><span class="lineno"> 1101</span>  boost::array&lt;uint8_t, 16UL&gt; req_id;</div>
<div class="line"><span class="lineno"> 1102</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> = 0; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> &lt; 8; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> ++) req_id[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>] = geofence_msg-&gt;tcm_v01.reqid.id[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>];</div>
<div class="line"><span class="lineno"> 1103</span>  boost::uuids::uuid uuid_id;</div>
<div class="line"><span class="lineno"> 1104</span>  std::copy(req_id.begin(),req_id.end(), uuid_id.begin());</div>
<div class="line"><span class="lineno"> 1105</span>  std::string reqid = <a class="code hl_function" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5">boost::uuids::to_string</a>(uuid_id).substr(0, 8);</div>
<div class="line"><span class="lineno"> 1106</span>  <span class="comment">// drop if the req has never been sent</span></div>
<div class="line"><span class="lineno"> 1107</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ae21047d8e9e8273c80ae80c4749feee0">generated_geofence_reqids_</a>.find(reqid) == <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ae21047d8e9e8273c80ae80c4749feee0">generated_geofence_reqids_</a>.end() &amp;&amp; reqid.compare(<span class="stringliteral">&quot;00000000&quot;</span>) != 0)</div>
<div class="line"><span class="lineno"> 1108</span>  {</div>
<div class="line"><span class="lineno"> 1109</span>    RCLCPP_WARN_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;CARMA_WM_CTRL received a TrafficControlMessage with unknown TrafficControlRequest ID (reqid): &quot;</span> &lt;&lt; reqid);</div>
<div class="line"><span class="lineno"> 1110</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1111</span>  }</div>
<div class="line"><span class="lineno"> 1112</span>    </div>
<div class="line"><span class="lineno"> 1113</span>  <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#af032eaea663f829c386e54bef319b09c">checked_geofence_ids_</a>.insert(<a class="code hl_function" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5">boost::uuids::to_string</a>(<span class="keywordtype">id</span>));</div>
<div class="line"><span class="lineno"> 1114</span> </div>
<div class="line"><span class="lineno"> 1115</span>  <span class="keyword">auto</span> gf_ptr = std::make_shared&lt;Geofence&gt;();</div>
<div class="line"><span class="lineno"> 1116</span> </div>
<div class="line"><span class="lineno"> 1117</span>  gf_ptr-&gt;msg_ = geofence_msg-&gt;tcm_v01;</div>
<div class="line"><span class="lineno"> 1118</span> </div>
<div class="line"><span class="lineno"> 1119</span>  <span class="keywordflow">try</span></div>
<div class="line"><span class="lineno"> 1120</span>  {</div>
<div class="line"><span class="lineno"> 1121</span>    <span class="comment">// process schedule from message</span></div>
<div class="line"><span class="lineno"> 1122</span>    <a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#abea25fd0b879387b68454225ebb0ebc6">addScheduleFromMsg</a>(gf_ptr, geofence_msg-&gt;tcm_v01);    </div>
<div class="line"><span class="lineno"> 1123</span>    <a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ab6bfd98359ff2f28688bf7503b43a336">scheduleGeofence</a>(gf_ptr);</div>
<div class="line"><span class="lineno"> 1124</span>    reason_ss.str(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno"> 1125</span>    reason_ss &lt;&lt; <span class="stringliteral">&quot;Successfully processed TCM.&quot;</span>;</div>
<div class="line"><span class="lineno"> 1126</span>    <a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#acc8891ed0c1949e44412537e7c904f4c">pubTCMACK</a>(geofence_msg-&gt;tcm_v01.reqid, geofence_msg-&gt;tcm_v01.msgnum, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_enumvalue" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a4f20a8fa387e6ae0d4db62b8f3207efea7e83ae21b9e9b168f12ba5a90ee82c94">AcknowledgementStatus::ACKNOWLEDGED</a>), reason_ss.str());</div>
<div class="line"><span class="lineno"> 1127</span>  }</div>
<div class="line"><span class="lineno"> 1128</span>  <span class="keywordflow">catch</span>(std::exception&amp; ex)</div>
<div class="line"><span class="lineno"> 1129</span>  {</div>
<div class="line"><span class="lineno"> 1130</span>    reason_ss.str(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno"> 1131</span>    reason_ss &lt;&lt; <span class="stringliteral">&quot;Failed to process TCM. &quot;</span> &lt;&lt; ex.what();</div>
<div class="line"><span class="lineno"> 1132</span>    <a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#acc8891ed0c1949e44412537e7c904f4c">pubTCMACK</a>(geofence_msg-&gt;tcm_v01.reqid, geofence_msg-&gt;tcm_v01.msgnum, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_enumvalue" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a4f20a8fa387e6ae0d4db62b8f3207efea9cc8ad3d99798c6726d4af0bd14e49d2">AcknowledgementStatus::REJECTED</a>), reason_ss.str());</div>
<div class="line"><span class="lineno"> 1133</span>    <span class="keywordflow">throw</span>; <span class="comment">//rethrows the exception object</span></div>
<div class="line"><span class="lineno"> 1134</span>  }</div>
<div class="line"><span class="lineno"> 1135</span>};</div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_a4f20a8fa387e6ae0d4db62b8f3207efea7e83ae21b9e9b168f12ba5a90ee82c94"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a4f20a8fa387e6ae0d4db62b8f3207efea7e83ae21b9e9b168f12ba5a90ee82c94">carma_wm_ctrl::WMBroadcaster::AcknowledgementStatus::ACKNOWLEDGED</a></div><div class="ttdeci">@ ACKNOWLEDGED</div></div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_a4f20a8fa387e6ae0d4db62b8f3207efea9cc8ad3d99798c6726d4af0bd14e49d2"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a4f20a8fa387e6ae0d4db62b8f3207efea9cc8ad3d99798c6726d4af0bd14e49d2">carma_wm_ctrl::WMBroadcaster::AcknowledgementStatus::REJECTED</a></div><div class="ttdeci">@ REJECTED</div></div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_acc8891ed0c1949e44412537e7c904f4c"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#acc8891ed0c1949e44412537e7c904f4c">carma_wm_ctrl::WMBroadcaster::pubTCMACK</a></div><div class="ttdeci">void pubTCMACK(j2735_v2x_msgs::msg::Id64b tcm_req_id, uint16_t msgnum, int ack_status, const std::string &amp;ack_reason)</div><div class="ttdoc">Construct TCM acknowledgement object and populate it with params. Publish the object for a configured...</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8cpp_source.html#l02262">WMBroadcaster.cpp:2262</a></div></div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_af032eaea663f829c386e54bef319b09c"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#af032eaea663f829c386e54bef319b09c">carma_wm_ctrl::WMBroadcaster::checked_geofence_ids_</a></div><div class="ttdeci">std::unordered_set&lt; std::string &gt; checked_geofence_ids_</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8hpp_source.html#l00433">WMBroadcaster.hpp:433</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a4f20a8fa387e6ae0d4db62b8f3207efea7e83ae21b9e9b168f12ba5a90ee82c94">ACKNOWLEDGED</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l00117">addScheduleFromMsg()</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00433">checked_geofence_ids_</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00434">generated_geofence_reqids_</a>, <a class="el" href="process__bag_8py_source.html#l00059">process_bag::i</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00436">map_mutex_</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l02262">pubTCMACK()</a>, <a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a4f20a8fa387e6ae0d4db62b8f3207efea9cc8ad3d99798c6726d4af0bd14e49d2">REJECTED</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l01137">scheduleGeofence()</a>, and <a class="el" href="utm__zone_8cpp_source.html#l00021">carma_cooperative_perception::to_string()</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcasterNode_8cpp_source.html#l00153">carma_wm_ctrl::WMBroadcasterNode::handle_on_activate()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_a63a919c2cf6736a80fa29a706b020330_cgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_a63a919c2cf6736a80fa29a706b020330_cgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_a63a919c2cf6736a80fa29a706b020330_cgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_a63a919c2cf6736a80fa29a706b020330_cgraph">
<area shape="rect" title="Callback to add a geofence to the map. Currently only supports version 1 TrafficControlMessage." alt="" coords="5,124,216,165"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#abea25fd0b879387b68454225ebb0ebc6" title="Populates the schedules member of the geofence object from given TrafficControlMessageV01 message." alt="" coords="264,36,475,77"/>
<area shape="rect" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5" title=" " alt="" coords="554,95,753,136"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#acc8891ed0c1949e44412537e7c904f4c" title="Construct TCM acknowledgement object and populate it with params. Publish the object for a configured..." alt="" coords="264,153,475,195"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ab6bfd98359ff2f28688bf7503b43a336" title=" " alt="" coords="264,219,475,260"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1GeofenceScheduler.html#a2fecf322a302aff00ce8d76b0965e02e" title="Get the clock type of the clock being created by the timer factory." alt="" coords="538,5,769,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1GeofenceScheduler.html#a645ff72ccf3e3b7f6a529debf7a172a2" title="Get current time used by scheduler." alt="" coords="523,161,784,187"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1GeofenceScheduler.html#aa6e1c118ed8765ca03a7e52518c6e007" title="Add a geofence to the scheduler. This will cause it to trigger an event when it becomes active or goe..." alt="" coords="538,219,769,260"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1GeofenceScheduler.html#a9072b770cf240953a50f1d926b733b7c" title="Generates the next id to be used for a timer." alt="" coords="1389,215,1620,256"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1GeofenceScheduler.html#a8e993e68cb77c8c77b81dc8dfba2bc1e" title="The callback which is triggered when a geofence becomes active This will call the user set active_cal..." alt="" coords="832,248,1063,289"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1GeofenceScheduler.html#a0f58b227dcbd413eb451146d36cb1728" title="The callback which is triggered when a geofence becomes in&#45;active This will call the user set inactiv..." alt="" coords="1111,273,1341,315"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_a63a919c2cf6736a80fa29a706b020330_icgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_a63a919c2cf6736a80fa29a706b020330_icgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_a63a919c2cf6736a80fa29a706b020330_icgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_a63a919c2cf6736a80fa29a706b020330_icgraph">
<area shape="rect" title="Callback to add a geofence to the map. Currently only supports version 1 TrafficControlMessage." alt="" coords="264,5,475,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcasterNode.html#ab0c14f6d7e30870755a4dcf6b228de82" title=" " alt="" coords="5,5,216,47"/>
</map>
</div>

</div>
</div>
<a id="aac72e7333f997bfe19547a235f389c07" name="aac72e7333f997bfe19547a235f389c07"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac72e7333f997bfe19547a235f389c07">&#9670;&nbsp;</a></span>geofenceFromMapMsg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::shared_ptr&lt; <a class="el" href="classcarma__wm__ctrl_1_1Geofence.html">Geofence</a> &gt; &gt; carma_wm_ctrl::WMBroadcaster::geofenceFromMapMsg </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classcarma__wm__ctrl_1_1Geofence.html">Geofence</a> &gt;&#160;</td>
          <td class="paramname"><em>gf_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const carma_v2x_msgs::msg::MapData &amp;&#160;</td>
          <td class="paramname"><em>map_msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fills geofence object from MAP Data ROS Msg which contains intersections' static data such as geometry and signal_group. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname"><a class="el" href="classcarma__wm__ctrl_1_1Geofence.html" title="An object representing a geofence use for communications with CARMA Cloud.">Geofence</a></td><td>object to fill with information extracted from this msg </td></tr>
    <tr><td class="paramname">geofence_msg</td><td>The MAP ROS msg that contains intersection information </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">InvalidObjectStateError</td><td>if base_map is not set or the base_map's georeference is empty </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8cpp_source.html#l00217">217</a> of file <a class="el" href="WMBroadcaster_8cpp_source.html">WMBroadcaster.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  218</span>{</div>
<div class="line"><span class="lineno">  219</span>  std::vector&lt;std::shared_ptr&lt;Geofence&gt;&gt; updates_to_send;</div>
<div class="line"><span class="lineno">  220</span>  std::vector&lt;std::shared_ptr&lt;lanelet::SignalizedIntersection&gt;&gt; intersections;</div>
<div class="line"><span class="lineno">  221</span>  std::vector&lt;std::shared_ptr&lt;lanelet::CarmaTrafficSignal&gt;&gt; traffic_signals;</div>
<div class="line"><span class="lineno">  222</span> </div>
<div class="line"><span class="lineno">  223</span>  <span class="keyword">auto</span> sim_copy = std::make_shared&lt;carma_wm::SignalizedIntersectionManager&gt;(*<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aa26bb2f41f25b523fd2a98010af60cb0">sim_</a>);</div>
<div class="line"><span class="lineno">  224</span> </div>
<div class="line"><span class="lineno">  225</span>  <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aa26bb2f41f25b523fd2a98010af60cb0">sim_</a>-&gt;createIntersectionFromMapMsg(intersections, traffic_signals, map_msg, <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>, <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a4c64c73d83158f9b82682ad3bcc4af74">current_routing_graph_</a>);</div>
<div class="line"><span class="lineno">  226</span> </div>
<div class="line"><span class="lineno">  227</span>  <span class="keywordflow">if</span> (*<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aa26bb2f41f25b523fd2a98010af60cb0">sim_</a> == *sim_copy) <span class="comment">// if no change</span></div>
<div class="line"><span class="lineno">  228</span>  {</div>
<div class="line"><span class="lineno">  229</span>    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;&gt;&gt;&gt; Detected no change from previous, ignoring duplicate message! with gf id: &quot;</span> &lt;&lt; gf_ptr-&gt;id_);</div>
<div class="line"><span class="lineno">  230</span>    <span class="keywordflow">return</span> {};</div>
<div class="line"><span class="lineno">  231</span>  }</div>
<div class="line"><span class="lineno">  232</span> </div>
<div class="line"><span class="lineno">  233</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> intersection : intersections)</div>
<div class="line"><span class="lineno">  234</span>  {</div>
<div class="line"><span class="lineno">  235</span>    <span class="keyword">auto</span> update = std::make_shared&lt;Geofence&gt;();</div>
<div class="line"><span class="lineno">  236</span>    update-&gt;id_ = boost::uuids::random_generator()();</div>
<div class="line"><span class="lineno">  237</span>    update-&gt;label_ = <a class="code hl_variable" href="namespacecarma__wm__ctrl.html#aa279c4adbe51924a233b9efbb3735b75">carma_wm_ctrl::MAP_MSG_INTERSECTION</a>;</div>
<div class="line"><span class="lineno">  238</span>    update-&gt;regulatory_element_ = intersection;</div>
<div class="line"><span class="lineno">  239</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> llt : intersection-&gt;getEntryLanelets())</div>
<div class="line"><span class="lineno">  240</span>    {</div>
<div class="line"><span class="lineno">  241</span>      update-&gt;affected_parts_.push_back(llt);</div>
<div class="line"><span class="lineno">  242</span>    }</div>
<div class="line"><span class="lineno">  243</span>    updates_to_send.push_back(update);</div>
<div class="line"><span class="lineno">  244</span>  }</div>
<div class="line"><span class="lineno">  245</span> </div>
<div class="line"><span class="lineno">  246</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> signal : traffic_signals)</div>
<div class="line"><span class="lineno">  247</span>  {</div>
<div class="line"><span class="lineno">  248</span>    <span class="keyword">auto</span> update = std::make_shared&lt;Geofence&gt;();</div>
<div class="line"><span class="lineno">  249</span>    update-&gt;id_ = boost::uuids::random_generator()();</div>
<div class="line"><span class="lineno">  250</span>    update-&gt;label_ = <a class="code hl_variable" href="namespacecarma__wm__ctrl.html#a4db189b12ee451d1b4e936c4e36155f7">carma_wm_ctrl::MAP_MSG_TF_SIGNAL</a>;</div>
<div class="line"><span class="lineno">  251</span>    update-&gt;regulatory_element_ = signal;</div>
<div class="line"><span class="lineno">  252</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> llt : signal-&gt;getControlStartLanelets())</div>
<div class="line"><span class="lineno">  253</span>    {</div>
<div class="line"><span class="lineno">  254</span>      update-&gt;affected_parts_.push_back(llt);</div>
<div class="line"><span class="lineno">  255</span>    }</div>
<div class="line"><span class="lineno">  256</span>    updates_to_send.push_back(update);</div>
<div class="line"><span class="lineno">  257</span>  }</div>
<div class="line"><span class="lineno">  258</span>  </div>
<div class="line"><span class="lineno">  259</span>  <span class="keywordflow">return</span> updates_to_send;</div>
<div class="line"><span class="lineno">  260</span>}</div>
<div class="ttc" id="anamespacecarma__wm__ctrl_html_a4db189b12ee451d1b4e936c4e36155f7"><div class="ttname"><a href="namespacecarma__wm__ctrl.html#a4db189b12ee451d1b4e936c4e36155f7">carma_wm_ctrl::MAP_MSG_TF_SIGNAL</a></div><div class="ttdeci">const std::string MAP_MSG_TF_SIGNAL</div><div class="ttdef"><b>Definition:</b> <a href="Geofence_8hpp_source.html#l00041">Geofence.hpp:41</a></div></div>
<div class="ttc" id="anamespacecarma__wm__ctrl_html_aa279c4adbe51924a233b9efbb3735b75"><div class="ttname"><a href="namespacecarma__wm__ctrl.html#aa279c4adbe51924a233b9efbb3735b75">carma_wm_ctrl::MAP_MSG_INTERSECTION</a></div><div class="ttdeci">const std::string MAP_MSG_INTERSECTION</div><div class="ttdef"><b>Definition:</b> <a href="Geofence_8hpp_source.html#l00040">Geofence.hpp:40</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMBroadcaster_8hpp_source.html#l00429">current_map_</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00430">current_routing_graph_</a>, <a class="el" href="Geofence_8hpp_source.html#l00040">carma_wm_ctrl::MAP_MSG_INTERSECTION</a>, <a class="el" href="Geofence_8hpp_source.html#l00041">carma_wm_ctrl::MAP_MSG_TF_SIGNAL</a>, and <a class="el" href="WMBroadcaster_8hpp_source.html#l00463">sim_</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l01488">addGeofence()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_aac72e7333f997bfe19547a235f389c07_icgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_aac72e7333f997bfe19547a235f389c07_icgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_aac72e7333f997bfe19547a235f389c07_icgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_aac72e7333f997bfe19547a235f389c07_icgraph">
<area shape="rect" title="Fills geofence object from MAP Data ROS Msg which contains intersections&#39; static data such as geometr..." alt="" coords="523,5,733,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a649174a7a7270df95532cad5131bf4cb" title="Adds a geofence to the current map and publishes the ROS msg." alt="" coords="264,5,475,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a95cb7c60682d7b455a8624534ad94706" title="Constructor." alt="" coords="5,5,216,47"/>
</map>
</div>

</div>
</div>
<a id="af0e373523dc84a409331d01b62d2fce0" name="af0e373523dc84a409331d01b62d2fce0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0e373523dc84a409331d01b62d2fce0">&#9670;&nbsp;</a></span>geofenceFromMsg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void carma_wm_ctrl::WMBroadcaster::geofenceFromMsg </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classcarma__wm__ctrl_1_1Geofence.html">Geofence</a> &gt;&#160;</td>
          <td class="paramname"><em>gf_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const carma_v2x_msgs::msg::TrafficControlMessageV01 &amp;&#160;</td>
          <td class="paramname"><em>geofence_msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fills geofence object from TrafficControlMessageV01 ROS Msg. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname"><a class="el" href="classcarma__wm__ctrl_1_1Geofence.html" title="An object representing a geofence use for communications with CARMA Cloud.">Geofence</a></td><td>object to fill with information extracted from this msg and previously cached msgs that are relevant </td></tr>
    <tr><td class="paramname">geofence_msg</td><td>The ROS msg that contains geofence information </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">InvalidObjectStateError</td><td>if base_map is not set or the base_map's georeference is empty </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8cpp_source.html#l00262">262</a> of file <a class="el" href="WMBroadcaster_8cpp_source.html">WMBroadcaster.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  263</span>{</div>
<div class="line"><span class="lineno">  264</span>  <span class="keywordtype">bool</span> detected_workzone_signal = msg_v01.package.label_exists &amp;&amp; msg_v01.package.label.find(<span class="stringliteral">&quot;SIG_WZ&quot;</span>) != std::string::npos;</div>
<div class="line"><span class="lineno">  265</span>  carma_v2x_msgs::msg::TrafficControlDetail msg_detail = msg_v01.params.detail;</div>
<div class="line"><span class="lineno">  266</span> </div>
<div class="line"><span class="lineno">  267</span>  <span class="comment">// Get ID</span></div>
<div class="line"><span class="lineno">  268</span>  std::copy(msg_v01.id.id.begin(), msg_v01.id.id.end(), gf_ptr-&gt;id_.begin());</div>
<div class="line"><span class="lineno">  269</span>  </div>
<div class="line"><span class="lineno">  270</span>  gf_ptr-&gt;gf_pts = <a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a44fed247724b501a968aec27479ed58d">getPointsInLocalFrame</a>(msg_v01);</div>
<div class="line"><span class="lineno">  271</span> </div>
<div class="line"><span class="lineno">  272</span>  gf_ptr-&gt;affected_parts_ = <a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a1327952ca44a5e817b0498f93f6143ac">getAffectedLaneletOrAreas</a>(gf_ptr-&gt;gf_pts);</div>
<div class="line"><span class="lineno">  273</span> </div>
<div class="line"><span class="lineno">  274</span>  <span class="keywordflow">if</span> (gf_ptr-&gt;affected_parts_.size() == 0) {</div>
<div class="line"><span class="lineno">  275</span>    RCLCPP_WARN_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;There is no applicable component in map for the new geofence message received by WMBroadcaster with id: &quot;</span> &lt;&lt; gf_ptr-&gt;id_);</div>
<div class="line"><span class="lineno">  276</span>    <span class="keywordflow">return</span>; <span class="comment">// Return empty geofence list</span></div>
<div class="line"><span class="lineno">  277</span>  }</div>
<div class="line"><span class="lineno">  278</span> </div>
<div class="line"><span class="lineno">  279</span>  std::vector&lt;lanelet::Lanelet&gt; affected_llts;</div>
<div class="line"><span class="lineno">  280</span>  std::vector&lt;lanelet::Area&gt; affected_areas;</div>
<div class="line"><span class="lineno">  281</span> </div>
<div class="line"><span class="lineno">  282</span>  <span class="comment">// used for assigning them to the regem as parameters</span></div>
<div class="line"><span class="lineno">  283</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> llt_or_area : gf_ptr-&gt;affected_parts_)</div>
<div class="line"><span class="lineno">  284</span>  {</div>
<div class="line"><span class="lineno">  285</span> </div>
<div class="line"><span class="lineno">  286</span>    <span class="keywordflow">if</span> (llt_or_area.isLanelet()) affected_llts.push_back(<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;laneletLayer.get(llt_or_area.lanelet()-&gt;id()));</div>
<div class="line"><span class="lineno">  287</span>    <span class="keywordflow">if</span> (llt_or_area.isArea()) affected_areas.push_back(<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;areaLayer.get(llt_or_area.area()-&gt;id()));</div>
<div class="line"><span class="lineno">  288</span>  }</div>
<div class="line"><span class="lineno">  289</span> </div>
<div class="line"><span class="lineno">  290</span>  <span class="comment">// TODO: logic to determine what type of geofence goes here</span></div>
<div class="line"><span class="lineno">  291</span>  <span class="comment">// currently only converting portion of control message that is relevant to:</span></div>
<div class="line"><span class="lineno">  292</span>  <span class="comment">// - digital speed limit, passing control line, digital minimum gap, region access rule, and series of workzone related messages</span></div>
<div class="line"><span class="lineno">  293</span>  lanelet::Velocity sL;</div>
<div class="line"><span class="lineno">  294</span>  </div>
<div class="line"><span class="lineno">  295</span>  </div>
<div class="line"><span class="lineno">  296</span>  <span class="keywordflow">if</span> (msg_detail.choice == carma_v2x_msgs::msg::TrafficControlDetail::MAXSPEED_CHOICE) </div>
<div class="line"><span class="lineno">  297</span>  {  </div>
<div class="line"><span class="lineno">  298</span>    <span class="comment">//Acquire speed limit information from TafficControlDetail msg</span></div>
<div class="line"><span class="lineno">  299</span>    sL = lanelet::Velocity(msg_detail.maxspeed * lanelet::units::MPS()); </div>
<div class="line"><span class="lineno">  300</span>    std::string reason = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><span class="lineno">  301</span>    <span class="keywordflow">if</span> (msg_v01.package.label_exists)</div>
<div class="line"><span class="lineno">  302</span>      reason = msg_v01.package.label;</div>
<div class="line"><span class="lineno">  303</span> </div>
<div class="line"><span class="lineno">  304</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a4bf605c8ea54b5a03e01d010d6014389">config_limit</a> &gt; 0_mph &amp;&amp; <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a4bf605c8ea54b5a03e01d010d6014389">config_limit</a> &lt; 80_mph &amp;&amp; <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a4bf605c8ea54b5a03e01d010d6014389">config_limit</a> &lt; sL)<span class="comment">//Accounting for the configured speed limit, input zero when not in use</span></div>
<div class="line"><span class="lineno">  305</span>        sL = <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a4bf605c8ea54b5a03e01d010d6014389">config_limit</a>;</div>
<div class="line"><span class="lineno">  306</span>    <span class="comment">//Ensure Geofences do not provide invalid speed limit data (exceed predetermined maximum value)</span></div>
<div class="line"><span class="lineno">  307</span>    <span class="comment">// @SONAR_STOP@</span></div>
<div class="line"><span class="lineno">  308</span>    <span class="keywordflow">if</span>(sL &gt; 80_mph )</div>
<div class="line"><span class="lineno">  309</span>    {</div>
<div class="line"><span class="lineno">  310</span>    RCLCPP_WARN_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Digital maximum speed limit is invalid. Value capped at max speed limit.&quot;</span>); <span class="comment">//Output warning message</span></div>
<div class="line"><span class="lineno">  311</span>    sL = 80_mph; <span class="comment">//Cap the speed limit to the predetermined maximum value</span></div>
<div class="line"><span class="lineno">  312</span> </div>
<div class="line"><span class="lineno">  313</span>    }</div>
<div class="line"><span class="lineno">  314</span>    <span class="keywordflow">if</span>(sL &lt; 0_mph)</div>
<div class="line"><span class="lineno">  315</span>    {</div>
<div class="line"><span class="lineno">  316</span>          RCLCPP_WARN_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Digital  speed limit is invalid. Value set to 0mph.&quot;</span>);</div>
<div class="line"><span class="lineno">  317</span>      sL = 0_mph;</div>
<div class="line"><span class="lineno">  318</span>    }<span class="comment">// @SONAR_START@</span></div>
<div class="line"><span class="lineno">  319</span>    </div>
<div class="line"><span class="lineno">  320</span>    gf_ptr-&gt;regulatory_element_ = std::make_shared&lt;lanelet::DigitalSpeedLimit&gt;(lanelet::DigitalSpeedLimit::buildData(lanelet::utils::getId(), </div>
<div class="line"><span class="lineno">  321</span>                                        sL, affected_llts, affected_areas, <a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aa326eab73fe1583c1fa937ed2e38b33f">participantsChecker</a>(msg_v01), reason));</div>
<div class="line"><span class="lineno">  322</span>  }</div>
<div class="line"><span class="lineno">  323</span>  <span class="keywordflow">if</span> (msg_detail.choice == carma_v2x_msgs::msg::TrafficControlDetail::MINSPEED_CHOICE) </div>
<div class="line"><span class="lineno">  324</span>  {</div>
<div class="line"><span class="lineno">  325</span>    <span class="comment">//Acquire speed limit information from TafficControlDetail msg</span></div>
<div class="line"><span class="lineno">  326</span>    sL = lanelet::Velocity(msg_detail.minspeed * lanelet::units::MPS());</div>
<div class="line"><span class="lineno">  327</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a4bf605c8ea54b5a03e01d010d6014389">config_limit</a> &gt; 0_mph &amp;&amp; <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a4bf605c8ea54b5a03e01d010d6014389">config_limit</a> &lt; 80_mph)<span class="comment">//Accounting for the configured speed limit, input zero when not in use</span></div>
<div class="line"><span class="lineno">  328</span>        sL = <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a4bf605c8ea54b5a03e01d010d6014389">config_limit</a>;</div>
<div class="line"><span class="lineno">  329</span> </div>
<div class="line"><span class="lineno">  330</span>    std::string reason = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><span class="lineno">  331</span>    <span class="keywordflow">if</span> (msg_v01.package.label_exists)</div>
<div class="line"><span class="lineno">  332</span>      reason = msg_v01.package.label;</div>
<div class="line"><span class="lineno">  333</span> </div>
<div class="line"><span class="lineno">  334</span>    <span class="comment">//Ensure Geofences do not provide invalid speed limit data </span></div>
<div class="line"><span class="lineno">  335</span>    <span class="comment">// @SONAR_STOP@</span></div>
<div class="line"><span class="lineno">  336</span>    <span class="keywordflow">if</span>(sL &gt; 80_mph )</div>
<div class="line"><span class="lineno">  337</span>    {</div>
<div class="line"><span class="lineno">  338</span>    RCLCPP_WARN_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Digital speed limit is invalid. Value capped at max speed limit.&quot;</span>);</div>
<div class="line"><span class="lineno">  339</span>    sL = 80_mph;</div>
<div class="line"><span class="lineno">  340</span>    }</div>
<div class="line"><span class="lineno">  341</span>    <span class="keywordflow">if</span>(sL &lt; 0_mph)</div>
<div class="line"><span class="lineno">  342</span>    {</div>
<div class="line"><span class="lineno">  343</span>      RCLCPP_WARN_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Digital  speed limit is invalid. Value set to 0mph.&quot;</span>);</div>
<div class="line"><span class="lineno">  344</span>      sL = 0_mph;</div>
<div class="line"><span class="lineno">  345</span>    }<span class="comment">// @SONAR_START@</span></div>
<div class="line"><span class="lineno">  346</span>    gf_ptr-&gt;regulatory_element_ = std::make_shared&lt;lanelet::DigitalSpeedLimit&gt;(lanelet::DigitalSpeedLimit::buildData(lanelet::utils::getId(), </div>
<div class="line"><span class="lineno">  347</span>                                        sL, affected_llts, affected_areas, <a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aa326eab73fe1583c1fa937ed2e38b33f">participantsChecker</a>(msg_v01), reason));</div>
<div class="line"><span class="lineno">  348</span>  }</div>
<div class="line"><span class="lineno">  349</span>  <span class="keywordflow">if</span> (msg_detail.choice == carma_v2x_msgs::msg::TrafficControlDetail::LATPERM_CHOICE || msg_detail.choice == carma_v2x_msgs::msg::TrafficControlDetail::LATAFFINITY_CHOICE)</div>
<div class="line"><span class="lineno">  350</span>  {</div>
<div class="line"><span class="lineno">  351</span>    <a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a74d10f4f0534115f672f8995f0036b49">addPassingControlLineFromMsg</a>(gf_ptr, msg_v01, affected_llts);</div>
<div class="line"><span class="lineno">  352</span>  }</div>
<div class="line"><span class="lineno">  353</span>  <span class="keywordflow">if</span> (msg_detail.choice == carma_v2x_msgs::msg::TrafficControlDetail::MINHDWY_CHOICE) </div>
<div class="line"><span class="lineno">  354</span>  {</div>
<div class="line"><span class="lineno">  355</span> </div>
<div class="line"><span class="lineno">  356</span>    <span class="keywordtype">double</span> min_gap = (double)msg_detail.minhdwy;</div>
<div class="line"><span class="lineno">  357</span> </div>
<div class="line"><span class="lineno">  358</span>    <span class="keywordflow">if</span>(min_gap &lt; 0)</div>
<div class="line"><span class="lineno">  359</span>    {</div>
<div class="line"><span class="lineno">  360</span>      RCLCPP_WARN_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Digital min gap is invalid. Value set to 0 meter.&quot;</span>);</div>
<div class="line"><span class="lineno">  361</span>      min_gap = 0;</div>
<div class="line"><span class="lineno">  362</span>    }</div>
<div class="line"><span class="lineno">  363</span>    <a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a116928c0070cfa7587c219a6629dadb8">addRegionMinimumGap</a>(gf_ptr,msg_v01, min_gap, affected_llts, affected_areas);</div>
<div class="line"><span class="lineno">  364</span>  }</div>
<div class="line"><span class="lineno">  365</span> </div>
<div class="line"><span class="lineno">  366</span>  <span class="keywordflow">if</span> (detected_workzone_signal &amp;&amp; msg_detail.choice != carma_v2x_msgs::msg::TrafficControlDetail::MAXSPEED_CHOICE) <span class="comment">// if workzone message detected, save to cache to process later</span></div>
<div class="line"><span class="lineno">  367</span>  {</div>
<div class="line"><span class="lineno">  368</span>    gf_ptr-&gt;label_ = msg_v01.package.label; <span class="comment">// to extract intersection, and signal group id</span></div>
<div class="line"><span class="lineno">  369</span>    <span class="keywordflow">if</span> (msg_detail.choice == carma_v2x_msgs::msg::TrafficControlDetail::CLOSED_CHOICE &amp;&amp; (msg_detail.closed == carma_v2x_msgs::msg::TrafficControlDetail::CLOSED ||</div>
<div class="line"><span class="lineno">  370</span>                                                                                msg_detail.closed == carma_v2x_msgs::msg::TrafficControlDetail::TAPERRIGHT ||</div>
<div class="line"><span class="lineno">  371</span>                                                                                msg_detail.closed == carma_v2x_msgs::msg::TrafficControlDetail::OPENRIGHT))</div>
<div class="line"><span class="lineno">  372</span>    {</div>
<div class="line"><span class="lineno">  373</span>      <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a4610499a06e220327a8eb10cbc18d8de">work_zone_geofence_cache_</a>[msg_detail.closed] = gf_ptr;</div>
<div class="line"><span class="lineno">  374</span>    }</div>
<div class="line"><span class="lineno">  375</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (msg_detail.choice == carma_v2x_msgs::msg::TrafficControlDetail::DIRECTION_CHOICE &amp;&amp; msg_detail.direction == carma_v2x_msgs::msg::TrafficControlDetail::REVERSE)</div>
<div class="line"><span class="lineno">  376</span>    {</div>
<div class="line"><span class="lineno">  377</span>      <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a4610499a06e220327a8eb10cbc18d8de">work_zone_geofence_cache_</a>[<a class="code hl_variable" href="structcarma__wm__ctrl_1_1WorkZoneSection.html#ade4ff9d14cf9c540b8235d25a3fe1b61">WorkZoneSection::REVERSE</a>] = gf_ptr;</div>
<div class="line"><span class="lineno">  378</span>    }</div>
<div class="line"><span class="lineno">  379</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  380</span>  }</div>
<div class="line"><span class="lineno">  381</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (msg_detail.choice == carma_v2x_msgs::msg::TrafficControlDetail::CLOSED_CHOICE &amp;&amp; msg_detail.closed==carma_v2x_msgs::msg::TrafficControlDetail::CLOSED) <span class="comment">// if stand-alone closed signal apart from Workzone</span></div>
<div class="line"><span class="lineno">  382</span>  {</div>
<div class="line"><span class="lineno">  383</span>    <a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ae34565da1566e777745a92161422404c">addRegionAccessRule</a>(gf_ptr,msg_v01,affected_llts);</div>
<div class="line"><span class="lineno">  384</span>  }</div>
<div class="line"><span class="lineno">  385</span> </div>
<div class="line"><span class="lineno">  386</span>  <span class="keywordflow">if</span> (msg_detail.choice == carma_v2x_msgs::msg::TrafficControlDetail::RESTRICTED_CHOICE) {</div>
<div class="line"><span class="lineno">  387</span>    <a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ae34565da1566e777745a92161422404c">addRegionAccessRule</a>(gf_ptr, msg_v01, affected_llts);</div>
<div class="line"><span class="lineno">  388</span>  }</div>
<div class="line"><span class="lineno">  389</span> </div>
<div class="line"><span class="lineno">  390</span>  <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  391</span>}</div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_a116928c0070cfa7587c219a6629dadb8"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a116928c0070cfa7587c219a6629dadb8">carma_wm_ctrl::WMBroadcaster::addRegionMinimumGap</a></div><div class="ttdeci">void addRegionMinimumGap(std::shared_ptr&lt; Geofence &gt; gf_ptr, const carma_v2x_msgs::msg::TrafficControlMessageV01 &amp;msg_v01, double min_gap, const std::vector&lt; lanelet::Lanelet &gt; &amp;affected_llts, const std::vector&lt; lanelet::Area &gt; &amp;affected_areas) const</div><div class="ttdoc">Adds Minimum Gap to the map.</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8cpp_source.html#l00943">WMBroadcaster.cpp:943</a></div></div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_a1327952ca44a5e817b0498f93f6143ac"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a1327952ca44a5e817b0498f93f6143ac">carma_wm_ctrl::WMBroadcaster::getAffectedLaneletOrAreas</a></div><div class="ttdeci">lanelet::ConstLaneletOrAreas getAffectedLaneletOrAreas(const lanelet::Points3d &amp;gf_pts)</div><div class="ttdoc">Gets the affected lanelet or areas based on the points in local frame.</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8cpp_source.html#l01344">WMBroadcaster.cpp:1344</a></div></div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_a44fed247724b501a968aec27479ed58d"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a44fed247724b501a968aec27479ed58d">carma_wm_ctrl::WMBroadcaster::getPointsInLocalFrame</a></div><div class="ttdeci">lanelet::Points3d getPointsInLocalFrame(const carma_v2x_msgs::msg::TrafficControlMessageV01 &amp;geofence_msg)</div><div class="ttdoc">Extract geofence points from geofence message using its given proj and datum fields.</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8cpp_source.html#l01264">WMBroadcaster.cpp:1264</a></div></div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_a74d10f4f0534115f672f8995f0036b49"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a74d10f4f0534115f672f8995f0036b49">carma_wm_ctrl::WMBroadcaster::addPassingControlLineFromMsg</a></div><div class="ttdeci">void addPassingControlLineFromMsg(std::shared_ptr&lt; Geofence &gt; gf_ptr, const carma_v2x_msgs::msg::TrafficControlMessageV01 &amp;msg_v01, const std::vector&lt; lanelet::Lanelet &gt; &amp;affected_llts) const</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8cpp_source.html#l00880">WMBroadcaster.cpp:880</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMBroadcaster_8cpp_source.html#l00880">addPassingControlLineFromMsg()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l00926">addRegionAccessRule()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l00943">addRegionMinimumGap()</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00431">config_limit</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00429">current_map_</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l01344">getAffectedLaneletOrAreas()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l01264">getPointsInLocalFrame()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l00951">participantsChecker()</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00062">carma_wm_ctrl::WorkZoneSection::REVERSE</a>, and <a class="el" href="WMBroadcaster_8hpp_source.html#l00412">work_zone_geofence_cache_</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l01488">addGeofence()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_af0e373523dc84a409331d01b62d2fce0_cgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_af0e373523dc84a409331d01b62d2fce0_cgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_af0e373523dc84a409331d01b62d2fce0_cgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_af0e373523dc84a409331d01b62d2fce0_cgraph">
<area shape="rect" title="Fills geofence object from TrafficControlMessageV01 ROS Msg." alt="" coords="5,156,216,197"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a74d10f4f0534115f672f8995f0036b49" title=" " alt="" coords="264,5,481,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aa326eab73fe1583c1fa937ed2e38b33f" title="Generates participants list." alt="" coords="529,123,740,164"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ae34565da1566e777745a92161422404c" title="Adds RegionAccessRule to the map." alt="" coords="267,188,478,229"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a116928c0070cfa7587c219a6629dadb8" title="Adds Minimum Gap to the map." alt="" coords="267,123,478,164"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a1327952ca44a5e817b0498f93f6143ac" title="Gets the affected lanelet or areas based on the points in local frame." alt="" coords="267,253,478,295"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a44fed247724b501a968aec27479ed58d" title="Extract geofence points from geofence message using its given proj and datum fields." alt="" coords="267,319,478,360"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a2c6c3606e5f4b3c12a984261823c1d71" title="Combines a list of the given participants into a single &quot;vehicle&quot; type if participants cover all poss..." alt="" coords="790,123,1001,164"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ac71c9fdbf27cbfbe3988c3a77d6e7067" title="Generates inverse participants list of the given participants." alt="" coords="529,188,740,229"/>
<area shape="rect" href="namespacecarma__wm_1_1query.html#a9c9935e22582f37c01441115bce72f58" title="Gets the affected lanelet or areas based on the points in the given map&#39;s frame." alt="" coords="537,253,732,295"/>
<area shape="rect" href="namespacecarma__wm_1_1query.html#a382665a2ddc42be06fca9c1f8dfd0489" title="A function that filters successor lanelets of root_lanelets from possible_lanelets." alt="" coords="788,188,1003,229"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#abab7ba4e773f03d6cfc09492742c6b7b" title="Calculates the angle between two vectors." alt="" coords="808,253,983,295"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#aebce986f21c117983313292d5e82b50a" title="Returns the TrackPos, computed in 2d, of the provided point relative to the centerline of the provide..." alt="" coords="823,319,968,360"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#a50c966bd5e6ed00ea0b1a70e93cd0d4a" title="acos method that caps the input x value for 1 or &#45;1 to avoid undefined output. This is meant to preve..." alt="" coords="1051,253,1196,295"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#ab675b2b8862a2ba9c139a8b5b353b846" title="Get the TrackPos of the provided point along the linestring and the segment of the line string which ..." alt="" coords="1051,319,1196,360"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#ae0a06818149f7430fee80e295ef04548" title="Helper function to identify whether to select the preceeding or succeeding segment of a linstring poi..." alt="" coords="1244,319,1389,360"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_af0e373523dc84a409331d01b62d2fce0_icgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_af0e373523dc84a409331d01b62d2fce0_icgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_af0e373523dc84a409331d01b62d2fce0_icgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_af0e373523dc84a409331d01b62d2fce0_icgraph">
<area shape="rect" title="Fills geofence object from TrafficControlMessageV01 ROS Msg." alt="" coords="523,5,733,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a649174a7a7270df95532cad5131bf4cb" title="Adds a geofence to the current map and publishes the ROS msg." alt="" coords="264,5,475,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a95cb7c60682d7b455a8624534ad94706" title="Constructor." alt="" coords="5,5,216,47"/>
</map>
</div>

</div>
</div>
<a id="af400fb26c47adae60502bc64c600b298" name="af400fb26c47adae60502bc64c600b298"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af400fb26c47adae60502bc64c600b298">&#9670;&nbsp;</a></span>geoReferenceCallback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void carma_wm_ctrl::WMBroadcaster::geoReferenceCallback </td>
          <td>(</td>
          <td class="paramtype">std_msgs::msg::String::UniquePtr&#160;</td>
          <td class="paramname"><em>geo_ref</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Callback to set the base map georeference (proj string) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">georef_msg</td><td>Proj string that specifies the georeference of the map. It is used for transfering frames between that of geofence and that of the vehicle </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8cpp_source.html#l01198">1198</a> of file <a class="el" href="WMBroadcaster_8cpp_source.html">WMBroadcaster.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1199</span>{</div>
<div class="line"><span class="lineno"> 1200</span>  std::lock_guard&lt;std::mutex&gt; guard(<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a1ac51e0b0b57eda669c87372bd079ede">map_mutex_</a>);</div>
<div class="line"><span class="lineno"> 1201</span>  <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aa26bb2f41f25b523fd2a98010af60cb0">sim_</a>-&gt;setTargetFrame(geo_ref-&gt;data);</div>
<div class="line"><span class="lineno"> 1202</span>  <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a8960147050728c13bb19f8157cd51d25">base_map_georef_</a> = geo_ref-&gt;data;</div>
<div class="line"><span class="lineno"> 1203</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMBroadcaster_8hpp_source.html#l00443">base_map_georef_</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00436">map_mutex_</a>, and <a class="el" href="WMBroadcaster_8hpp_source.html#l00463">sim_</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcasterNode_8cpp_source.html#l00153">carma_wm_ctrl::WMBroadcasterNode::handle_on_activate()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_af400fb26c47adae60502bc64c600b298_icgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_af400fb26c47adae60502bc64c600b298_icgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_af400fb26c47adae60502bc64c600b298_icgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_af400fb26c47adae60502bc64c600b298_icgraph">
<area shape="rect" title="Callback to set the base map georeference (proj string)" alt="" coords="264,5,475,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcasterNode.html#ab0c14f6d7e30870755a4dcf6b228de82" title=" " alt="" coords="5,5,216,47"/>
</map>
</div>

</div>
</div>
<a id="a1327952ca44a5e817b0498f93f6143ac" name="a1327952ca44a5e817b0498f93f6143ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1327952ca44a5e817b0498f93f6143ac">&#9670;&nbsp;</a></span>getAffectedLaneletOrAreas()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">lanelet::ConstLaneletOrAreas carma_wm_ctrl::WMBroadcaster::getAffectedLaneletOrAreas </td>
          <td>(</td>
          <td class="paramtype">const lanelet::Points3d &amp;&#160;</td>
          <td class="paramname"><em>gf_pts</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the affected lanelet or areas based on the points in local frame. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">geofence_msg</td><td>lanelet::Points3d in local frame NOTE:Currently this function only checks lanelets and will be expanded to areas in the future. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8cpp_source.html#l01344">1344</a> of file <a class="el" href="WMBroadcaster_8cpp_source.html">WMBroadcaster.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1345</span>{</div>
<div class="line"><span class="lineno"> 1346</span>  <span class="keywordflow">return</span> <a class="code hl_function" href="namespacecarma__wm_1_1query.html#a9c9935e22582f37c01441115bce72f58">carma_wm::query::getAffectedLaneletOrAreas</a>(gf_pts, <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>, <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a4c64c73d83158f9b82682ad3bcc4af74">current_routing_graph_</a>, <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#af150debc195a3c34c9320232a9b9a1eb">max_lane_width_</a>);</div>
<div class="line"><span class="lineno"> 1347</span>}</div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_af150debc195a3c34c9320232a9b9a1eb"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#af150debc195a3c34c9320232a9b9a1eb">carma_wm_ctrl::WMBroadcaster::max_lane_width_</a></div><div class="ttdeci">double max_lane_width_</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8hpp_source.html#l00444">WMBroadcaster.hpp:444</a></div></div>
<div class="ttc" id="anamespacecarma__wm_1_1query_html_a9c9935e22582f37c01441115bce72f58"><div class="ttname"><a href="namespacecarma__wm_1_1query.html#a9c9935e22582f37c01441115bce72f58">carma_wm::query::getAffectedLaneletOrAreas</a></div><div class="ttdeci">lanelet::ConstLaneletOrAreas getAffectedLaneletOrAreas(const lanelet::Points3d &amp;gf_pts, const lanelet::LaneletMapPtr &amp;lanelet_map, std::shared_ptr&lt; const lanelet::routing::RoutingGraph &gt; routing_graph, double max_lane_width)</div><div class="ttdoc">Gets the affected lanelet or areas based on the points in the given map's frame.</div><div class="ttdef"><b>Definition:</b> <a href="WorldModelUtils_8cpp_source.html#l00117">WorldModelUtils.cpp:117</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMBroadcaster_8hpp_source.html#l00429">current_map_</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00430">current_routing_graph_</a>, <a class="el" href="WorldModelUtils_8cpp_source.html#l00117">carma_wm::query::getAffectedLaneletOrAreas()</a>, and <a class="el" href="WMBroadcaster_8hpp_source.html#l00444">max_lane_width_</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l00262">geofenceFromMsg()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_a1327952ca44a5e817b0498f93f6143ac_cgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_a1327952ca44a5e817b0498f93f6143ac_cgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_a1327952ca44a5e817b0498f93f6143ac_cgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_a1327952ca44a5e817b0498f93f6143ac_cgraph">
<area shape="rect" title="Gets the affected lanelet or areas based on the points in local frame." alt="" coords="5,71,216,112"/>
<area shape="rect" href="namespacecarma__wm_1_1query.html#a9c9935e22582f37c01441115bce72f58" title="Gets the affected lanelet or areas based on the points in the given map&#39;s frame." alt="" coords="264,71,459,112"/>
<area shape="rect" href="namespacecarma__wm_1_1query.html#a382665a2ddc42be06fca9c1f8dfd0489" title="A function that filters successor lanelets of root_lanelets from possible_lanelets." alt="" coords="507,5,721,47"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#abab7ba4e773f03d6cfc09492742c6b7b" title="Calculates the angle between two vectors." alt="" coords="527,71,701,112"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#aebce986f21c117983313292d5e82b50a" title="Returns the TrackPos, computed in 2d, of the provided point relative to the centerline of the provide..." alt="" coords="541,136,687,177"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#a50c966bd5e6ed00ea0b1a70e93cd0d4a" title="acos method that caps the input x value for 1 or &#45;1 to avoid undefined output. This is meant to preve..." alt="" coords="769,71,915,112"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#ab675b2b8862a2ba9c139a8b5b353b846" title="Get the TrackPos of the provided point along the linestring and the segment of the line string which ..." alt="" coords="769,136,915,177"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#ae0a06818149f7430fee80e295ef04548" title="Helper function to identify whether to select the preceeding or succeeding segment of a linstring poi..." alt="" coords="963,136,1108,177"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_a1327952ca44a5e817b0498f93f6143ac_icgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_a1327952ca44a5e817b0498f93f6143ac_icgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_a1327952ca44a5e817b0498f93f6143ac_icgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_a1327952ca44a5e817b0498f93f6143ac_icgraph">
<area shape="rect" title="Gets the affected lanelet or areas based on the points in local frame." alt="" coords="781,5,992,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#af0e373523dc84a409331d01b62d2fce0" title="Fills geofence object from TrafficControlMessageV01 ROS Msg." alt="" coords="523,5,733,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a649174a7a7270df95532cad5131bf4cb" title="Adds a geofence to the current map and publishes the ROS msg." alt="" coords="264,5,475,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a95cb7c60682d7b455a8624534ad94706" title="Constructor." alt="" coords="5,5,216,47"/>
</map>
</div>

</div>
</div>
<a id="a44fed247724b501a968aec27479ed58d" name="a44fed247724b501a968aec27479ed58d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44fed247724b501a968aec27479ed58d">&#9670;&nbsp;</a></span>getPointsInLocalFrame()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">lanelet::Points3d carma_wm_ctrl::WMBroadcaster::getPointsInLocalFrame </td>
          <td>(</td>
          <td class="paramtype">const carma_v2x_msgs::msg::TrafficControlMessageV01 &amp;&#160;</td>
          <td class="paramname"><em>geofence_msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Extract geofence points from geofence message using its given proj and datum fields. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">geofence_msg</td><td>The ROS msg that contains proj and any point that lie on the target lanelet or area </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">InvalidObjectStateError</td><td>if base_map is not set or the base_map's georeference is empty </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>lanelet::Points3d in local frame </dd></dl>

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8cpp_source.html#l01264">1264</a> of file <a class="el" href="WMBroadcaster_8cpp_source.html">WMBroadcaster.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1265</span>{</div>
<div class="line"><span class="lineno"> 1266</span>  RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Getting affected lanelets&quot;</span>);</div>
<div class="line"><span class="lineno"> 1267</span>  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a> || <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;laneletLayer.size() == 0)</div>
<div class="line"><span class="lineno"> 1268</span>  {</div>
<div class="line"><span class="lineno"> 1269</span>    <span class="keywordflow">throw</span> lanelet::InvalidObjectStateError(std::string(<span class="stringliteral">&quot;Base lanelet map is not loaded to the WMBroadcaster&quot;</span>));</div>
<div class="line"><span class="lineno"> 1270</span>  }</div>
<div class="line"><span class="lineno"> 1271</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a8960147050728c13bb19f8157cd51d25">base_map_georef_</a> == <span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><span class="lineno"> 1272</span>    <span class="keywordflow">throw</span> lanelet::InvalidObjectStateError(std::string(<span class="stringliteral">&quot;Base lanelet map has empty proj string loaded as georeference. Therefore, WMBroadcaster failed to\n &quot;</span>) +</div>
<div class="line"><span class="lineno"> 1273</span>                                          std::string(<span class="stringliteral">&quot;get transformation between the geofence and the map&quot;</span>));</div>
<div class="line"><span class="lineno"> 1274</span> </div>
<div class="line"><span class="lineno"> 1275</span>  <span class="comment">// This next section handles the geofence projection conversion</span></div>
<div class="line"><span class="lineno"> 1276</span>  <span class="comment">// The datum field is used to identify the frame for the provided referance lat/lon. </span></div>
<div class="line"><span class="lineno"> 1277</span>  <span class="comment">// This reference is then converted to the provided projection as a reference origin point</span></div>
<div class="line"><span class="lineno"> 1278</span>  <span class="comment">// From the reference the message projection to map projection transformation is used to convert the nodes in the TrafficControlMessage</span></div>
<div class="line"><span class="lineno"> 1279</span>  std::string projection = tcm_v01.geometry.proj;</div>
<div class="line"><span class="lineno"> 1280</span>  std::string datum = tcm_v01.geometry.datum;</div>
<div class="line"><span class="lineno"> 1281</span>  <span class="keywordflow">if</span> (datum.empty()) {</div>
<div class="line"><span class="lineno"> 1282</span>    RCLCPP_WARN_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Datum field not populated. Attempting to use WGS84&quot;</span>);</div>
<div class="line"><span class="lineno"> 1283</span>    datum = <span class="stringliteral">&quot;WGS84&quot;</span>;</div>
<div class="line"><span class="lineno"> 1284</span>  }</div>
<div class="line"><span class="lineno"> 1285</span> </div>
<div class="line"><span class="lineno"> 1286</span>  RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Projection field: &quot;</span> &lt;&lt; projection);</div>
<div class="line"><span class="lineno"> 1287</span>  RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Datum field: &quot;</span> &lt;&lt; datum);</div>
<div class="line"><span class="lineno"> 1288</span>  </div>
<div class="line"><span class="lineno"> 1289</span>  std::string universal_frame = datum; <span class="comment">//lat/long included in TCM is in this datum</span></div>
<div class="line"><span class="lineno"> 1290</span> </div>
<div class="line"><span class="lineno"> 1291</span> </div>
<div class="line"><span class="lineno"> 1292</span>  RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Traffic Control heading provided: &quot;</span> &lt;&lt; tcm_v01.geometry.heading &lt;&lt; <span class="stringliteral">&quot; System understanding is that this value will not affect the projection and is only provided for supporting derivative calculations.&quot;</span>);</div>
<div class="line"><span class="lineno"> 1293</span>  </div>
<div class="line"><span class="lineno"> 1294</span>  <span class="comment">// Create the resulting projection transformation</span></div>
<div class="line"><span class="lineno"> 1295</span>  PJ* universal_to_target = proj_create_crs_to_crs(PJ_DEFAULT_CTX, universal_frame.c_str(), projection.c_str(), <span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno"> 1296</span>  <span class="keywordflow">if</span> (universal_to_target == <span class="keyword">nullptr</span>) { <span class="comment">// proj_create_crs_to_crs returns 0 when there is an error in the projection</span></div>
<div class="line"><span class="lineno"> 1297</span>    </div>
<div class="line"><span class="lineno"> 1298</span>    RCLCPP_ERROR_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Failed to generate projection between geofence and map with error number: &quot;</span> &lt;&lt;  proj_context_errno(PJ_DEFAULT_CTX) </div>
<div class="line"><span class="lineno"> 1299</span>      &lt;&lt; <span class="stringliteral">&quot; universal_frame: &quot;</span> &lt;&lt; universal_frame &lt;&lt; <span class="stringliteral">&quot; projection: &quot;</span> &lt;&lt; projection);</div>
<div class="line"><span class="lineno"> 1300</span> </div>
<div class="line"><span class="lineno"> 1301</span>    <span class="keywordflow">return</span> {}; <span class="comment">// Ignore geofence if it could not be projected from universal to TCM frame</span></div>
<div class="line"><span class="lineno"> 1302</span>  }</div>
<div class="line"><span class="lineno"> 1303</span>  </div>
<div class="line"><span class="lineno"> 1304</span>  PJ* target_to_map = proj_create_crs_to_crs(PJ_DEFAULT_CTX, projection.c_str(), <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a8960147050728c13bb19f8157cd51d25">base_map_georef_</a>.c_str(), <span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno"> 1305</span> </div>
<div class="line"><span class="lineno"> 1306</span>  <span class="keywordflow">if</span> (target_to_map == <span class="keyword">nullptr</span>) { <span class="comment">// proj_create_crs_to_crs returns 0 when there is an error in the projection</span></div>
<div class="line"><span class="lineno"> 1307</span>    </div>
<div class="line"><span class="lineno"> 1308</span>    RCLCPP_ERROR_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Failed to generate projection between geofence and map with error number: &quot;</span> &lt;&lt;  proj_context_errno(PJ_DEFAULT_CTX) </div>
<div class="line"><span class="lineno"> 1309</span>      &lt;&lt; <span class="stringliteral">&quot; target_to_map: &quot;</span> &lt;&lt; target_to_map &lt;&lt; <span class="stringliteral">&quot; base_map_georef_: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a8960147050728c13bb19f8157cd51d25">base_map_georef_</a>);</div>
<div class="line"><span class="lineno"> 1310</span> </div>
<div class="line"><span class="lineno"> 1311</span>    <span class="keywordflow">return</span> {}; <span class="comment">// Ignore geofence if it could not be projected into the map frame</span></div>
<div class="line"><span class="lineno"> 1312</span>  </div>
<div class="line"><span class="lineno"> 1313</span>  }</div>
<div class="line"><span class="lineno"> 1314</span>  </div>
<div class="line"><span class="lineno"> 1315</span>  <span class="comment">// convert all geofence points into our map&#39;s frame</span></div>
<div class="line"><span class="lineno"> 1316</span>  std::vector&lt;lanelet::Point3d&gt; gf_pts;</div>
<div class="line"><span class="lineno"> 1317</span>  carma_v2x_msgs::msg::PathNode prev_pt;</div>
<div class="line"><span class="lineno"> 1318</span>  PJ_COORD c_init_latlong{{tcm_v01.geometry.reflat, tcm_v01.geometry.reflon, tcm_v01.geometry.refelv}};</div>
<div class="line"><span class="lineno"> 1319</span>  PJ_COORD c_init = proj_trans(universal_to_target, PJ_FWD, c_init_latlong);</div>
<div class="line"><span class="lineno"> 1320</span> </div>
<div class="line"><span class="lineno"> 1321</span>  prev_pt.x = c_init.xyz.x;</div>
<div class="line"><span class="lineno"> 1322</span>  prev_pt.y =  c_init.xyz.y;</div>
<div class="line"><span class="lineno"> 1323</span> </div>
<div class="line"><span class="lineno"> 1324</span>  RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;In TCM&#39;s frame, initial Point X &quot;</span>&lt;&lt; prev_pt.x&lt;&lt;<span class="stringliteral">&quot; Before conversion: Point Y &quot;</span>&lt;&lt; prev_pt.y );</div>
<div class="line"><span class="lineno"> 1325</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> pt : tcm_v01.geometry.nodes)</div>
<div class="line"><span class="lineno"> 1326</span>  { </div>
<div class="line"><span class="lineno"> 1327</span>    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Before conversion in TCM frame: Point X &quot;</span>&lt;&lt; pt.x &lt;&lt;<span class="stringliteral">&quot; Before conversion: Point Y &quot;</span>&lt;&lt; pt.y);</div>
<div class="line"><span class="lineno"> 1328</span> </div>
<div class="line"><span class="lineno"> 1329</span>    PJ_COORD <a class="code hl_variable" href="namespaceprocess__traj__logs.html#a49cd466f330a9498d8373baecf47e071">c</a> {{prev_pt.x + pt.x, prev_pt.y + pt.y, 0, 0}}; <span class="comment">// z is not currently used</span></div>
<div class="line"><span class="lineno"> 1330</span>    PJ_COORD c_out;</div>
<div class="line"><span class="lineno"> 1331</span>    c_out = proj_trans(target_to_map, PJ_FWD, <a class="code hl_variable" href="namespaceprocess__traj__logs.html#a49cd466f330a9498d8373baecf47e071">c</a>);</div>
<div class="line"><span class="lineno"> 1332</span> </div>
<div class="line"><span class="lineno"> 1333</span>    gf_pts.push_back(lanelet::Point3d{<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;pointLayer.uniqueId(), c_out.xyz.x, c_out.xyz.y});</div>
<div class="line"><span class="lineno"> 1334</span>    prev_pt.x += pt.x;</div>
<div class="line"><span class="lineno"> 1335</span>    prev_pt.y += pt.y;</div>
<div class="line"><span class="lineno"> 1336</span> </div>
<div class="line"><span class="lineno"> 1337</span>    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;After conversion in Map frame: Point X &quot;</span>&lt;&lt; gf_pts.back().x() &lt;&lt;<span class="stringliteral">&quot; After conversion: Point Y &quot;</span>&lt;&lt; gf_pts.back().y());</div>
<div class="line"><span class="lineno"> 1338</span>  }</div>
<div class="line"><span class="lineno"> 1339</span>  </div>
<div class="line"><span class="lineno"> 1340</span>  <span class="comment">// save the points converted to local map frame</span></div>
<div class="line"><span class="lineno"> 1341</span>  <span class="keywordflow">return</span> gf_pts;</div>
<div class="line"><span class="lineno"> 1342</span>}</div>
<div class="ttc" id="anamespaceprocess__traj__logs_html_a49cd466f330a9498d8373baecf47e071"><div class="ttname"><a href="namespaceprocess__traj__logs.html#a49cd466f330a9498d8373baecf47e071">process_traj_logs.c</a></div><div class="ttdeci">c</div><div class="ttdef"><b>Definition:</b> <a href="process__traj__logs_8py_source.html#l00166">process_traj_logs.py:166</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMBroadcaster_8hpp_source.html#l00443">base_map_georef_</a>, <a class="el" href="process__traj__logs_8py_source.html#l00166">process_traj_logs::c</a>, and <a class="el" href="WMBroadcaster_8hpp_source.html#l00429">current_map_</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l00262">geofenceFromMsg()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_a44fed247724b501a968aec27479ed58d_icgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_a44fed247724b501a968aec27479ed58d_icgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_a44fed247724b501a968aec27479ed58d_icgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_a44fed247724b501a968aec27479ed58d_icgraph">
<area shape="rect" title="Extract geofence points from geofence message using its given proj and datum fields." alt="" coords="781,5,992,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#af0e373523dc84a409331d01b62d2fce0" title="Fills geofence object from TrafficControlMessageV01 ROS Msg." alt="" coords="523,5,733,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a649174a7a7270df95532cad5131bf4cb" title="Adds a geofence to the current map and publishes the ROS msg." alt="" coords="264,5,475,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a95cb7c60682d7b455a8624534ad94706" title="Constructor." alt="" coords="5,5,216,47"/>
</map>
</div>

</div>
</div>
<a id="addb8a4d7c2bae6f3763833a3c6f6c5dc" name="addb8a4d7c2bae6f3763833a3c6f6c5dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#addb8a4d7c2bae6f3763833a3c6f6c5dc">&#9670;&nbsp;</a></span>getRoute()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">carma_planning_msgs::msg::Route carma_wm_ctrl::WMBroadcaster::getRoute </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the most recently recieved route message. </p>
<dl class="section return"><dt>Returns</dt><dd>The most recent route message. </dd></dl>

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8cpp_source.html#l01627">1627</a> of file <a class="el" href="WMBroadcaster_8cpp_source.html">WMBroadcaster.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1628</span>{</div>
<div class="line"><span class="lineno"> 1629</span>  <span class="keywordflow">return</span> <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a2c67e3708a1f2e191b24bdec5caf2af3">current_route</a>;</div>
<div class="line"><span class="lineno"> 1630</span>}</div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_a2c67e3708a1f2e191b24bdec5caf2af3"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a2c67e3708a1f2e191b24bdec5caf2af3">carma_wm_ctrl::WMBroadcaster::current_route</a></div><div class="ttdeci">carma_planning_msgs::msg::Route current_route</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8hpp_source.html#l00453">WMBroadcaster.hpp:453</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMBroadcaster_8hpp_source.html#l00453">current_route</a>.</p>

</div>
</div>
<a id="a83cf47dec758a15a42d30905a3b9b7b8" name="a83cf47dec758a15a42d30905a3b9b7b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83cf47dec758a15a42d30905a3b9b7b8">&#9670;&nbsp;</a></span>getVehicleParticipationType()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string carma_wm_ctrl::WMBroadcaster::getVehicleParticipationType </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the Vehicle Participation Type object. </p>
<dl class="section return"><dt>Returns</dt><dd>Current Vehicle Participation Type being used in this World Model Instance </dd></dl>

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8cpp_source.html#l01247">1247</a> of file <a class="el" href="WMBroadcaster_8cpp_source.html">WMBroadcaster.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1248</span>{</div>
<div class="line"><span class="lineno"> 1249</span>  <span class="keywordflow">return</span> <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a9d9fd775035c8389502d5185fa890070">participant_</a>;</div>
<div class="line"><span class="lineno"> 1250</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMBroadcaster_8hpp_source.html#l00432">participant_</a>.</p>

</div>
</div>
<a id="ac71c9fdbf27cbfbe3988c3a77d6e7067" name="ac71c9fdbf27cbfbe3988c3a77d6e7067"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac71c9fdbf27cbfbe3988c3a77d6e7067">&#9670;&nbsp;</a></span>invertParticipants()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::string &gt; carma_wm_ctrl::WMBroadcaster::invertParticipants </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>input_participants</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates inverse participants list of the given participants. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">std::vector&lt;std::string&gt;</td><td>participants vector of strings </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8cpp_source.html#l00993">993</a> of file <a class="el" href="WMBroadcaster_8cpp_source.html">WMBroadcaster.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  994</span>{</div>
<div class="line"><span class="lineno">  995</span>  std::vector&lt;std::string&gt; participants;</div>
<div class="line"><span class="lineno">  996</span> </div>
<div class="line"><span class="lineno">  997</span>  <span class="keywordflow">if</span>(std::find(input_participants.begin(),input_participants.end(),lanelet::Participants::Pedestrian ) == input_participants.end()) participants.emplace_back(lanelet::Participants::Pedestrian);</div>
<div class="line"><span class="lineno">  998</span>  <span class="keywordflow">if</span>(std::find(input_participants.begin(),input_participants.end(),lanelet::Participants::Bicycle ) == input_participants.end()) participants.emplace_back(lanelet::Participants::Bicycle);</div>
<div class="line"><span class="lineno">  999</span>  <span class="keywordflow">if</span>(std::find(input_participants.begin(),input_participants.end(),lanelet::Participants::Vehicle ) == input_participants.end())</div>
<div class="line"><span class="lineno"> 1000</span>  {</div>
<div class="line"><span class="lineno"> 1001</span>    <span class="keywordflow">if</span>(std::find(input_participants.begin(),input_participants.end(),lanelet::Participants::VehicleMotorcycle)== input_participants.end()) participants.emplace_back(lanelet::Participants::VehicleMotorcycle);</div>
<div class="line"><span class="lineno"> 1002</span>    <span class="keywordflow">if</span>(std::find(input_participants.begin(),input_participants.end(),lanelet::Participants::VehicleBus)== input_participants.end()) participants.emplace_back(lanelet::Participants::VehicleBus);</div>
<div class="line"><span class="lineno"> 1003</span>    <span class="keywordflow">if</span>(std::find(input_participants.begin(),input_participants.end(),lanelet::Participants::VehicleCar)== input_participants.end()) participants.emplace_back(lanelet::Participants::VehicleCar);</div>
<div class="line"><span class="lineno"> 1004</span>    <span class="keywordflow">if</span>(std::find(input_participants.begin(),input_participants.end(),lanelet::Participants::VehicleTruck)== input_participants.end()) participants.emplace_back(lanelet::Participants::VehicleTruck);</div>
<div class="line"><span class="lineno"> 1005</span>  }</div>
<div class="line"><span class="lineno"> 1006</span>  <span class="keywordflow">return</span>  participants;</div>
<div class="line"><span class="lineno"> 1007</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l00926">addRegionAccessRule()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_ac71c9fdbf27cbfbe3988c3a77d6e7067_icgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_ac71c9fdbf27cbfbe3988c3a77d6e7067_icgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_ac71c9fdbf27cbfbe3988c3a77d6e7067_icgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_ac71c9fdbf27cbfbe3988c3a77d6e7067_icgraph">
<area shape="rect" title="Generates inverse participants list of the given participants." alt="" coords="1299,39,1509,80"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ae34565da1566e777745a92161422404c" title="Adds RegionAccessRule to the map." alt="" coords="1040,39,1251,80"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a12708b289f7f3d8f10c6dc749bf14d65" title="Create workzone geofence. Create diagonal lanelets and a lanelet that houses opposing lane&#39;s trafficl..." alt="" coords="781,8,992,49"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#af0e373523dc84a409331d01b62d2fce0" title="Fills geofence object from TrafficControlMessageV01 ROS Msg." alt="" coords="523,71,733,112"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a5ae3f2086831ebd932e19b2bdfd76405" title="Creates a single workzone geofence (in the vector) that includes all additional lanelets (housing tra..." alt="" coords="523,5,733,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a649174a7a7270df95532cad5131bf4cb" title="Adds a geofence to the current map and publishes the ROS msg." alt="" coords="264,39,475,80"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a95cb7c60682d7b455a8624534ad94706" title="Constructor." alt="" coords="5,39,216,80"/>
</map>
</div>

</div>
</div>
<a id="aa326eab73fe1583c1fa937ed2e38b33f" name="aa326eab73fe1583c1fa937ed2e38b33f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa326eab73fe1583c1fa937ed2e38b33f">&#9670;&nbsp;</a></span>participantsChecker()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::string &gt; carma_wm_ctrl::WMBroadcaster::participantsChecker </td>
          <td>(</td>
          <td class="paramtype">const carma_v2x_msgs::msg::TrafficControlMessageV01 &amp;&#160;</td>
          <td class="paramname"><em>msg_v01</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates participants list. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg_v01</td><td>message type </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8cpp_source.html#l00951">951</a> of file <a class="el" href="WMBroadcaster_8cpp_source.html">WMBroadcaster.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  952</span>{</div>
<div class="line"><span class="lineno">  953</span>  std::vector&lt;std::string&gt; participants;</div>
<div class="line"><span class="lineno">  954</span>  <span class="keywordflow">for</span> (j2735_v2x_msgs::msg::TrafficControlVehClass participant : msg_v01.params.vclasses)</div>
<div class="line"><span class="lineno">  955</span>  {</div>
<div class="line"><span class="lineno">  956</span>    <span class="comment">// Currently j2735_v2x_msgs::msg::TrafficControlVehClass::RAIL is not supported</span></div>
<div class="line"><span class="lineno">  957</span>    <span class="keywordflow">if</span> (participant.vehicle_class == j2735_v2x_msgs::msg::TrafficControlVehClass::ANY)</div>
<div class="line"><span class="lineno">  958</span>    {</div>
<div class="line"><span class="lineno">  959</span>      participants = {lanelet::Participants::Vehicle, lanelet::Participants::Pedestrian, lanelet::Participants::Bicycle};</div>
<div class="line"><span class="lineno">  960</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  961</span>    }</div>
<div class="line"><span class="lineno">  962</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (participant.vehicle_class == j2735_v2x_msgs::msg::TrafficControlVehClass::PEDESTRIAN)</div>
<div class="line"><span class="lineno">  963</span>    {</div>
<div class="line"><span class="lineno">  964</span>      participants.push_back(lanelet::Participants::Pedestrian);</div>
<div class="line"><span class="lineno">  965</span>    }</div>
<div class="line"><span class="lineno">  966</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (participant.vehicle_class == j2735_v2x_msgs::msg::TrafficControlVehClass::BICYCLE)</div>
<div class="line"><span class="lineno">  967</span>    {</div>
<div class="line"><span class="lineno">  968</span>      participants.push_back(lanelet::Participants::Bicycle);</div>
<div class="line"><span class="lineno">  969</span>    }</div>
<div class="line"><span class="lineno">  970</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (participant.vehicle_class == j2735_v2x_msgs::msg::TrafficControlVehClass::MICROMOBILE ||</div>
<div class="line"><span class="lineno">  971</span>              participant.vehicle_class == j2735_v2x_msgs::msg::TrafficControlVehClass::MOTORCYCLE)</div>
<div class="line"><span class="lineno">  972</span>    {</div>
<div class="line"><span class="lineno">  973</span>      participants.push_back(lanelet::Participants::VehicleMotorcycle);</div>
<div class="line"><span class="lineno">  974</span>    }</div>
<div class="line"><span class="lineno">  975</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (participant.vehicle_class == j2735_v2x_msgs::msg::TrafficControlVehClass::BUS)</div>
<div class="line"><span class="lineno">  976</span>    {</div>
<div class="line"><span class="lineno">  977</span>      participants.push_back(lanelet::Participants::VehicleBus);</div>
<div class="line"><span class="lineno">  978</span>    }</div>
<div class="line"><span class="lineno">  979</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (participant.vehicle_class == j2735_v2x_msgs::msg::TrafficControlVehClass::LIGHT_TRUCK_VAN ||</div>
<div class="line"><span class="lineno">  980</span>            participant.vehicle_class == j2735_v2x_msgs::msg::TrafficControlVehClass::PASSENGER_CAR)</div>
<div class="line"><span class="lineno">  981</span>    {</div>
<div class="line"><span class="lineno">  982</span>      participants.push_back(lanelet::Participants::VehicleCar);</div>
<div class="line"><span class="lineno">  983</span>    }</div>
<div class="line"><span class="lineno">  984</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (8&lt;= participant.vehicle_class &amp;&amp; participant.vehicle_class &lt;= 16) <span class="comment">// Truck enum definition range from 8-16 currently</span></div>
<div class="line"><span class="lineno">  985</span>    {</div>
<div class="line"><span class="lineno">  986</span>      participants.push_back(lanelet::Participants::VehicleTruck);</div>
<div class="line"><span class="lineno">  987</span>    }</div>
<div class="line"><span class="lineno">  988</span>  }</div>
<div class="line"><span class="lineno">  989</span>  <span class="comment">// combine to single vehicle type if possible, otherwise pass through</span></div>
<div class="line"><span class="lineno">  990</span>  <span class="keywordflow">return</span>  <a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a2c6c3606e5f4b3c12a984261823c1d71">combineParticipantsToVehicle</a>(participants);</div>
<div class="line"><span class="lineno">  991</span>}</div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_a2c6c3606e5f4b3c12a984261823c1d71"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a2c6c3606e5f4b3c12a984261823c1d71">carma_wm_ctrl::WMBroadcaster::combineParticipantsToVehicle</a></div><div class="ttdeci">std::vector&lt; std::string &gt; combineParticipantsToVehicle(const std::vector&lt; std::string &gt; &amp;input_participants) const</div><div class="ttdoc">Combines a list of the given participants into a single &quot;vehicle&quot; type if participants cover all poss...</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8cpp_source.html#l01009">WMBroadcaster.cpp:1009</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMBroadcaster_8cpp_source.html#l01009">combineParticipantsToVehicle()</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l00880">addPassingControlLineFromMsg()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l00926">addRegionAccessRule()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l00943">addRegionMinimumGap()</a>, and <a class="el" href="WMBroadcaster_8cpp_source.html#l00262">geofenceFromMsg()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_aa326eab73fe1583c1fa937ed2e38b33f_cgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_aa326eab73fe1583c1fa937ed2e38b33f_cgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_aa326eab73fe1583c1fa937ed2e38b33f_cgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_aa326eab73fe1583c1fa937ed2e38b33f_cgraph">
<area shape="rect" title="Generates participants list." alt="" coords="5,5,216,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a2c6c3606e5f4b3c12a984261823c1d71" title="Combines a list of the given participants into a single &quot;vehicle&quot; type if participants cover all poss..." alt="" coords="264,5,475,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_aa326eab73fe1583c1fa937ed2e38b33f_icgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_aa326eab73fe1583c1fa937ed2e38b33f_icgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_aa326eab73fe1583c1fa937ed2e38b33f_icgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_aa326eab73fe1583c1fa937ed2e38b33f_icgraph">
<area shape="rect" title="Generates participants list." alt="" coords="1305,93,1516,135"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a74d10f4f0534115f672f8995f0036b49" title=" " alt="" coords="1040,5,1257,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#af0e373523dc84a409331d01b62d2fce0" title="Fills geofence object from TrafficControlMessageV01 ROS Msg." alt="" coords="781,123,992,164"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ae34565da1566e777745a92161422404c" title="Adds RegionAccessRule to the map." alt="" coords="1043,188,1254,229"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a116928c0070cfa7587c219a6629dadb8" title="Adds Minimum Gap to the map." alt="" coords="1043,123,1254,164"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a649174a7a7270df95532cad5131bf4cb" title="Adds a geofence to the current map and publishes the ROS msg." alt="" coords="264,156,475,197"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a95cb7c60682d7b455a8624534ad94706" title="Constructor." alt="" coords="5,156,216,197"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a12708b289f7f3d8f10c6dc749bf14d65" title="Create workzone geofence. Create diagonal lanelets and a lanelet that houses opposing lane&#39;s trafficl..." alt="" coords="781,188,992,229"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a5ae3f2086831ebd932e19b2bdfd76405" title="Creates a single workzone geofence (in the vector) that includes all additional lanelets (housing tra..." alt="" coords="523,185,733,227"/>
</map>
</div>

</div>
</div>
<a id="adc221f65f0b99586fc8c2ffc97c5feea" name="adc221f65f0b99586fc8c2ffc97c5feea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc221f65f0b99586fc8c2ffc97c5feea">&#9670;&nbsp;</a></span>preprocessWorkzoneGeometry()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void carma_wm_ctrl::WMBroadcaster::preprocessWorkzoneGeometry </td>
          <td>(</td>
          <td class="paramtype">std::unordered_map&lt; uint8_t, std::shared_ptr&lt; <a class="el" href="classcarma__wm__ctrl_1_1Geofence.html">Geofence</a> &gt; &gt;&#160;</td>
          <td class="paramname"><em>work_zone_geofence_cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::shared_ptr&lt; std::vector&lt; lanelet::Lanelet &gt; &gt;&#160;</td>
          <td class="paramname"><em>parallel_llts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::shared_ptr&lt; std::vector&lt; lanelet::Lanelet &gt; &gt;&#160;</td>
          <td class="paramname"><em>opposite_llts</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Preprocess for workzone area. Parallel_llts will have front_parallel and back_parallel lanelets that were created from splitting (if necessary) TAPERRIGHT and OPENRIGHT lanelets. Opposite_llts will have new lanelets split from REVERSE part with same direction as parallel lanelets that connect to diagonal ones. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">work_zone_geofence_cache</td><td><a class="el" href="classcarma__wm__ctrl_1_1Geofence.html" title="An object representing a geofence use for communications with CARMA Cloud.">Geofence</a> map with size of 4 corresponding to CLOSED, TAPERRIGHT, OPENRIGHT, REVERSE TrafficControlMessages. Each should have gf_pts, affected_parts. </td></tr>
    <tr><td class="paramname">parallel_llts</td><td>list holding front_parallel and back_parallel. These are created from splitting old ones in place such that they connect to diagonal ones </td></tr>
    <tr><td class="paramname">opposite_llts</td><td>list holding split and filtered lanelets from REVERSE part that connect to diagonal ones </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">InvalidObjectStateError</td><td>if no map is available NOTE: REVERSE part's geofence points should have same direction as opposite lane's as that is what getAffectedLaneletOrArea requires. </td></tr>
  </table>
  </dd>
</dl>
<p >PARALLEL FRONT (TAPERRIGHT side)</p>
<p >PARALLEL BACK (OPENRIGHT side)</p>
<p >HANDLE MID HERE</p>
<p >OPPOSITE FRONT (OPENRIGHT side)</p>
<p >Fill in the middle part of middle lanelets</p>
<p >OPPOSITE BACK (TAPERRIGHT side)</p>

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8cpp_source.html#l00600">600</a> of file <a class="el" href="WMBroadcaster_8cpp_source.html">WMBroadcaster.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  601</span>{</div>
<div class="line"><span class="lineno">  602</span>  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a> || <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;laneletLayer.size() == 0)</div>
<div class="line"><span class="lineno">  603</span>  {</div>
<div class="line"><span class="lineno">  604</span>    <span class="keywordflow">throw</span> lanelet::InvalidObjectStateError(std::string(<span class="stringliteral">&quot;Base lanelet map is not loaded to the WMBroadcaster&quot;</span>));</div>
<div class="line"><span class="lineno">  605</span>  }</div>
<div class="line"><span class="lineno">  609</span>  std::vector &lt;lanelet::Lanelet&gt; new_taper_right_llts;</div>
<div class="line"><span class="lineno">  610</span>  <span class="keyword">auto</span> taper_right_first_pt = work_zone_geofence_cache[<a class="code hl_variable" href="structcarma__wm__ctrl_1_1WorkZoneSection.html#a132b6a0453690caded522cf9ce8a0a75">WorkZoneSection::TAPERRIGHT</a>]-&gt;gf_pts.front().basicPoint2d();</div>
<div class="line"><span class="lineno">  611</span>  <span class="keyword">auto</span> taper_right_first_llt = <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;laneletLayer.get(work_zone_geofence_cache[<a class="code hl_variable" href="structcarma__wm__ctrl_1_1WorkZoneSection.html#a132b6a0453690caded522cf9ce8a0a75">WorkZoneSection::TAPERRIGHT</a>]-&gt;affected_parts_.front().lanelet().get().id());</div>
<div class="line"><span class="lineno">  612</span> </div>
<div class="line"><span class="lineno">  613</span>  new_taper_right_llts = <a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a883734808f44db2778371ce3fbeecdd3">splitLaneletWithPoint</a>({taper_right_first_pt}, taper_right_first_llt, <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ab5567570e8a54c507f1c55c23f364933">error_distance_</a>);</div>
<div class="line"><span class="lineno">  614</span>  <span class="keywordtype">double</span> check_dist_tpr = lanelet::geometry::distance2d(taper_right_first_llt.centerline2d().front().basicPoint2d(), taper_right_first_pt);</div>
<div class="line"><span class="lineno">  615</span> </div>
<div class="line"><span class="lineno">  616</span>  <span class="comment">// if no splitting happened and taperright&#39;s first point is close to starting boundary, we need to create duplicate of previous lanelet of TAPERRIGHT&#39;s first lanelet</span></div>
<div class="line"><span class="lineno">  617</span>  <span class="comment">// to match the output expected of this function as if split happened</span></div>
<div class="line"><span class="lineno">  618</span>  <span class="keywordflow">if</span> (new_taper_right_llts.size() == 1 &amp;&amp; check_dist_tpr &lt;= <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ab5567570e8a54c507f1c55c23f364933">error_distance_</a>)</div>
<div class="line"><span class="lineno">  619</span>  {</div>
<div class="line"><span class="lineno">  620</span>    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Creating duplicate lanelet of &#39;previous lanelet&#39; due to TAPERRIGHT using entire lanelet...&quot;</span>);</div>
<div class="line"><span class="lineno">  621</span>    <span class="keyword">auto</span> previous_lanelets = <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a4c64c73d83158f9b82682ad3bcc4af74">current_routing_graph_</a>-&gt;previous(work_zone_geofence_cache[<a class="code hl_variable" href="structcarma__wm__ctrl_1_1WorkZoneSection.html#a132b6a0453690caded522cf9ce8a0a75">WorkZoneSection::TAPERRIGHT</a>]-&gt;affected_parts_.front().lanelet().get());</div>
<div class="line"><span class="lineno">  622</span>    <span class="keywordflow">if</span> (previous_lanelets.empty()) <span class="comment">//error if bad match</span></div>
<div class="line"><span class="lineno">  623</span>    {</div>
<div class="line"><span class="lineno">  624</span>      RCLCPP_ERROR_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Workzone area starts from lanelet with no previous lanelet (Id : &quot;</span> &lt;&lt; work_zone_geofence_cache[<a class="code hl_variable" href="structcarma__wm__ctrl_1_1WorkZoneSection.html#a132b6a0453690caded522cf9ce8a0a75">WorkZoneSection::TAPERRIGHT</a>]-&gt;affected_parts_.front().lanelet().get().id()</div>
<div class="line"><span class="lineno">  625</span>                      &lt;&lt; <span class="stringliteral">&quot;. This case is rare and not supported at the moment.&quot;</span>);</div>
<div class="line"><span class="lineno">  626</span>      <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  627</span>    }</div>
<div class="line"><span class="lineno">  628</span> </div>
<div class="line"><span class="lineno">  629</span>    <span class="comment">// get previous lanelet of affected part of TAPERRIGHT (doesn&#39;t matter which previous, as the new lanelet will only be duplicate anyways)</span></div>
<div class="line"><span class="lineno">  630</span>    <span class="keyword">auto</span> prev_lanelet_to_copy  = <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;laneletLayer.get(previous_lanelets.front().id());</div>
<div class="line"><span class="lineno">  631</span> </div>
<div class="line"><span class="lineno">  632</span>    <span class="comment">// parallel_llts will have a copy of `prev_lanelet_to_copy` with new id to be used as part of workzone area</span></div>
<div class="line"><span class="lineno">  633</span>    new_taper_right_llts = <a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a883734808f44db2778371ce3fbeecdd3">splitLaneletWithPoint</a>({prev_lanelet_to_copy.centerline2d().back()}, prev_lanelet_to_copy, <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ab5567570e8a54c507f1c55c23f364933">error_distance_</a>);</div>
<div class="line"><span class="lineno">  634</span>  }</div>
<div class="line"><span class="lineno">  635</span>  parallel_llts-&gt;insert(parallel_llts-&gt;end(), new_taper_right_llts.begin(), new_taper_right_llts.end());</div>
<div class="line"><span class="lineno">  636</span>  RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Finished TAPERRIGHT processing of size: &quot;</span> &lt;&lt; new_taper_right_llts.size());</div>
<div class="line"><span class="lineno">  637</span> </div>
<div class="line"><span class="lineno">  641</span>  std::vector &lt;lanelet::Lanelet&gt; new_open_right_llts;</div>
<div class="line"><span class="lineno">  642</span>  <span class="keyword">auto</span> open_right_last_pt = work_zone_geofence_cache[<a class="code hl_variable" href="structcarma__wm__ctrl_1_1WorkZoneSection.html#ac422b9b0dab0dea3fdf1a8ee4dc64abc">WorkZoneSection::OPENRIGHT</a>]-&gt;gf_pts.back().basicPoint2d();</div>
<div class="line"><span class="lineno">  643</span>  <span class="keyword">auto</span> open_right_last_llt = <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;laneletLayer.get(work_zone_geofence_cache[<a class="code hl_variable" href="structcarma__wm__ctrl_1_1WorkZoneSection.html#ac422b9b0dab0dea3fdf1a8ee4dc64abc">WorkZoneSection::OPENRIGHT</a>]-&gt;affected_parts_.back().lanelet().get().id());</div>
<div class="line"><span class="lineno">  644</span> </div>
<div class="line"><span class="lineno">  645</span>  new_open_right_llts = <a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a883734808f44db2778371ce3fbeecdd3">splitLaneletWithPoint</a>({open_right_last_pt}, open_right_last_llt, <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ab5567570e8a54c507f1c55c23f364933">error_distance_</a>);</div>
<div class="line"><span class="lineno">  646</span>  <span class="keywordtype">double</span> check_dist_opr = lanelet::geometry::distance2d(open_right_last_llt.centerline2d().back().basicPoint2d(), open_right_last_pt);</div>
<div class="line"><span class="lineno">  647</span> </div>
<div class="line"><span class="lineno">  648</span>  <span class="comment">// if no splitting happened, we need to create duplicate of next lanelet of OPENRIGHT&#39;s last lanelet</span></div>
<div class="line"><span class="lineno">  649</span>  <span class="comment">// to match the output expected of this function as if split happened</span></div>
<div class="line"><span class="lineno">  650</span>  <span class="keywordflow">if</span> (new_open_right_llts.size() == 1 &amp;&amp; check_dist_opr &lt;= <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ab5567570e8a54c507f1c55c23f364933">error_distance_</a>) </div>
<div class="line"><span class="lineno">  651</span>  {</div>
<div class="line"><span class="lineno">  652</span>    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Creating duplicate lanelet of &#39;next lanelet&#39; due to OPENRIGHT using entire lanelet...&quot;</span>);</div>
<div class="line"><span class="lineno">  653</span>    <span class="keyword">auto</span> next_lanelets = <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a4c64c73d83158f9b82682ad3bcc4af74">current_routing_graph_</a>-&gt;following(work_zone_geofence_cache[<a class="code hl_variable" href="structcarma__wm__ctrl_1_1WorkZoneSection.html#ac422b9b0dab0dea3fdf1a8ee4dc64abc">WorkZoneSection::OPENRIGHT</a>]-&gt;affected_parts_.back().lanelet().get());</div>
<div class="line"><span class="lineno">  654</span>    <span class="keywordflow">if</span> (next_lanelets.empty()) <span class="comment">//error if bad match</span></div>
<div class="line"><span class="lineno">  655</span>    {</div>
<div class="line"><span class="lineno">  656</span>      RCLCPP_ERROR_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Workzone area ends at lanelet with no following lanelet (Id : &quot;</span> &lt;&lt; work_zone_geofence_cache[<a class="code hl_variable" href="structcarma__wm__ctrl_1_1WorkZoneSection.html#ac422b9b0dab0dea3fdf1a8ee4dc64abc">WorkZoneSection::OPENRIGHT</a>]-&gt;affected_parts_.back().lanelet().get().id()</div>
<div class="line"><span class="lineno">  657</span>                      &lt;&lt; <span class="stringliteral">&quot;. This case is rare and not supported at the moment.&quot;</span>);</div>
<div class="line"><span class="lineno">  658</span>      <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  659</span>    }</div>
<div class="line"><span class="lineno">  660</span>    </div>
<div class="line"><span class="lineno">  661</span>    <span class="comment">// get next lanelet of affected part of OPENRIGHT (doesn&#39;t matter which next, as the new lanelet will only be duplicate anyways)</span></div>
<div class="line"><span class="lineno">  662</span>    <span class="keyword">auto</span> next_lanelet_to_copy  = <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;laneletLayer.get(next_lanelets.front().id());</div>
<div class="line"><span class="lineno">  663</span> </div>
<div class="line"><span class="lineno">  664</span>    <span class="comment">// parallel_llts will have a copy of `next_lanelet_to_copy` with new id to be used as part of workzone area</span></div>
<div class="line"><span class="lineno">  665</span>    new_open_right_llts = <a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a883734808f44db2778371ce3fbeecdd3">splitLaneletWithPoint</a>({next_lanelet_to_copy.centerline2d().back()}, next_lanelet_to_copy, <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ab5567570e8a54c507f1c55c23f364933">error_distance_</a>);</div>
<div class="line"><span class="lineno">  666</span>  }</div>
<div class="line"><span class="lineno">  667</span>  parallel_llts-&gt;insert(parallel_llts-&gt;end(), new_open_right_llts.begin(), new_open_right_llts.end());</div>
<div class="line"><span class="lineno">  668</span>  RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Finished OPENRIGHT processing of size: &quot;</span> &lt;&lt; new_open_right_llts.size());</div>
<div class="line"><span class="lineno">  669</span> </div>
<div class="line"><span class="lineno">  673</span> </div>
<div class="line"><span class="lineno">  674</span>  <span class="keyword">auto</span> reverse_back_llts = <a class="code hl_function" href="namespacecarma__wm_1_1query.html#a8933b74d652e02d07be1170b787d87a2">carma_wm::query::getLaneletsFromPoint</a>(<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>,  work_zone_geofence_cache[<a class="code hl_variable" href="structcarma__wm__ctrl_1_1WorkZoneSection.html#ade4ff9d14cf9c540b8235d25a3fe1b61">WorkZoneSection::REVERSE</a>]-&gt;gf_pts.back().basicPoint2d());</div>
<div class="line"><span class="lineno">  675</span>  <span class="keyword">auto</span> reverse_back_llt = reverse_back_llts[0];</div>
<div class="line"><span class="lineno">  676</span>  <span class="keyword">auto</span> reverse_front_llts = <a class="code hl_function" href="namespacecarma__wm_1_1query.html#a8933b74d652e02d07be1170b787d87a2">carma_wm::query::getLaneletsFromPoint</a>(<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>,  work_zone_geofence_cache[<a class="code hl_variable" href="structcarma__wm__ctrl_1_1WorkZoneSection.html#ade4ff9d14cf9c540b8235d25a3fe1b61">WorkZoneSection::REVERSE</a>]-&gt;gf_pts.front().basicPoint2d());</div>
<div class="line"><span class="lineno">  677</span>  <span class="keyword">auto</span> reverse_front_llt = reverse_front_llts[0];</div>
<div class="line"><span class="lineno">  678</span> </div>
<div class="line"><span class="lineno">  679</span>  <span class="keywordflow">if</span> (reverse_back_llt.id() == reverse_front_llt.id()) <span class="comment">//means there is only 1 middle lanelet, which needs to be split into 3 lanelets</span></div>
<div class="line"><span class="lineno">  680</span>  {</div>
<div class="line"><span class="lineno">  681</span>    std::vector&lt;lanelet::Lanelet&gt; temp_llts;</div>
<div class="line"><span class="lineno">  682</span>    temp_llts = <a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a883734808f44db2778371ce3fbeecdd3">splitLaneletWithPoint</a>({work_zone_geofence_cache[<a class="code hl_variable" href="structcarma__wm__ctrl_1_1WorkZoneSection.html#ade4ff9d14cf9c540b8235d25a3fe1b61">WorkZoneSection::REVERSE</a>]-&gt;gf_pts.front().basicPoint2d(), </div>
<div class="line"><span class="lineno">  683</span>                                          work_zone_geofence_cache[<a class="code hl_variable" href="structcarma__wm__ctrl_1_1WorkZoneSection.html#ade4ff9d14cf9c540b8235d25a3fe1b61">WorkZoneSection::REVERSE</a>]-&gt;gf_pts.back().basicPoint2d()},</div>
<div class="line"><span class="lineno">  684</span>                                          <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;laneletLayer.get(work_zone_geofence_cache[<a class="code hl_variable" href="structcarma__wm__ctrl_1_1WorkZoneSection.html#ade4ff9d14cf9c540b8235d25a3fe1b61">WorkZoneSection::REVERSE</a>]-&gt;affected_parts_.front().lanelet().get().id()), <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ab5567570e8a54c507f1c55c23f364933">error_distance_</a>);</div>
<div class="line"><span class="lineno">  685</span>    </div>
<div class="line"><span class="lineno">  686</span>    <span class="keywordflow">if</span> (temp_llts.size() &lt; 2) <span class="comment">// if there is only 1 lanelet</span></div>
<div class="line"><span class="lineno">  687</span>    {</div>
<div class="line"><span class="lineno">  688</span>      <span class="comment">// we found what we want, so return</span></div>
<div class="line"><span class="lineno">  689</span>      opposite_llts-&gt;insert(opposite_llts-&gt;end(), temp_llts.begin(), temp_llts.end());</div>
<div class="line"><span class="lineno">  690</span>      RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Ended preprocessWorkzoneGeometry with opposite_llts.size()&quot;</span> &lt;&lt; opposite_llts-&gt;size() &lt;&lt; <span class="stringliteral">&quot;, and parallel_llts.size()&quot;</span> &lt;&lt; parallel_llts-&gt;size());</div>
<div class="line"><span class="lineno">  691</span>      <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  692</span>    }</div>
<div class="line"><span class="lineno">  693</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (temp_llts.size() == 2) <span class="comment">// determine which </span></div>
<div class="line"><span class="lineno">  694</span>    {</div>
<div class="line"><span class="lineno">  695</span>      <span class="comment">// back gap is bigger than front&#39;s, we should lose front lanelet from the two</span></div>
<div class="line"><span class="lineno">  696</span>      <span class="keywordflow">if</span> (lanelet::geometry::distance2d(work_zone_geofence_cache[<a class="code hl_variable" href="structcarma__wm__ctrl_1_1WorkZoneSection.html#ade4ff9d14cf9c540b8235d25a3fe1b61">WorkZoneSection::REVERSE</a>]-&gt;gf_pts.back().basicPoint2d(), reverse_front_llt.centerline2d().back().basicPoint2d()) &gt;</div>
<div class="line"><span class="lineno">  697</span>        lanelet::geometry::distance2d(work_zone_geofence_cache[<a class="code hl_variable" href="structcarma__wm__ctrl_1_1WorkZoneSection.html#ade4ff9d14cf9c540b8235d25a3fe1b61">WorkZoneSection::REVERSE</a>]-&gt;gf_pts.front().basicPoint2d(), reverse_front_llt.centerline2d().front().basicPoint2d()))</div>
<div class="line"><span class="lineno">  698</span>        {</div>
<div class="line"><span class="lineno">  699</span>          opposite_llts-&gt;push_back(temp_llts.back());</div>
<div class="line"><span class="lineno">  700</span>        }</div>
<div class="line"><span class="lineno">  701</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  702</span>        {</div>
<div class="line"><span class="lineno">  703</span>          opposite_llts-&gt;push_back(temp_llts.front());</div>
<div class="line"><span class="lineno">  704</span>        }</div>
<div class="line"><span class="lineno">  705</span>    }</div>
<div class="line"><span class="lineno">  706</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (temp_llts.size() == 3) <span class="comment">// leave only middle lanelets from 3</span></div>
<div class="line"><span class="lineno">  707</span>    {</div>
<div class="line"><span class="lineno">  708</span>      opposite_llts-&gt;insert(opposite_llts-&gt;end(), temp_llts.begin() + 1, temp_llts.end()- 1);</div>
<div class="line"><span class="lineno">  709</span>    }</div>
<div class="line"><span class="lineno">  710</span>    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Finished REVERSE processing of size: &quot;</span> &lt;&lt; opposite_llts-&gt;size() &lt;&lt; <span class="stringliteral">&quot; from original of 1 REVERSE lanelet size&quot;</span>);</div>
<div class="line"><span class="lineno">  711</span>  }</div>
<div class="line"><span class="lineno">  712</span>  <span class="keywordflow">else</span> <span class="comment">//if there are two or more lanelets</span></div>
<div class="line"><span class="lineno">  713</span>  {</div>
<div class="line"><span class="lineno">  715</span>    <span class="keyword">auto</span> reverse_first_pt = work_zone_geofence_cache[<a class="code hl_variable" href="structcarma__wm__ctrl_1_1WorkZoneSection.html#ade4ff9d14cf9c540b8235d25a3fe1b61">WorkZoneSection::REVERSE</a>]-&gt;gf_pts.front().basicPoint2d();</div>
<div class="line"><span class="lineno">  716</span>    <span class="keyword">auto</span> reverse_first_llt = <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;laneletLayer.get(work_zone_geofence_cache[<a class="code hl_variable" href="structcarma__wm__ctrl_1_1WorkZoneSection.html#ade4ff9d14cf9c540b8235d25a3fe1b61">WorkZoneSection::REVERSE</a>]-&gt;affected_parts_.front().lanelet().get().id());</div>
<div class="line"><span class="lineno">  717</span>    std::vector&lt;lanelet::Lanelet&gt; temp_opposite_front_llts;</div>
<div class="line"><span class="lineno">  718</span>    temp_opposite_front_llts = <a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a883734808f44db2778371ce3fbeecdd3">splitLaneletWithPoint</a>( {reverse_first_pt}, reverse_first_llt, <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ab5567570e8a54c507f1c55c23f364933">error_distance_</a>);</div>
<div class="line"><span class="lineno">  719</span>    <span class="keywordflow">if</span> (temp_opposite_front_llts.size() &gt; 1)</div>
<div class="line"><span class="lineno">  720</span>    {</div>
<div class="line"><span class="lineno">  721</span>      opposite_llts-&gt;insert(opposite_llts-&gt;end(), temp_opposite_front_llts.begin() + 1, temp_opposite_front_llts.end());</div>
<div class="line"><span class="lineno">  722</span>    }</div>
<div class="line"><span class="lineno">  723</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  724</span>    {</div>
<div class="line"><span class="lineno">  725</span>      opposite_llts-&gt;insert(opposite_llts-&gt;end(), temp_opposite_front_llts.begin(), temp_opposite_front_llts.end());</div>
<div class="line"><span class="lineno">  726</span>    }</div>
<div class="line"><span class="lineno">  728</span>    <span class="keywordflow">if</span> (work_zone_geofence_cache[<a class="code hl_variable" href="structcarma__wm__ctrl_1_1WorkZoneSection.html#ade4ff9d14cf9c540b8235d25a3fe1b61">WorkZoneSection::REVERSE</a>]-&gt;affected_parts_.size() &gt; 2)</div>
<div class="line"><span class="lineno">  729</span>    {</div>
<div class="line"><span class="lineno">  730</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> = 1; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> &lt;  work_zone_geofence_cache[<a class="code hl_variable" href="structcarma__wm__ctrl_1_1WorkZoneSection.html#ade4ff9d14cf9c540b8235d25a3fe1b61">WorkZoneSection::REVERSE</a>]-&gt;affected_parts_.size() - 1; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> ++)</div>
<div class="line"><span class="lineno">  731</span>      {</div>
<div class="line"><span class="lineno">  732</span>        opposite_llts-&gt;push_back(<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;laneletLayer.get(work_zone_geofence_cache[<a class="code hl_variable" href="structcarma__wm__ctrl_1_1WorkZoneSection.html#ade4ff9d14cf9c540b8235d25a3fe1b61">WorkZoneSection::REVERSE</a>]-&gt;affected_parts_[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>].id()));</div>
<div class="line"><span class="lineno">  733</span>      }</div>
<div class="line"><span class="lineno">  734</span>    }</div>
<div class="line"><span class="lineno">  736</span>    </div>
<div class="line"><span class="lineno">  737</span>    <span class="keyword">auto</span> reverse_last_pt = work_zone_geofence_cache[<a class="code hl_variable" href="structcarma__wm__ctrl_1_1WorkZoneSection.html#ade4ff9d14cf9c540b8235d25a3fe1b61">WorkZoneSection::REVERSE</a>]-&gt;gf_pts.back().basicPoint2d();</div>
<div class="line"><span class="lineno">  738</span>    <span class="keyword">auto</span> reverse_last_llt = <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;laneletLayer.get(work_zone_geofence_cache[<a class="code hl_variable" href="structcarma__wm__ctrl_1_1WorkZoneSection.html#ade4ff9d14cf9c540b8235d25a3fe1b61">WorkZoneSection::REVERSE</a>]-&gt;affected_parts_.back().lanelet().get().id());</div>
<div class="line"><span class="lineno">  739</span>    std::vector&lt;lanelet::Lanelet&gt; temp_opposite_back_llts;</div>
<div class="line"><span class="lineno">  740</span>    temp_opposite_back_llts = <a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a883734808f44db2778371ce3fbeecdd3">splitLaneletWithPoint</a>({reverse_last_pt}, reverse_last_llt, <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ab5567570e8a54c507f1c55c23f364933">error_distance_</a>);</div>
<div class="line"><span class="lineno">  741</span>    <span class="keywordflow">if</span> (temp_opposite_back_llts.size() &gt; 1)</div>
<div class="line"><span class="lineno">  742</span>    {</div>
<div class="line"><span class="lineno">  743</span>      opposite_llts-&gt;insert(opposite_llts-&gt;end(), temp_opposite_back_llts.begin(), temp_opposite_back_llts.end()- 1);</div>
<div class="line"><span class="lineno">  744</span>    }</div>
<div class="line"><span class="lineno">  745</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  746</span>    {</div>
<div class="line"><span class="lineno">  747</span>      opposite_llts-&gt;insert(opposite_llts-&gt;end(), temp_opposite_back_llts.begin(), temp_opposite_back_llts.end());</div>
<div class="line"><span class="lineno">  748</span>    }</div>
<div class="line"><span class="lineno">  749</span>    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Finished REVERSE processing of size: &quot;</span> &lt;&lt; opposite_llts-&gt;size() &lt;&lt; <span class="stringliteral">&quot; from original of more than one REVERSE lanelet size&quot;</span>);</div>
<div class="line"><span class="lineno">  750</span>  }</div>
<div class="line"><span class="lineno">  751</span> </div>
<div class="line"><span class="lineno">  752</span>  RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Ended preprocessWorkzoneGeometry with opposite_llts.size()&quot;</span> &lt;&lt; opposite_llts-&gt;size() &lt;&lt; <span class="stringliteral">&quot;, and parallel_llts.size()&quot;</span> &lt;&lt; parallel_llts-&gt;size());</div>
<div class="line"><span class="lineno">  753</span>}</div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_a883734808f44db2778371ce3fbeecdd3"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a883734808f44db2778371ce3fbeecdd3">carma_wm_ctrl::WMBroadcaster::splitLaneletWithPoint</a></div><div class="ttdeci">std::vector&lt; lanelet::Lanelet &gt; splitLaneletWithPoint(const std::vector&lt; lanelet::BasicPoint2d &gt; &amp;input_pts, const lanelet::Lanelet &amp;input_llt, double error_distance)</div><div class="ttdoc">Split given lanelet with same proportion as the given points' downtrack relative to the lanelet....</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8cpp_source.html#l00755">WMBroadcaster.cpp:755</a></div></div>
<div class="ttc" id="anamespacecarma__wm_1_1query_html_a8933b74d652e02d07be1170b787d87a2"><div class="ttname"><a href="namespacecarma__wm_1_1query.html#a8933b74d652e02d07be1170b787d87a2">carma_wm::query::getLaneletsFromPoint</a></div><div class="ttdeci">std::vector&lt; lanelet::ConstLanelet &gt; getLaneletsFromPoint(const lanelet::LaneletMapConstPtr &amp;semantic_map, const lanelet::BasicPoint2d &amp;point, const unsigned int n=10)</div><div class="ttdoc">carma_wm::query namespace contains implementations for query functions (input and output read or writ...</div><div class="ttdef"><b>Definition:</b> <a href="WorldModelUtils_8cpp_source.html#l00024">WorldModelUtils.cpp:24</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMBroadcaster_8hpp_source.html#l00429">current_map_</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00430">current_routing_graph_</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00409">error_distance_</a>, <a class="el" href="WorldModelUtils_8cpp_source.html#l00024">carma_wm::query::getLaneletsFromPoint()</a>, <a class="el" href="process__bag_8py_source.html#l00059">process_bag::i</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00062">carma_wm_ctrl::WorkZoneSection::OPENRIGHT</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00062">carma_wm_ctrl::WorkZoneSection::REVERSE</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l00755">splitLaneletWithPoint()</a>, and <a class="el" href="WMBroadcaster_8hpp_source.html#l00062">carma_wm_ctrl::WorkZoneSection::TAPERRIGHT</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l00393">createWorkzoneGeofence()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_adc221f65f0b99586fc8c2ffc97c5feea_cgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_adc221f65f0b99586fc8c2ffc97c5feea_cgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_adc221f65f0b99586fc8c2ffc97c5feea_cgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_adc221f65f0b99586fc8c2ffc97c5feea_cgraph">
<area shape="rect" title="Preprocess for workzone area. Parallel_llts will have front_parallel and back_parallel lanelets that ..." alt="" coords="5,39,216,80"/>
<area shape="rect" href="namespacecarma__wm_1_1query.html#a8933b74d652e02d07be1170b787d87a2" title="carma_wm::query namespace contains implementations for query functions (input and output read or writ..." alt="" coords="271,5,468,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a883734808f44db2778371ce3fbeecdd3" title="Split given lanelet with same proportion as the given points&#39; downtrack relative to the lanelet...." alt="" coords="264,71,475,112"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a1dfc2ec5be906966916939c75874cbab" title="Split given lanelet with given downtrack ratios relative to the lanelet. Newly created lanelet will h..." alt="" coords="523,37,733,79"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#aebce986f21c117983313292d5e82b50a" title="Returns the TrackPos, computed in 2d, of the provided point relative to the centerline of the provide..." alt="" coords="555,103,701,144"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#ab675b2b8862a2ba9c139a8b5b353b846" title="Get the TrackPos of the provided point along the linestring and the segment of the line string which ..." alt="" coords="781,103,927,144"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#ae0a06818149f7430fee80e295ef04548" title="Helper function to identify whether to select the preceeding or succeeding segment of a linstring poi..." alt="" coords="975,103,1120,144"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_adc221f65f0b99586fc8c2ffc97c5feea_icgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_adc221f65f0b99586fc8c2ffc97c5feea_icgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_adc221f65f0b99586fc8c2ffc97c5feea_icgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_adc221f65f0b99586fc8c2ffc97c5feea_icgraph">
<area shape="rect" title="Preprocess for workzone area. Parallel_llts will have front_parallel and back_parallel lanelets that ..." alt="" coords="781,5,992,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a5ae3f2086831ebd932e19b2bdfd76405" title="Creates a single workzone geofence (in the vector) that includes all additional lanelets (housing tra..." alt="" coords="523,5,733,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a649174a7a7270df95532cad5131bf4cb" title="Adds a geofence to the current map and publishes the ROS msg." alt="" coords="264,5,475,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a95cb7c60682d7b455a8624534ad94706" title="Constructor." alt="" coords="5,5,216,47"/>
</map>
</div>

</div>
</div>
<a id="a0bd681a01c6f93dba31882b370a87aef" name="a0bd681a01c6f93dba31882b370a87aef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0bd681a01c6f93dba31882b370a87aef">&#9670;&nbsp;</a></span>publishLightId()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void carma_wm_ctrl::WMBroadcaster::publishLightId </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>helps to populate upcoming_intersection_ids_ from local traffic lanelet ids </p>

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8cpp_source.html#l01971">1971</a> of file <a class="el" href="WMBroadcaster_8cpp_source.html">WMBroadcaster.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1972</span>{</div>
<div class="line"><span class="lineno"> 1973</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aa03b08ee979d7a4cfd7577280374b97e">traffic_light_id_lookup_</a>.empty())</div>
<div class="line"><span class="lineno"> 1974</span>  {</div>
<div class="line"><span class="lineno"> 1975</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1976</span>  }</div>
<div class="line"><span class="lineno"> 1977</span>  <span class="keywordflow">for</span>(<span class="keyword">auto</span> <span class="keywordtype">id</span> : <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a2c67e3708a1f2e191b24bdec5caf2af3">current_route</a>.route_path_lanelet_ids) </div>
<div class="line"><span class="lineno"> 1978</span>  {</div>
<div class="line"><span class="lineno"> 1979</span>    <span class="keywordtype">bool</span> convert_success = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1980</span>    <span class="keywordtype">unsigned</span> intersection_id = 0;</div>
<div class="line"><span class="lineno"> 1981</span>    <span class="keywordtype">unsigned</span> group_id = 0;</div>
<div class="line"><span class="lineno"> 1982</span>    <span class="keyword">auto</span> route_lanelet= <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;laneletLayer.get(<span class="keywordtype">id</span>);</div>
<div class="line"><span class="lineno"> 1983</span>    <span class="keyword">auto</span> traffic_lights = route_lanelet.regulatoryElementsAs&lt;lanelet::CarmaTrafficSignal&gt;();</div>
<div class="line"><span class="lineno"> 1984</span>    </div>
<div class="line"><span class="lineno"> 1985</span>    <span class="keywordflow">if</span> (!traffic_lights.empty())</div>
<div class="line"><span class="lineno"> 1986</span>    {</div>
<div class="line"><span class="lineno"> 1987</span>      RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Found Traffic Light Regulatory Element id: &quot;</span> &lt;&lt; traffic_lights.front()-&gt;id());</div>
<div class="line"><span class="lineno"> 1988</span>      convert_success = <a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a4b5b09f05f4f3ed3a6d5027328f687a3">convertLightIdToInterGroupId</a>(intersection_id,group_id,  traffic_lights.front()-&gt;id());</div>
<div class="line"><span class="lineno"> 1989</span>    }</div>
<div class="line"><span class="lineno"> 1990</span> </div>
<div class="line"><span class="lineno"> 1991</span>    <span class="keywordflow">if</span> (!convert_success)</div>
<div class="line"><span class="lineno"> 1992</span>        <span class="keywordflow">continue</span>; </div>
<div class="line"><span class="lineno"> 1993</span> </div>
<div class="line"><span class="lineno"> 1994</span>    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Found Traffic Light with Intersection id: &quot;</span> &lt;&lt; intersection_id &lt;&lt; <span class="stringliteral">&quot; Group id:&quot;</span> &lt;&lt; group_id);</div>
<div class="line"><span class="lineno"> 1995</span>    <span class="keywordtype">bool</span> id_exists = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1996</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> idx = 0; idx &lt; <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a9976591578b2eb031c24c9f63f9c3051">upcoming_intersection_ids_</a>.data.size(); idx +2)</div>
<div class="line"><span class="lineno"> 1997</span>    {</div>
<div class="line"><span class="lineno"> 1998</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a9976591578b2eb031c24c9f63f9c3051">upcoming_intersection_ids_</a>.data[idx] == intersection_id &amp;&amp; <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a9976591578b2eb031c24c9f63f9c3051">upcoming_intersection_ids_</a>.data[idx + 1] == group_id) <span class="comment">//check if already there</span></div>
<div class="line"><span class="lineno"> 1999</span>      {</div>
<div class="line"><span class="lineno"> 2000</span>        id_exists = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2001</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2002</span>      }</div>
<div class="line"><span class="lineno"> 2003</span>    }</div>
<div class="line"><span class="lineno"> 2004</span> </div>
<div class="line"><span class="lineno"> 2005</span>    <span class="keywordflow">if</span> (id_exists)</div>
<div class="line"><span class="lineno"> 2006</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2007</span> </div>
<div class="line"><span class="lineno"> 2008</span>    <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a9976591578b2eb031c24c9f63f9c3051">upcoming_intersection_ids_</a>.data.push_back(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(intersection_id));</div>
<div class="line"><span class="lineno"> 2009</span>    <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a9976591578b2eb031c24c9f63f9c3051">upcoming_intersection_ids_</a>.data.push_back(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(group_id));</div>
<div class="line"><span class="lineno"> 2010</span>  }</div>
<div class="line"><span class="lineno"> 2011</span>}</div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_a4b5b09f05f4f3ed3a6d5027328f687a3"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a4b5b09f05f4f3ed3a6d5027328f687a3">carma_wm_ctrl::WMBroadcaster::convertLightIdToInterGroupId</a></div><div class="ttdeci">bool convertLightIdToInterGroupId(unsigned &amp;intersection_id, unsigned &amp;group_id, const lanelet::Id &amp;lanelet_id)</div><div class="ttdoc">helper for generating intersection and group Id of a traffic light from lanelet id</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8cpp_source.html#l01956">WMBroadcaster.cpp:1956</a></div></div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_a9976591578b2eb031c24c9f63f9c3051"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a9976591578b2eb031c24c9f63f9c3051">carma_wm_ctrl::WMBroadcaster::upcoming_intersection_ids_</a></div><div class="ttdeci">std_msgs::msg::Int32MultiArray upcoming_intersection_ids_</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8hpp_source.html#l00406">WMBroadcaster.hpp:406</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMBroadcaster_8cpp_source.html#l01956">convertLightIdToInterGroupId()</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00429">current_map_</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00453">current_route</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00413">traffic_light_id_lookup_</a>, and <a class="el" href="WMBroadcaster_8hpp_source.html#l00406">upcoming_intersection_ids_</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_a0bd681a01c6f93dba31882b370a87aef_cgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_a0bd681a01c6f93dba31882b370a87aef_cgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_a0bd681a01c6f93dba31882b370a87aef_cgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_a0bd681a01c6f93dba31882b370a87aef_cgraph">
<area shape="rect" title="helps to populate upcoming_intersection_ids_ from local traffic lanelet ids" alt="" coords="5,5,216,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a4b5b09f05f4f3ed3a6d5027328f687a3" title="helper for generating intersection and group Id of a traffic light from lanelet id" alt="" coords="264,5,475,47"/>
</map>
</div>

</div>
</div>
<a id="acc8891ed0c1949e44412537e7c904f4c" name="acc8891ed0c1949e44412537e7c904f4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc8891ed0c1949e44412537e7c904f4c">&#9670;&nbsp;</a></span>pubTCMACK()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void carma_wm_ctrl::WMBroadcaster::pubTCMACK </td>
          <td>(</td>
          <td class="paramtype">j2735_v2x_msgs::msg::Id64b&#160;</td>
          <td class="paramname"><em>tcm_req_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>msgnum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ack_status</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>ack_reason</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Construct TCM acknowledgement object and populate it with params. Publish the object for a configured number of times. </p>

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8cpp_source.html#l02262">2262</a> of file <a class="el" href="WMBroadcaster_8cpp_source.html">WMBroadcaster.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2263</span>{</div>
<div class="line"><span class="lineno"> 2264</span>  carma_v2x_msgs::msg::MobilityOperation mom_msg;</div>
<div class="line"><span class="lineno"> 2265</span>  mom_msg.m_header.timestamp = <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#abbf8a6885fb83de6bdf0241ef3e1401f">scheduler_</a>.<a class="code hl_function" href="classcarma__wm__ctrl_1_1GeofenceScheduler.html#a645ff72ccf3e3b7f6a529debf7a172a2">now</a>().nanoseconds()/1000000;</div>
<div class="line"><span class="lineno"> 2266</span>  mom_msg.m_header.sender_id = <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ac34bbb28c302480f2876f0946105cbd6">vehicle_id_</a>;</div>
<div class="line"><span class="lineno"> 2267</span>  mom_msg.strategy = <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a229cd9488710003a3f7da5be95ce9f4f">geofence_ack_strategy_</a>;</div>
<div class="line"><span class="lineno"> 2268</span>  std::stringstream ss;</div>
<div class="line"><span class="lineno"> 2269</span>  <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>=0; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> &lt; tcm_req_id.id.size(); <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>++)</div>
<div class="line"><span class="lineno"> 2270</span>  {</div>
<div class="line"><span class="lineno"> 2271</span>    ss &lt;&lt; std::setfill(<span class="charliteral">&#39;0&#39;</span>) &lt;&lt; std::setw(2) &lt;&lt; std::hex &lt;&lt; (unsigned) tcm_req_id.id.at(<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>);</div>
<div class="line"><span class="lineno"> 2272</span>  }</div>
<div class="line"><span class="lineno"> 2273</span>    std::string tcmv01_req_id_hex = ss.str();   </div>
<div class="line"><span class="lineno"> 2274</span>  ss.str(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno"> 2275</span>  ss &lt;&lt; <span class="stringliteral">&quot;traffic_control_id:&quot;</span> &lt;&lt; tcmv01_req_id_hex &lt;&lt; <span class="stringliteral">&quot;, msgnum:&quot;</span>&lt;&lt; msgnum &lt;&lt; <span class="stringliteral">&quot;, acknowledgement:&quot;</span> &lt;&lt; ack_status &lt;&lt; <span class="stringliteral">&quot;, reason:&quot;</span> &lt;&lt; ack_reason;</div>
<div class="line"><span class="lineno"> 2276</span>  mom_msg.strategy_params = ss.str();</div>
<div class="line"><span class="lineno"> 2277</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> = 0; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> &lt; <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a19e428bc63bdb7eef768738e08af92ac">ack_pub_times_</a>; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>++)</div>
<div class="line"><span class="lineno"> 2278</span>  {</div>
<div class="line"><span class="lineno"> 2279</span>    <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a96fcd16e9d674a448e5a46a08c3a3b64">tcm_ack_pub_</a>(mom_msg);</div>
<div class="line"><span class="lineno"> 2280</span>  }</div>
<div class="line"><span class="lineno"> 2281</span>}</div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1GeofenceScheduler_html_a645ff72ccf3e3b7f6a529debf7a172a2"><div class="ttname"><a href="classcarma__wm__ctrl_1_1GeofenceScheduler.html#a645ff72ccf3e3b7f6a529debf7a172a2">carma_wm_ctrl::GeofenceScheduler::now</a></div><div class="ttdeci">rclcpp::Time now()</div><div class="ttdoc">Get current time used by scheduler.</div><div class="ttdef"><b>Definition:</b> <a href="GeofenceScheduler_8cpp_source.html#l00032">GeofenceScheduler.cpp:32</a></div></div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_a19e428bc63bdb7eef768738e08af92ac"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a19e428bc63bdb7eef768738e08af92ac">carma_wm_ctrl::WMBroadcaster::ack_pub_times_</a></div><div class="ttdeci">int ack_pub_times_</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8hpp_source.html#l00470">WMBroadcaster.hpp:470</a></div></div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_a229cd9488710003a3f7da5be95ce9f4f"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a229cd9488710003a3f7da5be95ce9f4f">carma_wm_ctrl::WMBroadcaster::geofence_ack_strategy_</a></div><div class="ttdeci">const std::string geofence_ack_strategy_</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8hpp_source.html#l00469">WMBroadcaster.hpp:469</a></div></div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_ac34bbb28c302480f2876f0946105cbd6"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ac34bbb28c302480f2876f0946105cbd6">carma_wm_ctrl::WMBroadcaster::vehicle_id_</a></div><div class="ttdeci">std::string vehicle_id_</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8hpp_source.html#l00471">WMBroadcaster.hpp:471</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMBroadcaster_8hpp_source.html#l00470">ack_pub_times_</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00469">geofence_ack_strategy_</a>, <a class="el" href="process__bag_8py_source.html#l00059">process_bag::i</a>, <a class="el" href="GeofenceScheduler_8cpp_source.html#l00032">carma_wm_ctrl::GeofenceScheduler::now()</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00441">scheduler_</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00442">tcm_ack_pub_</a>, and <a class="el" href="WMBroadcaster_8hpp_source.html#l00471">vehicle_id_</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l01077">geofenceCallback()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_acc8891ed0c1949e44412537e7c904f4c_cgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_acc8891ed0c1949e44412537e7c904f4c_cgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_acc8891ed0c1949e44412537e7c904f4c_cgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_acc8891ed0c1949e44412537e7c904f4c_cgraph">
<area shape="rect" title="Construct TCM acknowledgement object and populate it with params. Publish the object for a configured..." alt="" coords="5,5,216,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1GeofenceScheduler.html#a645ff72ccf3e3b7f6a529debf7a172a2" title="Get current time used by scheduler." alt="" coords="264,13,525,39"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_acc8891ed0c1949e44412537e7c904f4c_icgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_acc8891ed0c1949e44412537e7c904f4c_icgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_acc8891ed0c1949e44412537e7c904f4c_icgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_acc8891ed0c1949e44412537e7c904f4c_icgraph">
<area shape="rect" title="Construct TCM acknowledgement object and populate it with params. Publish the object for a configured..." alt="" coords="523,5,733,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a63a919c2cf6736a80fa29a706b020330" title="Callback to add a geofence to the map. Currently only supports version 1 TrafficControlMessage." alt="" coords="264,5,475,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcasterNode.html#ab0c14f6d7e30870755a4dcf6b228de82" title=" " alt="" coords="5,5,216,47"/>
</map>
</div>

</div>
</div>
<a id="a3751e2e2dc4455fc7e3e80f1ae2c672e" name="a3751e2e2dc4455fc7e3e80f1ae2c672e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3751e2e2dc4455fc7e3e80f1ae2c672e">&#9670;&nbsp;</a></span>removeGeofence()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void carma_wm_ctrl::WMBroadcaster::removeGeofence </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classcarma__wm__ctrl_1_1Geofence.html">Geofence</a> &gt;&#160;</td>
          <td class="paramname"><em>gf_ptr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Removes a geofence from the current map and publishes the ROS msg. </p>

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8cpp_source.html#l01578">1578</a> of file <a class="el" href="WMBroadcaster_8cpp_source.html">WMBroadcaster.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1579</span>{</div>
<div class="line"><span class="lineno"> 1580</span>  std::lock_guard&lt;std::mutex&gt; guard(<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a1ac51e0b0b57eda669c87372bd079ede">map_mutex_</a>);</div>
<div class="line"><span class="lineno"> 1581</span>  RCLCPP_INFO_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Removing inactive geofence from the map with geofence id: &quot;</span> &lt;&lt; gf_ptr-&gt;id_);</div>
<div class="line"><span class="lineno"> 1582</span>  </div>
<div class="line"><span class="lineno"> 1583</span>  <span class="comment">// Process the geofence object to populate update remove lists</span></div>
<div class="line"><span class="lineno"> 1584</span>  <span class="keywordflow">if</span> (gf_ptr-&gt;affected_parts_.empty())</div>
<div class="line"><span class="lineno"> 1585</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1586</span> </div>
<div class="line"><span class="lineno"> 1587</span>  <a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a0a119e3571ef94545fc979ca3190c5f1">removeGeofenceHelper</a>(gf_ptr);</div>
<div class="line"><span class="lineno"> 1588</span> </div>
<div class="line"><span class="lineno"> 1589</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> pair : gf_ptr-&gt;remove_list_) <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a9f7ae45f954ed5f177756a56b9387545">active_geofence_llt_ids_</a>.erase(pair.first);</div>
<div class="line"><span class="lineno"> 1590</span> </div>
<div class="line"><span class="lineno"> 1591</span>  <span class="comment">// publish</span></div>
<div class="line"><span class="lineno"> 1592</span>  autoware_lanelet2_msgs::msg::MapBin gf_msg_revert;</div>
<div class="line"><span class="lineno"> 1593</span>  <span class="keyword">auto</span> send_data = std::make_shared&lt;carma_wm::TrafficControl&gt;(<a class="code hl_class" href="classcarma__wm_1_1TrafficControl.html">carma_wm::TrafficControl</a>(gf_ptr-&gt;id_, gf_ptr-&gt;update_list_, gf_ptr-&gt;remove_list_, {}));</div>
<div class="line"><span class="lineno"> 1594</span> </div>
<div class="line"><span class="lineno"> 1595</span>  <span class="keywordflow">if</span> (gf_ptr-&gt;invalidate_route_) { <span class="comment">// If a geofence initially invalidated the route it stands to reason its removal should as well</span></div>
<div class="line"><span class="lineno"> 1596</span> </div>
<div class="line"><span class="lineno"> 1597</span>    RCLCPP_INFO_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Rebuilding routing graph after is was invalidated by geofence removal&quot;</span>);</div>
<div class="line"><span class="lineno"> 1598</span> </div>
<div class="line"><span class="lineno"> 1599</span>    lanelet::traffic_rules::TrafficRulesUPtr traffic_rules_car = lanelet::traffic_rules::TrafficRulesFactory::create(</div>
<div class="line"><span class="lineno"> 1600</span>      lanelet::traffic_rules::CarmaUSTrafficRules::Location, <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a9d9fd775035c8389502d5185fa890070">participant_</a></div>
<div class="line"><span class="lineno"> 1601</span>    );</div>
<div class="line"><span class="lineno"> 1602</span>    <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a4c64c73d83158f9b82682ad3bcc4af74">current_routing_graph_</a> = lanelet::routing::RoutingGraph::build(*<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>, *traffic_rules_car);</div>
<div class="line"><span class="lineno"> 1603</span> </div>
<div class="line"><span class="lineno"> 1604</span>    RCLCPP_INFO_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Done rebuilding routing graph after is was invalidated by geofence removal&quot;</span>);</div>
<div class="line"><span class="lineno"> 1605</span> </div>
<div class="line"><span class="lineno"> 1606</span>    <span class="comment">// Populate routing graph structure</span></div>
<div class="line"><span class="lineno"> 1607</span>    RCLCPP_INFO_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Creating routing graph message for geofence removal&quot;</span>);</div>
<div class="line"><span class="lineno"> 1608</span> </div>
<div class="line"><span class="lineno"> 1609</span>    <span class="keyword">auto</span> readable_graph = std::static_pointer_cast&lt;RoutingGraphAccessor&gt;(<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a4c64c73d83158f9b82682ad3bcc4af74">current_routing_graph_</a>);</div>
<div class="line"><span class="lineno"> 1610</span> </div>
<div class="line"><span class="lineno"> 1611</span>    gf_msg_revert.routing_graph = readable_graph-&gt;routingGraphToMsg(<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a9d9fd775035c8389502d5185fa890070">participant_</a>);</div>
<div class="line"><span class="lineno"> 1612</span>    gf_msg_revert.has_routing_graph = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1613</span> </div>
<div class="line"><span class="lineno"> 1614</span>    RCLCPP_INFO_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Done creating routing graph message for geofence removal&quot;</span>);</div>
<div class="line"><span class="lineno"> 1615</span>  }</div>
<div class="line"><span class="lineno"> 1616</span>  </div>
<div class="line"><span class="lineno"> 1617</span>  <a class="code hl_function" href="namespacecarma__wm.html#aef665263f7df5afa3781f4319fe95e9c">carma_wm::toBinMsg</a>(send_data, &amp;gf_msg_revert);</div>
<div class="line"><span class="lineno"> 1618</span>  <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a644d3ebd9dd0e50b9152e965fd9f0721">update_count_</a>++; <span class="comment">// Update the sequence count for geofence messages</span></div>
<div class="line"><span class="lineno"> 1619</span>  gf_msg_revert.seq_id = <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a644d3ebd9dd0e50b9152e965fd9f0721">update_count_</a>;</div>
<div class="line"><span class="lineno"> 1620</span>  gf_msg_revert.map_version = <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ab963fffc1b41395dd3393aee9b3e88e4">current_map_version_</a>;</div>
<div class="line"><span class="lineno"> 1621</span> </div>
<div class="line"><span class="lineno"> 1622</span>  <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aee1d8ad2f6c7865da16ea7f40140b04a">map_update_pub_</a>(gf_msg_revert);</div>
<div class="line"><span class="lineno"> 1623</span> </div>
<div class="line"><span class="lineno"> 1624</span> </div>
<div class="line"><span class="lineno"> 1625</span>}</div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_a0a119e3571ef94545fc979ca3190c5f1"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a0a119e3571ef94545fc979ca3190c5f1">carma_wm_ctrl::WMBroadcaster::removeGeofenceHelper</a></div><div class="ttdeci">void removeGeofenceHelper(std::shared_ptr&lt; Geofence &gt; gf_ptr) const</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8cpp_source.html#l01935">WMBroadcaster.cpp:1935</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMBroadcaster_8hpp_source.html#l00411">active_geofence_llt_ids_</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00429">current_map_</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00451">current_map_version_</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00430">current_routing_graph_</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00436">map_mutex_</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00438">map_update_pub_</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00432">participant_</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l01935">removeGeofenceHelper()</a>, <a class="el" href="TrafficControl_8cpp_source.html#l00024">carma_wm::toBinMsg()</a>, and <a class="el" href="WMBroadcaster_8hpp_source.html#l00461">update_count_</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l00047">WMBroadcaster()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_a3751e2e2dc4455fc7e3e80f1ae2c672e_cgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_a3751e2e2dc4455fc7e3e80f1ae2c672e_cgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_a3751e2e2dc4455fc7e3e80f1ae2c672e_cgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_a3751e2e2dc4455fc7e3e80f1ae2c672e_cgraph">
<area shape="rect" title="Removes a geofence from the current map and publishes the ROS msg." alt="" coords="5,35,216,76"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a0a119e3571ef94545fc979ca3190c5f1" title=" " alt="" coords="264,5,475,47"/>
<area shape="rect" href="namespacecarma__wm.html#aef665263f7df5afa3781f4319fe95e9c" title=" " alt="" coords="296,71,443,98"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#af1b3b20607c1fde289b41fc6a51ee88a" title=" " alt="" coords="523,5,733,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#af027533b2d500770301e17520f9e4863" title="This is a helper function that returns true if the provided regem is marked to be changed by the geof..." alt="" coords="781,5,992,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_a3751e2e2dc4455fc7e3e80f1ae2c672e_icgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_a3751e2e2dc4455fc7e3e80f1ae2c672e_icgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_a3751e2e2dc4455fc7e3e80f1ae2c672e_icgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_a3751e2e2dc4455fc7e3e80f1ae2c672e_icgraph">
<area shape="rect" title="Removes a geofence from the current map and publishes the ROS msg." alt="" coords="264,5,475,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a95cb7c60682d7b455a8624534ad94706" title="Constructor." alt="" coords="5,5,216,47"/>
</map>
</div>

</div>
</div>
<a id="a0a119e3571ef94545fc979ca3190c5f1" name="a0a119e3571ef94545fc979ca3190c5f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a119e3571ef94545fc979ca3190c5f1">&#9670;&nbsp;</a></span>removeGeofenceHelper()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void carma_wm_ctrl::WMBroadcaster::removeGeofenceHelper </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classcarma__wm__ctrl_1_1Geofence.html">Geofence</a> &gt;&#160;</td>
          <td class="paramname"><em>gf_ptr</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8cpp_source.html#l01935">1935</a> of file <a class="el" href="WMBroadcaster_8cpp_source.html">WMBroadcaster.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1936</span>{</div>
<div class="line"><span class="lineno"> 1937</span>  <span class="comment">// Logic to determine what type of geofence</span></div>
<div class="line"><span class="lineno"> 1938</span>  <span class="comment">// reset the info inside geofence</span></div>
<div class="line"><span class="lineno"> 1939</span>  gf_ptr-&gt;remove_list_ = {};</div>
<div class="line"><span class="lineno"> 1940</span>  gf_ptr-&gt;update_list_ = {};</div>
<div class="line"><span class="lineno"> 1941</span>  <a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#af1b3b20607c1fde289b41fc6a51ee88a">addBackRegulatoryComponent</a>(gf_ptr);</div>
<div class="line"><span class="lineno"> 1942</span>  <span class="comment">// as all changes are reverted back, we no longer need prev_regems</span></div>
<div class="line"><span class="lineno"> 1943</span>  gf_ptr-&gt;prev_regems_ = {};</div>
<div class="line"><span class="lineno"> 1944</span>}</div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_af1b3b20607c1fde289b41fc6a51ee88a"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#af1b3b20607c1fde289b41fc6a51ee88a">carma_wm_ctrl::WMBroadcaster::addBackRegulatoryComponent</a></div><div class="ttdeci">void addBackRegulatoryComponent(std::shared_ptr&lt; Geofence &gt; gf_ptr) const</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8cpp_source.html#l01457">WMBroadcaster.cpp:1457</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMBroadcaster_8cpp_source.html#l01457">addBackRegulatoryComponent()</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l01578">removeGeofence()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_a0a119e3571ef94545fc979ca3190c5f1_cgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_a0a119e3571ef94545fc979ca3190c5f1_cgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_a0a119e3571ef94545fc979ca3190c5f1_cgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_a0a119e3571ef94545fc979ca3190c5f1_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,216,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#af1b3b20607c1fde289b41fc6a51ee88a" title=" " alt="" coords="264,5,475,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#af027533b2d500770301e17520f9e4863" title="This is a helper function that returns true if the provided regem is marked to be changed by the geof..." alt="" coords="523,5,733,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_a0a119e3571ef94545fc979ca3190c5f1_icgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_a0a119e3571ef94545fc979ca3190c5f1_icgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_a0a119e3571ef94545fc979ca3190c5f1_icgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_a0a119e3571ef94545fc979ca3190c5f1_icgraph">
<area shape="rect" title=" " alt="" coords="523,5,733,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a3751e2e2dc4455fc7e3e80f1ae2c672e" title="Removes a geofence from the current map and publishes the ROS msg." alt="" coords="264,5,475,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a95cb7c60682d7b455a8624534ad94706" title="Constructor." alt="" coords="5,5,216,47"/>
</map>
</div>

</div>
</div>
<a id="a7efa8028648e4ed8b847c97e952b07d1" name="a7efa8028648e4ed8b847c97e952b07d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7efa8028648e4ed8b847c97e952b07d1">&#9670;&nbsp;</a></span>routeCallbackMessage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void carma_wm_ctrl::WMBroadcaster::routeCallbackMessage </td>
          <td>(</td>
          <td class="paramtype">carma_planning_msgs::msg::Route::UniquePtr&#160;</td>
          <td class="paramname"><em>route_msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calls <a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a0fcc6904e5b3fb2fca13e9488069ec10" title="Pulls vehicle information from CARMA Cloud at startup by providing its selected route in a TrafficCon...">controlRequestFromRoute()</a> and publishes the TrafficControlRequest Message returned after the completed operations. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">route_msg</td><td>The message containing route information </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8cpp_source.html#l01632">1632</a> of file <a class="el" href="WMBroadcaster_8cpp_source.html">WMBroadcaster.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1633</span>{</div>
<div class="line"><span class="lineno"> 1634</span> <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a2c67e3708a1f2e191b24bdec5caf2af3">current_route</a> = *route_msg;</div>
<div class="line"><span class="lineno"> 1635</span> carma_v2x_msgs::msg::TrafficControlRequest cR; </div>
<div class="line"><span class="lineno"> 1636</span> cR =  <a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a0fcc6904e5b3fb2fca13e9488069ec10">controlRequestFromRoute</a>(*route_msg);</div>
<div class="line"><span class="lineno"> 1637</span> <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a220595697a17eed6a334c9e858e611f5">control_msg_pub_</a>(cR);</div>
<div class="line"><span class="lineno"> 1638</span> </div>
<div class="line"><span class="lineno"> 1639</span>}</div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_a0fcc6904e5b3fb2fca13e9488069ec10"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a0fcc6904e5b3fb2fca13e9488069ec10">carma_wm_ctrl::WMBroadcaster::controlRequestFromRoute</a></div><div class="ttdeci">carma_v2x_msgs::msg::TrafficControlRequest controlRequestFromRoute(const carma_planning_msgs::msg::Route &amp;route_msg, std::shared_ptr&lt; j2735_v2x_msgs::msg::Id64b &gt; req_id_for_testing=NULL)</div><div class="ttdoc">Pulls vehicle information from CARMA Cloud at startup by providing its selected route in a TrafficCon...</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8cpp_source.html#l01641">WMBroadcaster.cpp:1641</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMBroadcaster_8hpp_source.html#l00439">control_msg_pub_</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l01641">controlRequestFromRoute()</a>, and <a class="el" href="WMBroadcaster_8hpp_source.html#l00453">current_route</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l00047">WMBroadcaster()</a>, and <a class="el" href="WMBroadcasterNode_8cpp_source.html#l00153">carma_wm_ctrl::WMBroadcasterNode::handle_on_activate()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_a7efa8028648e4ed8b847c97e952b07d1_cgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_a7efa8028648e4ed8b847c97e952b07d1_cgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_a7efa8028648e4ed8b847c97e952b07d1_cgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_a7efa8028648e4ed8b847c97e952b07d1_cgraph">
<area shape="rect" title="Calls controlRequestFromRoute() and publishes the TrafficControlRequest Message returned after the co..." alt="" coords="5,64,216,105"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a0fcc6904e5b3fb2fca13e9488069ec10" title="Pulls vehicle information from CARMA Cloud at startup by providing its selected route in a TrafficCon..." alt="" coords="264,64,475,105"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a8c72c6fdeb1568b078bf6131c906b377" title="composeTCRStatus() compose TCM Request visualization on UI" alt="" coords="533,5,743,47"/>
<area shape="rect" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5" title=" " alt="" coords="801,35,1000,76"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1GeofenceScheduler.html#a2fecf322a302aff00ce8d76b0965e02e" title="Get the clock type of the clock being created by the timer factory." alt="" coords="523,123,753,164"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_a7efa8028648e4ed8b847c97e952b07d1_icgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_a7efa8028648e4ed8b847c97e952b07d1_icgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_a7efa8028648e4ed8b847c97e952b07d1_icgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_a7efa8028648e4ed8b847c97e952b07d1_icgraph">
<area shape="rect" title="Calls controlRequestFromRoute() and publishes the TrafficControlRequest Message returned after the co..." alt="" coords="264,39,475,80"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a95cb7c60682d7b455a8624534ad94706" title="Constructor." alt="" coords="5,5,216,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcasterNode.html#ab0c14f6d7e30870755a4dcf6b228de82" title=" " alt="" coords="5,71,216,112"/>
</map>
</div>

</div>
</div>
<a id="ab6bfd98359ff2f28688bf7503b43a336" name="ab6bfd98359ff2f28688bf7503b43a336"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6bfd98359ff2f28688bf7503b43a336">&#9670;&nbsp;</a></span>scheduleGeofence()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void carma_wm_ctrl::WMBroadcaster::scheduleGeofence </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classcarma__wm__ctrl_1_1Geofence.html">carma_wm_ctrl::Geofence</a> &gt;&#160;</td>
          <td class="paramname"><em>gf_ptr_list</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8cpp_source.html#l01137">1137</a> of file <a class="el" href="WMBroadcaster_8cpp_source.html">WMBroadcaster.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1138</span>{</div>
<div class="line"><span class="lineno"> 1139</span>  RCLCPP_INFO_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Scheduling new geofence message received by WMBroadcaster with id: &quot;</span> &lt;&lt; gf_ptr-&gt;id_);</div>
<div class="line"><span class="lineno"> 1140</span>  </div>
<div class="line"><span class="lineno"> 1141</span>  <span class="keywordtype">bool</span> detected_workzone_signal = gf_ptr-&gt;msg_.package.label_exists &amp;&amp; gf_ptr-&gt;msg_.package.label.find(<span class="stringliteral">&quot;SIG_WZ&quot;</span>) != std::string::npos;</div>
<div class="line"><span class="lineno"> 1142</span>  </div>
<div class="line"><span class="lineno"> 1143</span>  carma_v2x_msgs::msg::TrafficControlDetail msg_detail = gf_ptr-&gt;msg_.params.detail;</div>
<div class="line"><span class="lineno"> 1144</span>  </div>
<div class="line"><span class="lineno"> 1145</span>  <span class="comment">// create workzone specific extra speed geofence</span></div>
<div class="line"><span class="lineno"> 1146</span>  <span class="keywordflow">if</span> (detected_workzone_signal &amp;&amp; msg_detail.choice == carma_v2x_msgs::msg::TrafficControlDetail::MAXSPEED_CHOICE)</div>
<div class="line"><span class="lineno"> 1147</span>  {</div>
<div class="line"><span class="lineno"> 1148</span>    <span class="comment">// duplicate the messages with inverted points to support new lanelets created from workzone</span></div>
<div class="line"><span class="lineno"> 1149</span>    <span class="comment">// as carma-cloud currently does not support geofence points with direction opposite to that of the road</span></div>
<div class="line"><span class="lineno"> 1150</span> </div>
<div class="line"><span class="lineno"> 1151</span>    <span class="keyword">auto</span> gf_ptr_speed = std::make_shared&lt;Geofence&gt;();</div>
<div class="line"><span class="lineno"> 1152</span>    gf_ptr_speed-&gt;schedules = gf_ptr-&gt;schedules;</div>
<div class="line"><span class="lineno"> 1153</span> </div>
<div class="line"><span class="lineno"> 1154</span>    carma_v2x_msgs::msg::TrafficControlMessageV01 duplicate_msg = gf_ptr-&gt;msg_;</div>
<div class="line"><span class="lineno"> 1155</span> </div>
<div class="line"><span class="lineno"> 1156</span>    std::reverse(duplicate_msg.geometry.nodes.begin() + 1, duplicate_msg.geometry.nodes.end());</div>
<div class="line"><span class="lineno"> 1157</span>    <span class="keywordtype">double</span> first_x = 0;</div>
<div class="line"><span class="lineno"> 1158</span>    <span class="keywordtype">double</span> first_y = 0;</div>
<div class="line"><span class="lineno"> 1159</span> </div>
<div class="line"><span class="lineno"> 1160</span>    <span class="comment">// this fancy logic is needed as each node is expressed as an offset from the last one</span></div>
<div class="line"><span class="lineno"> 1161</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; pt: duplicate_msg.geometry.nodes)</div>
<div class="line"><span class="lineno"> 1162</span>    {</div>
<div class="line"><span class="lineno"> 1163</span>      first_x+= pt.x;</div>
<div class="line"><span class="lineno"> 1164</span>      first_y+= pt.y;</div>
<div class="line"><span class="lineno"> 1165</span>      pt.x = -1* pt.x;</div>
<div class="line"><span class="lineno"> 1166</span>      pt.y = -1* pt.y;</div>
<div class="line"><span class="lineno"> 1167</span>    }</div>
<div class="line"><span class="lineno"> 1168</span>    duplicate_msg.geometry.nodes[0].x = first_x;</div>
<div class="line"><span class="lineno"> 1169</span>    duplicate_msg.geometry.nodes[0].y = first_y;</div>
<div class="line"><span class="lineno"> 1170</span>    </div>
<div class="line"><span class="lineno"> 1171</span>    gf_ptr_speed-&gt;msg_ = duplicate_msg;</div>
<div class="line"><span class="lineno"> 1172</span>    <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#abbf8a6885fb83de6bdf0241ef3e1401f">scheduler_</a>.<a class="code hl_function" href="classcarma__wm__ctrl_1_1GeofenceScheduler.html#aa6e1c118ed8765ca03a7e52518c6e007">addGeofence</a>(gf_ptr_speed);</div>
<div class="line"><span class="lineno"> 1173</span>  }</div>
<div class="line"><span class="lineno"> 1174</span>  <span class="keywordflow">if</span> (detected_workzone_signal &amp;&amp; msg_detail.choice != carma_v2x_msgs::msg::TrafficControlDetail::MAXSPEED_CHOICE) <span class="comment">// if workzone message detected, save to cache to process later</span></div>
<div class="line"><span class="lineno"> 1175</span>  {</div>
<div class="line"><span class="lineno"> 1176</span>    gf_ptr-&gt;label_ = gf_ptr-&gt;msg_.package.label; <span class="comment">// to extract intersection, and signal group id</span></div>
<div class="line"><span class="lineno"> 1177</span>    <span class="keywordflow">if</span> (msg_detail.choice == carma_v2x_msgs::msg::TrafficControlDetail::CLOSED_CHOICE &amp;&amp; (msg_detail.closed == carma_v2x_msgs::msg::TrafficControlDetail::CLOSED ||</div>
<div class="line"><span class="lineno"> 1178</span>                                                                                msg_detail.closed == carma_v2x_msgs::msg::TrafficControlDetail::TAPERRIGHT ||</div>
<div class="line"><span class="lineno"> 1179</span>                                                                                msg_detail.closed == carma_v2x_msgs::msg::TrafficControlDetail::OPENRIGHT))</div>
<div class="line"><span class="lineno"> 1180</span>    {</div>
<div class="line"><span class="lineno"> 1181</span>      <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a4610499a06e220327a8eb10cbc18d8de">work_zone_geofence_cache_</a>[msg_detail.closed] = gf_ptr;</div>
<div class="line"><span class="lineno"> 1182</span>    }</div>
<div class="line"><span class="lineno"> 1183</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (msg_detail.choice == carma_v2x_msgs::msg::TrafficControlDetail::DIRECTION_CHOICE &amp;&amp; msg_detail.direction == carma_v2x_msgs::msg::TrafficControlDetail::REVERSE)</div>
<div class="line"><span class="lineno"> 1184</span>    {</div>
<div class="line"><span class="lineno"> 1185</span>      <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a4610499a06e220327a8eb10cbc18d8de">work_zone_geofence_cache_</a>[<a class="code hl_variable" href="structcarma__wm__ctrl_1_1WorkZoneSection.html#ade4ff9d14cf9c540b8235d25a3fe1b61">WorkZoneSection::REVERSE</a>] = gf_ptr;</div>
<div class="line"><span class="lineno"> 1186</span>    }</div>
<div class="line"><span class="lineno"> 1187</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a4610499a06e220327a8eb10cbc18d8de">work_zone_geofence_cache_</a>.size() &lt; <a class="code hl_variable" href="namespacecarma__wm__ctrl.html#ada99e470ef51033ea80c2ded7249158b">WORKZONE_TCM_REQUIRED_SIZE</a>)</div>
<div class="line"><span class="lineno"> 1188</span>    {</div>
<div class="line"><span class="lineno"> 1189</span>      RCLCPP_INFO_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Received &#39;SIG_WZ&#39; signal. Waiting for the rest of the messages, returning for now...&quot;</span>);</div>
<div class="line"><span class="lineno"> 1190</span>      <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1191</span>    }</div>
<div class="line"><span class="lineno"> 1192</span>  }</div>
<div class="line"><span class="lineno"> 1193</span> </div>
<div class="line"><span class="lineno"> 1194</span>  <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#abbf8a6885fb83de6bdf0241ef3e1401f">scheduler_</a>.<a class="code hl_function" href="classcarma__wm__ctrl_1_1GeofenceScheduler.html#aa6e1c118ed8765ca03a7e52518c6e007">addGeofence</a>(gf_ptr);  <span class="comment">// Add the geofence to the scheduler</span></div>
<div class="line"><span class="lineno"> 1195</span> </div>
<div class="line"><span class="lineno"> 1196</span>}</div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1GeofenceScheduler_html_aa6e1c118ed8765ca03a7e52518c6e007"><div class="ttname"><a href="classcarma__wm__ctrl_1_1GeofenceScheduler.html#aa6e1c118ed8765ca03a7e52518c6e007">carma_wm_ctrl::GeofenceScheduler::addGeofence</a></div><div class="ttdeci">void addGeofence(std::shared_ptr&lt; Geofence &gt; gf_ptr)</div><div class="ttdoc">Add a geofence to the scheduler. This will cause it to trigger an event when it becomes active or goe...</div><div class="ttdef"><b>Definition:</b> <a href="GeofenceScheduler_8cpp_source.html#l00070">GeofenceScheduler.cpp:70</a></div></div>
<div class="ttc" id="anamespacecarma__wm__ctrl_html_ada99e470ef51033ea80c2ded7249158b"><div class="ttname"><a href="namespacecarma__wm__ctrl.html#ada99e470ef51033ea80c2ded7249158b">carma_wm_ctrl::WORKZONE_TCM_REQUIRED_SIZE</a></div><div class="ttdeci">const int WORKZONE_TCM_REQUIRED_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8hpp_source.html#l00061">WMBroadcaster.hpp:61</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="GeofenceScheduler_8cpp_source.html#l00070">carma_wm_ctrl::GeofenceScheduler::addGeofence()</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00062">carma_wm_ctrl::WorkZoneSection::REVERSE</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00441">scheduler_</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00412">work_zone_geofence_cache_</a>, and <a class="el" href="WMBroadcaster_8hpp_source.html#l00061">carma_wm_ctrl::WORKZONE_TCM_REQUIRED_SIZE</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l01030">externalMapMsgCallback()</a>, and <a class="el" href="WMBroadcaster_8cpp_source.html#l01077">geofenceCallback()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_ab6bfd98359ff2f28688bf7503b43a336_cgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_ab6bfd98359ff2f28688bf7503b43a336_cgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_ab6bfd98359ff2f28688bf7503b43a336_cgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_ab6bfd98359ff2f28688bf7503b43a336_cgraph">
<area shape="rect" title=" " alt="" coords="5,9,216,51"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1GeofenceScheduler.html#aa6e1c118ed8765ca03a7e52518c6e007" title="Add a geofence to the scheduler. This will cause it to trigger an event when it becomes active or goe..." alt="" coords="264,9,495,51"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1GeofenceScheduler.html#a9072b770cf240953a50f1d926b733b7c" title="Generates the next id to be used for a timer." alt="" coords="1100,5,1331,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1GeofenceScheduler.html#a8e993e68cb77c8c77b81dc8dfba2bc1e" title="The callback which is triggered when a geofence becomes active This will call the user set active_cal..." alt="" coords="543,39,773,80"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1GeofenceScheduler.html#a0f58b227dcbd413eb451146d36cb1728" title="The callback which is triggered when a geofence becomes in&#45;active This will call the user set inactiv..." alt="" coords="821,64,1052,105"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_ab6bfd98359ff2f28688bf7503b43a336_icgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_ab6bfd98359ff2f28688bf7503b43a336_icgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_ab6bfd98359ff2f28688bf7503b43a336_icgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_ab6bfd98359ff2f28688bf7503b43a336_icgraph">
<area shape="rect" title=" " alt="" coords="523,39,733,80"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a9d4ee6959ff334d9f4f16864e5bd0cfe" title="Callback to MAP.msg which contains intersections&#39; static info such geometry and lane ids." alt="" coords="264,5,475,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a63a919c2cf6736a80fa29a706b020330" title="Callback to add a geofence to the map. Currently only supports version 1 TrafficControlMessage." alt="" coords="264,71,475,112"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcasterNode.html#ab0c14f6d7e30870755a4dcf6b228de82" title=" " alt="" coords="5,39,216,80"/>
</map>
</div>

</div>
</div>
<a id="ae520d10dda3ac342470fd49304cf0e21" name="ae520d10dda3ac342470fd49304cf0e21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae520d10dda3ac342470fd49304cf0e21">&#9670;&nbsp;</a></span>setConfigACKPubTimes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void carma_wm_ctrl::WMBroadcaster::setConfigACKPubTimes </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ack_pub_times</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the TCM Acknowledgement publish times. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ack_pub_times</td><td>the number of times it publishes TCM Acknowledgement </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8cpp_source.html#l01238">1238</a> of file <a class="el" href="WMBroadcaster_8cpp_source.html">WMBroadcaster.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1238</span>                                                         {</div>
<div class="line"><span class="lineno"> 1239</span>  <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a19e428bc63bdb7eef768738e08af92ac">ack_pub_times_</a> = ack_pub_times;</div>
<div class="line"><span class="lineno"> 1240</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMBroadcaster_8hpp_source.html#l00470">ack_pub_times_</a>.</p>

</div>
</div>
<a id="a69a944cfa523079a3b9cdd29267d6d68" name="a69a944cfa523079a3b9cdd29267d6d68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69a944cfa523079a3b9cdd29267d6d68">&#9670;&nbsp;</a></span>setConfigSpeedLimit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void carma_wm_ctrl::WMBroadcaster::setConfigSpeedLimit </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cL</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the configured speed limit. </p>

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8cpp_source.html#l01228">1228</a> of file <a class="el" href="WMBroadcaster_8cpp_source.html">WMBroadcaster.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1229</span>{</div>
<div class="line"><span class="lineno"> 1230</span>  <span class="comment">/*Logic to change config_lim to Velocity value config_limit*/</span></div>
<div class="line"><span class="lineno"> 1231</span>  <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a4bf605c8ea54b5a03e01d010d6014389">config_limit</a> = lanelet::Velocity(cL * lanelet::units::MPH());</div>
<div class="line"><span class="lineno"> 1232</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMBroadcaster_8hpp_source.html#l00431">config_limit</a>.</p>

</div>
</div>
<a id="a3e4ce19e4beeb74ae79ae8b1ca02cbb7" name="a3e4ce19e4beeb74ae79ae8b1ca02cbb7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e4ce19e4beeb74ae79ae8b1ca02cbb7">&#9670;&nbsp;</a></span>setConfigVehicleId()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void carma_wm_ctrl::WMBroadcaster::setConfigVehicleId </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>vehicle_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve the vehicle ID from global vehicle parameters, and set instance memeber vehicle id. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">vehicle_id</td><td>Vehicle ID from UniqueVehicleParams.yaml </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8cpp_source.html#l01234">1234</a> of file <a class="el" href="WMBroadcaster_8cpp_source.html">WMBroadcaster.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1234</span>                                                                 {</div>
<div class="line"><span class="lineno"> 1235</span>  <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ac34bbb28c302480f2876f0946105cbd6">vehicle_id_</a> = vehicle_id;</div>
<div class="line"><span class="lineno"> 1236</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMBroadcaster_8hpp_source.html#l00471">vehicle_id_</a>.</p>

</div>
</div>
<a id="a1e4581c0020ab957f80062f40b89a4cf" name="a1e4581c0020ab957f80062f40b89a4cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e4581c0020ab957f80062f40b89a4cf">&#9670;&nbsp;</a></span>setErrorDistance()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void carma_wm_ctrl::WMBroadcaster::setErrorDistance </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>error_distance</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8cpp_source.html#l00595">595</a> of file <a class="el" href="WMBroadcaster_8cpp_source.html">WMBroadcaster.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  596</span>{</div>
<div class="line"><span class="lineno">  597</span>  <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ab5567570e8a54c507f1c55c23f364933">error_distance_</a> = error_distance;</div>
<div class="line"><span class="lineno">  598</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMBroadcaster_8hpp_source.html#l00409">error_distance_</a>.</p>

</div>
</div>
<a id="ad0225013dc8793cf940e8007f96ead71" name="ad0225013dc8793cf940e8007f96ead71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0225013dc8793cf940e8007f96ead71">&#9670;&nbsp;</a></span>setIntersectionCoordCorrection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void carma_wm_ctrl::WMBroadcaster::setIntersectionCoordCorrection </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; int64_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>intersection_ids_for_correction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>intersection_correction</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the coordinate correction for intersection. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">list</td><td>of intersection_ids corresponding to every two elements in correction list </td></tr>
    <tr><td class="paramname">list</td><td>of intersection coord correction parameters in double in every 2 elements: delta_x, delta_y </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8cpp_source.html#l01213">1213</a> of file <a class="el" href="WMBroadcaster_8cpp_source.html">WMBroadcaster.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1214</span>{</div>
<div class="line"><span class="lineno"> 1215</span>  <span class="keywordflow">if</span> (intersection_correction.size() % 2 != 0 || intersection_ids_for_correction.size() != intersection_correction.size() / 2)</div>
<div class="line"><span class="lineno"> 1216</span>  {</div>
<div class="line"><span class="lineno"> 1217</span>    <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;Some of intersection coordinate correction parameters are not fully set!&quot;</span>);</div>
<div class="line"><span class="lineno"> 1218</span>  }</div>
<div class="line"><span class="lineno"> 1219</span> </div>
<div class="line"><span class="lineno"> 1220</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> = 0; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> &lt; intersection_correction.size(); <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> = <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> + 2)</div>
<div class="line"><span class="lineno"> 1221</span>  {</div>
<div class="line"><span class="lineno"> 1222</span>    <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aa26bb2f41f25b523fd2a98010af60cb0">sim_</a>-&gt;intersection_coord_correction_[(uint16_t)intersection_ids_for_correction[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>/2]].first =  intersection_correction[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>]; <span class="comment">//x</span></div>
<div class="line"><span class="lineno"> 1223</span>    <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aa26bb2f41f25b523fd2a98010af60cb0">sim_</a>-&gt;intersection_coord_correction_[(uint16_t)intersection_ids_for_correction[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>/2]].second = intersection_correction[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> + 1]; <span class="comment">//y</span></div>
<div class="line"><span class="lineno"> 1224</span>  }</div>
<div class="line"><span class="lineno"> 1225</span> </div>
<div class="line"><span class="lineno"> 1226</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="process__bag_8py_source.html#l00059">process_bag::i</a>, and <a class="el" href="WMBroadcaster_8hpp_source.html#l00463">sim_</a>.</p>

</div>
</div>
<a id="a634326ffd890a920f456bd8c1ebc5e6f" name="a634326ffd890a920f456bd8c1ebc5e6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a634326ffd890a920f456bd8c1ebc5e6f">&#9670;&nbsp;</a></span>setMaxLaneWidth()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void carma_wm_ctrl::WMBroadcaster::setMaxLaneWidth </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_lane_width</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the max lane width in meters. <a class="el" href="classcarma__wm__ctrl_1_1Geofence.html" title="An object representing a geofence use for communications with CARMA Cloud.">Geofence</a> points are associated to a lanelet if they are within this distance to a lanelet as geofence points are guaranteed to apply to a single lane. </p>

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8cpp_source.html#l01205">1205</a> of file <a class="el" href="WMBroadcaster_8cpp_source.html">WMBroadcaster.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1206</span>{</div>
<div class="line"><span class="lineno"> 1207</span>  <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aa26bb2f41f25b523fd2a98010af60cb0">sim_</a> = std::make_shared&lt;carma_wm::SignalizedIntersectionManager&gt;();</div>
<div class="line"><span class="lineno"> 1208</span>  </div>
<div class="line"><span class="lineno"> 1209</span>  <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#af150debc195a3c34c9320232a9b9a1eb">max_lane_width_</a> = max_lane_width;</div>
<div class="line"><span class="lineno"> 1210</span>  <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aa26bb2f41f25b523fd2a98010af60cb0">sim_</a>-&gt;setMaxLaneWidth(<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#af150debc195a3c34c9320232a9b9a1eb">max_lane_width_</a>);</div>
<div class="line"><span class="lineno"> 1211</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMBroadcaster_8hpp_source.html#l00444">max_lane_width_</a>, and <a class="el" href="WMBroadcaster_8hpp_source.html#l00463">sim_</a>.</p>

</div>
</div>
<a id="a7731acf2acd03792583bba969571235f" name="a7731acf2acd03792583bba969571235f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7731acf2acd03792583bba969571235f">&#9670;&nbsp;</a></span>setVehicleParticipationType()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void carma_wm_ctrl::WMBroadcaster::setVehicleParticipationType </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>participant</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the Vehicle Participation Type. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">participant</td><td>vehicle participation type </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8cpp_source.html#l01242">1242</a> of file <a class="el" href="WMBroadcaster_8cpp_source.html">WMBroadcaster.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1243</span>{</div>
<div class="line"><span class="lineno"> 1244</span>  <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a9d9fd775035c8389502d5185fa890070">participant_</a> = participant;</div>
<div class="line"><span class="lineno"> 1245</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMBroadcaster_8hpp_source.html#l00432">participant_</a>.</p>

</div>
</div>
<a id="af027533b2d500770301e17520f9e4863" name="af027533b2d500770301e17520f9e4863"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af027533b2d500770301e17520f9e4863">&#9670;&nbsp;</a></span>shouldChangeControlLine()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool carma_wm_ctrl::WMBroadcaster::shouldChangeControlLine </td>
          <td>(</td>
          <td class="paramtype">const lanelet::ConstLaneletOrArea &amp;&#160;</td>
          <td class="paramname"><em>el</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const lanelet::RegulatoryElementConstPtr &amp;&#160;</td>
          <td class="paramname"><em>regem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classcarma__wm__ctrl_1_1Geofence.html">Geofence</a> &gt;&#160;</td>
          <td class="paramname"><em>gf_ptr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This is a helper function that returns true if the provided regem is marked to be changed by the geofence as there are usually multiple passing control lines are in the lanelet. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">geofence_msg</td><td>The ROS msg that contains geofence information </td></tr>
    <tr><td class="paramname">el</td><td>The LaneletOrArea that houses the regem </td></tr>
    <tr><td class="paramname">regem</td><td>The regulatoryElement that needs to be checked NOTE: Currently this function only works on lanelets. It returns true if the regem is not passingControlLine or if the pcl should be changed. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8cpp_source.html#l01357">1357</a> of file <a class="el" href="WMBroadcaster_8cpp_source.html">WMBroadcaster.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1358</span>{</div>
<div class="line"><span class="lineno"> 1359</span>  <span class="comment">// should change if if the regem is not a passing control line or area, which is not supported by this logic</span></div>
<div class="line"><span class="lineno"> 1360</span>  <span class="keywordflow">if</span> (regem-&gt;attribute(lanelet::AttributeName::Subtype).value().compare(lanelet::PassingControlLine::RuleName) != 0 || !el.isLanelet())</div>
<div class="line"><span class="lineno"> 1361</span>  {</div>
<div class="line"><span class="lineno"> 1362</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1363</span>  }</div>
<div class="line"><span class="lineno"> 1364</span>  </div>
<div class="line"><span class="lineno"> 1365</span>  lanelet::PassingControlLinePtr <a class="code hl_namespace" href="namespacepcl.html">pcl</a> =  std::dynamic_pointer_cast&lt;lanelet::PassingControlLine&gt;(<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;regulatoryElementLayer.get(regem-&gt;id()));</div>
<div class="line"><span class="lineno"> 1366</span>  <span class="comment">// if this geofence&#39;s pcl doesn&#39;t match with the lanelets current bound side, return false as we shouldn&#39;t change</span></div>
<div class="line"><span class="lineno"> 1367</span>  <span class="keywordtype">bool</span> should_change_pcl = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1368</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> control_line : <a class="code hl_namespace" href="namespacepcl.html">pcl</a>-&gt;controlLine())</div>
<div class="line"><span class="lineno"> 1369</span>  {</div>
<div class="line"><span class="lineno"> 1370</span>    <span class="keywordflow">if</span> ((control_line.id() == el.lanelet()-&gt;leftBound2d().id() &amp;&amp; gf_ptr-&gt;pcl_affects_left_) ||</div>
<div class="line"><span class="lineno"> 1371</span>        (control_line.id() == el.lanelet()-&gt;rightBound2d().id() &amp;&amp; gf_ptr-&gt;pcl_affects_right_))</div>
<div class="line"><span class="lineno"> 1372</span>    {</div>
<div class="line"><span class="lineno"> 1373</span>      should_change_pcl = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1374</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1375</span>    }</div>
<div class="line"><span class="lineno"> 1376</span>  }</div>
<div class="line"><span class="lineno"> 1377</span>  <span class="keywordflow">return</span> should_change_pcl;</div>
<div class="line"><span class="lineno"> 1378</span>}</div>
<div class="ttc" id="anamespacepcl_html"><div class="ttname"><a href="namespacepcl.html">pcl</a></div><div class="ttdef"><b>Definition:</b> <a href="functor__filter_8h_source.html#l00024">functor_filter.h:24</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMBroadcaster_8hpp_source.html#l00429">current_map_</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l01457">addBackRegulatoryComponent()</a>, and <a class="el" href="WMBroadcaster_8cpp_source.html#l01416">addRegulatoryComponent()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_af027533b2d500770301e17520f9e4863_icgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_af027533b2d500770301e17520f9e4863_icgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_af027533b2d500770301e17520f9e4863_icgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_af027533b2d500770301e17520f9e4863_icgraph">
<area shape="rect" title="This is a helper function that returns true if the provided regem is marked to be changed by the geof..." alt="" coords="1040,39,1251,80"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#af1b3b20607c1fde289b41fc6a51ee88a" title=" " alt="" coords="781,5,992,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aa7f599cf26d1e2ff6ea7cb943de23071" title=" " alt="" coords="781,71,992,112"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a0a119e3571ef94545fc979ca3190c5f1" title=" " alt="" coords="523,5,733,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a3751e2e2dc4455fc7e3e80f1ae2c672e" title="Removes a geofence from the current map and publishes the ROS msg." alt="" coords="264,5,475,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a95cb7c60682d7b455a8624534ad94706" title="Constructor." alt="" coords="5,39,216,80"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a59dfece11887f76f024c34ef7f6e0f05" title=" " alt="" coords="523,71,733,112"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a649174a7a7270df95532cad5131bf4cb" title="Adds a geofence to the current map and publishes the ROS msg." alt="" coords="264,71,475,112"/>
</map>
</div>

</div>
</div>
<a id="a13393bf085e59efc687c5d9b407326cf" name="a13393bf085e59efc687c5d9b407326cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13393bf085e59efc687c5d9b407326cf">&#9670;&nbsp;</a></span>shouldChangeTrafficSignal()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool carma_wm_ctrl::WMBroadcaster::shouldChangeTrafficSignal </td>
          <td>(</td>
          <td class="paramtype">const lanelet::ConstLaneletOrArea &amp;&#160;</td>
          <td class="paramname"><em>el</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const lanelet::RegulatoryElementConstPtr &amp;&#160;</td>
          <td class="paramname"><em>regem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classcarma__wm_1_1SignalizedIntersectionManager.html">carma_wm::SignalizedIntersectionManager</a> &gt;&#160;</td>
          <td class="paramname"><em>sim</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This is a helper function that returns true if signal in the lanelet should be changed according to the records of signalizer intersection manager Used in managing multiple signal_groups in a single entry lanelet for example. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">el</td><td>The LaneletOrArea that houses the regem </td></tr>
    <tr><td class="paramname">regem</td><td>The regulatoryElement that needs to be checked </td></tr>
    <tr><td class="paramname">sim</td><td>The signalized intersection manager that has records regems and corresponding lanelets NOTE: Currently this function only works on lanelets. It returns true if the regem is not CarmaTrafficSignal or if the signal should be changed. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8cpp_source.html#l01388">1388</a> of file <a class="el" href="WMBroadcaster_8cpp_source.html">WMBroadcaster.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1389</span>{</div>
<div class="line"><span class="lineno"> 1390</span>  <span class="comment">// should change if the regem is not a CarmaTrafficSignal, which is not supported by this logic</span></div>
<div class="line"><span class="lineno"> 1391</span>  <span class="keywordflow">if</span> (regem-&gt;attribute(lanelet::AttributeName::Subtype).value().compare(lanelet::CarmaTrafficSignal::RuleName) != 0 || !el.isLanelet() || !<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aa26bb2f41f25b523fd2a98010af60cb0">sim_</a>)</div>
<div class="line"><span class="lineno"> 1392</span>  {</div>
<div class="line"><span class="lineno"> 1393</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1394</span>  }</div>
<div class="line"><span class="lineno"> 1395</span>  </div>
<div class="line"><span class="lineno"> 1396</span>  lanelet::CarmaTrafficSignalPtr traffic_signal =  std::dynamic_pointer_cast&lt;lanelet::CarmaTrafficSignal&gt;(<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;regulatoryElementLayer.get(regem-&gt;id()));</div>
<div class="line"><span class="lineno"> 1397</span>  uint8_t signal_id = 0;</div>
<div class="line"><span class="lineno"> 1398</span>  </div>
<div class="line"><span class="lineno"> 1399</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = sim-&gt;signal_group_to_traffic_light_id_.begin(); it != sim-&gt;signal_group_to_traffic_light_id_.end(); ++it) </div>
<div class="line"><span class="lineno"> 1400</span>  {</div>
<div class="line"><span class="lineno"> 1401</span>    <span class="keywordflow">if</span> (regem-&gt;id() == it-&gt;second)</div>
<div class="line"><span class="lineno"> 1402</span>    {</div>
<div class="line"><span class="lineno"> 1403</span>      signal_id = it-&gt;first;</div>
<div class="line"><span class="lineno"> 1404</span>    } </div>
<div class="line"><span class="lineno"> 1405</span>  } </div>
<div class="line"><span class="lineno"> 1406</span> </div>
<div class="line"><span class="lineno"> 1407</span>  <span class="keywordflow">if</span> (signal_id == 0) <span class="comment">// doesn&#39;t exist in the record</span></div>
<div class="line"><span class="lineno"> 1408</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1409</span>  </div>
<div class="line"><span class="lineno"> 1410</span>  <span class="keywordflow">if</span> (sim-&gt;signal_group_to_entry_lanelet_ids_[signal_id].find(el.id()) != sim-&gt;signal_group_to_entry_lanelet_ids_[signal_id].end())</div>
<div class="line"><span class="lineno"> 1411</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// signal group&#39;s entry lane is still part of the intersection, so don&#39;t change</span></div>
<div class="line"><span class="lineno"> 1412</span>  </div>
<div class="line"><span class="lineno"> 1413</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1414</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMBroadcaster_8hpp_source.html#l00429">current_map_</a>, and <a class="el" href="WMBroadcaster_8hpp_source.html#l00463">sim_</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l01416">addRegulatoryComponent()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_a13393bf085e59efc687c5d9b407326cf_icgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_a13393bf085e59efc687c5d9b407326cf_icgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_a13393bf085e59efc687c5d9b407326cf_icgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_a13393bf085e59efc687c5d9b407326cf_icgraph">
<area shape="rect" title="This is a helper function that returns true if signal in the lanelet should be changed according to t..." alt="" coords="1040,5,1251,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aa7f599cf26d1e2ff6ea7cb943de23071" title=" " alt="" coords="781,5,992,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a59dfece11887f76f024c34ef7f6e0f05" title=" " alt="" coords="523,5,733,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a649174a7a7270df95532cad5131bf4cb" title="Adds a geofence to the current map and publishes the ROS msg." alt="" coords="264,5,475,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a95cb7c60682d7b455a8624534ad94706" title="Constructor." alt="" coords="5,5,216,47"/>
</map>
</div>

</div>
</div>
<a id="a883734808f44db2778371ce3fbeecdd3" name="a883734808f44db2778371ce3fbeecdd3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a883734808f44db2778371ce3fbeecdd3">&#9670;&nbsp;</a></span>splitLaneletWithPoint()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; lanelet::Lanelet &gt; carma_wm_ctrl::WMBroadcaster::splitLaneletWithPoint </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; lanelet::BasicPoint2d &gt; &amp;&#160;</td>
          <td class="paramname"><em>input_pts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const lanelet::Lanelet &amp;&#160;</td>
          <td class="paramname"><em>input_llt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>error_distance</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Split given lanelet with same proportion as the given points' downtrack relative to the lanelet. Newly created lanelet will have old regulatory elements copied into each of them. From the front and back boundaries, it is deemed not necessary to split if the ratios are within error_distance from either of it. For example, if front and back points of 3 points given are both within error_distance, only middle point will be used to split into 2 lanelets. It will return duplicate of old lanelet (with different id) if no splitting was done. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">input_pts</td><td>Points whose downtrack ratio relative to given lanelet will be used to split the lanelet </td></tr>
    <tr><td class="paramname">input_llt</td><td>A lanelet to split </td></tr>
    <tr><td class="paramname">error_distance</td><td>if within this distance (in meters) the point will be ignored </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>lanelets split form original one. lanelets sorted from front to back. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">InvalidObjectStateError</td><td>if no map is available. NOTE: this is requried to return mutable objects. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8cpp_source.html#l00755">755</a> of file <a class="el" href="WMBroadcaster_8cpp_source.html">WMBroadcaster.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  756</span>{</div>
<div class="line"><span class="lineno">  757</span>  <span class="comment">// get ratio of this point and split</span></div>
<div class="line"><span class="lineno">  758</span>  std::vector&lt;lanelet::Lanelet&gt; parallel_llts;</div>
<div class="line"><span class="lineno">  759</span>  <span class="keywordtype">double</span> llt_downtrack = <a class="code hl_function" href="namespacecarma__wm_1_1geometry.html#aebce986f21c117983313292d5e82b50a">carma_wm::geometry::trackPos</a>(input_llt, input_llt.centerline().back().basicPoint2d()).<a class="code hl_variable" href="classcarma__wm_1_1TrackPos.html#a6ea99bbb9c6a75685ceaaf370d58ea24">downtrack</a>;</div>
<div class="line"><span class="lineno">  760</span>  std::vector&lt;double&gt; ratios;</div>
<div class="line"><span class="lineno">  761</span> </div>
<div class="line"><span class="lineno">  762</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> pt : input_pts)</div>
<div class="line"><span class="lineno">  763</span>  {</div>
<div class="line"><span class="lineno">  764</span>    <span class="keywordtype">double</span> point_downtrack = <a class="code hl_function" href="namespacecarma__wm_1_1geometry.html#aebce986f21c117983313292d5e82b50a">carma_wm::geometry::trackPos</a>(input_llt, pt).<a class="code hl_variable" href="classcarma__wm_1_1TrackPos.html#a6ea99bbb9c6a75685ceaaf370d58ea24">downtrack</a>;</div>
<div class="line"><span class="lineno">  765</span>    <span class="keywordtype">double</span> point_downtrack_ratio = point_downtrack / llt_downtrack;</div>
<div class="line"><span class="lineno">  766</span>    ratios.push_back(point_downtrack_ratio);</div>
<div class="line"><span class="lineno">  767</span>  }</div>
<div class="line"><span class="lineno">  768</span>  </div>
<div class="line"><span class="lineno">  769</span>  <span class="keyword">auto</span> new_parallel_llts = <a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a1dfc2ec5be906966916939c75874cbab">splitLaneletWithRatio</a>(ratios, input_llt, error_distance);</div>
<div class="line"><span class="lineno">  770</span> </div>
<div class="line"><span class="lineno">  771</span>  parallel_llts.insert(parallel_llts.end(),new_parallel_llts.begin(), new_parallel_llts.end());</div>
<div class="line"><span class="lineno">  772</span>  RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;splitLaneletWithPoint returning lanelets size: &quot;</span> &lt;&lt; parallel_llts.size());</div>
<div class="line"><span class="lineno">  773</span>  <span class="keywordflow">return</span> parallel_llts;</div>
<div class="line"><span class="lineno">  774</span>}</div>
<div class="ttc" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_html_a1dfc2ec5be906966916939c75874cbab"><div class="ttname"><a href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a1dfc2ec5be906966916939c75874cbab">carma_wm_ctrl::WMBroadcaster::splitLaneletWithRatio</a></div><div class="ttdeci">std::vector&lt; lanelet::Lanelet &gt; splitLaneletWithRatio(std::vector&lt; double &gt; ratios, lanelet::Lanelet input_lanelet, double error_distance) const</div><div class="ttdoc">Split given lanelet with given downtrack ratios relative to the lanelet. Newly created lanelet will h...</div><div class="ttdef"><b>Definition:</b> <a href="WMBroadcaster_8cpp_source.html#l00797">WMBroadcaster.cpp:797</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="TrackPos_8hpp_source.html#l00037">carma_wm::TrackPos::downtrack</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l00797">splitLaneletWithRatio()</a>, and <a class="el" href="Geometry_8cpp_source.html#l00120">carma_wm::geometry::trackPos()</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l00600">preprocessWorkzoneGeometry()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_a883734808f44db2778371ce3fbeecdd3_cgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_a883734808f44db2778371ce3fbeecdd3_cgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_a883734808f44db2778371ce3fbeecdd3_cgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_a883734808f44db2778371ce3fbeecdd3_cgraph">
<area shape="rect" title="Split given lanelet with same proportion as the given points&#39; downtrack relative to the lanelet...." alt="" coords="5,39,216,80"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a1dfc2ec5be906966916939c75874cbab" title="Split given lanelet with given downtrack ratios relative to the lanelet. Newly created lanelet will h..." alt="" coords="264,5,475,47"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#aebce986f21c117983313292d5e82b50a" title="Returns the TrackPos, computed in 2d, of the provided point relative to the centerline of the provide..." alt="" coords="297,71,442,112"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#ab675b2b8862a2ba9c139a8b5b353b846" title="Get the TrackPos of the provided point along the linestring and the segment of the line string which ..." alt="" coords="523,71,668,112"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#ae0a06818149f7430fee80e295ef04548" title="Helper function to identify whether to select the preceeding or succeeding segment of a linstring poi..." alt="" coords="716,71,861,112"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_a883734808f44db2778371ce3fbeecdd3_icgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_a883734808f44db2778371ce3fbeecdd3_icgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_a883734808f44db2778371ce3fbeecdd3_icgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_a883734808f44db2778371ce3fbeecdd3_icgraph">
<area shape="rect" title="Split given lanelet with same proportion as the given points&#39; downtrack relative to the lanelet...." alt="" coords="1040,5,1251,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#adc221f65f0b99586fc8c2ffc97c5feea" title="Preprocess for workzone area. Parallel_llts will have front_parallel and back_parallel lanelets that ..." alt="" coords="781,5,992,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a5ae3f2086831ebd932e19b2bdfd76405" title="Creates a single workzone geofence (in the vector) that includes all additional lanelets (housing tra..." alt="" coords="523,5,733,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a649174a7a7270df95532cad5131bf4cb" title="Adds a geofence to the current map and publishes the ROS msg." alt="" coords="264,5,475,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a95cb7c60682d7b455a8624534ad94706" title="Constructor." alt="" coords="5,5,216,47"/>
</map>
</div>

</div>
</div>
<a id="a1dfc2ec5be906966916939c75874cbab" name="a1dfc2ec5be906966916939c75874cbab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1dfc2ec5be906966916939c75874cbab">&#9670;&nbsp;</a></span>splitLaneletWithRatio()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; lanelet::Lanelet &gt; carma_wm_ctrl::WMBroadcaster::splitLaneletWithRatio </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; double &gt;&#160;</td>
          <td class="paramname"><em>ratios</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">lanelet::Lanelet&#160;</td>
          <td class="paramname"><em>input_lanelet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>error_distance</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Split given lanelet with given downtrack ratios relative to the lanelet. Newly created lanelet will have old regulatory elements copied into each of them. From the front and back boundaries, it is deemed not necessary to split if the ratios are within error_distance from either of it. For example, if front and back points of 3 ratios given are both within error_distance, only middle ratio will be used to split, so 2 lanelets will be returned. It will return duplicate of old lanelet (with different id) if no splitting was done. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ratios</td><td>Ratios relative to given lanelet will be used to split the lanelet </td></tr>
    <tr><td class="paramname">input_llt</td><td>A lanelet to split </td></tr>
    <tr><td class="paramname">error_distance</td><td>if within this distance (in meters) the ratio will be ignored as it is too small </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>parallel_llts return lanelets split form original one. lanelets sorted from front to back. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">InvalidObjectStateError</td><td>if no map is available. NOTE: this is requried to return mutable objects. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8cpp_source.html#l00797">797</a> of file <a class="el" href="WMBroadcaster_8cpp_source.html">WMBroadcaster.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  798</span>{</div>
<div class="line"><span class="lineno">  799</span>  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a> || <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;laneletLayer.size() == 0)</div>
<div class="line"><span class="lineno">  800</span>  {</div>
<div class="line"><span class="lineno">  801</span>    <span class="keywordflow">throw</span> lanelet::InvalidObjectStateError(std::string(<span class="stringliteral">&quot;Base lanelet map is not loaded to the WMBroadcaster&quot;</span>));</div>
<div class="line"><span class="lineno">  802</span>  }</div>
<div class="line"><span class="lineno">  803</span>  <span class="keywordflow">if</span> (ratios.empty())</div>
<div class="line"><span class="lineno">  804</span>  {</div>
<div class="line"><span class="lineno">  805</span>    <span class="keywordflow">throw</span> lanelet::InvalidInputError(std::string(<span class="stringliteral">&quot;Ratios list is empty! Cannot split&quot;</span>));</div>
<div class="line"><span class="lineno">  806</span>  }</div>
<div class="line"><span class="lineno">  807</span> </div>
<div class="line"><span class="lineno">  808</span>  std::vector&lt;lanelet::Lanelet&gt; created_llts;</div>
<div class="line"><span class="lineno">  809</span> </div>
<div class="line"><span class="lineno">  810</span>  std::sort(ratios.begin(), ratios.end());</div>
<div class="line"><span class="lineno">  811</span>  RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;splitLaneletWithRatio evaluating input ratios of size: &quot;</span> &lt;&lt; ratios.size());</div>
<div class="line"><span class="lineno">  812</span> </div>
<div class="line"><span class="lineno">  813</span>  ratios.push_back(1.0); <span class="comment">//needed to complete the loop</span></div>
<div class="line"><span class="lineno">  814</span> </div>
<div class="line"><span class="lineno">  815</span>  <span class="keywordtype">int</span> left_ls_size = input_lanelet.leftBound2d().size();</div>
<div class="line"><span class="lineno">  816</span>  <span class="keywordtype">int</span> right_ls_size = input_lanelet.rightBound2d().size();</div>
<div class="line"><span class="lineno">  817</span> </div>
<div class="line"><span class="lineno">  818</span>  <span class="keywordtype">int</span> left_next_pt_idx = 0;</div>
<div class="line"><span class="lineno">  819</span>  <span class="keywordtype">int</span> left_prev_pt_idx = 0;</div>
<div class="line"><span class="lineno">  820</span>  <span class="keywordtype">int</span> right_next_pt_idx = 0;</div>
<div class="line"><span class="lineno">  821</span>  <span class="keywordtype">int</span> right_prev_pt_idx = 0;</div>
<div class="line"><span class="lineno">  822</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> = 0 ; <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> &lt; ratios.size(); <a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a> ++)</div>
<div class="line"><span class="lineno">  823</span>  {</div>
<div class="line"><span class="lineno">  824</span>    left_next_pt_idx = std::round(ratios[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>] * (left_ls_size - 1));</div>
<div class="line"><span class="lineno">  825</span>    right_next_pt_idx = std::round(ratios[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>] * (right_ls_size - 1));</div>
<div class="line"><span class="lineno">  826</span>    <span class="comment">// check if edge ratios are too close to any boundaries. if so, skip</span></div>
<div class="line"><span class="lineno">  827</span>    <span class="keywordflow">if</span> (lanelet::geometry::distance2d(input_lanelet.leftBound2d().front().basicPoint2d(), input_lanelet.leftBound2d()[left_next_pt_idx].basicPoint2d()) &lt;= error_distance)</div>
<div class="line"><span class="lineno">  828</span>    {</div>
<div class="line"><span class="lineno">  829</span>      <span class="comment">// assuming both linestrings have roughly the same number of points and</span></div>
<div class="line"><span class="lineno">  830</span>      <span class="comment">// assuming distance between 0th and index-th points are small enough we can approximate the curve between them as a line:</span></div>
<div class="line"><span class="lineno">  831</span>      RCLCPP_INFO_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Ratio: &quot;</span> &lt;&lt; ratios[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>] &lt;&lt; <span class="stringliteral">&quot;, is too close to the lanelet&#39;s front boundary! Therefore, ignoring... Allowed error_distance: &quot;</span> &lt;&lt; error_distance &lt;&lt; <span class="stringliteral">&quot;, Distance: &quot;</span> </div>
<div class="line"><span class="lineno">  832</span>                        &lt;&lt; lanelet::geometry::distance2d(input_lanelet.leftBound2d().front().basicPoint2d(), input_lanelet.leftBound2d()[left_next_pt_idx].basicPoint2d()));</div>
<div class="line"><span class="lineno">  833</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  834</span>    } </div>
<div class="line"><span class="lineno">  835</span>    <span class="keywordflow">if</span> (lanelet::geometry::distance2d(input_lanelet.leftBound2d().back().basicPoint2d(), input_lanelet.leftBound2d()[left_next_pt_idx].basicPoint2d()) &lt;= error_distance)</div>
<div class="line"><span class="lineno">  836</span>    {</div>
<div class="line"><span class="lineno">  837</span>      RCLCPP_INFO_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;Ratio: &quot;</span> &lt;&lt; ratios[<a class="code hl_variable" href="namespaceprocess__bag.html#af102a02c97622dd30b0dbf7bafb0d199">i</a>] &lt;&lt; <span class="stringliteral">&quot;, is too close to the lanelet&#39;s back boundary! Therefore, ignoring... Allowed error_distance: &quot;</span> &lt;&lt; error_distance &lt;&lt; <span class="stringliteral">&quot;, Distance: &quot;</span> </div>
<div class="line"><span class="lineno">  838</span>                  &lt;&lt; lanelet::geometry::distance2d(input_lanelet.leftBound2d().back().basicPoint2d(), input_lanelet.leftBound2d()[left_next_pt_idx].basicPoint2d()));</div>
<div class="line"><span class="lineno">  839</span> </div>
<div class="line"><span class="lineno">  840</span>      left_next_pt_idx = left_ls_size - 1;</div>
<div class="line"><span class="lineno">  841</span>      right_next_pt_idx = right_ls_size - 1;</div>
<div class="line"><span class="lineno">  842</span>    }</div>
<div class="line"><span class="lineno">  843</span>    <span class="comment">// create lanelet</span></div>
<div class="line"><span class="lineno">  844</span>    std::vector&lt;lanelet::Point3d&gt; left_pts;</div>
<div class="line"><span class="lineno">  845</span>    left_pts.insert(left_pts.end(), <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;laneletLayer.get(input_lanelet.id()).leftBound3d().begin() + left_prev_pt_idx, <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;laneletLayer.get(input_lanelet.id()).leftBound3d().begin() + left_next_pt_idx + 1);</div>
<div class="line"><span class="lineno">  846</span> </div>
<div class="line"><span class="lineno">  847</span>    lanelet::LineString3d left_ls(lanelet::utils::getId(), left_pts, <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;laneletLayer.get(input_lanelet.id()).leftBound3d().attributes());  </div>
<div class="line"><span class="lineno">  848</span> </div>
<div class="line"><span class="lineno">  849</span>    std::vector&lt;lanelet::Point3d&gt; right_pts;</div>
<div class="line"><span class="lineno">  850</span>    right_pts.insert(right_pts.end(), <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;laneletLayer.get(input_lanelet.id()).rightBound3d().begin() + right_prev_pt_idx, <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;laneletLayer.get(input_lanelet.id()).rightBound3d().begin() + right_next_pt_idx + 1);</div>
<div class="line"><span class="lineno">  851</span>    </div>
<div class="line"><span class="lineno">  852</span>    lanelet::LineString3d right_ls(lanelet::utils::getId(), right_pts);  </div>
<div class="line"><span class="lineno">  853</span> </div>
<div class="line"><span class="lineno">  854</span>    lanelet::Lanelet new_llt (lanelet::utils::getId(), left_ls, right_ls, <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;laneletLayer.get(input_lanelet.id()).rightBound3d().attributes());</div>
<div class="line"><span class="lineno">  855</span>    </div>
<div class="line"><span class="lineno">  856</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> regem : <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;laneletLayer.get(input_lanelet.id()).regulatoryElements()) <span class="comment">//copy existing regem into new llts</span></div>
<div class="line"><span class="lineno">  857</span>    {</div>
<div class="line"><span class="lineno">  858</span>      new_llt.addRegulatoryElement(<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;regulatoryElementLayer.get(regem-&gt;id()));</div>
<div class="line"><span class="lineno">  859</span>    }</div>
<div class="line"><span class="lineno">  860</span>    </div>
<div class="line"><span class="lineno">  861</span>    left_prev_pt_idx = left_next_pt_idx;</div>
<div class="line"><span class="lineno">  862</span>    right_prev_pt_idx = right_next_pt_idx;</div>
<div class="line"><span class="lineno">  863</span>    </div>
<div class="line"><span class="lineno">  864</span>    created_llts.push_back(new_llt);</div>
<div class="line"><span class="lineno">  865</span>    </div>
<div class="line"><span class="lineno">  866</span>    <span class="comment">// Detected the end already. Exiting now</span></div>
<div class="line"><span class="lineno">  867</span>    <span class="keywordflow">if</span> (left_prev_pt_idx == left_ls_size - 1 || right_prev_pt_idx == right_ls_size - 1)</div>
<div class="line"><span class="lineno">  868</span>    {</div>
<div class="line"><span class="lineno">  869</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  870</span>    }</div>
<div class="line"><span class="lineno">  871</span>    </div>
<div class="line"><span class="lineno">  872</span>  }</div>
<div class="line"><span class="lineno">  873</span> </div>
<div class="line"><span class="lineno">  874</span>  RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;splitLaneletWithRatio returning lanelets size: &quot;</span> &lt;&lt; created_llts.size());</div>
<div class="line"><span class="lineno">  875</span> </div>
<div class="line"><span class="lineno">  876</span>  <span class="keywordflow">return</span> created_llts;</div>
<div class="line"><span class="lineno">  877</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMBroadcaster_8hpp_source.html#l00429">current_map_</a>, and <a class="el" href="process__bag_8py_source.html#l00059">process_bag::i</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l00755">splitLaneletWithPoint()</a>, and <a class="el" href="WMBroadcaster_8cpp_source.html#l00776">splitOppositeLaneletWithPoint()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_a1dfc2ec5be906966916939c75874cbab_icgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_a1dfc2ec5be906966916939c75874cbab_icgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_a1dfc2ec5be906966916939c75874cbab_icgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_a1dfc2ec5be906966916939c75874cbab_icgraph">
<area shape="rect" title="Split given lanelet with given downtrack ratios relative to the lanelet. Newly created lanelet will h..." alt="" coords="1299,39,1509,80"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a883734808f44db2778371ce3fbeecdd3" title="Split given lanelet with same proportion as the given points&#39; downtrack relative to the lanelet...." alt="" coords="1040,5,1251,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a264607b6ec5b20d8971f8dc14a4b1825" title="Split given lanelet&#39;s adjacent, OPPOSITE lanelet with same proportion as the given point&#39;s downtrack ..." alt="" coords="1040,71,1251,112"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#adc221f65f0b99586fc8c2ffc97c5feea" title="Preprocess for workzone area. Parallel_llts will have front_parallel and back_parallel lanelets that ..." alt="" coords="781,5,992,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a5ae3f2086831ebd932e19b2bdfd76405" title="Creates a single workzone geofence (in the vector) that includes all additional lanelets (housing tra..." alt="" coords="523,39,733,80"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a649174a7a7270df95532cad5131bf4cb" title="Adds a geofence to the current map and publishes the ROS msg." alt="" coords="264,39,475,80"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a95cb7c60682d7b455a8624534ad94706" title="Constructor." alt="" coords="5,39,216,80"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a12708b289f7f3d8f10c6dc749bf14d65" title="Create workzone geofence. Create diagonal lanelets and a lanelet that houses opposing lane&#39;s trafficl..." alt="" coords="781,71,992,112"/>
</map>
</div>

</div>
</div>
<a id="a264607b6ec5b20d8971f8dc14a4b1825" name="a264607b6ec5b20d8971f8dc14a4b1825"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a264607b6ec5b20d8971f8dc14a4b1825">&#9670;&nbsp;</a></span>splitOppositeLaneletWithPoint()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">lanelet::Lanelets carma_wm_ctrl::WMBroadcaster::splitOppositeLaneletWithPoint </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; std::vector&lt; lanelet::Lanelet &gt; &gt;&#160;</td>
          <td class="paramname"><em>opposite_llts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const lanelet::BasicPoint2d &amp;&#160;</td>
          <td class="paramname"><em>input_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const lanelet::Lanelet &amp;&#160;</td>
          <td class="paramname"><em>input_llt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>error_distance</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Split given lanelet's adjacent, OPPOSITE lanelet with same proportion as the given point's downtrack relative to the lanelet. Newly created lanelet will have old regulatory elements copied into each of them. From the front and back boundaries, it is deemed not necessary to split if the ratios are within error_distance from either of it. It will return duplicate of old lanelet (with different id) if no splitting was done. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">opposite_llts</td><td>return lanelets split form original one. lanelets sorted from front to back. </td></tr>
    <tr><td class="paramname">input_pt</td><td>A point whose downtrack ratio relative to given lanelet will be used to split the lanelet </td></tr>
    <tr><td class="paramname">input_llt</td><td>A lanelet to split </td></tr>
    <tr><td class="paramname">error_distance</td><td>if within this distance (in meters) the point will be ignored </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>return original opposite lanelet(s if overlapping) </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">InvalidObjectStateError</td><td>if no map is available. NOTE: this is requried to return mutable objects. NOTE: Opposite lanelet doesn't have to share points with current lanelet </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8cpp_source.html#l00776">776</a> of file <a class="el" href="WMBroadcaster_8cpp_source.html">WMBroadcaster.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  777</span>{</div>
<div class="line"><span class="lineno">  778</span>  <span class="comment">// get ratio of this point and split</span></div>
<div class="line"><span class="lineno">  779</span>  <span class="keyword">auto</span> point_downtrack = <a class="code hl_function" href="namespacecarma__wm_1_1geometry.html#aebce986f21c117983313292d5e82b50a">carma_wm::geometry::trackPos</a>(input_llt, input_pt).<a class="code hl_variable" href="classcarma__wm_1_1TrackPos.html#a6ea99bbb9c6a75685ceaaf370d58ea24">downtrack</a>;</div>
<div class="line"><span class="lineno">  780</span>  <span class="keyword">auto</span> point_downtrack_ratio = point_downtrack / <a class="code hl_function" href="namespacecarma__wm_1_1geometry.html#aebce986f21c117983313292d5e82b50a">carma_wm::geometry::trackPos</a>(input_llt, input_llt.centerline().back().basicPoint2d()).<a class="code hl_variable" href="classcarma__wm_1_1TrackPos.html#a6ea99bbb9c6a75685ceaaf370d58ea24">downtrack</a>;</div>
<div class="line"><span class="lineno">  781</span>  </div>
<div class="line"><span class="lineno">  782</span>  <span class="comment">// get opposing lanelets and split</span></div>
<div class="line"><span class="lineno">  783</span>  <span class="keyword">auto</span> opposing_llts = <a class="code hl_function" href="namespacecarma__wm_1_1query.html#a9fb50939b2ae576d2eb7fcfc42fcdc22">carma_wm::query::nonConnectedAdjacentLeft</a>(<a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>, input_pt);</div>
<div class="line"><span class="lineno">  784</span>  </div>
<div class="line"><span class="lineno">  785</span>  <span class="keywordflow">if</span> (opposing_llts.empty())</div>
<div class="line"><span class="lineno">  786</span>  {</div>
<div class="line"><span class="lineno">  787</span>    RCLCPP_ERROR_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;WMBroadcaster was not able to find opposing lane for given point in geofence related to Work Zone! Returning&quot;</span>);</div>
<div class="line"><span class="lineno">  788</span>    <span class="keywordflow">return</span> {};</div>
<div class="line"><span class="lineno">  789</span>  }</div>
<div class="line"><span class="lineno">  790</span> </div>
<div class="line"><span class="lineno">  791</span>  <span class="keyword">auto</span> new_llts_opposite = <a class="code hl_function" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a1dfc2ec5be906966916939c75874cbab">splitLaneletWithRatio</a>({1 - point_downtrack_ratio}, opposing_llts[0], error_distance);</div>
<div class="line"><span class="lineno">  792</span>  opposite_llts-&gt;insert(opposite_llts-&gt;begin(),new_llts_opposite.begin(), new_llts_opposite.end());</div>
<div class="line"><span class="lineno">  793</span>  RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;splitOppositeLaneletWithPoint returning lanelets size: &quot;</span> &lt;&lt; opposite_llts-&gt;size());</div>
<div class="line"><span class="lineno">  794</span>  <span class="keywordflow">return</span> opposing_llts;</div>
<div class="line"><span class="lineno">  795</span>}</div>
<div class="ttc" id="anamespacecarma__wm_1_1query_html_a9fb50939b2ae576d2eb7fcfc42fcdc22"><div class="ttname"><a href="namespacecarma__wm_1_1query.html#a9fb50939b2ae576d2eb7fcfc42fcdc22">carma_wm::query::nonConnectedAdjacentLeft</a></div><div class="ttdeci">std::vector&lt; lanelet::ConstLanelet &gt; nonConnectedAdjacentLeft(const lanelet::LaneletMapConstPtr &amp;semantic_map, const lanelet::BasicPoint2d &amp;input_point, const unsigned int n=10)</div><div class="ttdoc">Given the cartesian point on the map, tries to get the opposite direction lanelet on the left This fu...</div><div class="ttdef"><b>Definition:</b> <a href="WorldModelUtils_8cpp_source.html#l00079">WorldModelUtils.cpp:79</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMBroadcaster_8hpp_source.html#l00429">current_map_</a>, <a class="el" href="TrackPos_8hpp_source.html#l00037">carma_wm::TrackPos::downtrack</a>, <a class="el" href="WorldModelUtils_8cpp_source.html#l00079">carma_wm::query::nonConnectedAdjacentLeft()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l00797">splitLaneletWithRatio()</a>, and <a class="el" href="Geometry_8cpp_source.html#l00120">carma_wm::geometry::trackPos()</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l00420">createWorkzoneGeometry()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_a264607b6ec5b20d8971f8dc14a4b1825_cgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_a264607b6ec5b20d8971f8dc14a4b1825_cgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_a264607b6ec5b20d8971f8dc14a4b1825_cgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_a264607b6ec5b20d8971f8dc14a4b1825_cgraph">
<area shape="rect" title="Split given lanelet&#39;s adjacent, OPPOSITE lanelet with same proportion as the given point&#39;s downtrack ..." alt="" coords="5,159,216,200"/>
<area shape="rect" href="namespacecarma__wm_1_1query.html#a9fb50939b2ae576d2eb7fcfc42fcdc22" title="Given the cartesian point on the map, tries to get the opposite direction lanelet on the left This fu..." alt="" coords="264,97,476,139"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#aebce986f21c117983313292d5e82b50a" title="Returns the TrackPos, computed in 2d, of the provided point relative to the centerline of the provide..." alt="" coords="551,160,696,201"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a1dfc2ec5be906966916939c75874cbab" title="Split given lanelet with given downtrack ratios relative to the lanelet. Newly created lanelet will h..." alt="" coords="265,217,475,259"/>
<area shape="rect" href="namespacecarma__wm_1_1query.html#a8933b74d652e02d07be1170b787d87a2" title="carma_wm::query namespace contains implementations for query functions (input and output read or writ..." alt="" coords="525,5,722,47"/>
<area shape="rect" href="namespacecarma__cooperative__perception.html#a64b708654c8aecb09122d39577df31b5" title=" " alt="" coords="524,95,723,136"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#ab675b2b8862a2ba9c139a8b5b353b846" title="Get the TrackPos of the provided point along the linestring and the segment of the line string which ..." alt="" coords="771,160,916,201"/>
<area shape="rect" href="namespacecarma__wm_1_1geometry.html#ae0a06818149f7430fee80e295ef04548" title="Helper function to identify whether to select the preceeding or succeeding segment of a linstring poi..." alt="" coords="964,160,1109,201"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcarma__wm__ctrl_1_1WMBroadcaster_a264607b6ec5b20d8971f8dc14a4b1825_icgraph.png" border="0" usemap="#aclasscarma__wm__ctrl_1_1WMBroadcaster_a264607b6ec5b20d8971f8dc14a4b1825_icgraph" alt=""/></div>
<map name="aclasscarma__wm__ctrl_1_1WMBroadcaster_a264607b6ec5b20d8971f8dc14a4b1825_icgraph" id="aclasscarma__wm__ctrl_1_1WMBroadcaster_a264607b6ec5b20d8971f8dc14a4b1825_icgraph">
<area shape="rect" title="Split given lanelet&#39;s adjacent, OPPOSITE lanelet with same proportion as the given point&#39;s downtrack ..." alt="" coords="1040,5,1251,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a12708b289f7f3d8f10c6dc749bf14d65" title="Create workzone geofence. Create diagonal lanelets and a lanelet that houses opposing lane&#39;s trafficl..." alt="" coords="781,5,992,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a5ae3f2086831ebd932e19b2bdfd76405" title="Creates a single workzone geofence (in the vector) that includes all additional lanelets (housing tra..." alt="" coords="523,5,733,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a649174a7a7270df95532cad5131bf4cb" title="Adds a geofence to the current map and publishes the ROS msg." alt="" coords="264,5,475,47"/>
<area shape="rect" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a95cb7c60682d7b455a8624534ad94706" title="Constructor." alt="" coords="5,5,216,47"/>
</map>
</div>

</div>
</div>
<a id="ad8d0e8fc5b08ab5f722e4f0afb8ee9f6" name="ad8d0e8fc5b08ab5f722e4f0afb8ee9f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8d0e8fc5b08ab5f722e4f0afb8ee9f6">&#9670;&nbsp;</a></span>updateUpcomingSGIntersectionIds()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void carma_wm_ctrl::WMBroadcaster::updateUpcomingSGIntersectionIds </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>populate upcoming_intersection_ids_ from local traffic lanelet ids </p>

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8cpp_source.html#l02197">2197</a> of file <a class="el" href="WMBroadcaster_8cpp_source.html">WMBroadcaster.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2198</span>{</div>
<div class="line"><span class="lineno"> 2199</span>  uint16_t map_msg_intersection_id = 0;</div>
<div class="line"><span class="lineno"> 2200</span>  uint16_t cur_signal_group_id = 0;</div>
<div class="line"><span class="lineno"> 2201</span>  std::vector&lt;lanelet::CarmaTrafficSignalPtr&gt; traffic_lights;</div>
<div class="line"><span class="lineno"> 2202</span>  lanelet::Lanelet route_lanelet;</div>
<div class="line"><span class="lineno"> 2203</span>  lanelet::Ids cur_route_lanelet_ids = <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a2c67e3708a1f2e191b24bdec5caf2af3">current_route</a>.route_path_lanelet_ids;</div>
<div class="line"><span class="lineno"> 2204</span>  <span class="keywordtype">bool</span> isLightFound = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2205</span>  </div>
<div class="line"><span class="lineno"> 2206</span>  <span class="keywordflow">for</span>(<span class="keyword">auto</span> <span class="keywordtype">id</span> : cur_route_lanelet_ids) </div>
<div class="line"><span class="lineno"> 2207</span>  {    </div>
<div class="line"><span class="lineno"> 2208</span>    route_lanelet= <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a040ca7a37cb8e92574f77401eb80b856">current_map_</a>-&gt;laneletLayer.get(<span class="keywordtype">id</span>);</div>
<div class="line"><span class="lineno"> 2209</span>    traffic_lights = route_lanelet.regulatoryElementsAs&lt;lanelet::CarmaTrafficSignal&gt;();</div>
<div class="line"><span class="lineno"> 2210</span>    <span class="keywordflow">if</span>(!traffic_lights.empty())</div>
<div class="line"><span class="lineno"> 2211</span>    {</div>
<div class="line"><span class="lineno"> 2212</span>      isLightFound  = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2213</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2214</span>    }</div>
<div class="line"><span class="lineno"> 2215</span>  }</div>
<div class="line"><span class="lineno"> 2216</span> </div>
<div class="line"><span class="lineno"> 2217</span>  <span class="keywordflow">if</span>(isLightFound &amp;&amp; <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aa26bb2f41f25b523fd2a98010af60cb0">sim_</a>)</div>
<div class="line"><span class="lineno"> 2218</span>  {</div>
<div class="line"><span class="lineno"> 2219</span>    <span class="keywordflow">for</span>(<span class="keyword">auto</span> itr = <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aa26bb2f41f25b523fd2a98010af60cb0">sim_</a>-&gt;signal_group_to_traffic_light_id_.begin(); itr != <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aa26bb2f41f25b523fd2a98010af60cb0">sim_</a>-&gt;signal_group_to_traffic_light_id_.end(); itr++)</div>
<div class="line"><span class="lineno"> 2220</span>    {     </div>
<div class="line"><span class="lineno"> 2221</span>      <span class="keywordflow">if</span>(itr-&gt;second == traffic_lights.front()-&gt;id())</div>
<div class="line"><span class="lineno"> 2222</span>      {</div>
<div class="line"><span class="lineno"> 2223</span>        cur_signal_group_id = itr-&gt;first;</div>
<div class="line"><span class="lineno"> 2224</span>      }</div>
<div class="line"><span class="lineno"> 2225</span>    }</div>
<div class="line"><span class="lineno"> 2226</span>  }</div>
<div class="line"><span class="lineno"> 2227</span>  <span class="keywordflow">else</span>{</div>
<div class="line"><span class="lineno"> 2228</span>     RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;NO matching Traffic lights along the route&quot;</span>);</div>
<div class="line"><span class="lineno"> 2229</span>  }<span class="comment">//END Traffic signals</span></div>
<div class="line"><span class="lineno"> 2230</span> </div>
<div class="line"><span class="lineno"> 2231</span>  <span class="keyword">auto</span> intersections = route_lanelet.regulatoryElementsAs&lt;lanelet::SignalizedIntersection&gt;();</div>
<div class="line"><span class="lineno"> 2232</span>  <span class="keywordflow">if</span> (intersections.empty())</div>
<div class="line"><span class="lineno"> 2233</span>  {</div>
<div class="line"><span class="lineno"> 2234</span>    <span class="comment">// no match if any of the entry lanelet is not part of any intersection.</span></div>
<div class="line"><span class="lineno"> 2235</span>    RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;NO matching intersection for current lanelet. lanelet id = &quot;</span> &lt;&lt; route_lanelet.id());</div>
<div class="line"><span class="lineno"> 2236</span>  }</div>
<div class="line"><span class="lineno"> 2237</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2238</span>  {</div>
<div class="line"><span class="lineno"> 2239</span>    <span class="comment">//Currently, each lanelet has only one intersection</span></div>
<div class="line"><span class="lineno"> 2240</span>    lanelet::Id intersection_id = intersections.front()-&gt;id();    </div>
<div class="line"><span class="lineno"> 2241</span>    <span class="keywordflow">if</span>(intersection_id != lanelet::InvalId)</div>
<div class="line"><span class="lineno"> 2242</span>    {</div>
<div class="line"><span class="lineno"> 2243</span>      <span class="keywordflow">for</span>(<span class="keyword">auto</span> itr = <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aa26bb2f41f25b523fd2a98010af60cb0">sim_</a>-&gt;intersection_id_to_regem_id_.begin(); itr != <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#aa26bb2f41f25b523fd2a98010af60cb0">sim_</a>-&gt;intersection_id_to_regem_id_.end(); itr++)</div>
<div class="line"><span class="lineno"> 2244</span>      {</div>
<div class="line"><span class="lineno"> 2245</span>        <span class="keywordflow">if</span>(itr-&gt;second == intersection_id)</div>
<div class="line"><span class="lineno"> 2246</span>        {</div>
<div class="line"><span class="lineno"> 2247</span>          map_msg_intersection_id = itr-&gt;first;</div>
<div class="line"><span class="lineno"> 2248</span>        }</div>
<div class="line"><span class="lineno"> 2249</span>      }</div>
<div class="line"><span class="lineno"> 2250</span>    }</div>
<div class="line"><span class="lineno"> 2251</span>  } <span class="comment">//END intersections</span></div>
<div class="line"><span class="lineno"> 2252</span> </div>
<div class="line"><span class="lineno"> 2253</span>  RCLCPP_DEBUG_STREAM(rclcpp::get_logger(<span class="stringliteral">&quot;carma_wm_ctrl&quot;</span>), <span class="stringliteral">&quot;MAP msg: Intersection ID = &quot;</span> &lt;&lt;  map_msg_intersection_id &lt;&lt; <span class="stringliteral">&quot;, Signal Group ID =&quot;</span> &lt;&lt; cur_signal_group_id );</div>
<div class="line"><span class="lineno"> 2254</span>  <span class="keywordflow">if</span>(map_msg_intersection_id != 0 &amp;&amp; cur_signal_group_id != 0)</div>
<div class="line"><span class="lineno"> 2255</span>  { </div>
<div class="line"><span class="lineno"> 2256</span>    <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a9976591578b2eb031c24c9f63f9c3051">upcoming_intersection_ids_</a>.data.clear();</div>
<div class="line"><span class="lineno"> 2257</span>    <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a9976591578b2eb031c24c9f63f9c3051">upcoming_intersection_ids_</a>.data.push_back(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(map_msg_intersection_id));</div>
<div class="line"><span class="lineno"> 2258</span>    <a class="code hl_variable" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a9976591578b2eb031c24c9f63f9c3051">upcoming_intersection_ids_</a>.data.push_back(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(cur_signal_group_id));</div>
<div class="line"><span class="lineno"> 2259</span>  }</div>
<div class="line"><span class="lineno"> 2260</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="WMBroadcaster_8hpp_source.html#l00429">current_map_</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00453">current_route</a>, <a class="el" href="WMBroadcaster_8hpp_source.html#l00463">sim_</a>, and <a class="el" href="WMBroadcaster_8hpp_source.html#l00406">upcoming_intersection_ids_</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a19e428bc63bdb7eef768738e08af92ac" name="a19e428bc63bdb7eef768738e08af92ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19e428bc63bdb7eef768738e08af92ac">&#9670;&nbsp;</a></span>ack_pub_times_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int carma_wm_ctrl::WMBroadcaster::ack_pub_times_ = 1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8hpp_source.html#l00470">470</a> of file <a class="el" href="WMBroadcaster_8hpp_source.html">WMBroadcaster.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l02262">pubTCMACK()</a>, and <a class="el" href="WMBroadcaster_8cpp_source.html#l01238">setConfigACKPubTimes()</a>.</p>

</div>
</div>
<a id="a9f7ae45f954ed5f177756a56b9387545" name="a9f7ae45f954ed5f177756a56b9387545"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f7ae45f954ed5f177756a56b9387545">&#9670;&nbsp;</a></span>active_geofence_llt_ids_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unordered_set&lt;lanelet::Id&gt; carma_wm_ctrl::WMBroadcaster::active_geofence_llt_ids_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8hpp_source.html#l00411">411</a> of file <a class="el" href="WMBroadcaster_8hpp_source.html">WMBroadcaster.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l01488">addGeofence()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l02012">checkActiveGeofenceLogic()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l01868">distToNearestActiveGeofence()</a>, and <a class="el" href="WMBroadcaster_8cpp_source.html#l01578">removeGeofence()</a>.</p>

</div>
</div>
<a id="abd83bad51ddd9d019add9b8a7de697ae" name="abd83bad51ddd9d019add9b8a7de697ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd83bad51ddd9d019add9b8a7de697ae">&#9670;&nbsp;</a></span>active_pub_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a1f39f2021825ba09363d9ee1c456ced6">PublishActiveGeofCallback</a> carma_wm_ctrl::WMBroadcaster::active_pub_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8hpp_source.html#l00440">440</a> of file <a class="el" href="WMBroadcaster_8hpp_source.html">WMBroadcaster.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l01946">currentLocationCallback()</a>.</p>

</div>
</div>
<a id="a3a0a12165535501b0dc4e174f3029642" name="a3a0a12165535501b0dc4e174f3029642"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a0a12165535501b0dc4e174f3029642">&#9670;&nbsp;</a></span>base_map_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">lanelet::LaneletMapPtr carma_wm_ctrl::WMBroadcaster::base_map_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8hpp_source.html#l00428">428</a> of file <a class="el" href="WMBroadcaster_8hpp_source.html">WMBroadcaster.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l00056">baseMapCallback()</a>.</p>

</div>
</div>
<a id="a8960147050728c13bb19f8157cd51d25" name="a8960147050728c13bb19f8157cd51d25"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8960147050728c13bb19f8157cd51d25">&#9670;&nbsp;</a></span>base_map_georef_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string carma_wm_ctrl::WMBroadcaster::base_map_georef_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8hpp_source.html#l00443">443</a> of file <a class="el" href="WMBroadcaster_8hpp_source.html">WMBroadcaster.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l01641">controlRequestFromRoute()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l01198">geoReferenceCallback()</a>, and <a class="el" href="WMBroadcaster_8cpp_source.html#l01264">getPointsInLocalFrame()</a>.</p>

</div>
</div>
<a id="adaf5a7b70e0bf779f638b739e356bb88" name="adaf5a7b70e0bf779f638b739e356bb88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adaf5a7b70e0bf779f638b739e356bb88">&#9670;&nbsp;</a></span>cached_maps_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;lanelet::LaneletMapPtr&gt; carma_wm_ctrl::WMBroadcaster::cached_maps_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8hpp_source.html#l00435">435</a> of file <a class="el" href="WMBroadcaster_8hpp_source.html">WMBroadcaster.hpp</a>.</p>

</div>
</div>
<a id="af032eaea663f829c386e54bef319b09c" name="af032eaea663f829c386e54bef319b09c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af032eaea663f829c386e54bef319b09c">&#9670;&nbsp;</a></span>checked_geofence_ids_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unordered_set&lt;std::string&gt; carma_wm_ctrl::WMBroadcaster::checked_geofence_ids_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8hpp_source.html#l00433">433</a> of file <a class="el" href="WMBroadcaster_8hpp_source.html">WMBroadcaster.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l01077">geofenceCallback()</a>.</p>

</div>
</div>
<a id="a4bf605c8ea54b5a03e01d010d6014389" name="a4bf605c8ea54b5a03e01d010d6014389"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4bf605c8ea54b5a03e01d010d6014389">&#9670;&nbsp;</a></span>config_limit</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">lanelet::Velocity carma_wm_ctrl::WMBroadcaster::config_limit</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8hpp_source.html#l00431">431</a> of file <a class="el" href="WMBroadcaster_8hpp_source.html">WMBroadcaster.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l00056">baseMapCallback()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l00262">geofenceFromMsg()</a>, and <a class="el" href="WMBroadcaster_8cpp_source.html#l01228">setConfigSpeedLimit()</a>.</p>

</div>
</div>
<a id="a220595697a17eed6a334c9e858e611f5" name="a220595697a17eed6a334c9e858e611f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a220595697a17eed6a334c9e858e611f5">&#9670;&nbsp;</a></span>control_msg_pub_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#af3784647580aee6501347090b46c3244">PublishCtrlRequestCallback</a> carma_wm_ctrl::WMBroadcaster::control_msg_pub_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8hpp_source.html#l00439">439</a> of file <a class="el" href="WMBroadcaster_8hpp_source.html">WMBroadcaster.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l01632">routeCallbackMessage()</a>.</p>

</div>
</div>
<a id="a040ca7a37cb8e92574f77401eb80b856" name="a040ca7a37cb8e92574f77401eb80b856"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a040ca7a37cb8e92574f77401eb80b856">&#9670;&nbsp;</a></span>current_map_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">lanelet::LaneletMapPtr carma_wm_ctrl::WMBroadcaster::current_map_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8hpp_source.html#l00429">429</a> of file <a class="el" href="WMBroadcaster_8hpp_source.html">WMBroadcaster.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l01457">addBackRegulatoryComponent()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l01488">addGeofence()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l01912">addGeofenceHelper()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l01416">addRegulatoryComponent()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l00056">baseMapCallback()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l02012">checkActiveGeofenceLogic()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l01641">controlRequestFromRoute()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l00420">createWorkzoneGeometry()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l01946">currentLocationCallback()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l01868">distToNearestActiveGeofence()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l01030">externalMapMsgCallback()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l00217">geofenceFromMapMsg()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l00262">geofenceFromMsg()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l01344">getAffectedLaneletOrAreas()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l01264">getPointsInLocalFrame()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l00600">preprocessWorkzoneGeometry()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l01971">publishLightId()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l01578">removeGeofence()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l01357">shouldChangeControlLine()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l01388">shouldChangeTrafficSignal()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l00797">splitLaneletWithRatio()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l00776">splitOppositeLaneletWithPoint()</a>, and <a class="el" href="WMBroadcaster_8cpp_source.html#l02197">updateUpcomingSGIntersectionIds()</a>.</p>

</div>
</div>
<a id="ab963fffc1b41395dd3393aee9b3e88e4" name="ab963fffc1b41395dd3393aee9b3e88e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab963fffc1b41395dd3393aee9b3e88e4">&#9670;&nbsp;</a></span>current_map_version_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t carma_wm_ctrl::WMBroadcaster::current_map_version_ = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8hpp_source.html#l00451">451</a> of file <a class="el" href="WMBroadcaster_8hpp_source.html">WMBroadcaster.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l01488">addGeofence()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l00056">baseMapCallback()</a>, and <a class="el" href="WMBroadcaster_8cpp_source.html#l01578">removeGeofence()</a>.</p>

</div>
</div>
<a id="a2c67e3708a1f2e191b24bdec5caf2af3" name="a2c67e3708a1f2e191b24bdec5caf2af3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c67e3708a1f2e191b24bdec5caf2af3">&#9670;&nbsp;</a></span>current_route</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">carma_planning_msgs::msg::Route carma_wm_ctrl::WMBroadcaster::current_route</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8hpp_source.html#l00453">453</a> of file <a class="el" href="WMBroadcaster_8hpp_source.html">WMBroadcaster.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l01627">getRoute()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l01971">publishLightId()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l01632">routeCallbackMessage()</a>, and <a class="el" href="WMBroadcaster_8cpp_source.html#l02197">updateUpcomingSGIntersectionIds()</a>.</p>

</div>
</div>
<a id="a4c64c73d83158f9b82682ad3bcc4af74" name="a4c64c73d83158f9b82682ad3bcc4af74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c64c73d83158f9b82682ad3bcc4af74">&#9670;&nbsp;</a></span>current_routing_graph_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">lanelet::routing::RoutingGraphPtr carma_wm_ctrl::WMBroadcaster::current_routing_graph_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8hpp_source.html#l00430">430</a> of file <a class="el" href="WMBroadcaster_8hpp_source.html">WMBroadcaster.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l01488">addGeofence()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l00056">baseMapCallback()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l00217">geofenceFromMapMsg()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l01344">getAffectedLaneletOrAreas()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l00600">preprocessWorkzoneGeometry()</a>, and <a class="el" href="WMBroadcaster_8cpp_source.html#l01578">removeGeofence()</a>.</p>

</div>
</div>
<a id="ab5567570e8a54c507f1c55c23f364933" name="ab5567570e8a54c507f1c55c23f364933"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5567570e8a54c507f1c55c23f364933">&#9670;&nbsp;</a></span>error_distance_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double carma_wm_ctrl::WMBroadcaster::error_distance_ = 5</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8hpp_source.html#l00409">409</a> of file <a class="el" href="WMBroadcaster_8hpp_source.html">WMBroadcaster.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l00420">createWorkzoneGeometry()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l00600">preprocessWorkzoneGeometry()</a>, and <a class="el" href="WMBroadcaster_8cpp_source.html#l00595">setErrorDistance()</a>.</p>

</div>
</div>
<a id="ae21047d8e9e8273c80ae80c4749feee0" name="ae21047d8e9e8273c80ae80c4749feee0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae21047d8e9e8273c80ae80c4749feee0">&#9670;&nbsp;</a></span>generated_geofence_reqids_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unordered_set&lt;std::string&gt; carma_wm_ctrl::WMBroadcaster::generated_geofence_reqids_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8hpp_source.html#l00434">434</a> of file <a class="el" href="WMBroadcaster_8hpp_source.html">WMBroadcaster.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l01641">controlRequestFromRoute()</a>, and <a class="el" href="WMBroadcaster_8cpp_source.html#l01077">geofenceCallback()</a>.</p>

</div>
</div>
<a id="a229cd9488710003a3f7da5be95ce9f4f" name="a229cd9488710003a3f7da5be95ce9f4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a229cd9488710003a3f7da5be95ce9f4f">&#9670;&nbsp;</a></span>geofence_ack_strategy_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::string carma_wm_ctrl::WMBroadcaster::geofence_ack_strategy_ = &quot;carma3/Geofence_Acknowledgement&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8hpp_source.html#l00469">469</a> of file <a class="el" href="WMBroadcaster_8hpp_source.html">WMBroadcaster.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l02262">pubTCMACK()</a>.</p>

</div>
</div>
<a id="a1ac51e0b0b57eda669c87372bd079ede" name="a1ac51e0b0b57eda669c87372bd079ede"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ac51e0b0b57eda669c87372bd079ede">&#9670;&nbsp;</a></span>map_mutex_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::mutex carma_wm_ctrl::WMBroadcaster::map_mutex_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8hpp_source.html#l00436">436</a> of file <a class="el" href="WMBroadcaster_8hpp_source.html">WMBroadcaster.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l01488">addGeofence()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l00056">baseMapCallback()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l01868">distToNearestActiveGeofence()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l01077">geofenceCallback()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l01198">geoReferenceCallback()</a>, and <a class="el" href="WMBroadcaster_8cpp_source.html#l01578">removeGeofence()</a>.</p>

</div>
</div>
<a id="aa787188a277093da1500213ddcfc67ef" name="aa787188a277093da1500213ddcfc67ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa787188a277093da1500213ddcfc67ef">&#9670;&nbsp;</a></span>map_pub_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ad4e8773338ce55f7132025e04d492e23">PublishMapCallback</a> carma_wm_ctrl::WMBroadcaster::map_pub_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8hpp_source.html#l00437">437</a> of file <a class="el" href="WMBroadcaster_8hpp_source.html">WMBroadcaster.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l00056">baseMapCallback()</a>.</p>

</div>
</div>
<a id="a23df6022be994abaef6d4dfefa4d0cd4" name="a23df6022be994abaef6d4dfefa4d0cd4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23df6022be994abaef6d4dfefa4d0cd4">&#9670;&nbsp;</a></span>map_update_message_queue_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;autoware_lanelet2_msgs::msg::MapBin&gt; carma_wm_ctrl::WMBroadcaster::map_update_message_queue_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Queue which stores the map updates applied to the current map version as a sequence of diffs This queue is implemented as a vector because it gets reused by each new subscriber connection NOTE: This queue should be cleared each time the current_map_version changes </p>

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8hpp_source.html#l00459">459</a> of file <a class="el" href="WMBroadcaster_8hpp_source.html">WMBroadcaster.hpp</a>.</p>

</div>
</div>
<a id="aee1d8ad2f6c7865da16ea7f40140b04a" name="aee1d8ad2f6c7865da16ea7f40140b04a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee1d8ad2f6c7865da16ea7f40140b04a">&#9670;&nbsp;</a></span>map_update_pub_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#a7ed209093ad1ddb36c00f97951063f8b">PublishMapUpdateCallback</a> carma_wm_ctrl::WMBroadcaster::map_update_pub_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8hpp_source.html#l00438">438</a> of file <a class="el" href="WMBroadcaster_8hpp_source.html">WMBroadcaster.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l01488">addGeofence()</a>, and <a class="el" href="WMBroadcaster_8cpp_source.html#l01578">removeGeofence()</a>.</p>

</div>
</div>
<a id="af150debc195a3c34c9320232a9b9a1eb" name="af150debc195a3c34c9320232a9b9a1eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af150debc195a3c34c9320232a9b9a1eb">&#9670;&nbsp;</a></span>max_lane_width_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double carma_wm_ctrl::WMBroadcaster::max_lane_width_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8hpp_source.html#l00444">444</a> of file <a class="el" href="WMBroadcaster_8hpp_source.html">WMBroadcaster.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l01344">getAffectedLaneletOrAreas()</a>, and <a class="el" href="WMBroadcaster_8cpp_source.html#l01205">setMaxLaneWidth()</a>.</p>

</div>
</div>
<a id="a9d9fd775035c8389502d5185fa890070" name="a9d9fd775035c8389502d5185fa890070"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d9fd775035c8389502d5185fa890070">&#9670;&nbsp;</a></span>participant_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string carma_wm_ctrl::WMBroadcaster::participant_ = lanelet::Participants::VehicleCar</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8hpp_source.html#l00432">432</a> of file <a class="el" href="WMBroadcaster_8hpp_source.html">WMBroadcaster.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l01488">addGeofence()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l00056">baseMapCallback()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l01247">getVehicleParticipationType()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l01578">removeGeofence()</a>, and <a class="el" href="WMBroadcaster_8cpp_source.html#l01242">setVehicleParticipationType()</a>.</p>

</div>
</div>
<a id="a60ad34ffaa6843dc3225a95e828c3df8" name="a60ad34ffaa6843dc3225a95e828c3df8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60ad34ffaa6843dc3225a95e828c3df8">&#9670;&nbsp;</a></span>route_path_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">lanelet::ConstLanelets carma_wm_ctrl::WMBroadcaster::route_path_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8hpp_source.html#l00410">410</a> of file <a class="el" href="WMBroadcaster_8hpp_source.html">WMBroadcaster.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l01641">controlRequestFromRoute()</a>, and <a class="el" href="WMBroadcaster_8cpp_source.html#l01868">distToNearestActiveGeofence()</a>.</p>

</div>
</div>
<a id="abbf8a6885fb83de6bdf0241ef3e1401f" name="abbf8a6885fb83de6bdf0241ef3e1401f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abbf8a6885fb83de6bdf0241ef3e1401f">&#9670;&nbsp;</a></span>scheduler_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcarma__wm__ctrl_1_1GeofenceScheduler.html">GeofenceScheduler</a> carma_wm_ctrl::WMBroadcaster::scheduler_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8hpp_source.html#l00441">441</a> of file <a class="el" href="WMBroadcaster_8hpp_source.html">WMBroadcaster.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l00047">WMBroadcaster()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l00117">addScheduleFromMsg()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l01641">controlRequestFromRoute()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l02262">pubTCMACK()</a>, and <a class="el" href="WMBroadcaster_8cpp_source.html#l01137">scheduleGeofence()</a>.</p>

</div>
</div>
<a id="aa26bb2f41f25b523fd2a98010af60cb0" name="aa26bb2f41f25b523fd2a98010af60cb0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa26bb2f41f25b523fd2a98010af60cb0">&#9670;&nbsp;</a></span>sim_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_ptr&lt;<a class="el" href="classcarma__wm_1_1SignalizedIntersectionManager.html">carma_wm::SignalizedIntersectionManager</a>&gt; carma_wm_ctrl::WMBroadcaster::sim_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8hpp_source.html#l00463">463</a> of file <a class="el" href="WMBroadcaster_8hpp_source.html">WMBroadcaster.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l01488">addGeofence()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l01416">addRegulatoryComponent()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l01030">externalMapMsgCallback()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l00217">geofenceFromMapMsg()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l01198">geoReferenceCallback()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l01213">setIntersectionCoordCorrection()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l01205">setMaxLaneWidth()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l01388">shouldChangeTrafficSignal()</a>, and <a class="el" href="WMBroadcaster_8cpp_source.html#l02197">updateUpcomingSGIntersectionIds()</a>.</p>

</div>
</div>
<a id="a96fcd16e9d674a448e5a46a08c3a3b64" name="a96fcd16e9d674a448e5a46a08c3a3b64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96fcd16e9d674a448e5a46a08c3a3b64">&#9670;&nbsp;</a></span>tcm_ack_pub_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html#ac4bb2c122bfd96977dd89b9999a4050d">PublishMobilityOperationCallback</a> carma_wm_ctrl::WMBroadcaster::tcm_ack_pub_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8hpp_source.html#l00442">442</a> of file <a class="el" href="WMBroadcaster_8hpp_source.html">WMBroadcaster.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l02262">pubTCMACK()</a>.</p>

</div>
</div>
<a id="a0953785489057b443058b4ed4adb74ec" name="a0953785489057b443058b4ed4adb74ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0953785489057b443058b4ed4adb74ec">&#9670;&nbsp;</a></span>tcm_marker_array_</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">visualization_msgs::msg::MarkerArray carma_wm_ctrl::WMBroadcaster::tcm_marker_array_</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8hpp_source.html#l00404">404</a> of file <a class="el" href="WMBroadcaster_8hpp_source.html">WMBroadcaster.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l01488">addGeofence()</a>, and <a class="el" href="WMBroadcaster_8cpp_source.html#l01826">composeTCMMarkerVisualizer()</a>.</p>

</div>
</div>
<a id="abb6d33eb34b7cc277012ddce4274f0d1" name="abb6d33eb34b7cc277012ddce4274f0d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb6d33eb34b7cc277012ddce4274f0d1">&#9670;&nbsp;</a></span>tcr_polygon_</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">carma_v2x_msgs::msg::TrafficControlRequestPolygon carma_wm_ctrl::WMBroadcaster::tcr_polygon_</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8hpp_source.html#l00405">405</a> of file <a class="el" href="WMBroadcaster_8hpp_source.html">WMBroadcaster.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l01641">controlRequestFromRoute()</a>.</p>

</div>
</div>
<a id="aa03b08ee979d7a4cfd7577280374b97e" name="aa03b08ee979d7a4cfd7577280374b97e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa03b08ee979d7a4cfd7577280374b97e">&#9670;&nbsp;</a></span>traffic_light_id_lookup_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unordered_map&lt;uint32_t, lanelet::Id&gt; carma_wm_ctrl::WMBroadcaster::traffic_light_id_lookup_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8hpp_source.html#l00413">413</a> of file <a class="el" href="WMBroadcaster_8hpp_source.html">WMBroadcaster.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l01912">addGeofenceHelper()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l01956">convertLightIdToInterGroupId()</a>, and <a class="el" href="WMBroadcaster_8cpp_source.html#l01971">publishLightId()</a>.</p>

</div>
</div>
<a id="a9976591578b2eb031c24c9f63f9c3051" name="a9976591578b2eb031c24c9f63f9c3051"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9976591578b2eb031c24c9f63f9c3051">&#9670;&nbsp;</a></span>upcoming_intersection_ids_</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std_msgs::msg::Int32MultiArray carma_wm_ctrl::WMBroadcaster::upcoming_intersection_ids_</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8hpp_source.html#l00406">406</a> of file <a class="el" href="WMBroadcaster_8hpp_source.html">WMBroadcaster.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l01971">publishLightId()</a>, and <a class="el" href="WMBroadcaster_8cpp_source.html#l02197">updateUpcomingSGIntersectionIds()</a>.</p>

</div>
</div>
<a id="a644d3ebd9dd0e50b9152e965fd9f0721" name="a644d3ebd9dd0e50b9152e965fd9f0721"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a644d3ebd9dd0e50b9152e965fd9f0721">&#9670;&nbsp;</a></span>update_count_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t carma_wm_ctrl::WMBroadcaster::update_count_ = -1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8hpp_source.html#l00461">461</a> of file <a class="el" href="WMBroadcaster_8hpp_source.html">WMBroadcaster.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l01488">addGeofence()</a>, and <a class="el" href="WMBroadcaster_8cpp_source.html#l01578">removeGeofence()</a>.</p>

</div>
</div>
<a id="ac34bbb28c302480f2876f0946105cbd6" name="ac34bbb28c302480f2876f0946105cbd6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac34bbb28c302480f2876f0946105cbd6">&#9670;&nbsp;</a></span>vehicle_id_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string carma_wm_ctrl::WMBroadcaster::vehicle_id_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8hpp_source.html#l00471">471</a> of file <a class="el" href="WMBroadcaster_8hpp_source.html">WMBroadcaster.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l02262">pubTCMACK()</a>, and <a class="el" href="WMBroadcaster_8cpp_source.html#l01234">setConfigVehicleId()</a>.</p>

</div>
</div>
<a id="a4610499a06e220327a8eb10cbc18d8de" name="a4610499a06e220327a8eb10cbc18d8de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4610499a06e220327a8eb10cbc18d8de">&#9670;&nbsp;</a></span>work_zone_geofence_cache_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unordered_map&lt;uint8_t, std::shared_ptr&lt;<a class="el" href="classcarma__wm__ctrl_1_1Geofence.html">Geofence</a>&gt; &gt; carma_wm_ctrl::WMBroadcaster::work_zone_geofence_cache_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8hpp_source.html#l00412">412</a> of file <a class="el" href="WMBroadcaster_8hpp_source.html">WMBroadcaster.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="WMBroadcaster_8cpp_source.html#l01488">addGeofence()</a>, <a class="el" href="WMBroadcaster_8cpp_source.html#l00262">geofenceFromMsg()</a>, and <a class="el" href="WMBroadcaster_8cpp_source.html#l01137">scheduleGeofence()</a>.</p>

</div>
</div>
<a id="a84bf2071aeab82b686fa8165a5da9830" name="a84bf2071aeab82b686fa8165a5da9830"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84bf2071aeab82b686fa8165a5da9830">&#9670;&nbsp;</a></span>workzone_geometry_published_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool carma_wm_ctrl::WMBroadcaster::workzone_geometry_published_ = false</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8hpp_source.html#l00446">446</a> of file <a class="el" href="WMBroadcaster_8hpp_source.html">WMBroadcaster.hpp</a>.</p>

</div>
</div>
<a id="a09a01dfc3759b71f3040e701c4fe258f" name="a09a01dfc3759b71f3040e701c4fe258f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09a01dfc3759b71f3040e701c4fe258f">&#9670;&nbsp;</a></span>workzone_remaining_msgs_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;carma_v2x_msgs::msg::TrafficControlMessageV01&gt; carma_wm_ctrl::WMBroadcaster::workzone_remaining_msgs_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="WMBroadcaster_8hpp_source.html#l00445">445</a> of file <a class="el" href="WMBroadcaster_8hpp_source.html">WMBroadcaster.hpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>carma_wm_ctrl/include/carma_wm_ctrl/<a class="el" href="WMBroadcaster_8hpp_source.html">WMBroadcaster.hpp</a></li>
<li>carma_wm_ctrl/src/<a class="el" href="WMBroadcaster_8cpp_source.html">WMBroadcaster.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacecarma__wm__ctrl.html">carma_wm_ctrl</a></li><li class="navelem"><a class="el" href="classcarma__wm__ctrl_1_1WMBroadcaster.html">WMBroadcaster</a></li>
    <li class="footer">Generated on Thu Sep 12 2024 20:51:36 for Carma-platform by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4 </li>
  </ul>
</div>
</body>
</html>
